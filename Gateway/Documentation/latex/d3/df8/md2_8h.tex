\hypertarget{md2_8h}{}\section{cyclone\+\_\+crypto/hash/md2.h File Reference}
\label{md2_8h}\index{cyclone\+\_\+crypto/hash/md2.\+h@{cyclone\+\_\+crypto/hash/md2.\+h}}


M\+D2 (Message-\/\+Digest Algorithm)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structMd2Context}{Md2\+Context}
\begin{DoxyCompactList}\small\item\em M\+D2 algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{md2_8h_a7280fecba94053fef8e818f79590403e}{M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~16
\item 
\#define \hyperlink{md2_8h_a74c2b77e8a7c93238e817213881bfe80}{M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE}~16
\item 
\#define \hyperlink{md2_8h_ae905885dae2b3ee21e22e350f679c331}{M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE}~1
\item 
\#define \hyperlink{md2_8h_a4d0b938b1575227cc6eecc45e294c84c}{M\+D2\+\_\+\+O\+ID}~\hyperlink{md2_8h_aacf2328fd9efad86fc3b6ee2d43c56b3}{md2\+Oid}
\item 
\#define \hyperlink{md2_8h_a9bc342682c0ce91d4594184747f7decc}{M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO}~(\&\hyperlink{md2_8h_a34d2c72ce3d4b4dcd09c1bd4a167ba56}{md2\+Hash\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{md2_8h_ad4e6a5be5ff90c1653b7e1653a1aa766}{md2\+Compute} (const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest)
\begin{DoxyCompactList}\small\item\em Digest a message using M\+D2. \end{DoxyCompactList}\item 
void \hyperlink{md2_8h_a7ee7ac2d5e34c7cf0a6132813dcdadfe}{md2\+Init} (\hyperlink{structMd2Context}{Md2\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Initialize M\+D2 message digest context. \end{DoxyCompactList}\item 
void \hyperlink{md2_8h_a72d459983b1b37f2a963c3f257204e3b}{md2\+Update} (\hyperlink{structMd2Context}{Md2\+Context} $\ast$context, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update the M\+D2 context with a portion of the message being hashed. \end{DoxyCompactList}\item 
void \hyperlink{md2_8h_a0825823f61628df78856d620769c3eb5}{md2\+Final} (\hyperlink{structMd2Context}{Md2\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest)
\begin{DoxyCompactList}\small\item\em Finish the M\+D2 message digest. \end{DoxyCompactList}\item 
void \hyperlink{md2_8h_af8b607a9f509c9ee10195b4946b9ed4b}{md2\+Process\+Block} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$x, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\begin{DoxyCompactList}\small\item\em Process message in 16-\/word blocks. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{md2_8h_aacf2328fd9efad86fc3b6ee2d43c56b3}{md2\+Oid} \mbox{[}8\mbox{]}
\item 
const \hyperlink{structHashAlgo}{Hash\+Algo} \hyperlink{md2_8h_a34d2c72ce3d4b4dcd09c1bd4a167ba56}{md2\+Hash\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
M\+D2 (Message-\/\+Digest Algorithm) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{md2_8h_a7280fecba94053fef8e818f79590403e}\label{md2_8h_a7280fecba94053fef8e818f79590403e}} 
\index{md2.\+h@{md2.\+h}!M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{MD2\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define M\+D2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~16}



Definition at line 38 of file md2.\+h.

\mbox{\Hypertarget{md2_8h_a74c2b77e8a7c93238e817213881bfe80}\label{md2_8h_a74c2b77e8a7c93238e817213881bfe80}} 
\index{md2.\+h@{md2.\+h}!M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE@{M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE}}
\index{M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE@{M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE}{MD2\_DIGEST\_SIZE}}
{\footnotesize\ttfamily \#define M\+D2\+\_\+\+D\+I\+G\+E\+S\+T\+\_\+\+S\+I\+ZE~16}



Definition at line 40 of file md2.\+h.

\mbox{\Hypertarget{md2_8h_a9bc342682c0ce91d4594184747f7decc}\label{md2_8h_a9bc342682c0ce91d4594184747f7decc}} 
\index{md2.\+h@{md2.\+h}!M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO@{M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO}}
\index{M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO@{M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO}{MD2\_HASH\_ALGO}}
{\footnotesize\ttfamily \#define M\+D2\+\_\+\+H\+A\+S\+H\+\_\+\+A\+L\+GO~(\&\hyperlink{md2_8h_a34d2c72ce3d4b4dcd09c1bd4a167ba56}{md2\+Hash\+Algo})}



Definition at line 46 of file md2.\+h.

\mbox{\Hypertarget{md2_8h_ae905885dae2b3ee21e22e350f679c331}\label{md2_8h_ae905885dae2b3ee21e22e350f679c331}} 
\index{md2.\+h@{md2.\+h}!M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE@{M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE}}
\index{M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE@{M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE}{MD2\_MIN\_PAD\_SIZE}}
{\footnotesize\ttfamily \#define M\+D2\+\_\+\+M\+I\+N\+\_\+\+P\+A\+D\+\_\+\+S\+I\+ZE~1}



Definition at line 42 of file md2.\+h.

\mbox{\Hypertarget{md2_8h_a4d0b938b1575227cc6eecc45e294c84c}\label{md2_8h_a4d0b938b1575227cc6eecc45e294c84c}} 
\index{md2.\+h@{md2.\+h}!M\+D2\+\_\+\+O\+ID@{M\+D2\+\_\+\+O\+ID}}
\index{M\+D2\+\_\+\+O\+ID@{M\+D2\+\_\+\+O\+ID}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{M\+D2\+\_\+\+O\+ID}{MD2\_OID}}
{\footnotesize\ttfamily \#define M\+D2\+\_\+\+O\+ID~\hyperlink{md2_8h_aacf2328fd9efad86fc3b6ee2d43c56b3}{md2\+Oid}}



Definition at line 44 of file md2.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{md2_8h_ad4e6a5be5ff90c1653b7e1653a1aa766}\label{md2_8h_ad4e6a5be5ff90c1653b7e1653a1aa766}} 
\index{md2.\+h@{md2.\+h}!md2\+Compute@{md2\+Compute}}
\index{md2\+Compute@{md2\+Compute}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Compute()}{md2Compute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} md2\+Compute (\begin{DoxyParamCaption}\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest }\end{DoxyParamCaption})}



Digest a message using M\+D2. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the message being hashed \\
\hline
\mbox{\tt in}  & {\em length} & Length of the message \\
\hline
\mbox{\tt out}  & {\em digest} & Pointer to the calculated digest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 97 of file md2.\+c.


\begin{DoxyCode}
98 \{
99    \textcolor{comment}{//Allocate a memory buffer to hold the MD2 context}
100    \hyperlink{structMd2Context}{Md2Context} *context = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(\textcolor{keyword}{sizeof}(
      \hyperlink{structMd2Context}{Md2Context}));
101    \textcolor{comment}{//Failed to allocate memory?}
102    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
103       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
104 
105    \textcolor{comment}{//Initialize the MD2 context}
106    \hyperlink{md2_8c_a7ee7ac2d5e34c7cf0a6132813dcdadfe}{md2Init}(context);
107    \textcolor{comment}{//Digest the message}
108    \hyperlink{md2_8c_a72d459983b1b37f2a963c3f257204e3b}{md2Update}(context, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
109    \textcolor{comment}{//Finalize the MD2 message digest}
110    \hyperlink{md2_8c_a0825823f61628df78856d620769c3eb5}{md2Final}(context, digest);
111 
112    \textcolor{comment}{//Free previously allocated memory}
113    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(context);
114    \textcolor{comment}{//Successful processing}
115    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
116 \}
\end{DoxyCode}
\mbox{\Hypertarget{md2_8h_a0825823f61628df78856d620769c3eb5}\label{md2_8h_a0825823f61628df78856d620769c3eb5}} 
\index{md2.\+h@{md2.\+h}!md2\+Final@{md2\+Final}}
\index{md2\+Final@{md2\+Final}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Final()}{md2Final()}}
{\footnotesize\ttfamily void md2\+Final (\begin{DoxyParamCaption}\item[{\hyperlink{structMd2Context}{Md2\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest }\end{DoxyParamCaption})}



Finish the M\+D2 message digest. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+D2 context \\
\hline
\mbox{\tt out}  & {\em digest} & Calculated digest (optional parameter) \\
\hline
\end{DoxyParams}


Definition at line 180 of file md2.\+c.


\begin{DoxyCode}
181 \{
182    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
183 
184    \textcolor{comment}{//Pad the message so that its length is congruent to 0 modulo 16}
185    n = 16 - context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size};
186 
187    \textcolor{comment}{//Append padding bytes}
188    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context->\hyperlink{structMd2Context_a2e9be22ee68833109610d431d0ec7752}{m} + context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size}, n, n);
189    \textcolor{comment}{//Transform the 16-word block}
190    \hyperlink{md2_8c_af8b607a9f509c9ee10195b4946b9ed4b}{md2ProcessBlock}(context->\hyperlink{structMd2Context_a2e9be22ee68833109610d431d0ec7752}{m}, context->\hyperlink{structMd2Context_afea5eca1b34ddac53fa3f49846167bc4}{x}, context->\hyperlink{structMd2Context_abefd310eb88918040e120d90d2869256}{c});
191 
192    \textcolor{comment}{//Append the checksum}
193    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structMd2Context_a2e9be22ee68833109610d431d0ec7752}{m}, context->\hyperlink{structMd2Context_abefd310eb88918040e120d90d2869256}{c}, 16);
194    \textcolor{comment}{//Transform the 16-word block}
195    \hyperlink{md2_8c_af8b607a9f509c9ee10195b4946b9ed4b}{md2ProcessBlock}(context->\hyperlink{structMd2Context_a2e9be22ee68833109610d431d0ec7752}{m}, context->\hyperlink{structMd2Context_afea5eca1b34ddac53fa3f49846167bc4}{x}, context->\hyperlink{structMd2Context_abefd310eb88918040e120d90d2869256}{c});
196 
197    \textcolor{comment}{//Copy the resulting digest}
198    \textcolor{keywordflow}{if}(digest != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
199       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(digest, context->\hyperlink{structMd2Context_abbf42a8e93b5e5f22636477a6efa361a}{digest}, \hyperlink{md2_8h_a74c2b77e8a7c93238e817213881bfe80}{MD2\_DIGEST\_SIZE});
200 \}
\end{DoxyCode}
\mbox{\Hypertarget{md2_8h_a7ee7ac2d5e34c7cf0a6132813dcdadfe}\label{md2_8h_a7ee7ac2d5e34c7cf0a6132813dcdadfe}} 
\index{md2.\+h@{md2.\+h}!md2\+Init@{md2\+Init}}
\index{md2\+Init@{md2\+Init}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Init()}{md2Init()}}
{\footnotesize\ttfamily void md2\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structMd2Context}{Md2\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Initialize M\+D2 message digest context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+D2 context to initialize \\
\hline
\end{DoxyParams}


Definition at line 124 of file md2.\+c.


\begin{DoxyCode}
125 \{
126    \textcolor{comment}{//Initialize the 48-byte buffer X}
127    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context->\hyperlink{structMd2Context_afea5eca1b34ddac53fa3f49846167bc4}{x}, 0, 48);
128    \textcolor{comment}{//Clear checksum}
129    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context->\hyperlink{structMd2Context_abefd310eb88918040e120d90d2869256}{c}, 0, 16);
130    \textcolor{comment}{//Number of bytes in the buffer}
131    context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size} = 0;
132 \}
\end{DoxyCode}
\mbox{\Hypertarget{md2_8h_af8b607a9f509c9ee10195b4946b9ed4b}\label{md2_8h_af8b607a9f509c9ee10195b4946b9ed4b}} 
\index{md2.\+h@{md2.\+h}!md2\+Process\+Block@{md2\+Process\+Block}}
\index{md2\+Process\+Block@{md2\+Process\+Block}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Process\+Block()}{md2ProcessBlock()}}
{\footnotesize\ttfamily void md2\+Process\+Block (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{m,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{x,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{c }\end{DoxyParamCaption})}



Process message in 16-\/word blocks. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em m} & 16-\/byte data block to process \\
\hline
\mbox{\tt in,out}  & {\em x} & 48-\/byte buffer \\
\hline
\mbox{\tt in,out}  & {\em c} & 16-\/byte checksum \\
\hline
\end{DoxyParams}


Definition at line 210 of file md2.\+c.


\begin{DoxyCode}
211 \{
212    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
213    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
214    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
215 
216    \textcolor{comment}{//Update checksum}
217    \textcolor{keywordflow}{for}(t = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}[15], j = 0; j < 16; j++)
218    \{
219       \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}[j] ^= \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}[\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}[j] ^ \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t}];
220       t = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}[j];
221    \}
222 
223    \textcolor{comment}{//Copy current block into X}
224    \textcolor{keywordflow}{for}(j = 0; j < 16; j++)
225    \{
226       x[16 + j] = \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}[j];
227       x[32 + j] = x[16 + j] ^ x[j];
228    \}
229 
230    \textcolor{comment}{//Encrypt block (18 rounds)}
231    \textcolor{keywordflow}{for}(t = 0, j = 0; j < 18; j++)
232    \{
233       \textcolor{comment}{//Round j}
234       \textcolor{keywordflow}{for}(k = 0; k < 48; k++)
235       \{
236          x[\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}] ^= \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}[\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t}];
237          t = x[\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}];
238       \}
239 
240       \textcolor{comment}{//Set t to (t + j) modulo 256}
241       t = (t + j) & 0xFF;
242    \}
243 \}
\end{DoxyCode}
\mbox{\Hypertarget{md2_8h_a72d459983b1b37f2a963c3f257204e3b}\label{md2_8h_a72d459983b1b37f2a963c3f257204e3b}} 
\index{md2.\+h@{md2.\+h}!md2\+Update@{md2\+Update}}
\index{md2\+Update@{md2\+Update}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Update()}{md2Update()}}
{\footnotesize\ttfamily void md2\+Update (\begin{DoxyParamCaption}\item[{\hyperlink{structMd2Context}{Md2\+Context} $\ast$}]{context,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update the M\+D2 context with a portion of the message being hashed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+D2 context \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the buffer being hashed \\
\hline
\mbox{\tt in}  & {\em length} & Length of the buffer \\
\hline
\end{DoxyParams}


Definition at line 142 of file md2.\+c.


\begin{DoxyCode}
143 \{
144    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
145 
146    \textcolor{comment}{//Process the incoming data}
147    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
148    \{
149       \textcolor{comment}{//The buffer can hold at most 16 bytes}
150       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, 16 - context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size});
151 
152       \textcolor{comment}{//Copy the data to the buffer}
153       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structMd2Context_a2e9be22ee68833109610d431d0ec7752}{m} + context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, n);
154 
155       \textcolor{comment}{//Update the MD2 context}
156       context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
157       \textcolor{comment}{//Advance the data pointer}
158       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + n;
159       \textcolor{comment}{//Remaining bytes to process}
160       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
161 
162       \textcolor{comment}{//Process message in 16-word blocks}
163       \textcolor{keywordflow}{if}(context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size} == 16)
164       \{
165          \textcolor{comment}{//Transform the 16-word block}
166          \hyperlink{md2_8c_af8b607a9f509c9ee10195b4946b9ed4b}{md2ProcessBlock}(context->\hyperlink{structMd2Context_a2e9be22ee68833109610d431d0ec7752}{m}, context->\hyperlink{structMd2Context_afea5eca1b34ddac53fa3f49846167bc4}{x}, context->\hyperlink{structMd2Context_abefd310eb88918040e120d90d2869256}{c});
167          \textcolor{comment}{//Empty the buffer}
168          context->\hyperlink{structMd2Context_a257b9952c3fd0ad1c5fcc27c2883aa2f}{size} = 0;
169       \}
170    \}
171 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{md2_8h_a34d2c72ce3d4b4dcd09c1bd4a167ba56}\label{md2_8h_a34d2c72ce3d4b4dcd09c1bd4a167ba56}} 
\index{md2.\+h@{md2.\+h}!md2\+Hash\+Algo@{md2\+Hash\+Algo}}
\index{md2\+Hash\+Algo@{md2\+Hash\+Algo}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Hash\+Algo}{md2HashAlgo}}
{\footnotesize\ttfamily const \hyperlink{structHashAlgo}{Hash\+Algo} md2\+Hash\+Algo}



Definition at line 71 of file md2.\+c.

\mbox{\Hypertarget{md2_8h_aacf2328fd9efad86fc3b6ee2d43c56b3}\label{md2_8h_aacf2328fd9efad86fc3b6ee2d43c56b3}} 
\index{md2.\+h@{md2.\+h}!md2\+Oid@{md2\+Oid}}
\index{md2\+Oid@{md2\+Oid}!md2.\+h@{md2.\+h}}
\subsubsection{\texorpdfstring{md2\+Oid}{md2Oid}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} md2\+Oid\mbox{[}8\mbox{]}}



Definition at line 68 of file md2.\+c.

