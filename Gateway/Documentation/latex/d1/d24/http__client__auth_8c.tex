\hypertarget{http__client__auth_8c}{}\section{cyclone\+\_\+tcp/http/http\+\_\+client\+\_\+auth.c File Reference}
\label{http__client__auth_8c}\index{cyclone\+\_\+tcp/http/http\+\_\+client\+\_\+auth.\+c@{cyclone\+\_\+tcp/http/http\+\_\+client\+\_\+auth.\+c}}


H\+T\+TP authentication.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http/http\+\_\+client.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http/http\+\_\+client\+\_\+auth.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{http__client__auth_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_ace1dd0cc4628f20c72a1d8dc9612d2f1}{H\+T\+T\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{http__client__auth_8c_a5a35610019417b47ed7a8f39ed3e5a16}{http\+Client\+Init\+Auth\+Params} (\hyperlink{structHttpClientAuthParams}{Http\+Client\+Auth\+Params} $\ast$auth\+Params)
\begin{DoxyCompactList}\small\item\em Initialize H\+T\+TP authentication parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client__auth_8c_aa681300ec1fc69a129a64e24c7fd4f5a}{http\+Client\+Format\+Authorization\+Field} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Format Authorization header field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client__auth_8c_a7d7a46a9c5bfb55aebf9afd6124a12ee}{http\+Client\+Parse\+Www\+Authenticate\+Field} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Parse W\+W\+W-\/\+Authenticate header field. \end{DoxyCompactList}\item 
void \hyperlink{http__client__auth_8c_a2ad2695ff34c43c9ba289610e13ff40c}{http\+Client\+Parse\+Qop\+Param} (const \hyperlink{structHttpParam}{Http\+Param} $\ast$param, \hyperlink{structHttpWwwAuthenticateHeader}{Http\+Www\+Authenticate\+Header} $\ast$auth\+Header)
\begin{DoxyCompactList}\small\item\em Parse qop parameter. \end{DoxyCompactList}\item 
void \hyperlink{http__client__auth_8c_af19ccfcd09395c61a74aba04974672b4}{http\+Client\+Parse\+Algorithm\+Param} (const \hyperlink{structHttpParam}{Http\+Param} $\ast$param, \hyperlink{structHttpWwwAuthenticateHeader}{Http\+Www\+Authenticate\+Header} $\ast$auth\+Header)
\begin{DoxyCompactList}\small\item\em Parse algorithm parameter. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client__auth_8c_ab574c4cf88835190edb00d26af498398}{http\+Client\+Compute\+Digest} (\hyperlink{structHttpClientAuthParams}{Http\+Client\+Auth\+Params} $\ast$auth\+Params, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$method, size\+\_\+t method\+Len, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$uri, size\+\_\+t uri\+Len, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$response)
\begin{DoxyCompactList}\small\item\em Digest operation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
H\+T\+TP authentication. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
The H\+T\+TP authentication framework consists of Basic and Digest access authentication schemes. Basic access authentication scheme is not considered to be a secure method of user authentication (unless used in conjunction with some external secure system such as S\+SL), as the user name and password are passed over the network as cleartext. Digest access authentication verifies that both parties know a shared secret; unlike Basic, this verification can be done without sending the password in the clear. Refer to the following R\+F\+Cs for complete details\+:
\begin{DoxyItemize}
\item R\+FC 2617\+: H\+T\+TP Authentication\+: Basic and Digest Access Authentication
\item R\+FC 7235\+: Hypertext Transfer Protocol (H\+T\+T\+P/1.\+1)\+: Authentication
\item R\+FC 7616\+: H\+T\+TP Digest Access Authentication
\item R\+FC 7617\+: The Basic H\+T\+TP Authentication Scheme
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{http__client__auth_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{http__client__auth_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_ace1dd0cc4628f20c72a1d8dc9612d2f1}{H\+T\+T\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 47 of file http\+\_\+client\+\_\+auth.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{http__client__auth_8c_ab574c4cf88835190edb00d26af498398}\label{http__client__auth_8c_ab574c4cf88835190edb00d26af498398}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!http\+Client\+Compute\+Digest@{http\+Client\+Compute\+Digest}}
\index{http\+Client\+Compute\+Digest@{http\+Client\+Compute\+Digest}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Compute\+Digest()}{httpClientComputeDigest()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Compute\+Digest (\begin{DoxyParamCaption}\item[{\hyperlink{structHttpClientAuthParams}{Http\+Client\+Auth\+Params} $\ast$}]{auth\+Params,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{method,  }\item[{size\+\_\+t}]{method\+Len,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{uri,  }\item[{size\+\_\+t}]{uri\+Len,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{response }\end{DoxyParamCaption})}



Digest operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em auth\+Params} & H\+T\+TP authentication parameters \\
\hline
\mbox{\tt in}  & {\em method} & Pointer to the H\+T\+TP method \\
\hline
\mbox{\tt in}  & {\em method\+Len} & Length of the H\+T\+TP method \\
\hline
\mbox{\tt in}  & {\em uri} & Pointer to the U\+RI \\
\hline
\mbox{\tt in}  & {\em uri\+Len} & Length of the U\+RI \\
\hline
\mbox{\tt out}  & {\em response} & Pointer to the resulting digest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 587 of file http\+\_\+client\+\_\+auth.\+c.


\begin{DoxyCode}
590 \{
591 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
592    \textcolor{keywordtype}{size\_t} i;
593    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} buffer[9];
594    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} ha1[\hyperlink{http__client__auth_8h_adf96c500ab5b59befd678c0a5c46aa0e}{HTTP\_CLIENT\_MAX\_HASH\_DIGEST\_SIZE}];
595    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} ha2[\hyperlink{http__client__auth_8h_adf96c500ab5b59befd678c0a5c46aa0e}{HTTP\_CLIENT\_MAX\_HASH\_DIGEST\_SIZE}];
596    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} hashContext[\hyperlink{http__client__auth_8h_afb5918de12aae87e664686d912a7cfbe}{HTTP\_CLIENT\_MAX\_HASH\_CONTEXT\_SIZE}];
597    \textcolor{keyword}{const} \hyperlink{structHashAlgo}{HashAlgo} *\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash};
598 
599    \textcolor{comment}{//Point to the hash algorithm to be used}
600    hash = authParams->\hyperlink{structHttpClientAuthParams_a5fd751d46c8648505a9489c7aa62e655}{algorithm};
601    \textcolor{comment}{//Make sure the hash algorithm is valid}
602    \textcolor{keywordflow}{if}(hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
603       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
604 
605    \textcolor{comment}{//Compute H(A1) = H(username : realm : password)}
606    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
607    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, authParams->\hyperlink{structHttpClientAuthParams_a5cadfff947b3c71dfad308cfd94fd5cd}{username}, strlen(authParams->
      \hyperlink{structHttpClientAuthParams_a5cadfff947b3c71dfad308cfd94fd5cd}{username}));
608    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
609    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, authParams->\hyperlink{structHttpClientAuthParams_a23f1e898b935e02ab807b69e557cb8fa}{realm}, strlen(authParams->
      \hyperlink{structHttpClientAuthParams_a23f1e898b935e02ab807b69e557cb8fa}{realm}));
610    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
611    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, authParams->\hyperlink{structHttpClientAuthParams_a371e3a4a5fabb6c03cef84b43a45f3f2}{password}, strlen(authParams->
      \hyperlink{structHttpClientAuthParams_a371e3a4a5fabb6c03cef84b43a45f3f2}{password}));
612    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, ha1);
613 
614    \textcolor{comment}{//Compute H(A2) = H(method : uri)}
615    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
616    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, method, methodLen);
617    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
618    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, uri, uriLen);
619    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, ha2);
620 
621    \textcolor{comment}{//Compute H(H(A1) : nonce : nc : cnonce : qop : H(A2))}
622    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
623 
624    \textcolor{comment}{//Digest H(A1) as an hex string}
625    \textcolor{keywordflow}{for}(i = 0; i < hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; i++)
626    \{
627       \textcolor{comment}{//Convert the current byte to hex representation}
628       sprintf(buffer, \textcolor{stringliteral}{"%02"} PRIx8, ha1[i]);
629       \textcolor{comment}{//Digest the resulting value}
630       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, buffer, 2);
631    \}
632 
633    \textcolor{comment}{//Digest nonce parameter}
634    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
635    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, authParams->\hyperlink{structHttpClientAuthParams_aa5082a3e2626e38e3a6834bbec7299ec}{nonce}, strlen(authParams->
      \hyperlink{structHttpClientAuthParams_aa5082a3e2626e38e3a6834bbec7299ec}{nonce}));
636    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
637 
638    \textcolor{comment}{//Convert the nonce count to hex string}
639    sprintf(buffer, \textcolor{stringliteral}{"%08x"}, authParams->\hyperlink{structHttpClientAuthParams_af8657995b5e9910a6e205158eab5ada7}{nc});
640 
641    \textcolor{comment}{//Check quality of protection}
642    \textcolor{keywordflow}{if}(authParams->\hyperlink{structHttpClientAuthParams_a686fa3d08f2233ab049f6c1fb3a88a76}{qop} == \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0ace03ab3a38f4fab36f9560a8ce7e510e}{HTTP\_AUTH\_QOP\_AUTH} ||
643       authParams->\hyperlink{structHttpClientAuthParams_a686fa3d08f2233ab049f6c1fb3a88a76}{qop} == \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0a6b76e0dd32ba500d9f43bae0139c7e2e}{HTTP\_AUTH\_QOP\_AUTH\_INT})
644    \{
645       \textcolor{comment}{//Digest nc, cnonce and qop parameters}
646       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, buffer, 8);
647       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
648       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce}, strlen(authParams->
      \hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce}));
649       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
650       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{"auth"}, 4);
651       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \textcolor{stringliteral}{":"}, 1);
652    \}
653 
654    \textcolor{comment}{//Digest H(A2) as an hex string}
655    \textcolor{keywordflow}{for}(i = 0; i < hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; i++)
656    \{
657       \textcolor{comment}{//Convert the current byte to hex representation}
658       sprintf(buffer, \textcolor{stringliteral}{"%02"} PRIx8, ha2[i]);
659       \textcolor{comment}{//Digest the resulting value}
660       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, buffer, 2);
661    \}
662 
663    \textcolor{comment}{//Finalize hash computation}
664    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, response);
665 
666    \textcolor{comment}{//Convert the resulting digest to hex string}
667    \hyperlink{http__common_8c_a3a725c88e91487cbd453c21b1024a482}{httpEncodeHexString}(response, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, response);
668 
669    \textcolor{comment}{//Successful processing}
670    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
671 \textcolor{preprocessor}{#else}
672    \textcolor{comment}{//Digest authentication is not implemented}
673    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
674 \textcolor{preprocessor}{#endif}
675 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client__auth_8c_aa681300ec1fc69a129a64e24c7fd4f5a}\label{http__client__auth_8c_aa681300ec1fc69a129a64e24c7fd4f5a}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!http\+Client\+Format\+Authorization\+Field@{http\+Client\+Format\+Authorization\+Field}}
\index{http\+Client\+Format\+Authorization\+Field@{http\+Client\+Format\+Authorization\+Field}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Format\+Authorization\+Field()}{httpClientFormatAuthorizationField()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Format\+Authorization\+Field (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Format Authorization header field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 92 of file http\+\_\+client\+\_\+auth.\+c.


\begin{DoxyCode}
93 \{
94    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
95    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
96    \hyperlink{structHttpClientAuthParams}{HttpClientAuthParams} *authParams;
97 
98    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
99    \textcolor{keywordflow}{if}(context->bufferLen < 2 || context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
100       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
101 
102    \textcolor{comment}{//Point to the HTTP authentication parameters}
103    authParams = &context->authParams;
104 
105 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_BASIC\_AUTH\_SUPPORT == ENABLED)}
106    \textcolor{comment}{//Basic authentication scheme?}
107    \textcolor{keywordflow}{if}(authParams->\hyperlink{structHttpClientAuthParams_add04fcf3f023b6d2ac1e38d6fd3ebe1e}{mode} == \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31ae59e35c78d081e09a92601aedbde57d5}{HTTP\_AUTH\_MODE\_BASIC})
108    \{
109       \textcolor{keywordtype}{size\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
110       \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
111 
112       \textcolor{comment}{//Calculate the length of the username and password}
113       n = strlen(authParams->\hyperlink{structHttpClientAuthParams_a5cadfff947b3c71dfad308cfd94fd5cd}{username}) + strlen(authParams->\hyperlink{structHttpClientAuthParams_a371e3a4a5fabb6c03cef84b43a45f3f2}{password});
114 
115       \textcolor{comment}{//Make sure the buffer is large enough}
116       \textcolor{keywordflow}{if}((context->bufferLen + n + 22) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
117          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
118 
119       \textcolor{comment}{//Point to the buffer where to format the Authorization header field}
120       p = context->buffer + context->bufferLen - 2;
121 
122       \textcolor{comment}{//Format Authorization header field}
123       n = sprintf(p, \textcolor{stringliteral}{"Authorization: Basic "});
124 
125       \textcolor{comment}{//The client sends the username and password, separated by a single}
126       \textcolor{comment}{//colon character, within a Base64-encoded string in the credentials}
127       m = sprintf(p + n, \textcolor{stringliteral}{"%s:%s"}, authParams->\hyperlink{structHttpClientAuthParams_a5cadfff947b3c71dfad308cfd94fd5cd}{username}, authParams->
      \hyperlink{structHttpClientAuthParams_a371e3a4a5fabb6c03cef84b43a45f3f2}{password});
128 
129       \textcolor{comment}{//The first pass calculates the length of the Base64-encoded string}
130       \hyperlink{base64_8c_a6eb49435a26b3297e611264f6d1cbf5f}{base64Encode}(p + n, m, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, &k);
131 
132       \textcolor{comment}{//Make sure the buffer is large enough}
133       \textcolor{keywordflow}{if}((context->bufferLen + n + k) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
134          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
135 
136       \textcolor{comment}{//The second pass encodes the string using Base64}
137       \hyperlink{base64_8c_a6eb49435a26b3297e611264f6d1cbf5f}{base64Encode}(p + n, m, p + n, &k);
138       \textcolor{comment}{//Update the total length of the header field}
139       n += \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
140 
141       \textcolor{comment}{//Make sure the buffer is large enough}
142       \textcolor{keywordflow}{if}((context->bufferLen + n + 2) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
143          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
144 
145       \textcolor{comment}{//Terminate the header field with a CRLF sequence}
146       sprintf(p + n, \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"});
147 
148       \textcolor{comment}{//Adjust the length of the request header}
149       context->bufferLen = context->bufferLen + n + 2;
150    \}
151    \textcolor{keywordflow}{else}
152 \textcolor{preprocessor}{#endif}
153 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
154    \textcolor{comment}{//Digest authentication scheme?}
155    \textcolor{keywordflow}{if}(authParams->\hyperlink{structHttpClientAuthParams_add04fcf3f023b6d2ac1e38d6fd3ebe1e}{mode} == \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a0ca9d6eab847100994632261a80833df}{HTTP\_AUTH\_MODE\_DIGEST})
156    \{
157       \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
158       \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *q;
159       \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *uri;
160       \textcolor{keywordtype}{size\_t} uriLen;
161       \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} response[\hyperlink{http__client__auth_8h_a2935e4c5a122e03a56a91a84daf29b8d}{HTTP\_CLIENT\_MAX\_RESPONSE\_LEN} + 1];
162 
163       \textcolor{comment}{//Properly terminate the string with a NULL character}
164       context->buffer[context->bufferLen] = \textcolor{charliteral}{'\(\backslash\)0'};
165 
166       \textcolor{comment}{//The Request-Line begins with a method token}
167       q = strchr(context->buffer, \textcolor{charliteral}{' '});
168       \textcolor{comment}{//Any parsing error?}
169       \textcolor{keywordflow}{if}(q == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
170          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
171 
172       \textcolor{comment}{//The method token is followed by the Request-URI}
173       uri = q + 1;
174 
175       \textcolor{comment}{//Point to the end of the Request-URI}
176       q = strchr(uri, \textcolor{charliteral}{' '});
177       \textcolor{comment}{//Any parsing error?}
178       \textcolor{keywordflow}{if}(q == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
179          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
180 
181       \textcolor{comment}{//Compute the length of the current URI}
182       uriLen = q - uri;
183 
184       \textcolor{comment}{//Check quality of protection}
185       \textcolor{keywordflow}{if}(authParams->\hyperlink{structHttpClientAuthParams_a686fa3d08f2233ab049f6c1fb3a88a76}{qop} == \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0ace03ab3a38f4fab36f9560a8ce7e510e}{HTTP\_AUTH\_QOP\_AUTH} ||
186          authParams->\hyperlink{structHttpClientAuthParams_a686fa3d08f2233ab049f6c1fb3a88a76}{qop} == \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0a6b76e0dd32ba500d9f43bae0139c7e2e}{HTTP\_AUTH\_QOP\_AUTH\_INT})
187       \{
188          \textcolor{comment}{//Make sure that a valid callback function has been registered}
189          \textcolor{keywordflow}{if}(context->randCallback == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
190             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2846b744950d419d058ba0f917caf491}{ERROR\_PRNG\_NOT\_READY};
191 
192          \textcolor{comment}{//A cryptographically strong random number generator must be used to}
193          \textcolor{comment}{//generate the cnonce}
194          error = context->randCallback(authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce}, 
      \hyperlink{http__client_8h_aa612d956996c93caa4ccccfef03fc9eb}{HTTP\_CLIENT\_CNONCE\_SIZE});
195          \textcolor{comment}{//Any error to report?}
196          \textcolor{keywordflow}{if}(error)
197             \textcolor{keywordflow}{return} error;
198 
199          \textcolor{comment}{//Convert the byte array to hex string}
200          \hyperlink{http__common_8c_a3a725c88e91487cbd453c21b1024a482}{httpEncodeHexString}(authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce}, 
      \hyperlink{http__client_8h_aa612d956996c93caa4ccccfef03fc9eb}{HTTP\_CLIENT\_CNONCE\_SIZE},
201             authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce});
202 
203          \textcolor{comment}{//Count of the number of requests (including the current request)}
204          \textcolor{comment}{//that the client has sent with the nonce value in this request}
205          authParams->\hyperlink{structHttpClientAuthParams_af8657995b5e9910a6e205158eab5ada7}{nc}++;
206       \}
207 
208       \textcolor{comment}{//Perform digest operation}
209       error = \hyperlink{http__client__auth_8c_ab574c4cf88835190edb00d26af498398}{httpClientComputeDigest}(authParams, context->method,
210          strlen(context->method), uri, uriLen, response);
211       \textcolor{comment}{//Any error to report?}
212       \textcolor{keywordflow}{if}(error)
213          \textcolor{keywordflow}{return} error;
214 
215       \textcolor{comment}{//Determine the length of the header field}
216       n = strlen(authParams->\hyperlink{structHttpClientAuthParams_a5cadfff947b3c71dfad308cfd94fd5cd}{username}) + strlen(authParams->\hyperlink{structHttpClientAuthParams_a23f1e898b935e02ab807b69e557cb8fa}{realm}) +
217          uriLen + strlen(authParams->\hyperlink{structHttpClientAuthParams_aa5082a3e2626e38e3a6834bbec7299ec}{nonce}) + strlen(authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce}) +
218          strlen(response) + strlen(authParams->\hyperlink{structHttpClientAuthParams_ab73141887f9df99f4269f26756b1da4b}{opaque});
219 
220       \textcolor{comment}{//Make sure the buffer is large enough}
221       \textcolor{keywordflow}{if}((context->bufferLen + n + 121) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
222          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
223 
224       \textcolor{comment}{//Point to the buffer where to format the Authorization header field}
225       p = context->buffer + context->bufferLen - 2;
226 
227       \textcolor{comment}{//Format Authorization header field}
228       n = sprintf(p, \textcolor{stringliteral}{"Authorization: Digest "});
229 
230       \textcolor{comment}{//Format username and realm parameter}
231       n += sprintf(p + n, \textcolor{stringliteral}{"username=\(\backslash\)"%s\(\backslash\)", "}, authParams->\hyperlink{structHttpClientAuthParams_a5cadfff947b3c71dfad308cfd94fd5cd}{username});
232       n += sprintf(p + n, \textcolor{stringliteral}{"realm=\(\backslash\)"%s\(\backslash\)", "}, authParams->\hyperlink{structHttpClientAuthParams_a23f1e898b935e02ab807b69e557cb8fa}{realm});
233 
234       \textcolor{comment}{//Format uri parameter}
235       n += sprintf(p + n, \textcolor{stringliteral}{"uri=\(\backslash\)""});
236       strncpy(p + n, uri, uriLen);
237       n += uriLen;
238       n += sprintf(p + n, \textcolor{stringliteral}{"\(\backslash\)", "});
239 
240       \textcolor{comment}{//Format nonce parameter}
241       n += sprintf(p + n, \textcolor{stringliteral}{"nonce=\(\backslash\)"%s\(\backslash\)", "}, authParams->\hyperlink{structHttpClientAuthParams_aa5082a3e2626e38e3a6834bbec7299ec}{nonce});
242 
243       \textcolor{comment}{//Check quality of protection}
244       \textcolor{keywordflow}{if}(authParams->\hyperlink{structHttpClientAuthParams_a686fa3d08f2233ab049f6c1fb3a88a76}{qop} == \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0ace03ab3a38f4fab36f9560a8ce7e510e}{HTTP\_AUTH\_QOP\_AUTH})
245       \{
246          \textcolor{comment}{//Format qop, nc, cnonce parameters}
247          n += sprintf(p + n, \textcolor{stringliteral}{"qop=auth, "});
248          n += sprintf(p + n, \textcolor{stringliteral}{"nc=%08x, "}, authParams->\hyperlink{structHttpClientAuthParams_af8657995b5e9910a6e205158eab5ada7}{nc});
249          n += sprintf(p + n, \textcolor{stringliteral}{"cnonce=\(\backslash\)"%s\(\backslash\)", "}, authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce});
250       \}
251 
252       \textcolor{comment}{//Format response parameter}
253       n += sprintf(p + n, \textcolor{stringliteral}{"response=\(\backslash\)"%s\(\backslash\)""}, response);
254 
255       \textcolor{comment}{//The opaque parameter should be returned by the client unchanged in}
256       \textcolor{comment}{//the Authorization header field of subsequent requests}
257       \textcolor{keywordflow}{if}(authParams->\hyperlink{structHttpClientAuthParams_ab73141887f9df99f4269f26756b1da4b}{opaque}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
258       \{
259          \textcolor{comment}{//Format opaque parameter}
260          n += sprintf(p + n, \textcolor{stringliteral}{", opaque=\(\backslash\)"%s\(\backslash\)""}, authParams->\hyperlink{structHttpClientAuthParams_ab73141887f9df99f4269f26756b1da4b}{opaque});
261       \}
262 
263       \textcolor{comment}{//Terminate the header field with a CRLF sequence}
264       sprintf(p + n, \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"});
265 
266       \textcolor{comment}{//Adjust the length of the request header}
267       context->bufferLen = context->bufferLen + n + 2;
268    \}
269    \textcolor{keywordflow}{else}
270 \textcolor{preprocessor}{#endif}
271    \textcolor{comment}{//Unknown authentication scheme?}
272    \{
273       \textcolor{comment}{//Just for sanity}
274    \}
275 
276    \textcolor{comment}{//Successful processing}
277    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
278 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client__auth_8c_a5a35610019417b47ed7a8f39ed3e5a16}\label{http__client__auth_8c_a5a35610019417b47ed7a8f39ed3e5a16}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!http\+Client\+Init\+Auth\+Params@{http\+Client\+Init\+Auth\+Params}}
\index{http\+Client\+Init\+Auth\+Params@{http\+Client\+Init\+Auth\+Params}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Init\+Auth\+Params()}{httpClientInitAuthParams()}}
{\footnotesize\ttfamily void http\+Client\+Init\+Auth\+Params (\begin{DoxyParamCaption}\item[{\hyperlink{structHttpClientAuthParams}{Http\+Client\+Auth\+Params} $\ast$}]{auth\+Params }\end{DoxyParamCaption})}



Initialize H\+T\+TP authentication parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em auth\+Params} & H\+T\+TP authentication parameters \\
\hline
\end{DoxyParams}


Definition at line 64 of file http\+\_\+client\+\_\+auth.\+c.


\begin{DoxyCode}
65 \{
66    \textcolor{comment}{//Reset authentication scheme to its default value}
67    authParams->\hyperlink{structHttpClientAuthParams_add04fcf3f023b6d2ac1e38d6fd3ebe1e}{mode} = \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a9136cfe14d0dc1985d1e4d93acbc44d7}{HTTP\_AUTH\_MODE\_NONE};
68 
69    \textcolor{comment}{//Clear realm}
70    strcpy(authParams->\hyperlink{structHttpClientAuthParams_a23f1e898b935e02ab807b69e557cb8fa}{realm}, \textcolor{stringliteral}{""});
71 
72 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
73    \textcolor{comment}{//Reset authentication parameters}
74    authParams->\hyperlink{structHttpClientAuthParams_a686fa3d08f2233ab049f6c1fb3a88a76}{qop} = \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0a6ac6b5d7425507f83b5111e0ef5951d0}{HTTP\_AUTH\_QOP\_NONE};
75    authParams->\hyperlink{structHttpClientAuthParams_a5fd751d46c8648505a9489c7aa62e655}{algorithm} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
76    strcpy(authParams->\hyperlink{structHttpClientAuthParams_aa5082a3e2626e38e3a6834bbec7299ec}{nonce}, \textcolor{stringliteral}{""});
77    strcpy(authParams->\hyperlink{structHttpClientAuthParams_aa1989def27a73aedd87034244415fbf5}{cnonce}, \textcolor{stringliteral}{""});
78    strcpy(authParams->\hyperlink{structHttpClientAuthParams_ab73141887f9df99f4269f26756b1da4b}{opaque}, \textcolor{stringliteral}{""});
79 
80    \textcolor{comment}{//Reset stale flag}
81    authParams->\hyperlink{structHttpClientAuthParams_ae97b6746ab9fbdf4b0cd90e354c75ca8}{stale} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
82 \textcolor{preprocessor}{#endif}
83 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client__auth_8c_af19ccfcd09395c61a74aba04974672b4}\label{http__client__auth_8c_af19ccfcd09395c61a74aba04974672b4}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!http\+Client\+Parse\+Algorithm\+Param@{http\+Client\+Parse\+Algorithm\+Param}}
\index{http\+Client\+Parse\+Algorithm\+Param@{http\+Client\+Parse\+Algorithm\+Param}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Parse\+Algorithm\+Param()}{httpClientParseAlgorithmParam()}}
{\footnotesize\ttfamily void http\+Client\+Parse\+Algorithm\+Param (\begin{DoxyParamCaption}\item[{const \hyperlink{structHttpParam}{Http\+Param} $\ast$}]{param,  }\item[{\hyperlink{structHttpWwwAuthenticateHeader}{Http\+Www\+Authenticate\+Header} $\ast$}]{auth\+Header }\end{DoxyParamCaption})}



Parse algorithm parameter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em param} & Pointer to the algorithm parameter \\
\hline
\mbox{\tt in,out}  & {\em auth\+Header} & Pointer to the W\+W\+W-\/\+Authenticate header field \\
\hline
\end{DoxyParams}


Definition at line 535 of file http\+\_\+client\+\_\+auth.\+c.


\begin{DoxyCode}
537 \{
538 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
539 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_MD5\_SUPPORT == ENABLED)}
540    \textcolor{comment}{//MD5 digest algorithm?}
541    \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a5ea2ffe5a754ea539626453d6b8bb91d}{httpCompareParamValue}(param, \textcolor{stringliteral}{"MD5"}))
542    \{
543       \textcolor{comment}{//Select MD5 digest algorithm}
544       authHeader->\hyperlink{structHttpWwwAuthenticateHeader_ad1152391a0ce4952518a457f5082e128}{algorithm} = \hyperlink{md5_8h_adcb5ecbd7a360856b056f053b0d8343d}{MD5\_HASH\_ALGO};
545    \}
546    \textcolor{keywordflow}{else}
547 \textcolor{preprocessor}{#endif}
548 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_SHA256\_SUPPORT == ENABLED)}
549    \textcolor{comment}{//SHA-256 digest algorithm?}
550    \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a5ea2ffe5a754ea539626453d6b8bb91d}{httpCompareParamValue}(param, \textcolor{stringliteral}{"SHA-256"}))
551    \{
552       \textcolor{comment}{//Select SHA-256 digest algorithm}
553       authHeader->\hyperlink{structHttpWwwAuthenticateHeader_ad1152391a0ce4952518a457f5082e128}{algorithm} = \hyperlink{sha256_8h_ac65e86d6ed85707af5486ff4d9f87c71}{SHA256\_HASH\_ALGO};
554    \}
555    \textcolor{keywordflow}{else}
556 \textcolor{preprocessor}{#endif}
557 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_SHA512\_256\_SUPPORT == ENABLED)}
558    \textcolor{comment}{//SHA-512/256 digest algorithm?}
559    \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a5ea2ffe5a754ea539626453d6b8bb91d}{httpCompareParamValue}(param, \textcolor{stringliteral}{"SHA-512-256"}))
560    \{
561       \textcolor{comment}{//Select SHA-512/256 digest algorithm}
562       authHeader->\hyperlink{structHttpWwwAuthenticateHeader_ad1152391a0ce4952518a457f5082e128}{algorithm} = \hyperlink{sha512__256_8h_a02a7b8b19bf56ac148813fef6faeaa24}{SHA512\_256\_HASH\_ALGO};
563    \}
564    \textcolor{keywordflow}{else}
565 \textcolor{preprocessor}{#endif}
566    \textcolor{comment}{//Unknown digest algorithm?}
567    \{
568       \textcolor{comment}{//If the algorithm is not understood, the challenge should be}
569       \textcolor{comment}{//ignored (refer to RFC 7616, section 3.3)}
570       authHeader->\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} = \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a9136cfe14d0dc1985d1e4d93acbc44d7}{HTTP\_AUTH\_MODE\_NONE};
571    \}
572 \textcolor{preprocessor}{#endif}
573 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client__auth_8c_a2ad2695ff34c43c9ba289610e13ff40c}\label{http__client__auth_8c_a2ad2695ff34c43c9ba289610e13ff40c}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!http\+Client\+Parse\+Qop\+Param@{http\+Client\+Parse\+Qop\+Param}}
\index{http\+Client\+Parse\+Qop\+Param@{http\+Client\+Parse\+Qop\+Param}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Parse\+Qop\+Param()}{httpClientParseQopParam()}}
{\footnotesize\ttfamily void http\+Client\+Parse\+Qop\+Param (\begin{DoxyParamCaption}\item[{const \hyperlink{structHttpParam}{Http\+Param} $\ast$}]{param,  }\item[{\hyperlink{structHttpWwwAuthenticateHeader}{Http\+Www\+Authenticate\+Header} $\ast$}]{auth\+Header }\end{DoxyParamCaption})}



Parse qop parameter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em param} & Pointer to the algorithm parameter \\
\hline
\mbox{\tt in,out}  & {\em auth\+Header} & Pointer to the W\+W\+W-\/\+Authenticate header field \\
\hline
\end{DoxyParams}


Definition at line 489 of file http\+\_\+client\+\_\+auth.\+c.


\begin{DoxyCode}
491 \{
492 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
493    \textcolor{keywordtype}{size\_t} i;
494    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
495 
496    \textcolor{comment}{//This parameter is a quoted string of one or more tokens indicating}
497    \textcolor{comment}{//the "quality of protection" values supported by the server}
498    authHeader->\hyperlink{structHttpWwwAuthenticateHeader_a9b039c3e85d0142f4a336ba085581d83}{qop} = \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0a6ac6b5d7425507f83b5111e0ef5951d0}{HTTP\_AUTH\_QOP\_NONE};
499 
500    \textcolor{comment}{//Parse the comma-separated list}
501    \textcolor{keywordflow}{for}(i = 0; i < param->\hyperlink{structHttpParam_abfd3afa2a5a13c642897c3ed8848db48}{valueLen}; i += (n + 1))
502    \{
503       \textcolor{comment}{//Calculate the length of the current token}
504       \textcolor{keywordflow}{for}(n = 0; (i + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}) < param->\hyperlink{structHttpParam_abfd3afa2a5a13c642897c3ed8848db48}{valueLen}; n++)
505       \{
506          \textcolor{comment}{//Separator character found?}
507          \textcolor{keywordflow}{if}(strchr(\textcolor{stringliteral}{", \(\backslash\)t"}, param->\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value}[i + n]))
508             \textcolor{keywordflow}{break};
509       \}
510 
511       \textcolor{comment}{//Check current token}
512       \textcolor{keywordflow}{if}(n == 4 && !\hyperlink{os__port__windows_8h_aba00036f71bb67f8600b239a39cf5ec9}{strncasecmp}(param->\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value} + i, \textcolor{stringliteral}{"auth"}, 4))
513       \{
514          \textcolor{comment}{//The value "auth" indicates authentication}
515          authHeader->\hyperlink{structHttpWwwAuthenticateHeader_a9b039c3e85d0142f4a336ba085581d83}{qop} = \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0ace03ab3a38f4fab36f9560a8ce7e510e}{HTTP\_AUTH\_QOP\_AUTH};
516       \}
517    \}
518 
519    \textcolor{comment}{//Quality of protection not supported?}
520    \textcolor{keywordflow}{if}(authHeader->\hyperlink{structHttpWwwAuthenticateHeader_a9b039c3e85d0142f4a336ba085581d83}{qop} == \hyperlink{http__common_8h_add2473701f02b0e633970b91bebf92b0a6ac6b5d7425507f83b5111e0ef5951d0}{HTTP\_AUTH\_QOP\_NONE})
521    \{
522       \textcolor{comment}{//The challenge should be ignored}
523       authHeader->\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} = \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a9136cfe14d0dc1985d1e4d93acbc44d7}{HTTP\_AUTH\_MODE\_NONE};
524    \}
525 \textcolor{preprocessor}{#endif}
526 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client__auth_8c_a7d7a46a9c5bfb55aebf9afd6124a12ee}\label{http__client__auth_8c_a7d7a46a9c5bfb55aebf9afd6124a12ee}} 
\index{http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}!http\+Client\+Parse\+Www\+Authenticate\+Field@{http\+Client\+Parse\+Www\+Authenticate\+Field}}
\index{http\+Client\+Parse\+Www\+Authenticate\+Field@{http\+Client\+Parse\+Www\+Authenticate\+Field}!http\+\_\+client\+\_\+auth.\+c@{http\+\_\+client\+\_\+auth.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Parse\+Www\+Authenticate\+Field()}{httpClientParseWwwAuthenticateField()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Parse\+Www\+Authenticate\+Field (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Parse W\+W\+W-\/\+Authenticate header field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em value} & N\+U\+L\+L-\/terminated string that contains the value of header field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 288 of file http\+\_\+client\+\_\+auth.\+c.


\begin{DoxyCode}
290 \{
291    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
292    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
293    \hyperlink{structHttpParam}{HttpParam} param;
294    \hyperlink{structHttpWwwAuthenticateHeader}{HttpWwwAuthenticateHeader} authHeader;
295 
296    \textcolor{comment}{//Point to the first character of the string}
297    p = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
298 
299    \textcolor{comment}{//Get the first token}
300    error = \hyperlink{http__common_8c_a1700b173bdb4597cec450d9a987e81ec}{httpParseParam}(&p, &param);
301 
302    \textcolor{comment}{//The WWW-Authenticate header field indicates the authentication scheme(s)}
303    \textcolor{comment}{//and parameters applicable to the target resource}
304    \textcolor{keywordflow}{while}(!error)
305    \{
306       \textcolor{comment}{//The authentication scheme must be a valid token followed by a}
307       \textcolor{comment}{//BWS character}
308       \textcolor{keywordflow}{if}(param.\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && (*p == \textcolor{charliteral}{' '} || *p == \textcolor{charliteral}{'\(\backslash\)t'}))
309       \{
310          \textcolor{comment}{//Clear authentication parameters}
311          memset(&authHeader, 0, \textcolor{keyword}{sizeof}(\hyperlink{structHttpWwwAuthenticateHeader}{HttpWwwAuthenticateHeader}));
312 
313 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED && HTTP\_CLIENT\_MD5\_SUPPORT == ENABLED)}
314          \textcolor{comment}{//If the algorithm parameter is not present, it is assumed to be}
315          \textcolor{comment}{//MD5 (refer to RFC 7616, section 3.3)}
316          authHeader.\hyperlink{structHttpWwwAuthenticateHeader_ad1152391a0ce4952518a457f5082e128}{algorithm} = \hyperlink{md5_8h_adcb5ecbd7a360856b056f053b0d8343d}{MD5\_HASH\_ALGO};
317 \textcolor{preprocessor}{#endif}
318          \textcolor{comment}{//A case-insensitive token is used to identify the authentication}
319          \textcolor{comment}{//scheme}
320          \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"Basic"}))
321          \{
322             \textcolor{comment}{//Basic access authentication}
323             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} = \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31ae59e35c78d081e09a92601aedbde57d5}{HTTP\_AUTH\_MODE\_BASIC};
324          \}
325          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"Digest"}))
326          \{
327             \textcolor{comment}{//Digest access authentication}
328             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} = \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a0ca9d6eab847100994632261a80833df}{HTTP\_AUTH\_MODE\_DIGEST};
329          \}
330          \textcolor{keywordflow}{else}
331          \{
332             \textcolor{comment}{//Unknown authentication scheme}
333             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} = \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a9136cfe14d0dc1985d1e4d93acbc44d7}{HTTP\_AUTH\_MODE\_NONE};
334          \}
335 
336          \textcolor{comment}{//The authentication scheme is followed by a comma-separated list}
337          \textcolor{comment}{//of attribute-value pairs which carry the parameters necessary for}
338          \textcolor{comment}{//achieving authentication via that scheme}
339          \textcolor{keywordflow}{while}(!error)
340          \{
341             \textcolor{comment}{//Parse authentication parameter}
342             error = \hyperlink{http__common_8c_a1700b173bdb4597cec450d9a987e81ec}{httpParseParam}(&p, &param);
343 
344             \textcolor{comment}{//Check status code}
345             \textcolor{keywordflow}{if}(!error)
346             \{
347                \textcolor{comment}{//Valid attribute-value pair?}
348                \textcolor{keywordflow}{if}(param.\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
349                \{
350                   \textcolor{comment}{//Realm parameter?}
351                   \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"realm"}))
352                   \{
353                      \textcolor{comment}{//The realm is a string to be displayed to users so they}
354                      \textcolor{comment}{//know which username and password to use}
355                      authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a8d516fa140d7d8f839a3877aa207c46c}{realm} = param.\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value};
356                      authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen} = param.\hyperlink{structHttpParam_abfd3afa2a5a13c642897c3ed8848db48}{valueLen};
357                   \}
358 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
359                   \textcolor{comment}{//Quality of protection parameter?}
360                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"qop"}))
361                   \{
362                      \textcolor{comment}{//The qop parameter is a quoted string of one or more}
363                      \textcolor{comment}{//tokens indicating the "quality of protection" values}
364                      \textcolor{comment}{//supported by the server}
365                      \hyperlink{http__client__auth_8c_a2ad2695ff34c43c9ba289610e13ff40c}{httpClientParseQopParam}(&param, &authHeader);
366                   \}
367                   \textcolor{comment}{//Algorithm parameter?}
368                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"algorithm"}))
369                   \{
370                      \textcolor{comment}{//This parameter indicates the algorithm used to produce}
371                      \textcolor{comment}{//the digest}
372                      \hyperlink{http__client__auth_8c_af19ccfcd09395c61a74aba04974672b4}{httpClientParseAlgorithmParam}(&param, &authHeader);
373                   \}
374                   \textcolor{comment}{//Nonce parameter?}
375                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"nonce"}))
376                   \{
377                      \textcolor{comment}{//The nonce is a server-specified string which should be}
378                      \textcolor{comment}{//uniquely generated each time a 401 response is made}
379                      authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a6affcd43ab95104141feb6e942cfa847}{nonce} = param.\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value};
380                      authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a0a7963450e6d9edfc3328f818b059a42}{nonceLen} = param.\hyperlink{structHttpParam_abfd3afa2a5a13c642897c3ed8848db48}{valueLen};
381                   \}
382                   \textcolor{comment}{//Opaque parameter?}
383                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"opaque"}))
384                   \{
385                      \textcolor{comment}{//The opaque parameter is a string of data, specified by the}
386                      \textcolor{comment}{//server, that should be returned by the client unchanged in}
387                      \textcolor{comment}{//the Authorization header field of subsequent requests}
388                      authHeader.\hyperlink{structHttpWwwAuthenticateHeader_ae28609cd57840a3be9b40abc0f046e58}{opaque} = param.\hyperlink{structHttpParam_a5474d862a96866927a3a6880731e9af6}{value};
389                      authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a46dd608310782f859a06434c6ebb7911}{opaqueLen} = param.\hyperlink{structHttpParam_abfd3afa2a5a13c642897c3ed8848db48}{valueLen};
390                   \}
391                   \textcolor{comment}{//Stale parameter?}
392                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a6cf3176393f675b6aca0953d17a5225d}{httpCompareParamName}(&param, \textcolor{stringliteral}{"stale"}))
393                   \{
394                      \textcolor{comment}{//The stale flag is a case-insensitive flag indicating that}
395                      \textcolor{comment}{//the previous request from the client was rejected because}
396                      \textcolor{comment}{//the nonce value was stale}
397                      \textcolor{keywordflow}{if}(\hyperlink{http__common_8c_a5ea2ffe5a754ea539626453d6b8bb91d}{httpCompareParamValue}(&param, \textcolor{stringliteral}{"true"}))
398                         authHeader.\hyperlink{structHttpWwwAuthenticateHeader_aa2703d9b83c9c45022f3eb3476d07ffd}{stale} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
399                      \textcolor{keywordflow}{else}
400                         authHeader.\hyperlink{structHttpWwwAuthenticateHeader_aa2703d9b83c9c45022f3eb3476d07ffd}{stale} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
401                   \}
402 \textcolor{preprocessor}{#endif}
403                   \textcolor{comment}{//Unknown parameter?}
404                   \textcolor{keywordflow}{else}
405                   \{
406                      \textcolor{comment}{//Discard unknown attributes}
407                   \}
408                \}
409                \textcolor{keywordflow}{else}
410                \{
411                   \textcolor{comment}{//Parse next authentication scheme}
412                   \textcolor{keywordflow}{break};
413                \}
414             \}
415          \}
416 
417 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_BASIC\_AUTH\_SUPPORT == ENABLED)}
418          \textcolor{comment}{//Valid basic authentication parameters?}
419          \textcolor{keywordflow}{if}(authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} == \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31ae59e35c78d081e09a92601aedbde57d5}{HTTP\_AUTH\_MODE\_BASIC} &&
420             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen} > 0 &&
421             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen} <= \hyperlink{http__client_8h_afd0c1d75944d4aaff63ae2e8b2513072}{HTTP\_CLIENT\_MAX\_REALM\_LEN})
422          \{
423             \textcolor{comment}{//Save authentication mode}
424             context->authParams.mode = authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode};
425 
426             \textcolor{comment}{//Save realm}
427             strncpy(context->authParams.realm, authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a8d516fa140d7d8f839a3877aa207c46c}{realm}, authHeader.
      \hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen});
428             context->authParams.realm[authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen}] = \textcolor{charliteral}{'\(\backslash\)0'};
429          \}
430          \textcolor{keywordflow}{else}
431 \textcolor{preprocessor}{#endif}
432 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
433          \textcolor{comment}{//Valid digest authentication parameters?}
434          \textcolor{keywordflow}{if}(authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode} == \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a0ca9d6eab847100994632261a80833df}{HTTP\_AUTH\_MODE\_DIGEST} &&
435             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_ad1152391a0ce4952518a457f5082e128}{algorithm} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
436             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen} > 0 &&
437             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen} <= \hyperlink{http__client_8h_afd0c1d75944d4aaff63ae2e8b2513072}{HTTP\_CLIENT\_MAX\_REALM\_LEN} &&
438             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a0a7963450e6d9edfc3328f818b059a42}{nonceLen} > 0 &&
439             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a0a7963450e6d9edfc3328f818b059a42}{nonceLen} <= \hyperlink{http__client_8h_aca4c4b3a57b921be4b03a17e1640bebe}{HTTP\_CLIENT\_MAX\_NONCE\_LEN} &&
440             authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a46dd608310782f859a06434c6ebb7911}{opaqueLen} <= \hyperlink{http__client_8h_a4252661d7fd08be7eec40656551e274f}{HTTP\_CLIENT\_MAX\_OPAQUE\_LEN})
441          \{
442             \textcolor{comment}{//Save authentication mode}
443             context->authParams.mode = authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a776f86c339aba82d0b145c83d366d243}{mode};
444             \textcolor{comment}{//Save qop parameter}
445             context->authParams.qop = authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a9b039c3e85d0142f4a336ba085581d83}{qop};
446             \textcolor{comment}{//Save digest algorithm}
447             context->authParams.algorithm = authHeader.\hyperlink{structHttpWwwAuthenticateHeader_ad1152391a0ce4952518a457f5082e128}{algorithm};
448 
449             \textcolor{comment}{//Save realm}
450             strncpy(context->authParams.realm, authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a8d516fa140d7d8f839a3877aa207c46c}{realm}, authHeader.
      \hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen});
451             context->authParams.realm[authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a7645656f51f2ea4df183446e42442f6e}{realmLen}] = \textcolor{charliteral}{'\(\backslash\)0'};
452 
453             \textcolor{comment}{//Save nonce value}
454             strncpy(context->authParams.nonce, authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a6affcd43ab95104141feb6e942cfa847}{nonce}, authHeader.
      \hyperlink{structHttpWwwAuthenticateHeader_a0a7963450e6d9edfc3328f818b059a42}{nonceLen});
455             context->authParams.nonce[authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a0a7963450e6d9edfc3328f818b059a42}{nonceLen}] = \textcolor{charliteral}{'\(\backslash\)0'};
456 
457             \textcolor{comment}{//Save opaque parameter}
458             strncpy(context->authParams.opaque, authHeader.\hyperlink{structHttpWwwAuthenticateHeader_ae28609cd57840a3be9b40abc0f046e58}{opaque}, authHeader.
      \hyperlink{structHttpWwwAuthenticateHeader_a46dd608310782f859a06434c6ebb7911}{opaqueLen});
459             context->authParams.opaque[authHeader.\hyperlink{structHttpWwwAuthenticateHeader_a46dd608310782f859a06434c6ebb7911}{opaqueLen}] = \textcolor{charliteral}{'\(\backslash\)0'};
460 
461             \textcolor{comment}{//Save stale flag}
462             context->authParams.stale = authHeader.\hyperlink{structHttpWwwAuthenticateHeader_aa2703d9b83c9c45022f3eb3476d07ffd}{stale};
463          \}
464          \textcolor{keywordflow}{else}
465 \textcolor{preprocessor}{#endif}
466          \textcolor{comment}{//Invalid parameters}
467          \{
468             \textcolor{comment}{//Ignore the challenge}
469          \}
470       \}
471       \textcolor{keywordflow}{else}
472       \{
473          \textcolor{comment}{//Get next token}
474          error = \hyperlink{http__common_8c_a1700b173bdb4597cec450d9a987e81ec}{httpParseParam}(&p, &param);
475       \}
476    \}
477 
478    \textcolor{comment}{//Successful processing}
479    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
480 \}
\end{DoxyCode}
