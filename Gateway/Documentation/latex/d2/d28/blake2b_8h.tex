\hypertarget{blake2b_8h}{}\section{cyclone\+\_\+crypto/hash/blake2b.h File Reference}
\label{blake2b_8h}\index{cyclone\+\_\+crypto/hash/blake2b.\+h@{cyclone\+\_\+crypto/hash/blake2b.\+h}}


B\+L\+A\+K\+E2 cryptographic hash and M\+AC (B\+L\+A\+K\+E2b variant)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structBlake2bContext}{Blake2b\+Context}
\begin{DoxyCompactList}\small\item\em B\+L\+A\+K\+E2b algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{blake2b_8h_a960749592b995c06830eec139808c77b}{B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~128
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{blake2b_8h_a287abc407ae0e08868cee88e4b9d6acb}{blake2b\+Compute} (const void $\ast$key, size\+\_\+t key\+Len, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t data\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, size\+\_\+t digest\+Len)
\begin{DoxyCompactList}\small\item\em Digest a message using B\+L\+A\+K\+E2b. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{blake2b_8h_af48936776492dca03f05d878f3a0f532}{blake2b\+Init} (\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$context, const void $\ast$key, size\+\_\+t key\+Len, size\+\_\+t digest\+Len)
\begin{DoxyCompactList}\small\item\em Initialize B\+L\+A\+K\+E2b message digest context. \end{DoxyCompactList}\item 
void \hyperlink{blake2b_8h_a7dac7b1287e85152f899ae7b9049b55a}{blake2b\+Update} (\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$context, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update the B\+L\+A\+K\+E2b context with a portion of the message being hashed. \end{DoxyCompactList}\item 
void \hyperlink{blake2b_8h_a8954407cf18778b13fcff2f10105eee2}{blake2b\+Final} (\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest)
\begin{DoxyCompactList}\small\item\em Finish the B\+L\+A\+K\+E2b message digest. \end{DoxyCompactList}\item 
void \hyperlink{blake2b_8h_a7e81a3f0165676976e1b192910a0dfe1}{blake2b\+Process\+Block} (\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$context, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv6__frag_8h_a7179af054cf318941e1a12e964965935}{last})
\begin{DoxyCompactList}\small\item\em Compression function F. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
B\+L\+A\+K\+E2 cryptographic hash and M\+AC (B\+L\+A\+K\+E2b variant) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{blake2b_8h_a960749592b995c06830eec139808c77b}\label{blake2b_8h_a960749592b995c06830eec139808c77b}} 
\index{blake2b.\+h@{blake2b.\+h}!B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!blake2b.\+h@{blake2b.\+h}}
\subsubsection{\texorpdfstring{B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{BLAKE2B\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define B\+L\+A\+K\+E2\+B\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~128}



Definition at line 38 of file blake2b.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{blake2b_8h_a287abc407ae0e08868cee88e4b9d6acb}\label{blake2b_8h_a287abc407ae0e08868cee88e4b9d6acb}} 
\index{blake2b.\+h@{blake2b.\+h}!blake2b\+Compute@{blake2b\+Compute}}
\index{blake2b\+Compute@{blake2b\+Compute}!blake2b.\+h@{blake2b.\+h}}
\subsubsection{\texorpdfstring{blake2b\+Compute()}{blake2bCompute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} blake2b\+Compute (\begin{DoxyParamCaption}\item[{const void $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{data\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{size\+\_\+t}]{digest\+Len }\end{DoxyParamCaption})}



Digest a message using B\+L\+A\+K\+E2b. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the message being hashed \\
\hline
\mbox{\tt in}  & {\em data\+Len} & Length of the message \\
\hline
\mbox{\tt out}  & {\em digest} & Pointer to the calculated digest \\
\hline
\mbox{\tt in}  & {\em digest\+Len} & Expected length of the digest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 100 of file blake2b.\+c.


\begin{DoxyCode}
102 \{
103    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
104    \hyperlink{structBlake2bContext}{Blake2bContext} *context;
105 
106    \textcolor{comment}{//Allocate a memory buffer to hold the BLAKE2b context}
107    context = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(\textcolor{keyword}{sizeof}(\hyperlink{structBlake2bContext}{Blake2bContext}));
108 
109    \textcolor{comment}{//Successful memory allocation?}
110    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
111    \{
112       \textcolor{comment}{//Initialize the hashing context}
113       error = \hyperlink{blake2b_8c_af48936776492dca03f05d878f3a0f532}{blake2bInit}(context, key, keyLen, digestLen);
114 
115       \textcolor{comment}{//Check status code}
116       \textcolor{keywordflow}{if}(!error)
117       \{
118          \textcolor{comment}{//Digest the message}
119          \hyperlink{blake2b_8c_a7dac7b1287e85152f899ae7b9049b55a}{blake2bUpdate}(context, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, dataLen);
120          \textcolor{comment}{//Finalize the BLAKE2b message digest}
121          \hyperlink{blake2b_8c_a8954407cf18778b13fcff2f10105eee2}{blake2bFinal}(context, digest);
122       \}
123 
124       \textcolor{comment}{//Free previously allocated memory}
125       \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(context);
126    \}
127    \textcolor{keywordflow}{else}
128    \{
129       \textcolor{comment}{//Failed to allocate memory}
130       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
131    \}
132 
133    \textcolor{comment}{//Return status code}
134    \textcolor{keywordflow}{return} error;
135 \}
\end{DoxyCode}
\mbox{\Hypertarget{blake2b_8h_a8954407cf18778b13fcff2f10105eee2}\label{blake2b_8h_a8954407cf18778b13fcff2f10105eee2}} 
\index{blake2b.\+h@{blake2b.\+h}!blake2b\+Final@{blake2b\+Final}}
\index{blake2b\+Final@{blake2b\+Final}!blake2b.\+h@{blake2b.\+h}}
\subsubsection{\texorpdfstring{blake2b\+Final()}{blake2bFinal()}}
{\footnotesize\ttfamily void blake2b\+Final (\begin{DoxyParamCaption}\item[{\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest }\end{DoxyParamCaption})}



Finish the B\+L\+A\+K\+E2b message digest. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the B\+L\+A\+K\+E2b context \\
\hline
\mbox{\tt out}  & {\em digest} & Calculated digest (optional parameter) \\
\hline
\end{DoxyParams}


Definition at line 245 of file blake2b.\+c.


\begin{DoxyCode}
246 \{
247    \textcolor{keywordtype}{size\_t} i;
248 
249    \textcolor{comment}{//The last block is padded with zeros to full block size, if required}
250    \textcolor{keywordflow}{for}(i = context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size}; i < 128; i++)
251    \{
252       context->\hyperlink{structBlake2bContext_a4c6fd944f37989469757f2b83dc1fbd1}{buffer}[i] = 0;
253    \}
254 
255    \textcolor{comment}{//Compress the last block}
256    \hyperlink{blake2b_8c_a7e81a3f0165676976e1b192910a0dfe1}{blake2bProcessBlock}(context, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
257 
258    \textcolor{comment}{//Convert from host byte order to big-endian byte order}
259    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
260    \{
261       context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[i] = \hyperlink{cpu__endian_8h_abe3c4432bb369f72cfb6b3dfd89e113a}{htole64}(context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[i]);
262    \}
263 
264    \textcolor{comment}{//Copy the resulting digest}
265    \textcolor{keywordflow}{if}(digest != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
266    \{
267       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(digest, context->\hyperlink{structBlake2bContext_a52c4b94d32c916bd5b9a0cfac711f46a}{digest}, context->
      \hyperlink{structBlake2bContext_a90c528ad18d05f458cf5f57f029973fa}{digestSize});
268    \}
269 \}
\end{DoxyCode}
\mbox{\Hypertarget{blake2b_8h_af48936776492dca03f05d878f3a0f532}\label{blake2b_8h_af48936776492dca03f05d878f3a0f532}} 
\index{blake2b.\+h@{blake2b.\+h}!blake2b\+Init@{blake2b\+Init}}
\index{blake2b\+Init@{blake2b\+Init}!blake2b.\+h@{blake2b.\+h}}
\subsubsection{\texorpdfstring{blake2b\+Init()}{blake2bInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} blake2b\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$}]{context,  }\item[{const void $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len,  }\item[{size\+\_\+t}]{digest\+Len }\end{DoxyParamCaption})}



Initialize B\+L\+A\+K\+E2b message digest context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the B\+L\+A\+K\+E2b context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\mbox{\tt in}  & {\em digest\+Len} & Expected length of the digest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 147 of file blake2b.\+c.


\begin{DoxyCode}
149 \{
150    \textcolor{keywordtype}{size\_t} i;
151 
152    \textcolor{comment}{//Check the length of the key}
153    \textcolor{keywordflow}{if}(keyLen > 64)
154       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
155 
156    \textcolor{comment}{//Check the length of the hash}
157    \textcolor{keywordflow}{if}(digestLen < 1 || digestLen > 64)
158       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
159 
160    \textcolor{comment}{//Initialize state vector}
161    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
162    \{
163       context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[i] = \hyperlink{blake2b_8c_a7776c99735c5a9d93817d8f7bd33d8e6}{iv}[i];
164    \}
165 
166    \textcolor{comment}{//The first byte of the parameter block is the hash size in bytes}
167    context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[0] ^= digestLen;
168    \textcolor{comment}{//The second byte of the parameter block is the key size in bytes}
169    context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[0] ^= keyLen << 8;
170    \textcolor{comment}{//Bytes 2 and 3 are set as 01}
171    context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[0] ^= 0x01010000;
172 
173    \textcolor{comment}{//Number of bytes in the buffer}
174    context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size} = 0;
175 
176    \textcolor{comment}{//Total number of bytes}
177    context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[0] = 0;
178    context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[1] = 0;
179 
180    \textcolor{comment}{//Size of the digest}
181    context->\hyperlink{structBlake2bContext_a90c528ad18d05f458cf5f57f029973fa}{digestSize} = digestLen;
182 
183    \textcolor{comment}{//Clear input buffer}
184    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context->\hyperlink{structBlake2bContext_a4c6fd944f37989469757f2b83dc1fbd1}{buffer}, 0, 128);
185 
186    \textcolor{comment}{//Any secret key?}
187    \textcolor{keywordflow}{if}(keyLen > 0)
188    \{
189       \textcolor{comment}{//Copy the secret key}
190       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structBlake2bContext_a4c6fd944f37989469757f2b83dc1fbd1}{buffer}, key, keyLen);
191       \textcolor{comment}{//The secret key is padded with zero bytes}
192       context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size} = 128;
193    \}
194 
195    \textcolor{comment}{//Successful initialization}
196    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
197 \}
\end{DoxyCode}
\mbox{\Hypertarget{blake2b_8h_a7e81a3f0165676976e1b192910a0dfe1}\label{blake2b_8h_a7e81a3f0165676976e1b192910a0dfe1}} 
\index{blake2b.\+h@{blake2b.\+h}!blake2b\+Process\+Block@{blake2b\+Process\+Block}}
\index{blake2b\+Process\+Block@{blake2b\+Process\+Block}!blake2b.\+h@{blake2b.\+h}}
\subsubsection{\texorpdfstring{blake2b\+Process\+Block()}{blake2bProcessBlock()}}
{\footnotesize\ttfamily void blake2b\+Process\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{last }\end{DoxyParamCaption})}



Compression function F. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the B\+L\+A\+K\+E2b context \\
\hline
\mbox{\tt in}  & {\em last} & Flag indicating the last block \\
\hline
\end{DoxyParams}


Definition at line 278 of file blake2b.\+c.


\begin{DoxyCode}
279 \{
280    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
281    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} *\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
282    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} v[16];
283 
284    \textcolor{comment}{//Initialize the working vector}
285    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
286    \{
287       \textcolor{comment}{//First half from state}
288       v[i] = context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[i];
289       \textcolor{comment}{//Second half from IV}
290       v[i + 8] = \hyperlink{blake2b_8c_a7776c99735c5a9d93817d8f7bd33d8e6}{iv}[i];
291    \}
292 
293    \textcolor{comment}{//Increment offset counter}
294    context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[0] += context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size};
295 
296    \textcolor{comment}{//Propagate the carry if necessary}
297    \textcolor{keywordflow}{if}(context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[0] < context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size})
298    \{
299       context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[1]++;
300    \}
301 
302    \textcolor{comment}{//Low word of the offset}
303    v[12] ^= context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[0];
304    \textcolor{comment}{//High word of the offset}
305    v[13] ^= context->\hyperlink{structBlake2bContext_ad9830491b846cc33a13f9c0f1c511647}{totalSize}[1];
306 
307    \textcolor{comment}{//Last block flag?}
308    \textcolor{keywordflow}{if}(\hyperlink{ipv4__frag_8h_a7179af054cf318941e1a12e964965935}{last})
309    \{
310       \textcolor{comment}{//Invert all bits}
311       v[14] = ~v[14];
312    \}
313 
314    \textcolor{comment}{//Point to the message block vector}
315    m = context->\hyperlink{structBlake2bContext_a1c5c35e976cc71762722092c34cdf09f}{m};
316 
317    \textcolor{comment}{//Convert from little-endian byte order to host byte order}
318    \textcolor{keywordflow}{for}(i = 0; i < 16; i++)
319    \{
320       m[i] = \hyperlink{cpu__endian_8h_a19763700b12cc422823f51d1ee3b4b6b}{letoh64}(m[i]);
321    \}
322 
323    \textcolor{comment}{//Cryptographic mixing}
324    \textcolor{keywordflow}{for}(i = 0; i < 12; i++)
325    \{
326       \textcolor{comment}{//The column rounds apply the quarter-round function to the four}
327       \textcolor{comment}{//columns, from left to right}
328       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[0], v[4], v[8],  v[12], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][0]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][1]]);
329       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[1], v[5], v[9],  v[13], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][2]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][3]]);
330       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[2], v[6], v[10], v[14], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][4]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][5]]);
331       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[3], v[7], v[11], v[15], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][6]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][7]]);
332 
333       \textcolor{comment}{//The diagonal rounds apply the quarter-round function to the top-left,}
334       \textcolor{comment}{//bottom-right diagonal, followed by the pattern shifted one place to}
335       \textcolor{comment}{//the right, for three more quarter-rounds}
336       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[0], v[5], v[10], v[15], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][8]],  m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][9]]);
337       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[1], v[6], v[11], v[12], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][10]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][11]]);
338       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[2], v[7], v[8],  v[13], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][12]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][13]]);
339       \hyperlink{blake2b_8c_a517da2b48479be603314a96aca4e9db8}{G}(v[3], v[4], v[9],  v[14], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][14]], m[\hyperlink{blake2b_8c_aded29a3bb68acec500e441db03175221}{sigma}[i][15]]);
340    \}
341 
342    \textcolor{comment}{//XOR the two halves}
343    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
344    \{
345       context->\hyperlink{structBlake2bContext_af58742ce97114c25ec5062b180c1d344}{h}[i] ^= v[i] ^ v[i + 8];
346    \}
347 \}
\end{DoxyCode}
\mbox{\Hypertarget{blake2b_8h_a7dac7b1287e85152f899ae7b9049b55a}\label{blake2b_8h_a7dac7b1287e85152f899ae7b9049b55a}} 
\index{blake2b.\+h@{blake2b.\+h}!blake2b\+Update@{blake2b\+Update}}
\index{blake2b\+Update@{blake2b\+Update}!blake2b.\+h@{blake2b.\+h}}
\subsubsection{\texorpdfstring{blake2b\+Update()}{blake2bUpdate()}}
{\footnotesize\ttfamily void blake2b\+Update (\begin{DoxyParamCaption}\item[{\hyperlink{structBlake2bContext}{Blake2b\+Context} $\ast$}]{context,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update the B\+L\+A\+K\+E2b context with a portion of the message being hashed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the B\+L\+A\+K\+E2b context \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the buffer being hashed \\
\hline
\mbox{\tt in}  & {\em length} & Length of the buffer \\
\hline
\end{DoxyParams}


Definition at line 207 of file blake2b.\+c.


\begin{DoxyCode}
208 \{
209    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
210 
211    \textcolor{comment}{//Process the incoming data}
212    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
213    \{
214       \textcolor{comment}{//Each message block consists of 16 words}
215       \textcolor{keywordflow}{if}(context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size} == 128)
216       \{
217          \textcolor{comment}{//Compress the 16-word block}
218          \hyperlink{blake2b_8c_a7e81a3f0165676976e1b192910a0dfe1}{blake2bProcessBlock}(context, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
219          \textcolor{comment}{//Empty the buffer}
220          context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size} = 0;
221       \}
222 
223       \textcolor{comment}{//The buffer can hold at most 128 bytes}
224       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, 128 - context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size});
225 
226       \textcolor{comment}{//Copy the data to the buffer}
227       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structBlake2bContext_a4c6fd944f37989469757f2b83dc1fbd1}{buffer} + context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, n);
228       \textcolor{comment}{//Update the length of the buffer}
229       context->\hyperlink{structBlake2bContext_a67cdba5ee54f03a5c0a779a2547781e4}{size} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
230 
231       \textcolor{comment}{//Advance the data pointer}
232       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + n;
233       \textcolor{comment}{//Remaining bytes to process}
234       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
235    \}
236 \}
\end{DoxyCode}
