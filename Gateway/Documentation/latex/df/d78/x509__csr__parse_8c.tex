\hypertarget{x509__csr__parse_8c}{}\section{cyclone\+\_\+crypto/pkix/x509\+\_\+csr\+\_\+parse.c File Reference}
\label{x509__csr__parse_8c}\index{cyclone\+\_\+crypto/pkix/x509\+\_\+csr\+\_\+parse.\+c@{cyclone\+\_\+crypto/pkix/x509\+\_\+csr\+\_\+parse.\+c}}


C\+SR (Certificate Signing Request) parsing.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+cert\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+csr\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+key\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{x509__csr__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__csr__parse_8c_a47fccc0f398b5dc55177f9037a3f5e83}{x509\+Parse\+Csr} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CsrInfo}{X509\+Csr\+Info} $\ast$csr\+Info)
\begin{DoxyCompactList}\small\item\em Parse a C\+SR (Certificate Signing Request) \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__csr__parse_8c_a5bc5c7b135bdc1b739aa7660ed5c9389}{x509\+Parse\+Cert\+Request\+Info} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509CertRequestInfo}{X509\+Cert\+Request\+Info} $\ast$cert\+Req\+Info)
\begin{DoxyCompactList}\small\item\em Parse Certification\+Request\+Info structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__csr__parse_8c_ac3de97fddea69d2d0ad4cffd497de880}{x509\+Parse\+Attributes} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Attributes}{X509\+Attributes} $\ast$attributes)
\begin{DoxyCompactList}\small\item\em Parse C\+SR attributes. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__csr__parse_8c_a2f88d0060da8e84a414dbac792b0dad1}{x509\+Parse\+Attribute} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Attribute}{X509\+Attribute} $\ast$attribute)
\begin{DoxyCompactList}\small\item\em Parse C\+SR attribute. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__csr__parse_8c_a92515f7bb4c29bd866bf7a377289731d}{x509\+Parse\+Challenge\+Password} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509ChallengePassword}{X509\+Challenge\+Password} $\ast$challenge\+Pwd)
\begin{DoxyCompactList}\small\item\em Parse Challenge\+Password attribute. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__csr__parse_8c_a1c51baa55fa49223d4ec31c3f66f46b8}{x509\+Parse\+Extension\+Request} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509Extensions}{X509\+Extensions} $\ast$extension\+Req)
\begin{DoxyCompactList}\small\item\em Parse Extension\+Request attribute. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
C\+SR (Certificate Signing Request) parsing. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{x509__csr__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{x509__csr__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file x509\+\_\+csr\+\_\+parse.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{x509__csr__parse_8c_a2f88d0060da8e84a414dbac792b0dad1}\label{x509__csr__parse_8c_a2f88d0060da8e84a414dbac792b0dad1}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!x509\+Parse\+Attribute@{x509\+Parse\+Attribute}}
\index{x509\+Parse\+Attribute@{x509\+Parse\+Attribute}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Attribute()}{x509ParseAttribute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Attribute (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Attribute}{X509\+Attribute} $\ast$}]{attribute }\end{DoxyParamCaption})}



Parse C\+SR attribute. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em attribute} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 303 of file x509\+\_\+csr\+\_\+parse.\+c.


\begin{DoxyCode}
305 \{
306    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
307    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
308 
309    \textcolor{comment}{//The attribute is encapsulated within a sequence}
310    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
311    \textcolor{comment}{//Failed to decode ASN.1 tag?}
312    \textcolor{keywordflow}{if}(error)
313       \textcolor{keywordflow}{return} error;
314 
315    \textcolor{comment}{//Save the total length of the attribute}
316    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
317 
318    \textcolor{comment}{//Each item binds an attribute identifier to one or more attribute values}
319    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
320    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
321 
322    \textcolor{comment}{//Read attribute identifier}
323    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
324    \textcolor{comment}{//Failed to decode ASN.1 tag?}
325    \textcolor{keywordflow}{if}(error)
326       \textcolor{keywordflow}{return} error;
327 
328    \textcolor{comment}{//Save the object identifier}
329    attribute->\hyperlink{structX509Attribute_adef93e94f9e831bb8d8d5e2ad1fe3693}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
330    attribute->\hyperlink{structX509Attribute_ac03ef355131a4835e1350f9da7819ca5}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
331 
332    \textcolor{comment}{//Next item}
333    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
334    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
335 
336    \textcolor{comment}{//Attribute values are encapsulated within a set}
337    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
338    \textcolor{comment}{//Failed to decode ASN.1 tag?}
339    \textcolor{keywordflow}{if}(error)
340       \textcolor{keywordflow}{return} error;
341 
342    \textcolor{comment}{//Enforce encoding, class and type}
343    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9b2fa570f44ed585417c69fdeead6efa}{ASN1\_TYPE\_SET});
344    \textcolor{comment}{//Invalid tag?}
345    \textcolor{keywordflow}{if}(error)
346       \textcolor{keywordflow}{return} error;
347 
348    \textcolor{comment}{//Save the value of the attribute}
349    attribute->\hyperlink{structX509Attribute_a4285683a21f1b17553c16d2372f9ea97}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
350    attribute->\hyperlink{structX509Attribute_a27cbb916c6731d4c1c26e48d95ba1f0c}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
351 
352    \textcolor{comment}{//Successful processing}
353    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
354 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__csr__parse_8c_ac3de97fddea69d2d0ad4cffd497de880}\label{x509__csr__parse_8c_ac3de97fddea69d2d0ad4cffd497de880}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!x509\+Parse\+Attributes@{x509\+Parse\+Attributes}}
\index{x509\+Parse\+Attributes@{x509\+Parse\+Attributes}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Attributes()}{x509ParseAttributes()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Attributes (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Attributes}{X509\+Attributes} $\ast$}]{attributes }\end{DoxyParamCaption})}



Parse C\+SR attributes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em attributes} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 214 of file x509\+\_\+csr\+\_\+parse.\+c.


\begin{DoxyCode}
216 \{
217    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
218    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
219    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
220    \hyperlink{structX509Attribute}{X509Attribute} attribute;
221 
222    \textcolor{comment}{//Debug message}
223    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Attributes...\(\backslash\)r\(\backslash\)n"});
224 
225    \textcolor{comment}{//Explicit tagging is used to encode the Attributes field}
226    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
227    \textcolor{comment}{//Failed to decode ASN.1 tag?}
228    \textcolor{keywordflow}{if}(error)
229       \textcolor{keywordflow}{return} error;
230 
231    \textcolor{comment}{//Enforce encoding, class and type}
232    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       0);
233    \textcolor{comment}{//Invalid tag?}
234    \textcolor{keywordflow}{if}(error)
235       \textcolor{keywordflow}{return} error;
236 
237    \textcolor{comment}{//This field is a collection of attributes providing additional information}
238    \textcolor{comment}{//about the subject of the certificate}
239    attributes->\hyperlink{structX509Attributes_a699798865f397343e8fa8ed260439422}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
240    attributes->\hyperlink{structX509Attributes_a27fd94a3c0cd628da8d60a9396f54f80}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
241 
242    \textcolor{comment}{//Point to the first item of the collection}
243    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
244    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
245 
246    \textcolor{comment}{//Loop through the collection of attributes}
247    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
248    \{
249       \textcolor{comment}{//Each item binds an attribute identifier to one or more attribute values}
250       error = \hyperlink{x509__csr__parse_8c_a2f88d0060da8e84a414dbac792b0dad1}{x509ParseAttribute}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &attribute);
251       \textcolor{comment}{//Any error to report?}
252       \textcolor{keywordflow}{if}(error)
253          \textcolor{keywordflow}{return} error;
254 
255       \textcolor{comment}{//PKCS#9 Challenge Password attribute found?}
256       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(attribute.\hyperlink{structX509Attribute_adef93e94f9e831bb8d8d5e2ad1fe3693}{oid}, attribute.\hyperlink{structX509Attribute_ac03ef355131a4835e1350f9da7819ca5}{oidLen},
257          \hyperlink{pkix_2x509__common_8c_ac550b6471a81cd6a1349d45d33b42cc1}{X509\_CHALLENGE\_PASSWORD\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{pkix_2x509__common_8c_ac550b6471a81cd6a1349d45d33b42cc1}{X509\_CHALLENGE\_PASSWORD\_OID})))
258       \{
259          \textcolor{comment}{//The interpretation of challenge passwords is intended to be specified}
260          \textcolor{comment}{//by certificate issuers}
261          error = \hyperlink{x509__csr__parse_8c_a92515f7bb4c29bd866bf7a377289731d}{x509ParseChallengePassword}(attribute.
      \hyperlink{structX509Attribute_a4285683a21f1b17553c16d2372f9ea97}{value},
262             attribute.\hyperlink{structX509Attribute_a27cbb916c6731d4c1c26e48d95ba1f0c}{valueLen}, &attributes->\hyperlink{structX509Attributes_a4db26f885358f9571c5108f2684ab287}{challengePwd});
263       \}
264       \textcolor{comment}{//PKCS#9 Extension Request attribute found?}
265       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(attribute.\hyperlink{structX509Attribute_adef93e94f9e831bb8d8d5e2ad1fe3693}{oid}, attribute.\hyperlink{structX509Attribute_ac03ef355131a4835e1350f9da7819ca5}{oidLen},
266          \hyperlink{pkix_2x509__common_8c_a92b820d45230284efc78374baef837c0}{X509\_EXTENSION\_REQUEST\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{pkix_2x509__common_8c_a92b820d45230284efc78374baef837c0}{X509\_EXTENSION\_REQUEST\_OID})))
267       \{
268          \textcolor{comment}{//This attribute may be used to carry information about certificate}
269          \textcolor{comment}{//extensions the requester wishes to be included in a certificate}
270          error = \hyperlink{x509__csr__parse_8c_a1c51baa55fa49223d4ec31c3f66f46b8}{x509ParseExtensionRequest}(attribute.
      \hyperlink{structX509Attribute_a4285683a21f1b17553c16d2372f9ea97}{value},
271             attribute.\hyperlink{structX509Attribute_a27cbb916c6731d4c1c26e48d95ba1f0c}{valueLen}, &attributes->\hyperlink{structX509Attributes_a67c2453fe7c47efb38e5657346330316}{extensionReq});
272       \}
273       \textcolor{comment}{//Unknown attribute?}
274       \textcolor{keywordflow}{else}
275       \{
276          \textcolor{comment}{//Discard current attribute}
277          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
278       \}
279 
280       \textcolor{comment}{//Any parsing error?}
281       \textcolor{keywordflow}{if}(error)
282          \textcolor{keywordflow}{return} error;
283 
284       \textcolor{comment}{//Next attribute}
285       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
286       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
287    \}
288 
289    \textcolor{comment}{//Successful processing}
290    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
291 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__csr__parse_8c_a5bc5c7b135bdc1b739aa7660ed5c9389}\label{x509__csr__parse_8c_a5bc5c7b135bdc1b739aa7660ed5c9389}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!x509\+Parse\+Cert\+Request\+Info@{x509\+Parse\+Cert\+Request\+Info}}
\index{x509\+Parse\+Cert\+Request\+Info@{x509\+Parse\+Cert\+Request\+Info}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Cert\+Request\+Info()}{x509ParseCertRequestInfo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Cert\+Request\+Info (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509CertRequestInfo}{X509\+Cert\+Request\+Info} $\ast$}]{cert\+Req\+Info }\end{DoxyParamCaption})}



Parse Certification\+Request\+Info structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em cert\+Req\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 131 of file x509\+\_\+csr\+\_\+parse.\+c.


\begin{DoxyCode}
133 \{
134    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
135    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version};
136    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
137    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
138 
139    \textcolor{comment}{//Debug message}
140    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing CertificationRequestInfo...\(\backslash\)r\(\backslash\)n"});
141 
142    \textcolor{comment}{//Read the contents of the CertificationRequestInfo structure}
143    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
144    \textcolor{comment}{//Failed to decode ASN.1 tag?}
145    \textcolor{keywordflow}{if}(error)
146       \textcolor{keywordflow}{return} error;
147 
148    \textcolor{comment}{//Save the total length of the field}
149    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
150 
151    \textcolor{comment}{//The ASN.1 DER-encoded CertificationRequestInfo is used as the input}
152    \textcolor{comment}{//to the signature function}
153    certReqInfo->\hyperlink{structX509CertRequestInfo_ad9090d83592df4b2e2ffe1a670fb0a65}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
154    certReqInfo->\hyperlink{structX509CertRequestInfo_a74cd4d14596bbf4331b6e05f02ad8e53}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
155 
156    \textcolor{comment}{//Point to the very first field of the CertificationRequestInfo}
157    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
158    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
159 
160    \textcolor{comment}{//Parse Version field}
161    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &version);
162    \textcolor{comment}{//Any parsing error?}
163    \textcolor{keywordflow}{if}(error)
164       \textcolor{keywordflow}{return} error;
165 
166    \textcolor{comment}{//Save version number}
167    certReqInfo->\hyperlink{structX509CertRequestInfo_a6888747b5ea57fb90fdf9ae77a30c96d}{version} = (\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509Version}) version;
168 
169    \textcolor{comment}{//Point to the next field}
170    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
171    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
172 
173    \textcolor{comment}{//Parse Subject field}
174    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certReqInfo->
      \hyperlink{structX509CertRequestInfo_ab7cab6a9a43f28a64198f227f2abae3f}{subject});
175    \textcolor{comment}{//Any parsing error?}
176    \textcolor{keywordflow}{if}(error)
177       \textcolor{keywordflow}{return} error;
178 
179    \textcolor{comment}{//Point to the next field}
180    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
181    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
182 
183    \textcolor{comment}{//Parse SubjectPublicKeyInfo field}
184    error = \hyperlink{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}{x509ParseSubjectPublicKeyInfo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
185       &certReqInfo->\hyperlink{structX509CertRequestInfo_ab1c561b08bbbb942b684423343363e22}{subjectPublicKeyInfo});
186    \textcolor{comment}{//Any parsing error?}
187    \textcolor{keywordflow}{if}(error)
188       \textcolor{keywordflow}{return} error;
189 
190    \textcolor{comment}{//Point to the next field}
191    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
192    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
193 
194    \textcolor{comment}{//Parse Attributes field}
195    error = \hyperlink{x509__csr__parse_8c_ac3de97fddea69d2d0ad4cffd497de880}{x509ParseAttributes}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certReqInfo->
      \hyperlink{structX509CertRequestInfo_ac4a74fdd56ba3feb52bb1a29de2c2e5c}{attributes});
196    \textcolor{comment}{//Any parsing error?}
197    \textcolor{keywordflow}{if}(error)
198       \textcolor{keywordflow}{return} error;
199 
200    \textcolor{comment}{//No error to report}
201    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
202 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__csr__parse_8c_a92515f7bb4c29bd866bf7a377289731d}\label{x509__csr__parse_8c_a92515f7bb4c29bd866bf7a377289731d}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!x509\+Parse\+Challenge\+Password@{x509\+Parse\+Challenge\+Password}}
\index{x509\+Parse\+Challenge\+Password@{x509\+Parse\+Challenge\+Password}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Challenge\+Password()}{x509ParseChallengePassword()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Challenge\+Password (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509ChallengePassword}{X509\+Challenge\+Password} $\ast$}]{challenge\+Pwd }\end{DoxyParamCaption})}



Parse Challenge\+Password attribute. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em challenge\+Pwd} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 365 of file x509\+\_\+csr\+\_\+parse.\+c.


\begin{DoxyCode}
367 \{
368    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
369    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
370 
371    \textcolor{comment}{//Debug message}
372    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ChallengePassword...\(\backslash\)r\(\backslash\)n"});
373 
374    \textcolor{comment}{//Read attribute value}
375    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
376    \textcolor{comment}{//Failed to decode ASN.1 tag?}
377    \textcolor{keywordflow}{if}(error)
378       \textcolor{keywordflow}{return} error;
379 
380    \textcolor{comment}{//Save challenge password}
381    challengePwd->\hyperlink{structX509ChallengePassword_a1336a40b4d952be8d6689fea03e28a01}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
382    challengePwd->\hyperlink{structX509ChallengePassword_a13c0c6c3c71eb74a5d1ffca2e7a011fa}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
383 
384    \textcolor{comment}{//Successful processing}
385    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
386 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__csr__parse_8c_a47fccc0f398b5dc55177f9037a3f5e83}\label{x509__csr__parse_8c_a47fccc0f398b5dc55177f9037a3f5e83}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!x509\+Parse\+Csr@{x509\+Parse\+Csr}}
\index{x509\+Parse\+Csr@{x509\+Parse\+Csr}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Csr()}{x509ParseCsr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Csr (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CsrInfo}{X509\+Csr\+Info} $\ast$}]{csr\+Info }\end{DoxyParamCaption})}



Parse a C\+SR (Certificate Signing Request) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the C\+SR to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the C\+SR \\
\hline
\mbox{\tt out}  & {\em csr\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 55 of file x509\+\_\+csr\+\_\+parse.\+c.


\begin{DoxyCode}
57 \{
58    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
59    \textcolor{keywordtype}{size\_t} totalLength;
60    \hyperlink{structX509Attributes}{X509Attributes} *attributes;
61    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
62 
63    \textcolor{comment}{//Debug message}
64    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Parsing X.509 CSR...\(\backslash\)r\(\backslash\)n"});
65 
66    \textcolor{comment}{//Check parameters}
67    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || csrInfo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
68       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
69 
70    \textcolor{comment}{//Clear the CSR information structure}
71    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(csrInfo, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509CsrInfo}{X509CsrInfo}));
72 
73    \textcolor{comment}{//Point to the CSR attributes}
74    attributes = &csrInfo->\hyperlink{structX509CsrInfo_a5988c516e1e7ca0c52daf81f02f0cb6c}{certReqInfo}.\hyperlink{structX509CertRequestInfo_ac4a74fdd56ba3feb52bb1a29de2c2e5c}{attributes};
75    \textcolor{comment}{//Where pathLenConstraint does not appear, no limit is imposed}
76    attributes->\hyperlink{structX509Attributes_a67c2453fe7c47efb38e5657346330316}{extensionReq}.\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.
      \hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = -1;
77 
78    \textcolor{comment}{//The CSR is encapsulated within a sequence}
79    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
80    \textcolor{comment}{//Failed to decode ASN.1 tag?}
81    \textcolor{keywordflow}{if}(error)
82       \textcolor{keywordflow}{return} error;
83 
84    \textcolor{comment}{//Point to the very first field}
85    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
86    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
87 
88    \textcolor{comment}{//Parse CertificationRequestInfo structure}
89    error = \hyperlink{x509__csr__parse_8c_a5bc5c7b135bdc1b739aa7660ed5c9389}{x509ParseCertRequestInfo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
90       &csrInfo->\hyperlink{structX509CsrInfo_a5988c516e1e7ca0c52daf81f02f0cb6c}{certReqInfo});
91    \textcolor{comment}{//Any error to report?}
92    \textcolor{keywordflow}{if}(error)
93       \textcolor{keywordflow}{return} error;
94 
95    \textcolor{comment}{//Point to the next field}
96    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
97    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
98 
99    \textcolor{comment}{//Parse SignatureAlgorithm structure}
100    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
101       &csrInfo->\hyperlink{structX509CsrInfo_aa0f75c78d019367fab5baeb5475ac5a1}{signatureAlgo});
102    \textcolor{comment}{//Any error to report?}
103    \textcolor{keywordflow}{if}(error)
104       \textcolor{keywordflow}{return} error;
105 
106    \textcolor{comment}{//Point to the next field}
107    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
108    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
109 
110    \textcolor{comment}{//Parse Signature structure}
111    error = \hyperlink{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509ParseSignatureValue}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
112       &csrInfo->\hyperlink{structX509CsrInfo_a843a90077fa750f9eaf4027436f39d9c}{signatureValue});
113    \textcolor{comment}{//Any error to report?}
114    \textcolor{keywordflow}{if}(error)
115       \textcolor{keywordflow}{return} error;
116 
117    \textcolor{comment}{//CSR successfully parsed}
118    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
119 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__csr__parse_8c_a1c51baa55fa49223d4ec31c3f66f46b8}\label{x509__csr__parse_8c_a1c51baa55fa49223d4ec31c3f66f46b8}} 
\index{x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}!x509\+Parse\+Extension\+Request@{x509\+Parse\+Extension\+Request}}
\index{x509\+Parse\+Extension\+Request@{x509\+Parse\+Extension\+Request}!x509\+\_\+csr\+\_\+parse.\+c@{x509\+\_\+csr\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extension\+Request()}{x509ParseExtensionRequest()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extension\+Request (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509Extensions}{X509\+Extensions} $\ast$}]{extension\+Req }\end{DoxyParamCaption})}



Parse Extension\+Request attribute. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em extension\+Req} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 397 of file x509\+\_\+csr\+\_\+parse.\+c.


\begin{DoxyCode}
399 \{
400    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
401    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
402    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
403    \hyperlink{structX509Extension}{X509Extension} extension;
404 
405    \textcolor{comment}{//Debug message}
406    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ExtensionRequest...\(\backslash\)r\(\backslash\)n"});
407 
408    \textcolor{comment}{//This field is a sequence of one or more certificate extensions}
409    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
410    \textcolor{comment}{//Failed to decode ASN.1 tag?}
411    \textcolor{keywordflow}{if}(error)
412       \textcolor{keywordflow}{return} error;
413 
414    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
415    extensionReq->\hyperlink{structX509Extensions_aed67fee9d790d14c3af1381cd07a7e0a}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
416    extensionReq->\hyperlink{structX509Extensions_affa35283aa7142110b2973474b7b1965}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
417 
418    \textcolor{comment}{//Point to the first item of the sequence}
419    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
420    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
421 
422    \textcolor{comment}{//Loop through the extensions}
423    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
424    \{
425       \textcolor{comment}{//Each extension includes an OID and a value}
426       error = \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509ParseExtension}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &extension);
427       \textcolor{comment}{//Any error to report?}
428       \textcolor{keywordflow}{if}(error)
429          \textcolor{keywordflow}{return} error;
430 
431       \textcolor{comment}{//BasicConstraints extension found?}
432       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
433          \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID})))
434       \{
435          \textcolor{comment}{//Parse BasicConstraints extension}
436          error = \hyperlink{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}{x509ParseBasicConstraints}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
437             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints});
438       \}
439       \textcolor{comment}{//NameConstraints extension found?}
440       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
441          \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID})))
442       \{
443          \textcolor{comment}{//Parse NameConstraints extension}
444          error = \hyperlink{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}{x509ParseNameConstraints}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
445             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_a25c09f610754fe740c393867ee9950a9}{nameConstraints});
446       \}
447       \textcolor{comment}{//KeyUsage extension found?}
448       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
449          \hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID})))
450       \{
451          \textcolor{comment}{//Parse KeyUsage extension}
452          error = \hyperlink{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}{x509ParseKeyUsage}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
453             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage});
454       \}
455       \textcolor{comment}{//ExtendedKeyUsage extension found?}
456       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
457          \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID})))
458       \{
459          \textcolor{comment}{//Parse ExtendedKeyUsage extension}
460          error = \hyperlink{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}{x509ParseExtendedKeyUsage}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
461             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_afad9dec97dd6bba0297e67efd46ff042}{extKeyUsage});
462       \}
463       \textcolor{comment}{//SubjectAltName extension found?}
464       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
465          \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID})))
466       \{
467          \textcolor{comment}{//Parse SubjectAltName extension}
468          error = \hyperlink{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}{x509ParseSubjectAltName}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
469             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_a6a01ce6bc43517af604b8cf580ebd01d}{subjectAltName});
470       \}
471       \textcolor{comment}{//SubjectKeyIdentifier extension found?}
472       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
473          \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID})))
474       \{
475          \textcolor{comment}{//Parse SubjectKeyIdentifier extension}
476          error = \hyperlink{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}{x509ParseSubjectKeyId}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
477             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_a720e6ecde7eba80ee36a83d18a67dfd9}{subjectKeyId});
478       \}
479       \textcolor{comment}{//AuthorityKeyIdentifier extension found?}
480       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
481          \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID})))
482       \{
483          \textcolor{comment}{//Parse AuthorityKeyIdentifier extension}
484          error = \hyperlink{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}{x509ParseAuthorityKeyId}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
485             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_a3c41096ba469c33d9fed4c090f5713fb}{authKeyId});
486       \}
487       \textcolor{comment}{//NetscapeCertType extension found?}
488       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
489          \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID})))
490       \{
491          \textcolor{comment}{//Parse NetscapeCertType extension}
492          error = \hyperlink{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}{x509ParseNsCertType}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
493             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensionReq->\hyperlink{structX509Extensions_a3600340825a23651f29c87e6da57a4bb}{nsCertType});
494       \}
495       \textcolor{comment}{//Unknown extension?}
496       \textcolor{keywordflow}{else}
497       \{
498          \textcolor{comment}{//Discard current extension}
499          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
500       \}
501 
502       \textcolor{comment}{//Any parsing error?}
503       \textcolor{keywordflow}{if}(error)
504          \textcolor{keywordflow}{return} error;
505 
506       \textcolor{comment}{//Next extension}
507       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
508       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
509    \}
510 
511    \textcolor{comment}{//Successful processing}
512    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
513 \}
\end{DoxyCode}
