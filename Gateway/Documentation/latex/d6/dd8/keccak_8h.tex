\hypertarget{keccak_8h}{}\section{cyclone\+\_\+crypto/xof/keccak.h File Reference}
\label{keccak_8h}\index{cyclone\+\_\+crypto/xof/keccak.\+h@{cyclone\+\_\+crypto/xof/keccak.\+h}}


Keccak sponge function.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structKeccakContext}{Keccak\+Context}
\begin{DoxyCompactList}\small\item\em Keccak context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}{K\+E\+C\+C\+A\+K\+\_\+L}~6
\item 
\#define \hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\+\_\+lane\+\_\+t}~\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t}
\item 
\#define \hyperlink{keccak_8h_ae9823477237cce037814a248cff2d149}{K\+E\+C\+C\+A\+K\+\_\+\+R\+OL}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a},  \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})~\hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{R\+O\+L64}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
\item 
\#define \hyperlink{keccak_8h_a0a828d8a1fca2a795060a6a264797398}{K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})~\hyperlink{cpu__endian_8h_abe3c4432bb369f72cfb6b3dfd89e113a}{htole64}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\item 
\#define \hyperlink{keccak_8h_afb7f7b06da6b64e6879d9b4f033b155d}{K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})~\hyperlink{cpu__endian_8h_a19763700b12cc422823f51d1ee3b4b6b}{letoh64}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\item 
\#define \hyperlink{keccak_8h_ae237e4133eee999bdea9cbbfc897f66a}{K\+E\+C\+C\+A\+K\+\_\+W}~(1 $<$$<$ \hyperlink{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}{K\+E\+C\+C\+A\+K\+\_\+L})
\item 
\#define \hyperlink{keccak_8h_a31051b70683aa36137549f71586607f3}{K\+E\+C\+C\+A\+K\+\_\+B}~(\hyperlink{keccak_8h_ae237e4133eee999bdea9cbbfc897f66a}{K\+E\+C\+C\+A\+K\+\_\+W} $\ast$ 25)
\item 
\#define \hyperlink{keccak_8h_a317fd0868ad1885f05a1edadffc7b57e}{K\+E\+C\+C\+A\+K\+\_\+\+NR}~(12 + 2 $\ast$ \hyperlink{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}{K\+E\+C\+C\+A\+K\+\_\+L})
\item 
\#define \hyperlink{keccak_8h_ac9a78327c742d8a7b2bc0483c560c92e}{K\+E\+C\+C\+A\+K\+\_\+\+P\+AD}~0x01
\item 
\#define \hyperlink{keccak_8h_a868894d3f5012dae62f687b00fb96add}{K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD}~0x06
\item 
\#define \hyperlink{keccak_8h_a126ca60eabde38e05c916897ee14b670}{K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD}~0x1F
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{keccak_8h_a07edc15e682ac1cd05b13dca6eb22aa0}{keccak\+Init} (\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$context, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} capacity)
\begin{DoxyCompactList}\small\item\em Initialize Keccak context. \end{DoxyCompactList}\item 
void \hyperlink{keccak_8h_a21ebb9748bcf8267acd81c8a870e6868}{keccak\+Absorb} (\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$context, const void $\ast$input, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Absorb data. \end{DoxyCompactList}\item 
void \hyperlink{keccak_8h_a195e35ca81dc05a04dd7d264857658b9}{keccak\+Final} (\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} pad)
\begin{DoxyCompactList}\small\item\em Finish absorbing phase. \end{DoxyCompactList}\item 
void \hyperlink{keccak_8h_a3592f8e7403386f61f59a9d446f5e6ad}{keccak\+Squeeze} (\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Extract data from the squeezing phase. \end{DoxyCompactList}\item 
void \hyperlink{keccak_8h_a8a31781f7158b56f47f077f72ffc19e5}{keccak\+Permut\+Block} (\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Block permutation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Keccak sponge function. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{keccak_8h_a31051b70683aa36137549f71586607f3}\label{keccak_8h_a31051b70683aa36137549f71586607f3}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+B@{K\+E\+C\+C\+A\+K\+\_\+B}}
\index{K\+E\+C\+C\+A\+K\+\_\+B@{K\+E\+C\+C\+A\+K\+\_\+B}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+B}{KECCAK\_B}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+B~(\hyperlink{keccak_8h_ae237e4133eee999bdea9cbbfc897f66a}{K\+E\+C\+C\+A\+K\+\_\+W} $\ast$ 25)}



Definition at line 86 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_a0a828d8a1fca2a795060a6a264797398}\label{keccak_8h_a0a828d8a1fca2a795060a6a264797398}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE@{K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE@{K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE}{KECCAK\_HTOLE}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+H\+T\+O\+LE(\begin{DoxyParamCaption}\item[{}]{\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} }\end{DoxyParamCaption})~\hyperlink{cpu__endian_8h_abe3c4432bb369f72cfb6b3dfd89e113a}{htole64}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})}



Definition at line 76 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}\label{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+L@{K\+E\+C\+C\+A\+K\+\_\+L}}
\index{K\+E\+C\+C\+A\+K\+\_\+L@{K\+E\+C\+C\+A\+K\+\_\+L}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+L}{KECCAK\_L}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+L~6}



Definition at line 39 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}\label{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}} 
\index{keccak.\+h@{keccak.\+h}!keccak\+\_\+lane\+\_\+t@{keccak\+\_\+lane\+\_\+t}}
\index{keccak\+\_\+lane\+\_\+t@{keccak\+\_\+lane\+\_\+t}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{keccak\+\_\+lane\+\_\+t}{keccak\_lane\_t}}
{\footnotesize\ttfamily \#define keccak\+\_\+lane\+\_\+t~\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t}}



Definition at line 72 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_afb7f7b06da6b64e6879d9b4f033b155d}\label{keccak_8h_afb7f7b06da6b64e6879d9b4f033b155d}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH@{K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH@{K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH}{KECCAK\_LETOH}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+L\+E\+T\+OH(\begin{DoxyParamCaption}\item[{}]{\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} }\end{DoxyParamCaption})~\hyperlink{cpu__endian_8h_a19763700b12cc422823f51d1ee3b4b6b}{letoh64}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})}



Definition at line 78 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_a317fd0868ad1885f05a1edadffc7b57e}\label{keccak_8h_a317fd0868ad1885f05a1edadffc7b57e}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+NR@{K\+E\+C\+C\+A\+K\+\_\+\+NR}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+NR@{K\+E\+C\+C\+A\+K\+\_\+\+NR}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+NR}{KECCAK\_NR}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+NR~(12 + 2 $\ast$ \hyperlink{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}{K\+E\+C\+C\+A\+K\+\_\+L})}



Definition at line 88 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_ac9a78327c742d8a7b2bc0483c560c92e}\label{keccak_8h_ac9a78327c742d8a7b2bc0483c560c92e}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+P\+AD@{K\+E\+C\+C\+A\+K\+\_\+\+P\+AD}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+P\+AD@{K\+E\+C\+C\+A\+K\+\_\+\+P\+AD}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+P\+AD}{KECCAK\_PAD}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+P\+AD~0x01}



Definition at line 91 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_ae9823477237cce037814a248cff2d149}\label{keccak_8h_ae9823477237cce037814a248cff2d149}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+R\+OL@{K\+E\+C\+C\+A\+K\+\_\+\+R\+OL}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+R\+OL@{K\+E\+C\+C\+A\+K\+\_\+\+R\+OL}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+R\+OL}{KECCAK\_ROL}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+R\+OL(\begin{DoxyParamCaption}\item[{}]{\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a},  }\item[{}]{\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} }\end{DoxyParamCaption})~\hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{R\+O\+L64}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})}



Definition at line 74 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_a868894d3f5012dae62f687b00fb96add}\label{keccak_8h_a868894d3f5012dae62f687b00fb96add}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD@{K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD@{K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD}{KECCAK\_SHA3\_PAD}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+S\+H\+A3\+\_\+\+P\+AD~0x06}



Definition at line 93 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_ae237e4133eee999bdea9cbbfc897f66a}\label{keccak_8h_ae237e4133eee999bdea9cbbfc897f66a}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+W@{K\+E\+C\+C\+A\+K\+\_\+W}}
\index{K\+E\+C\+C\+A\+K\+\_\+W@{K\+E\+C\+C\+A\+K\+\_\+W}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+W}{KECCAK\_W}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+W~(1 $<$$<$ \hyperlink{keccak_8h_a46dbc5f2caa069c1b110adaa859fb014}{K\+E\+C\+C\+A\+K\+\_\+L})}



Definition at line 84 of file keccak.\+h.

\mbox{\Hypertarget{keccak_8h_a126ca60eabde38e05c916897ee14b670}\label{keccak_8h_a126ca60eabde38e05c916897ee14b670}} 
\index{keccak.\+h@{keccak.\+h}!K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD@{K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD}}
\index{K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD@{K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD}{KECCAK\_XOF\_PAD}}
{\footnotesize\ttfamily \#define K\+E\+C\+C\+A\+K\+\_\+\+X\+O\+F\+\_\+\+P\+AD~0x1F}



Definition at line 95 of file keccak.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{keccak_8h_a21ebb9748bcf8267acd81c8a870e6868}\label{keccak_8h_a21ebb9748bcf8267acd81c8a870e6868}} 
\index{keccak.\+h@{keccak.\+h}!keccak\+Absorb@{keccak\+Absorb}}
\index{keccak\+Absorb@{keccak\+Absorb}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{keccak\+Absorb()}{keccakAbsorb()}}
{\footnotesize\ttfamily void keccak\+Absorb (\begin{DoxyParamCaption}\item[{\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$}]{context,  }\item[{const void $\ast$}]{input,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Absorb data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Keccak context \\
\hline
\mbox{\tt in}  & {\em input} & Pointer to the buffer being hashed \\
\hline
\mbox{\tt in}  & {\em length} & Length of the buffer \\
\hline
\end{DoxyParams}


Definition at line 318 of file keccak.\+c.


\begin{DoxyCode}
319 \{
320    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
321    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
322    \hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t} *\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
323 
324    \textcolor{comment}{//Point to the state array}
325    a = (\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t} *) context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a};
326 
327    \textcolor{comment}{//Absorbing phase}
328    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
329    \{
330       \textcolor{comment}{//Limit the number of bytes to process at a time}
331       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} - context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length});
332 
333       \textcolor{comment}{//Copy the data to the buffer}
334       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structKeccakContext_a449097a035be46c58179fa9a33f81bd6}{buffer} + context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length}, input, n);
335 
336       \textcolor{comment}{//Number of data bytes that have been buffered}
337       context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
338 
339       \textcolor{comment}{//Advance the data pointer}
340       input = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) input + n;
341       \textcolor{comment}{//Remaining bytes to process}
342       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
343 
344       \textcolor{comment}{//Absorb the message block by block}
345       \textcolor{keywordflow}{if}(context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} == context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize})
346       \{
347          \textcolor{comment}{//Absorb the current block}
348          \textcolor{keywordflow}{for}(i = 0; i < context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} / \textcolor{keyword}{sizeof}(\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t}); i++)
349          \{
350             a[i] ^= \hyperlink{keccak_8h_afb7f7b06da6b64e6879d9b4f033b155d}{KECCAK\_LETOH}(context->\hyperlink{structKeccakContext_acfa449b5cd9c15e940b11703fb4cc937}{block}[i]);
351          \}
352 
353          \textcolor{comment}{//Apply block permutation function}
354          \hyperlink{keccak_8c_a8a31781f7158b56f47f077f72ffc19e5}{keccakPermutBlock}(context);
355 
356          \textcolor{comment}{//The input buffer is empty}
357          context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} = 0;
358       \}
359    \}
360 \}
\end{DoxyCode}
\mbox{\Hypertarget{keccak_8h_a195e35ca81dc05a04dd7d264857658b9}\label{keccak_8h_a195e35ca81dc05a04dd7d264857658b9}} 
\index{keccak.\+h@{keccak.\+h}!keccak\+Final@{keccak\+Final}}
\index{keccak\+Final@{keccak\+Final}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{keccak\+Final()}{keccakFinal()}}
{\footnotesize\ttfamily void keccak\+Final (\begin{DoxyParamCaption}\item[{\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{pad }\end{DoxyParamCaption})}



Finish absorbing phase. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Keccak context \\
\hline
\mbox{\tt in}  & {\em pad} & Value of the padding byte (0x01 for Keccak, 0x06 for S\+H\+A-\/3 and 0x1F for X\+OF) \\
\hline
\end{DoxyParams}


Definition at line 369 of file keccak.\+c.


\begin{DoxyCode}
370 \{
371    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
372    \textcolor{keywordtype}{size\_t} q;
373    \hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t} *\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
374 
375    \textcolor{comment}{//Point to the state array}
376    a = (\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t} *) context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a};
377 
378    \textcolor{comment}{//Compute the number of padding bytes}
379    q = context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} - context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length};
380 
381    \textcolor{comment}{//Append padding}
382    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context->\hyperlink{structKeccakContext_a449097a035be46c58179fa9a33f81bd6}{buffer} + context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length}, 0, q);
383    context->\hyperlink{structKeccakContext_a449097a035be46c58179fa9a33f81bd6}{buffer}[context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length}] |= pad;
384    context->\hyperlink{structKeccakContext_a449097a035be46c58179fa9a33f81bd6}{buffer}[context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} - 1] |= 0x80;
385 
386    \textcolor{comment}{//Absorb the final block}
387    \textcolor{keywordflow}{for}(i = 0; i < context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} / \textcolor{keyword}{sizeof}(\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t}); i++)
388    \{
389       a[i] ^= \hyperlink{keccak_8h_afb7f7b06da6b64e6879d9b4f033b155d}{KECCAK\_LETOH}(context->\hyperlink{structKeccakContext_acfa449b5cd9c15e940b11703fb4cc937}{block}[i]);
390    \}
391 
392    \textcolor{comment}{//Apply block permutation function}
393    \hyperlink{keccak_8c_a8a31781f7158b56f47f077f72ffc19e5}{keccakPermutBlock}(context);
394 
395    \textcolor{comment}{//Convert lanes to little-endian byte order}
396    \textcolor{keywordflow}{for}(i = 0; i < context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} / \textcolor{keyword}{sizeof}(\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t}); i++)
397    \{
398       a[i] = \hyperlink{keccak_8h_a0a828d8a1fca2a795060a6a264797398}{KECCAK\_HTOLE}(a[i]);
399    \}
400 
401    \textcolor{comment}{//Number of bytes available in the output buffer}
402    context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} = context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize};
403 \}
\end{DoxyCode}
\mbox{\Hypertarget{keccak_8h_a07edc15e682ac1cd05b13dca6eb22aa0}\label{keccak_8h_a07edc15e682ac1cd05b13dca6eb22aa0}} 
\index{keccak.\+h@{keccak.\+h}!keccak\+Init@{keccak\+Init}}
\index{keccak\+Init@{keccak\+Init}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{keccak\+Init()}{keccakInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} keccak\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{capacity }\end{DoxyParamCaption})}



Initialize Keccak context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Keccak context to initialize \\
\hline
\mbox{\tt in}  & {\em capacity} & Capacity of the sponge function \\
\hline
\end{DoxyParams}


Definition at line 285 of file keccak.\+c.


\begin{DoxyCode}
286 \{
287    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} rate;
288 
289    \textcolor{comment}{//Clear Keccak context}
290    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context, 0, \textcolor{keyword}{sizeof}(\hyperlink{structKeccakContext}{KeccakContext}));
291 
292    \textcolor{comment}{//The capacity cannot exceed the width of a Keccak-p permutation}
293    \textcolor{keywordflow}{if}(capacity >= \hyperlink{keccak_8h_a31051b70683aa36137549f71586607f3}{KECCAK\_B})
294       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
295 
296    \textcolor{comment}{//The rate depends on the capacity of the sponge function}
297    rate = \hyperlink{keccak_8h_a31051b70683aa36137549f71586607f3}{KECCAK\_B} - capacity;
298 
299    \textcolor{comment}{//The rate must be multiple of the lane size}
300    \textcolor{keywordflow}{if}((rate % \hyperlink{keccak_8h_ae237e4133eee999bdea9cbbfc897f66a}{KECCAK\_W}) != 0)
301       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
302 
303    \textcolor{comment}{//Save the block size, in bytes}
304    context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} = rate / 8;
305 
306    \textcolor{comment}{//Successful initialization}
307    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
308 \}
\end{DoxyCode}
\mbox{\Hypertarget{keccak_8h_a8a31781f7158b56f47f077f72ffc19e5}\label{keccak_8h_a8a31781f7158b56f47f077f72ffc19e5}} 
\index{keccak.\+h@{keccak.\+h}!keccak\+Permut\+Block@{keccak\+Permut\+Block}}
\index{keccak\+Permut\+Block@{keccak\+Permut\+Block}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{keccak\+Permut\+Block()}{keccakPermutBlock()}}
{\footnotesize\ttfamily void keccak\+Permut\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Block permutation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Keccak context \\
\hline
\end{DoxyParams}


Definition at line 473 of file keccak.\+c.


\begin{DoxyCode}
474 \{
475    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
476 
477    \textcolor{comment}{//Each round consists of a sequence of five transformations,}
478    \textcolor{comment}{//which are called the step mappings}
479    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{keccak_8h_a317fd0868ad1885f05a1edadffc7b57e}{KECCAK\_NR}; i++)
480    \{
481       \textcolor{comment}{//Apply theta step mapping}
482       \hyperlink{keccak_8c_a77c7f2850d4221b642d01ee5eec9a240}{theta}(context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a});
483       \textcolor{comment}{//Apply rho step mapping}
484       \hyperlink{keccak_8c_a26fcaaf85e4181b40d296156901d2c22}{rho}(context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a});
485       \textcolor{comment}{//Apply pi step mapping}
486       \hyperlink{keccak_8c_a2afd6eb93c8ee23f157c4d81988811cc}{pi}(context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a});
487       \textcolor{comment}{//Apply chi step mapping}
488       \hyperlink{keccak_8c_a877780b67a485dd6f45199657ed248a6}{chi}(context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a});
489       \textcolor{comment}{//Apply iota step mapping}
490       \hyperlink{keccak_8c_a9f89168df466f1595e38bcc88a94b442}{iota}(context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a}, i);
491    \}
492 \}
\end{DoxyCode}
\mbox{\Hypertarget{keccak_8h_a3592f8e7403386f61f59a9d446f5e6ad}\label{keccak_8h_a3592f8e7403386f61f59a9d446f5e6ad}} 
\index{keccak.\+h@{keccak.\+h}!keccak\+Squeeze@{keccak\+Squeeze}}
\index{keccak\+Squeeze@{keccak\+Squeeze}!keccak.\+h@{keccak.\+h}}
\subsubsection{\texorpdfstring{keccak\+Squeeze()}{keccakSqueeze()}}
{\footnotesize\ttfamily void keccak\+Squeeze (\begin{DoxyParamCaption}\item[{\hyperlink{structKeccakContext}{Keccak\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Extract data from the squeezing phase. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Keccak context \\
\hline
\mbox{\tt out}  & {\em output} & Output string \\
\hline
\mbox{\tt in}  & {\em length} & Desired output length, in bytes \\
\hline
\end{DoxyParams}


Definition at line 413 of file keccak.\+c.


\begin{DoxyCode}
414 \{
415    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
416    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
417    \hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t} *\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
418 
419    \textcolor{comment}{//Point to the state array}
420    a = (\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t} *) context->\hyperlink{structKeccakContext_a990ac688d2a22e872cdab3d880418dc4}{a};
421 
422    \textcolor{comment}{//An arbitrary number of output bits can be squeezed out of the state}
423    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
424    \{
425       \textcolor{comment}{//Check whether more data is required}
426       \textcolor{keywordflow}{if}(context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} == 0)
427       \{
428          \textcolor{comment}{//Convert lanes to host byte order}
429          \textcolor{keywordflow}{for}(i = 0; i < context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} / \textcolor{keyword}{sizeof}(\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t}); i++)
430          \{
431             a[i] = \hyperlink{keccak_8h_afb7f7b06da6b64e6879d9b4f033b155d}{KECCAK\_LETOH}(a[i]);
432          \}
433 
434          \textcolor{comment}{//Apply block permutation function}
435          \hyperlink{keccak_8c_a8a31781f7158b56f47f077f72ffc19e5}{keccakPermutBlock}(context);
436 
437          \textcolor{comment}{//Convert lanes to little-endian byte order}
438          \textcolor{keywordflow}{for}(i = 0; i < context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} / \textcolor{keyword}{sizeof}(\hyperlink{keccak_8h_ad0c0a8baa1f82943a57b85bc3dfd3abc}{keccak\_lane\_t}); i++)
439          \{
440             a[i] = \hyperlink{keccak_8h_a0a828d8a1fca2a795060a6a264797398}{KECCAK\_HTOLE}(a[i]);
441          \}
442 
443          \textcolor{comment}{//Number of bytes available in the output buffer}
444          context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} = context->\hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize};
445       \}
446 
447       \textcolor{comment}{//Compute the number of bytes to process at a time}
448       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length});
449 
450       \textcolor{comment}{//Copy the output string}
451       \textcolor{keywordflow}{if}(output != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
452       \{
453          \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(output, context->\hyperlink{structKeccakContext_a4196dad6ace978207ffd2013474e4062}{digest} + context->
      \hyperlink{structKeccakContext_ae7a33ebbbcdcc2f688293684dfac9bc5}{blockSize} -
454             context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length}, n);
455       \}
456 
457       \textcolor{comment}{//Number of bytes available in the output buffer}
458       context->\hyperlink{structKeccakContext_aa29155c613493a5da2480aad142ebc96}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
459 
460       \textcolor{comment}{//Advance the data pointer}
461       output = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) output + n;
462       \textcolor{comment}{//Number of bytes that remains to be written}
463       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
464    \}
465 \}
\end{DoxyCode}
