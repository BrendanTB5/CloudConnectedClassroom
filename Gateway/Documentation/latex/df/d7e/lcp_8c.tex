\hypertarget{lcp_8c}{}\section{cyclone\+\_\+tcp/ppp/lcp.c File Reference}
\label{lcp_8c}\index{cyclone\+\_\+tcp/ppp/lcp.\+c@{cyclone\+\_\+tcp/ppp/lcp.\+c}}


L\+CP (P\+PP Link Control Protocol)  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ppp\+\_\+fsm.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ppp\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ppp\+\_\+debug.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/lcp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ipcp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ipv6cp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/pap.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/chap.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{lcp_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~P\+P\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_ac28b8ec8de588dc9eea42c8a73c8b273}{lcp\+Open} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em L\+CP Open event. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a588713b9f40b510b652a2ef5fe564161}{lcp\+Close} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em L\+CP Close event. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_afe7b3ad105bd83710936f826eaef350b}{lcp\+Tick} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em L\+CP timer handler. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_afb2003c0d7a0aba04ebed21f6c9ed7f5}{lcp\+Process\+Packet} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Process an incoming L\+CP packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a182d3752150021cdb17484ec5e5baa1f}{lcp\+Process\+Configure\+Req} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Process Configure-\/\+Request packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a67108867085f40b1b35aa9094de2d0c8}{lcp\+Process\+Configure\+Ack} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Ack\+Packet)
\begin{DoxyCompactList}\small\item\em Process Configure-\/\+Ack packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a2866401c98e5cf9b2ef2af7f5e511980}{lcp\+Process\+Configure\+Nak} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Nak\+Packet)
\begin{DoxyCompactList}\small\item\em Process Configure-\/\+Nak packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a775c4d53736e86ff57e9045830b2d510}{lcp\+Process\+Configure\+Reject} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Rej\+Packet)
\begin{DoxyCompactList}\small\item\em Process Configure-\/\+Reject packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a1a4819b7100b8cab9ed5aa1feb176488}{lcp\+Process\+Terminate\+Req} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{Ppp\+Terminate\+Packet} $\ast$terminate\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Process Terminate-\/\+Request packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a6ce8e96ab033de7df5f87d8302b3df34}{lcp\+Process\+Terminate\+Ack} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{Ppp\+Terminate\+Packet} $\ast$terminate\+Ack\+Packet)
\begin{DoxyCompactList}\small\item\em Process Terminate-\/\+Ack packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_abc8ed84052c76b7fa8ee032b5399d1ad}{lcp\+Process\+Code\+Rej} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{Ppp\+Code\+Rej\+Packet} $\ast$code\+Rej\+Packet)
\begin{DoxyCompactList}\small\item\em Process Code-\/\+Reject packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a907e3befce4dc419f3da0795e8464be3}{lcp\+Process\+Protocol\+Rej} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{Ppp\+Protocol\+Rej\+Packet} $\ast$protocol\+Rej\+Packet)
\begin{DoxyCompactList}\small\item\em Process Protocol-\/\+Reject packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a3d2f1f11fff38515db59a1b606a537f3}{lcp\+Process\+Echo\+Req} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{Ppp\+Echo\+Packet} $\ast$echo\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Process Echo-\/\+Request packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a1867605af99cec64670ff97c4e3386fe}{lcp\+Process\+Echo\+Rep} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{Ppp\+Echo\+Packet} $\ast$echo\+Rep\+Packet)
\begin{DoxyCompactList}\small\item\em Process Echo-\/\+Reply packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a792d9fe3c7343a295dd1ddb17ba47cad}{lcp\+Process\+Discard\+Req} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a8e588707f484587f88e20e1d23c5ec02}{Ppp\+Discard\+Req\+Packet} $\ast$discard\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Process Discard-\/\+Request packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a5bd4f562b72d27676424bc80b0850918}{lcp\+Process\+Unknown\+Code} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet)
\begin{DoxyCompactList}\small\item\em Process packet with unknown code. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_abeb711fbddcd63260c596e713efe2279}{lcp\+Process\+Unknown\+Protocol} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{lcp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$information, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Process P\+PP frame with unknown protocol. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_abd9199055733e892c3966de333cf0901}{lcp\+This\+Layer\+Up} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em This-\/\+Layer-\/\+Up callback function. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_a17f4ae6647a829da1cb138ccdedcc6db}{lcp\+This\+Layer\+Down} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em This-\/\+Layer-\/\+Down callback function. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_a557deab8358c3d54507381c0e0cfd15f}{lcp\+This\+Layer\+Started} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em This-\/\+Layer-\/\+Started callback function. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_ad7ed99ba86939aa4991b3ff524d86f69}{lcp\+This\+Layer\+Finished} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em This-\/\+Layer-\/\+Finished callback function. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_ad4e7307fd7db99dde4f2746e2443bd47}{lcp\+Init\+Restart\+Count} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Initialize-\/\+Restart-\/\+Count callback function. \end{DoxyCompactList}\item 
void \hyperlink{lcp_8c_ac2774a3d44ef2882df9f0fd49031c0f4}{lcp\+Zero\+Restart\+Count} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Zero-\/\+Restart-\/\+Count callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_aef4dbd7f008e1d0e00af06d3b497d681}{lcp\+Send\+Configure\+Req} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Send-\/\+Configure-\/\+Request callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_ac28ea9130e9d415f78e77b2fa2fbf1fd}{lcp\+Send\+Configure\+Ack} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Send-\/\+Configure-\/\+Ack callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_aa101cc34e9a166d7c46c2ab157ee4113}{lcp\+Send\+Configure\+Nak} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Send-\/\+Configure-\/\+Nak callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_aa62d82bdb9679210a8c3c1caceb8fa46}{lcp\+Send\+Configure\+Rej} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$configure\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Send-\/\+Configure-\/\+Reject callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a511169a123d6b9dcda8fb0688becc8e8}{lcp\+Send\+Terminate\+Req} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Send-\/\+Terminate-\/\+Request callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a3d080f03f892946506028242120953b1}{lcp\+Send\+Terminate\+Ack} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{Ppp\+Terminate\+Packet} $\ast$terminate\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Send-\/\+Terminate-\/\+Ack callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_abd984c9a6e0443956fc7ede34fba84e8}{lcp\+Send\+Code\+Rej} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet)
\begin{DoxyCompactList}\small\item\em Send-\/\+Code-\/\+Reject callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a92a586faad8a549fe7210a04760337dd}{lcp\+Send\+Echo\+Rep} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, const \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{Ppp\+Echo\+Packet} $\ast$echo\+Req\+Packet)
\begin{DoxyCompactList}\small\item\em Send-\/\+Echo-\/\+Reply callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a8c5764c60af4de217c8e20c76c75252c}{lcp\+Parse\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$option, size\+\_\+t in\+Packet\+Len, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse L\+CP configuration option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a0495e315066dcad90d5f6e28a5dbc09b}{lcp\+Parse\+Mru\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{Lcp\+Mru\+Option} $\ast$option, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse Maximum-\/\+Receive-\/\+Unit option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_acd649622a121b928a48b90fac3974aec}{lcp\+Parse\+Accm\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{Lcp\+Accm\+Option} $\ast$option, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse Async-\/\+Control-\/\+Character-\/\+Map option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_aed8dff1e02a0424d59832e94f760f302}{lcp\+Parse\+Auth\+Protocol\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{Lcp\+Auth\+Protocol\+Option} $\ast$option, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse Authentication-\/\+Protocol option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_ad1f276c7fd227aafa68df086b8f3b966}{lcp\+Parse\+Magic\+Number\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{lcp_8h_a26b87fa524c66943dba06265631b9eaa}{Lcp\+Magic\+Number\+Option} $\ast$option, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse Magic-\/\+Number option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a1311086387f66edd281ae84fba6395e1}{lcp\+Parse\+Pfc\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{lcp_8h_aa4cf7b9b8146275624fdf4314b1c746a}{Lcp\+Pfc\+Option} $\ast$option, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse Protocol-\/\+Field-\/\+Compression option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{lcp_8c_a04761d03623139c3299b4df3a1ae5d5a}{lcp\+Parse\+Acfc\+Option} (\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$context, \hyperlink{lcp_8h_a2ad8a221c2fa53f7d38aadcc0723287b}{Lcp\+Acfc\+Option} $\ast$option, \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$out\+Packet)
\begin{DoxyCompactList}\small\item\em Parse Address-\/and-\/\+Control-\/\+Field-\/\+Compression option. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structPppCallbacks}{Ppp\+Callbacks} \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcp\+Callbacks}
\begin{DoxyCompactList}\small\item\em L\+CP F\+SM callbacks. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
L\+CP (P\+PP Link Control Protocol) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{lcp_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{lcp_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{lcp.\+c@{lcp.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~P\+P\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}



Definition at line 32 of file lcp.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{lcp_8c_a588713b9f40b510b652a2ef5fe564161}\label{lcp_8c_a588713b9f40b510b652a2ef5fe564161}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Close@{lcp\+Close}}
\index{lcp\+Close@{lcp\+Close}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Close()}{lcpClose()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Close (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



L\+CP Close event. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 103 of file lcp.\+c.


\begin{DoxyCode}
104 \{
105    \textcolor{comment}{//Debug message}
106    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Close event\(\backslash\)r\(\backslash\)n"});
107 
108    \textcolor{comment}{//The link is no longer available for traffic}
109    \hyperlink{ppp__fsm_8c_a99f9adb8cee4039fd63439bd3401b7f9}{pppCloseEvent}(context, &context->lcpFsm, &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
110 
111    \textcolor{comment}{//Successful processing}
112    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
113 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_ad4e7307fd7db99dde4f2746e2443bd47}\label{lcp_8c_ad4e7307fd7db99dde4f2746e2443bd47}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Init\+Restart\+Count@{lcp\+Init\+Restart\+Count}}
\index{lcp\+Init\+Restart\+Count@{lcp\+Init\+Restart\+Count}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Init\+Restart\+Count()}{lcpInitRestartCount()}}
{\footnotesize\ttfamily void lcp\+Init\+Restart\+Count (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{value }\end{DoxyParamCaption})}



Initialize-\/\+Restart-\/\+Count callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em value} & Restart counter value \\
\hline
\end{DoxyParams}


Definition at line 988 of file lcp.\+c.


\begin{DoxyCode}
989 \{
990    \textcolor{comment}{//Debug message}
991    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Initialize-Restart-Count callback\(\backslash\)r\(\backslash\)n"});
992 
993    \textcolor{comment}{//Initialize restart counter}
994    context->lcpFsm.restartCounter = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
995 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_ac28b8ec8de588dc9eea42c8a73c8b273}\label{lcp_8c_ac28b8ec8de588dc9eea42c8a73c8b273}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Open@{lcp\+Open}}
\index{lcp\+Open@{lcp\+Open}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Open()}{lcpOpen()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Open (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



L\+CP Open event. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 79 of file lcp.\+c.


\begin{DoxyCode}
80 \{
81    \textcolor{comment}{//Debug message}
82    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Open event\(\backslash\)r\(\backslash\)n"});
83 
84    \textcolor{comment}{//Advance to the Establish phase}
85    context->pppPhase = \hyperlink{ppp_8h_aa187b5eb62890e0b7bac9a94259c1d29a92afe8bab71c5ffcf5465d6bd1382187}{PPP\_PHASE\_ESTABLISH};
86 
87    \textcolor{comment}{//The link is administratively available for traffic}
88    \hyperlink{ppp__fsm_8c_a56a599e9081bd1ef91c41ecb597b9ba3}{pppOpenEvent}(context, &context->lcpFsm, &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
89    \textcolor{comment}{//The lower layer is ready to carry packets}
90    \hyperlink{ppp__fsm_8c_ac8891398361d78b0e913933626ebd232}{pppUpEvent}(context, &context->lcpFsm, &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
91 
92    \textcolor{comment}{//Successful processing}
93    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
94 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_acd649622a121b928a48b90fac3974aec}\label{lcp_8c_acd649622a121b928a48b90fac3974aec}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Accm\+Option@{lcp\+Parse\+Accm\+Option}}
\index{lcp\+Parse\+Accm\+Option@{lcp\+Parse\+Accm\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Accm\+Option()}{lcpParseAccmOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Accm\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{Lcp\+Accm\+Option} $\ast$}]{option,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse Async-\/\+Control-\/\+Character-\/\+Map option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Nak or Configure-\/\+Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1458 of file lcp.\+c.


\begin{DoxyCode}
1460 \{
1461    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1462 
1463    \textcolor{comment}{//Check length field}
1464    \textcolor{keywordflow}{if}(option->length == \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{LcpAccmOption}))
1465    \{
1466       \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1467       \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1468       \textcolor{comment}{//must transmit a Configure-Ack}
1469       \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1470       \{
1471          \textcolor{comment}{//Save Async-Control-Character-Map option}
1472          context->peerConfig.accm = \hyperlink{cpu__endian_8h_a22f92ea3318059b7d88dfbd98d0cbc3e}{ntohl}(option->accm);
1473 
1474          \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1475          \textcolor{comment}{//configuration options that the sender is acknowledging}
1476          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea9473d9348d1568965142a387ab8b6a49}{LCP\_OPTION\_ACCM}, (\textcolor{keywordtype}{void} *) &option->accm,
1477             option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1478       \}
1479 
1480       \textcolor{comment}{//The value is acceptable}
1481       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1482    \}
1483    \textcolor{keywordflow}{else}
1484    \{
1485       \textcolor{comment}{//Invalid length field}
1486       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1487    \}
1488 
1489    \textcolor{comment}{//Return status code}
1490    \textcolor{keywordflow}{return} error;
1491 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a04761d03623139c3299b4df3a1ae5d5a}\label{lcp_8c_a04761d03623139c3299b4df3a1ae5d5a}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Acfc\+Option@{lcp\+Parse\+Acfc\+Option}}
\index{lcp\+Parse\+Acfc\+Option@{lcp\+Parse\+Acfc\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Acfc\+Option()}{lcpParseAcfcOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Acfc\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{lcp_8h_a2ad8a221c2fa53f7d38aadcc0723287b}{Lcp\+Acfc\+Option} $\ast$}]{option,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse Address-\/and-\/\+Control-\/\+Field-\/\+Compression option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Nak or Configure-\/\+Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1735 of file lcp.\+c.


\begin{DoxyCode}
1737 \{
1738    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1739 
1740    \textcolor{comment}{//Check length field}
1741    \textcolor{keywordflow}{if}(option->length == \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_a2ad8a221c2fa53f7d38aadcc0723287b}{LcpAcfcOption}))
1742    \{
1743       \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1744       \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1745       \textcolor{comment}{//must transmit a Configure-Ack}
1746       \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1747       \{
1748          \textcolor{comment}{//Save Address-and-Control-Field-Compression option}
1749          context->peerConfig.acfc = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1750 
1751          \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1752          \textcolor{comment}{//configuration options that the sender is acknowledging}
1753          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eafb752e91b241556cea0043760425f358}{LCP\_OPTION\_ACFC}, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
1754       \}
1755 
1756       \textcolor{comment}{//The value is acceptable}
1757       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1758    \}
1759    \textcolor{keywordflow}{else}
1760    \{
1761       \textcolor{comment}{//Invalid length field}
1762       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1763    \}
1764 
1765    \textcolor{comment}{//Return status code}
1766    \textcolor{keywordflow}{return} error;
1767 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_aed8dff1e02a0424d59832e94f760f302}\label{lcp_8c_aed8dff1e02a0424d59832e94f760f302}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Auth\+Protocol\+Option@{lcp\+Parse\+Auth\+Protocol\+Option}}
\index{lcp\+Parse\+Auth\+Protocol\+Option@{lcp\+Parse\+Auth\+Protocol\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Auth\+Protocol\+Option()}{lcpParseAuthProtocolOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Auth\+Protocol\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{Lcp\+Auth\+Protocol\+Option} $\ast$}]{option,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse Authentication-\/\+Protocol option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Nak or Configure-\/\+Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1502 of file lcp.\+c.


\begin{DoxyCode}
1504 \{
1505    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1506    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}[3];
1507 
1508    \textcolor{comment}{//Assume an error condition...}
1509    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1510 
1511    \textcolor{comment}{//Check the length of the option}
1512    \textcolor{keywordflow}{if}(option->length >= \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{LcpAuthProtocolOption}))
1513    \{
1514       \textcolor{comment}{//The Authentication-Protocol option for PAP must be exactly 4 bytes}
1515       \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->protocol) == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP})
1516       \{
1517          \textcolor{keywordflow}{if}(option->length == 4)
1518             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1519       \}
1520       \textcolor{comment}{//The Authentication-Protocol option for CHAP must be exactly 5 bytes}
1521       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->protocol) == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP})
1522       \{
1523          \textcolor{keywordflow}{if}(option->length == 5)
1524             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1525       \}
1526    \}
1527 
1528    \textcolor{comment}{//Make sure the length field is valid}
1529    \textcolor{keywordflow}{if}(!error)
1530    \{
1531       \textcolor{comment}{//PAP authentication protocol?}
1532       \textcolor{keywordflow}{if}(context->settings.authProtocol & \hyperlink{ppp_8h_a9015267d0befaf7905376607634aead6a8725b1327c28c7103183935d108edfb4}{PPP\_AUTH\_PROTOCOL\_PAP} &&
1533          \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->protocol) == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP})
1534       \{
1535          \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1536          \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1537          \textcolor{comment}{//must transmit a Configure-Ack}
1538          \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1539          \{
1540             \textcolor{comment}{//Save the authentication protocol to be used}
1541             context->peerConfig.authProtocol = \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP};
1542 
1543             \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1544             \textcolor{comment}{//configuration options that the sender is acknowledging}
1545             \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, option->type, (\textcolor{keywordtype}{void} *) &option->protocol,
1546                option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1547          \}
1548 
1549          \textcolor{comment}{//The value is acceptable}
1550          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1551       \}
1552       \textcolor{comment}{//CHAP with MD5 authentication protocol?}
1553       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->settings.authProtocol & \hyperlink{ppp_8h_a9015267d0befaf7905376607634aead6a9779a00f4c08df5f7436eb2641ee6649}{PPP\_AUTH\_PROTOCOL\_CHAP\_MD5} &&
1554          \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->protocol) == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP} &&
1555          option->data[0] == \hyperlink{chap_8h_a6a6019b22b92730d95f488f291cc6dd0a16d4a6501df8b6b73b8702d02e36f1b2}{CHAP\_ALGO\_ID\_CHAP\_MD5})
1556       \{
1557          \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1558          \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1559          \textcolor{comment}{//must transmit a Configure-Ack}
1560          \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1561          \{
1562             \textcolor{comment}{//Save the authentication protocol to be used}
1563             context->peerConfig.authProtocol = \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP};
1564             context->peerConfig.authAlgo = \hyperlink{chap_8h_a6a6019b22b92730d95f488f291cc6dd0a16d4a6501df8b6b73b8702d02e36f1b2}{CHAP\_ALGO\_ID\_CHAP\_MD5};
1565 
1566             \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1567             \textcolor{comment}{//configuration options that the sender is acknowledging}
1568             \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, option->type, (\textcolor{keywordtype}{void} *) &option->protocol,
1569                option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1570          \}
1571 
1572          \textcolor{comment}{//The value is acceptable}
1573          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1574       \}
1575       \textcolor{keywordflow}{else}
1576       \{
1577          \textcolor{comment}{//PAP authentication protocol allowed?}
1578          \textcolor{keywordflow}{if}(context->settings.authProtocol & \hyperlink{ppp_8h_a9015267d0befaf7905376607634aead6a8725b1327c28c7103183935d108edfb4}{PPP\_AUTH\_PROTOCOL\_PAP})
1579          \{
1580             \textcolor{comment}{//If all configuration options are recognizable, but some values are not}
1581             \textcolor{comment}{//acceptable, then the implementation must transmit a Configure-Nak}
1582             \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == 
      \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK})
1583             \{
1584                \textcolor{comment}{//Format Authentication-Protocol option}
1585                value[0] = \hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP});
1586                value[1] = \hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP});
1587 
1588                \textcolor{comment}{//The option must be modified to a value acceptable to the}
1589                \textcolor{comment}{//Configure-Nak sender}
1590                \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL}, value,
       2);
1591             \}
1592 
1593             \textcolor{comment}{//The value is not acceptable}
1594             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca979424b1dc1779fe6193ab5161329513}{ERROR\_INVALID\_VALUE};
1595          \}
1596          \textcolor{comment}{//CHAP with MD5 authentication protocol allowed?}
1597          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->settings.authProtocol & \hyperlink{ppp_8h_a9015267d0befaf7905376607634aead6a9779a00f4c08df5f7436eb2641ee6649}{PPP\_AUTH\_PROTOCOL\_CHAP\_MD5})
1598          \{
1599             \textcolor{comment}{//If all configuration options are recognizable, but some values are not}
1600             \textcolor{comment}{//acceptable, then the implementation must transmit a Configure-Nak}
1601             \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == 
      \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK})
1602             \{
1603                \textcolor{comment}{//Format Authentication-Protocol option}
1604                value[0] = \hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP});
1605                value[1] = \hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP});
1606                value[2] = \hyperlink{chap_8h_a6a6019b22b92730d95f488f291cc6dd0a16d4a6501df8b6b73b8702d02e36f1b2}{CHAP\_ALGO\_ID\_CHAP\_MD5};
1607 
1608                \textcolor{comment}{//The option must be modified to a value acceptable to the}
1609                \textcolor{comment}{//Configure-Nak sender}
1610                \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL}, value,
       3);
1611             \}
1612 
1613             \textcolor{comment}{//The value is not acceptable}
1614             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca979424b1dc1779fe6193ab5161329513}{ERROR\_INVALID\_VALUE};
1615          \}
1616          \textcolor{keywordflow}{else}
1617          \{
1618             \textcolor{comment}{//If some configuration options received in the Configure-Request are not}
1619             \textcolor{comment}{//recognizable or not acceptable for negotiation, then the implementation}
1620             \textcolor{comment}{//must transmit a Configure-Reject}
1621             \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == 
      \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ})
1622             \{
1623                \textcolor{comment}{//The options field of the Configure-Reject packet is filled}
1624                \textcolor{comment}{//with the unrecognized options from the Configure-Request}
1625                \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, option->type, (\textcolor{keywordtype}{void} *) &option->protocol,
1626                   option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1627             \}
1628 
1629             \textcolor{comment}{//The option is not acceptable for negotiation}
1630             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
1631          \}
1632       \}
1633    \}
1634 
1635    \textcolor{comment}{//Return status code}
1636    \textcolor{keywordflow}{return} error;
1637 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_ad1f276c7fd227aafa68df086b8f3b966}\label{lcp_8c_ad1f276c7fd227aafa68df086b8f3b966}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Magic\+Number\+Option@{lcp\+Parse\+Magic\+Number\+Option}}
\index{lcp\+Parse\+Magic\+Number\+Option@{lcp\+Parse\+Magic\+Number\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Magic\+Number\+Option()}{lcpParseMagicNumberOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Magic\+Number\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{lcp_8h_a26b87fa524c66943dba06265631b9eaa}{Lcp\+Magic\+Number\+Option} $\ast$}]{option,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse Magic-\/\+Number option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Nak or Configure-\/\+Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1648 of file lcp.\+c.


\begin{DoxyCode}
1650 \{
1651    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1652 
1653    \textcolor{comment}{//Check length field}
1654    \textcolor{keywordflow}{if}(option->length == \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_a26b87fa524c66943dba06265631b9eaa}{LcpMagicNumberOption}))
1655    \{
1656       \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1657       \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1658       \textcolor{comment}{//must transmit a Configure-Ack}
1659       \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1660       \{
1661          \textcolor{comment}{//Save Magic-Number option}
1662          context->peerConfig.magicNumber = \hyperlink{cpu__endian_8h_a22f92ea3318059b7d88dfbd98d0cbc3e}{ntohl}(option->magicNumber);
1663 
1664          \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1665          \textcolor{comment}{//configuration options that the sender is acknowledging}
1666          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea59c791ebec909b03a42659d08be2bcf8}{LCP\_OPTION\_MAGIC\_NUMBER}, (\textcolor{keywordtype}{void} *) &
      option->magicNumber,
1667             option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1668       \}
1669 
1670       \textcolor{comment}{//The value is acceptable}
1671       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1672    \}
1673    \textcolor{keywordflow}{else}
1674    \{
1675       \textcolor{comment}{//Invalid length field}
1676       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1677    \}
1678 
1679    \textcolor{comment}{//Return status code}
1680    \textcolor{keywordflow}{return} error;
1681 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a0495e315066dcad90d5f6e28a5dbc09b}\label{lcp_8c_a0495e315066dcad90d5f6e28a5dbc09b}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Mru\+Option@{lcp\+Parse\+Mru\+Option}}
\index{lcp\+Parse\+Mru\+Option@{lcp\+Parse\+Mru\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Mru\+Option()}{lcpParseMruOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Mru\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{Lcp\+Mru\+Option} $\ast$}]{option,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse Maximum-\/\+Receive-\/\+Unit option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Nak or Configure-\/\+Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1392 of file lcp.\+c.


\begin{DoxyCode}
1394 \{
1395    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1396    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1397 
1398    \textcolor{comment}{//Check length field}
1399    \textcolor{keywordflow}{if}(option->length == \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{LcpMruOption}))
1400    \{
1401       \textcolor{comment}{//Check whether the option value is acceptable}
1402       \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->mru) >= \hyperlink{ppp_8h_a9d0ac532691a3188b7d66e780f25b459}{PPP\_MIN\_MRU})
1403       \{
1404          \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1405          \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1406          \textcolor{comment}{//must transmit a Configure-Ack}
1407          \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1408          \{
1409             \textcolor{comment}{//Save Maximum-Receive-Unit option}
1410             context->peerConfig.mru = \hyperlink{cpu__endian_8h_a22f92ea3318059b7d88dfbd98d0cbc3e}{ntohl}(option->mru);
1411 
1412             \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1413             \textcolor{comment}{//configuration options that the sender is acknowledging}
1414             \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU}, (\textcolor{keywordtype}{void} *) &option->mru,
1415                option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1416          \}
1417 
1418          \textcolor{comment}{//The value is acceptable}
1419          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1420       \}
1421       \textcolor{keywordflow}{else}
1422       \{
1423          \textcolor{comment}{//If all configuration options are recognizable, but some values are not}
1424          \textcolor{comment}{//acceptable, then the implementation must transmit a Configure-Nak}
1425          \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK})
1426          \{
1427             \textcolor{comment}{//Use default value}
1428             value = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(\hyperlink{ppp_8h_aafef0c86ab4acdbf353d2c64abc7d9a3}{PPP\_DEFAULT\_MRU});
1429 
1430             \textcolor{comment}{//The option must be modified to a value acceptable to the}
1431             \textcolor{comment}{//Configure-Nak sender}
1432             \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU}, &value, \textcolor{keyword}{sizeof}(
      \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}));
1433          \}
1434 
1435          \textcolor{comment}{//The value is not acceptable}
1436          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca979424b1dc1779fe6193ab5161329513}{ERROR\_INVALID\_VALUE};
1437       \}
1438    \}
1439    \textcolor{keywordflow}{else}
1440    \{
1441       \textcolor{comment}{//Invalid length field}
1442       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1443    \}
1444 
1445    \textcolor{comment}{//Return status code}
1446    \textcolor{keywordflow}{return} error;
1447 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a8c5764c60af4de217c8e20c76c75252c}\label{lcp_8c_a8c5764c60af4de217c8e20c76c75252c}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Option@{lcp\+Parse\+Option}}
\index{lcp\+Parse\+Option@{lcp\+Parse\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Option()}{lcpParseOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$}]{option,  }\item[{size\+\_\+t}]{in\+Packet\+Len,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse L\+CP configuration option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt in}  & {\em in\+Packet\+Len} & Remaining bytes to process in the incoming packet \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Ack, Nak or Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1320 of file lcp.\+c.


\begin{DoxyCode}
1322 \{
1323    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1324 
1325    \textcolor{comment}{//Malformed LCP packet?}
1326    \textcolor{keywordflow}{if}(inPacketLen < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
1327       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1328 
1329    \textcolor{comment}{//Check option length}
1330    \textcolor{keywordflow}{if}(option->length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
1331       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1332    \textcolor{keywordflow}{if}(option->length > inPacketLen)
1333       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1334 
1335    \textcolor{comment}{//Check option type}
1336    \textcolor{keywordflow}{switch}(option->type)
1337    \{
1338    \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU}:
1339       \textcolor{comment}{//Check Maximum-Receive-Unit option}
1340       error = \hyperlink{lcp_8c_a0495e315066dcad90d5f6e28a5dbc09b}{lcpParseMruOption}(context, (\hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{LcpMruOption} *) option, outPacket);
1341       \textcolor{keywordflow}{break};
1342    \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea9473d9348d1568965142a387ab8b6a49}{LCP\_OPTION\_ACCM}:
1343       \textcolor{comment}{//Check Async-Control-Character-Map option}
1344       error = \hyperlink{lcp_8c_acd649622a121b928a48b90fac3974aec}{lcpParseAccmOption}(context, (\hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{LcpAccmOption} *) option, 
      outPacket);
1345       \textcolor{keywordflow}{break};
1346    \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL}:
1347       \textcolor{comment}{//Check Authentication-Protocol option}
1348       error = \hyperlink{lcp_8c_aed8dff1e02a0424d59832e94f760f302}{lcpParseAuthProtocolOption}(context, (
      \hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{LcpAuthProtocolOption} *) option, outPacket);
1349       \textcolor{keywordflow}{break};
1350    \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea59c791ebec909b03a42659d08be2bcf8}{LCP\_OPTION\_MAGIC\_NUMBER}:
1351       \textcolor{comment}{//Check Magic-Number option}
1352       error = \hyperlink{lcp_8c_ad1f276c7fd227aafa68df086b8f3b966}{lcpParseMagicNumberOption}(context, (
      \hyperlink{lcp_8h_a26b87fa524c66943dba06265631b9eaa}{LcpMagicNumberOption} *) option, outPacket);
1353       \textcolor{keywordflow}{break};
1354    \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea3ca1ff6f4322d2ba84208db682a02e56}{LCP\_OPTION\_PFC}:
1355       \textcolor{comment}{//Check Protocol-Field-Compression option}
1356       error = \hyperlink{lcp_8c_a1311086387f66edd281ae84fba6395e1}{lcpParsePfcOption}(context, (\hyperlink{lcp_8h_aa4cf7b9b8146275624fdf4314b1c746a}{LcpPfcOption} *) option, outPacket);
1357       \textcolor{keywordflow}{break};
1358    \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eafb752e91b241556cea0043760425f358}{LCP\_OPTION\_ACFC}:
1359       \textcolor{comment}{//Check Address-and-Control-Field-Compression option}
1360       error = \hyperlink{lcp_8c_a04761d03623139c3299b4df3a1ae5d5a}{lcpParseAcfcOption}(context, (\hyperlink{lcp_8h_a2ad8a221c2fa53f7d38aadcc0723287b}{LcpAcfcOption} *) option, 
      outPacket);
1361       \textcolor{keywordflow}{break};
1362    \textcolor{keywordflow}{default}:
1363       \textcolor{comment}{//If some configuration options received in the Configure-Request are not}
1364       \textcolor{comment}{//recognizable or not acceptable for negotiation, then the implementation}
1365       \textcolor{comment}{//must transmit a Configure-Reject}
1366       \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ})
1367       \{
1368          \textcolor{comment}{//The options field of the Configure-Reject packet is filled}
1369          \textcolor{comment}{//with the unrecognized options from the Configure-Request}
1370          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, option->type, option->data,
1371             option->length - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
1372       \}
1373 
1374       \textcolor{comment}{//The option is not acceptable for negotiation}
1375       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
1376       \textcolor{keywordflow}{break};
1377    \}
1378 
1379    \textcolor{comment}{//Return status code}
1380    \textcolor{keywordflow}{return} error;
1381 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a1311086387f66edd281ae84fba6395e1}\label{lcp_8c_a1311086387f66edd281ae84fba6395e1}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Parse\+Pfc\+Option@{lcp\+Parse\+Pfc\+Option}}
\index{lcp\+Parse\+Pfc\+Option@{lcp\+Parse\+Pfc\+Option}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Parse\+Pfc\+Option()}{lcpParsePfcOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Parse\+Pfc\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{lcp_8h_aa4cf7b9b8146275624fdf4314b1c746a}{Lcp\+Pfc\+Option} $\ast$}]{option,  }\item[{\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{out\+Packet }\end{DoxyParamCaption})}



Parse Protocol-\/\+Field-\/\+Compression option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em option} & Option to be checked \\
\hline
\mbox{\tt out}  & {\em out\+Packet} & Pointer to the Configure-\/\+Nak or Configure-\/\+Reject packet \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1692 of file lcp.\+c.


\begin{DoxyCode}
1694 \{
1695    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1696 
1697    \textcolor{comment}{//Check length field}
1698    \textcolor{keywordflow}{if}(option->length == \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_aa4cf7b9b8146275624fdf4314b1c746a}{LcpPfcOption}))
1699    \{
1700       \textcolor{comment}{//If every configuration option received in the Configure-Request is}
1701       \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
1702       \textcolor{comment}{//must transmit a Configure-Ack}
1703       \textcolor{keywordflow}{if}(outPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && outPacket->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK})
1704       \{
1705          \textcolor{comment}{//Save Protocol-Field-Compression option}
1706          context->peerConfig.pfc = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1707 
1708          \textcolor{comment}{//The options field of the Configure-Ack packet contains the}
1709          \textcolor{comment}{//configuration options that the sender is acknowledging}
1710          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(outPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea3ca1ff6f4322d2ba84208db682a02e56}{LCP\_OPTION\_PFC}, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
1711       \}
1712 
1713       \textcolor{comment}{//The value is acceptable}
1714       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1715    \}
1716    \textcolor{keywordflow}{else}
1717    \{
1718       \textcolor{comment}{//Invalid length field}
1719       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1720    \}
1721 
1722    \textcolor{comment}{//Return status code}
1723    \textcolor{keywordflow}{return} error;
1724 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_abc8ed84052c76b7fa8ee032b5399d1ad}\label{lcp_8c_abc8ed84052c76b7fa8ee032b5399d1ad}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Code\+Rej@{lcp\+Process\+Code\+Rej}}
\index{lcp\+Process\+Code\+Rej@{lcp\+Process\+Code\+Rej}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Code\+Rej()}{lcpProcessCodeRej()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Code\+Rej (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{Ppp\+Code\+Rej\+Packet} $\ast$}]{code\+Rej\+Packet }\end{DoxyParamCaption})}



Process Code-\/\+Reject packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em code\+Rej\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 635 of file lcp.\+c.


\begin{DoxyCode}
637 \{
638    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
639    \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket} *packet;
640 
641    \textcolor{comment}{//Debug message}
642    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Code-Reject event\(\backslash\)r\(\backslash\)n"});
643 
644    \textcolor{comment}{//Point to the rejected packet}
645    packet = (\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket} *) codeRejPacket->rejectedPacket;
646    \textcolor{comment}{//Retrieve the length of the rejected packet}
647    length = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(codeRejPacket->length) - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket});
648 
649    \textcolor{comment}{//Make sure the length of the rejected packet is valid}
650    \textcolor{keywordflow}{if}(length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
651       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
652 
653    \textcolor{comment}{//Check whether the rejected value is acceptable or catastrophic}
654    \textcolor{keywordflow}{if}(packet->code < \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4e4279fdfcf8d81d216d58801f58d84d}{PPP\_CODE\_CONFIGURE\_REQ} ||
655       packet->code > \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a811138680a40b6a7f8eae50b2b623012}{PPP\_CODE\_DISCARD\_REQ})
656    \{
657       \textcolor{comment}{//The RXJ+ event arises when the rejected value is acceptable, such}
658       \textcolor{comment}{//as a Code-Reject of an extended code, or a Protocol-Reject of a}
659       \textcolor{comment}{//NCP. These are within the scope of normal operation}
660       \hyperlink{ppp__fsm_8c_ab0b7104a9aeef47cf8a3611f8ff0c49d}{pppRcvCodeRejEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
661    \}
662    \textcolor{keywordflow}{else}
663    \{
664       \textcolor{comment}{//The RXJ- event arises when the rejected value is catastrophic, such}
665       \textcolor{comment}{//as a Code-Reject of Configure-Request! This event communicates an}
666       \textcolor{comment}{//unrecoverable error that terminates the connection}
667       \hyperlink{ppp__fsm_8c_ab0b7104a9aeef47cf8a3611f8ff0c49d}{pppRcvCodeRejEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
668    \}
669 
670    \textcolor{comment}{//Successful processing}
671    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
672 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a67108867085f40b1b35aa9094de2d0c8}\label{lcp_8c_a67108867085f40b1b35aa9094de2d0c8}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Configure\+Ack@{lcp\+Process\+Configure\+Ack}}
\index{lcp\+Process\+Configure\+Ack@{lcp\+Process\+Configure\+Ack}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Configure\+Ack()}{lcpProcessConfigureAck()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Configure\+Ack (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Ack\+Packet }\end{DoxyParamCaption})}



Process Configure-\/\+Ack packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Ack\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 345 of file lcp.\+c.


\begin{DoxyCode}
347 \{
348    \textcolor{comment}{//Debug message}
349    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Configure-Ack event\(\backslash\)r\(\backslash\)n"});
350 
351    \textcolor{comment}{//When a packet is received with an invalid Identifier field, the}
352    \textcolor{comment}{//packet is silently discarded without affecting the automaton}
353    \textcolor{keywordflow}{if}(configureAckPacket->identifier != context->lcpFsm.identifier)
354       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
355 
356    \textcolor{comment}{//A valid Configure-Ack packet has been received from the peer}
357    \hyperlink{ppp__fsm_8c_a45bb9f242e43bee7a741258f86c9c276}{pppRcvConfigureAckEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
358 
359    \textcolor{comment}{//Successful processing}
360    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
361 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a2866401c98e5cf9b2ef2af7f5e511980}\label{lcp_8c_a2866401c98e5cf9b2ef2af7f5e511980}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Configure\+Nak@{lcp\+Process\+Configure\+Nak}}
\index{lcp\+Process\+Configure\+Nak@{lcp\+Process\+Configure\+Nak}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Configure\+Nak()}{lcpProcessConfigureNak()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Configure\+Nak (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Nak\+Packet }\end{DoxyParamCaption})}



Process Configure-\/\+Nak packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Nak\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 371 of file lcp.\+c.


\begin{DoxyCode}
373 \{
374    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
375    \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *option;
376 
377    \textcolor{comment}{//Debug message}
378    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Receive-Configure-Nak event\(\backslash\)r\(\backslash\)n"});
379 
380    \textcolor{comment}{//When a packet is received with an invalid Identifier field, the}
381    \textcolor{comment}{//packet is silently discarded without affecting the automaton}
382    \textcolor{keywordflow}{if}(configureNakPacket->identifier != context->lcpFsm.identifier)
383       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
384 
385    \textcolor{comment}{//Retrieve the length of the option list}
386    length = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(configureNakPacket->length) - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket});
387    \textcolor{comment}{//Point to the first option}
388    option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) configureNakPacket->options;
389 
390    \textcolor{comment}{//Parse configuration options}
391    \textcolor{keywordflow}{while}(length > 0)
392    \{
393       \textcolor{comment}{//Check option length}
394       \textcolor{keywordflow}{if}(option->length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
395          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
396       \textcolor{keywordflow}{if}(option->length > length)
397          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
398 
399       \textcolor{comment}{//Maximum-Receive-Unit option?}
400       \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU})
401       \{
402          \textcolor{comment}{//Cast option}
403          \hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{LcpMruOption} *mruOption = (\hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{LcpMruOption} *) option;
404 
405          \textcolor{comment}{//Check option length}
406          \textcolor{keywordflow}{if}(mruOption->length != \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_a7556764ea7b66a02aab4b19fd0543b13}{LcpMruOption}))
407             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
408 
409          \textcolor{comment}{//Save value}
410          context->localConfig.mru = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(mruOption->mru);
411          \textcolor{comment}{//Make sure the MRU is acceptable}
412          context->localConfig.mru = \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(context->localConfig.mru, \hyperlink{ppp_8h_a9d0ac532691a3188b7d66e780f25b459}{PPP\_MIN\_MRU});
413          context->localConfig.mru = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(context->localConfig.mru, \hyperlink{ppp_8h_ab0b5dbfc7b2cfd6454412f881feaad3c}{PPP\_MAX\_MRU});
414       \}
415       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea9473d9348d1568965142a387ab8b6a49}{LCP\_OPTION\_ACCM})
416       \{
417          \textcolor{comment}{//Cast option}
418          \hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{LcpAccmOption} *accmOption = (\hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{LcpAccmOption} *) option;
419 
420          \textcolor{comment}{//Check option length}
421          \textcolor{keywordflow}{if}(accmOption->length != \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_ac25c3308d2d1980157cb7abb69945adc}{LcpAccmOption}))
422             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
423 
424          \textcolor{comment}{//Save value}
425          context->localConfig.accm = \hyperlink{cpu__endian_8h_a22f92ea3318059b7d88dfbd98d0cbc3e}{ntohl}(accmOption->accm);
426       \}
427       \textcolor{comment}{//Authentication-Protocol option?}
428       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL})
429       \{
430          \textcolor{comment}{//Cast option}
431          \hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{LcpAuthProtocolOption} *authProtocolOption = (
      \hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{LcpAuthProtocolOption} *) option;
432 
433          \textcolor{comment}{//Check option length}
434          \textcolor{keywordflow}{if}(authProtocolOption->length < \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{LcpAuthProtocolOption}))
435             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
436 
437          \textcolor{comment}{//Check the value provided by the peer}
438          \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(authProtocolOption->protocol) == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP})
439          \{
440 \textcolor{preprocessor}{#if (PAP\_SUPPORT == ENABLED)}
441             \textcolor{comment}{//Manage authentication policy}
442             \textcolor{keywordflow}{if}(context->settings.authProtocol & \hyperlink{ppp_8h_a9015267d0befaf7905376607634aead6a8725b1327c28c7103183935d108edfb4}{PPP\_AUTH\_PROTOCOL\_PAP})
443             \{
444                \textcolor{comment}{//Select PAP authentication protocol}
445                context->localConfig.authProtocol = \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP};
446             \}
447 \textcolor{preprocessor}{#endif}
448          \}
449          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(authProtocolOption->protocol) == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP})
450          \{
451 \textcolor{preprocessor}{#if (CHAP\_SUPPORT == ENABLED)}
452             \textcolor{comment}{//Make sure that the length of the option is correct}
453             \textcolor{keywordflow}{if}(authProtocolOption->length > \textcolor{keyword}{sizeof}(\hyperlink{lcp_8h_af6845130d3896e25a803f605f56edb4c}{LcpAuthProtocolOption}))
454             \{
455                \textcolor{comment}{//Check the algorithm identifier}
456                \textcolor{keywordflow}{if}(authProtocolOption->data[0] == \hyperlink{chap_8h_a6a6019b22b92730d95f488f291cc6dd0a16d4a6501df8b6b73b8702d02e36f1b2}{CHAP\_ALGO\_ID\_CHAP\_MD5})
457                \{
458                   \textcolor{comment}{//Manage authentication policy}
459                   \textcolor{keywordflow}{if}(context->settings.authProtocol & \hyperlink{ppp_8h_a9015267d0befaf7905376607634aead6a9779a00f4c08df5f7436eb2641ee6649}{PPP\_AUTH\_PROTOCOL\_CHAP\_MD5})
460                   \{
461                      \textcolor{comment}{//Select CHAP with MD5 authentication protocol}
462                      context->localConfig.authProtocol = \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP};
463                      context->localConfig.authAlgo = \hyperlink{chap_8h_a6a6019b22b92730d95f488f291cc6dd0a16d4a6501df8b6b73b8702d02e36f1b2}{CHAP\_ALGO\_ID\_CHAP\_MD5};
464                   \}
465                \}
466             \}
467 \textcolor{preprocessor}{#endif}
468          \}
469       \}
470 
471       \textcolor{comment}{//Remaining bytes to process}
472       length -= option->length;
473       \textcolor{comment}{//Jump to the next option}
474       option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) option + option->length);
475    \}
476 
477    \textcolor{comment}{//A valid Configure-Nak or Configure-Reject packet has been received from the peer}
478    \hyperlink{ppp__fsm_8c_afb660738da04688fc48d49afbca2b594}{pppRcvConfigureNakEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
479 
480    \textcolor{comment}{//Successful processing}
481    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
482 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a775c4d53736e86ff57e9045830b2d510}\label{lcp_8c_a775c4d53736e86ff57e9045830b2d510}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Configure\+Reject@{lcp\+Process\+Configure\+Reject}}
\index{lcp\+Process\+Configure\+Reject@{lcp\+Process\+Configure\+Reject}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Configure\+Reject()}{lcpProcessConfigureReject()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Configure\+Reject (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Rej\+Packet }\end{DoxyParamCaption})}



Process Configure-\/\+Reject packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Rej\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 492 of file lcp.\+c.


\begin{DoxyCode}
494 \{
495    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
496    \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *option;
497 
498    \textcolor{comment}{//Debug message}
499    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Configure-Reject event\(\backslash\)r\(\backslash\)n"});
500 
501    \textcolor{comment}{//When a packet is received with an invalid Identifier field, the}
502    \textcolor{comment}{//packet is silently discarded without affecting the automaton}
503    \textcolor{keywordflow}{if}(configureRejPacket->identifier != context->lcpFsm.identifier)
504       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
505 
506    \textcolor{comment}{//Retrieve the length of the option list}
507    length = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(configureRejPacket->length) - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket});
508    \textcolor{comment}{//Point to the first option}
509    option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) configureRejPacket->options;
510 
511    \textcolor{comment}{//Parse configuration options}
512    \textcolor{keywordflow}{while}(length > 0)
513    \{
514       \textcolor{comment}{//Check option length}
515       \textcolor{keywordflow}{if}(option->length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
516          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
517       \textcolor{keywordflow}{if}(option->length > length)
518          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
519 
520       \textcolor{comment}{//Maximum-Receive-Unit option?}
521       \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU})
522       \{
523          \textcolor{comment}{//The option is not recognized by the peer}
524          context->localConfig.mruRejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
525          \textcolor{comment}{//Restore default value}
526          context->localConfig.mru = \hyperlink{ppp_8h_aafef0c86ab4acdbf353d2c64abc7d9a3}{PPP\_DEFAULT\_MRU};
527       \}
528       \textcolor{comment}{//Async-Control-Character-Map option?}
529       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea9473d9348d1568965142a387ab8b6a49}{LCP\_OPTION\_ACCM})
530       \{
531          \textcolor{comment}{//The option is not recognized by the peer}
532          context->localConfig.accmRejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
533          \textcolor{comment}{//Restore default value}
534          context->localConfig.accm = \hyperlink{ppp_8h_a9abac89eadc302964ae0f31556bf750d}{PPP\_DEFAULT\_ACCM};
535       \}
536       \textcolor{comment}{//Authentication-Protocol option?}
537       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL})
538       \{
539          \textcolor{comment}{//This is an unrecoverable error that terminates the connection}
540          \hyperlink{ppp__fsm_8c_ab0b7104a9aeef47cf8a3611f8ff0c49d}{pppRcvCodeRejEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
541          \textcolor{comment}{//Exit immediately}
542          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
543       \}
544       \textcolor{comment}{//Magic-Number option?}
545       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea59c791ebec909b03a42659d08be2bcf8}{LCP\_OPTION\_MAGIC\_NUMBER})
546       \{
547          \textcolor{comment}{//The option is not recognized by the peer}
548          context->localConfig.magicNumberRejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
549          \textcolor{comment}{//Restore default value}
550          context->localConfig.magicNumber = \hyperlink{ppp_8h_aed55c175e22cda3b4bdfa1965ecae0c8}{PPP\_DEFAULT\_MAGIC\_NUMBER};
551       \}
552       \textcolor{comment}{//Protocol-Field-Compression option?}
553       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea3ca1ff6f4322d2ba84208db682a02e56}{LCP\_OPTION\_PFC})
554       \{
555          \textcolor{comment}{//The option is not recognized by the peer}
556          context->localConfig.pfcRejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
557          \textcolor{comment}{//Restore default value}
558          context->localConfig.pfc = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
559       \}
560       \textcolor{comment}{//Address-and-Control-Field-Compression option?}
561       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type == \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eafb752e91b241556cea0043760425f358}{LCP\_OPTION\_ACFC})
562       \{
563          \textcolor{comment}{//The option is not recognized by the peer}
564          context->localConfig.acfcRejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
565          \textcolor{comment}{//Restore default value}
566          context->localConfig.acfc = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
567       \}
568 
569       \textcolor{comment}{//Remaining bytes to process}
570       length -= option->length;
571       \textcolor{comment}{//Jump to the next option}
572       option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) option + option->length);
573    \}
574 
575    \textcolor{comment}{//A valid Configure-Nak or Configure-Reject packet has been received from the peer}
576    \hyperlink{ppp__fsm_8c_afb660738da04688fc48d49afbca2b594}{pppRcvConfigureNakEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
577 
578    \textcolor{comment}{//Successful processing}
579    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
580 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a182d3752150021cdb17484ec5e5baa1f}\label{lcp_8c_a182d3752150021cdb17484ec5e5baa1f}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Configure\+Req@{lcp\+Process\+Configure\+Req}}
\index{lcp\+Process\+Configure\+Req@{lcp\+Process\+Configure\+Req}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Configure\+Req()}{lcpProcessConfigureReq()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Configure\+Req (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Req\+Packet }\end{DoxyParamCaption})}



Process Configure-\/\+Request packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Req\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 249 of file lcp.\+c.


\begin{DoxyCode}
251 \{
252    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
253    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
254    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} notRecognizable;
255    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} notAcceptable;
256    \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *option;
257 
258    \textcolor{comment}{//Debug message}
259    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Configure-Request event\(\backslash\)r\(\backslash\)n"});
260 
261    \textcolor{comment}{//Initialize variables}
262    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
263    notRecognizable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
264    notAcceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
265 
266    \textcolor{comment}{//Retrieve the length of the option list}
267    length = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(configureReqPacket->length) - \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket});
268    \textcolor{comment}{//Point to the first option}
269    option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) configureReqPacket->options;
270 
271    \textcolor{comment}{//Parse configuration options}
272    \textcolor{keywordflow}{while}(length > 0)
273    \{
274       \textcolor{comment}{//Parse current option}
275       error = \hyperlink{lcp_8c_a8c5764c60af4de217c8e20c76c75252c}{lcpParseOption}(context, option, length, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
276 
277       \textcolor{comment}{//Any error to report?}
278       \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE})
279       \{
280          \textcolor{comment}{//Option not recognizable}
281          notRecognizable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
282          \textcolor{comment}{//Catch error}
283          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
284       \}
285       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca979424b1dc1779fe6193ab5161329513}{ERROR\_INVALID\_VALUE})
286       \{
287          \textcolor{comment}{//Option not acceptable for configuration}
288          notAcceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
289          \textcolor{comment}{//Catch error}
290          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
291       \}
292       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error)
293       \{
294          \textcolor{comment}{//Malformed Configure-Request packet}
295          \textcolor{keywordflow}{break};
296       \}
297 
298       \textcolor{comment}{//Remaining bytes to process}
299       length -= option->length;
300       \textcolor{comment}{//Jump to the next option}
301       option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) option + option->length);
302    \}
303 
304    \textcolor{comment}{//Valid Configure-Request packet received from the peer?}
305    \textcolor{keywordflow}{if}(!error)
306    \{
307       \textcolor{comment}{//Check flags}
308       \textcolor{keywordflow}{if}(notRecognizable)
309       \{
310          \textcolor{comment}{//If some configuration options received in the Configure-Request are not}
311          \textcolor{comment}{//recognizable or not acceptable for negotiation, then the implementation}
312          \textcolor{comment}{//must transmit a Configure-Reject}
313          \hyperlink{ppp__fsm_8c_af1c972a74fd368977eee1df1eedac2d4}{pppRcvConfigureReqEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks},
314             configureReqPacket, \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ});
315       \}
316       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(notAcceptable)
317       \{
318          \textcolor{comment}{//If all configuration options are recognizable, but some values are not}
319          \textcolor{comment}{//acceptable, then the implementation must transmit a Configure-Nak}
320          \hyperlink{ppp__fsm_8c_af1c972a74fd368977eee1df1eedac2d4}{pppRcvConfigureReqEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks},
321             configureReqPacket, \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK});
322       \}
323       \textcolor{keywordflow}{else}
324       \{
325          \textcolor{comment}{//If every configuration option received in the Configure-Request is}
326          \textcolor{comment}{//recognizable and all values are acceptable, then the implementation}
327          \textcolor{comment}{//must transmit a Configure-Ack}
328          \hyperlink{ppp__fsm_8c_af1c972a74fd368977eee1df1eedac2d4}{pppRcvConfigureReqEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks},
329             configureReqPacket, \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK});
330       \}
331    \}
332 
333    \textcolor{comment}{//Return status code}
334    \textcolor{keywordflow}{return} error;
335 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a792d9fe3c7343a295dd1ddb17ba47cad}\label{lcp_8c_a792d9fe3c7343a295dd1ddb17ba47cad}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Discard\+Req@{lcp\+Process\+Discard\+Req}}
\index{lcp\+Process\+Discard\+Req@{lcp\+Process\+Discard\+Req}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Discard\+Req()}{lcpProcessDiscardReq()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Discard\+Req (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a8e588707f484587f88e20e1d23c5ec02}{Ppp\+Discard\+Req\+Packet} $\ast$}]{discard\+Req\+Packet }\end{DoxyParamCaption})}



Process Discard-\/\+Request packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em discard\+Req\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 788 of file lcp.\+c.


\begin{DoxyCode}
790 \{
791    \textcolor{comment}{//Debug message}
792    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Discard-Request event\(\backslash\)r\(\backslash\)n"});
793 
794    \textcolor{comment}{//The receiver must silently discard any Discard-Request that it receives}
795    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
796 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a1867605af99cec64670ff97c4e3386fe}\label{lcp_8c_a1867605af99cec64670ff97c4e3386fe}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Echo\+Rep@{lcp\+Process\+Echo\+Rep}}
\index{lcp\+Process\+Echo\+Rep@{lcp\+Process\+Echo\+Rep}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Echo\+Rep()}{lcpProcessEchoRep()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Echo\+Rep (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{Ppp\+Echo\+Packet} $\ast$}]{echo\+Rep\+Packet }\end{DoxyParamCaption})}



Process Echo-\/\+Reply packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em echo\+Rep\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 770 of file lcp.\+c.


\begin{DoxyCode}
772 \{
773    \textcolor{comment}{//Debug message}
774    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Echo-Reply event\(\backslash\)r\(\backslash\)n"});
775 
776    \textcolor{comment}{//Successful processing}
777    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
778 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a3d2f1f11fff38515db59a1b606a537f3}\label{lcp_8c_a3d2f1f11fff38515db59a1b606a537f3}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Echo\+Req@{lcp\+Process\+Echo\+Req}}
\index{lcp\+Process\+Echo\+Req@{lcp\+Process\+Echo\+Req}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Echo\+Req()}{lcpProcessEchoReq()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Echo\+Req (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{Ppp\+Echo\+Packet} $\ast$}]{echo\+Req\+Packet }\end{DoxyParamCaption})}



Process Echo-\/\+Request packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em echo\+Req\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 747 of file lcp.\+c.


\begin{DoxyCode}
749 \{
750    \textcolor{comment}{//Debug message}
751    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Echo-Request event\(\backslash\)r\(\backslash\)n"});
752 
753    \textcolor{comment}{//An Echo-Reply packet is transmitted to acknowledge the}
754    \textcolor{comment}{//reception of the Echo-Request packet}
755    \hyperlink{ppp__fsm_8c_afad7b1363587425fe776a7bd9299ef5a}{pppRcvEchoReqEvent}(context, &context->lcpFsm,
756       &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, echoReqPacket);
757 
758    \textcolor{comment}{//Successful processing}
759    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
760 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_afb2003c0d7a0aba04ebed21f6c9ed7f5}\label{lcp_8c_afb2003c0d7a0aba04ebed21f6c9ed7f5}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Packet@{lcp\+Process\+Packet}}
\index{lcp\+Process\+Packet@{lcp\+Process\+Packet}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Packet()}{lcpProcessPacket()}}
{\footnotesize\ttfamily void lcp\+Process\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Process an incoming L\+CP packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em packet} & L\+CP packet received from the peer \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}


Definition at line 155 of file lcp.\+c.


\begin{DoxyCode}
156 \{
157    \textcolor{comment}{//Ensure the length of the incoming LCP packet is valid}
158    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
159       \textcolor{keywordflow}{return};
160 
161    \textcolor{comment}{//Check the length field}
162    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
163       \textcolor{keywordflow}{return};
164    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
165       \textcolor{keywordflow}{return};
166 
167    \textcolor{comment}{//Save the length of the LCP packet}
168    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length);
169 
170    \textcolor{comment}{//Debug message}
171    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP packet received (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
172    \textcolor{comment}{//Dump LCP packet contents for debugging purpose}
173    \hyperlink{ppp__debug_8c_aebeb2591b3799b0ede290881fdd67e78}{pppDumpPacket}(packet, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
174 
175    \textcolor{comment}{//Check LCP code field}
176    \textcolor{keywordflow}{switch}(packet->code)
177    \{
178    \textcolor{comment}{//Configure-Request packet?}
179    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4e4279fdfcf8d81d216d58801f58d84d}{PPP\_CODE\_CONFIGURE\_REQ}:
180       \textcolor{comment}{//Process Configure-Request packet}
181       \hyperlink{lcp_8c_a182d3752150021cdb17484ec5e5baa1f}{lcpProcessConfigureReq}(context, (\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *) packet
      );
182       \textcolor{keywordflow}{break};
183    \textcolor{comment}{//Configure-Ack packet?}
184    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK}:
185       \textcolor{comment}{//Process Configure-Ack packet}
186       \hyperlink{lcp_8c_a67108867085f40b1b35aa9094de2d0c8}{lcpProcessConfigureAck}(context, (\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *) packet
      );
187       \textcolor{keywordflow}{break};
188    \textcolor{comment}{//Configure-Nak packet?}
189    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK}:
190       \textcolor{comment}{//Process Configure-Nak packet}
191       \hyperlink{lcp_8c_a2866401c98e5cf9b2ef2af7f5e511980}{lcpProcessConfigureNak}(context, (\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *) packet
      );
192       \textcolor{keywordflow}{break};
193    \textcolor{comment}{//Configure-Reject packet?}
194    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ}:
195       \textcolor{comment}{//Process Configure-Reject packet}
196       \hyperlink{lcp_8c_a775c4d53736e86ff57e9045830b2d510}{lcpProcessConfigureReject}(context, (
      \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *) packet);
197       \textcolor{keywordflow}{break};
198    \textcolor{comment}{//Terminate-Request packet?}
199    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a7471c8252f420930c98ee6a789724a2d}{PPP\_CODE\_TERMINATE\_REQ}:
200       \textcolor{comment}{//Process Terminate-Request packet}
201       \hyperlink{lcp_8c_a1a4819b7100b8cab9ed5aa1feb176488}{lcpProcessTerminateReq}(context, (\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket} *) packet
      );
202       \textcolor{keywordflow}{break};
203    \textcolor{comment}{//Terminate-Ack packet?}
204    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a6e7e46a330cfb72374afc3d09f275860}{PPP\_CODE\_TERMINATE\_ACK}:
205       \textcolor{comment}{//Process Terminate-Ack packet}
206       \hyperlink{lcp_8c_a6ce8e96ab033de7df5f87d8302b3df34}{lcpProcessTerminateAck}(context, (\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket} *) packet
      );
207       \textcolor{keywordflow}{break};
208    \textcolor{comment}{//Code-Reject packet?}
209    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a7635f2c8a624bbf7fcb8eea300082a7d}{PPP\_CODE\_CODE\_REJ}:
210       \textcolor{comment}{//Process Code-Reject packet}
211       \hyperlink{lcp_8c_abc8ed84052c76b7fa8ee032b5399d1ad}{lcpProcessCodeRej}(context, (\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket} *) packet);
212       \textcolor{keywordflow}{break};
213    \textcolor{comment}{//Protocol-Reject packet?}
214    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5ebc2227db3d6ca6bd25832e59fc9c04}{PPP\_CODE\_PROTOCOL\_REJ}:
215       \textcolor{comment}{//Process Protocol-Reject packet}
216       \hyperlink{lcp_8c_a907e3befce4dc419f3da0795e8464be3}{lcpProcessProtocolRej}(context, (\hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{PppProtocolRejPacket} *) 
      packet);
217       \textcolor{keywordflow}{break};
218    \textcolor{comment}{//Echo-Request packet?}
219    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188ae005fbe003b806f08c309d6d55531b6a}{PPP\_CODE\_ECHO\_REQ}:
220       \textcolor{comment}{//Process Echo-Request packet}
221       \hyperlink{lcp_8c_a3d2f1f11fff38515db59a1b606a537f3}{lcpProcessEchoReq}(context, (\hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{PppEchoPacket} *) packet);
222       \textcolor{keywordflow}{break};
223    \textcolor{comment}{//Echo-Reply packet?}
224    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4302d5cd359bf94f9af9e413db9bf929}{PPP\_CODE\_ECHO\_REP}:
225       \textcolor{comment}{//Process Echo-Reply packet}
226       \hyperlink{lcp_8c_a1867605af99cec64670ff97c4e3386fe}{lcpProcessEchoRep}(context, (\hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{PppEchoPacket} *) packet);
227       \textcolor{keywordflow}{break};
228    \textcolor{comment}{//Discard-Request packet?}
229    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a811138680a40b6a7f8eae50b2b623012}{PPP\_CODE\_DISCARD\_REQ}:
230       \textcolor{comment}{//Process Discard-Request packet}
231       \hyperlink{lcp_8c_a792d9fe3c7343a295dd1ddb17ba47cad}{lcpProcessDiscardReq}(context, (\hyperlink{ppp_8h_a8e588707f484587f88e20e1d23c5ec02}{PppDiscardReqPacket} *) packet);
232       \textcolor{keywordflow}{break};
233    \textcolor{comment}{//Unknown code field}
234    \textcolor{keywordflow}{default}:
235       \textcolor{comment}{//The packet is un-interpretable}
236       \hyperlink{lcp_8c_a5bd4f562b72d27676424bc80b0850918}{lcpProcessUnknownCode}(context, packet);
237       \textcolor{keywordflow}{break};
238    \}
239 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a907e3befce4dc419f3da0795e8464be3}\label{lcp_8c_a907e3befce4dc419f3da0795e8464be3}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Protocol\+Rej@{lcp\+Process\+Protocol\+Rej}}
\index{lcp\+Process\+Protocol\+Rej@{lcp\+Process\+Protocol\+Rej}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Protocol\+Rej()}{lcpProcessProtocolRej()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Protocol\+Rej (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{Ppp\+Protocol\+Rej\+Packet} $\ast$}]{protocol\+Rej\+Packet }\end{DoxyParamCaption})}



Process Protocol-\/\+Reject packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em protocol\+Rej\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 682 of file lcp.\+c.


\begin{DoxyCode}
684 \{
685    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
686    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol};
687 
688    \textcolor{comment}{//Debug message}
689    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Protocol-Reject event\(\backslash\)r\(\backslash\)n"});
690 
691    \textcolor{comment}{//Retrieve the length of the packet}
692    length = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(protocolRejPacket->length);
693 
694    \textcolor{comment}{//Make sure the length of the Protocol-Reject packet is valid}
695    \textcolor{keywordflow}{if}(length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{PppProtocolRejPacket}))
696       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
697 
698    \textcolor{comment}{//Convert the Rejected-Protocol field to host byte order}
699    protocol = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(protocolRejPacket->rejectedProtocol);
700 
701    \textcolor{comment}{//Check Rejected-Protocol field value}
702    \textcolor{keywordflow}{switch}(protocol)
703    \{
704    \textcolor{comment}{//LCP protocol?}
705    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP}:
706       \textcolor{comment}{//The rejected value is catastrophic. This event communicates}
707       \textcolor{comment}{//an unrecoverable error that terminates the connection}
708       \hyperlink{ppp__fsm_8c_ab0b7104a9aeef47cf8a3611f8ff0c49d}{pppRcvCodeRejEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
709       \textcolor{keywordflow}{break};
710 
711    \textcolor{comment}{//IPv4 or IPCP protocol?}
712    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ab7bc5a54ca81625aa54dbe2b3fc6ffbb}{PPP\_PROTOCOL\_IP}:
713    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2a1dbae0b4db670646438954a53f57254a}{PPP\_PROTOCOL\_IPCP}:
714       \textcolor{comment}{//The implementation must stop sending the offending packet type}
715       context->ipRejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
716       \textcolor{comment}{//This is within the scope of normal operation...}
717       \hyperlink{ppp__fsm_8c_ab0b7104a9aeef47cf8a3611f8ff0c49d}{pppRcvCodeRejEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
718       \textcolor{keywordflow}{break};
719 
720    \textcolor{comment}{//IPv6 or IPV6CP protocol?}
721    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2af1df03be97aa4a98a941e011c9fedcbd}{PPP\_PROTOCOL\_IPV6}:
722    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2abc85aaca4959631f37902c4c8f34146a}{PPP\_PROTOCOL\_IPV6CP}:
723       \textcolor{comment}{//The implementation must stop sending the offending packet type}
724       context->ipv6Rejected = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
725       \textcolor{comment}{//This is within the scope of normal operation...}
726       \hyperlink{ppp__fsm_8c_ab0b7104a9aeef47cf8a3611f8ff0c49d}{pppRcvCodeRejEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
727       \textcolor{keywordflow}{break};
728 
729    \textcolor{comment}{//Unknown protocol?}
730    \textcolor{keywordflow}{default}:
731       \textcolor{comment}{//Just for sanity's sake...}
732       \textcolor{keywordflow}{break};
733    \}
734 
735    \textcolor{comment}{//Successful processing}
736    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
737 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a6ce8e96ab033de7df5f87d8302b3df34}\label{lcp_8c_a6ce8e96ab033de7df5f87d8302b3df34}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Terminate\+Ack@{lcp\+Process\+Terminate\+Ack}}
\index{lcp\+Process\+Terminate\+Ack@{lcp\+Process\+Terminate\+Ack}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Terminate\+Ack()}{lcpProcessTerminateAck()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Terminate\+Ack (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{Ppp\+Terminate\+Packet} $\ast$}]{terminate\+Ack\+Packet }\end{DoxyParamCaption})}



Process Terminate-\/\+Ack packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em terminate\+Ack\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 612 of file lcp.\+c.


\begin{DoxyCode}
614 \{
615    \textcolor{comment}{//Debug message}
616    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Terminate-Ack event\(\backslash\)r\(\backslash\)n"});
617 
618    \textcolor{comment}{//The Terminate-Ack packet is usually a response to a Terminate-Request}
619    \textcolor{comment}{//packet. This packet may also indicate that the peer is in Closed or}
620    \textcolor{comment}{//Stopped states, and serves to re-synchronize the link configuration}
621    \hyperlink{ppp__fsm_8c_aee79a99cb18b0c11f3d8a728d59b5ca8}{pppRcvTerminateAckEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
622 
623    \textcolor{comment}{//Successful processing}
624    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
625 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a1a4819b7100b8cab9ed5aa1feb176488}\label{lcp_8c_a1a4819b7100b8cab9ed5aa1feb176488}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Terminate\+Req@{lcp\+Process\+Terminate\+Req}}
\index{lcp\+Process\+Terminate\+Req@{lcp\+Process\+Terminate\+Req}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Terminate\+Req()}{lcpProcessTerminateReq()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Terminate\+Req (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{Ppp\+Terminate\+Packet} $\ast$}]{terminate\+Req\+Packet }\end{DoxyParamCaption})}



Process Terminate-\/\+Request packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em terminate\+Req\+Packet} & Packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 590 of file lcp.\+c.


\begin{DoxyCode}
592 \{
593    \textcolor{comment}{//Debug message}
594    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Terminate-Request event\(\backslash\)r\(\backslash\)n"});
595 
596    \textcolor{comment}{//The Terminate-Request indicates the desire of the peer to close the connection}
597    \hyperlink{ppp__fsm_8c_adf41be150eb29ecad7dcb966134f5d18}{pppRcvTerminateReqEvent}(context, &context->lcpFsm,
598       &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, terminateReqPacket);
599 
600    \textcolor{comment}{//Successful processing}
601    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
602 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a5bd4f562b72d27676424bc80b0850918}\label{lcp_8c_a5bd4f562b72d27676424bc80b0850918}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Unknown\+Code@{lcp\+Process\+Unknown\+Code}}
\index{lcp\+Process\+Unknown\+Code@{lcp\+Process\+Unknown\+Code}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Unknown\+Code()}{lcpProcessUnknownCode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Unknown\+Code (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet }\end{DoxyParamCaption})}



Process packet with unknown code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em packet} & Un-\/interpretable packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 806 of file lcp.\+c.


\begin{DoxyCode}
808 \{
809    \textcolor{comment}{//Debug message}
810    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Unknown-Code event\(\backslash\)r\(\backslash\)n"});
811 
812    \textcolor{comment}{//This event occurs when an un-interpretable packet is received from}
813    \textcolor{comment}{//the peer. A Code-Reject packet is sent in response}
814    \hyperlink{ppp__fsm_8c_acc5bb9360d00a9033e5aff533cfb9f79}{pppRcvUnknownCodeEvent}(context, &context->lcpFsm, &
      \hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks}, packet);
815 
816    \textcolor{comment}{//Successful processing}
817    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
818 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_abeb711fbddcd63260c596e713efe2279}\label{lcp_8c_abeb711fbddcd63260c596e713efe2279}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Process\+Unknown\+Protocol@{lcp\+Process\+Unknown\+Protocol}}
\index{lcp\+Process\+Unknown\+Protocol@{lcp\+Process\+Unknown\+Protocol}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Process\+Unknown\+Protocol()}{lcpProcessUnknownProtocol()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Process\+Unknown\+Protocol (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{protocol,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{information,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Process P\+PP frame with unknown protocol. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em protocol} & Rejected protocol \\
\hline
\mbox{\tt in}  & {\em information} & Rejected information \\
\hline
\mbox{\tt in}  & {\em length} & Length of the rejected information \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 830 of file lcp.\+c.


\begin{DoxyCode}
832 \{
833    \textcolor{comment}{//Debug message}
834    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Receive-Unknown-Protocol event\(\backslash\)r\(\backslash\)n"});
835 
836    \textcolor{comment}{//The peer is attempting to use a protocol which is unsupported}
837    \textcolor{keywordflow}{if}(context->lcpFsm.state == \hyperlink{ppp_8h_a4cd9e6fb37bf811037ccb89b4f314bbca3a46b5a98c799ee1827ef8aa0ddc4d07}{PPP\_STATE\_9\_OPENED})
838    \{
839       \textcolor{comment}{//The Identifier field must be changed for each Protocol-Reject sent}
840       context->lcpFsm.identifier++;
841 
842       \textcolor{comment}{//If the LCP automaton is in the Opened state, then this must be}
843       \textcolor{comment}{//reported back to the peer by transmitting a Protocol-Reject}
844       \hyperlink{ppp__misc_8c_a92cf229e7981da27c9f38f0c897f0c0a}{pppSendProtocolRej}(context, context->lcpFsm.identifier,
845          \hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol}, information, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
846    \}
847 
848    \textcolor{comment}{//Successful processing}
849    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
850 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_abd984c9a6e0443956fc7ede34fba84e8}\label{lcp_8c_abd984c9a6e0443956fc7ede34fba84e8}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Code\+Rej@{lcp\+Send\+Code\+Rej}}
\index{lcp\+Send\+Code\+Rej@{lcp\+Send\+Code\+Rej}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Code\+Rej()}{lcpSendCodeRej()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Code\+Rej (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet }\end{DoxyParamCaption})}



Send-\/\+Code-\/\+Reject callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em packet} & Un-\/interpretable packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1281 of file lcp.\+c.


\begin{DoxyCode}
1282 \{
1283    \textcolor{comment}{//Debug message}
1284    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Code-Reject callback\(\backslash\)r\(\backslash\)n"});
1285 
1286    \textcolor{comment}{//The Identifier field must be changed for each Code-Reject sent}
1287    context->lcpFsm.identifier++;
1288 
1289    \textcolor{comment}{//Send Code-Reject packet}
1290    \textcolor{keywordflow}{return} \hyperlink{ppp__misc_8c_a3767bc838defa017dacfee2546714ce1}{pppSendCodeRej}(context, packet, context->lcpFsm.identifier, 
      \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
1291 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_ac28ea9130e9d415f78e77b2fa2fbf1fd}\label{lcp_8c_ac28ea9130e9d415f78e77b2fa2fbf1fd}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Configure\+Ack@{lcp\+Send\+Configure\+Ack}}
\index{lcp\+Send\+Configure\+Ack@{lcp\+Send\+Configure\+Ack}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Configure\+Ack()}{lcpSendConfigureAck()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Configure\+Ack (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Req\+Packet }\end{DoxyParamCaption})}



Send-\/\+Configure-\/\+Ack callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Req\+Packet} & Configure-\/\+Request packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1159 of file lcp.\+c.


\begin{DoxyCode}
1161 \{
1162    \textcolor{comment}{//Debug message}
1163    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Configure-Ack callback\(\backslash\)r\(\backslash\)n"});
1164 
1165    \textcolor{comment}{//Send Configure-Ack packet}
1166    \textcolor{keywordflow}{return} \hyperlink{ppp__misc_8c_a3b9675b85f9c68935fdcba6d7c0b262f}{pppSendConfigureAckNak}(context, configureReqPacket,
1167       \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP}, \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK});
1168 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_aa101cc34e9a166d7c46c2ab157ee4113}\label{lcp_8c_aa101cc34e9a166d7c46c2ab157ee4113}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Configure\+Nak@{lcp\+Send\+Configure\+Nak}}
\index{lcp\+Send\+Configure\+Nak@{lcp\+Send\+Configure\+Nak}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Configure\+Nak()}{lcpSendConfigureNak()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Configure\+Nak (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Req\+Packet }\end{DoxyParamCaption})}



Send-\/\+Configure-\/\+Nak callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Req\+Packet} & Configure-\/\+Request packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1178 of file lcp.\+c.


\begin{DoxyCode}
1180 \{
1181    \textcolor{comment}{//Debug message}
1182    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Configure-Nak callback\(\backslash\)r\(\backslash\)n"});
1183 
1184    \textcolor{comment}{//Send Configure-Nak packet}
1185    \textcolor{keywordflow}{return} \hyperlink{ppp__misc_8c_a3b9675b85f9c68935fdcba6d7c0b262f}{pppSendConfigureAckNak}(context, configureReqPacket,
1186       \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP}, \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK});
1187 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_aa62d82bdb9679210a8c3c1caceb8fa46}\label{lcp_8c_aa62d82bdb9679210a8c3c1caceb8fa46}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Configure\+Rej@{lcp\+Send\+Configure\+Rej}}
\index{lcp\+Send\+Configure\+Rej@{lcp\+Send\+Configure\+Rej}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Configure\+Rej()}{lcpSendConfigureRej()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Configure\+Rej (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{Ppp\+Configure\+Packet} $\ast$}]{configure\+Req\+Packet }\end{DoxyParamCaption})}



Send-\/\+Configure-\/\+Reject callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em configure\+Req\+Packet} & Configure-\/\+Request packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1197 of file lcp.\+c.


\begin{DoxyCode}
1199 \{
1200    \textcolor{comment}{//Debug message}
1201    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Configure-Reject callback\(\backslash\)r\(\backslash\)n"});
1202 
1203    \textcolor{comment}{//Send Configure-Reject packet}
1204    \textcolor{keywordflow}{return} \hyperlink{ppp__misc_8c_a3b9675b85f9c68935fdcba6d7c0b262f}{pppSendConfigureAckNak}(context, configureReqPacket,
1205       \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP}, \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ});
1206 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_aef4dbd7f008e1d0e00af06d3b497d681}\label{lcp_8c_aef4dbd7f008e1d0e00af06d3b497d681}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Configure\+Req@{lcp\+Send\+Configure\+Req}}
\index{lcp\+Send\+Configure\+Req@{lcp\+Send\+Configure\+Req}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Configure\+Req()}{lcpSendConfigureReq()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Configure\+Req (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Send-\/\+Configure-\/\+Request callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1024 of file lcp.\+c.


\begin{DoxyCode}
1025 \{
1026    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1027    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1028    \textcolor{keywordtype}{size\_t} \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset};
1029    \hyperlink{structNetBuffer}{NetBuffer} *buffer;
1030    \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *configureReqPacket;
1031 
1032    \textcolor{comment}{//Debug message}
1033    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Configure-Request callback\(\backslash\)r\(\backslash\)n"});
1034 
1035    \textcolor{comment}{//Allocate a buffer memory to hold the Configure-Request packet}
1036    buffer = \hyperlink{ppp_8c_a9100186e00aec050c4952fd462b035aa}{pppAllocBuffer}(\hyperlink{ppp_8h_ad62bee1d8548d875480b9ca6c8436445}{PPP\_MAX\_CONF\_REQ\_SIZE}, &offset);
1037    \textcolor{comment}{//Failed to allocate memory?}
1038    \textcolor{keywordflow}{if}(buffer == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1039       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
1040 
1041    \textcolor{comment}{//Point to the Configure-Request packet}
1042    configureReqPacket = \hyperlink{net__mem_8c_a20d30c9db547b3b2743368b589cf482b}{netBufferAt}(buffer, offset);
1043 
1044    \textcolor{comment}{//Format packet header}
1045    configureReqPacket->code = \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4e4279fdfcf8d81d216d58801f58d84d}{PPP\_CODE\_CONFIGURE\_REQ};
1046    configureReqPacket->identifier = ++context->lcpFsm.identifier;
1047    configureReqPacket->length = \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket});
1048 
1049    \textcolor{comment}{//Make sure the Maximum-Receive-Unit option has not been}
1050    \textcolor{comment}{//previously rejected}
1051    \textcolor{keywordflow}{if}(!context->localConfig.mruRejected)
1052    \{
1053       \textcolor{comment}{//Convert MRU to network byte order}
1054       \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(context->localConfig.mru);
1055       \textcolor{comment}{//Add option}
1056       \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(configureReqPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU}, &value, \textcolor{keyword}{sizeof}(
      \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}));
1057    \}
1058 
1059    \textcolor{comment}{//Make sure the Async-Control-Character-Map option has not been}
1060    \textcolor{comment}{//previously rejected}
1061    \textcolor{keywordflow}{if}(!context->localConfig.accmRejected)
1062    \{
1063       \textcolor{comment}{//Convert ACCM to network byte order}
1064       \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} value = \hyperlink{cpu__endian_8h_a63baf217625b15caa7246af75b027380}{htonl}(context->localConfig.accm);
1065       \textcolor{comment}{//Add option}
1066       \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(configureReqPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea9473d9348d1568965142a387ab8b6a49}{LCP\_OPTION\_ACCM}, &value, \textcolor{keyword}{sizeof}(
      \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}));
1067    \}
1068 
1069    \textcolor{comment}{//Make sure the Authentication-Protocol option has not been}
1070    \textcolor{comment}{//previously rejected}
1071    \textcolor{keywordflow}{if}(!context->localConfig.authProtocolRejected)
1072    \{
1073       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} value[3];
1074 
1075       \textcolor{comment}{//PAP authentication protocol?}
1076       \textcolor{keywordflow}{if}(context->localConfig.authProtocol == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP})
1077       \{
1078          \textcolor{comment}{//Format Authentication-Protocol option}
1079          value[0] = \hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP});
1080          value[1] = \hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP});
1081 
1082          \textcolor{comment}{//Add option}
1083          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(configureReqPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL}, &
      value, 2);
1084       \}
1085       \textcolor{comment}{//CHAP authentication protocol?}
1086       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->localConfig.authProtocol == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP})
1087       \{
1088          \textcolor{comment}{//Format Authentication-Protocol option}
1089          value[0] = \hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP});
1090          value[1] = \hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP});
1091          value[2] = context->localConfig.authAlgo;
1092 
1093          \textcolor{comment}{//Add option}
1094          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(configureReqPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea787d2e9d2dfb42f50f3134af91b3573b}{LCP\_OPTION\_AUTH\_PROTOCOL}, &
      value, 3);
1095       \}
1096    \}
1097 
1098    \textcolor{comment}{//Make sure the Protocol-Field-Compression option has not been}
1099    \textcolor{comment}{//previously rejected}
1100    \textcolor{keywordflow}{if}(!context->localConfig.pfcRejected)
1101    \{
1102       \textcolor{comment}{//Check whether compression of the Protocol field is supported}
1103       \textcolor{keywordflow}{if}(context->localConfig.pfc)
1104       \{
1105          \textcolor{comment}{//Add option}
1106          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(configureReqPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea3ca1ff6f4322d2ba84208db682a02e56}{LCP\_OPTION\_PFC}, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
1107       \}
1108    \}
1109 
1110    \textcolor{comment}{//Make sure the Address-and-Control-Field-Compression option has not been}
1111    \textcolor{comment}{//previously rejected}
1112    \textcolor{keywordflow}{if}(!context->localConfig.acfcRejected)
1113    \{
1114       \textcolor{comment}{//Check whether compression of the Address and Control fields is supported}
1115       \textcolor{keywordflow}{if}(context->localConfig.acfc)
1116       \{
1117          \textcolor{comment}{//Add option}
1118          \hyperlink{ppp__misc_8c_a52b0a518f20c37d08e66f8c3b437c74f}{pppAddOption}(configureReqPacket, \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eafb752e91b241556cea0043760425f358}{LCP\_OPTION\_ACFC}, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
1119       \}
1120    \}
1121 
1122    \textcolor{comment}{//Save packet length}
1123    length = configureReqPacket->length;
1124    \textcolor{comment}{//Convert length field to network byte order}
1125    configureReqPacket->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(length);
1126 
1127    \textcolor{comment}{//Adjust the length of the multi-part buffer}
1128    \hyperlink{net__mem_8c_ac0a46f396754e069dd1ee65cdc559b28}{netBufferSetLength}(buffer, offset + length);
1129 
1130    \textcolor{comment}{//Debug message}
1131    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Sending Configure-Request packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, length);
1132    \textcolor{comment}{//Dump packet contents for debugging purpose}
1133    \hyperlink{ppp__debug_8c_aebeb2591b3799b0ede290881fdd67e78}{pppDumpPacket}((\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket} *) configureReqPacket, length, 
      \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
1134 
1135    \textcolor{comment}{//Send PPP frame}
1136    error = \hyperlink{ppp_8c_aaacd84d6af940a50fa94b67324b080ea}{pppSendFrame}(context->interface, buffer, offset, 
      \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
1137 
1138    \textcolor{comment}{//The restart counter is decremented each time a Configure-Request is sent}
1139    \textcolor{keywordflow}{if}(context->lcpFsm.restartCounter > 0)
1140       context->lcpFsm.restartCounter--;
1141 
1142    \textcolor{comment}{//Save the time at which the packet was sent}
1143    context->lcpFsm.timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1144 
1145    \textcolor{comment}{//Free previously allocated memory block}
1146    \hyperlink{net__mem_8c_aa33fc4dd2a71649194052f297c707d08}{netBufferFree}(buffer);
1147    \textcolor{comment}{//Return status code}
1148    \textcolor{keywordflow}{return} error;
1149 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a92a586faad8a549fe7210a04760337dd}\label{lcp_8c_a92a586faad8a549fe7210a04760337dd}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Echo\+Rep@{lcp\+Send\+Echo\+Rep}}
\index{lcp\+Send\+Echo\+Rep@{lcp\+Send\+Echo\+Rep}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Echo\+Rep()}{lcpSendEchoRep()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Echo\+Rep (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{Ppp\+Echo\+Packet} $\ast$}]{echo\+Req\+Packet }\end{DoxyParamCaption})}



Send-\/\+Echo-\/\+Reply callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em echo\+Req\+Packet} & Echo-\/\+Request packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1301 of file lcp.\+c.


\begin{DoxyCode}
1302 \{
1303    \textcolor{comment}{//Debug message}
1304    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Echo-Reply callback\(\backslash\)r\(\backslash\)n"});
1305 
1306    \textcolor{comment}{//Send Echo-Reply packet}
1307    \textcolor{keywordflow}{return} \hyperlink{ppp__misc_8c_a4cbc7984e9160392ed3a5b80dc8e974b}{pppSendEchoRep}(context, echoReqPacket, \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
1308 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a3d080f03f892946506028242120953b1}\label{lcp_8c_a3d080f03f892946506028242120953b1}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Terminate\+Ack@{lcp\+Send\+Terminate\+Ack}}
\index{lcp\+Send\+Terminate\+Ack@{lcp\+Send\+Terminate\+Ack}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Terminate\+Ack()}{lcpSendTerminateAck()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Terminate\+Ack (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context,  }\item[{const \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{Ppp\+Terminate\+Packet} $\ast$}]{terminate\+Req\+Packet }\end{DoxyParamCaption})}



Send-\/\+Terminate-\/\+Ack callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\mbox{\tt in}  & {\em terminate\+Req\+Packet} & Terminate-\/\+Request packet received from the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1247 of file lcp.\+c.


\begin{DoxyCode}
1249 \{
1250    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{dhcpv6__common_8h_a679cc9d376a65e69d88ec3496eea7122}{identifier};
1251 
1252    \textcolor{comment}{//Debug message}
1253    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Terminate-Ack callback\(\backslash\)r\(\backslash\)n"});
1254 
1255    \textcolor{comment}{//Check whether this Terminate-Ack acknowledges the reception of a}
1256    \textcolor{comment}{//Terminate-Request packet}
1257    \textcolor{keywordflow}{if}(terminateReqPacket != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1258    \{
1259       \textcolor{comment}{//The Identifier field of the Terminate-Request is copied into the}
1260       \textcolor{comment}{//Identifier field of the Terminate-Ack packet}
1261       identifier = terminateReqPacket->identifier;
1262    \}
1263    \textcolor{keywordflow}{else}
1264    \{
1265       \textcolor{comment}{//This Terminate-Ack packet serves to synchronize the automatons}
1266       identifier = ++context->lcpFsm.identifier;
1267    \}
1268 
1269    \textcolor{comment}{//Send Terminate-Ack packet}
1270    \textcolor{keywordflow}{return} \hyperlink{ppp__misc_8c_a2bd2959558a1ea861bacb3f481a31a5f}{pppSendTerminateAck}(context, identifier, 
      \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
1271 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a511169a123d6b9dcda8fb0688becc8e8}\label{lcp_8c_a511169a123d6b9dcda8fb0688becc8e8}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Send\+Terminate\+Req@{lcp\+Send\+Terminate\+Req}}
\index{lcp\+Send\+Terminate\+Req@{lcp\+Send\+Terminate\+Req}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Send\+Terminate\+Req()}{lcpSendTerminateReq()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Send\+Terminate\+Req (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Send-\/\+Terminate-\/\+Request callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1215 of file lcp.\+c.


\begin{DoxyCode}
1216 \{
1217    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1218 
1219    \textcolor{comment}{//Debug message}
1220    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Send-Terminate-Request callback\(\backslash\)r\(\backslash\)n"});
1221 
1222    \textcolor{comment}{//On transmission, the Identifier field must be changed}
1223    context->lcpFsm.identifier++;
1224 
1225    \textcolor{comment}{//Send Terminate-Request packet}
1226    error = \hyperlink{ppp__misc_8c_aad98bd785df68e1f1067eb190bfc638a}{pppSendTerminateReq}(context, context->lcpFsm.identifier, 
      \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP});
1227 
1228    \textcolor{comment}{//The restart counter is decremented each time a Terminate-Request is sent}
1229    \textcolor{keywordflow}{if}(context->lcpFsm.restartCounter > 0)
1230       context->lcpFsm.restartCounter--;
1231 
1232    \textcolor{comment}{//Save the time at which the packet was sent}
1233    context->lcpFsm.timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1234 
1235    \textcolor{comment}{//Return status code}
1236    \textcolor{keywordflow}{return} error;
1237 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a17f4ae6647a829da1cb138ccdedcc6db}\label{lcp_8c_a17f4ae6647a829da1cb138ccdedcc6db}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+This\+Layer\+Down@{lcp\+This\+Layer\+Down}}
\index{lcp\+This\+Layer\+Down@{lcp\+This\+Layer\+Down}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+This\+Layer\+Down()}{lcpThisLayerDown()}}
{\footnotesize\ttfamily void lcp\+This\+Layer\+Down (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



This-\/\+Layer-\/\+Down callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}


Definition at line 921 of file lcp.\+c.


\begin{DoxyCode}
922 \{
923    \textcolor{comment}{//Debug message}
924    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP This-Layer-Down callback\(\backslash\)r\(\backslash\)n"});
925 
926    \textcolor{comment}{//Advance to the Terminate phase}
927    context->pppPhase = \hyperlink{ppp_8h_aa187b5eb62890e0b7bac9a94259c1d29a82c60f1daba7f36451535832580ef66b}{PPP\_PHASE\_TERMINATE};
928 
929 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
930    \textcolor{comment}{//IPCP Close event}
931    \hyperlink{ipcp_8c_a461ccc0abc7cbcf8492efd87070e7b11}{ipcpClose}(context);
932 \textcolor{preprocessor}{#endif}
933 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
934    \textcolor{comment}{//IPV6CP Close event}
935    \hyperlink{ipv6cp_8c_aa20fc6433bbfe276d8d2ea9aa0fcca78}{ipv6cpClose}(context);
936 \textcolor{preprocessor}{#endif}
937 
938 \textcolor{preprocessor}{#if (PAP\_SUPPORT == ENABLED)}
939    \textcolor{comment}{//Abort PAP authentication process}
940    \hyperlink{pap_8c_ad87d5b9ddd79993c637c460d49c1c803}{papAbortAuth}(context);
941 \textcolor{preprocessor}{#endif}
942 
943 \textcolor{preprocessor}{#if (CHAP\_SUPPORT == ENABLED)}
944    \textcolor{comment}{//Abort CHAP authentication process}
945    \hyperlink{chap_8c_a26c789cfd1cc7009e7bedcaa884dd551}{chapAbortAuth}(context);
946 \textcolor{preprocessor}{#endif}
947 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_ad7ed99ba86939aa4991b3ff524d86f69}\label{lcp_8c_ad7ed99ba86939aa4991b3ff524d86f69}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+This\+Layer\+Finished@{lcp\+This\+Layer\+Finished}}
\index{lcp\+This\+Layer\+Finished@{lcp\+This\+Layer\+Finished}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+This\+Layer\+Finished()}{lcpThisLayerFinished()}}
{\footnotesize\ttfamily void lcp\+This\+Layer\+Finished (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



This-\/\+Layer-\/\+Finished callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}


Definition at line 967 of file lcp.\+c.


\begin{DoxyCode}
968 \{
969    \textcolor{comment}{//Debug message}
970    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP This-Layer-Finished callback\(\backslash\)r\(\backslash\)n"});
971 
972    \textcolor{comment}{//The link is no longer available for traffic}
973    \hyperlink{ppp__fsm_8c_a99f9adb8cee4039fd63439bd3401b7f9}{pppCloseEvent}(context, &context->lcpFsm, &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
974    \textcolor{comment}{//The lower layer is no longer ready to carry packets}
975    \hyperlink{ppp__fsm_8c_abada68985183c2e9b998f21ebb7cbe65}{pppDownEvent}(context, &context->lcpFsm, &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
976 
977    \textcolor{comment}{//Advance to the Link Dead phase}
978    context->pppPhase = \hyperlink{ppp_8h_aa187b5eb62890e0b7bac9a94259c1d29aac297c054291557a24288cf2efa96842}{PPP\_PHASE\_DEAD};
979 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_a557deab8358c3d54507381c0e0cfd15f}\label{lcp_8c_a557deab8358c3d54507381c0e0cfd15f}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+This\+Layer\+Started@{lcp\+This\+Layer\+Started}}
\index{lcp\+This\+Layer\+Started@{lcp\+This\+Layer\+Started}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+This\+Layer\+Started()}{lcpThisLayerStarted()}}
{\footnotesize\ttfamily void lcp\+This\+Layer\+Started (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



This-\/\+Layer-\/\+Started callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}


Definition at line 955 of file lcp.\+c.


\begin{DoxyCode}
956 \{
957    \textcolor{comment}{//Debug message}
958    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP This-Layer-Started callback\(\backslash\)r\(\backslash\)n"});
959 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_abd9199055733e892c3966de333cf0901}\label{lcp_8c_abd9199055733e892c3966de333cf0901}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+This\+Layer\+Up@{lcp\+This\+Layer\+Up}}
\index{lcp\+This\+Layer\+Up@{lcp\+This\+Layer\+Up}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+This\+Layer\+Up()}{lcpThisLayerUp()}}
{\footnotesize\ttfamily void lcp\+This\+Layer\+Up (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



This-\/\+Layer-\/\+Up callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}


Definition at line 858 of file lcp.\+c.


\begin{DoxyCode}
859 \{
860    \textcolor{comment}{//Debug message}
861    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP This-Layer-Up callback\(\backslash\)r\(\backslash\)n"});
862 
863    \textcolor{comment}{//Check whether the other end of the PPP link is being authenticated}
864    \textcolor{keywordflow}{if}(context->localConfig.authProtocol != 0)
865       context->localAuthDone = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
866    \textcolor{keywordflow}{else}
867       context->localAuthDone = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
868 
869    \textcolor{comment}{//Check whether the other end of the PPP link is the authenticator}
870    \textcolor{keywordflow}{if}(context->peerConfig.authProtocol != 0)
871       context->peerAuthDone = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
872    \textcolor{keywordflow}{else}
873       context->peerAuthDone = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
874 
875 \textcolor{preprocessor}{#if (PAP\_SUPPORT == ENABLED)}
876    \textcolor{comment}{//PAP authentication required?}
877    \textcolor{keywordflow}{if}(context->localConfig.authProtocol == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP} ||
878       context->peerConfig.authProtocol == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP})
879    \{
880       \textcolor{comment}{//Advance to the Authentication phase}
881       context->pppPhase = \hyperlink{ppp_8h_aa187b5eb62890e0b7bac9a94259c1d29aab4c795f3f8509655c0e1eb0c3991104}{PPP\_PHASE\_AUTHENTICATE};
882       \textcolor{comment}{//Start PAP authentication process}
883       \hyperlink{pap_8c_a6846ac6ad519d80910968129e3b384c2}{papStartAuth}(context);
884    \}
885 \textcolor{preprocessor}{#endif}
886 \textcolor{preprocessor}{#if (CHAP\_SUPPORT == ENABLED)}
887    \textcolor{comment}{//CHAP authentication required?}
888    \textcolor{keywordflow}{if}(context->localConfig.authProtocol == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP} ||
889       context->peerConfig.authProtocol == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP})
890    \{
891       \textcolor{comment}{//Advance to the Authentication phase}
892       context->pppPhase = \hyperlink{ppp_8h_aa187b5eb62890e0b7bac9a94259c1d29aab4c795f3f8509655c0e1eb0c3991104}{PPP\_PHASE\_AUTHENTICATE};
893       \textcolor{comment}{//Start CHAP authentication process}
894       \hyperlink{chap_8c_ae9797d6803ada8fa458a2b8e74bb9e00}{chapStartAuth}(context);
895    \}
896 \textcolor{preprocessor}{#endif}
897 
898    \textcolor{comment}{//Check whether PPP authentication is complete}
899    \textcolor{keywordflow}{if}(context->localAuthDone && context->peerAuthDone)
900    \{
901       \textcolor{comment}{//Advance to the Network phase}
902       context->pppPhase = \hyperlink{ppp_8h_aa187b5eb62890e0b7bac9a94259c1d29ab0d3380ae163bae2a13438207f8f6adf}{PPP\_PHASE\_NETWORK};
903 
904 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
905       \textcolor{comment}{//IPCP Open event}
906       \hyperlink{ipcp_8c_a964305681ae4db8b15a060834fc95967}{ipcpOpen}(context);
907 \textcolor{preprocessor}{#endif}
908 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
909       \textcolor{comment}{//IPV6CP Open event}
910       \hyperlink{ipv6cp_8c_a0bef2c07fcc5f6302075dde648aec215}{ipv6cpOpen}(context);
911 \textcolor{preprocessor}{#endif}
912    \}
913 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_afe7b3ad105bd83710936f826eaef350b}\label{lcp_8c_afe7b3ad105bd83710936f826eaef350b}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Tick@{lcp\+Tick}}
\index{lcp\+Tick@{lcp\+Tick}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Tick()}{lcpTick()}}
{\footnotesize\ttfamily void lcp\+Tick (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



L\+CP timer handler. 

This routine must be periodically called by the T\+C\+P/\+IP stack to manage retransmissions


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}


Definition at line 125 of file lcp.\+c.


\begin{DoxyCode}
126 \{
127    \textcolor{comment}{//Check whether the restart timer is running}
128    \textcolor{keywordflow}{if}(context->lcpFsm.state >= \hyperlink{ppp_8h_a4cd9e6fb37bf811037ccb89b4f314bbca517046b14cdbe60860cf08c716b4b632}{PPP\_STATE\_4\_CLOSING} &&
129       context->lcpFsm.state <= \hyperlink{ppp_8h_a4cd9e6fb37bf811037ccb89b4f314bbca718e97f8e3cf50a96b56990eab353669}{PPP\_STATE\_8\_ACK\_SENT})
130    \{
131       \textcolor{comment}{//Get current time}
132       \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
133 
134       \textcolor{comment}{//Check restart timer}
135       \textcolor{keywordflow}{if}((time - context->lcpFsm.timestamp) >= \hyperlink{ppp_8h_af7ce638d012dba0785bb0767bf27027a}{PPP\_RESTART\_TIMER})
136       \{
137          \textcolor{comment}{//Debug message}
138          \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)nLCP Timeout event\(\backslash\)r\(\backslash\)n"});
139 
140          \textcolor{comment}{//The restart timer is used to retransmit Configure-Request}
141          \textcolor{comment}{//and Terminate-Request packets}
142          \hyperlink{ppp__fsm_8c_a36be609fbc1074aca17caeb84dc1430c}{pppTimeoutEvent}(context, &context->lcpFsm, &\hyperlink{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}{lcpCallbacks});
143       \}
144    \}
145 \}
\end{DoxyCode}
\mbox{\Hypertarget{lcp_8c_ac2774a3d44ef2882df9f0fd49031c0f4}\label{lcp_8c_ac2774a3d44ef2882df9f0fd49031c0f4}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Zero\+Restart\+Count@{lcp\+Zero\+Restart\+Count}}
\index{lcp\+Zero\+Restart\+Count@{lcp\+Zero\+Restart\+Count}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Zero\+Restart\+Count()}{lcpZeroRestartCount()}}
{\footnotesize\ttfamily void lcp\+Zero\+Restart\+Count (\begin{DoxyParamCaption}\item[{\hyperlink{ppp_8h_a896c00dd8ba8bad09b3f442b7aa5ad9c}{Ppp\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Zero-\/\+Restart-\/\+Count callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & P\+PP context \\
\hline
\end{DoxyParams}


Definition at line 1003 of file lcp.\+c.


\begin{DoxyCode}
1004 \{
1005    \textcolor{comment}{//Debug message}
1006    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"LCP Zero-Restart-Count callback\(\backslash\)r\(\backslash\)n"});
1007 
1008    \textcolor{comment}{//Zero restart counter}
1009    context->lcpFsm.restartCounter = 0;
1010 
1011    \textcolor{comment}{//The receiver of a Terminate-Request should wait for the peer to}
1012    \textcolor{comment}{//disconnect, and must not disconnect until at least one Restart}
1013    \textcolor{comment}{//time has passed after sending a Terminate-Ack}
1014    context->lcpFsm.timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1015 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}\label{lcp_8c_a1e1f06e2afa5743751a679c4d0a3be25}} 
\index{lcp.\+c@{lcp.\+c}!lcp\+Callbacks@{lcp\+Callbacks}}
\index{lcp\+Callbacks@{lcp\+Callbacks}!lcp.\+c@{lcp.\+c}}
\subsubsection{\texorpdfstring{lcp\+Callbacks}{lcpCallbacks}}
{\footnotesize\ttfamily const \hyperlink{structPppCallbacks}{Ppp\+Callbacks} lcp\+Callbacks}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   \hyperlink{lcp_8c_abd9199055733e892c3966de333cf0901}{lcpThisLayerUp},
   \hyperlink{lcp_8c_a17f4ae6647a829da1cb138ccdedcc6db}{lcpThisLayerDown},
   \hyperlink{lcp_8c_a557deab8358c3d54507381c0e0cfd15f}{lcpThisLayerStarted},
   \hyperlink{lcp_8c_ad7ed99ba86939aa4991b3ff524d86f69}{lcpThisLayerFinished},
   \hyperlink{lcp_8c_ad4e7307fd7db99dde4f2746e2443bd47}{lcpInitRestartCount},
   \hyperlink{lcp_8c_ac2774a3d44ef2882df9f0fd49031c0f4}{lcpZeroRestartCount},
   \hyperlink{lcp_8c_aef4dbd7f008e1d0e00af06d3b497d681}{lcpSendConfigureReq},
   \hyperlink{lcp_8c_ac28ea9130e9d415f78e77b2fa2fbf1fd}{lcpSendConfigureAck},
   \hyperlink{lcp_8c_aa101cc34e9a166d7c46c2ab157ee4113}{lcpSendConfigureNak},
   \hyperlink{lcp_8c_aa62d82bdb9679210a8c3c1caceb8fa46}{lcpSendConfigureRej},
   \hyperlink{lcp_8c_a511169a123d6b9dcda8fb0688becc8e8}{lcpSendTerminateReq},
   \hyperlink{lcp_8c_a3d080f03f892946506028242120953b1}{lcpSendTerminateAck},
   \hyperlink{lcp_8c_abd984c9a6e0443956fc7ede34fba84e8}{lcpSendCodeRej},
   \hyperlink{lcp_8c_a92a586faad8a549fe7210a04760337dd}{lcpSendEchoRep}
\}
\end{DoxyCode}


L\+CP F\+SM callbacks. 



Definition at line 54 of file lcp.\+c.

