\hypertarget{group__WifiEnableMonitorModeFn}{}\section{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode}
\label{group__WifiEnableMonitorModeFn}\index{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode@{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__WifiEnableMonitorModeFn_gac208f9fc4c1ac93d3fc3e8a81c3c2223}{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode} (\hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstr\+M2\+M\+Wifi\+Monitor\+Mode\+Ctrl} $\ast$pstr\+Mtr\+Ctrl)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Asynchronous wi-\/fi monitoring enable mode (Promiscuous mode) function. This function enables the monitoring mode, which starts transmission of the packets based on the filter information passed in as a parameter. All packets that meet the filtering criteria are passed to the application layer, to be handled by the assigned monitoring callback function. The monitoring callback function must be implemented before starting the monitoring mode, in-\/order to handle the packets received. Registering of the implemented callback function is through the callback pointer \hyperlink{group__WlanEnums_ga8d2753e870245dad4932cee1777c6eb6}{tpf\+App\+Mon\+Cb} in the \hyperlink{structtstrWifiInitParam}{tstr\+Wifi\+Init\+Param} structure. passed to \hyperlink{group__WifiInitFn_ga73c734812e844d96d860c4e93e9daf35}{m2m\+\_\+wifi\+\_\+init} function at initialization. 

\subsection{Function Documentation}
\mbox{\Hypertarget{group__WifiEnableMonitorModeFn_gac208f9fc4c1ac93d3fc3e8a81c3c2223}\label{group__WifiEnableMonitorModeFn_gac208f9fc4c1ac93d3fc3e8a81c3c2223}} 
\index{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode@{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode}!m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode@{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode}}
\index{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode@{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode}!m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode@{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode}}
\subsubsection{\texorpdfstring{m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode()}{m2m\_wifi\_enable\_monitoring\_mode()}}
{\footnotesize\ttfamily \hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} m2m\+\_\+wifi\+\_\+enable\+\_\+monitoring\+\_\+mode (\begin{DoxyParamCaption}\item[{\hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstr\+M2\+M\+Wifi\+Monitor\+Mode\+Ctrl} $\ast$}]{pstr\+Mtr\+Ctrl }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\hyperlink{m2m__wifi_8h}{third\+\_\+party/atmel/devices/wilc1000/driver/include/m2m\+\_\+wifi.\+h}$>$}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pstr\+Mtr\+Ctrl} & Pointer to \hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstr\+M2\+M\+Wifi\+Monitor\+Mode\+Ctrl} structure holding the Filtering parameters. A buffer to receive data should be set during initializing \hyperlink{group__WifiInitFn_ga73c734812e844d96d860c4e93e9daf35}{m2m\+\_\+wifi\+\_\+init()}, or \hyperlink{m2m__wifi_8c_a50cd420caaafca3ff68ec77d26ceba54}{m2m\+\_\+wifi\+\_\+set\+\_\+receive\+\_\+buffer()} \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstr\+M2\+M\+Wifi\+Monitor\+Mode\+Ctrl} \hyperlink{structtstrM2MWifiRxPacketInfo}{tstr\+M2\+M\+Wifi\+Rx\+Packet\+Info} \hyperlink{structtstrWifiInitParam}{tstr\+Wifi\+Init\+Param} \hyperlink{group__WifiDisableMonitorModeFn_ga22d6c3d2f63fceac652835994cb15594}{m2m\+\_\+wifi\+\_\+disable\+\_\+monitoring\+\_\+mode} \hyperlink{group__WifiInitFn_ga73c734812e844d96d860c4e93e9daf35}{m2m\+\_\+wifi\+\_\+init} \hyperlink{m2m__wifi_8c_a50cd420caaafca3ff68ec77d26ceba54}{m2m\+\_\+wifi\+\_\+set\+\_\+receive\+\_\+buffer} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
The function returns \hyperlink{nm__common_8h_a9ef27ba27aafdd1aa3a79d3ba2c36b8f}{M2\+M\+\_\+\+S\+U\+C\+C\+E\+SS} for successful operations and a negative value otherwise.
\end{DoxyReturn}
\hypertarget{group__WifiEnableMonitorModeFn_Example}{}\subsection{Example}\label{group__WifiEnableMonitorModeFn_Example}
The example demonstrates the main function where-\/by the monitoring enable function is called after the initialization of the driver and the packets are handled in the callback function. 
\begin{DoxyCode}
\textcolor{preprocessor}{#include "\hyperlink{m2m__wifi_8h}{m2m\_wifi.h}"}
\textcolor{preprocessor}{#include "\hyperlink{m2m__types_8h}{m2m\_types.h}"}

\textcolor{comment}{//Declare receive buffer }
\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8} gmgmt[1600];

\textcolor{comment}{//Callback functions}
\textcolor{keywordtype}{void} wifi\_cb(\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8} u8WiFiEvent, \textcolor{keywordtype}{void} * pvMsg)
\{
    ; 
\}
\textcolor{keywordtype}{void} wifi\_monitoring\_cb(\hyperlink{structtstrM2MWifiRxPacketInfo}{tstrM2MWifiRxPacketInfo} *pstrWifiRxPacket, 
      \hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8} *pu8Payload, \hyperlink{group__DataT_ga1daa745171fc6e31d942c161422a76f9}{uint16} u16PayloadSize)
\{
    \textcolor{keywordflow}{if}((\hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} != pstrWifiRxPacket) && (0 != u16PayloadSize)) \{
        \textcolor{keywordflow}{if}(\hyperlink{group__WlanEnums_gga593eb9b713b71fcc9cae6e81393b40d9a6882ae19eda3dcf275595670d49d709e}{MANAGEMENT} == pstrWifiRxPacket->\hyperlink{structtstrM2MWifiRxPacketInfo_a15d2ea32b15af3afadecf6487bb0d086}{u8FrameType}) \{
            \hyperlink{nm__common_8h_a84108eca2655e811179386a39c62acf2}{M2M\_INFO}(\textcolor{stringliteral}{"***# MGMT PACKET #***\(\backslash\)r\(\backslash\)n"});
        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{group__WlanEnums_gga593eb9b713b71fcc9cae6e81393b40d9a297b5ad5452f3000106b51741f65aee9}{DATA\_BASICTYPE} == pstrWifiRxPacket->\hyperlink{structtstrM2MWifiRxPacketInfo_a15d2ea32b15af3afadecf6487bb0d086}{u8FrameType}) \{
            \hyperlink{nm__common_8h_a84108eca2655e811179386a39c62acf2}{M2M\_INFO}(\textcolor{stringliteral}{"***# DATA PACKET #***\(\backslash\)r\(\backslash\)n"});
        \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{group__WlanEnums_gga593eb9b713b71fcc9cae6e81393b40d9af722a5faa36087c914da53ebe4711f08}{CONTROL} == pstrWifiRxPacket->\hyperlink{structtstrM2MWifiRxPacketInfo_a15d2ea32b15af3afadecf6487bb0d086}{u8FrameType}) \{
            \hyperlink{nm__common_8h_a84108eca2655e811179386a39c62acf2}{M2M\_INFO}(\textcolor{stringliteral}{"***# CONTROL PACKET #***\(\backslash\)r\(\backslash\)n"});
        \}
    \}
\}

\textcolor{keywordtype}{int} \hyperlink{demo_2microchip_2pic32mz__ef__curiosity_2wifi__http__server__demo_2src_2main_8c_ac5a1eca594b063e0d2dbccf86f96f221}{main}()
\{
    \textcolor{comment}{//Register wifi\_monitoring\_cb }
    \hyperlink{structtstrWifiInitParam}{tstrWifiInitParam} param;
    param.\hyperlink{group__WifiSetCustInfoElementFn_ga13d5fa7a0c71fd59bbf36a61923835cc}{pfAppWifiCb} = wifi\_cb;
    param.\hyperlink{group__WifiSetCustInfoElementFn_gabbd16bbde19ebb6cea2ff732b84421e8}{pfAppMonCb}  = wifi\_monitoring\_cb;
    param->\hyperlink{group__WifiSetCustInfoElementFn_gac72757e663d13b9c446735a5dca54eb1}{strEthInitParam}.\hyperlink{group__WifiSetCustInfoElementFn_gaa0328252052cf33e1ca7c695e238a067}{au8ethRcvBuf} = gmgmt;
    param->\hyperlink{group__WifiSetCustInfoElementFn_gac72757e663d13b9c446735a5dca54eb1}{strEthInitParam}.\hyperlink{group__WifiSetCustInfoElementFn_ga536ae78324c98515266f493c81da12ab}{u16ethRcvBufSize} = \textcolor{keyword}{sizeof}(gmgmt);
    
    \hyperlink{group__NmBspInitFn_ga91533a50cf3da832110a746b4a57789e}{nm\_bsp\_init}();
    
    \textcolor{keywordflow}{if}(!\hyperlink{group__WifiInitFn_ga73c734812e844d96d860c4e93e9daf35}{m2m\_wifi\_init}(&param)) \{
        \textcolor{comment}{//Enable Monitor Mode with filter to receive all data frames on channel 1}
        \hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstrM2MWifiMonitorModeCtrl}  strMonitorCtrl = \{0\};
        strMonitorCtrl.\hyperlink{structtstrM2MWifiMonitorModeCtrl_aa171fa84ecfab4b966e935825f1f23f6}{u8ChannelID}      = 1;
        strMonitorCtrl.\hyperlink{structtstrM2MWifiMonitorModeCtrl_a1302bd34bc71c93586443e1bfa0e5b20}{u8FrameType}      = \hyperlink{group__WlanEnums_gga593eb9b713b71fcc9cae6e81393b40d9a297b5ad5452f3000106b51741f65aee9}{DATA\_BASICTYPE};
        strMonitorCtrl.\hyperlink{structtstrM2MWifiMonitorModeCtrl_a98f14e2b9c2aa0288517362886b9608a}{u8FrameSubtype}   = 
      \hyperlink{group__WlanDefines_ga63b89cf8396db0c50077e1fec7f3d0ed}{M2M\_WIFI\_FRAME\_SUB\_TYPE\_ANY}; \textcolor{comment}{//Receive any subtype of data frame}
        \hyperlink{group__WifiEnableMonitorModeFn_gac208f9fc4c1ac93d3fc3e8a81c3c2223}{m2m\_wifi\_enable\_monitoring\_mode}(&strMonitorCtrl);
        
        \textcolor{keywordflow}{while}(1) \{
            \hyperlink{group__WifiHandleEventsFn_ga461a4edc057cec8c00cf124a07aa3b02}{m2m\_wifi\_handle\_events}(\hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
        \}
    \}
    \textcolor{keywordflow}{return} 0;
\}
\end{DoxyCode}
 

Definition at line 808 of file m2m\+\_\+wifi.\+c.


\begin{DoxyCode}
809 \{
810     \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8}  s8Ret = -1;
811     \hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstrM2MWifiMonitorModeCtrl}* pstrTmpMonitorModeCtrl = &guCtrlStruct.
      strM2MWifiMonitorModeCtrl;
812     \hyperlink{nm__common_8h_a62b30b611dfcc58e190254d1f663470a}{m2m\_memcpy}((\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*)pstrTmpMonitorModeCtrl, (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*)pstrMtrCtrl, \textcolor{keyword}{sizeof}(
      \hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstrM2MWifiMonitorModeCtrl}));
813     \textcolor{keywordflow}{if}(\textcolor{comment}{/*(pstrMtrCtrl->u8ChannelID >= M2M\_WIFI\_CH\_1) &&*/} (pstrMtrCtrl->u8ChannelID <= 
      \hyperlink{group__WlanEnums_gga2a91dd671e2672dba1a7ed45230f3a99a6421cfaf77ed29e91106d39e69e4a970}{M2M\_WIFI\_CH\_14}))
814     \{
815         s8Ret = \hyperlink{m2m__hif_8c_a13ba8ad11b2ac39516ca787386d16ce0}{hif\_send}(\hyperlink{nm__common_8h_a9ab02eb1aea02a75c3f5aade4eef1276aeb9a7d57324ba4b8a6c2a5f46dd499c2}{M2M\_REQ\_GRP\_WIFI}, (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8})
      \hyperlink{group__WlanEnums_gga064de09dec1d5e88ed8d075fa40f57dea1a121c4c7263d80c2c02c4b87bb3aa0f}{M2M\_WIFI\_REQ\_ENABLE\_MONITORING} | (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8})
      \hyperlink{nm__common_8h_a8f14623395b4e817613140afdf87fe6fa4ba55ee3c10f0b8175bba12f4b39a499}{M2M\_REQ\_DATA\_PKT},
816             (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*)pstrTmpMonitorModeCtrl, \textcolor{keyword}{sizeof}(
      \hyperlink{structtstrM2MWifiMonitorModeCtrl}{tstrM2MWifiMonitorModeCtrl}), \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0,0);
817     \}
818     \textcolor{keywordflow}{return} s8Ret;
819 \}
\end{DoxyCode}
