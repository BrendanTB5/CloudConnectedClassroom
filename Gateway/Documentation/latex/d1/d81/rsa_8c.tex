\hypertarget{rsa_8c}{}\section{cyclone\+\_\+crypto/pkc/rsa.c File Reference}
\label{rsa_8c}\index{cyclone\+\_\+crypto/pkc/rsa.\+c@{cyclone\+\_\+crypto/pkc/rsa.\+c}}


R\+SA public-\/key cryptography standard.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mac/hmac.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkc/rsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mpi/mpi.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{rsa_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{rsa_8c_af3d3a1f0ce23e006da06325cc37c4063}{rsa\+Init\+Public\+Key} (\hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key)
\begin{DoxyCompactList}\small\item\em Initialize an R\+SA public key. \end{DoxyCompactList}\item 
void \hyperlink{rsa_8c_a6dc1711d56454b2a6e565199509d884e}{rsa\+Free\+Public\+Key} (\hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key)
\begin{DoxyCompactList}\small\item\em Release an R\+SA public key. \end{DoxyCompactList}\item 
void \hyperlink{rsa_8c_ad454d9bc34f7d9fa5717180707365e69}{rsa\+Init\+Private\+Key} (\hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key)
\begin{DoxyCompactList}\small\item\em Initialize an R\+SA private key. \end{DoxyCompactList}\item 
void \hyperlink{rsa_8c_a14ee0338e3149b934552c40b97c8f096}{rsa\+Free\+Private\+Key} (\hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key)
\begin{DoxyCompactList}\small\item\em Release an R\+SA private key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a1c7acb4138d300d842d80320df4a0cde}{rsaes\+Pkcs1v15\+Encrypt} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t message\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ciphertext, size\+\_\+t $\ast$ciphertext\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+E\+S-\/\+P\+K\+C\+S1-\/v1\+\_\+5 encryption operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a2441cef0529ca8ebb763f566877fc37e}{rsaes\+Pkcs1v15\+Decrypt} (const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ciphertext, size\+\_\+t ciphertext\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t message\+Size, size\+\_\+t $\ast$message\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+E\+S-\/\+P\+K\+C\+S1-\/v1\+\_\+5 decryption operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a8efc8557a0154f30783e8937a5f3ee46}{rsaes\+Oaep\+Encrypt} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$label, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t message\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ciphertext, size\+\_\+t $\ast$ciphertext\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+E\+S-\/\+O\+A\+EP encryption operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_aa026e5906d0de64892b89a3b0125fa38}{rsaes\+Oaep\+Decrypt} (const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$label, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ciphertext, size\+\_\+t ciphertext\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t message\+Size, size\+\_\+t $\ast$message\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+E\+S-\/\+O\+A\+EP decryption operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_aa11231857578f3d094759dd7789015b8}{rsassa\+Pkcs1v15\+Sign} (const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, size\+\_\+t $\ast$signature\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+S\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 signature generation operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_ac8bc3701e41ec2201abf77a280dfbc01}{rsassa\+Pkcs1v15\+Verify} (const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, size\+\_\+t signature\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+S\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 signature verification operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a2bc9405e58c8ce947d411cd9751e96b2}{rsassa\+Pss\+Sign} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, size\+\_\+t salt\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, size\+\_\+t $\ast$signature\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+S\+S\+A-\/\+P\+SS signature generation operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a353c0daced94ff0a95ec1067f6f9048c}{rsassa\+Pss\+Verify} (const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, size\+\_\+t salt\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, size\+\_\+t signature\+Len)
\begin{DoxyCompactList}\small\item\em R\+S\+A\+S\+S\+A-\/\+P\+SS signature verification operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_aa747fb394b77511f47268bfb77e90e94}{rsaep} (const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\begin{DoxyCompactList}\small\item\em R\+SA encryption primitive. \end{DoxyCompactList}\item 
\+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a5288ac4218c0e6f3cc00da6d0ddf21c4}{rsadp} (const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c}, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m})
\begin{DoxyCompactList}\small\item\em R\+SA decryption primitive. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a36efdd5187b817ffb4a5c1eebcdec68c}{rsasp1} (const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$key, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s})
\begin{DoxyCompactList}\small\item\em R\+SA signature primitive. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_ae3bd572570d3ad77ce2cf5169f8b4417}{rsavp1} (const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$key, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m})
\begin{DoxyCompactList}\small\item\em R\+SA verification primitive. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a1b04d815975669a6b26f8b68847ce029}{eme\+Pkcs1v15\+Encode} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t message\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, size\+\_\+t \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k})
\begin{DoxyCompactList}\small\item\em E\+M\+E-\/\+P\+K\+C\+S1-\/v1\+\_\+5 encoding operation. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{rsa_8c_a4476eea5c60b091fbac68c4d29dbbbbb}{eme\+Pkcs1v15\+Decode} (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, size\+\_\+t \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k}, size\+\_\+t $\ast$message\+Len)
\begin{DoxyCompactList}\small\item\em E\+M\+E-\/\+P\+K\+C\+S1-\/v1\+\_\+5 decoding operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a68d67e7b81685fbd077f87b68a16b0ea}{eme\+Oaep\+Encode} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$label, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t message\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, size\+\_\+t \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k})
\begin{DoxyCompactList}\small\item\em E\+M\+E-\/\+O\+A\+EP encoding operation. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{rsa_8c_a5e002e31dd695eb54953f35b429a2e0b}{eme\+Oaep\+Decode} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$label, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, size\+\_\+t \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k}, size\+\_\+t $\ast$message\+Len)
\begin{DoxyCompactList}\small\item\em E\+M\+E-\/\+O\+A\+EP decoding operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a7eec30cb6f589d520b380bc37ed655f0}{emsa\+Pkcs1v15\+Encode} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, size\+\_\+t em\+Len)
\begin{DoxyCompactList}\small\item\em E\+M\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 encoding operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_adf2b3eb984c081a403ca5c73667586e6}{emsa\+Pkcs1v15\+Verify} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, size\+\_\+t em\+Len)
\begin{DoxyCompactList}\small\item\em E\+M\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 verification operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_ae703b31c8c30e8df45449f1a847522a7}{emsa\+Pss\+Encode} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, size\+\_\+t salt\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} em\+Bits)
\begin{DoxyCompactList}\small\item\em E\+M\+S\+A-\/\+P\+SS encoding operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a776b7f6b47e34540ed99dd44ffefdf49}{emsa\+Pss\+Verify} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, size\+\_\+t salt\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$em, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} em\+Bits)
\begin{DoxyCompactList}\small\item\em E\+M\+S\+A-\/\+P\+SS verification operation. \end{DoxyCompactList}\item 
void \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, \hyperlink{structHashContext}{Hash\+Context} $\ast$hash\+Context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{demo_2microchip_2pic32mz__ef__curiosity_2wifi__http__server__demo_2src_2main_8c_ae5b6f47ec5afdb614046a54e45a39c69}{seed}, size\+\_\+t seed\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t data\+Len)
\begin{DoxyCompactList}\small\item\em M\+G\+F1 mask generation function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rsa_8c_a50211782db4f1f58fef305d71993fa55}{rsa\+Generate\+Key\+Pair} (const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context, size\+\_\+t \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} e, \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$private\+Key, \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$public\+Key)
\begin{DoxyCompactList}\small\item\em R\+SA key pair generation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_ad67011f345ca59ed0582e0484b597eb9}{P\+K\+C\+S1\+\_\+\+O\+ID} \mbox{[}8\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x01\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a4dfd8d1562ab65d3c3917a064ff1d292}{M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x02\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_af19f8c370895ebbb0acbe8da4ef0a0c0}{M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x04\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a736d50cd0e106849f68525738a84807d}{S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x05\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_ac7526d5f43a9b9190710675d6ba34f8e}{S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+E\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a3f47da029e12f80b24910e857eff27b9}{S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+B\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a3894e84fdea08249ef57afdba18aa380}{S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+C\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_adf40ca1962295568f78ca0cdcd202971}{S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+D\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a7a9560d9c4ca9e89e1e982551574b153}{S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+F\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a2725d615df2470c4c02ca385174b43b7}{S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x10\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a490ca34e6cbccf1058ae40901758270d}{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0\+D\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_ab5a7bb1be04732887f695d6f21bb94f6}{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0\+E\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a107945de499d583b794eed91ab7eadd3}{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0\+F\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a827aeeb405a047789dee2fcd9ffea4b0}{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x10\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+A\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_a0f28ad77f8507396cd4e2efbc6e25c10}{M\+G\+F1\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x08\}
\item 
static const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}{padding} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+SA public-\/key cryptography standard. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
R\+SA is an algorithm for public-\/key cryptography which is suitable for signing as well as encryption. Refer to the following R\+F\+Cs for complete details\+:
\begin{DoxyItemize}
\item R\+FC 2313\+: P\+K\+CS \#1\+: R\+SA Encryption Version 1.\+5
\item R\+FC 3447\+: P\+K\+CS \#1\+: R\+SA Cryptography Specifications Version 2.\+1
\item R\+FC 8017\+: P\+K\+CS \#1\+: R\+SA Cryptography Specifications Version 2.\+2
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{rsa_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{rsa_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{rsa.\+c@{rsa.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 40 of file rsa.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{rsa_8c_a5e002e31dd695eb54953f35b429a2e0b}\label{rsa_8c_a5e002e31dd695eb54953f35b429a2e0b}} 
\index{rsa.\+c@{rsa.\+c}!eme\+Oaep\+Decode@{eme\+Oaep\+Decode}}
\index{eme\+Oaep\+Decode@{eme\+Oaep\+Decode}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{eme\+Oaep\+Decode()}{emeOaepDecode()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} eme\+Oaep\+Decode (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{label,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{size\+\_\+t}]{k,  }\item[{size\+\_\+t $\ast$}]{message\+Len }\end{DoxyParamCaption})}



E\+M\+E-\/\+O\+A\+EP decoding operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em label} & Optional label to be associated with the message \\
\hline
\mbox{\tt in}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em k} & Length of the encoded message \\
\hline
\mbox{\tt out}  & {\em message\+Len} & Length of the decrypted message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 0 on success, 1 on failure 
\end{DoxyReturn}


Definition at line 1491 of file rsa.\+c.


\begin{DoxyCode}
1493 \{
1494    \textcolor{keywordtype}{size\_t} i;
1495    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1496    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1497    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1498    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} bad;
1499    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *db;
1500    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{demo_2microchip_2pic32mz__ef__curiosity_2wifi__http__server__demo_2src_2main_8c_ae5b6f47ec5afdb614046a54e45a39c69}{seed};
1501    \hyperlink{structHashContext}{HashContext} *hashContext;
1502    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} lHash[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
1503 
1504    \textcolor{comment}{//Allocate a memory buffer to hold the hash context}
1505    hashContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(hash->\hyperlink{structHashAlgo_ad087845190aa4163d8339cacd07fec3e}{contextSize});
1506 
1507    \textcolor{comment}{//Successful memory allocation?}
1508    \textcolor{keywordflow}{if}(hashContext != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1509    \{
1510       \textcolor{comment}{//If the label L is not provided, let L be the empty string}
1511       \textcolor{keywordflow}{if}(label == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1512          label = \textcolor{stringliteral}{""};
1513 
1514       \textcolor{comment}{//Let lHash = Hash(L)}
1515       hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
1516       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, label, \hyperlink{cyclone__crypto_2core_2crypto_8h_a60355e8a0b63bff69cedd877fc82c624}{cryptoStrlen}(label));
1517       hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, lHash);
1518 
1519       \textcolor{comment}{//Separate the encoded message EM into a single octet Y, an octet string}
1520       \textcolor{comment}{//maskedSeed of length hLen, and an octet string maskedDB of length k - hLen - 1}
1521       seed = em + 1;
1522       db = em + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 1;
1523 
1524       \textcolor{comment}{//Calculate the length of the data block}
1525       n = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 1;
1526 
1527       \textcolor{comment}{//Let seed = maskedSeed xor MGF(maskedDB, hLen)}
1528       \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1}(hash, hashContext, db, n, seed, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1529       \textcolor{comment}{//Let DB = maskedDB xor MGF(seed, k - hLen - 1)}
1530       \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1}(hash, hashContext, seed, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, db, n);
1531 
1532       \textcolor{comment}{//Release hash context}
1533       \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hashContext);
1534 
1535       \textcolor{comment}{//Separate DB into an octet string lHash' of length hLen, a padding string}
1536       \textcolor{comment}{//PS consisting of octets with hexadecimal value 0x00, and a message M}
1537       \textcolor{keywordflow}{for}(m = 0, i = hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; i < n; i++)
1538       \{
1539          \textcolor{comment}{//Constant time implementation}
1540          c = \hyperlink{cyclone__crypto_2core_2crypto_8h_a3381c01521bc706555c5c519be3c7c61}{CRYPTO\_TEST\_NZ\_8}(db[i]);
1541          c &= \hyperlink{cyclone__crypto_2core_2crypto_8h_a57e4b2c8e9be00198f1dc34e90d4eaaa}{CRYPTO\_TEST\_Z\_32}(m);
1542          m = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(m, i, c);
1543       \}
1544 
1545       \textcolor{comment}{//Make sure the padding string PS is terminated}
1546       bad = \hyperlink{cyclone__crypto_2core_2crypto_8h_a57e4b2c8e9be00198f1dc34e90d4eaaa}{CRYPTO\_TEST\_Z\_32}(m);
1547 
1548       \textcolor{comment}{//If there is no octet with hexadecimal value 0x01 to separate PS from M,}
1549       \textcolor{comment}{//then report a decryption error}
1550       bad |= \hyperlink{cyclone__crypto_2core_2crypto_8h_a12c7de83247edc168d74071447fd7793}{CRYPTO\_TEST\_NEQ\_8}(db[m], 0x01);
1551 
1552       \textcolor{comment}{//If lHash does not equal lHash', then report a decryption error}
1553       \textcolor{keywordflow}{for}(i = 0; i < hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; i++)
1554       \{
1555          bad |= \hyperlink{cyclone__crypto_2core_2crypto_8h_a12c7de83247edc168d74071447fd7793}{CRYPTO\_TEST\_NEQ\_8}(db[i], lHash[i]);
1556       \}
1557 
1558       \textcolor{comment}{//If Y is nonzero, then report a decryption error}
1559       bad |= \hyperlink{cyclone__crypto_2core_2crypto_8h_a12c7de83247edc168d74071447fd7793}{CRYPTO\_TEST\_NEQ\_8}(em[0], 0x00);
1560 
1561       \textcolor{comment}{//Return the length of the decrypted message}
1562       *messageLen = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(n - m - 1, 0, bad);
1563    \}
1564    \textcolor{keywordflow}{else}
1565    \{
1566       \textcolor{comment}{//Failed to allocate memory}
1567       bad = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1568    \}
1569 
1570    \textcolor{comment}{//Care must be taken to ensure that an opponent cannot distinguish the}
1571    \textcolor{comment}{//different error conditions, whether by error message or timing}
1572    \textcolor{keywordflow}{return} bad;
1573 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a68d67e7b81685fbd077f87b68a16b0ea}\label{rsa_8c_a68d67e7b81685fbd077f87b68a16b0ea}} 
\index{rsa.\+c@{rsa.\+c}!eme\+Oaep\+Encode@{eme\+Oaep\+Encode}}
\index{eme\+Oaep\+Encode@{eme\+Oaep\+Encode}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{eme\+Oaep\+Encode()}{emeOaepEncode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eme\+Oaep\+Encode (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{label,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{message,  }\item[{size\+\_\+t}]{message\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{size\+\_\+t}]{k }\end{DoxyParamCaption})}



E\+M\+E-\/\+O\+A\+EP encoding operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em label} & Optional label to be associated with the message \\
\hline
\mbox{\tt in}  & {\em message} & Message to be encrypted \\
\hline
\mbox{\tt in}  & {\em message\+Len} & Length of the message to be encrypted \\
\hline
\mbox{\tt out}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em k} & Length of the encoded message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1411 of file rsa.\+c.


\begin{DoxyCode}
1414 \{
1415    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1416    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1417    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *db;
1418    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{demo_2microchip_2pic32mz__ef__curiosity_2wifi__http__server__demo_2src_2main_8c_ae5b6f47ec5afdb614046a54e45a39c69}{seed};
1419    \hyperlink{structHashContext}{HashContext} *hashContext;
1420 
1421    \textcolor{comment}{//Check the length of the message}
1422    \textcolor{keywordflow}{if}(messageLen > (\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - 2 * hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 2))
1423       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1424 
1425    \textcolor{comment}{//Point to the buffer where to format the seed}
1426    seed = em + 1;
1427    \textcolor{comment}{//Point to the buffer where to format the data block}
1428    db = em + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 1;
1429 
1430    \textcolor{comment}{//Generate a random octet string seed of length hLen}
1431    error = prngAlgo->\hyperlink{structPrngAlgo_a079621740ef14faacfcd05b84c9036eb}{read}(prngContext, seed, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1432    \textcolor{comment}{//Any error to report?}
1433    \textcolor{keywordflow}{if}(error)
1434       \textcolor{keywordflow}{return} error;
1435 
1436    \textcolor{comment}{//Allocate a memory buffer to hold the hash context}
1437    hashContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(hash->\hyperlink{structHashAlgo_ad087845190aa4163d8339cacd07fec3e}{contextSize});
1438    \textcolor{comment}{//Failed to allocate memory?}
1439    \textcolor{keywordflow}{if}(hashContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1440       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
1441 
1442    \textcolor{comment}{//If the label L is not provided, let L be the empty string}
1443    \textcolor{keywordflow}{if}(label == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1444       label = \textcolor{stringliteral}{""};
1445 
1446    \textcolor{comment}{//Let lHash = Hash(L)}
1447    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
1448    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, label, \hyperlink{cyclone__crypto_2core_2crypto_8h_a60355e8a0b63bff69cedd877fc82c624}{cryptoStrlen}(label));
1449    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, db);
1450 
1451    \textcolor{comment}{//The padding string PS consists of k - mLen - 2hLen - 2 zero octets}
1452    n = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - messageLen - 2 * hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 2;
1453    \textcolor{comment}{//Generate the padding string}
1454    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(db + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, 0, n);
1455 
1456    \textcolor{comment}{//Concatenate lHash, PS, a single octet with hexadecimal value 0x01, and}
1457    \textcolor{comment}{//the message M to form a data block DB of length k - hLen - 1 octets}
1458    db[hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = 0x01;
1459    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(db + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + n + 1, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, messageLen);
1460 
1461    \textcolor{comment}{//Calculate the length of the data block}
1462    n = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 1;
1463 
1464    \textcolor{comment}{//Let maskedDB = DB xor MGF(seed, k - hLen - 1)}
1465    \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1}(hash, hashContext, seed, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, db, n);
1466    \textcolor{comment}{//Let maskedSeed = seed xor MGF(maskedDB, hLen)}
1467    \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1}(hash, hashContext, db, n, seed, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1468 
1469    \textcolor{comment}{//Concatenate a single octet with hexadecimal value 0x00, maskedSeed, and}
1470    \textcolor{comment}{//maskedDB to form an encoded message EM of length k octets}
1471    em[0] = 0x00;
1472 
1473    \textcolor{comment}{//Release hash context}
1474    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hashContext);
1475 
1476    \textcolor{comment}{//Successful processing}
1477    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1478 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a4476eea5c60b091fbac68c4d29dbbbbb}\label{rsa_8c_a4476eea5c60b091fbac68c4d29dbbbbb}} 
\index{rsa.\+c@{rsa.\+c}!eme\+Pkcs1v15\+Decode@{eme\+Pkcs1v15\+Decode}}
\index{eme\+Pkcs1v15\+Decode@{eme\+Pkcs1v15\+Decode}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{eme\+Pkcs1v15\+Decode()}{emePkcs1v15Decode()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} eme\+Pkcs1v15\+Decode (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{size\+\_\+t}]{k,  }\item[{size\+\_\+t $\ast$}]{message\+Len }\end{DoxyParamCaption})}



E\+M\+E-\/\+P\+K\+C\+S1-\/v1\+\_\+5 decoding operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em k} & Length of the encoded message \\
\hline
\mbox{\tt out}  & {\em message\+Len} & Length of the decrypted message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 0 on success, 1 on failure 
\end{DoxyReturn}


Definition at line 1357 of file rsa.\+c.


\begin{DoxyCode}
1358 \{
1359    \textcolor{keywordtype}{size\_t} i;
1360    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1361    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1362    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} bad;
1363 
1364    \textcolor{comment}{//Separate the encoded message EM into an octet string PS consisting of}
1365    \textcolor{comment}{//nonzero octets and a message M}
1366    \textcolor{keywordflow}{for}(m = 0, i = 2; i < \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}; i++)
1367    \{
1368       \textcolor{comment}{//Constant time implementation}
1369       c = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0e7d69e766fbd4f9550819554d0137d6}{CRYPTO\_TEST\_Z\_8}(em[i]);
1370       c &= \hyperlink{cyclone__crypto_2core_2crypto_8h_a57e4b2c8e9be00198f1dc34e90d4eaaa}{CRYPTO\_TEST\_Z\_32}(m);
1371       m = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(m, i, c);
1372    \}
1373 
1374    \textcolor{comment}{//If the first octet of EM does not have hexadecimal value 0x00, then}
1375    \textcolor{comment}{//report a decryption error}
1376    bad = \hyperlink{cyclone__crypto_2core_2crypto_8h_a12c7de83247edc168d74071447fd7793}{CRYPTO\_TEST\_NEQ\_8}(em[0], 0x00);
1377 
1378    \textcolor{comment}{//If the second octet of EM does not have hexadecimal value 0x02, then}
1379    \textcolor{comment}{//report a decryption error}
1380    bad |= \hyperlink{cyclone__crypto_2core_2crypto_8h_a12c7de83247edc168d74071447fd7793}{CRYPTO\_TEST\_NEQ\_8}(em[1], 0x02);
1381 
1382    \textcolor{comment}{//If there is no octet with hexadecimal value 0x00 to separate PS from M,}
1383    \textcolor{comment}{//then report a decryption error}
1384    bad |= \hyperlink{cyclone__crypto_2core_2crypto_8h_a57e4b2c8e9be00198f1dc34e90d4eaaa}{CRYPTO\_TEST\_Z\_32}(m);
1385 
1386    \textcolor{comment}{//If the length of PS is less than 8 octets, then report a decryption error}
1387    bad |= \hyperlink{cyclone__crypto_2core_2crypto_8h_a61a9ec36a7ba935b9aa5bd44fbd386a3}{CRYPTO\_TEST\_LT\_32}(m, 10);
1388 
1389    \textcolor{comment}{//Return the length of the decrypted message}
1390    *messageLen = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(k - m - 1, 0, bad);
1391 
1392    \textcolor{comment}{//Care must be taken to ensure that an opponent cannot distinguish the}
1393    \textcolor{comment}{//different error conditions, whether by error message or timing}
1394    \textcolor{keywordflow}{return} bad;
1395 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a1b04d815975669a6b26f8b68847ce029}\label{rsa_8c_a1b04d815975669a6b26f8b68847ce029}} 
\index{rsa.\+c@{rsa.\+c}!eme\+Pkcs1v15\+Encode@{eme\+Pkcs1v15\+Encode}}
\index{eme\+Pkcs1v15\+Encode@{eme\+Pkcs1v15\+Encode}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{eme\+Pkcs1v15\+Encode()}{emePkcs1v15Encode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eme\+Pkcs1v15\+Encode (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{message,  }\item[{size\+\_\+t}]{message\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{size\+\_\+t}]{k }\end{DoxyParamCaption})}



E\+M\+E-\/\+P\+K\+C\+S1-\/v1\+\_\+5 encoding operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em message} & Message to be encrypted \\
\hline
\mbox{\tt in}  & {\em message\+Len} & Length of the message to be encrypted \\
\hline
\mbox{\tt out}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em k} & Length of the encoded message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1289 of file rsa.\+c.


\begin{DoxyCode}
1291 \{
1292    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1293    \textcolor{keywordtype}{size\_t} i;
1294    \textcolor{keywordtype}{size\_t} j;
1295    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1296    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1297 
1298    \textcolor{comment}{//Check the length of the message}
1299    \textcolor{keywordflow}{if}((messageLen + 11) > \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k})
1300       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1301 
1302    \textcolor{comment}{//The leading 0x00 octet ensures that the encoded message, converted to}
1303    \textcolor{comment}{//an integer, is less than the modulus}
1304    em[0] = 0x00;
1305    \textcolor{comment}{//For a public-key operation, the block type BT shall be 0x02}
1306    em[1] = 0x02;
1307 
1308    \textcolor{comment}{//Point to the buffer where to format the padding string PS}
1309    p = em + 2;
1310    \textcolor{comment}{//Determine the length of the padding string}
1311    n = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - messageLen - 3;
1312 
1313    \textcolor{comment}{//Generate an octet string PS of length k - mLen - 3 consisting of}
1314    \textcolor{comment}{//pseudo-randomly generated nonzero octets}
1315    \textcolor{keywordflow}{while}(n > 0)
1316    \{
1317       \textcolor{comment}{//Generate random data}
1318       error = prngAlgo->\hyperlink{structPrngAlgo_a079621740ef14faacfcd05b84c9036eb}{read}(prngContext, p, n);
1319       \textcolor{comment}{//Any error to report?}
1320       \textcolor{keywordflow}{if}(error)
1321          \textcolor{keywordflow}{return} error;
1322 
1323       \textcolor{comment}{//Parse the resulting octet string}
1324       \textcolor{keywordflow}{for}(i = 0, j = 0; j < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j++)
1325       \{
1326          \textcolor{comment}{//Strip any byte with a value of zero}
1327          \textcolor{keywordflow}{if}(p[j] != 0)
1328          \{
1329             p[i++] = p[j];
1330          \}
1331       \}
1332 
1333       \textcolor{comment}{//Advance data pointer}
1334       p += i;
1335       n -= i;
1336    \}
1337 
1338    \textcolor{comment}{//Append a 0x00 octet to the padding string}
1339    *p = 0x00;
1340 
1341    \textcolor{comment}{//Copy the message to be encrypted}
1342    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(p + 1, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, messageLen);
1343 
1344    \textcolor{comment}{//Successful processing}
1345    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1346 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a7eec30cb6f589d520b380bc37ed655f0}\label{rsa_8c_a7eec30cb6f589d520b380bc37ed655f0}} 
\index{rsa.\+c@{rsa.\+c}!emsa\+Pkcs1v15\+Encode@{emsa\+Pkcs1v15\+Encode}}
\index{emsa\+Pkcs1v15\+Encode@{emsa\+Pkcs1v15\+Encode}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{emsa\+Pkcs1v15\+Encode()}{emsaPkcs1v15Encode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} emsa\+Pkcs1v15\+Encode (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{size\+\_\+t}]{em\+Len }\end{DoxyParamCaption})}



E\+M\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 encoding operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Hash function used to digest the message \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message to be signed \\
\hline
\mbox{\tt out}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em em\+Len} & Intended length of the encoded message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1585 of file rsa.\+c.


\begin{DoxyCode}
1587 \{
1588    \textcolor{keywordtype}{size\_t} i;
1589    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1590 
1591    \textcolor{comment}{//Check the intended length of the encoded message}
1592    \textcolor{keywordflow}{if}(emLen < (hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 21))
1593       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1594 
1595    \textcolor{comment}{//Point to the first byte of the encoded message}
1596    i = 0;
1597 
1598    \textcolor{comment}{//The leading 0x00 octet ensures that the encoded message, converted to}
1599    \textcolor{comment}{//an integer, is less than the modulus}
1600    em[i++] = 0x00;
1601    \textcolor{comment}{//Block type 0x01 is used for private-key operations}
1602    em[i++] = 0x01;
1603 
1604    \textcolor{comment}{//Determine the length of the padding string PS}
1605    n = emLen - hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 13;
1606 
1607    \textcolor{comment}{//Each byte of PS must be set to 0xFF when the block type is 0x01}
1608    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(em + i, 0xFF, n);
1609    i += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1610 
1611    \textcolor{comment}{//Append a 0x00 octet to the padding string}
1612    em[i++] = 0x00;
1613 
1614    \textcolor{comment}{//Encode the DigestInfo structure using ASN.1}
1615    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (\hyperlink{asn1_8h_a333f7702ca4c67a7bb95c03bbe3d55c0}{ASN1\_ENCODING\_CONSTRUCTED} | 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE});
1616    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 8);
1617    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (\hyperlink{asn1_8h_a333f7702ca4c67a7bb95c03bbe3d55c0}{ASN1\_ENCODING\_CONSTRUCTED} | 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE});
1618    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} + 4);
1619    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa586ebdd8b160ea2185cff78381dfe4b0}{ASN1\_TYPE\_OBJECT\_IDENTIFIER};
1620    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize};
1621 
1622    \textcolor{comment}{//Copy the hash algorithm OID}
1623    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(em + i, hash->\hyperlink{structHashAlgo_a19af95385f1c3b7f8ccbe17bc078b673}{oid}, hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize});
1624    i += hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize};
1625 
1626    \textcolor{comment}{//Encode the rest of the ASN.1 structure}
1627    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfac7b5ab1acfd186cfa72328495cc5261a}{ASN1\_TYPE\_NULL};
1628    em[i++] = 0;
1629    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
1630    em[i++] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize};
1631 
1632    \textcolor{comment}{//Append the hash value}
1633    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(em + i, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1634 
1635    \textcolor{comment}{//Successful processing}
1636    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1637 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_adf2b3eb984c081a403ca5c73667586e6}\label{rsa_8c_adf2b3eb984c081a403ca5c73667586e6}} 
\index{rsa.\+c@{rsa.\+c}!emsa\+Pkcs1v15\+Verify@{emsa\+Pkcs1v15\+Verify}}
\index{emsa\+Pkcs1v15\+Verify@{emsa\+Pkcs1v15\+Verify}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{emsa\+Pkcs1v15\+Verify()}{emsaPkcs1v15Verify()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} emsa\+Pkcs1v15\+Verify (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{size\+\_\+t}]{em\+Len }\end{DoxyParamCaption})}



E\+M\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 verification operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Hash function \\
\hline
\mbox{\tt in}  & {\em digest} & Digest value \\
\hline
\mbox{\tt in}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em em\+Len} & Length of the encoded message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1649 of file rsa.\+c.


\begin{DoxyCode}
1651 \{
1652    \textcolor{keywordtype}{size\_t} i;
1653    \textcolor{keywordtype}{size\_t} j;
1654    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1655    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} bad;
1656 
1657    \textcolor{comment}{//Check the length of the encoded message}
1658    \textcolor{keywordflow}{if}(emLen < (hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 21))
1659       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1660 
1661    \textcolor{comment}{//Point to the first byte of the encoded message}
1662    i = 0;
1663 
1664    \textcolor{comment}{//The first octet of EM must have hexadecimal value 0x00}
1665    bad = em[i++];
1666    \textcolor{comment}{//The second octet of EM must have hexadecimal value 0x01}
1667    bad |= em[i++] ^ 0x01;
1668 
1669    \textcolor{comment}{//Determine the length of the padding string PS}
1670    n = emLen - hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 13;
1671 
1672    \textcolor{comment}{//Each byte of PS must be set to 0xFF when the block type is 0x01}
1673    \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j++)
1674    \{
1675       bad |= em[i++] ^ 0xFF;
1676    \}
1677 
1678    \textcolor{comment}{//The padding string must be followed by a 0x00 octet}
1679    bad |= em[i++];
1680 
1681    \textcolor{comment}{//Check the ASN.1 syntax of the DigestInfo structure}
1682    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (\hyperlink{asn1_8h_a333f7702ca4c67a7bb95c03bbe3d55c0}{ASN1\_ENCODING\_CONSTRUCTED} | 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE});
1683    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 8);
1684    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (\hyperlink{asn1_8h_a333f7702ca4c67a7bb95c03bbe3d55c0}{ASN1\_ENCODING\_CONSTRUCTED} | 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE});
1685    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize} + 4);
1686    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa586ebdd8b160ea2185cff78381dfe4b0}{ASN1\_TYPE\_OBJECT\_IDENTIFIER};
1687    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) hash->\hyperlink{structHashAlgo_a3c31200f0d9ee2ee3ad36b7e405814d2}{oidSize};
1688 
1689    \textcolor{comment}{//Verify the hash algorithm OID}
1690    \textcolor{keywordflow}{for}(j = 0; j < hash->oidSize; j++)
1691    \{
1692       bad |= em[i++] ^ hash->\hyperlink{structHashAlgo_a19af95385f1c3b7f8ccbe17bc078b673}{oid}[j];
1693    \}
1694 
1695    \textcolor{comment}{//Check the rest of the ASN.1 structure}
1696    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfac7b5ab1acfd186cfa72328495cc5261a}{ASN1\_TYPE\_NULL};
1697    bad |= em[i++];
1698    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
1699    bad |= em[i++] ^ (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize};
1700 
1701    \textcolor{comment}{//Recover the underlying hash value, and then compare it to a newly}
1702    \textcolor{comment}{//computed hash value}
1703    \textcolor{keywordflow}{for}(j = 0; j < hash->digestSize; j++)
1704    \{
1705       bad |= em[i++] ^ digest[j];
1706    \}
1707 
1708    \textcolor{comment}{//Verification result}
1709    \textcolor{keywordflow}{return} (bad != 0) ? \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE} : 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1710 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_ae703b31c8c30e8df45449f1a847522a7}\label{rsa_8c_ae703b31c8c30e8df45449f1a847522a7}} 
\index{rsa.\+c@{rsa.\+c}!emsa\+Pss\+Encode@{emsa\+Pss\+Encode}}
\index{emsa\+Pss\+Encode@{emsa\+Pss\+Encode}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{emsa\+Pss\+Encode()}{emsaPssEncode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} emsa\+Pss\+Encode (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{size\+\_\+t}]{salt\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{em\+Bits }\end{DoxyParamCaption})}



E\+M\+S\+A-\/\+P\+SS encoding operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em salt\+Len} & Length of the salt, in bytes \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message to be signed \\
\hline
\mbox{\tt out}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em em\+Bits} & Maximal bit length of the integer O\+S2\+I\+P(\+E\+M) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1725 of file rsa.\+c.


\begin{DoxyCode}
1728 \{
1729    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1730    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1731    \textcolor{keywordtype}{size\_t} emLen;
1732    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *db;
1733    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *salt;
1734    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{ndp_8h_a1f1dfeb2f802fe99f37fe91867b84456}{h}[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
1735    \hyperlink{structHashContext}{HashContext} *hashContext;
1736 
1737    \textcolor{comment}{//The encoded message is an octet string of length emLen = ceil(emBits / 8)}
1738    emLen = (emBits + 7) / 8;
1739 
1740    \textcolor{comment}{//If emLen < hLen + sLen + 2, output "encoding error" and stop}
1741    \textcolor{keywordflow}{if}(emLen < (hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + saltLen + 2))
1742       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1743 
1744    \textcolor{comment}{//The padding string PS consists of emLen - sLen - hLen - 2 zero octets}
1745    n = emLen - saltLen - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 2;
1746 
1747    \textcolor{comment}{//Point to the buffer where to format the data block DB}
1748    db = em;
1749    \textcolor{comment}{//Point to the buffer where to generate the salt}
1750    salt = db + n + 1;
1751 
1752    \textcolor{comment}{//Generate a random octet string salt of length sLen}
1753    error = prngAlgo->\hyperlink{structPrngAlgo_a079621740ef14faacfcd05b84c9036eb}{read}(prngContext, salt, saltLen);
1754    \textcolor{comment}{//Any error to report?}
1755    \textcolor{keywordflow}{if}(error)
1756       \textcolor{keywordflow}{return} error;
1757 
1758    \textcolor{comment}{//Allocate a memory buffer to hold the hash context}
1759    hashContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(hash->\hyperlink{structHashAlgo_ad087845190aa4163d8339cacd07fec3e}{contextSize});
1760    \textcolor{comment}{//Failed to allocate memory?}
1761    \textcolor{keywordflow}{if}(hashContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1762       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
1763 
1764    \textcolor{comment}{//Let H = Hash(00 00 00 00 00 00 00 00 || mHash || salt)}
1765    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
1766    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \hyperlink{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}{padding}, \textcolor{keyword}{sizeof}(\hyperlink{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}{padding}));
1767    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1768    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, salt, saltLen);
1769    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, h);
1770 
1771    \textcolor{comment}{//Let DB = PS || 0x01 || salt}
1772    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(db, 0, n);
1773    db[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = 0x01;
1774 
1775    \textcolor{comment}{//Calculate the length of the data block}
1776    n += saltLen + 1;
1777 
1778    \textcolor{comment}{//Let maskedDB = DB xor MGF(H, emLen - hLen - 1)}
1779    \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1}(hash, hashContext, h, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, db, n);
1780 
1781    \textcolor{comment}{//Set the leftmost 8emLen - emBits bits of the leftmost octet in maskedDB}
1782    \textcolor{comment}{//to zero}
1783    db[0] &= 0xFF >> (8 * emLen - emBits);
1784 
1785    \textcolor{comment}{//Let EM = maskedDB || H || 0xbc}
1786    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(em + n, h, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1787    em[n + hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}] = 0xBC;
1788 
1789    \textcolor{comment}{//Release hash context}
1790    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hashContext);
1791 
1792    \textcolor{comment}{//Successful processing}
1793    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1794 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a776b7f6b47e34540ed99dd44ffefdf49}\label{rsa_8c_a776b7f6b47e34540ed99dd44ffefdf49}} 
\index{rsa.\+c@{rsa.\+c}!emsa\+Pss\+Verify@{emsa\+Pss\+Verify}}
\index{emsa\+Pss\+Verify@{emsa\+Pss\+Verify}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{emsa\+Pss\+Verify()}{emsaPssVerify()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} emsa\+Pss\+Verify (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{size\+\_\+t}]{salt\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{em,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{em\+Bits }\end{DoxyParamCaption})}



E\+M\+S\+A-\/\+P\+SS verification operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em salt\+Len} & Length of the salt, in bytes \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message to be signed \\
\hline
\mbox{\tt out}  & {\em em} & Encoded message \\
\hline
\mbox{\tt in}  & {\em em\+Bits} & Maximal bit length of the integer O\+S2\+I\+P(\+E\+M) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1807 of file rsa.\+c.


\begin{DoxyCode}
1809 \{
1810    \textcolor{keywordtype}{size\_t} i;
1811    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1812    \textcolor{keywordtype}{size\_t} emLen;
1813    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} bad;
1814    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
1815    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a1f1dfeb2f802fe99f37fe91867b84456}{h};
1816    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *db;
1817    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *salt;
1818    \hyperlink{structHashContext}{HashContext} *hashContext;
1819 
1820    \textcolor{comment}{//The encoded message is an octet string of length emLen = ceil(emBits / 8)}
1821    emLen = (emBits + 7) / 8;
1822 
1823    \textcolor{comment}{//Check the length of the encoded message EM}
1824    \textcolor{keywordflow}{if}(emLen < (hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + saltLen + 2))
1825       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1826 
1827    \textcolor{comment}{//Allocate a memory buffer to hold the hash context}
1828    hashContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(hash->\hyperlink{structHashAlgo_ad087845190aa4163d8339cacd07fec3e}{contextSize});
1829    \textcolor{comment}{//Failed to allocate memory?}
1830    \textcolor{keywordflow}{if}(hashContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1831       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
1832 
1833    \textcolor{comment}{//If the rightmost octet of EM does not have hexadecimal value 0xbc, output}
1834    \textcolor{comment}{//"inconsistent" and stop}
1835    bad = em[emLen - 1] ^ 0xBC;
1836 
1837    \textcolor{comment}{//Let maskedDB be the leftmost emLen - hLen - 1 octets of EM, and let H be}
1838    \textcolor{comment}{//the next hLen octets}
1839    db = em;
1840    n = emLen - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - 1;
1841    h = em + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1842 
1843    \textcolor{comment}{//Form a mask}
1844    mask = 0xFF >> (8 * emLen - emBits);
1845 
1846    \textcolor{comment}{//If the leftmost 8emLen - emBits bits of the leftmost octet in maskedDB are}
1847    \textcolor{comment}{//not all equal to zero, output "inconsistent" and stop}
1848    bad |= db[0] & ~mask;
1849 
1850    \textcolor{comment}{//Let DB = maskedDB xor MGF(H, emLen - hLen - 1)}
1851    \hyperlink{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}{mgf1}(hash, hashContext, h, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, db, n);
1852 
1853    \textcolor{comment}{//Set the leftmost 8emLen - emBits bits of the leftmost octet in DB to zero}
1854    db[0] &= \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
1855 
1856    \textcolor{comment}{//The padding string PS consists of emLen - sLen - hLen - 2 octets}
1857    n = emLen - hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} - saltLen - 2;
1858 
1859    \textcolor{comment}{//If the emLen - hLen - sLen - 2 leftmost octets of DB are not zero, output}
1860    \textcolor{comment}{//"inconsistent" and stop}
1861    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
1862    \{
1863       bad |= db[i];
1864    \}
1865 
1866    \textcolor{comment}{//If the octet at position emLen - hLen - sLen - 1 does not have hexadecimal}
1867    \textcolor{comment}{//value 0x01, output "inconsistent" and stop}
1868    bad |= db[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] ^ 0x01;
1869 
1870    \textcolor{comment}{//Let salt be the last sLen octets of DB}
1871    salt = db + n + 1;
1872 
1873    \textcolor{comment}{//Let H' = Hash(00 00 00 00 00 00 00 00 || mHash || salt)}
1874    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
1875    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \hyperlink{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}{padding}, \textcolor{keyword}{sizeof}(\hyperlink{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}{padding}));
1876    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1877    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, salt, saltLen);
1878    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
1879 
1880    \textcolor{comment}{//If H = H', output "consistent". Otherwise, output "inconsistent"}
1881    \textcolor{keywordflow}{for}(i = 0; i < hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; i++)
1882    \{
1883       bad |= h[i] ^ hashContext->\hyperlink{structHashContext_a846e5b08172b00162569c343caa0eae1}{digest}[i];
1884    \}
1885 
1886    \textcolor{comment}{//Release hash context}
1887    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hashContext);
1888 
1889    \textcolor{comment}{//Verification result}
1890    \textcolor{keywordflow}{return} (bad != 0) ? \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE} : 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1891 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}\label{rsa_8c_a9972c3ca6ef13c9d6b4debe9615cb1fe}} 
\index{rsa.\+c@{rsa.\+c}!mgf1@{mgf1}}
\index{mgf1@{mgf1}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{mgf1()}{mgf1()}}
{\footnotesize\ttfamily void mgf1 (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{\hyperlink{structHashContext}{Hash\+Context} $\ast$}]{hash\+Context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{seed,  }\item[{size\+\_\+t}]{seed\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{data\+Len }\end{DoxyParamCaption})}



M\+G\+F1 mask generation function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Hash function \\
\hline
\mbox{\tt in}  & {\em hash\+Context} & Hash function context \\
\hline
\mbox{\tt in}  & {\em seed} & Seed from which the mask is generated \\
\hline
\mbox{\tt in}  & {\em seed\+Len} & Length of the seed in bytes \\
\hline
\mbox{\tt in,out}  & {\em data} & Data block to be masked \\
\hline
\mbox{\tt in}  & {\em data\+Len} & Length of the data block in bytes \\
\hline
\end{DoxyParams}


Definition at line 1904 of file rsa.\+c.


\begin{DoxyCode}
1906 \{
1907    \textcolor{keywordtype}{size\_t} i;
1908    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1909    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} counter;
1910    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}[4];
1911 
1912    \textcolor{comment}{//The data is processed block by block}
1913    \textcolor{keywordflow}{for}(counter = 0; dataLen > 0; counter++)
1914    \{
1915       \textcolor{comment}{//Limit the number of bytes to process at a time}
1916       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(dataLen, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1917 
1918       \textcolor{comment}{//Convert counter to an octet string C of length 4 octets}
1919       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(counter, c);
1920 
1921       \textcolor{comment}{//Calculate Hash(mgfSeed || C)}
1922       hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
1923       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \hyperlink{demo_2microchip_2pic32mz__ef__curiosity_2wifi__http__server__demo_2src_2main_8c_ae5b6f47ec5afdb614046a54e45a39c69}{seed}, seedLen);
1924       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, c, \textcolor{keyword}{sizeof}(c));
1925       hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
1926 
1927       \textcolor{comment}{//Apply the mask}
1928       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
1929       \{
1930          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[i] ^= hashContext->\hyperlink{structHashContext_a846e5b08172b00162569c343caa0eae1}{digest}[i];
1931       \}
1932 
1933       \textcolor{comment}{//Advance data pointer}
1934       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1935       dataLen -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1936    \}
1937 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a5288ac4218c0e6f3cc00da6d0ddf21c4}\label{rsa_8c_a5288ac4218c0e6f3cc00da6d0ddf21c4}} 
\index{rsa.\+c@{rsa.\+c}!rsadp@{rsadp}}
\index{rsadp@{rsadp}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsadp()}{rsadp()}}
{\footnotesize\ttfamily \+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsadp (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{c,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{m }\end{DoxyParamCaption})}



R\+SA decryption primitive. 

The R\+SA decryption primitive recovers the message representative from the ciphertext representative under the control of a private key


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & R\+SA private key \\
\hline
\mbox{\tt in}  & {\em c} & Ciphertext representative \\
\hline
\mbox{\tt out}  & {\em m} & Message representative \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1181 of file rsa.\+c.


\begin{DoxyCode}
1182 \{
1183    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1184    \hyperlink{structMpi}{Mpi} m1;
1185    \hyperlink{structMpi}{Mpi} m2;
1186    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a1f1dfeb2f802fe99f37fe91867b84456}{h};
1187 
1188    \textcolor{comment}{//The ciphertext representative c shall be between 0 and n - 1}
1189    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(c, 0) < 0 || \hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(c, &key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}) >= 0)
1190       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca796107c17e41c601d633f670e5e29800}{ERROR\_OUT\_OF\_RANGE};
1191 
1192    \textcolor{comment}{//Initialize multiple-precision integers}
1193    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m1);
1194    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m2);
1195    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&h);
1196 
1197    \textcolor{comment}{//Use the Chinese remainder algorithm?}
1198    \textcolor{keywordflow}{if}(key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} &&
1199       key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
1200    \{
1201       \textcolor{comment}{//Compute m1 = c ^ dP mod p}
1202       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_ae18482447f7293c8bb44899ce236b72e}{mpiExpMod}(&m1, c, &key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp}, &key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}));
1203       \textcolor{comment}{//Compute m2 = c ^ dQ mod q}
1204       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_ae18482447f7293c8bb44899ce236b72e}{mpiExpMod}(&m2, c, &key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq}, &key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}));
1205       \textcolor{comment}{//Let h = (m1 - m2) * qInv mod p}
1206       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpiSub}(&h, &m1, &m2));
1207       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpiMulMod}(&h, &h, &key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv}, &key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}));
1208       \textcolor{comment}{//Let m = m2 + q * h}
1209       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_a5ce82adaded4af385feef6b79aaad6d2}{mpiMul}(m, &key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, &h));
1210       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}{mpiAdd}(m, m, &m2));
1211    \}
1212    \textcolor{comment}{//Use modular exponentiation?}
1213    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
1214    \{
1215       \textcolor{comment}{//Let m = c ^ d mod n}
1216       error = \hyperlink{samd51__crypto__pukcc_8c_ae18482447f7293c8bb44899ce236b72e}{mpiExpMod}(m, c, &key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d}, &key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
1217    \}
1218    \textcolor{comment}{//Invalid parameters?}
1219    \textcolor{keywordflow}{else}
1220    \{
1221       \textcolor{comment}{//Report an error}
1222       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1223    \}
1224 
1225 end:
1226    \textcolor{comment}{//Free previously allocated memory}
1227    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m1);
1228    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m2);
1229    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&h);
1230 
1231    \textcolor{comment}{//Return status code}
1232    \textcolor{keywordflow}{return} error;
1233 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_aa747fb394b77511f47268bfb77e90e94}\label{rsa_8c_aa747fb394b77511f47268bfb77e90e94}} 
\index{rsa.\+c@{rsa.\+c}!rsaep@{rsaep}}
\index{rsaep@{rsaep}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsaep()}{rsaep()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsaep (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{m,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{c }\end{DoxyParamCaption})}



R\+SA encryption primitive. 

The R\+SA encryption primitive produces a ciphertext representative from a message representative under the control of a public key


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & R\+SA public key \\
\hline
\mbox{\tt in}  & {\em m} & Message representative \\
\hline
\mbox{\tt out}  & {\em c} & Ciphertext representative \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1154 of file rsa.\+c.


\begin{DoxyCode}
1155 \{
1156    \textcolor{comment}{//Ensure the RSA public key is valid}
1157    \textcolor{keywordflow}{if}(!key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} || !key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
1158       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1159 
1160    \textcolor{comment}{//The message representative m shall be between 0 and n - 1}
1161    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(m, 0) < 0 || \hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(m, &key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n}) >= 0)
1162       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca796107c17e41c601d633f670e5e29800}{ERROR\_OUT\_OF\_RANGE};
1163 
1164    \textcolor{comment}{//Perform modular exponentiation (c = m ^ e mod n)}
1165    \textcolor{keywordflow}{return} \hyperlink{samd51__crypto__pukcc_8c_ae18482447f7293c8bb44899ce236b72e}{mpiExpMod}(c, m, &key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e}, &key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
1166 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_aa026e5906d0de64892b89a3b0125fa38}\label{rsa_8c_aa026e5906d0de64892b89a3b0125fa38}} 
\index{rsa.\+c@{rsa.\+c}!rsaes\+Oaep\+Decrypt@{rsaes\+Oaep\+Decrypt}}
\index{rsaes\+Oaep\+Decrypt@{rsaes\+Oaep\+Decrypt}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsaes\+Oaep\+Decrypt()}{rsaesOaepDecrypt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsaes\+Oaep\+Decrypt (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{label,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ciphertext,  }\item[{size\+\_\+t}]{ciphertext\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{message,  }\item[{size\+\_\+t}]{message\+Size,  }\item[{size\+\_\+t $\ast$}]{message\+Len }\end{DoxyParamCaption})}



R\+S\+A\+E\+S-\/\+O\+A\+EP decryption operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Recipient\textquotesingle{}s R\+SA private key \\
\hline
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em label} & Optional label to be associated with the message \\
\hline
\mbox{\tt in}  & {\em ciphertext} & Ciphertext to be decrypted \\
\hline
\mbox{\tt in}  & {\em ciphertext\+Len} & Length of the ciphertext to be decrypted \\
\hline
\mbox{\tt out}  & {\em message} & Output buffer where to store the decrypted message \\
\hline
\mbox{\tt in}  & {\em message\+Size} & Size of the output buffer \\
\hline
\mbox{\tt out}  & {\em message\+Len} & Length of the decrypted message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 529 of file rsa.\+c.


\begin{DoxyCode}
532 \{
533    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
534    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
535    \textcolor{keywordtype}{size\_t} i;
536    \textcolor{keywordtype}{size\_t} j;
537    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
538    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
539    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
540    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} badPadding;
541    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} badLength;
542    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
543    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
544    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
545 
546    \textcolor{comment}{//Check parameters}
547    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || ciphertext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
548       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
549    \textcolor{keywordflow}{if}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || messageSize == 0 || messageLen == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
550       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
551 
552    \textcolor{comment}{//Debug message}
553    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSAES-OAEP decryption...\(\backslash\)r\(\backslash\)n"});
554    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
555    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
556    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
557    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
558    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private exponent:\(\backslash\)r\(\backslash\)n"});
559    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
560    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 1:\(\backslash\)r\(\backslash\)n"});
561    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
562    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 2:\(\backslash\)r\(\backslash\)n"});
563    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
564    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 1:\(\backslash\)r\(\backslash\)n"});
565    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
566    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 2:\(\backslash\)r\(\backslash\)n"});
567    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
568    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Coefficient:\(\backslash\)r\(\backslash\)n"});
569    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
570    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Ciphertext:\(\backslash\)r\(\backslash\)n"});
571    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, ciphertext, ciphertextLen);
572 
573    \textcolor{comment}{//Initialize multiple-precision integers}
574    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
575    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
576 
577    \textcolor{comment}{//Get the length in octets of the modulus n}
578    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
579 
580    \textcolor{comment}{//Check the length of the modulus}
581    \textcolor{keywordflow}{if}(k < (2 * hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize} + 2))
582       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
583 
584    \textcolor{comment}{//Check the length of the ciphertext}
585    \textcolor{keywordflow}{if}(ciphertextLen != k)
586       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
587 
588    \textcolor{comment}{//Allocate a buffer to store the encoded message EM}
589    em = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(k);
590    \textcolor{comment}{//Failed to allocate memory?}
591    \textcolor{keywordflow}{if}(em == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
592       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
593 
594    \textcolor{comment}{//Start of exception handling block}
595    \textcolor{keywordflow}{do}
596    \{
597       \textcolor{comment}{//Convert the ciphertext to an integer ciphertext representative c}
598       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&c, ciphertext, ciphertextLen);
599       \textcolor{comment}{//Conversion failed?}
600       \textcolor{keywordflow}{if}(error)
601          \textcolor{keywordflow}{break};
602 
603       \textcolor{comment}{//Apply the RSADP decryption primitive}
604       error = \hyperlink{rsa_8c_a5288ac4218c0e6f3cc00da6d0ddf21c4}{rsadp}(key, &c, &m);
605       \textcolor{comment}{//Any error to report?}
606       \textcolor{keywordflow}{if}(error)
607          \textcolor{keywordflow}{break};
608 
609       \textcolor{comment}{//Convert the message representative m to an encoded message EM of}
610       \textcolor{comment}{//length k octets}
611       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&m, em, k);
612       \textcolor{comment}{//Conversion failed?}
613       \textcolor{keywordflow}{if}(error)
614          \textcolor{keywordflow}{break};
615 
616       \textcolor{comment}{//Debug message}
617       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
618       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, k);
619 
620       \textcolor{comment}{//EME-OAEP decoding}
621       badPadding = \hyperlink{rsa_8c_a5e002e31dd695eb54953f35b429a2e0b}{emeOaepDecode}(hash, label, em, k, &n);
622 
623       \textcolor{comment}{//Check whether the output buffer is large enough to hold the decrypted}
624       \textcolor{comment}{//message}
625       badLength = \hyperlink{cyclone__crypto_2core_2crypto_8h_a61a9ec36a7ba935b9aa5bd44fbd386a3}{CRYPTO\_TEST\_LT\_32}(messageSize, n);
626 
627       \textcolor{comment}{//Copy the decrypted message, byte per byte}
628       \textcolor{keywordflow}{for}(i = 0; i < messageSize; i++)
629       \{
630          \textcolor{comment}{//Read the whole encoded message EM}
631          \textcolor{keywordflow}{for}(b = 0, j = 0; j < \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}; j++)
632          \{
633             \textcolor{comment}{//Constant time implementation}
634             a = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0714729000f7a99b1c125e96d084161f}{CRYPTO\_TEST\_EQ\_32}(j, k - n + i);
635             b = \hyperlink{cyclone__crypto_2core_2crypto_8h_aa9f5e6d0d42a84bae01ec5e4e6f5c45b}{CRYPTO\_SELECT\_8}(b, em[j], a);
636          \}
637 
638          \textcolor{comment}{//Save the value of the current byte}
639          \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}[i] = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
640       \}
641 
642       \textcolor{comment}{//Return the length of the decrypted message}
643       *messageLen = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(n, messageSize, badLength);
644 
645       \textcolor{comment}{//Check whether the decryption operation is successful}
646       error = (\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t}) \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(error, 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW}, badLength);
647       error = (\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t}) \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(error, 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca42ac4eb97a02112d45b5f0405c0393c1}{ERROR\_DECRYPTION\_FAILED}, badPadding);
648 
649       \textcolor{comment}{//Debug message}
650       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message:\(\backslash\)r\(\backslash\)n"});
651       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, *messageLen);
652 
653       \textcolor{comment}{//End of exception handling block}
654    \} \textcolor{keywordflow}{while}(0);
655 
656    \textcolor{comment}{//Release the encoded message}
657    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(em);
658 
659    \textcolor{comment}{//Release multiple precision integers}
660    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
661    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
662 
663    \textcolor{comment}{//Return status code}
664    \textcolor{keywordflow}{return} error;
665 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a8efc8557a0154f30783e8937a5f3ee46}\label{rsa_8c_a8efc8557a0154f30783e8937a5f3ee46}} 
\index{rsa.\+c@{rsa.\+c}!rsaes\+Oaep\+Encrypt@{rsaes\+Oaep\+Encrypt}}
\index{rsaes\+Oaep\+Encrypt@{rsaes\+Oaep\+Encrypt}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsaes\+Oaep\+Encrypt()}{rsaesOaepEncrypt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsaes\+Oaep\+Encrypt (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{label,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{message,  }\item[{size\+\_\+t}]{message\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ciphertext,  }\item[{size\+\_\+t $\ast$}]{ciphertext\+Len }\end{DoxyParamCaption})}



R\+S\+A\+E\+S-\/\+O\+A\+EP encryption operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em key} & Recipient\textquotesingle{}s R\+SA public key \\
\hline
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em label} & Optional label to be associated with the message \\
\hline
\mbox{\tt in}  & {\em message} & Message to be encrypted \\
\hline
\mbox{\tt in}  & {\em message\+Len} & Length of the message to be encrypted \\
\hline
\mbox{\tt out}  & {\em ciphertext} & Ciphertext resulting from the encryption operation \\
\hline
\mbox{\tt out}  & {\em ciphertext\+Len} & Length of the resulting ciphertext \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 423 of file rsa.\+c.


\begin{DoxyCode}
427 \{
428    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
429    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
430    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
431    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
432    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
433 
434    \textcolor{comment}{//Check parameters}
435    \textcolor{keywordflow}{if}(prngAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || prngContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
436       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
437    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
438       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
439    \textcolor{keywordflow}{if}(ciphertext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || ciphertextLen == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
440       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
441 
442    \textcolor{comment}{//Debug message}
443    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSAES-OAEP encryption...\(\backslash\)r\(\backslash\)n"});
444    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
445    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
446    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
447    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
448    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message:\(\backslash\)r\(\backslash\)n"});
449    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, messageLen);
450 
451    \textcolor{comment}{//Initialize multiple-precision integers}
452    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
453    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
454 
455    \textcolor{comment}{//Get the length in octets of the modulus n}
456    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
457 
458    \textcolor{comment}{//Make sure the modulus is valid}
459    \textcolor{keywordflow}{if}(k == 0)
460       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
461 
462    \textcolor{comment}{//Point to the buffer where the encoded message EM will be formatted}
463    em = ciphertext;
464 
465    \textcolor{comment}{//EME-OAEP encoding}
466    error = \hyperlink{rsa_8c_a68d67e7b81685fbd077f87b68a16b0ea}{emeOaepEncode}(prngAlgo, prngContext, hash, label, 
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message},
467       messageLen, em, k);
468    \textcolor{comment}{//Any error to report?}
469    \textcolor{keywordflow}{if}(error)
470       \textcolor{keywordflow}{return} error;
471 
472    \textcolor{comment}{//Debug message}
473    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
474    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, k);
475 
476    \textcolor{comment}{//Start of exception handling block}
477    \textcolor{keywordflow}{do}
478    \{
479       \textcolor{comment}{//Convert the encoded message EM to an integer message representative m}
480       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&m, em, k);
481       \textcolor{comment}{//Conversion failed?}
482       \textcolor{keywordflow}{if}(error)
483          \textcolor{keywordflow}{break};
484 
485       \textcolor{comment}{//Apply the RSAEP encryption primitive}
486       error = \hyperlink{rsa_8c_aa747fb394b77511f47268bfb77e90e94}{rsaep}(key, &m, &c);
487       \textcolor{comment}{//Any error to report?}
488       \textcolor{keywordflow}{if}(error)
489          \textcolor{keywordflow}{break};
490 
491       \textcolor{comment}{//Convert the ciphertext representative c to a ciphertext of length k octets}
492       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&c, ciphertext, k);
493       \textcolor{comment}{//Conversion failed?}
494       \textcolor{keywordflow}{if}(error)
495          \textcolor{keywordflow}{break};
496 
497       \textcolor{comment}{//Length of the resulting ciphertext}
498       *ciphertextLen = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
499 
500       \textcolor{comment}{//Debug message}
501       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Ciphertext:\(\backslash\)r\(\backslash\)n"});
502       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, ciphertext, *ciphertextLen);
503 
504       \textcolor{comment}{//End of exception handling block}
505    \} \textcolor{keywordflow}{while}(0);
506 
507    \textcolor{comment}{//Free previously allocated memory}
508    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
509    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
510 
511    \textcolor{comment}{//Return status code}
512    \textcolor{keywordflow}{return} error;
513 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a2441cef0529ca8ebb763f566877fc37e}\label{rsa_8c_a2441cef0529ca8ebb763f566877fc37e}} 
\index{rsa.\+c@{rsa.\+c}!rsaes\+Pkcs1v15\+Decrypt@{rsaes\+Pkcs1v15\+Decrypt}}
\index{rsaes\+Pkcs1v15\+Decrypt@{rsaes\+Pkcs1v15\+Decrypt}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsaes\+Pkcs1v15\+Decrypt()}{rsaesPkcs1v15Decrypt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsaes\+Pkcs1v15\+Decrypt (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ciphertext,  }\item[{size\+\_\+t}]{ciphertext\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{message,  }\item[{size\+\_\+t}]{message\+Size,  }\item[{size\+\_\+t $\ast$}]{message\+Len }\end{DoxyParamCaption})}



R\+S\+A\+E\+S-\/\+P\+K\+C\+S1-\/v1\+\_\+5 decryption operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Recipient\textquotesingle{}s R\+SA private key \\
\hline
\mbox{\tt in}  & {\em ciphertext} & Ciphertext to be decrypted \\
\hline
\mbox{\tt in}  & {\em ciphertext\+Len} & Length of the ciphertext to be decrypted \\
\hline
\mbox{\tt out}  & {\em message} & Output buffer where to store the decrypted message \\
\hline
\mbox{\tt in}  & {\em message\+Size} & Size of the output buffer \\
\hline
\mbox{\tt out}  & {\em message\+Len} & Length of the decrypted message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 274 of file rsa.\+c.


\begin{DoxyCode}
277 \{
278    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
279    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
280    \textcolor{keywordtype}{size\_t} i;
281    \textcolor{keywordtype}{size\_t} j;
282    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
283    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
284    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
285    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} badPadding;
286    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} badLength;
287    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
288    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
289    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
290 
291    \textcolor{comment}{//Check parameters}
292    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || ciphertext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
293       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
294    \textcolor{keywordflow}{if}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || messageSize == 0 || messageLen == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
295       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
296 
297    \textcolor{comment}{//Debug message}
298    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSAES-PKCS1-v1\_5 decryption...\(\backslash\)r\(\backslash\)n"});
299    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
300    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
301    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
302    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
303    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private exponent:\(\backslash\)r\(\backslash\)n"});
304    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
305    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 1:\(\backslash\)r\(\backslash\)n"});
306    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
307    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 2:\(\backslash\)r\(\backslash\)n"});
308    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
309    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 1:\(\backslash\)r\(\backslash\)n"});
310    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
311    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 2:\(\backslash\)r\(\backslash\)n"});
312    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
313    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Coefficient:\(\backslash\)r\(\backslash\)n"});
314    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
315    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Ciphertext:\(\backslash\)r\(\backslash\)n"});
316    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, ciphertext, ciphertextLen);
317 
318    \textcolor{comment}{//Initialize multiple-precision integers}
319    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
320    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
321 
322    \textcolor{comment}{//Get the length in octets of the modulus n}
323    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
324 
325    \textcolor{comment}{//Check the length of the ciphertext}
326    \textcolor{keywordflow}{if}(ciphertextLen != k || ciphertextLen < 11)
327       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
328 
329    \textcolor{comment}{//Allocate a buffer to store the encoded message EM}
330    em = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(k);
331    \textcolor{comment}{//Failed to allocate memory?}
332    \textcolor{keywordflow}{if}(em == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
333       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
334 
335    \textcolor{comment}{//Start of exception handling block}
336    \textcolor{keywordflow}{do}
337    \{
338       \textcolor{comment}{//Convert the ciphertext to an integer ciphertext representative c}
339       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&c, ciphertext, ciphertextLen);
340       \textcolor{comment}{//Conversion failed?}
341       \textcolor{keywordflow}{if}(error)
342          \textcolor{keywordflow}{break};
343 
344       \textcolor{comment}{//Apply the RSADP decryption primitive}
345       error = \hyperlink{rsa_8c_a5288ac4218c0e6f3cc00da6d0ddf21c4}{rsadp}(key, &c, &m);
346       \textcolor{comment}{//Any error to report?}
347       \textcolor{keywordflow}{if}(error)
348          \textcolor{keywordflow}{break};
349 
350       \textcolor{comment}{//Convert the message representative m to an encoded message EM of}
351       \textcolor{comment}{//length k octets}
352       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&m, em, k);
353       \textcolor{comment}{//Conversion failed?}
354       \textcolor{keywordflow}{if}(error)
355          \textcolor{keywordflow}{break};
356 
357       \textcolor{comment}{//Debug message}
358       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
359       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, k);
360 
361       \textcolor{comment}{//EME-PKCS1-v1\_5 decoding}
362       badPadding = \hyperlink{rsa_8c_a4476eea5c60b091fbac68c4d29dbbbbb}{emePkcs1v15Decode}(em, k, &n);
363 
364       \textcolor{comment}{//Check whether the output buffer is large enough to hold the decrypted}
365       \textcolor{comment}{//message}
366       badLength = \hyperlink{cyclone__crypto_2core_2crypto_8h_a61a9ec36a7ba935b9aa5bd44fbd386a3}{CRYPTO\_TEST\_LT\_32}(messageSize, n);
367 
368       \textcolor{comment}{//Copy the decrypted message, byte per byte}
369       \textcolor{keywordflow}{for}(i = 0; i < messageSize; i++)
370       \{
371          \textcolor{comment}{//Read the whole encoded message EM}
372          \textcolor{keywordflow}{for}(b = 0, j = 0; j < \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}; j++)
373          \{
374             \textcolor{comment}{//Constant time implementation}
375             a = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0714729000f7a99b1c125e96d084161f}{CRYPTO\_TEST\_EQ\_32}(j, k - n + i);
376             b = \hyperlink{cyclone__crypto_2core_2crypto_8h_aa9f5e6d0d42a84bae01ec5e4e6f5c45b}{CRYPTO\_SELECT\_8}(b, em[j], a);
377          \}
378 
379          \textcolor{comment}{//Save the value of the current byte}
380          \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}[i] = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
381       \}
382 
383       \textcolor{comment}{//Return the length of the decrypted message}
384       *messageLen = \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(n, messageSize, badLength);
385 
386       \textcolor{comment}{//Check whether the decryption operation is successful}
387       error = (\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t}) \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(error, 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW}, badLength);
388       error = (\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t}) \hyperlink{cyclone__crypto_2core_2crypto_8h_a0c5339f6a93ab2d30e4ac5d222195d47}{CRYPTO\_SELECT\_32}(error, 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca42ac4eb97a02112d45b5f0405c0393c1}{ERROR\_DECRYPTION\_FAILED}, badPadding);
389 
390       \textcolor{comment}{//Debug message}
391       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message:\(\backslash\)r\(\backslash\)n"});
392       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, *messageLen);
393 
394       \textcolor{comment}{//End of exception handling block}
395    \} \textcolor{keywordflow}{while}(0);
396 
397    \textcolor{comment}{//Release the encoded message}
398    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(em);
399 
400    \textcolor{comment}{//Release multiple precision integers}
401    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
402    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
403 
404    \textcolor{comment}{//Return status code}
405    \textcolor{keywordflow}{return} error;
406 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a1c7acb4138d300d842d80320df4a0cde}\label{rsa_8c_a1c7acb4138d300d842d80320df4a0cde}} 
\index{rsa.\+c@{rsa.\+c}!rsaes\+Pkcs1v15\+Encrypt@{rsaes\+Pkcs1v15\+Encrypt}}
\index{rsaes\+Pkcs1v15\+Encrypt@{rsaes\+Pkcs1v15\+Encrypt}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsaes\+Pkcs1v15\+Encrypt()}{rsaesPkcs1v15Encrypt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsaes\+Pkcs1v15\+Encrypt (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{message,  }\item[{size\+\_\+t}]{message\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ciphertext,  }\item[{size\+\_\+t $\ast$}]{ciphertext\+Len }\end{DoxyParamCaption})}



R\+S\+A\+E\+S-\/\+P\+K\+C\+S1-\/v1\+\_\+5 encryption operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em key} & Recipient\textquotesingle{}s R\+SA public key \\
\hline
\mbox{\tt in}  & {\em message} & Message to be encrypted \\
\hline
\mbox{\tt in}  & {\em message\+Len} & Length of the message to be encrypted \\
\hline
\mbox{\tt out}  & {\em ciphertext} & Ciphertext resulting from the encryption operation \\
\hline
\mbox{\tt out}  & {\em ciphertext\+Len} & Length of the resulting ciphertext \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 176 of file rsa.\+c.


\begin{DoxyCode}
179 \{
180    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
181    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
182    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
183    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
184    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
185 
186    \textcolor{comment}{//Check parameters}
187    \textcolor{keywordflow}{if}(prngAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || prngContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
188       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
189    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
190       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
191    \textcolor{keywordflow}{if}(ciphertext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || ciphertextLen == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
192       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
193 
194    \textcolor{comment}{//Debug message}
195    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSAES-PKCS1-v1\_5 encryption...\(\backslash\)r\(\backslash\)n"});
196    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
197    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
198    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
199    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
200    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message:\(\backslash\)r\(\backslash\)n"});
201    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, messageLen);
202 
203    \textcolor{comment}{//Initialize multiple-precision integers}
204    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
205    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
206 
207    \textcolor{comment}{//Get the length in octets of the modulus n}
208    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
209 
210    \textcolor{comment}{//Point to the buffer where the encoded message EM will be formatted}
211    em = ciphertext;
212 
213    \textcolor{comment}{//EME-PKCS1-v1\_5 encoding}
214    error = \hyperlink{rsa_8c_a1b04d815975669a6b26f8b68847ce029}{emePkcs1v15Encode}(prngAlgo, prngContext, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, messageLen, em, k);
215    \textcolor{comment}{//Any error to report?}
216    \textcolor{keywordflow}{if}(error)
217       \textcolor{keywordflow}{return} error;
218 
219    \textcolor{comment}{//Debug message}
220    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
221    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, k);
222 
223    \textcolor{comment}{//Start of exception handling block}
224    \textcolor{keywordflow}{do}
225    \{
226       \textcolor{comment}{//Convert the encoded message EM to an integer message representative m}
227       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&m, em, k);
228       \textcolor{comment}{//Conversion failed?}
229       \textcolor{keywordflow}{if}(error)
230          \textcolor{keywordflow}{break};
231 
232       \textcolor{comment}{//Apply the RSAEP encryption primitive}
233       error = \hyperlink{rsa_8c_aa747fb394b77511f47268bfb77e90e94}{rsaep}(key, &m, &c);
234       \textcolor{comment}{//Any error to report?}
235       \textcolor{keywordflow}{if}(error)
236          \textcolor{keywordflow}{break};
237 
238       \textcolor{comment}{//Convert the ciphertext representative c to a ciphertext of length k octets}
239       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&c, ciphertext, k);
240       \textcolor{comment}{//Conversion failed?}
241       \textcolor{keywordflow}{if}(error)
242          \textcolor{keywordflow}{break};
243 
244       \textcolor{comment}{//Length of the resulting ciphertext}
245       *ciphertextLen = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
246 
247       \textcolor{comment}{//Debug message}
248       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Ciphertext:\(\backslash\)r\(\backslash\)n"});
249       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, ciphertext, *ciphertextLen);
250 
251       \textcolor{comment}{//End of exception handling block}
252    \} \textcolor{keywordflow}{while}(0);
253 
254    \textcolor{comment}{//Free previously allocated memory}
255    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
256    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
257 
258    \textcolor{comment}{//Return status code}
259    \textcolor{keywordflow}{return} error;
260 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a14ee0338e3149b934552c40b97c8f096}\label{rsa_8c_a14ee0338e3149b934552c40b97c8f096}} 
\index{rsa.\+c@{rsa.\+c}!rsa\+Free\+Private\+Key@{rsa\+Free\+Private\+Key}}
\index{rsa\+Free\+Private\+Key@{rsa\+Free\+Private\+Key}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsa\+Free\+Private\+Key()}{rsaFreePrivateKey()}}
{\footnotesize\ttfamily void rsa\+Free\+Private\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key }\end{DoxyParamCaption})}



Release an R\+SA private key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Pointer to the R\+SA private key to free \\
\hline
\end{DoxyParams}


Definition at line 150 of file rsa.\+c.


\begin{DoxyCode}
151 \{
152    \textcolor{comment}{//Free multiple precision integers}
153    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
154    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
155    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
156    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
157    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
158    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
159    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
160    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
161 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a6dc1711d56454b2a6e565199509d884e}\label{rsa_8c_a6dc1711d56454b2a6e565199509d884e}} 
\index{rsa.\+c@{rsa.\+c}!rsa\+Free\+Public\+Key@{rsa\+Free\+Public\+Key}}
\index{rsa\+Free\+Public\+Key@{rsa\+Free\+Public\+Key}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsa\+Free\+Public\+Key()}{rsaFreePublicKey()}}
{\footnotesize\ttfamily void rsa\+Free\+Public\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key }\end{DoxyParamCaption})}



Release an R\+SA public key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Pointer to the R\+SA public key to free \\
\hline
\end{DoxyParams}


Definition at line 118 of file rsa.\+c.


\begin{DoxyCode}
119 \{
120    \textcolor{comment}{//Free multiple precision integers}
121    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
122    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
123 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a50211782db4f1f58fef305d71993fa55}\label{rsa_8c_a50211782db4f1f58fef305d71993fa55}} 
\index{rsa.\+c@{rsa.\+c}!rsa\+Generate\+Key\+Pair@{rsa\+Generate\+Key\+Pair}}
\index{rsa\+Generate\+Key\+Pair@{rsa\+Generate\+Key\+Pair}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsa\+Generate\+Key\+Pair()}{rsaGenerateKeyPair()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsa\+Generate\+Key\+Pair (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{size\+\_\+t}]{k,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{e,  }\item[{\hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{private\+Key,  }\item[{\hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{public\+Key }\end{DoxyParamCaption})}



R\+SA key pair generation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em k} & Required bit length of the modulus n \\
\hline
\mbox{\tt in}  & {\em e} & Public exponent (3, 5, 17, 257 or 65537) \\
\hline
\mbox{\tt out}  & {\em private\+Key} & R\+SA private key \\
\hline
\mbox{\tt out}  & {\em public\+Key} & R\+SA public key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1951 of file rsa.\+c.


\begin{DoxyCode}
1953 \{
1954    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1955    \hyperlink{structMpi}{Mpi} \hyperlink{tiger_8c_a5017152cac85e29a2dc5d8d74de9e07c}{t1};
1956    \hyperlink{structMpi}{Mpi} \hyperlink{tiger_8c_a42a80c4c472115c0fcb04a076526ecf5}{t2};
1957    \hyperlink{structMpi}{Mpi} phy;
1958 
1959    \textcolor{comment}{//Check parameters}
1960    \textcolor{keywordflow}{if}(prngAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || prngContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || privateKey == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1961       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1962 
1963    \textcolor{comment}{//Check the length of the modulus}
1964    \textcolor{keywordflow}{if}(\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} < 8)
1965       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1966 
1967    \textcolor{comment}{//Check the value of the public exponent}
1968    \textcolor{keywordflow}{if}(e != 3 && e != 5 && e != 17 && e != 257 && e != 65537)
1969       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1970 
1971    \textcolor{comment}{//Initialize multiple precision integers}
1972    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&t1);
1973    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&t2);
1974    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&phy);
1975 
1976    \textcolor{comment}{//Save public exponent}
1977    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(&privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}, e));
1978 
1979    \textcolor{comment}{//Generate a large random prime p}
1980    \textcolor{keywordflow}{do}
1981    \{
1982       \textcolor{keywordflow}{do}
1983       \{
1984          \textcolor{comment}{//Generate a random number of bit length k/2}
1985          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a9753c7bf919b7c41e48512ba572c3bbb}{mpiRand}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} / 2, prngAlgo, prngContext));
1986          \textcolor{comment}{//Set the low bit (this ensures the number is odd)}
1987          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, 0, 1));
1988          \textcolor{comment}{//Set the two highest bits (this ensures that the high bit of n is also set)}
1989          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} / 2 - 1, 1));
1990          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} / 2 - 2, 1));
1991 
1992          \textcolor{comment}{//Test whether p is a probable prime}
1993          error = \hyperlink{samd51__crypto__pukcc_8c_afc585fe41f6754070e5d99e61cc9a2b1}{mpiCheckProbablePrime}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
1994 
1995          \textcolor{comment}{//Repeat until an acceptable value is found}
1996       \} \textcolor{keywordflow}{while}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca979424b1dc1779fe6193ab5161329513}{ERROR\_INVALID\_VALUE});
1997 
1998       \textcolor{comment}{//Check status code}
1999       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(error);
2000 
2001       \textcolor{comment}{//Compute p mod e}
2002       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(&t1, &privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, &privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}));
2003 
2004       \textcolor{comment}{//Repeat as long as p mod e = 1}
2005    \} \textcolor{keywordflow}{while}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(&t1, 1) == 0);
2006 
2007    \textcolor{comment}{//Generate a large random prime q}
2008    \textcolor{keywordflow}{do}
2009    \{
2010       \textcolor{keywordflow}{do}
2011       \{
2012          \textcolor{comment}{//Generate random number of bit length k - k/2}
2013          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a9753c7bf919b7c41e48512ba572c3bbb}{mpiRand}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - (\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} / 2), prngAlgo, prngContext));
2014          \textcolor{comment}{//Set the low bit (this ensures the number is odd)}
2015          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, 0, 1));
2016          \textcolor{comment}{//Set the two highest bits (this ensures that the high bit of n is also set)}
2017          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - (
      \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} / 2) - 1, 1));
2018          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} - (
      \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} / 2) - 2, 1));
2019 
2020          \textcolor{comment}{//Test whether q is a probable prime}
2021          error = \hyperlink{samd51__crypto__pukcc_8c_afc585fe41f6754070e5d99e61cc9a2b1}{mpiCheckProbablePrime}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
2022 
2023          \textcolor{comment}{//Repeat until an acceptable value is found}
2024       \} \textcolor{keywordflow}{while}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca979424b1dc1779fe6193ab5161329513}{ERROR\_INVALID\_VALUE});
2025 
2026       \textcolor{comment}{//Check status code}
2027       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(error);
2028 
2029       \textcolor{comment}{//Compute q mod e}
2030       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(&t2, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, &privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}));
2031 
2032       \textcolor{comment}{//Repeat as long as p mod e = 1}
2033    \} \textcolor{keywordflow}{while}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(&t2, 1) == 0);
2034 
2035    \textcolor{comment}{//Make sure p an q are distinct}
2036    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}) == 0)
2037    \{
2038       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE});
2039    \}
2040 
2041    \textcolor{comment}{//If p < q, then swap p and q (this only matters if the CRT form of}
2042    \textcolor{comment}{//the private key is used)}
2043    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}) < 0)
2044    \{
2045       \textcolor{comment}{//Swap primes}
2046       \hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&t1, &privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
2047       \hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
2048       \hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, &t1);
2049    \}
2050 
2051    \textcolor{comment}{//Compute the modulus n = pq}
2052    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_a5ce82adaded4af385feef6b79aaad6d2}{mpiMul}(&privateKey->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}, &privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, &privateKey->
      \hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}));
2053 
2054    \textcolor{comment}{//Compute phy = (p-1)(q-1)}
2055    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a77f0e675dfb77c89650dee4c39561891}{mpiSubInt}(&t1, &privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, 1));
2056    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a77f0e675dfb77c89650dee4c39561891}{mpiSubInt}(&t2, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, 1));
2057    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_a5ce82adaded4af385feef6b79aaad6d2}{mpiMul}(&phy, &t1, &t2));
2058 
2059    \textcolor{comment}{//Compute d = e^-1 mod phy}
2060    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_a2195ea62b59019943aa5bfa4d309028f}{mpiInvMod}(&privateKey->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d}, &privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}, &phy));
2061    \textcolor{comment}{//Compute dP = d mod (p-1)}
2062    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(&privateKey->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp}, &privateKey->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d}, &t1));
2063    \textcolor{comment}{//Compute dQ = d mod (q-1)}
2064    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(&privateKey->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq}, &privateKey->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d}, &t2));
2065    \textcolor{comment}{//Compute qInv = q^-1 mod p}
2066    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{samd51__crypto__pukcc_8c_a2195ea62b59019943aa5bfa4d309028f}{mpiInvMod}(&privateKey->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv}, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, &privateKey->
      \hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}));
2067 
2068    \textcolor{comment}{//Debug message}
2069    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSA private key:\(\backslash\)r\(\backslash\)n"});
2070    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
2071    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
2072    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
2073    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
2074    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private exponent:\(\backslash\)r\(\backslash\)n"});
2075    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
2076    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 1:\(\backslash\)r\(\backslash\)n"});
2077    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
2078    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 2:\(\backslash\)r\(\backslash\)n"});
2079    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
2080    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 1:\(\backslash\)r\(\backslash\)n"});
2081    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
2082    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 2:\(\backslash\)r\(\backslash\)n"});
2083    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
2084    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Coefficient:\(\backslash\)r\(\backslash\)n"});
2085    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
2086 
2087    \textcolor{comment}{//An public key can be optionally generated}
2088    \textcolor{keywordflow}{if}(publicKey != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
2089    \{
2090       \textcolor{comment}{//The public key is (n, e)}
2091       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&publicKey->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n}, &privateKey->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}));
2092       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&publicKey->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e}, &privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}));
2093 
2094       \textcolor{comment}{//Debug message}
2095       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSA public key:\(\backslash\)r\(\backslash\)n"});
2096       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
2097       \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
2098       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
2099       \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
2100    \}
2101 
2102 end:
2103    \textcolor{comment}{//Release multiple precision integers}
2104    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&t1);
2105    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&t2);
2106    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&phy);
2107 
2108    \textcolor{comment}{//Any error to report?}
2109    \textcolor{keywordflow}{if}(error)
2110    \{
2111       \textcolor{comment}{//Release RSA private key}
2112       \hyperlink{rsa_8c_a14ee0338e3149b934552c40b97c8f096}{rsaFreePrivateKey}(privateKey);
2113 
2114       \textcolor{comment}{//Release RSA public key}
2115       \textcolor{keywordflow}{if}(publicKey != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
2116          \hyperlink{rsa_8c_a6dc1711d56454b2a6e565199509d884e}{rsaFreePublicKey}(publicKey);
2117    \}
2118 
2119    \textcolor{comment}{//Return status code}
2120    \textcolor{keywordflow}{return} error;
2121 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_ad454d9bc34f7d9fa5717180707365e69}\label{rsa_8c_ad454d9bc34f7d9fa5717180707365e69}} 
\index{rsa.\+c@{rsa.\+c}!rsa\+Init\+Private\+Key@{rsa\+Init\+Private\+Key}}
\index{rsa\+Init\+Private\+Key@{rsa\+Init\+Private\+Key}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsa\+Init\+Private\+Key()}{rsaInitPrivateKey()}}
{\footnotesize\ttfamily void rsa\+Init\+Private\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key }\end{DoxyParamCaption})}



Initialize an R\+SA private key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Pointer to the R\+SA private key to initialize \\
\hline
\end{DoxyParams}


Definition at line 131 of file rsa.\+c.


\begin{DoxyCode}
132 \{
133    \textcolor{comment}{//Initialize multiple precision integers}
134    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
135    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
136    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
137    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
138    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
139    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
140    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
141    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
142 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_af3d3a1f0ce23e006da06325cc37c4063}\label{rsa_8c_af3d3a1f0ce23e006da06325cc37c4063}} 
\index{rsa.\+c@{rsa.\+c}!rsa\+Init\+Public\+Key@{rsa\+Init\+Public\+Key}}
\index{rsa\+Init\+Public\+Key@{rsa\+Init\+Public\+Key}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsa\+Init\+Public\+Key()}{rsaInitPublicKey()}}
{\footnotesize\ttfamily void rsa\+Init\+Public\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key }\end{DoxyParamCaption})}



Initialize an R\+SA public key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Pointer to the R\+SA public key to initialize \\
\hline
\end{DoxyParams}


Definition at line 105 of file rsa.\+c.


\begin{DoxyCode}
106 \{
107    \textcolor{comment}{//Initialize multiple precision integers}
108    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
109    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
110 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a36efdd5187b817ffb4a5c1eebcdec68c}\label{rsa_8c_a36efdd5187b817ffb4a5c1eebcdec68c}} 
\index{rsa.\+c@{rsa.\+c}!rsasp1@{rsasp1}}
\index{rsasp1@{rsasp1}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsasp1()}{rsasp1()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsasp1 (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{m,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{s }\end{DoxyParamCaption})}



R\+SA signature primitive. 

The R\+SA signature primitive produces a signature representative from a message representative under the control of a private key


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & R\+SA private key \\
\hline
\mbox{\tt in}  & {\em m} & Message representative \\
\hline
\mbox{\tt out}  & {\em s} & Signature representative \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1248 of file rsa.\+c.


\begin{DoxyCode}
1249 \{
1250    \textcolor{comment}{//RSASP1 primitive is the same as RSADP except for the names of its input}
1251    \textcolor{comment}{//and output arguments. They are distinguished as they are intended for}
1252    \textcolor{comment}{//different purposes}
1253    \textcolor{keywordflow}{return} \hyperlink{rsa_8c_a5288ac4218c0e6f3cc00da6d0ddf21c4}{rsadp}(key, m, s);
1254 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_aa11231857578f3d094759dd7789015b8}\label{rsa_8c_aa11231857578f3d094759dd7789015b8}} 
\index{rsa.\+c@{rsa.\+c}!rsassa\+Pkcs1v15\+Sign@{rsassa\+Pkcs1v15\+Sign}}
\index{rsassa\+Pkcs1v15\+Sign@{rsassa\+Pkcs1v15\+Sign}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsassa\+Pkcs1v15\+Sign()}{rsassaPkcs1v15Sign()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsassa\+Pkcs1v15\+Sign (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{signature,  }\item[{size\+\_\+t $\ast$}]{signature\+Len }\end{DoxyParamCaption})}



R\+S\+A\+S\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 signature generation operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Signer\textquotesingle{}s R\+SA private key \\
\hline
\mbox{\tt in}  & {\em hash} & Hash function used to digest the message \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message to be signed \\
\hline
\mbox{\tt out}  & {\em signature} & Resulting signature \\
\hline
\mbox{\tt out}  & {\em signature\+Len} & Length of the resulting signature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 678 of file rsa.\+c.


\begin{DoxyCode}
680 \{
681    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
682    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
683    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
684    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
685    \hyperlink{structMpi}{Mpi} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
686    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
687 
688    \textcolor{comment}{//Check parameters}
689    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || digest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
690       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
691    \textcolor{keywordflow}{if}(\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || signatureLen == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
692       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
693 
694    \textcolor{comment}{//Debug message}
695    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSASSA-PKCS1-v1\_5 signature generation...\(\backslash\)r\(\backslash\)n"});
696    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
697    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
698    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
699    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
700    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private exponent:\(\backslash\)r\(\backslash\)n"});
701    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
702    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 1:\(\backslash\)r\(\backslash\)n"});
703    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
704    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 2:\(\backslash\)r\(\backslash\)n"});
705    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
706    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 1:\(\backslash\)r\(\backslash\)n"});
707    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
708    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 2:\(\backslash\)r\(\backslash\)n"});
709    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
710    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Coefficient:\(\backslash\)r\(\backslash\)n"});
711    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
712    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message digest:\(\backslash\)r\(\backslash\)n"});
713    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
714 
715    \textcolor{comment}{//Initialize multiple-precision integers}
716    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
717    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&s);
718    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&t);
719 
720    \textcolor{comment}{//Get the length in octets of the modulus n}
721    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
722    \textcolor{comment}{//Point to the buffer where the encoded message EM will be formatted}
723    em = \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature};
724 
725    \textcolor{comment}{//Apply the EMSA-PKCS1-v1.5 encoding operation}
726    error = \hyperlink{rsa_8c_a7eec30cb6f589d520b380bc37ed655f0}{emsaPkcs1v15Encode}(hash, digest, em, k);
727    \textcolor{comment}{//Any error to report?}
728    \textcolor{keywordflow}{if}(error)
729       \textcolor{keywordflow}{return} error;
730 
731    \textcolor{comment}{//Debug message}
732    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
733    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, k);
734 
735    \textcolor{comment}{//Start of exception handling block}
736    \textcolor{keywordflow}{do}
737    \{
738       \textcolor{comment}{//Convert the encoded message EM to an integer message representative m}
739       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&m, em, k);
740       \textcolor{comment}{//Conversion failed?}
741       \textcolor{keywordflow}{if}(error)
742          \textcolor{keywordflow}{break};
743 
744       \textcolor{comment}{//Apply the RSASP1 signature primitive}
745       error = \hyperlink{rsa_8c_a36efdd5187b817ffb4a5c1eebcdec68c}{rsasp1}(key, &m, &s);
746       \textcolor{comment}{//Any error to report?}
747       \textcolor{keywordflow}{if}(error)
748          \textcolor{keywordflow}{break};
749 
750       \textcolor{comment}{//When unprotected, RSACRT is vulnerable to the Bellcore attack}
751       \textcolor{keywordflow}{if}(key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}.
      \hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} &&
752          key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} && key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv}.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
753       \{
754          \hyperlink{structRsaPublicKey}{RsaPublicKey} publicKey;
755 
756          \textcolor{comment}{//Retrieve modulus and public exponent}
757          publicKey.\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n} = key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n};
758          publicKey.\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e} = key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e};
759 
760          \textcolor{comment}{//Apply the RSAVP1 verification primitive}
761          error = \hyperlink{rsa_8c_ae3bd572570d3ad77ce2cf5169f8b4417}{rsavp1}(&publicKey, &s, &t);
762          \textcolor{comment}{//Any error to report?}
763          \textcolor{keywordflow}{if}(error)
764             \textcolor{keywordflow}{break};
765 
766          \textcolor{comment}{//Verify the RSA signature in order to protect against RSA-CRT key leak}
767          \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(&t, &m) != 0)
768          \{
769             \textcolor{comment}{//A signature fault has been detected}
770             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
771             \textcolor{keywordflow}{break};
772          \}
773       \}
774 
775       \textcolor{comment}{//Convert the signature representative s to a signature of length k octets}
776       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&s, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, k);
777       \textcolor{comment}{//Conversion failed?}
778       \textcolor{keywordflow}{if}(error)
779          \textcolor{keywordflow}{break};
780 
781       \textcolor{comment}{//Length of the resulting signature}
782       *signatureLen = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
783 
784       \textcolor{comment}{//Debug message}
785       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Signature:\(\backslash\)r\(\backslash\)n"});
786       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, *signatureLen);
787 
788       \textcolor{comment}{//End of exception handling block}
789    \} \textcolor{keywordflow}{while}(0);
790 
791    \textcolor{comment}{//Free previously allocated memory}
792    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
793    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&s);
794    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&t);
795 
796    \textcolor{comment}{//Return status code}
797    \textcolor{keywordflow}{return} error;
798 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_ac8bc3701e41ec2201abf77a280dfbc01}\label{rsa_8c_ac8bc3701e41ec2201abf77a280dfbc01}} 
\index{rsa.\+c@{rsa.\+c}!rsassa\+Pkcs1v15\+Verify@{rsassa\+Pkcs1v15\+Verify}}
\index{rsassa\+Pkcs1v15\+Verify@{rsassa\+Pkcs1v15\+Verify}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsassa\+Pkcs1v15\+Verify()}{rsassaPkcs1v15Verify()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsassa\+Pkcs1v15\+Verify (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{signature,  }\item[{size\+\_\+t}]{signature\+Len }\end{DoxyParamCaption})}



R\+S\+A\+S\+S\+A-\/\+P\+K\+C\+S1-\/v1\+\_\+5 signature verification operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Signer\textquotesingle{}s R\+SA public key \\
\hline
\mbox{\tt in}  & {\em hash} & Hash function used to digest the message \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message whose signature is to be verified \\
\hline
\mbox{\tt in}  & {\em signature} & Signature to be verified \\
\hline
\mbox{\tt in}  & {\em signature\+Len} & Length of the signature to be verified \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 811 of file rsa.\+c.


\begin{DoxyCode}
813 \{
814    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
815    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
816    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
817    \hyperlink{structMpi}{Mpi} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
818    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
819 
820    \textcolor{comment}{//Check parameters}
821    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || digest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature} == 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
822       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
823 
824    \textcolor{comment}{//Debug message}
825    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSASSA-PKCS1-v1\_5 signature verification...\(\backslash\)r\(\backslash\)n"});
826    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
827    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
828    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
829    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
830    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message digest:\(\backslash\)r\(\backslash\)n"});
831    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
832    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Signature:\(\backslash\)r\(\backslash\)n"});
833    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, signatureLen);
834 
835    \textcolor{comment}{//Initialize multiple-precision integers}
836    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&s);
837    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
838 
839    \textcolor{comment}{//Get the length in octets of the modulus n}
840    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
841 
842    \textcolor{comment}{//Make sure the modulus is valid}
843    \textcolor{keywordflow}{if}(k == 0)
844       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
845 
846    \textcolor{comment}{//Check the length of the signature}
847    \textcolor{keywordflow}{if}(signatureLen != k)
848       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48}{ERROR\_INVALID\_SIGNATURE};
849 
850    \textcolor{comment}{//Allocate a memory buffer to hold the encoded message}
851    em = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(k);
852    \textcolor{comment}{//Failed to allocate memory?}
853    \textcolor{keywordflow}{if}(em == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
854       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
855 
856    \textcolor{comment}{//Start of exception handling block}
857    \textcolor{keywordflow}{do}
858    \{
859       \textcolor{comment}{//Convert the signature to an integer signature representative s}
860       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&s, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, signatureLen);
861       \textcolor{comment}{//Conversion failed?}
862       \textcolor{keywordflow}{if}(error)
863          \textcolor{keywordflow}{break};
864 
865       \textcolor{comment}{//Apply the RSAVP1 verification primitive}
866       error = \hyperlink{rsa_8c_ae3bd572570d3ad77ce2cf5169f8b4417}{rsavp1}(key, &s, &m);
867       \textcolor{comment}{//Any error to report?}
868       \textcolor{keywordflow}{if}(error)
869          \textcolor{keywordflow}{break};
870 
871       \textcolor{comment}{//Convert the message representative m to an encoded message EM of}
872       \textcolor{comment}{//length k octets}
873       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&m, em, k);
874       \textcolor{comment}{//Conversion failed?}
875       \textcolor{keywordflow}{if}(error)
876          \textcolor{keywordflow}{break};
877 
878       \textcolor{comment}{//Debug message}
879       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
880       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, k);
881 
882       \textcolor{comment}{//Verify the encoded message EM}
883       error = \hyperlink{rsa_8c_adf2b3eb984c081a403ca5c73667586e6}{emsaPkcs1v15Verify}(hash, digest, em, k);
884       \textcolor{comment}{//Any error to report?}
885       \textcolor{keywordflow}{if}(error)
886       \{
887          \textcolor{comment}{//The signature is not valid}
888          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48}{ERROR\_INVALID\_SIGNATURE};
889          \textcolor{keywordflow}{break};
890       \}
891 
892       \textcolor{comment}{//End of exception handling block}
893    \} \textcolor{keywordflow}{while}(0);
894 
895    \textcolor{comment}{//Release the encoded message}
896    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(em);
897 
898    \textcolor{comment}{//Release multiple precision integers}
899    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&s);
900    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
901 
902    \textcolor{comment}{//Return status code}
903    \textcolor{keywordflow}{return} error;
904 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a2bc9405e58c8ce947d411cd9751e96b2}\label{rsa_8c_a2bc9405e58c8ce947d411cd9751e96b2}} 
\index{rsa.\+c@{rsa.\+c}!rsassa\+Pss\+Sign@{rsassa\+Pss\+Sign}}
\index{rsassa\+Pss\+Sign@{rsassa\+Pss\+Sign}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsassa\+Pss\+Sign()}{rsassaPssSign()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsassa\+Pss\+Sign (\begin{DoxyParamCaption}\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context,  }\item[{const \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{size\+\_\+t}]{salt\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{signature,  }\item[{size\+\_\+t $\ast$}]{signature\+Len }\end{DoxyParamCaption})}



R\+S\+A\+S\+S\+A-\/\+P\+SS signature generation operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\mbox{\tt in}  & {\em key} & Signer\textquotesingle{}s R\+SA private key \\
\hline
\mbox{\tt in}  & {\em hash} & Hash function used to digest the message \\
\hline
\mbox{\tt in}  & {\em salt\+Len} & Length of the salt, in bytes \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message to be signed \\
\hline
\mbox{\tt out}  & {\em signature} & Resulting signature \\
\hline
\mbox{\tt out}  & {\em signature\+Len} & Length of the resulting signature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 920 of file rsa.\+c.


\begin{DoxyCode}
923 \{
924    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
925    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
926    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} modBits;
927    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
928    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
929    \hyperlink{structMpi}{Mpi} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
930 
931    \textcolor{comment}{//Check parameters}
932    \textcolor{keywordflow}{if}(prngAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || prngContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
933       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
934    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || digest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
935       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
936    \textcolor{keywordflow}{if}(\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || signatureLen == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
937       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
938 
939    \textcolor{comment}{//Debug message}
940    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSASSA-PSS signature generation...\(\backslash\)r\(\backslash\)n"});
941    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
942    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
943    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
944    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
945    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private exponent:\(\backslash\)r\(\backslash\)n"});
946    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
947    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 1:\(\backslash\)r\(\backslash\)n"});
948    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
949    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 2:\(\backslash\)r\(\backslash\)n"});
950    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
951    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 1:\(\backslash\)r\(\backslash\)n"});
952    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
953    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 2:\(\backslash\)r\(\backslash\)n"});
954    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
955    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Coefficient:\(\backslash\)r\(\backslash\)n"});
956    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
957    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message digest:\(\backslash\)r\(\backslash\)n"});
958    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
959 
960    \textcolor{comment}{//Initialize multiple-precision integers}
961    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
962    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&s);
963 
964    \textcolor{comment}{//modBits is the length in bits of the modulus n}
965    modBits = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(&key->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
966 
967    \textcolor{comment}{//Make sure the modulus is valid}
968    \textcolor{keywordflow}{if}(modBits == 0)
969       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
970 
971    \textcolor{comment}{//Calculate the length in octets of the modulus n}
972    k = (modBits + 7) / 8;
973 
974    \textcolor{comment}{//Point to the buffer where the encoded message EM will be formatted}
975    em = \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature};
976 
977    \textcolor{comment}{//Apply the EMSA-PSS encoding operation to the message M to produce an}
978    \textcolor{comment}{//encoded message EM of length ceil((modBits - 1) / 8) octets}
979    error = \hyperlink{rsa_8c_ae703b31c8c30e8df45449f1a847522a7}{emsaPssEncode}(prngAlgo, prngContext, hash, saltLen, digest,
980       em, modBits - 1);
981    \textcolor{comment}{//Any error to report?}
982    \textcolor{keywordflow}{if}(error)
983       \textcolor{keywordflow}{return} error;
984 
985    \textcolor{comment}{//Debug message}
986    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
987    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, (modBits + 6) / 8);
988 
989    \textcolor{comment}{//Start of exception handling block}
990    \textcolor{keywordflow}{do}
991    \{
992       \textcolor{comment}{//Convert the encoded message EM to an integer message representative m}
993       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&m, em, (modBits + 6) / 8);
994       \textcolor{comment}{//Conversion failed?}
995       \textcolor{keywordflow}{if}(error)
996          \textcolor{keywordflow}{break};
997 
998       \textcolor{comment}{//Apply the RSASP1 signature primitive}
999       error = \hyperlink{rsa_8c_a36efdd5187b817ffb4a5c1eebcdec68c}{rsasp1}(key, &m, &s);
1000       \textcolor{comment}{//Any error to report?}
1001       \textcolor{keywordflow}{if}(error)
1002          \textcolor{keywordflow}{break};
1003 
1004       \textcolor{comment}{//Convert the signature representative s to a signature of length k octets}
1005       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&s, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, k);
1006       \textcolor{comment}{//Conversion failed?}
1007       \textcolor{keywordflow}{if}(error)
1008          \textcolor{keywordflow}{break};
1009 
1010       \textcolor{comment}{//Length of the resulting signature}
1011       *signatureLen = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
1012 
1013       \textcolor{comment}{//Debug message}
1014       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Signature:\(\backslash\)r\(\backslash\)n"});
1015       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, *signatureLen);
1016 
1017       \textcolor{comment}{//End of exception handling block}
1018    \} \textcolor{keywordflow}{while}(0);
1019 
1020    \textcolor{comment}{//Free previously allocated memory}
1021    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
1022    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&s);
1023 
1024    \textcolor{comment}{//Return status code}
1025    \textcolor{keywordflow}{return} error;
1026 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_a353c0daced94ff0a95ec1067f6f9048c}\label{rsa_8c_a353c0daced94ff0a95ec1067f6f9048c}} 
\index{rsa.\+c@{rsa.\+c}!rsassa\+Pss\+Verify@{rsassa\+Pss\+Verify}}
\index{rsassa\+Pss\+Verify@{rsassa\+Pss\+Verify}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsassa\+Pss\+Verify()}{rsassaPssVerify()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsassa\+Pss\+Verify (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{size\+\_\+t}]{salt\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{signature,  }\item[{size\+\_\+t}]{signature\+Len }\end{DoxyParamCaption})}



R\+S\+A\+S\+S\+A-\/\+P\+SS signature verification operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & Signer\textquotesingle{}s R\+SA public key \\
\hline
\mbox{\tt in}  & {\em hash} & Hash function used to digest the message \\
\hline
\mbox{\tt in}  & {\em salt\+Len} & Length of the salt, in bytes \\
\hline
\mbox{\tt in}  & {\em digest} & Digest of the message whose signature is to be verified \\
\hline
\mbox{\tt in}  & {\em signature} & Signature to be verified \\
\hline
\mbox{\tt in}  & {\em signature\+Len} & Length of the signature to be verified \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1040 of file rsa.\+c.


\begin{DoxyCode}
1043 \{
1044    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1045    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
1046    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} modBits;
1047    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *em;
1048    \hyperlink{structMpi}{Mpi} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
1049    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1050 
1051    \textcolor{comment}{//Check parameters}
1052    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || digest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature} == 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1053       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1054 
1055    \textcolor{comment}{//Debug message}
1056    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSASSA-PSS signature verification...\(\backslash\)r\(\backslash\)n"});
1057    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
1058    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
1059    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
1060    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &key->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
1061    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message digest:\(\backslash\)r\(\backslash\)n"});
1062    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, digest, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
1063    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Signature:\(\backslash\)r\(\backslash\)n"});
1064    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, signatureLen);
1065 
1066    \textcolor{comment}{//Initialize multiple-precision integers}
1067    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&s);
1068    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&m);
1069 
1070    \textcolor{comment}{//modBits is the length in bits of the modulus n}
1071    modBits = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(&key->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
1072 
1073    \textcolor{comment}{//Make sure the modulus is valid}
1074    \textcolor{keywordflow}{if}(modBits == 0)
1075       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1076 
1077    \textcolor{comment}{//Calculate the length in octets of the modulus n}
1078    k = (modBits + 7) / 8;
1079 
1080    \textcolor{comment}{//Check the length of the signature}
1081    \textcolor{keywordflow}{if}(signatureLen != k)
1082       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48}{ERROR\_INVALID\_SIGNATURE};
1083 
1084    \textcolor{comment}{//Allocate a memory buffer to hold the encoded message}
1085    em = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(k);
1086    \textcolor{comment}{//Failed to allocate memory?}
1087    \textcolor{keywordflow}{if}(em == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1088       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
1089 
1090    \textcolor{comment}{//Start of exception handling block}
1091    \textcolor{keywordflow}{do}
1092    \{
1093       \textcolor{comment}{//Convert the signature to an integer signature representative s}
1094       error = \hyperlink{crypto__legacy_8h_abcebe7f916d9073a85492596ec3924fa}{mpiReadRaw}(&s, \hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature}, signatureLen);
1095       \textcolor{comment}{//Conversion failed?}
1096       \textcolor{keywordflow}{if}(error)
1097          \textcolor{keywordflow}{break};
1098 
1099       \textcolor{comment}{//Apply the RSAVP1 verification primitive}
1100       error = \hyperlink{rsa_8c_ae3bd572570d3ad77ce2cf5169f8b4417}{rsavp1}(key, &s, &m);
1101       \textcolor{comment}{//Any error to report?}
1102       \textcolor{keywordflow}{if}(error)
1103          \textcolor{keywordflow}{break};
1104 
1105       \textcolor{comment}{//Convert the message representative m to an encoded message EM of}
1106       \textcolor{comment}{//length emLen = ceil((modBits - 1) / 8) octets}
1107       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&m, em, (modBits + 6) / 8);
1108       \textcolor{comment}{//Conversion failed?}
1109       \textcolor{keywordflow}{if}(error)
1110          \textcolor{keywordflow}{break};
1111 
1112       \textcolor{comment}{//Debug message}
1113       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Encoded message:\(\backslash\)r\(\backslash\)n"});
1114       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, em, (modBits + 6) / 8);
1115 
1116       \textcolor{comment}{//Apply the EMSA-PSS verification operation to the message M and the}
1117       \textcolor{comment}{//encoded message EM to determine whether they are consistent}
1118       error = \hyperlink{rsa_8c_a776b7f6b47e34540ed99dd44ffefdf49}{emsaPssVerify}(hash, saltLen, digest, em, modBits - 1);
1119       \textcolor{comment}{//Any error to report?}
1120       \textcolor{keywordflow}{if}(error)
1121       \{
1122          \textcolor{comment}{//The signature is not valid}
1123          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48}{ERROR\_INVALID\_SIGNATURE};
1124          \textcolor{keywordflow}{break};
1125       \}
1126 
1127       \textcolor{comment}{//End of exception handling block}
1128    \} \textcolor{keywordflow}{while}(0);
1129 
1130    \textcolor{comment}{//Release the encoded message}
1131    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(em);
1132 
1133    \textcolor{comment}{//Release multiple precision integers}
1134    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&s);
1135    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&m);
1136 
1137    \textcolor{comment}{//Return status code}
1138    \textcolor{keywordflow}{return} error;
1139 \}
\end{DoxyCode}
\mbox{\Hypertarget{rsa_8c_ae3bd572570d3ad77ce2cf5169f8b4417}\label{rsa_8c_ae3bd572570d3ad77ce2cf5169f8b4417}} 
\index{rsa.\+c@{rsa.\+c}!rsavp1@{rsavp1}}
\index{rsavp1@{rsavp1}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{rsavp1()}{rsavp1()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rsavp1 (\begin{DoxyParamCaption}\item[{const \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{key,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{s,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{m }\end{DoxyParamCaption})}



R\+SA verification primitive. 

The R\+SA verification primitive recovers the message representative from the signature representative under the control of a public key


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em key} & R\+SA public key \\
\hline
\mbox{\tt in}  & {\em s} & Signature representative \\
\hline
\mbox{\tt out}  & {\em m} & Message representative \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1269 of file rsa.\+c.


\begin{DoxyCode}
1270 \{
1271    \textcolor{comment}{//RSAVP1 primitive is the same as RSAEP except for the names of its input}
1272    \textcolor{comment}{//and output arguments. They are distinguished as they are intended for}
1273    \textcolor{comment}{//different purposes}
1274    \textcolor{keywordflow}{return} \hyperlink{rsa_8c_aa747fb394b77511f47268bfb77e90e94}{rsaep}(key, s, m);
1275 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{rsa_8c_a4dfd8d1562ab65d3c3917a064ff1d292}\label{rsa_8c_a4dfd8d1562ab65d3c3917a064ff1d292}} 
\index{rsa.\+c@{rsa.\+c}!M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{MD2\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} M\+D2\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x02\}}



Definition at line 60 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_af19f8c370895ebbb0acbe8da4ef0a0c0}\label{rsa_8c_af19f8c370895ebbb0acbe8da4ef0a0c0}} 
\index{rsa.\+c@{rsa.\+c}!M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{MD5\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} M\+D5\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x04\}}



Definition at line 62 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a0f28ad77f8507396cd4e2efbc6e25c10}\label{rsa_8c_a0f28ad77f8507396cd4e2efbc6e25c10}} 
\index{rsa.\+c@{rsa.\+c}!M\+G\+F1\+\_\+\+O\+ID@{M\+G\+F1\+\_\+\+O\+ID}}
\index{M\+G\+F1\+\_\+\+O\+ID@{M\+G\+F1\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{M\+G\+F1\+\_\+\+O\+ID}{MGF1\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} M\+G\+F1\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x08\}}



Definition at line 91 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}\label{rsa_8c_af1c4a27ba7373c2944af658b6a7d1477}} 
\index{rsa.\+c@{rsa.\+c}!padding@{padding}}
\index{padding@{padding}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{padding}{padding}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} padding\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
\}
\end{DoxyCode}


Definition at line 94 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_ad67011f345ca59ed0582e0484b597eb9}\label{rsa_8c_ad67011f345ca59ed0582e0484b597eb9}} 
\index{rsa.\+c@{rsa.\+c}!P\+K\+C\+S1\+\_\+\+O\+ID@{P\+K\+C\+S1\+\_\+\+O\+ID}}
\index{P\+K\+C\+S1\+\_\+\+O\+ID@{P\+K\+C\+S1\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{P\+K\+C\+S1\+\_\+\+O\+ID}{PKCS1\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} P\+K\+C\+S1\+\_\+\+O\+ID\mbox{[}8\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01\}}



Definition at line 55 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}\label{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}} 
\index{rsa.\+c@{rsa.\+c}!R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x01\}}



Definition at line 57 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a490ca34e6cbccf1058ae40901758270d}\label{rsa_8c_a490ca34e6cbccf1058ae40901758270d}} 
\index{rsa.\+c@{rsa.\+c}!R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID}}
\index{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID}{RSASSA\_PKCS1\_V1\_5\_WITH\_SHA3\_224\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+224\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0\+D\}}



Definition at line 79 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_ab5a7bb1be04732887f695d6f21bb94f6}\label{rsa_8c_ab5a7bb1be04732887f695d6f21bb94f6}} 
\index{rsa.\+c@{rsa.\+c}!R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID}}
\index{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID}{RSASSA\_PKCS1\_V1\_5\_WITH\_SHA3\_256\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+256\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0\+E\}}



Definition at line 81 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a107945de499d583b794eed91ab7eadd3}\label{rsa_8c_a107945de499d583b794eed91ab7eadd3}} 
\index{rsa.\+c@{rsa.\+c}!R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID}}
\index{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID}{RSASSA\_PKCS1\_V1\_5\_WITH\_SHA3\_384\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+384\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0\+F\}}



Definition at line 83 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a827aeeb405a047789dee2fcd9ffea4b0}\label{rsa_8c_a827aeeb405a047789dee2fcd9ffea4b0}} 
\index{rsa.\+c@{rsa.\+c}!R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID}}
\index{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID}{RSASSA\_PKCS1\_V1\_5\_WITH\_SHA3\_512\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} R\+S\+A\+S\+S\+A\+\_\+\+P\+K\+C\+S1\+\_\+\+V1\+\_\+5\+\_\+\+W\+I\+T\+H\+\_\+\+S\+H\+A3\+\_\+512\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x10\}}



Definition at line 85 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}\label{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}} 
\index{rsa.\+c@{rsa.\+c}!R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID}}
\index{R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID@{R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID}{RSASSA\_PSS\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} R\+S\+A\+S\+S\+A\+\_\+\+P\+S\+S\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+A\}}



Definition at line 88 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a736d50cd0e106849f68525738a84807d}\label{rsa_8c_a736d50cd0e106849f68525738a84807d}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA1\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A1\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x05\}}



Definition at line 64 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_ac7526d5f43a9b9190710675d6ba34f8e}\label{rsa_8c_ac7526d5f43a9b9190710675d6ba34f8e}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA224\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+E\}}



Definition at line 66 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a3f47da029e12f80b24910e857eff27b9}\label{rsa_8c_a3f47da029e12f80b24910e857eff27b9}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA256\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+B\}}



Definition at line 68 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a3894e84fdea08249ef57afdba18aa380}\label{rsa_8c_a3894e84fdea08249ef57afdba18aa380}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA384\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A384\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+C\}}



Definition at line 70 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a7a9560d9c4ca9e89e1e982551574b153}\label{rsa_8c_a7a9560d9c4ca9e89e1e982551574b153}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA512\_224\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A512\+\_\+224\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+F\}}



Definition at line 74 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_a2725d615df2470c4c02ca385174b43b7}\label{rsa_8c_a2725d615df2470c4c02ca385174b43b7}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA512\_256\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A512\+\_\+256\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x10\}}



Definition at line 76 of file rsa.\+c.

\mbox{\Hypertarget{rsa_8c_adf40ca1962295568f78ca0cdcd202971}\label{rsa_8c_adf40ca1962295568f78ca0cdcd202971}} 
\index{rsa.\+c@{rsa.\+c}!S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}}
\index{S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID@{S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}!rsa.\+c@{rsa.\+c}}
\subsubsection{\texorpdfstring{S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID}{SHA512\_WITH\_RSA\_ENCRYPTION\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} S\+H\+A512\+\_\+\+W\+I\+T\+H\+\_\+\+R\+S\+A\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+I\+O\+N\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x01, 0x0\+D\}}



Definition at line 72 of file rsa.\+c.

