\hypertarget{mqtt__sn__client__misc_8c}{}\section{cyclone\+\_\+tcp/mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client\+\_\+misc.c File Reference}
\label{mqtt__sn__client__misc_8c}\index{cyclone\+\_\+tcp/mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{cyclone\+\_\+tcp/mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}


Helper functions for M\+Q\+T\+T-\/\+SN client.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client\+\_\+message.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client\+\_\+transport.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mqtt__sn__client__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_a84a94bc8e8c71e7717663296513ed1d9}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqtt\+Sn\+Client\+Process\+Events} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} timeout)
\begin{DoxyCompactList}\small\item\em Process M\+Q\+T\+T-\/\+SN client events. \end{DoxyCompactList}\item 
\hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9c}{Mqtt\+Sn\+Return\+Code} \hyperlink{mqtt__sn__client__misc_8c_ad63494d6633856d2baaec02ff35d7db2}{mqtt\+Sn\+Deliver\+Publish\+Message} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{mqtt__sn__common_8h_adfa650f3c081a815eb81daa416bb94a0}{Mqtt\+Sn\+Flags} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topic\+Id}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t data\+Len)
\begin{DoxyCompactList}\small\item\em Deliver a P\+U\+B\+L\+I\+SH message to the application. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_ad237e69506d77f2867af6da6e22e776c}{mqtt\+Sn\+Client\+Add\+Topic} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topic\+Id})
\begin{DoxyCompactList}\small\item\em Add a new entry to the topic table. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_af30cd99cf8df4c1b4655cde149a3b02c}{mqtt\+Sn\+Client\+Delete\+Topic} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name})
\begin{DoxyCompactList}\small\item\em Remove an entry in the topic table. \end{DoxyCompactList}\item 
const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$ \hyperlink{mqtt__sn__client__misc_8c_ade97ca282d1b07bf7e8ad499df778571}{mqtt\+Sn\+Client\+Find\+Topic\+Id} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topic\+Id})
\begin{DoxyCompactList}\small\item\em Retrieve the topic name associated with a given topic ID. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_a2cd69e6ec99d3b7c7bddd0452a7308d0}{mqtt\+Sn\+Client\+Find\+Topic\+Name} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name})
\begin{DoxyCompactList}\small\item\em Retrieve the topic ID associated with a given topic name. \end{DoxyCompactList}\item 
const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$ \hyperlink{mqtt__sn__client__misc_8c_ad8b1873c108de6931c3f2245e037d3a9}{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topic\+Id})
\begin{DoxyCompactList}\small\item\em Retrieve the topic name associated with a predefined topic ID. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_a5a3a8ce51441f762a4d7a92a24d1c936}{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name})
\begin{DoxyCompactList}\small\item\em Retrieve the topic ID associated with a predefined topic name. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}{mqtt\+Sn\+Client\+Generate\+Message\+Id} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Generate a new message identifier. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_a74f6132ed62cc0427ebd0ca584893e0e}{mqtt\+Sn\+Client\+Store\+Message\+Id} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msg\+Id})
\begin{DoxyCompactList}\small\item\em Store message ID (QoS 2 message processing) \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_afa65039a1f4b7932cc3c26de1542a868}{mqtt\+Sn\+Client\+Discard\+Message\+Id} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msg\+Id})
\begin{DoxyCompactList}\small\item\em Discard message ID (QoS 2 message processing) \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_a1c993b7a118e134d92ba1ad034de1245}{mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msg\+Id})
\begin{DoxyCompactList}\small\item\em Check whether the message ID is a duplicate (QoS 2 message processing) \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__client__misc_8c_a562e489c567eebf11c934e7379b42022}{mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name})
\begin{DoxyCompactList}\small\item\em Check whether a topic name is a short topic name. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Helper functions for M\+Q\+T\+T-\/\+SN client. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{mqtt__sn__client__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_a84a94bc8e8c71e7717663296513ed1d9}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_ad237e69506d77f2867af6da6e22e776c}\label{mqtt__sn__client__misc_8c_ad237e69506d77f2867af6da6e22e776c}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Add\+Topic@{mqtt\+Sn\+Client\+Add\+Topic}}
\index{mqtt\+Sn\+Client\+Add\+Topic@{mqtt\+Sn\+Client\+Add\+Topic}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Add\+Topic()}{mqttSnClientAddTopic()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Add\+Topic (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{topic\+Id }\end{DoxyParamCaption})}



Add a new entry to the topic table. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Topic name \\
\hline
\mbox{\tt in}  & {\em topic\+Id} & Topic identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 240 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
242 \{
243    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
244 
245    \textcolor{comment}{//Make sure the name of the topic name is acceptable}
246    \textcolor{keywordflow}{if}(strlen(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}) > \hyperlink{mqtt__sn__client_8h_a746a6fb4ce05f20c05f8a852a1e376e1}{MQTT\_SN\_CLIENT\_MAX\_TOPIC\_NAME\_LEN})
247       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
248 
249    \textcolor{comment}{//Loop through the topic table}
250    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}{MQTT\_SN\_CLIENT\_TOPIC\_TABLE\_SIZE}; i++)
251    \{
252       \textcolor{comment}{//Check whether the topic name has already been registered}
253       \textcolor{keywordflow}{if}(!strcmp(context->topicTable[i].topicName, \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}))
254       \{
255          \textcolor{comment}{//Update topic identifier}
256          context->topicTable[i].topicId = \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId};
257 
258          \textcolor{comment}{//We are done}
259          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
260       \}
261    \}
262 
263    \textcolor{comment}{//Loop through the topic table}
264    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}{MQTT\_SN\_CLIENT\_TOPIC\_TABLE\_SIZE}; i++)
265    \{
266       \textcolor{comment}{//Check whether the current entry is free}
267       \textcolor{keywordflow}{if}(context->topicTable[i].topicName[0] == \textcolor{charliteral}{'\(\backslash\)0'})
268       \{
269          \textcolor{comment}{//Save mapping between topic name and topic ID}
270          strcpy(context->topicTable[i].topicName, \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName});
271          context->topicTable[i].topicId = \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId};
272 
273          \textcolor{comment}{//A new entry has been successfully created}
274          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
275       \}
276    \}
277 
278    \textcolor{comment}{//The table runs out of entries}
279    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca528efe91b7a7e4bcc9a6de7d4b778c67}{ERROR\_OUT\_OF\_RESOURCES};
280 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_af30cd99cf8df4c1b4655cde149a3b02c}\label{mqtt__sn__client__misc_8c_af30cd99cf8df4c1b4655cde149a3b02c}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Delete\+Topic@{mqtt\+Sn\+Client\+Delete\+Topic}}
\index{mqtt\+Sn\+Client\+Delete\+Topic@{mqtt\+Sn\+Client\+Delete\+Topic}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Delete\+Topic()}{mqttSnClientDeleteTopic()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Delete\+Topic (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name }\end{DoxyParamCaption})}



Remove an entry in the topic table. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Topic name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 290 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
292 \{
293    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
294 
295    \textcolor{comment}{//Loop through the list of topics that have been registered}
296    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}{MQTT\_SN\_CLIENT\_TOPIC\_TABLE\_SIZE}; i++)
297    \{
298       \textcolor{comment}{//Matching topic name?}
299       \textcolor{keywordflow}{if}(!strcmp(context->topicTable[i].topicName, \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}))
300       \{
301          \textcolor{comment}{//Release current entry}
302          context->topicTable[i].topicName[0] = \textcolor{charliteral}{'\(\backslash\)0'};
303 
304          \textcolor{comment}{//We are done}
305          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
306       \}
307    \}
308 
309    \textcolor{comment}{//The specified topic name does not exist}
310    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4cca37264afee88cb14cd105f0d59607}{ERROR\_NOT\_FOUND};
311 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_afa65039a1f4b7932cc3c26de1542a868}\label{mqtt__sn__client__misc_8c_afa65039a1f4b7932cc3c26de1542a868}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Discard\+Message\+Id@{mqtt\+Sn\+Client\+Discard\+Message\+Id}}
\index{mqtt\+Sn\+Client\+Discard\+Message\+Id@{mqtt\+Sn\+Client\+Discard\+Message\+Id}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Discard\+Message\+Id()}{mqttSnClientDiscardMessageId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Discard\+Message\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{msg\+Id }\end{DoxyParamCaption})}



Discard message ID (QoS 2 message processing) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em msg\+Id} & Message identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 532 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
534 \{
535    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
536 
537    \textcolor{comment}{//Loop through the list of message identifiers}
538    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}{MQTT\_SN\_CLIENT\_MSG\_ID\_TABLE\_SIZE}; i++)
539    \{
540       \textcolor{comment}{//Matching message identifier?}
541       \textcolor{keywordflow}{if}(context->msgIdTable[i].ownership &&
542          context->msgIdTable[i].msgId == \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId})
543       \{
544          \textcolor{comment}{//Release current entry}
545          context->msgIdTable[i].msgId = 0;
546          context->msgIdTable[i].ownership = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
547 
548          \textcolor{comment}{//We are done}
549          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
550       \}
551    \}
552 
553    \textcolor{comment}{//The specified message identifier does not exist}
554    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4cca37264afee88cb14cd105f0d59607}{ERROR\_NOT\_FOUND};
555 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_ad8b1873c108de6931c3f2245e037d3a9}\label{mqtt__sn__client__misc_8c_ad8b1873c108de6931c3f2245e037d3a9}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id@{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id}}
\index{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id@{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id()}{mqttSnClientFindPredefTopicId()}}
{\footnotesize\ttfamily const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}$\ast$ mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{topic\+Id }\end{DoxyParamCaption})}



Retrieve the topic name associated with a predefined topic ID. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Id} & Predefined topic identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Topic name 
\end{DoxyReturn}


Definition at line 395 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
397 \{
398    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
399    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName};
400 
401    \textcolor{comment}{//Initialize topic name}
402    topicName = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
403 
404    \textcolor{comment}{//Valid topic identifier?}
405    \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId} != \hyperlink{mqtt__sn__common_8h_a124c3e4a030914b576c63af515fd1019}{MQTT\_SN\_INVALID\_TOPIC\_ID})
406    \{
407       \textcolor{comment}{//Loop through the list of predefined topics}
408       \textcolor{keywordflow}{for}(i = 0; i < context->predefinedTopicTableSize; i++)
409       \{
410          \textcolor{comment}{//Matching topic identifier?}
411          \textcolor{keywordflow}{if}(context->predefinedTopicTable[i].topicId == \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId})
412          \{
413             \textcolor{comment}{//Retrieve the corresponding topic name}
414             topicName = context->predefinedTopicTable[i].topicName;
415             \textcolor{keywordflow}{break};
416          \}
417       \}
418    \}
419 
420    \textcolor{comment}{//Return the corresponding topic name}
421    \textcolor{keywordflow}{return} \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName};
422 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_a5a3a8ce51441f762a4d7a92a24d1c936}\label{mqtt__sn__client__misc_8c_a5a3a8ce51441f762a4d7a92a24d1c936}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name@{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name}}
\index{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name@{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name()}{mqttSnClientFindPredefTopicName()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} mqtt\+Sn\+Client\+Find\+Predef\+Topic\+Name (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name }\end{DoxyParamCaption})}



Retrieve the topic ID associated with a predefined topic name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Predefined topic name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Topic identifier 
\end{DoxyReturn}


Definition at line 432 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
434 \{
435    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
436    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId};
437 
438    \textcolor{comment}{//Initialize topic identifier}
439    topicId = \hyperlink{mqtt__sn__common_8h_a124c3e4a030914b576c63af515fd1019}{MQTT\_SN\_INVALID\_TOPIC\_ID};
440 
441    \textcolor{comment}{//Valid topic name?}
442    \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
443    \{
444       \textcolor{comment}{//Loop through the list of predefined topics}
445       \textcolor{keywordflow}{for}(i = 0; i < context->predefinedTopicTableSize; i++)
446       \{
447          \textcolor{comment}{//Matching topic name?}
448          \textcolor{keywordflow}{if}(!strcmp(context->predefinedTopicTable[i].topicName, \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}))
449          \{
450             \textcolor{comment}{//Retrieve the corresponding topic identifier}
451             topicId = context->predefinedTopicTable[i].topicId;
452             \textcolor{keywordflow}{break};
453          \}
454       \}
455    \}
456 
457    \textcolor{comment}{//Return the corresponding topic identifier}
458    \textcolor{keywordflow}{return} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId};
459 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_ade97ca282d1b07bf7e8ad499df778571}\label{mqtt__sn__client__misc_8c_ade97ca282d1b07bf7e8ad499df778571}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Find\+Topic\+Id@{mqtt\+Sn\+Client\+Find\+Topic\+Id}}
\index{mqtt\+Sn\+Client\+Find\+Topic\+Id@{mqtt\+Sn\+Client\+Find\+Topic\+Id}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Find\+Topic\+Id()}{mqttSnClientFindTopicId()}}
{\footnotesize\ttfamily const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}$\ast$ mqtt\+Sn\+Client\+Find\+Topic\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{topic\+Id }\end{DoxyParamCaption})}



Retrieve the topic name associated with a given topic ID. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Id} & Topic identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Topic name 
\end{DoxyReturn}


Definition at line 321 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
323 \{
324    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
325    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName};
326 
327    \textcolor{comment}{//Initialize topic name}
328    topicName = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
329 
330    \textcolor{comment}{//Valid topic identifier?}
331    \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId} != \hyperlink{mqtt__sn__common_8h_a124c3e4a030914b576c63af515fd1019}{MQTT\_SN\_INVALID\_TOPIC\_ID})
332    \{
333       \textcolor{comment}{//Loop through the list of topics that have been registered}
334       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}{MQTT\_SN\_CLIENT\_TOPIC\_TABLE\_SIZE}; i++)
335       \{
336          \textcolor{comment}{//Matching topic identifier?}
337          \textcolor{keywordflow}{if}(context->topicTable[i].topicId == \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId})
338          \{
339             \textcolor{comment}{//Retrieve the corresponding topic name}
340             topicName = context->topicTable[i].topicName;
341             \textcolor{keywordflow}{break};
342          \}
343       \}
344    \}
345 
346    \textcolor{comment}{//Return the corresponding topic name}
347    \textcolor{keywordflow}{return} \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName};
348 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_a2cd69e6ec99d3b7c7bddd0452a7308d0}\label{mqtt__sn__client__misc_8c_a2cd69e6ec99d3b7c7bddd0452a7308d0}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Find\+Topic\+Name@{mqtt\+Sn\+Client\+Find\+Topic\+Name}}
\index{mqtt\+Sn\+Client\+Find\+Topic\+Name@{mqtt\+Sn\+Client\+Find\+Topic\+Name}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Find\+Topic\+Name()}{mqttSnClientFindTopicName()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} mqtt\+Sn\+Client\+Find\+Topic\+Name (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name }\end{DoxyParamCaption})}



Retrieve the topic ID associated with a given topic name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Topic name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Topic identifier 
\end{DoxyReturn}


Definition at line 358 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
360 \{
361    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
362    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId};
363 
364    \textcolor{comment}{//Initialize topic identifier}
365    topicId = \hyperlink{mqtt__sn__common_8h_a124c3e4a030914b576c63af515fd1019}{MQTT\_SN\_INVALID\_TOPIC\_ID};
366 
367    \textcolor{comment}{//Valid topic name?}
368    \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
369    \{
370       \textcolor{comment}{//Loop through the list of registered topics that have been registered}
371       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}{MQTT\_SN\_CLIENT\_TOPIC\_TABLE\_SIZE}; i++)
372       \{
373          \textcolor{comment}{//Matching topic name?}
374          \textcolor{keywordflow}{if}(!strcmp(context->topicTable[i].topicName, \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}))
375          \{
376             \textcolor{comment}{//Retrieve the corresponding topic identifier}
377             topicId = context->topicTable[i].topicId;
378             \textcolor{keywordflow}{break};
379          \}
380       \}
381    \}
382 
383    \textcolor{comment}{//Return the corresponding topic identifier}
384    \textcolor{keywordflow}{return} \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId};
385 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}\label{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Generate\+Message\+Id@{mqtt\+Sn\+Client\+Generate\+Message\+Id}}
\index{mqtt\+Sn\+Client\+Generate\+Message\+Id@{mqtt\+Sn\+Client\+Generate\+Message\+Id}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Generate\+Message\+Id()}{mqttSnClientGenerateMessageId()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} mqtt\+Sn\+Client\+Generate\+Message\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Generate a new message identifier. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
16-\/bit message identifier 
\end{DoxyReturn}


Definition at line 468 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
469 \{
470    \textcolor{comment}{//Increment message identifier and wrap around if necessary}
471    \textcolor{keywordflow}{if}(context->msgId < \hyperlink{stdint_8h_a3ea490c9b3617d4479bd80ef93cd5602}{UINT16\_MAX})
472       context->msgId++;
473    \textcolor{keywordflow}{else}
474       context->msgId = 1;
475 
476    \textcolor{comment}{//Return current value}
477    \textcolor{keywordflow}{return} context->msgId;
478 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_a1c993b7a118e134d92ba1ad034de1245}\label{mqtt__sn__client__misc_8c_a1c993b7a118e134d92ba1ad034de1245}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id@{mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id}}
\index{mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id@{mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id()}{mqttSnClientIsDuplicateMessageId()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} mqtt\+Sn\+Client\+Is\+Duplicate\+Message\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{msg\+Id }\end{DoxyParamCaption})}



Check whether the message ID is a duplicate (QoS 2 message processing) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em msg\+Id} & Message identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the message ID is a duplicate, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 565 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
567 \{
568    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
569    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} duplicate;
570 
571    \textcolor{comment}{//Initialize flag}
572    duplicate = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
573 
574    \textcolor{comment}{//Loop through the list of message identifiers}
575    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}{MQTT\_SN\_CLIENT\_MSG\_ID\_TABLE\_SIZE}; i++)
576    \{
577       \textcolor{comment}{//Check whether the message ID has already been accepted by the client}
578       \textcolor{keywordflow}{if}(context->msgIdTable[i].ownership &&
579          context->msgIdTable[i].msgId == \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId})
580       \{
581          \textcolor{comment}{//The message ID is a duplicate}
582          duplicate = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
583          \textcolor{keywordflow}{break};
584       \}
585    \}
586 
587    \textcolor{comment}{//Return TRUE if the message ID is a duplicate}
588    \textcolor{keywordflow}{return} duplicate;
589 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_a562e489c567eebf11c934e7379b42022}\label{mqtt__sn__client__misc_8c_a562e489c567eebf11c934e7379b42022}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name@{mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name}}
\index{mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name@{mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name()}{mqttSnClientIsShortTopicName()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} mqtt\+Sn\+Client\+Is\+Short\+Topic\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name }\end{DoxyParamCaption})}



Check whether a topic name is a short topic name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em topic\+Name} & Topic name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the specified topic name is a short topic name, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 598 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
599 \{
600    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
601 
602    \textcolor{comment}{//Initialize variable}
603    res = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
604 
605    \textcolor{comment}{//A short topic name is a topic name that has a fixed length of two octets}
606    \textcolor{keywordflow}{if}(strlen(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}) == 2)
607    \{
608       \textcolor{comment}{//Ensure the topic name does not contains wildcard characters}
609       \textcolor{keywordflow}{if}(strchr(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \textcolor{charliteral}{'#'}) == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && strchr(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \textcolor{charliteral}{'+'}) == 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
610       \{
611          \textcolor{comment}{//The short topic name is a valid}
612          res = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
613       \}
614    \}
615 
616    \textcolor{comment}{//Return TRUE if the specified topic name is a short topic name}
617    \textcolor{keywordflow}{return} \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
618 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}\label{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Process\+Events@{mqtt\+Sn\+Client\+Process\+Events}}
\index{mqtt\+Sn\+Client\+Process\+Events@{mqtt\+Sn\+Client\+Process\+Events}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Process\+Events()}{mqttSnClientProcessEvents()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Process\+Events (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{timeout }\end{DoxyParamCaption})}



Process M\+Q\+T\+T-\/\+SN client events. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em timeout} & Maximum time to wait before returning \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 53 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
55 \{
56    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
57    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} d;
58    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} startTime;
59    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} currentTime;
60    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
61    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port};
62 
63    \textcolor{comment}{//Flush buffer}
64    context->message.length = 0;
65 
66    \textcolor{comment}{//Save current time}
67    currentTime = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
68    startTime = currentTime;
69 
70    \textcolor{comment}{//Initialize status code}
71    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
72 
73    \textcolor{comment}{//Process events}
74    \textcolor{keywordflow}{do}
75    \{
76       \textcolor{comment}{//Maximum time to wait for an incoming datagram}
77       \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(startTime + timeout, currentTime) > 0)
78          d = startTime + timeout - currentTime;
79       \textcolor{keywordflow}{else}
80          d = 0;
81 
82       \textcolor{comment}{//Limit the delay}
83       d = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(d, \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
84 
85       \textcolor{comment}{//Wait for an incoming datagram}
86       error = \hyperlink{mqtt__sn__client__transport_8c_a4160b273779195b46ebf45674398003c}{mqttSnClientReceiveDatagram}(context, &ipAddr, &port,
87          context->message.buffer, \hyperlink{mqtt__sn__message_8h_ada138ba791ef46d36fe224cf038bf38b}{MQTT\_SN\_MAX\_MSG\_SIZE},
88          &context->message.length, d);
89 
90       \textcolor{comment}{//Get current time}
91       currentTime = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
92 
93       \textcolor{comment}{//Any datagram received?}
94       \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
95       \{
96          \textcolor{comment}{//Terminate the payload with a NULL character}
97          context->message.buffer[context->message.length] = \textcolor{charliteral}{'\(\backslash\)0'};
98 
99          \textcolor{comment}{//Process the received MQTT-SN message}
100          \hyperlink{mqtt__sn__client__message_8c_a852b40ae91fbf145a44da3cab0799349}{mqttSnClientProcessMessage}(context, &context->message, &ipAddr, port);
101       \}
102       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
103       \{
104          \textcolor{comment}{//No datagram has been received}
105          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
106       \}
107       \textcolor{keywordflow}{else}
108       \{
109          \textcolor{comment}{//A communication error has occurred}
110       \}
111 
112       \textcolor{comment}{//Check status code}
113       \textcolor{keywordflow}{if}(!error)
114       \{
115          \textcolor{comment}{//A keep-alive value of zero has the effect of turning off the keep}
116          \textcolor{comment}{//alive mechanism}
117          \textcolor{keywordflow}{if}(context->keepAlive != 0)
118          \{
119             \textcolor{comment}{//Make sure the MQTT-SN client is connected}
120             \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE} ||
121                context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ} ||
122                context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
123             \{
124                \textcolor{comment}{//Check whether the keep-alive timer has expired}
125                \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(currentTime, context->keepAliveTimestamp +
126                   context->keepAlive) >= 0)
127                \{
128                   \textcolor{comment}{//Check retransmission counter}
129                   \textcolor{keywordflow}{if}(context->keepAliveCounter < 
      \hyperlink{mqtt__sn__client_8h_a20c1e6ef1d8aa1ff620efeeaecfc03f0}{MQTT\_SN\_CLIENT\_MAX\_KEEP\_ALIVE\_PROBES})
130                   \{
131                      \textcolor{comment}{//Send a PINGREQ message to the gateway}
132                      error = \hyperlink{mqtt__sn__client__message_8c_a6b0db34af4f76e875fd5e471de572589}{mqttSnClientSendPingReq}(context);
133 
134                      \textcolor{comment}{//Increment retransmission counter}
135                      context->keepAliveCounter++;
136                   \}
137                   \textcolor{keywordflow}{else}
138                   \{
139                      \textcolor{comment}{//If a client does not receive a PINGRESP from the gateway}
140                      \textcolor{comment}{//even after multiple retransmissions of the PINGREQ message,}
141                      \textcolor{comment}{//then the gateway is considered offline}
142                      context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING};
143 
144                      \textcolor{comment}{//The connection is lost}
145                      error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
146                   \}
147                \}
148             \}
149          \}
150       \}
151 
152       \textcolor{comment}{//Check whether the timeout has elapsed}
153    \} \textcolor{keywordflow}{while}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} && context->message.length == 0 && d > 0);
154 
155    \textcolor{comment}{//Return status code}
156    \textcolor{keywordflow}{return} error;
157 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_a74f6132ed62cc0427ebd0ca584893e0e}\label{mqtt__sn__client__misc_8c_a74f6132ed62cc0427ebd0ca584893e0e}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Client\+Store\+Message\+Id@{mqtt\+Sn\+Client\+Store\+Message\+Id}}
\index{mqtt\+Sn\+Client\+Store\+Message\+Id@{mqtt\+Sn\+Client\+Store\+Message\+Id}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Store\+Message\+Id()}{mqttSnClientStoreMessageId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Store\+Message\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{msg\+Id }\end{DoxyParamCaption})}



Store message ID (QoS 2 message processing) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em msg\+Id} & Message identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 488 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
490 \{
491    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
492 
493    \textcolor{comment}{//Loop through the list of message identifiers}
494    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}{MQTT\_SN\_CLIENT\_MSG\_ID\_TABLE\_SIZE}; i++)
495    \{
496       \textcolor{comment}{//Check whether the message ID has already been accepted by the client}
497       \textcolor{keywordflow}{if}(context->msgIdTable[i].ownership &&
498          context->msgIdTable[i].msgId == \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId})
499       \{
500          \textcolor{comment}{//We are done}
501          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
502       \}
503    \}
504 
505    \textcolor{comment}{//Loop through the list of message identifiers}
506    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}{MQTT\_SN\_CLIENT\_MSG\_ID\_TABLE\_SIZE}; i++)
507    \{
508       \textcolor{comment}{//Check whether the current entry is free}
509       \textcolor{keywordflow}{if}(!context->msgIdTable[i].ownership)
510       \{
511          \textcolor{comment}{//Create a new entry}
512          context->msgIdTable[i].msgId = \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId};
513          context->msgIdTable[i].ownership = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
514 
515          \textcolor{comment}{//We are done}
516          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
517       \}
518    \}
519 
520    \textcolor{comment}{//The table runs out of entries}
521    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca528efe91b7a7e4bcc9a6de7d4b778c67}{ERROR\_OUT\_OF\_RESOURCES};
522 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client__misc_8c_ad63494d6633856d2baaec02ff35d7db2}\label{mqtt__sn__client__misc_8c_ad63494d6633856d2baaec02ff35d7db2}} 
\index{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}!mqtt\+Sn\+Deliver\+Publish\+Message@{mqtt\+Sn\+Deliver\+Publish\+Message}}
\index{mqtt\+Sn\+Deliver\+Publish\+Message@{mqtt\+Sn\+Deliver\+Publish\+Message}!mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c@{mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Deliver\+Publish\+Message()}{mqttSnDeliverPublishMessage()}}
{\footnotesize\ttfamily \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9c}{Mqtt\+Sn\+Return\+Code} mqtt\+Sn\+Deliver\+Publish\+Message (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{mqtt__sn__common_8h_adfa650f3c081a815eb81daa416bb94a0}{Mqtt\+Sn\+Flags}}]{flags,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{topic\+Id,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{data\+Len }\end{DoxyParamCaption})}



Deliver a P\+U\+B\+L\+I\+SH message to the application. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em flags} & Flags \\
\hline
\mbox{\tt in}  & {\em topic\+Id} & Topic identifier \\
\hline
\mbox{\tt in}  & {\em data} & Message payload \\
\hline
\mbox{\tt in}  & {\em data\+Len} & Length of the message payload \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 170 of file mqtt\+\_\+sn\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
172 \{
173    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName};
174    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} shortTopicName[3];
175    \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9c}{MqttSnReturnCode} \hyperlink{mqtt__sn__common_8h_aa43af56bba229c3214623f0f0c23bf6e}{returnCode};
176 
177    \textcolor{comment}{//Check the type of topic identifier}
178    \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags}.topicIdType == \hyperlink{mqtt__sn__common_8h_a70807215f60d92d02503f2a5ed76ee96a041f445f341f6caa8749f3d627f481e5}{MQTT\_SN\_NORMAL\_TOPIC\_ID})
179    \{
180       \textcolor{comment}{//Retrieve the topic name associated with the normal topic ID}
181       topicName = \hyperlink{mqtt__sn__client__misc_8c_ade97ca282d1b07bf7e8ad499df778571}{mqttSnClientFindTopicId}(context, 
      \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId});
182    \}
183    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags}.topicIdType == \hyperlink{mqtt__sn__common_8h_a70807215f60d92d02503f2a5ed76ee96a6bade83ea3e30d700f58005473c2736b}{MQTT\_SN\_PREDEFINED\_TOPIC\_ID})
184    \{
185       \textcolor{comment}{//Retrieve the topic name associated with the predefined topic ID}
186       topicName = \hyperlink{mqtt__sn__client__misc_8c_ad8b1873c108de6931c3f2245e037d3a9}{mqttSnClientFindPredefTopicId}(context, 
      \hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId});
187    \}
188    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags}.topicIdType == \hyperlink{mqtt__sn__common_8h_a70807215f60d92d02503f2a5ed76ee96a558b98c894af8f1b6d373d93b5d17827}{MQTT\_SN\_SHORT\_TOPIC\_NAME})
189    \{
190       \textcolor{comment}{//Short topic names are topic names that have a fixed length of two}
191       \textcolor{comment}{//octets. They are short enough for being carried together with the}
192       \textcolor{comment}{//data within PUBLISH messages}
193       shortTopicName[0] = \hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId});
194       shortTopicName[1] = \hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{mqtt__sn__common_8h_a9f7eda5d21d45b5350db8cd0c451427a}{topicId});
195       shortTopicName[2] = \textcolor{charliteral}{'\(\backslash\)0'};
196 
197       \textcolor{comment}{//Point to the resulting topic name}
198       topicName = shortTopicName;
199    \}
200    \textcolor{keywordflow}{else}
201    \{
202       \textcolor{comment}{//The value of the TopicIdType flag is not valid}
203       topicName = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
204    \}
205 
206    \textcolor{comment}{//Check whether the topic name has been successfully resolved}
207    \textcolor{keywordflow}{if}(topicName != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
208    \{
209       \textcolor{comment}{//Any registered callback?}
210       \textcolor{keywordflow}{if}(context->publishCallback != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
211       \{
212          \textcolor{comment}{//Deliver the message to the application}
213          context->publishCallback(context, topicName, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, dataLen,
214             (\hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{MqttSnQosLevel}) \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags}.qos, \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags}.retain);
215       \}
216 
217       \textcolor{comment}{//Successfull processing}
218       returnCode = \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED};
219    \}
220    \textcolor{keywordflow}{else}
221    \{
222       \textcolor{comment}{//The client has received a PUBLISH message with an unknown topic ID}
223       returnCode = \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca5390ad885605874a8dea964586528f1f}{MQTT\_SN\_RETURN\_CODE\_REJECTED\_INVALID\_TOPIC\_ID}
      ;
224    \}
225 
226    \textcolor{comment}{//The return code indicates whether the PUBLISH message has been accepted}
227    \textcolor{comment}{//or rejected}
228    \textcolor{keywordflow}{return} \hyperlink{mqtt__sn__common_8h_aa43af56bba229c3214623f0f0c23bf6e}{returnCode};
229 \}
\end{DoxyCode}
