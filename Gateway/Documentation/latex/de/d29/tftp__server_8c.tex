\hypertarget{tftp__server_8c}{}\section{cyclone\+\_\+tcp/tftp/tftp\+\_\+server.c File Reference}
\label{tftp__server_8c}\index{cyclone\+\_\+tcp/tftp/tftp\+\_\+server.\+c@{cyclone\+\_\+tcp/tftp/tftp\+\_\+server.\+c}}


T\+F\+TP server.  


{\ttfamily \#include \char`\"{}tftp/tftp\+\_\+server.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tftp/tftp\+\_\+server\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{tftp__server_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_ade296bfed5309e0f497d85905610d9a9}{T\+F\+T\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{tftp__server_8c_aab61c9fb00a47405db619557cd4a9631}{tftp\+Server\+Get\+Default\+Settings} (\hyperlink{structTftpServerSettings}{Tftp\+Server\+Settings} $\ast$settings)
\begin{DoxyCompactList}\small\item\em Initialize settings with default values. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__server_8c_a03c44a860098b6deb60addd2bcf62ca8}{tftp\+Server\+Init} (\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{Tftp\+Server\+Context} $\ast$context, const \hyperlink{structTftpServerSettings}{Tftp\+Server\+Settings} $\ast$settings)
\begin{DoxyCompactList}\small\item\em T\+F\+TP server initialization. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__server_8c_ab2eeb960f0e710d41d3df575351fbd24}{tftp\+Server\+Start} (\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{Tftp\+Server\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Start T\+F\+TP server. \end{DoxyCompactList}\item 
void \hyperlink{tftp__server_8c_ad9a2260f50862685332fe4cac413e07a}{tftp\+Server\+Task} (\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{Tftp\+Server\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em T\+F\+TP server task. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
T\+F\+TP server. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
T\+F\+TP is a very simple protocol used to transfer files. Refer to the following R\+F\+Cs for complete details\+:
\begin{DoxyItemize}
\item R\+FC 1123\+: Requirements for Internet Hosts
\item R\+FC 1350\+: The T\+F\+TP Protocol (Revision 2)
\item R\+FC 1782\+: T\+F\+TP Option Extension
\item R\+FC 1783\+: T\+F\+TP Blocksize Option
\item R\+FC 1784\+: T\+F\+TP Timeout Interval and Transfer Size Options
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{tftp__server_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{tftp__server_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_ade296bfed5309e0f497d85905610d9a9}{T\+F\+T\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 42 of file tftp\+\_\+server.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{tftp__server_8c_aab61c9fb00a47405db619557cd4a9631}\label{tftp__server_8c_aab61c9fb00a47405db619557cd4a9631}} 
\index{tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}!tftp\+Server\+Get\+Default\+Settings@{tftp\+Server\+Get\+Default\+Settings}}
\index{tftp\+Server\+Get\+Default\+Settings@{tftp\+Server\+Get\+Default\+Settings}!tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}}
\subsubsection{\texorpdfstring{tftp\+Server\+Get\+Default\+Settings()}{tftpServerGetDefaultSettings()}}
{\footnotesize\ttfamily void tftp\+Server\+Get\+Default\+Settings (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpServerSettings}{Tftp\+Server\+Settings} $\ast$}]{settings }\end{DoxyParamCaption})}



Initialize settings with default values. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em settings} & Structure that contains T\+F\+TP server settings \\
\hline
\end{DoxyParams}


Definition at line 58 of file tftp\+\_\+server.\+c.


\begin{DoxyCode}
59 \{
60    \textcolor{comment}{//The TFTP server is not bound to any interface}
61    settings->\hyperlink{structTftpServerSettings_ada45e3b84aedec470a0d6fa4c2ff53ce}{interface} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
62 
63    \textcolor{comment}{//TFTP port number}
64    settings->\hyperlink{structTftpServerSettings_ac188b0c3119ad1c1ebeec4750e9123c8}{port} = \hyperlink{tftp__common_8h_ad9230620a5d3bb87a7ac280ff99875d1}{TFTP\_PORT};
65 
66    \textcolor{comment}{//Open file callback function}
67    settings->\hyperlink{structTftpServerSettings_acb6820c295cca83e7d6559977d548835}{openFileCallback} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
68    \textcolor{comment}{//Write file callback function}
69    settings->\hyperlink{structTftpServerSettings_a26573cbdb9c307f46dec55de70ff7843}{writeFileCallback} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
70    \textcolor{comment}{//Read file callback function}
71    settings->\hyperlink{structTftpServerSettings_a19916ed7790a89b5faac2c3f70cd5600}{readFileCallback} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
72    \textcolor{comment}{//Close file callback function}
73    settings->\hyperlink{structTftpServerSettings_a72dc05f03e3eb13f0250658c90c18e0f}{closeFileCallback} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
74 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__server_8c_a03c44a860098b6deb60addd2bcf62ca8}\label{tftp__server_8c_a03c44a860098b6deb60addd2bcf62ca8}} 
\index{tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}!tftp\+Server\+Init@{tftp\+Server\+Init}}
\index{tftp\+Server\+Init@{tftp\+Server\+Init}!tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}}
\subsubsection{\texorpdfstring{tftp\+Server\+Init()}{tftpServerInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Server\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{Tftp\+Server\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structTftpServerSettings}{Tftp\+Server\+Settings} $\ast$}]{settings }\end{DoxyParamCaption})}



T\+F\+TP server initialization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP server context \\
\hline
\mbox{\tt in}  & {\em settings} & T\+F\+TP server specific settings \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 84 of file tftp\+\_\+server.\+c.


\begin{DoxyCode}
85 \{
86    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
87 
88    \textcolor{comment}{//Debug message}
89    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Initializing TFTP server...\(\backslash\)r\(\backslash\)n"});
90 
91    \textcolor{comment}{//Ensure the parameters are valid}
92    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || settings == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
93       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
94 
95    \textcolor{comment}{//Clear the TFTP server context}
96    memset(context, 0, \textcolor{keyword}{sizeof}(\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{TftpServerContext}));
97 
98    \textcolor{comment}{//Save user settings}
99    context->settings = *settings;
100 
101    \textcolor{comment}{//Create an event object to poll the state of sockets}
102    \textcolor{keywordflow}{if}(!\hyperlink{os__port__chibios_8c_ac1658f3fed1eb64efcd47e4503a9ef2e}{osCreateEvent}(&context->event))
103    \{
104       \textcolor{comment}{//Failed to create event}
105       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca528efe91b7a7e4bcc9a6de7d4b778c67}{ERROR\_OUT\_OF\_RESOURCES};
106    \}
107 
108    \textcolor{comment}{//Start of exception handling block}
109    \textcolor{keywordflow}{do}
110    \{
111       \textcolor{comment}{//Open a UDP socket}
112       context->socket = \hyperlink{socket_8c_aa139bbf42b326b52eb08cf52771ac337}{socketOpen}(\hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a26963b01dac3a99a930779035d3796a7}{SOCKET\_TYPE\_DGRAM}, 
      \hyperlink{socket_8h_a56eb0e60bda5d1d8a2e702228405d969a53c45ffdb9dee4a8f885b816386a99b8}{SOCKET\_IP\_PROTO\_UDP});
113 
114       \textcolor{comment}{//Failed to open socket?}
115       \textcolor{keywordflow}{if}(context->socket == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
116       \{
117          \textcolor{comment}{//Report an error}
118          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab721230e985e398cc0977dd729a12c61}{ERROR\_OPEN\_FAILED};
119          \textcolor{comment}{//Exit immediately}
120          \textcolor{keywordflow}{break};
121       \}
122 
123       \textcolor{comment}{//Associate the socket with the relevant interface}
124       error = \hyperlink{net__legacy_8h_a80bc49fa99e5654d8c345cd5c70d36d3}{socketBindToInterface}(context->socket, settings->
      \hyperlink{structTftpServerSettings_ada45e3b84aedec470a0d6fa4c2ff53ce}{interface});
125       \textcolor{comment}{//Unable to bind the socket to the desired interface?}
126       \textcolor{keywordflow}{if}(error)
127          \textcolor{keywordflow}{break};
128 
129       \textcolor{comment}{//The TFTP server listens for connection requests on port 69}
130       error = \hyperlink{socket_8c_a56de93ca9f66782811dbe151d6da0b9c}{socketBind}(context->socket, &\hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY}, settings->
      \hyperlink{structTftpServerSettings_ac188b0c3119ad1c1ebeec4750e9123c8}{port});
131       \textcolor{comment}{//Unable to bind the socket to the desired port?}
132       \textcolor{keywordflow}{if}(error)
133          \textcolor{keywordflow}{break};
134 
135       \textcolor{comment}{//End of exception handling block}
136    \} \textcolor{keywordflow}{while}(0);
137 
138    \textcolor{comment}{//Did we encounter an error?}
139    \textcolor{keywordflow}{if}(error)
140    \{
141       \textcolor{comment}{//Free previously allocated resources}
142       \hyperlink{os__port__chibios_8c_a25827a49278bad6150b04b47165fda3d}{osDeleteEvent}(&context->event);
143       \textcolor{comment}{//Close socket}
144       \hyperlink{socket_8c_ac5012e9f71c97e2ea0410f2c5baccb0e}{socketClose}(context->socket);
145    \}
146 
147    \textcolor{comment}{//Return status code}
148    \textcolor{keywordflow}{return} error;
149 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__server_8c_ab2eeb960f0e710d41d3df575351fbd24}\label{tftp__server_8c_ab2eeb960f0e710d41d3df575351fbd24}} 
\index{tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}!tftp\+Server\+Start@{tftp\+Server\+Start}}
\index{tftp\+Server\+Start@{tftp\+Server\+Start}!tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}}
\subsubsection{\texorpdfstring{tftp\+Server\+Start()}{tftpServerStart()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Server\+Start (\begin{DoxyParamCaption}\item[{\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{Tftp\+Server\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Start T\+F\+TP server. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP server context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 158 of file tftp\+\_\+server.\+c.


\begin{DoxyCode}
159 \{
160    \hyperlink{structOsTask}{OsTask} *task;
161 
162    \textcolor{comment}{//Debug message}
163    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Starting TFTP server...\(\backslash\)r\(\backslash\)n"});
164 
165    \textcolor{comment}{//Make sure the TFTP server context is valid}
166    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
167       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
168 
169    \textcolor{comment}{//Create the TFTP server task}
170    task = \hyperlink{os__port__chibios_8c_aef8c6fe13a0df9e5cfaeb0501ecbac3e}{osCreateTask}(\textcolor{stringliteral}{"TFTP Server"}, (\hyperlink{os__port__chibios_8h_a52a4e1975bb554c2ce70aaac35b752d2}{OsTaskCode}) 
      \hyperlink{tftp__server_8c_ad9a2260f50862685332fe4cac413e07a}{tftpServerTask},
171       context, \hyperlink{tftp__server_8h_a84dc621259da6494680f75b9356a1471}{TFTP\_SERVER\_STACK\_SIZE}, 
      \hyperlink{tftp__server_8h_a33af35f71eacfd46848caba6d196938c}{TFTP\_SERVER\_PRIORITY});
172 
173    \textcolor{comment}{//Unable to create the task?}
174    \textcolor{keywordflow}{if}(task == \hyperlink{os__port_8h_aa673e52d8b286c3b613ad127aa85d536}{OS\_INVALID\_HANDLE})
175       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca528efe91b7a7e4bcc9a6de7d4b778c67}{ERROR\_OUT\_OF\_RESOURCES};
176 
177    \textcolor{comment}{//Successful processing}
178    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
179 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__server_8c_ad9a2260f50862685332fe4cac413e07a}\label{tftp__server_8c_ad9a2260f50862685332fe4cac413e07a}} 
\index{tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}!tftp\+Server\+Task@{tftp\+Server\+Task}}
\index{tftp\+Server\+Task@{tftp\+Server\+Task}!tftp\+\_\+server.\+c@{tftp\+\_\+server.\+c}}
\subsubsection{\texorpdfstring{tftp\+Server\+Task()}{tftpServerTask()}}
{\footnotesize\ttfamily void tftp\+Server\+Task (\begin{DoxyParamCaption}\item[{\hyperlink{tftp__server_8h_a74392166fd32409398d53d11de1d62fa}{Tftp\+Server\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



T\+F\+TP server task. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP server context \\
\hline
\end{DoxyParams}


Definition at line 187 of file tftp\+\_\+server.\+c.


\begin{DoxyCode}
188 \{
189    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
190    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
191    \hyperlink{tftp__server_8h_a0f645438c1de49e8bfc6960ef861e5c9}{TftpClientConnection} *connection;
192 
193 \textcolor{preprocessor}{#if (NET\_RTOS\_SUPPORT == ENABLED)}
194    \textcolor{comment}{//Task prologue}
195    \hyperlink{os__port__chibios_8h_abd3485ee30ab6a2de1208b0498a449cf}{osEnterTask}();
196 
197    \textcolor{comment}{//Process events}
198    \textcolor{keywordflow}{while}(1)
199    \{
200 \textcolor{preprocessor}{#endif}
201       \textcolor{comment}{//Clear event descriptor set}
202       memset(context->eventDesc, 0, \textcolor{keyword}{sizeof}(context->eventDesc));
203 
204       \textcolor{comment}{//Specify the events the application is interested in}
205       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{tftp__server_8h_a0acdd308af5bdb354e7a80dc8ff4388d}{TFTP\_SERVER\_MAX\_CONNECTIONS}; i++)
206       \{
207          \textcolor{comment}{//Point to the structure describing the current connection}
208          connection = &context->connection[i];
209 
210          \textcolor{comment}{//Loop through active connections only}
211          \textcolor{keywordflow}{if}(connection->state != \hyperlink{tftp__server_8h_ab2a2374014f9d5d77c65b15bb32f3a4aaa4e48853d260c8e956ae519c1f2deba2}{TFTP\_STATE\_CLOSED})
212          \{
213             \textcolor{comment}{//Wait for a packet to be received}
214             context->eventDesc[i].socket = connection->socket;
215             context->eventDesc[i].eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea72985d7e82625f037ca8a6734f49996c}{SOCKET\_EVENT\_RX\_READY};
216          \}
217       \}
218 
219       \textcolor{comment}{//The TFTP server listens for connection requests on port 69}
220       context->eventDesc[i].socket = context->socket;
221       context->eventDesc[i].eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea72985d7e82625f037ca8a6734f49996c}{SOCKET\_EVENT\_RX\_READY};
222 
223       \textcolor{comment}{//Wait for one of the set of sockets to become ready to perform I/O}
224       error = \hyperlink{socket_8c_a57ec969d9a3deee2dae93fe0a891e583}{socketPoll}(context->eventDesc, TFTP\_SERVER\_MAX\_CONNECTIONS + 1,
225          &context->event, \hyperlink{tftp__server_8h_ab483e1096bd234a8fe08a8a4f2dfcd5a}{TFTP\_SERVER\_TICK\_INTERVAL});
226 
227       \textcolor{comment}{//Verify status code}
228       \textcolor{keywordflow}{if}(!error)
229       \{
230          \textcolor{comment}{//Event-driven processing}
231          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{tftp__server_8h_a0acdd308af5bdb354e7a80dc8ff4388d}{TFTP\_SERVER\_MAX\_CONNECTIONS}; i++)
232          \{
233             \textcolor{comment}{//Point to the structure describing the current connection}
234             connection = &context->connection[i];
235 
236             \textcolor{comment}{//Loop through active connections only}
237             \textcolor{keywordflow}{if}(connection->state != \hyperlink{tftp__server_8h_ab2a2374014f9d5d77c65b15bb32f3a4aaa4e48853d260c8e956ae519c1f2deba2}{TFTP\_STATE\_CLOSED})
238             \{
239                \textcolor{comment}{//Check whether a packet has been received}
240                \textcolor{keywordflow}{if}(context->eventDesc[i].eventFlags & \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea72985d7e82625f037ca8a6734f49996c}{SOCKET\_EVENT\_RX\_READY})
241                \{
242                   \textcolor{comment}{//Process incoming packet}
243                   \hyperlink{tftp__server__misc_8c_a26e3bf5cc0cc5e8a0c415cdfd400770d}{tftpServerProcessPacket}(context, connection);
244                \}
245             \}
246          \}
247 
248          \textcolor{comment}{//Any connection request received on port 69?}
249          \textcolor{keywordflow}{if}(context->eventDesc[i].eventFlags & \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea72985d7e82625f037ca8a6734f49996c}{SOCKET\_EVENT\_RX\_READY})
250          \{
251             \textcolor{comment}{//Accept connection request}
252             \hyperlink{tftp__server__misc_8c_a6fe187acd7a366cae91106d096b215ad}{tftpServerAcceptRequest}(context);
253          \}
254       \}
255 
256       \textcolor{comment}{//Handle periodic operations}
257       \hyperlink{tftp__server__misc_8c_aa9bf9834436dbd5df47d52ff62da36a6}{tftpServerTick}(context);
258 
259 \textcolor{preprocessor}{#if (NET\_RTOS\_SUPPORT == ENABLED)}
260    \}
261 \textcolor{preprocessor}{#endif}
262 \}
\end{DoxyCode}
