\hypertarget{camellia_8h}{}\section{cyclone\+\_\+crypto/cipher/camellia.h File Reference}
\label{camellia_8h}\index{cyclone\+\_\+crypto/cipher/camellia.\+h@{cyclone\+\_\+crypto/cipher/camellia.\+h}}


Camellia encryption algorithm.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structCamelliaSubkey}{Camellia\+Subkey}
\begin{DoxyCompactList}\small\item\em Structure describing subkey generation. \end{DoxyCompactList}\item 
struct \hyperlink{structCamelliaContext}{Camellia\+Context}
\begin{DoxyCompactList}\small\item\em Camellia algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{camellia_8h_a75e646fb8543fc3279c2c3435fea75ed}{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~16
\item 
\#define \hyperlink{camellia_8h_a942054abb71ea3a1d5827e530c7c3555}{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{camellia_8h_a593a58219e849b6e74672d970bd46a1a}{camellia\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{camellia_8h_a40f037ff4c0ba16da488c8956f737eb8}{camellia\+Init} (\hyperlink{structCamelliaContext}{Camellia\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a Camellia context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{camellia_8h_ad3a28aca85720cfede64b88409905fc3}{camellia\+Encrypt\+Block} (\hyperlink{structCamelliaContext}{Camellia\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 16-\/byte block using Camellia algorithm. \end{DoxyCompactList}\item 
void \hyperlink{camellia_8h_a0312c04b9c38d4e956ef0f7baa5a2703}{camellia\+Decrypt\+Block} (\hyperlink{structCamelliaContext}{Camellia\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 16-\/byte block using Camellia algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{camellia_8h_a593a58219e849b6e74672d970bd46a1a}{camellia\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Camellia encryption algorithm. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{camellia_8h_a75e646fb8543fc3279c2c3435fea75ed}\label{camellia_8h_a75e646fb8543fc3279c2c3435fea75ed}} 
\index{camellia.\+h@{camellia.\+h}!C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!camellia.\+h@{camellia.\+h}}
\subsubsection{\texorpdfstring{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{CAMELLIA\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~16}



Definition at line 38 of file camellia.\+h.

\mbox{\Hypertarget{camellia_8h_a942054abb71ea3a1d5827e530c7c3555}\label{camellia_8h_a942054abb71ea3a1d5827e530c7c3555}} 
\index{camellia.\+h@{camellia.\+h}!C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!camellia.\+h@{camellia.\+h}}
\subsubsection{\texorpdfstring{C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{CAMELLIA\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define C\+A\+M\+E\+L\+L\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{camellia_8h_a593a58219e849b6e74672d970bd46a1a}{camellia\+Cipher\+Algo})}



Definition at line 40 of file camellia.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{camellia_8h_a0312c04b9c38d4e956ef0f7baa5a2703}\label{camellia_8h_a0312c04b9c38d4e956ef0f7baa5a2703}} 
\index{camellia.\+h@{camellia.\+h}!camellia\+Decrypt\+Block@{camellia\+Decrypt\+Block}}
\index{camellia\+Decrypt\+Block@{camellia\+Decrypt\+Block}!camellia.\+h@{camellia.\+h}}
\subsubsection{\texorpdfstring{camellia\+Decrypt\+Block()}{camelliaDecryptBlock()}}
{\footnotesize\ttfamily void camellia\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structCamelliaContext}{Camellia\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 16-\/byte block using Camellia algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Camellia context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 498 of file camellia.\+c.


\begin{DoxyCode}
499 \{
500    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
501    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp1;
502    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp2;
503    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ks;
504 
505    \textcolor{comment}{//The ciphertext is separated into two parts (L and R)}
506    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} right1 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 0);
507    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} right2 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 4);
508    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} left1 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 8);
509    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} left2 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 12);
510 
511    \textcolor{comment}{//The key schedule must be applied in reverse order}
512    ks = (context->\hyperlink{structCamelliaContext_a53fbc3b3b523fcf86ec2fb13690c4c5e}{nr} == 18) ? (context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks} + 48) : (context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks} + 64);
513 
514    \textcolor{comment}{//XOR ciphertext with kw3 and kw4}
515    right1 ^= ks[0];
516    right2 ^= ks[1];
517    left1 ^= ks[2];
518    left2 ^= ks[3];
519 
520    \textcolor{comment}{//Apply round function 18 or 24 times depending on the key length}
521    \textcolor{keywordflow}{for}(i = context->\hyperlink{structCamelliaContext_a53fbc3b3b523fcf86ec2fb13690c4c5e}{nr}; i > 0; i--)
522    \{
523       \textcolor{comment}{//Update current location in key schedule}
524       ks -= 2;
525       \textcolor{comment}{//Apply round function}
526       \hyperlink{camellia_8c_a154e5792105e99fa242318f6ac8b82e0}{CAMELLIA\_ROUND}(right1, right2, left1, left2, ks[0], ks[1]);
527 
528       \textcolor{comment}{//6th, 12th and 18th rounds require special processing}
529       \textcolor{keywordflow}{if}(i == 7 || i == 13 || i == 19)
530       \{
531          \textcolor{comment}{//Update current location in key schedule}
532          ks -= 4;
533          \textcolor{comment}{//Apply FL-function}
534          \hyperlink{camellia_8c_a8e81bc8ddfc0612e79a9912b610b1771}{CAMELLIA\_FL}(right1, right2, ks[2], ks[3])
535          \textcolor{comment}{//Apply inverse FL-function}
536          \hyperlink{camellia_8c_accfd57a28293d2b24735a988ac847bba}{CAMELLIA\_INV\_FL}(left1, left2, ks[0], ks[1])
537       \}
538    \}
539 
540    \textcolor{comment}{//Update current location in key schedule}
541    ks -= 4;
542    \textcolor{comment}{//XOR operation with kw1 and kw2}
543    left1 ^= ks[0];
544    left2 ^= ks[1];
545    right1 ^= ks[2];
546    right2 ^= ks[3];
547 
548    \textcolor{comment}{//The resulting value is the plaintext}
549    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(left1, output + 0);
550    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(left2, output + 4);
551    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(right1, output + 8);
552    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(right2, output + 12);
553 \}
\end{DoxyCode}
\mbox{\Hypertarget{camellia_8h_ad3a28aca85720cfede64b88409905fc3}\label{camellia_8h_ad3a28aca85720cfede64b88409905fc3}} 
\index{camellia.\+h@{camellia.\+h}!camellia\+Encrypt\+Block@{camellia\+Encrypt\+Block}}
\index{camellia\+Encrypt\+Block@{camellia\+Encrypt\+Block}!camellia.\+h@{camellia.\+h}}
\subsubsection{\texorpdfstring{camellia\+Encrypt\+Block()}{camelliaEncryptBlock()}}
{\footnotesize\ttfamily void camellia\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structCamelliaContext}{Camellia\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 16-\/byte block using Camellia algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Camellia context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 433 of file camellia.\+c.


\begin{DoxyCode}
434 \{
435    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
436    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp1;
437    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp2;
438    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ks;
439 
440    \textcolor{comment}{//The plaintext is separated into two parts (L and R)}
441    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} left1 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 0);
442    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} left2 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 4);
443    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} right1 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 8);
444    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} right2 = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 12);
445 
446    \textcolor{comment}{//The key schedule must be applied in ascending order}
447    ks = context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks};
448 
449    \textcolor{comment}{//XOR plaintext with kw1 and kw2}
450    left1 ^= ks[0];
451    left2 ^= ks[1];
452    right1 ^= ks[2];
453    right2 ^= ks[3];
454    \textcolor{comment}{//Advance current location in key schedule}
455    ks += 4;
456 
457    \textcolor{comment}{//Apply round function 18 or 24 times depending on the key length}
458    \textcolor{keywordflow}{for}(i = context->\hyperlink{structCamelliaContext_a53fbc3b3b523fcf86ec2fb13690c4c5e}{nr}; i > 0; i--)
459    \{
460       \textcolor{comment}{//Apply round function}
461       \hyperlink{camellia_8c_a154e5792105e99fa242318f6ac8b82e0}{CAMELLIA\_ROUND}(left1, left2, right1, right2, ks[0], ks[1]);
462       \textcolor{comment}{//Advance current location in key schedule}
463       ks += 2;
464 
465       \textcolor{comment}{//6th, 12th and 18th rounds require special processing}
466       \textcolor{keywordflow}{if}(i == 7 || i == 13 || i == 19)
467       \{
468          \textcolor{comment}{//Apply FL-function}
469          \hyperlink{camellia_8c_a8e81bc8ddfc0612e79a9912b610b1771}{CAMELLIA\_FL}(left1, left2, ks[0], ks[1])
470          \textcolor{comment}{//Apply inverse FL-function}
471          \hyperlink{camellia_8c_accfd57a28293d2b24735a988ac847bba}{CAMELLIA\_INV\_FL}(right1, right2, ks[2], ks[3])
472          \textcolor{comment}{//Advance current location in key schedule}
473          ks += 4;
474       \}
475    \}
476 
477    \textcolor{comment}{//XOR operation with kw3 and kw4}
478    right1 ^= ks[0];
479    right2 ^= ks[1];
480    left1 ^= ks[2];
481    left2 ^= ks[3];
482 
483    \textcolor{comment}{//The resulting value is the ciphertext}
484    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(right1, output + 0);
485    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(right2, output + 4);
486    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(left1, output + 8);
487    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(left2, output + 12);
488 \}
\end{DoxyCode}
\mbox{\Hypertarget{camellia_8h_a40f037ff4c0ba16da488c8956f737eb8}\label{camellia_8h_a40f037ff4c0ba16da488c8956f737eb8}} 
\index{camellia.\+h@{camellia.\+h}!camellia\+Init@{camellia\+Init}}
\index{camellia\+Init@{camellia\+Init}!camellia.\+h@{camellia.\+h}}
\subsubsection{\texorpdfstring{camellia\+Init()}{camelliaInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} camellia\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structCamelliaContext}{Camellia\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Initialize a Camellia context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Camellia context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 301 of file camellia.\+c.


\begin{DoxyCode}
302 \{
303    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
304    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp1;
305    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp2;
306    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
307    \textcolor{keyword}{const} \hyperlink{structCamelliaSubkey}{CamelliaSubkey} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
308 
309    \textcolor{comment}{//Check parameters}
310    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
311       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
312 
313    \textcolor{comment}{//Check the length of the key}
314    \textcolor{keywordflow}{if}(keyLen == 16)
315    \{
316       \textcolor{comment}{//18 rounds are required for 128-bit key}
317       context->\hyperlink{structCamelliaContext_a53fbc3b3b523fcf86ec2fb13690c4c5e}{nr} = 18;
318    \}
319    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(keyLen == 24 || keyLen == 32)
320    \{
321       \textcolor{comment}{//24 rounds are required for 192 and 256-bit keys}
322       context->\hyperlink{structCamelliaContext_a53fbc3b3b523fcf86ec2fb13690c4c5e}{nr} = 24;
323    \}
324    \textcolor{keywordflow}{else}
325    \{
326       \textcolor{comment}{//Report an error}
327       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
328    \}
329 
330    \textcolor{comment}{//Point to KA, KB, KL and KR}
331    k = context->\hyperlink{structCamelliaContext_a0ced10c17db7c88b9be722699cfffffa}{k};
332    \textcolor{comment}{//Clear key contents}
333    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(k, 0, 64);
334    \textcolor{comment}{//Save the supplied secret key}
335    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(k, key, keyLen);
336 
337    \textcolor{comment}{//192-bit keys require special processing}
338    \textcolor{keywordflow}{if}(keyLen == 24)
339    \{
340       \textcolor{comment}{//Form a 256-bit key}
341       k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 2] = ~k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 0];
342       k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 3] = ~k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 1];
343    \}
344 
345    \textcolor{comment}{//XOR KL and KR before applying the rounds}
346    \textcolor{keywordflow}{for}(i = 0; i < 4; i++)
347    \{
348       k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + i] = \hyperlink{cpu__endian_8h_a1f0e86c75b9c4d1fc0850a4762eb2148}{betoh32}(k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + i]);
349       k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + i] = \hyperlink{cpu__endian_8h_a1f0e86c75b9c4d1fc0850a4762eb2148}{betoh32}(k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + i]);
350       k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + i] = k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + i] ^ k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + i];
351    \}
352 
353    \textcolor{comment}{//Generate the 128-bit keys KA and KB}
354    \textcolor{keywordflow}{for}(i = 0; i < 6; i++)
355    \{
356       \textcolor{comment}{//Apply round function}
357       \hyperlink{camellia_8c_a154e5792105e99fa242318f6ac8b82e0}{CAMELLIA\_ROUND}(k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 0], k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 1], k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 2], k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 3], 
      \hyperlink{camellia_8c_a61428f6acc02d966c9771f969b643ec0}{sigma}[2 * i], \hyperlink{camellia_8c_a61428f6acc02d966c9771f969b643ec0}{sigma}[2 * i + 1]);
358 
359       \textcolor{comment}{//The 2nd round requires special processing}
360       \textcolor{keywordflow}{if}(i == 1)
361       \{
362          \textcolor{comment}{//The result is XORed with KL}
363          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 0] ^= k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + 0];
364          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 1] ^= k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + 1];
365          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 2] ^= k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + 2];
366          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 3] ^= k[\hyperlink{camellia_8c_a81a7c36ecc75b2f02c2b6d2d6d49778e}{KL} + 3];
367       \}
368       \textcolor{comment}{//The 4th round requires special processing}
369       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(i == 3)
370       \{
371          \textcolor{comment}{//Save KA after the 4th round}
372          \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(k + \hyperlink{camellia_8c_ac20b871b737ec964c3a7c440d411f969}{KA}, k + \hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB}, 16);
373          \textcolor{comment}{//The result is XORed with KR}
374          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 0] ^= k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 0];
375          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 1] ^= k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 1];
376          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 2] ^= k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 2];
377          k[\hyperlink{camellia_8c_a1841fd1a462d245d8c73dce55e2f45da}{KB} + 3] ^= k[\hyperlink{camellia_8c_a76f9425f5a9151312ae472a45a03b60c}{KR} + 3];
378       \}
379    \}
380 
381    \textcolor{comment}{//The key schedule depends on the length of key}
382    \textcolor{keywordflow}{if}(keyLen == 16)
383    \{
384       \textcolor{comment}{//Key schedule for 128-bit key}
385       i = \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{camellia_8c_a816290e7a13c6b54677e41417c382765}{ks1});
386       p = \hyperlink{camellia_8c_a816290e7a13c6b54677e41417c382765}{ks1};
387    \}
388    \textcolor{keywordflow}{else}
389    \{
390       \textcolor{comment}{//Key schedule for 192 and 256-bit keys}
391       i = \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{camellia_8c_a9d5a54f5ab87f285a18ad2d08b0ae091}{ks2});
392       p = \hyperlink{camellia_8c_a9d5a54f5ab87f285a18ad2d08b0ae091}{ks2};
393    \}
394 
395    \textcolor{comment}{//Generate subkeys}
396    \textcolor{keywordflow}{while}(i > 0)
397    \{
398       \textcolor{comment}{//Calculate the shift count}
399       \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = (p->\hyperlink{structCamelliaSubkey_af62ef58a7800c83d492f05b8f1c04af0}{shift} + p->\hyperlink{structCamelliaSubkey_a851bbb32cfc2269202af66ef72aa897d}{position}) / 32;
400       \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m} = (p->\hyperlink{structCamelliaSubkey_af62ef58a7800c83d492f05b8f1c04af0}{shift} + p->\hyperlink{structCamelliaSubkey_a851bbb32cfc2269202af66ef72aa897d}{position}) % 32;
401       \textcolor{comment}{//Point to KL, KR, KA or KB}
402       k = context->\hyperlink{structCamelliaContext_a0ced10c17db7c88b9be722699cfffffa}{k} + p->\hyperlink{structCamelliaSubkey_a9d4ee77359241e8eada1a3fff35551ce}{key};
403 
404       \textcolor{comment}{//Generate the current subkey}
405       \textcolor{keywordflow}{if}(m == 0)
406       \{
407          context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks}[p->\hyperlink{structCamelliaSubkey_ae3fdfef5ccf7b49fc347ade24fe3e3ca}{index}] = k[n % 4];
408          context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks}[p->\hyperlink{structCamelliaSubkey_ae3fdfef5ccf7b49fc347ade24fe3e3ca}{index} + 1] = k[(n + 1) % 4];
409       \}
410       \textcolor{keywordflow}{else}
411       \{
412          context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks}[p->\hyperlink{structCamelliaSubkey_ae3fdfef5ccf7b49fc347ade24fe3e3ca}{index}] = (k[n % 4] << \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}) | (k[(n + 1) % 4] >> (32 - 
      \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}));
413          context->\hyperlink{structCamelliaContext_a462c7479aab6b5e6a3646ab1b0eb6f6c}{ks}[p->\hyperlink{structCamelliaSubkey_ae3fdfef5ccf7b49fc347ade24fe3e3ca}{index} + 1] = (k[(n + 1) % 4] << m) | (k[(n + 2) % 4] >> (32 - m));
414       \}
415 
416       \textcolor{comment}{//Next subkey}
417       p++;
418       i--;
419    \}
420 
421    \textcolor{comment}{//No error to report}
422    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
423 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{camellia_8h_a593a58219e849b6e74672d970bd46a1a}\label{camellia_8h_a593a58219e849b6e74672d970bd46a1a}} 
\index{camellia.\+h@{camellia.\+h}!camellia\+Cipher\+Algo@{camellia\+Cipher\+Algo}}
\index{camellia\+Cipher\+Algo@{camellia\+Cipher\+Algo}!camellia.\+h@{camellia.\+h}}
\subsubsection{\texorpdfstring{camellia\+Cipher\+Algo}{camelliaCipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} camellia\+Cipher\+Algo}



Definition at line 279 of file camellia.\+c.

