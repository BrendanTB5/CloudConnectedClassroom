\hypertarget{oid_8c}{}\section{cyclone\+\_\+crypto/encoding/oid.c File Reference}
\label{oid_8c}\index{cyclone\+\_\+crypto/encoding/oid.\+c@{cyclone\+\_\+crypto/encoding/oid.\+c}}


O\+ID (Object Identifier)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{oid_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{oid_8c_a80ab34e995a15107af8975514a03efbb}{oid\+Check} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len)
\begin{DoxyCompactList}\small\item\em Check whether the specified object identifier is valid. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oid\+Comp} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$oid1, size\+\_\+t oid\+Len1, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$oid2, size\+\_\+t oid\+Len2)
\begin{DoxyCompactList}\small\item\em Compare object identifiers. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{oid_8c_aa87eb17a914fd929c4ea3b683bc211a8}{oid\+Match} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$subtree, size\+\_\+t subtree\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}, size\+\_\+t mask\+Len)
\begin{DoxyCompactList}\small\item\em Check whether an O\+ID matches the specified subtree. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{oid_8c_a01b05d4053e1aff70f4fa3429d889e17}{oid\+Count\+Sub\+Identifiers} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len)
\begin{DoxyCompactList}\small\item\em Calculate the number of sub-\/identifiers. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{oid_8c_a72ac22c80e241d7063691c459165e551}{oid\+Encode\+Sub\+Identifier} (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t max\+Oid\+Len, size\+\_\+t $\ast$pos, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Encode O\+ID sub-\/identifier. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{oid_8c_a1d91c34cf384005c0ee0c0bb95686aa7}{oid\+Decode\+Sub\+Identifier} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, size\+\_\+t $\ast$pos, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Decode O\+ID sub-\/identifier. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{oid_8c_a3ac6afc1831e8343e4c19bbe20ef047c}{oid\+From\+String} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$str, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t max\+Oid\+Len, size\+\_\+t $\ast$oid\+Len)
\begin{DoxyCompactList}\small\item\em Convert a string representation of an O\+ID to a binary O\+ID. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$ \hyperlink{oid_8c_afd6abfd7bdf7b14b9ca45ff051f3134e}{oid\+To\+String} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$str, size\+\_\+t max\+Str\+Len)
\begin{DoxyCompactList}\small\item\em Convert a binary O\+ID to a string representation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{oid_8c_aece2184ac142232287dba3da902de49e}{mask\+From\+String} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$str, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}, size\+\_\+t max\+Mask\+Len, size\+\_\+t $\ast$mask\+Len)
\begin{DoxyCompactList}\small\item\em Convert a bit mask to binary representation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
O\+ID (Object Identifier) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{oid_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{oid_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{oid.\+c@{oid.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file oid.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{oid_8c_aece2184ac142232287dba3da902de49e}\label{oid_8c_aece2184ac142232287dba3da902de49e}} 
\index{oid.\+c@{oid.\+c}!mask\+From\+String@{mask\+From\+String}}
\index{mask\+From\+String@{mask\+From\+String}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{mask\+From\+String()}{maskFromString()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mask\+From\+String (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{str,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{mask,  }\item[{size\+\_\+t}]{max\+Mask\+Len,  }\item[{size\+\_\+t $\ast$}]{mask\+Len }\end{DoxyParamCaption})}



Convert a bit mask to binary representation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em str} & N\+U\+L\+L-\/terminated string representing the bit mask \\
\hline
\mbox{\tt out}  & {\em mask} & Pointer to the buffer where to store the resulting mask \\
\hline
\mbox{\tt in}  & {\em max\+Mask\+Len} & Maximum number of bytes the buffer can hold \\
\hline
\mbox{\tt out}  & {\em mask\+Len} & Length of the mask \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 629 of file oid.\+c.


\begin{DoxyCode}
631 \{
632    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
633    \textcolor{keywordtype}{size\_t} i;
634    \textcolor{keywordtype}{size\_t} j;
635 
636    \textcolor{comment}{//Point to the first byte}
637    i = 0;
638    \textcolor{comment}{//Point to the most-significant bit}
639    j = 8;
640 
641    \textcolor{comment}{//Parse input string}
642    \textcolor{keywordflow}{while}(1)
643    \{
644       \textcolor{comment}{//Check current character}
645       \textcolor{keywordflow}{if}(*str == \textcolor{charliteral}{'0'} || *str == \textcolor{charliteral}{'1'})
646       \{
647          \textcolor{comment}{//Make sure the output buffer is large enough}
648          \textcolor{keywordflow}{if}(i >= maxMaskLen)
649          \{
650             \textcolor{comment}{//Report an error}
651             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
652             \textcolor{keywordflow}{break};
653          \}
654 
655          \textcolor{comment}{//Update bit mask}
656          \textcolor{keywordflow}{if}(*str == \textcolor{charliteral}{'1'})
657             \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}[i] |= (1 << (j - 1));
658          \textcolor{keywordflow}{else}
659             \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}[i] &= ~(1 << (j - 1));
660 
661          \textcolor{comment}{//Next bit}
662          j--;
663       \}
664       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*str == \textcolor{charliteral}{'\(\backslash\)0'})
665       \{
666          \textcolor{comment}{//End of string detected}
667          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
668          \textcolor{keywordflow}{break};
669       \}
670       \textcolor{keywordflow}{else}
671       \{
672          \textcolor{comment}{//Discard any other characters}
673       \}
674 
675       \textcolor{comment}{//Check whether the least-significant bit has been reached}
676       \textcolor{keywordflow}{if}(j == 0)
677       \{
678          \textcolor{comment}{//Point to the most-significant bit of the next byte}
679          j = 8;
680          i++;
681       \}
682 
683       \textcolor{comment}{//Point to the next character}
684       str++;
685    \}
686 
687    \textcolor{comment}{//Check status code}
688    \textcolor{keywordflow}{if}(!error)
689    \{
690       \textcolor{comment}{//Incomplete byte?}
691       \textcolor{keywordflow}{if}(j < 8)
692       \{
693          \textcolor{comment}{//The bit mask is extended with 1's to be the required length}
694          \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}[i] |= (1 << j) - 1;
695          \textcolor{comment}{//Save the length of the resulting mask}
696          *maskLen = i + 1;
697       \}
698       \textcolor{keywordflow}{else}
699       \{
700          \textcolor{comment}{//Save the length of the resulting mask}
701          *maskLen = i;
702       \}
703    \}
704 
705    \textcolor{comment}{//Return status code}
706    \textcolor{keywordflow}{return} error;
707 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_a80ab34e995a15107af8975514a03efbb}\label{oid_8c_a80ab34e995a15107af8975514a03efbb}} 
\index{oid.\+c@{oid.\+c}!oid\+Check@{oid\+Check}}
\index{oid\+Check@{oid\+Check}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+Check()}{oidCheck()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} oid\+Check (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len }\end{DoxyParamCaption})}



Check whether the specified object identifier is valid. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid} & Pointer to the object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 50 of file oid.\+c.


\begin{DoxyCode}
51 \{
52    \textcolor{keywordtype}{size\_t} i;
53    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
54 
55    \textcolor{comment}{//Check parameters}
56    \textcolor{keywordflow}{if}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
57       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
58 
59    \textcolor{comment}{//Check the length of the OID}
60    \textcolor{keywordflow}{if}(oidLen == 0)
61    \{
62       \textcolor{comment}{//Report an error}
63       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
64    \}
65    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(oidLen > 1)
66    \{
67       \textcolor{comment}{//Parse the object identifier}
68       \textcolor{keywordflow}{for}(i = 1, n = 2; i < oidLen; i++)
69       \{
70          \textcolor{comment}{//Update the total number of nodes}
71          \textcolor{keywordflow}{if}(!(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[i] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG}))
72             n++;
73 
74          \textcolor{comment}{//SNMP limits object identifier values to a maximum of 128 nodes}
75          \textcolor{keywordflow}{if}(n > 128)
76             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
77       \}
78 
79       \textcolor{comment}{//Ensure that the last sub-identifier is valid}
80       \textcolor{keywordflow}{if}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[oidLen - 1] & OID\_MORE\_FLAG)
81          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
82    \}
83 
84    \textcolor{comment}{//The specified OID is valid}
85    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
86 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}\label{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}} 
\index{oid.\+c@{oid.\+c}!oid\+Comp@{oid\+Comp}}
\index{oid\+Comp@{oid\+Comp}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+Comp()}{oidComp()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} oid\+Comp (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid1,  }\item[{size\+\_\+t}]{oid\+Len1,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid2,  }\item[{size\+\_\+t}]{oid\+Len2 }\end{DoxyParamCaption})}



Compare object identifiers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid1} & Pointer the first O\+ID \\
\hline
\mbox{\tt in}  & {\em oid\+Len1} & Length of the first O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em oid2} & Pointer the second O\+ID \\
\hline
\mbox{\tt in}  & {\em oid\+Len2} & Length of the second O\+ID, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Comparison result 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 0} & Objects identifiers are equal \\
\hline
{\em -\/1} & The first O\+ID lexicographically precedes the second O\+ID \\
\hline
{\em 1} & The second O\+ID lexicographically precedes the first O\+ID \\
\hline
\end{DoxyRetVals}


Definition at line 101 of file oid.\+c.


\begin{DoxyCode}
103 \{
104    \textcolor{keywordtype}{size\_t} i;
105 
106    \textcolor{comment}{//Perform lexicographical comparison}
107    \textcolor{keywordflow}{for}(i = 0; i < oidLen1 && i < oidLen2; i++)
108    \{
109       \textcolor{comment}{//Compare current byte}
110       \textcolor{keywordflow}{if}(oid1[i] < oid2[i])
111          \textcolor{keywordflow}{return} -1;
112       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(oid1[i] > oid2[i])
113          \textcolor{keywordflow}{return} 1;
114    \}
115 
116    \textcolor{comment}{//Compare length}
117    \textcolor{keywordflow}{if}(oidLen1 < oidLen2)
118       \textcolor{keywordflow}{return} -1;
119    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(oidLen1 > oidLen2)
120       \textcolor{keywordflow}{return} 1;
121 
122    \textcolor{comment}{//Object identifiers are equal}
123    \textcolor{keywordflow}{return} 0;
124 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_a01b05d4053e1aff70f4fa3429d889e17}\label{oid_8c_a01b05d4053e1aff70f4fa3429d889e17}} 
\index{oid.\+c@{oid.\+c}!oid\+Count\+Sub\+Identifiers@{oid\+Count\+Sub\+Identifiers}}
\index{oid\+Count\+Sub\+Identifiers@{oid\+Count\+Sub\+Identifiers}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+Count\+Sub\+Identifiers()}{oidCountSubIdentifiers()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} oid\+Count\+Sub\+Identifiers (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len }\end{DoxyParamCaption})}



Calculate the number of sub-\/identifiers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid} & Pointer to the object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of sub-\/identifiers 
\end{DoxyReturn}


Definition at line 275 of file oid.\+c.


\begin{DoxyCode}
276 \{
277    \textcolor{keywordtype}{size\_t} i;
278    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
279 
280    \textcolor{comment}{//Check the length of the OID}
281    \textcolor{keywordflow}{if}(oidLen == 0)
282    \{
283       \textcolor{comment}{//The OID is empty}
284       n = 0;
285    \}
286    \textcolor{keywordflow}{else}
287    \{
288       \textcolor{comment}{//The first byte encodes two sub-identifiers}
289       n = 2;
290 
291       \textcolor{comment}{//Parse the object identifier}
292       \textcolor{keywordflow}{for}(i = 1; i < oidLen; i++)
293       \{
294          \textcolor{comment}{//Update the total number of sub-identifiers}
295          \textcolor{keywordflow}{if}(!(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[i] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG}))
296             n++;
297       \}
298    \}
299 
300    \textcolor{comment}{//Return the total number of sub-identifiers}
301    \textcolor{keywordflow}{return} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
302 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_a1d91c34cf384005c0ee0c0bb95686aa7}\label{oid_8c_a1d91c34cf384005c0ee0c0bb95686aa7}} 
\index{oid.\+c@{oid.\+c}!oid\+Decode\+Sub\+Identifier@{oid\+Decode\+Sub\+Identifier}}
\index{oid\+Decode\+Sub\+Identifier@{oid\+Decode\+Sub\+Identifier}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+Decode\+Sub\+Identifier()}{oidDecodeSubIdentifier()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} oid\+Decode\+Sub\+Identifier (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{size\+\_\+t $\ast$}]{pos,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Decode O\+ID sub-\/identifier. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid} & Pointer to the object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in,out}  & {\em pos} & Offset where to read the sub-\/identifier \\
\hline
\mbox{\tt out}  & {\em value} & Value of the sub-\/identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 362 of file oid.\+c.


\begin{DoxyCode}
364 \{
365    \textcolor{keywordtype}{size\_t} i;
366 
367    \textcolor{comment}{//Initialize the value of the sub-identifier}
368    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = 0;
369 
370    \textcolor{comment}{//Read the OID until the last byte of the sub-identifier is found}
371    \textcolor{keywordflow}{for}(i = *pos; i < oidLen; i++)
372    \{
373       \textcolor{comment}{//Shift the value to the left}
374       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} <<= 7;
375       \textcolor{comment}{//Update value of the sub-identifier}
376       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} |= \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[i] & \hyperlink{oid_8h_af3ba06688a6ae640c0a79ed973d6e1c8}{OID\_VALUE\_MASK};
377 
378       \textcolor{comment}{//Bit b8 is set to zero to indicate the last byte}
379       \textcolor{keywordflow}{if}(!(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[i] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG}))
380       \{
381          \textcolor{comment}{//Update offset value}
382          *pos = i + 1;
383          \textcolor{comment}{//Successful processing}
384          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
385       \}
386    \}
387 
388    \textcolor{comment}{//The specified OID is not valid}
389    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
390 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_a72ac22c80e241d7063691c459165e551}\label{oid_8c_a72ac22c80e241d7063691c459165e551}} 
\index{oid.\+c@{oid.\+c}!oid\+Encode\+Sub\+Identifier@{oid\+Encode\+Sub\+Identifier}}
\index{oid\+Encode\+Sub\+Identifier@{oid\+Encode\+Sub\+Identifier}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+Encode\+Sub\+Identifier()}{oidEncodeSubIdentifier()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} oid\+Encode\+Sub\+Identifier (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{max\+Oid\+Len,  }\item[{size\+\_\+t $\ast$}]{pos,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{value }\end{DoxyParamCaption})}



Encode O\+ID sub-\/identifier. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid} & Pointer to the object identifier \\
\hline
\mbox{\tt in}  & {\em max\+Oid\+Len} & Maximum number of bytes the O\+ID can hold \\
\hline
\mbox{\tt in,out}  & {\em pos} & Offset where to write the sub-\/identifier \\
\hline
\mbox{\tt in}  & {\em value} & Value of the sub-\/identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 314 of file oid.\+c.


\begin{DoxyCode}
316 \{
317    \textcolor{keywordtype}{size\_t} i;
318    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
319    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} temp[5];
320 
321    \textcolor{comment}{//Encode the first byte of the sub-identifier}
322    temp[0] = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} & \hyperlink{oid_8h_af3ba06688a6ae640c0a79ed973d6e1c8}{OID\_VALUE\_MASK};
323    \textcolor{comment}{//Shift the value to the right}
324    \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} >>= 7;
325 
326    \textcolor{comment}{//Encode the remaining bytes}
327    \textcolor{keywordflow}{for}(n = 1; \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} != 0; n++)
328    \{
329       \textcolor{comment}{//Encode current byte}
330       temp[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG} | (\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} & \hyperlink{oid_8h_af3ba06688a6ae640c0a79ed973d6e1c8}{OID\_VALUE\_MASK});
331       \textcolor{comment}{//Shift the value to the right}
332       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} >>= 7;
333    \}
334 
335    \textcolor{comment}{//Sanity check}
336    \textcolor{keywordflow}{if}((*pos + n) > maxOidLen)
337       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
338 
339    \textcolor{comment}{//Write the current sub-identifier}
340    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
341    \{
342       \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[*pos + i] = temp[n - i - 1];
343    \}
344 
345    \textcolor{comment}{//Update offset value}
346    *pos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
347 
348    \textcolor{comment}{//Successful processing}
349    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
350 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_a3ac6afc1831e8343e4c19bbe20ef047c}\label{oid_8c_a3ac6afc1831e8343e4c19bbe20ef047c}} 
\index{oid.\+c@{oid.\+c}!oid\+From\+String@{oid\+From\+String}}
\index{oid\+From\+String@{oid\+From\+String}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+From\+String()}{oidFromString()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} oid\+From\+String (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{str,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{max\+Oid\+Len,  }\item[{size\+\_\+t $\ast$}]{oid\+Len }\end{DoxyParamCaption})}



Convert a string representation of an O\+ID to a binary O\+ID. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em str} & N\+U\+L\+L-\/terminated string representing the O\+ID \\
\hline
\mbox{\tt out}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em max\+Oid\+Len} & Maximum number of bytes the O\+ID can hold \\
\hline
\mbox{\tt out}  & {\em oid\+Len} & Length of the object identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 402 of file oid.\+c.


\begin{DoxyCode}
404 \{
405    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
406    \textcolor{keywordtype}{size\_t} i;
407    \textcolor{keywordtype}{size\_t} j;
408    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
409    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
410    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} temp[5];
411 
412    \textcolor{comment}{//Reset the length of the OID}
413    *oidLen = 0;
414 
415    \textcolor{comment}{//Number of nodes}
416    i = 0;
417    \textcolor{comment}{//Initialize the value of the sub-identifier}
418    value = 0;
419 
420    \textcolor{comment}{//Parse input string}
421    \textcolor{keywordflow}{while}(1)
422    \{
423       \textcolor{comment}{//Digit found?}
424       \textcolor{keywordflow}{if}(\hyperlink{cyclone__crypto_2core_2crypto_8h_a6859cfefa1679722e293755ba4d51ce5}{cryptoIsdigit}(*str))
425       \{
426          \textcolor{comment}{//Update the value of the sub-identifier}
427          value = (value * 10) + (*str - \textcolor{charliteral}{'0'});
428       \}
429       \textcolor{comment}{//Separator or end of string found?}
430       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*str == \textcolor{charliteral}{'.'} || *str == \textcolor{charliteral}{'\(\backslash\)0'})
431       \{
432          \textcolor{comment}{//First node?}
433          \textcolor{keywordflow}{if}(i == 0)
434          \{
435             \textcolor{comment}{//Check value}
436             \textcolor{keywordflow}{if}(value > 6)
437             \{
438                \textcolor{comment}{//The conversion failed}
439                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
440                \textcolor{keywordflow}{break};
441             \}
442 
443             \textcolor{comment}{//Encode the first sub-identifier}
444             temp[0] = value * 40;
445             \textcolor{comment}{//Prepare to decode the next node}
446             value = 0;
447             \textcolor{comment}{//Do not write current sub-identifier yet}
448             n = 0;
449          \}
450          \textcolor{comment}{//Second node?}
451          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(i == 1)
452          \{
453             \textcolor{comment}{//Check value}
454             \textcolor{keywordflow}{if}(value > 39)
455             \{
456                \textcolor{comment}{//The conversion failed}
457                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
458                \textcolor{keywordflow}{break};
459             \}
460 
461             \textcolor{comment}{//Encode the second sub-identifier}
462             temp[0] += \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
463             \textcolor{comment}{//Prepare to decode the next node}
464             value = 0;
465             \textcolor{comment}{//Write the first two sub-identifiers}
466             n = 1;
467          \}
468          \textcolor{comment}{//Remaining nodes?}
469          \textcolor{keywordflow}{else}
470          \{
471             \textcolor{comment}{//Encode the first byte of the sub-identifier}
472             temp[0] = value & \hyperlink{oid_8h_af3ba06688a6ae640c0a79ed973d6e1c8}{OID\_VALUE\_MASK};
473             \textcolor{comment}{//Shift the value to the right}
474             value >>= 7;
475 
476             \textcolor{comment}{//Encode the remaining bytes}
477             \textcolor{keywordflow}{for}(n = 1; value != 0; n++)
478             \{
479                \textcolor{comment}{//Encode current byte}
480                temp[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG} | (value & \hyperlink{oid_8h_af3ba06688a6ae640c0a79ed973d6e1c8}{OID\_VALUE\_MASK});
481                \textcolor{comment}{//Shift the value to the right}
482                value >>= 7;
483             \}
484          \}
485 
486          \textcolor{comment}{//Sanity check}
487          \textcolor{keywordflow}{if}(n > maxOidLen)
488          \{
489             \textcolor{comment}{//Report an error}
490             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
491             \textcolor{keywordflow}{break};
492          \}
493 
494          \textcolor{comment}{//Write the current sub-identifier}
495          \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j++)
496          \{
497             \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[j] = temp[n - j - 1];
498          \}
499 
500          \textcolor{comment}{//Advance write pointer}
501          \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
502          *oidLen += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
503          maxOidLen -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
504 
505          \textcolor{comment}{//Number of sub-identifiers}
506          i++;
507 
508          \textcolor{comment}{//End of string detected?}
509          \textcolor{keywordflow}{if}(*str == \textcolor{charliteral}{'\(\backslash\)0'})
510          \{
511             \textcolor{comment}{//The conversion succeeded}
512             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
513             \textcolor{keywordflow}{break};
514          \}
515       \}
516       \textcolor{comment}{//Invalid character...}
517       \textcolor{keywordflow}{else}
518       \{
519          \textcolor{comment}{//The conversion failed}
520          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
521          \textcolor{keywordflow}{break};
522       \}
523 
524       \textcolor{comment}{//Point to the next character}
525       str++;
526    \}
527 
528    \textcolor{comment}{//Return status code}
529    \textcolor{keywordflow}{return} error;
530 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_aa87eb17a914fd929c4ea3b683bc211a8}\label{oid_8c_aa87eb17a914fd929c4ea3b683bc211a8}} 
\index{oid.\+c@{oid.\+c}!oid\+Match@{oid\+Match}}
\index{oid\+Match@{oid\+Match}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+Match()}{oidMatch()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} oid\+Match (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{subtree,  }\item[{size\+\_\+t}]{subtree\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{mask,  }\item[{size\+\_\+t}]{mask\+Len }\end{DoxyParamCaption})}



Check whether an O\+ID matches the specified subtree. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid} & Pointer to the object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em subtree} & Pointer to the subtree \\
\hline
\mbox{\tt in}  & {\em subtree\+Len} & Length of the subtree, in bytes \\
\hline
\mbox{\tt in}  & {\em mask} & Pointer to the mask \\
\hline
\mbox{\tt in}  & {\em mask\+Len} & Length of the mask, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the O\+ID matches the specified subtree, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 138 of file oid.\+c.


\begin{DoxyCode}
140 \{
141    \textcolor{keywordtype}{size\_t} i;
142    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} flag;
143    \textcolor{keywordtype}{size\_t} oidPos;
144    \textcolor{keywordtype}{size\_t} subtreePos;
145 
146    \textcolor{comment}{//Initialize variables}
147    oidPos = 0;
148    subtreePos = 0;
149 
150    \textcolor{comment}{//Check whether the OID matches the specified subtree}
151    \textcolor{keywordflow}{for}(i = 0; subtreePos < subtreeLen; i++)
152    \{
153       \textcolor{comment}{//Check the length of the OID}
154       \textcolor{keywordflow}{if}(oidPos >= oidLen)
155          \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
156 
157       \textcolor{comment}{//The bit mask is extended with 1's to be the required length}
158       \textcolor{keywordflow}{if}((i / 8) < maskLen)
159          flag = \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}[i / 8] & (1 << (7 - (i % 8)));
160       \textcolor{keywordflow}{else}
161          flag = 1;
162 
163       \textcolor{comment}{//First node?}
164       \textcolor{keywordflow}{if}(i == 0)
165       \{
166          \textcolor{comment}{//The mask allows for a simple form of wildcarding}
167          \textcolor{keywordflow}{if}(flag)
168          \{
169             \textcolor{comment}{//Compare the first sub-identifier}
170             \textcolor{keywordflow}{if}((\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[0] / 40) != (subtree[0] / 40))
171                \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
172          \}
173       \}
174       \textcolor{comment}{//Second node?}
175       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(i == 1)
176       \{
177          \textcolor{comment}{//The mask allows for a simple form of wildcarding}
178          \textcolor{keywordflow}{if}(flag)
179          \{
180             \textcolor{comment}{//Compare the second sub-identifier}
181             \textcolor{keywordflow}{if}((\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[0] % 40) != (subtree[0] % 40))
182                \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
183          \}
184 
185          \textcolor{comment}{//Jump to the next node}
186          oidPos = 1;
187          subtreePos = 1;
188       \}
189       \textcolor{comment}{//Remaining nodes?}
190       \textcolor{keywordflow}{else}
191       \{
192          \textcolor{comment}{//The mask allows for a simple form of wildcarding}
193          \textcolor{keywordflow}{if}(flag)
194          \{
195             \textcolor{comment}{//Compare sub-identifiers}
196             \textcolor{keywordflow}{while}(1)
197             \{
198                \textcolor{comment}{//Compare the current byte}
199                \textcolor{keywordflow}{if}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[oidPos] != subtree[subtreePos])
200                   \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
201 
202                \textcolor{comment}{//Bit b8 is set to zero to indicate the last byte}
203                flag = \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[oidPos] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG};
204 
205                \textcolor{comment}{//Next byte}
206                oidPos++;
207                subtreePos++;
208 
209                \textcolor{comment}{//Last byte of the sub-identifier?}
210                \textcolor{keywordflow}{if}(!flag)
211                   \textcolor{keywordflow}{break};
212 
213                \textcolor{comment}{//Check the length of the OID}
214                \textcolor{keywordflow}{if}(oidPos >= oidLen)
215                   \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
216 
217                \textcolor{comment}{//Check the length of the subtree}
218                \textcolor{keywordflow}{if}(subtreePos > subtreeLen)
219                   \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
220             \}
221          \}
222          \textcolor{keywordflow}{else}
223          \{
224             \textcolor{comment}{//Read the OID until the last byte of the sub-identifier is found}
225             \textcolor{keywordflow}{while}(1)
226             \{
227                \textcolor{comment}{//Bit b8 is set to zero to indicate the last byte}
228                flag = \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[oidPos] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG};
229 
230                \textcolor{comment}{//Next byte}
231                oidPos++;
232 
233                \textcolor{comment}{//Last byte of the sub-identifier?}
234                \textcolor{keywordflow}{if}(!flag)
235                   \textcolor{keywordflow}{break};
236 
237                \textcolor{comment}{//Check the length of the OID}
238                \textcolor{keywordflow}{if}(oidPos >= oidLen)
239                   \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
240             \}
241 
242             \textcolor{comment}{//Read the subtree until the last byte of the sub-identifier is found}
243             \textcolor{keywordflow}{while}(1)
244             \{
245                \textcolor{comment}{//Bit b8 is set to zero to indicate the last byte}
246                flag = subtree[subtreePos] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG};
247 
248                \textcolor{comment}{//Next byte}
249                subtreePos++;
250 
251                \textcolor{comment}{//Last byte of the sub-identifier?}
252                \textcolor{keywordflow}{if}(!flag)
253                   \textcolor{keywordflow}{break};
254 
255                \textcolor{comment}{//Check the length of the subtree}
256                \textcolor{keywordflow}{if}(subtreePos >= subtreeLen)
257                   \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
258             \}
259          \}
260       \}
261    \}
262 
263    \textcolor{comment}{//The OID matches the specified subtree}
264    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
265 \}
\end{DoxyCode}
\mbox{\Hypertarget{oid_8c_afd6abfd7bdf7b14b9ca45ff051f3134e}\label{oid_8c_afd6abfd7bdf7b14b9ca45ff051f3134e}} 
\index{oid.\+c@{oid.\+c}!oid\+To\+String@{oid\+To\+String}}
\index{oid\+To\+String@{oid\+To\+String}!oid.\+c@{oid.\+c}}
\subsubsection{\texorpdfstring{oid\+To\+String()}{oidToString()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}$\ast$ oid\+To\+String (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{str,  }\item[{size\+\_\+t}]{max\+Str\+Len }\end{DoxyParamCaption})}



Convert a binary O\+ID to a string representation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the object identifier, in bytes \\
\hline
\mbox{\tt out}  & {\em str} & N\+U\+L\+L-\/terminated string representing the O\+ID \\
\hline
\mbox{\tt in}  & {\em max\+Str\+Len} & Maximum length of the resulting string \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the formatted string 
\end{DoxyReturn}


Definition at line 542 of file oid.\+c.


\begin{DoxyCode}
544 \{
545    \textcolor{keyword}{static} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} buffer[128];
546    \textcolor{keywordtype}{size\_t} i;
547    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
548    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
549    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
550    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} temp[12];
551 
552    \textcolor{comment}{//The str parameter is optional}
553    \textcolor{keywordflow}{if}(str == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
554    \{
555       \textcolor{comment}{//Point to the internal buffer}
556       str = buffer;
557       \textcolor{comment}{//Maximum length of the resulting string}
558       maxStrLen = \textcolor{keyword}{sizeof}(buffer) - 1;
559    \}
560 
561    \textcolor{comment}{//Point to the beginning of the string}
562    p = str;
563    \textcolor{comment}{//Properly terminate the string}
564    *p = \textcolor{charliteral}{'\(\backslash\)0'};
565 
566    \textcolor{comment}{//Check the length of the OID}
567    \textcolor{keywordflow}{if}(oidLen > 0)
568    \{
569       \textcolor{comment}{//Convert the first 2 bytes}
570       n = sprintf(temp, \textcolor{stringliteral}{"%"} PRIu8 \textcolor{stringliteral}{".%"} PRIu8 \textcolor{stringliteral}{""}, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[0] / 40, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[0] % 40);
571 
572       \textcolor{comment}{//Sanity check}
573       \textcolor{keywordflow}{if}(n <= maxStrLen)
574       \{
575          \textcolor{comment}{//Copy the resulting string}
576          \hyperlink{cyclone__crypto_2core_2crypto_8h_abf103c49118d398d66475f26db70412b}{cryptoStrcpy}(p, temp);
577          \textcolor{comment}{//Advance write pointer}
578          p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
579          maxStrLen -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
580       \}
581 
582       \textcolor{comment}{//Initialize the value of the sub-identifier}
583       value = 0;
584 
585       \textcolor{comment}{//Convert the rest of the OID}
586       \textcolor{keywordflow}{for}(i = 1; i < oidLen; i++)
587       \{
588          \textcolor{comment}{//Shift the value to the left}
589          value <<= 7;
590          \textcolor{comment}{//Update the current value}
591          value |= \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[i] & \hyperlink{oid_8h_af3ba06688a6ae640c0a79ed973d6e1c8}{OID\_VALUE\_MASK};
592 
593          \textcolor{comment}{//Bit b8 is set to zero to indicate the last byte}
594          \textcolor{keywordflow}{if}(!(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}[i] & \hyperlink{oid_8h_a92a39fc5e9b9b348469ed71cedefd90a}{OID\_MORE\_FLAG}))
595          \{
596             \textcolor{comment}{//Dump current value}
597             n = sprintf(temp, \textcolor{stringliteral}{".%"} PRIu32, value);
598 
599             \textcolor{comment}{//Sanity check}
600             \textcolor{keywordflow}{if}(n <= maxStrLen)
601             \{
602                \textcolor{comment}{//Copy the resulting string}
603                \hyperlink{cyclone__crypto_2core_2crypto_8h_abf103c49118d398d66475f26db70412b}{cryptoStrcpy}(p, temp);
604                \textcolor{comment}{//Advance write pointer}
605                p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
606                maxStrLen -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
607             \}
608 
609             \textcolor{comment}{//Prepare to decode the next value}
610             value = 0;
611          \}
612       \}
613    \}
614 
615    \textcolor{comment}{//Return a pointer to the formatted string}
616    \textcolor{keywordflow}{return} str;
617 \}
\end{DoxyCode}
