\hypertarget{samd51__crypto__pukcc_8h}{}\section{cyclone\+\_\+crypto/hardware/samd51\+\_\+crypto\+\_\+pukcc.h File Reference}
\label{samd51__crypto__pukcc_8h}\index{cyclone\+\_\+crypto/hardware/samd51\+\_\+crypto\+\_\+pukcc.\+h@{cyclone\+\_\+crypto/hardware/samd51\+\_\+crypto\+\_\+pukcc.\+h}}


S\+A\+M\+D51 P\+U\+K\+CC public key accelerator.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structPukccEcPoint}{Pukcc\+Ec\+Point}
\begin{DoxyCompactList}\small\item\em Elliptic curve point. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccFmultParams}{Pukcc\+Fmult\+Params}
\begin{DoxyCompactList}\small\item\em Fmult service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccGcdParams}{Pukcc\+Gcd\+Params}
\begin{DoxyCompactList}\small\item\em G\+CD service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccRedModParams}{Pukcc\+Red\+Mod\+Params}
\begin{DoxyCompactList}\small\item\em Red\+Mod service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccExpModParams}{Pukcc\+Exp\+Mod\+Params}
\begin{DoxyCompactList}\small\item\em Exp\+Mod service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccPrimeGenParams}{Pukcc\+Prime\+Gen\+Params}
\begin{DoxyCompactList}\small\item\em Prime\+Gen service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccCrtParams}{Pukcc\+Crt\+Params}
\begin{DoxyCompactList}\small\item\em C\+RT service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccZpEcPointIsOnCurveParams}{Pukcc\+Zp\+Ec\+Point\+Is\+On\+Curve\+Params}
\begin{DoxyCompactList}\small\item\em Zp\+Ec\+Point\+Is\+On\+Curve service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccZpEcConvProjToAffineParams}{Pukcc\+Zp\+Ec\+Conv\+Proj\+To\+Affine\+Params}
\begin{DoxyCompactList}\small\item\em Zp\+Ec\+Conv\+Proj\+To\+Affine service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccZpEccMulParams}{Pukcc\+Zp\+Ecc\+Mul\+Params}
\begin{DoxyCompactList}\small\item\em Zp\+Ecc\+Mul service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccZpEcDsaGenerateParams}{Pukcc\+Zp\+Ec\+Dsa\+Generate\+Params}
\begin{DoxyCompactList}\small\item\em Zp\+Ec\+Dsa\+Generate service parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structPukccZpEcDsaVerifyParams}{Pukcc\+Zp\+Ec\+Dsa\+Verify\+Params}
\begin{DoxyCompactList}\small\item\em Zp\+Ec\+Dsa\+Verify service parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{samd51__crypto__pukcc_8h_ad1d30e29d8d30aee1719f2cd4ae239fa}{P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE}~0x02011000\+UL
\item 
\#define \hyperlink{samd51__crypto__pukcc_8h_ae45c245e708d6186181093061d8a25ab}{P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})~((\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}) ((\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}) (\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{samd51__crypto__pukcc_8h_ac2204ce75455e8e0be1d075463d6dd4e}{pukcc\+Init} (void)
\begin{DoxyCompactList}\small\item\em Initialize P\+U\+K\+CC public key accelerator. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+A\+M\+D51 P\+U\+K\+CC public key accelerator. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{samd51__crypto__pukcc_8h_ad1d30e29d8d30aee1719f2cd4ae239fa}\label{samd51__crypto__pukcc_8h_ad1d30e29d8d30aee1719f2cd4ae239fa}} 
\index{samd51\+\_\+crypto\+\_\+pukcc.\+h@{samd51\+\_\+crypto\+\_\+pukcc.\+h}!P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE@{P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE}}
\index{P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE@{P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE}!samd51\+\_\+crypto\+\_\+pukcc.\+h@{samd51\+\_\+crypto\+\_\+pukcc.\+h}}
\subsubsection{\texorpdfstring{P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE}{PUKCC\_CRYPTO\_RAM\_BASE}}
{\footnotesize\ttfamily \#define P\+U\+K\+C\+C\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+R\+A\+M\+\_\+\+B\+A\+SE~0x02011000\+UL}



Definition at line 38 of file samd51\+\_\+crypto\+\_\+pukcc.\+h.

\mbox{\Hypertarget{samd51__crypto__pukcc_8h_ae45c245e708d6186181093061d8a25ab}\label{samd51__crypto__pukcc_8h_ae45c245e708d6186181093061d8a25ab}} 
\index{samd51\+\_\+crypto\+\_\+pukcc.\+h@{samd51\+\_\+crypto\+\_\+pukcc.\+h}!P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR@{P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR}}
\index{P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR@{P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR}!samd51\+\_\+crypto\+\_\+pukcc.\+h@{samd51\+\_\+crypto\+\_\+pukcc.\+h}}
\subsubsection{\texorpdfstring{P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR}{PUKCC\_FAR\_TO\_NEAR}}
{\footnotesize\ttfamily \#define P\+U\+K\+C\+C\+\_\+\+F\+A\+R\+\_\+\+T\+O\+\_\+\+N\+E\+AR(\begin{DoxyParamCaption}\item[{}]{\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} }\end{DoxyParamCaption})~((\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}) ((\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}) (\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})))}



Definition at line 41 of file samd51\+\_\+crypto\+\_\+pukcc.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{samd51__crypto__pukcc_8h_ac2204ce75455e8e0be1d075463d6dd4e}\label{samd51__crypto__pukcc_8h_ac2204ce75455e8e0be1d075463d6dd4e}} 
\index{samd51\+\_\+crypto\+\_\+pukcc.\+h@{samd51\+\_\+crypto\+\_\+pukcc.\+h}!pukcc\+Init@{pukcc\+Init}}
\index{pukcc\+Init@{pukcc\+Init}!samd51\+\_\+crypto\+\_\+pukcc.\+h@{samd51\+\_\+crypto\+\_\+pukcc.\+h}}
\subsubsection{\texorpdfstring{pukcc\+Init()}{pukccInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pukcc\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize P\+U\+K\+CC public key accelerator. 



Definition at line 56 of file samd51\+\_\+crypto\+\_\+pukcc.\+c.


\begin{DoxyCode}
57 \{
58    \textcolor{comment}{//Enable PUKCC clock}
59    MCLK->AHBMASK.reg |= MCLK\_AHBMASK\_PUKCC;
60 
61    \textcolor{comment}{//Clear PUKCLParam structure}
62    memset(&\hyperlink{samd51__crypto__pukcc_8c_adc1948c03b6b4b2c8c88e286ace6efe4}{PUKCLParam}, 0, \textcolor{keyword}{sizeof}(PUKCL\_PARAM));
63    \hyperlink{samd51__crypto__pukcc_8c_ab31506a251b636e98d84c30012b7d4fe}{pvPUKCLParam} = &\hyperlink{samd51__crypto__pukcc_8c_adc1948c03b6b4b2c8c88e286ace6efe4}{PUKCLParam};
64 
65    \textcolor{comment}{//Initialize PUKCC}
66    vPUKCL\_Process(SelfTest, \hyperlink{samd51__crypto__pukcc_8c_ab31506a251b636e98d84c30012b7d4fe}{pvPUKCLParam});
67 
68    \textcolor{comment}{//Check status code}
69    \textcolor{keywordflow}{if}(PUKCL(u2Status) != PUKCL\_OK)
70       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
71 
72    \textcolor{comment}{//Check version number}
73    \textcolor{keywordflow}{if}(\hyperlink{samd51__crypto__pukcc_8c_ab31506a251b636e98d84c30012b7d4fe}{pvPUKCLParam}->P.PUKCL\_SelfTest.u4Version != PUKCL\_VERSION)
74       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
75 
76    \textcolor{comment}{//The return values from the SelfTest service must be compared against}
77    \textcolor{comment}{//known values mentioned in the service description}
78    \textcolor{keywordflow}{if}(\hyperlink{samd51__crypto__pukcc_8c_ab31506a251b636e98d84c30012b7d4fe}{pvPUKCLParam}->P.PUKCL\_SelfTest.u4CheckNum1 != 0x6E70DDD2)
79       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
80 
81    \textcolor{keywordflow}{if}(\hyperlink{samd51__crypto__pukcc_8c_ab31506a251b636e98d84c30012b7d4fe}{pvPUKCLParam}->P.PUKCL\_SelfTest.u4CheckNum2 != 0x25C8D64F)
82       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
83 
84    \textcolor{comment}{//Successful initialization}
85    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
86 \}
\end{DoxyCode}
