\hypertarget{pkcs5_8c}{}\section{cyclone\+\_\+crypto/kdf/pkcs5.c File Reference}
\label{pkcs5_8c}\index{cyclone\+\_\+crypto/kdf/pkcs5.\+c@{cyclone\+\_\+crypto/kdf/pkcs5.\+c}}


P\+K\+CS \#5 (Password-\/\+Based Cryptography Standard)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}kdf/pkcs5.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mac/hmac.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pkcs5_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs5_8c_a3327b0b0aa8771dcaf799035a77c9014}{pbkdf1} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t p\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, size\+\_\+t s\+Len, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$dk, size\+\_\+t dk\+Len)
\begin{DoxyCompactList}\small\item\em P\+B\+K\+D\+F1 key derivation function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs5_8c_a30d96e01765a8a1815fb7f3ad7f8d8f9}{pbkdf2} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t p\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, size\+\_\+t s\+Len, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$dk, size\+\_\+t dk\+Len)
\begin{DoxyCompactList}\small\item\em P\+B\+K\+D\+F2 key derivation function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{pkcs5_8c_a5cb9816f71280dbbb305fa509f6a4200}{P\+K\+C\+S5\+\_\+\+O\+ID} \mbox{[}8\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x05\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{pkcs5_8c_af185dcc905d5699c4907ed56d4764b53}{P\+B\+K\+D\+F2\+\_\+\+O\+ID} \mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x05, 0x0\+C\}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
P\+K\+CS \#5 (Password-\/\+Based Cryptography Standard) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{pkcs5_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{pkcs5_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{pkcs5.\+c@{pkcs5.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!pkcs5.\+c@{pkcs5.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file pkcs5.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{pkcs5_8c_a3327b0b0aa8771dcaf799035a77c9014}\label{pkcs5_8c_a3327b0b0aa8771dcaf799035a77c9014}} 
\index{pkcs5.\+c@{pkcs5.\+c}!pbkdf1@{pbkdf1}}
\index{pbkdf1@{pbkdf1}!pkcs5.\+c@{pkcs5.\+c}}
\subsubsection{\texorpdfstring{pbkdf1()}{pbkdf1()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pbkdf1 (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t}]{p\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{s,  }\item[{size\+\_\+t}]{s\+Len,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{c,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{dk,  }\item[{size\+\_\+t}]{dk\+Len }\end{DoxyParamCaption})}



P\+B\+K\+D\+F1 key derivation function. 

P\+B\+K\+D\+F1 applies a hash function, which shall be M\+D2, M\+D5 or S\+H\+A-\/1, to derive keys. The length of the derived key is bounded by the length of the hash function output, which is 16 octets for M\+D2 and M\+D5 and 20 octets for S\+H\+A-\/1


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Underlying hash function (M\+D2, M\+D5 or S\+H\+A-\/1) \\
\hline
\mbox{\tt in}  & {\em p} & Password, an octet string \\
\hline
\mbox{\tt in}  & {\em p\+Len} & Length in octets of password \\
\hline
\mbox{\tt in}  & {\em s} & Salt, an octet string \\
\hline
\mbox{\tt in}  & {\em s\+Len} & Length in octets of salt \\
\hline
\mbox{\tt in}  & {\em c} & Iteration count \\
\hline
\mbox{\tt out}  & {\em dk} & Derived key \\
\hline
\mbox{\tt in}  & {\em dk\+Len} & Intended length in octets of the derived key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 66 of file pkcs5.\+c.


\begin{DoxyCode}
68 \{
69    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
70    \hyperlink{structHashContext}{HashContext} *hashContext;
71    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t}[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
72 
73    \textcolor{comment}{//Check parameters}
74    \textcolor{keywordflow}{if}(hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || dk == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
75       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
76 
77    \textcolor{comment}{//The iteration count must be a positive integer}
78    \textcolor{keywordflow}{if}(\hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} < 1)
79       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
80 
81    \textcolor{comment}{//Check the intended length of the derived key}
82    \textcolor{keywordflow}{if}(dkLen > hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize})
83       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
84 
85    \textcolor{comment}{//Allocate a memory buffer to hold the hash context}
86    hashContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(hash->\hyperlink{structHashAlgo_ad087845190aa4163d8339cacd07fec3e}{contextSize});
87    \textcolor{comment}{//Failed to allocate memory?}
88    \textcolor{keywordflow}{if}(hashContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
89       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
90 
91    \textcolor{comment}{//Apply the hash function to the concatenation of P and S}
92    hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
93    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, pLen);
94    hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}, sLen);
95    hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, t);
96 
97    \textcolor{comment}{//Iterate as many times as required}
98    \textcolor{keywordflow}{for}(i = 1; i < \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}; i++)
99    \{
100       \textcolor{comment}{//Apply the hash function to T(i - 1)}
101       hash->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
102       hash->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, t, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
103       hash->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, t);
104    \}
105 
106    \textcolor{comment}{//Output the derived key DK}
107    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(dk, t, dkLen);
108 
109    \textcolor{comment}{//Free previously allocated memory}
110    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hashContext);
111 
112    \textcolor{comment}{//Successful processing}
113    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
114 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs5_8c_a30d96e01765a8a1815fb7f3ad7f8d8f9}\label{pkcs5_8c_a30d96e01765a8a1815fb7f3ad7f8d8f9}} 
\index{pkcs5.\+c@{pkcs5.\+c}!pbkdf2@{pbkdf2}}
\index{pbkdf2@{pbkdf2}!pkcs5.\+c@{pkcs5.\+c}}
\subsubsection{\texorpdfstring{pbkdf2()}{pbkdf2()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pbkdf2 (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t}]{p\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{s,  }\item[{size\+\_\+t}]{s\+Len,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{c,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{dk,  }\item[{size\+\_\+t}]{dk\+Len }\end{DoxyParamCaption})}



P\+B\+K\+D\+F2 key derivation function. 

P\+B\+K\+D\+F2 applies a pseudorandom function to derive keys. The length of the derived key is essentially unbounded


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Hash algorithm used by the underlying P\+RF \\
\hline
\mbox{\tt in}  & {\em p} & Password, an octet string \\
\hline
\mbox{\tt in}  & {\em p\+Len} & Length in octets of password \\
\hline
\mbox{\tt in}  & {\em s} & Salt, an octet string \\
\hline
\mbox{\tt in}  & {\em s\+Len} & Length in octets of salt \\
\hline
\mbox{\tt in}  & {\em c} & Iteration count \\
\hline
\mbox{\tt out}  & {\em dk} & Derived key \\
\hline
\mbox{\tt in}  & {\em dk\+Len} & Intended length in octets of the derived key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 134 of file pkcs5.\+c.


\begin{DoxyCode}
136 \{
137    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
138    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
139    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
140    \hyperlink{structHmacContext}{HmacContext} *hashContext;
141    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[4];
142    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t}[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
143    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} u[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
144 
145    \textcolor{comment}{//Check parameters}
146    \textcolor{keywordflow}{if}(hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || dk == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
147       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
148 
149    \textcolor{comment}{//The iteration count must be a positive integer}
150    \textcolor{keywordflow}{if}(\hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} < 1)
151       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
152 
153    \textcolor{comment}{//Allocate a memory buffer to hold the HMAC context}
154    hashContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(\textcolor{keyword}{sizeof}(\hyperlink{structHmacContext}{HmacContext}));
155    \textcolor{comment}{//Failed to allocate memory?}
156    \textcolor{keywordflow}{if}(hashContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
157       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
158 
159    \textcolor{comment}{//For each block of the derived key apply the function F}
160    \textcolor{keywordflow}{for}(i = 1; dkLen > 0; i++)
161    \{
162       \textcolor{comment}{//Calculate the 4-octet encoding of the integer i (MSB first)}
163       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(i, a);
164 
165       \textcolor{comment}{//Compute U1 = PRF(P, S || INT(i))}
166       \hyperlink{hmac_8c_ac4ecc520cae02c1b9bbb3651758a703e}{hmacInit}(hashContext, hash, \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, pLen);
167       \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hashContext, \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}, sLen);
168       \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hashContext, a, 4);
169       \hyperlink{hmac_8c_a387906ffc55755df380361c43ce0bd6a}{hmacFinal}(hashContext, u);
170 
171       \textcolor{comment}{//Save the resulting HMAC value}
172       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(t, u, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
173 
174       \textcolor{comment}{//Iterate as many times as required}
175       \textcolor{keywordflow}{for}(j = 1; j < \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}; j++)
176       \{
177          \textcolor{comment}{//Compute U(j) = PRF(P, U(j-1))}
178          \hyperlink{hmac_8c_ac4ecc520cae02c1b9bbb3651758a703e}{hmacInit}(hashContext, hash, \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, pLen);
179          \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hashContext, u, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
180          \hyperlink{hmac_8c_a387906ffc55755df380361c43ce0bd6a}{hmacFinal}(hashContext, u);
181 
182          \textcolor{comment}{//Compute T = U(1) xor U(2) xor ... xor U(c)}
183          \textcolor{keywordflow}{for}(k = 0; k < hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; k++)
184          \{
185             t[\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}] ^= u[\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}];
186          \}
187       \}
188 
189       \textcolor{comment}{//Number of octets in the current block}
190       k = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(dkLen, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
191       \textcolor{comment}{//Save the resulting block}
192       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(dk, t, k);
193 
194       \textcolor{comment}{//Point to the next block}
195       dk += \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
196       dkLen -= \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
197    \}
198 
199    \textcolor{comment}{//Free previously allocated memory}
200    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hashContext);
201 
202    \textcolor{comment}{//Successful processing}
203    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
204 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{pkcs5_8c_af185dcc905d5699c4907ed56d4764b53}\label{pkcs5_8c_af185dcc905d5699c4907ed56d4764b53}} 
\index{pkcs5.\+c@{pkcs5.\+c}!P\+B\+K\+D\+F2\+\_\+\+O\+ID@{P\+B\+K\+D\+F2\+\_\+\+O\+ID}}
\index{P\+B\+K\+D\+F2\+\_\+\+O\+ID@{P\+B\+K\+D\+F2\+\_\+\+O\+ID}!pkcs5.\+c@{pkcs5.\+c}}
\subsubsection{\texorpdfstring{P\+B\+K\+D\+F2\+\_\+\+O\+ID}{PBKDF2\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} P\+B\+K\+D\+F2\+\_\+\+O\+ID\mbox{[}9\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x05, 0x0\+C\}}



Definition at line 45 of file pkcs5.\+c.

\mbox{\Hypertarget{pkcs5_8c_a5cb9816f71280dbbb305fa509f6a4200}\label{pkcs5_8c_a5cb9816f71280dbbb305fa509f6a4200}} 
\index{pkcs5.\+c@{pkcs5.\+c}!P\+K\+C\+S5\+\_\+\+O\+ID@{P\+K\+C\+S5\+\_\+\+O\+ID}}
\index{P\+K\+C\+S5\+\_\+\+O\+ID@{P\+K\+C\+S5\+\_\+\+O\+ID}!pkcs5.\+c@{pkcs5.\+c}}
\subsubsection{\texorpdfstring{P\+K\+C\+S5\+\_\+\+O\+ID}{PKCS5\_OID}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} P\+K\+C\+S5\+\_\+\+O\+ID\mbox{[}8\mbox{]} = \{0x2\+A, 0x86, 0x48, 0x86, 0x\+F7, 0x0\+D, 0x01, 0x05\}}



Definition at line 43 of file pkcs5.\+c.

