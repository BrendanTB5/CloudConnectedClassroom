\hypertarget{tls__client__extensions_8h}{}\section{cyclone\+\_\+ssl/tls\+\_\+client\+\_\+extensions.h File Reference}
\label{tls__client__extensions_8h}\index{cyclone\+\_\+ssl/tls\+\_\+client\+\_\+extensions.\+h@{cyclone\+\_\+ssl/tls\+\_\+client\+\_\+extensions.\+h}}


Formatting and parsing of extensions (T\+LS client)  


{\ttfamily \#include \char`\"{}tls.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_ad9bb10c56b22f756ab454fd63dcba4d7}{tls\+Format\+Client\+Supported\+Versions\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Supported\+Versions extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a4d9277592681463451ceea0efdc26340}{tls\+Format\+Client\+Sni\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format S\+NI extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a05af8e4ee90e7cc25e14a80ea240f185}{tls\+Format\+Client\+Max\+Frag\+Len\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Max\+Fragment\+Length extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a7e9320e20ccda8455635905cb92f6d5f}{tls\+Format\+Client\+Record\+Size\+Limit\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Record\+Size\+Limit extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a61e515de2ffab301ccd6db65f8b23388}{tls\+Format\+Supported\+Groups\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} cipher\+Suite\+Types, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Supported\+Groups extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_ac5346af8cde411297e32136ae676cf93}{tls\+Format\+Client\+Ec\+Point\+Formats\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} cipher\+Suite\+Types, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Ec\+Point\+Formats extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a39698d5880238026defe6cb810f8bf73}{tls\+Format\+Client\+Alpn\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format A\+L\+PN extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_afd8592e5df48c67f0a3fdf1052a05403}{tls\+Format\+Client\+Cert\+Type\+List\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Client\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_abe810d75943c4423f122d87d30119c5c}{tls\+Format\+Server\+Cert\+Type\+List\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Server\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a896d082ae1376761ea11808bc4c127b0}{tls\+Format\+Client\+Ems\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Extended\+Master\+Secret extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_ac31c814e50949f47e7ca07502229fb21}{tls\+Format\+Client\+Renego\+Info\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Renegotiation\+Info extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_ad3ac65b6ad2b19ac1cf2849669926423}{tls\+Format\+Client\+Hello\+Padding\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, size\+\_\+t client\+Hello\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Client\+Hello Padding extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_abb7e3afa03320f12445a027bcec125ea}{tls\+Parse\+Server\+Sni\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{tls_8h_a15e86cf6f06b8178e14735d6e4c83cb1}{Tls\+Server\+Name\+List} $\ast$server\+Name\+List)
\begin{DoxyCompactList}\small\item\em Parse S\+NI extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a2e070756a890d030b3d44e52ca561cd1}{tls\+Parse\+Server\+Max\+Frag\+Len\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$max\+Frag\+Len)
\begin{DoxyCompactList}\small\item\em Parse Max\+Fragment\+Length extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a5585164093c76ef6fa5f2199dac4b98b}{tls\+Parse\+Server\+Record\+Size\+Limit\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$record\+Size\+Limit)
\begin{DoxyCompactList}\small\item\em Parse Record\+Size\+Limit extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a111f4eb896f7a1e7b81c26949926d163}{tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{tls_8h_a56cd71342730891de1eb587381a26731}{Tls\+Ec\+Point\+Format\+List} $\ast$ec\+Point\+Format\+List)
\begin{DoxyCompactList}\small\item\em Parse Ec\+Point\+Formats extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a48aa76764f8864824dbb375c3ea3b765}{tls\+Parse\+Server\+Alpn\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{tls_8h_a437df336a6795a38ec9bcfb7c2ab4b2f}{Tls\+Protocol\+Name\+List} $\ast$protocol\+Name\+List)
\begin{DoxyCompactList}\small\item\em Parse A\+L\+PN extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_ad002dcf307670ef4d0692506650c9567}{tls\+Parse\+Client\+Cert\+Type\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$client\+Cert\+Type)
\begin{DoxyCompactList}\small\item\em Parse Client\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a4fb6de89c85a0a0e3d7e42e55d6f0fe6}{tls\+Parse\+Server\+Cert\+Type\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$server\+Cert\+Type)
\begin{DoxyCompactList}\small\item\em Parse Server\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_a96534351b950c17505b01e28719d40b7}{tls\+Parse\+Server\+Ems\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$extended\+Master\+Secret)
\begin{DoxyCompactList}\small\item\em Parse Extended\+Master\+Secret extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__client__extensions_8h_ab1f51cd1e13b9aa71e4e5e9bee4c6910}{tls\+Parse\+Server\+Renego\+Info\+Extension} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{structTlsHelloExtensions}{Tls\+Hello\+Extensions} $\ast$\hyperlink{tls13__misc_8h_a7b8cc84c920376c616d85d575080d28e}{extensions})
\begin{DoxyCompactList}\small\item\em Parse Renegotiation\+Info extension. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Formatting and parsing of extensions (T\+LS client) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+S\+SL Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{tls__client__extensions_8h_a39698d5880238026defe6cb810f8bf73}\label{tls__client__extensions_8h_a39698d5880238026defe6cb810f8bf73}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Alpn\+Extension@{tls\+Format\+Client\+Alpn\+Extension}}
\index{tls\+Format\+Client\+Alpn\+Extension@{tls\+Format\+Client\+Alpn\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Alpn\+Extension()}{tlsFormatClientAlpnExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Alpn\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format A\+L\+PN extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the A\+L\+PN extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 540 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
542 \{
543    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
544 
545 \textcolor{preprocessor}{#if (TLS\_ALPN\_SUPPORT == ENABLED)}
546    \textcolor{comment}{//The ALPN extension contains the list of protocols advertised by the}
547    \textcolor{comment}{//client, in descending order of preference}
548    \textcolor{keywordflow}{if}(context->protocolList != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
549    \{
550       \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
551       \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
552       \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
553       \hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName} *protocolName;
554       \hyperlink{tls_8h_a437df336a6795a38ec9bcfb7c2ab4b2f}{TlsProtocolNameList} *protocolNameList;
555 
556       \textcolor{comment}{//Add ALPN (Application-Layer Protocol Negotiation) extension}
557       extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
558       \textcolor{comment}{//Type of the extension}
559       extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7acd549b6d27b86af438c5da5b481277a7}{TLS\_EXT\_ALPN});
560 
561       \textcolor{comment}{//Point to the list of protocol names}
562       protocolNameList = (\hyperlink{tls_8h_a437df336a6795a38ec9bcfb7c2ab4b2f}{TlsProtocolNameList} *) extension->value;
563 
564       \textcolor{comment}{//Move back to the beginning of the list}
565       i = 0;
566       j = 0;
567       n = 0;
568 
569       \textcolor{comment}{//Parse the list of supported protocols}
570       \textcolor{keywordflow}{do}
571       \{
572          \textcolor{comment}{//Delimiter character found?}
573          \textcolor{keywordflow}{if}(context->protocolList[i] == \textcolor{charliteral}{','} || context->protocolList[i] == \textcolor{charliteral}{'\(\backslash\)0'})
574          \{
575             \textcolor{comment}{//Discard empty tokens}
576             \textcolor{keywordflow}{if}((i - j) > 0)
577             \{
578                \textcolor{comment}{//Point to the protocol name}
579                protocolName = (\hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName} *) (protocolNameList->value + n);
580 
581                \textcolor{comment}{//Fill in the length field}
582                protocolName->length = i - j;
583                \textcolor{comment}{//Copy protocol name}
584                memcpy(protocolName->value, context->protocolList + j, i - j);
585 
586                \textcolor{comment}{//Adjust the length of the list}
587                n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName}) + i - j;
588             \}
589 
590             \textcolor{comment}{//Move to the next token}
591             j = i + 1;
592          \}
593 
594          \textcolor{comment}{//Loop until the NULL character is reached}
595       \} \textcolor{keywordflow}{while}(context->protocolList[i++] != \textcolor{charliteral}{'\(\backslash\)0'});
596 
597       \textcolor{comment}{//Fix the length of the list}
598       protocolNameList->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
599 
600       \textcolor{comment}{//Consider the 2-byte length field that precedes the list}
601       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a437df336a6795a38ec9bcfb7c2ab4b2f}{TlsProtocolNameList});
602       \textcolor{comment}{//Fix the length of the extension}
603       extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
604 
605       \textcolor{comment}{//Compute the length, in bytes, of the ALPN extension}
606       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
607    \}
608 \textcolor{preprocessor}{#endif}
609 
610    \textcolor{comment}{//Total number of bytes that have been written}
611    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
612 
613    \textcolor{comment}{//Successful processing}
614    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
615 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_afd8592e5df48c67f0a3fdf1052a05403}\label{tls__client__extensions_8h_afd8592e5df48c67f0a3fdf1052a05403}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Cert\+Type\+List\+Extension@{tls\+Format\+Client\+Cert\+Type\+List\+Extension}}
\index{tls\+Format\+Client\+Cert\+Type\+List\+Extension@{tls\+Format\+Client\+Cert\+Type\+List\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Cert\+Type\+List\+Extension()}{tlsFormatClientCertTypeListExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Cert\+Type\+List\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Client\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Client\+Cert\+Type extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 626 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
628 \{
629    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
630 
631 \textcolor{preprocessor}{#if (TLS\_RAW\_PUBLIC\_KEY\_SUPPORT == ENABLED)}
632    \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
633    \hyperlink{tls_8h_aef3d0205a40e8c95b8d7019053d3e7ca}{TlsCertTypeList} *clientCertTypeList;
634 
635    \textcolor{comment}{//Add the ClientCertType extension}
636    extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
637    \textcolor{comment}{//Type of the extension}
638    extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a643926386cd2016b4832014c859b6e75}{TLS\_EXT\_CLIENT\_CERT\_TYPE});
639 
640    \textcolor{comment}{//The ClientCertType extension in the ClientHello indicates the certificate}
641    \textcolor{comment}{//types the client is able to provide to the server, when requested using a}
642    \textcolor{comment}{//CertificateRequest message}
643    clientCertTypeList = (\hyperlink{tls_8h_aef3d0205a40e8c95b8d7019053d3e7ca}{TlsCertTypeList} *) extension->value;
644 
645    \textcolor{comment}{//The ClientCertType extension carries a list of supported certificate}
646    \textcolor{comment}{//types, sorted by client preference}
647    n = 0;
648 
649    \textcolor{comment}{//Raw public key type}
650    clientCertTypeList->value[n++] = \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0a598a87140d01a36216289f5dfb6c0f35}{TLS\_CERT\_FORMAT\_RAW\_PUBLIC\_KEY};
651    \textcolor{comment}{//X.509 certificate type}
652    clientCertTypeList->value[n++] = \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0aa099e08287ecdea1676dce7f30d35270}{TLS\_CERT\_FORMAT\_X509};
653 
654    \textcolor{comment}{//Fix the length of the list}
655    clientCertTypeList->length = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
656 
657    \textcolor{comment}{//Consider the length field that precedes the list}
658    n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_aef3d0205a40e8c95b8d7019053d3e7ca}{TlsCertTypeList});
659    \textcolor{comment}{//Fix the length of the extension}
660    extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
661 
662    \textcolor{comment}{//Compute the length, in bytes, of the ClientCertType extension}
663    n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
664 \textcolor{preprocessor}{#endif}
665 
666    \textcolor{comment}{//Total number of bytes that have been written}
667    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
668 
669    \textcolor{comment}{//Successful processing}
670    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
671 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_ac5346af8cde411297e32136ae676cf93}\label{tls__client__extensions_8h_ac5346af8cde411297e32136ae676cf93}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Ec\+Point\+Formats\+Extension@{tls\+Format\+Client\+Ec\+Point\+Formats\+Extension}}
\index{tls\+Format\+Client\+Ec\+Point\+Formats\+Extension@{tls\+Format\+Client\+Ec\+Point\+Formats\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Ec\+Point\+Formats\+Extension()}{tlsFormatClientEcPointFormatsExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Ec\+Point\+Formats\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{cipher\+Suite\+Types,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Ec\+Point\+Formats extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em cipher\+Suite\+Types} & Types of cipher suites proposed by the client \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Ec\+Point\+Formats extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 478 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
480 \{
481    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
482 
483 \textcolor{preprocessor}{#if (TLS\_MAX\_VERSION >= SSL\_VERSION\_3\_0 && TLS\_MIN\_VERSION <= TLS\_VERSION\_1\_2)}
484    \textcolor{comment}{//TLS 1.3 has removed point format negotiation in favor of a single point}
485    \textcolor{comment}{//format for each curve (refer to RFC 8446, section 1.2)}
486    \textcolor{keywordflow}{if}(context->versionMin <= \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2})
487    \{
488 \textcolor{preprocessor}{#if (TLS\_ECDH\_ANON\_KE\_SUPPORT == ENABLED || TLS\_ECDHE\_RSA\_KE\_SUPPORT == ENABLED || \(\backslash\)}
489 \textcolor{preprocessor}{   TLS\_ECDHE\_ECDSA\_KE\_SUPPORT == ENABLED || TLS\_ECDHE\_PSK\_KE\_SUPPORT == ENABLED)}
490       \textcolor{comment}{//A client that proposes ECC cipher suites in its ClientHello message}
491       \textcolor{comment}{//should send the EcPointFormats extension}
492       \textcolor{keywordflow}{if}((cipherSuiteTypes & \hyperlink{tls__cipher__suites_8h_aa19934da0d53bda533624f13ba98303ba876aff9a6f283b9cc44eeb7c668cad43}{TLS\_CIPHER\_SUITE\_TYPE\_ECC}) != 0)
493       \{
494          \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
495          \hyperlink{tls_8h_a56cd71342730891de1eb587381a26731}{TlsEcPointFormatList} *ecPointFormatList;
496 
497          \textcolor{comment}{//Add the EcPointFormats extension}
498          extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
499          \textcolor{comment}{//Type of the extension}
500          extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a9a3f8f880b4549fc336d1938d3ac54c2}{TLS\_EXT\_EC\_POINT\_FORMATS});
501 
502          \textcolor{comment}{//Point to the list of supported EC point formats}
503          ecPointFormatList = (\hyperlink{tls_8h_a56cd71342730891de1eb587381a26731}{TlsEcPointFormatList} *) extension->value;
504          \textcolor{comment}{//Items in the list are ordered according to client's preferences}
505          n = 0;
506 
507          \textcolor{comment}{//The client can parse only the uncompressed point format...}
508          ecPointFormatList->value[n++] = \hyperlink{tls_8h_a45b8a57398a9bd960e3f3186a7d3cd38a149b16635a32aa8ed87166485790f152}{TLS\_EC\_POINT\_FORMAT\_UNCOMPRESSED};
509          \textcolor{comment}{//Fix the length of the list}
510          ecPointFormatList->length = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
511 
512          \textcolor{comment}{//Consider the length field that precedes the list}
513          n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a56cd71342730891de1eb587381a26731}{TlsEcPointFormatList});
514          \textcolor{comment}{//Fix the length of the extension}
515          extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
516 
517          \textcolor{comment}{//Compute the length, in bytes, of the EcPointFormats extension}
518          n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
519       \}
520 \textcolor{preprocessor}{#endif}
521    \}
522 \textcolor{preprocessor}{#endif}
523 
524    \textcolor{comment}{//Total number of bytes that have been written}
525    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
526 
527    \textcolor{comment}{//Successful processing}
528    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
529 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a896d082ae1376761ea11808bc4c127b0}\label{tls__client__extensions_8h_a896d082ae1376761ea11808bc4c127b0}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Ems\+Extension@{tls\+Format\+Client\+Ems\+Extension}}
\index{tls\+Format\+Client\+Ems\+Extension@{tls\+Format\+Client\+Ems\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Ems\+Extension()}{tlsFormatClientEmsExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Ems\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Extended\+Master\+Secret extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Extended\+Master\+Secret extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 742 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
744 \{
745    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
746 
747 \textcolor{preprocessor}{#if (TLS\_MAX\_VERSION >= TLS\_VERSION\_1\_0 && TLS\_MIN\_VERSION <= TLS\_VERSION\_1\_2)}
748    \textcolor{comment}{//Implementations which support both TLS 1.3 and earlier versions should}
749    \textcolor{comment}{//indicate the use of the ExtendedMasterSecret extension whenever TLS 1.3}
750    \textcolor{comment}{//is used (refer to RFC 8446, appendix D)}
751    \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_adcc8f4321c8f3b847fbea16ca0ff337e}{TLS\_VERSION\_1\_0} &&
752       context->versionMin <= \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2})
753    \{
754 \textcolor{preprocessor}{#if (TLS\_EXT\_MASTER\_SECRET\_SUPPORT == ENABLED)}
755       \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
756 
757       \textcolor{comment}{//Add the ExtendedMasterSecret extension}
758       extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
759       \textcolor{comment}{//Type of the extension}
760       extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7af66b97b46e6480db2e6b87ab700de152}{TLS\_EXT\_EXTENDED\_MASTER\_SECRET});
761 
762       \textcolor{comment}{//The extension data field of this extension is empty}
763       extension->length = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(0);
764 
765       \textcolor{comment}{//Compute the length, in bytes, of the ExtendedMasterSecret extension}
766       n = \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
767 \textcolor{preprocessor}{#endif}
768    \}
769 \textcolor{preprocessor}{#endif}
770 
771    \textcolor{comment}{//Total number of bytes that have been written}
772    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
773 
774    \textcolor{comment}{//Successful processing}
775    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
776 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_ad3ac65b6ad2b19ac1cf2849669926423}\label{tls__client__extensions_8h_ad3ac65b6ad2b19ac1cf2849669926423}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Hello\+Padding\+Extension@{tls\+Format\+Client\+Hello\+Padding\+Extension}}
\index{tls\+Format\+Client\+Hello\+Padding\+Extension@{tls\+Format\+Client\+Hello\+Padding\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Hello\+Padding\+Extension()}{tlsFormatClientHelloPaddingExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Hello\+Padding\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{size\+\_\+t}]{client\+Hello\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Client\+Hello Padding extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em client\+Hello\+Len} & Actual length of the Client\+Hello message \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Client\+Hello Padding extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 855 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
857 \{
858    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
859 
860 \textcolor{preprocessor}{#if (TLS\_CLIENT\_HELLO\_PADDING\_SUPPORT == ENABLED)}
861    \textcolor{comment}{//TLS protocol?}
862    \textcolor{keywordflow}{if}(context->transportProtocol == \hyperlink{tls_8h_a25cb7e3df9004160eb21eac9377dc89fa2fbbbd6c318570d570225144f3c6c244}{TLS\_TRANSPORT\_PROTOCOL\_STREAM})
863    \{
864       \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
865 
866       \textcolor{comment}{//After building a ClientHello as normal, the client can add four bytes}
867       \textcolor{comment}{//to the length and test whether the resulting length falls into the}
868       \textcolor{comment}{//range 256 to 511 (refer to RFC 7685, section 4)}
869       clientHelloLen += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_add338b5a3ca9dad219beec4da8055ed3}{TlsHandshake});
870 
871       \textcolor{comment}{//Check the resulting length}
872       \textcolor{keywordflow}{if}(clientHelloLen >= 256 && clientHelloLen < 512)
873       \{
874          \textcolor{comment}{//The ClientHello Padding extension will be added in order to push}
875          \textcolor{comment}{//the length to (at least) 512 bytes}
876          extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
877 
878          \textcolor{comment}{//Type of the extension}
879          extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a0aa244d50e988eb9af40705980dddbe1}{TLS\_EXT\_PADDING});
880 
881          \textcolor{comment}{//Calculate the length of the padding}
882          \textcolor{keywordflow}{if}((clientHelloLen + \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension})) < 512)
883             n = 512 - \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension}) - clientHelloLen;
884          \textcolor{keywordflow}{else}
885             n = 0;
886 
887          \textcolor{comment}{//The padding string consists of an arbitrary number of zero bytes}
888          memset(extension->value, 0, n);
889          \textcolor{comment}{//Set the length of the extension}
890          extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
891 
892          \textcolor{comment}{//Compute the length, in bytes, of the padding extension}
893          n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
894       \}
895    \}
896 \textcolor{preprocessor}{#endif}
897 
898    \textcolor{comment}{//Total number of bytes that have been written}
899    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
900 
901    \textcolor{comment}{//Successful processing}
902    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
903 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a05af8e4ee90e7cc25e14a80ea240f185}\label{tls__client__extensions_8h_a05af8e4ee90e7cc25e14a80ea240f185}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Max\+Frag\+Len\+Extension@{tls\+Format\+Client\+Max\+Frag\+Len\+Extension}}
\index{tls\+Format\+Client\+Max\+Frag\+Len\+Extension@{tls\+Format\+Client\+Max\+Frag\+Len\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Max\+Frag\+Len\+Extension()}{tlsFormatClientMaxFragLenExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Max\+Frag\+Len\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Max\+Fragment\+Length extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Max\+Fragment\+Length extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 251 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
253 \{
254    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
255 
256 \textcolor{preprocessor}{#if (TLS\_MAX\_FRAG\_LEN\_SUPPORT == ENABLED)}
257    \textcolor{comment}{//In order to negotiate smaller maximum fragment lengths, clients may}
258    \textcolor{comment}{//include a MaxFragmentLength extension}
259    \textcolor{keywordflow}{if}(context->maxFragLen == 512 || context->maxFragLen == 1024 ||
260       context->maxFragLen == 2048 || context->maxFragLen == 4096)
261    \{
262       \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
263 
264       \textcolor{comment}{//Add the MaxFragmentLength extension}
265       extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
266       \textcolor{comment}{//Type of the extension}
267       extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a4a4ee70b35190ddeacec1a6d68286dab}{TLS\_EXT\_MAX\_FRAGMENT\_LENGTH});
268 
269       \textcolor{comment}{//Set the maximum fragment length}
270       \textcolor{keywordflow}{switch}(context->maxFragLen)
271       \{
272       \textcolor{keywordflow}{case} 512:
273          extension->value[0] = \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63a4c1a1521181c432d51d61dc4f295d027}{TLS\_MAX\_FRAGMENT\_LENGTH\_512};
274          \textcolor{keywordflow}{break};
275       \textcolor{keywordflow}{case} 1024:
276          extension->value[0] = \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63aeee4f23ba8be12a29158044f629a04cf}{TLS\_MAX\_FRAGMENT\_LENGTH\_1024};
277          \textcolor{keywordflow}{break};
278       \textcolor{keywordflow}{case} 2048:
279          extension->value[0] = \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63ad6ba9b8c7be1f57b904f4e1304295fad}{TLS\_MAX\_FRAGMENT\_LENGTH\_2048};
280          \textcolor{keywordflow}{break};
281       \textcolor{keywordflow}{default}:
282          extension->value[0] = \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63ac32ed0270e2b99db48fe7835eb1525bc}{TLS\_MAX\_FRAGMENT\_LENGTH\_4096};
283          \textcolor{keywordflow}{break};
284       \}
285 
286       \textcolor{comment}{//The extension data field contains a single byte}
287       n = \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
288       \textcolor{comment}{//Fix the length of the extension}
289       extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
290 
291       \textcolor{comment}{//Compute the length, in bytes, of the MaxFragmentLength extension}
292       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
293    \}
294 \textcolor{preprocessor}{#endif}
295 
296    \textcolor{comment}{//Total number of bytes that have been written}
297    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
298 
299    \textcolor{comment}{//Successful processing}
300    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
301 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a7e9320e20ccda8455635905cb92f6d5f}\label{tls__client__extensions_8h_a7e9320e20ccda8455635905cb92f6d5f}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Record\+Size\+Limit\+Extension@{tls\+Format\+Client\+Record\+Size\+Limit\+Extension}}
\index{tls\+Format\+Client\+Record\+Size\+Limit\+Extension@{tls\+Format\+Client\+Record\+Size\+Limit\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Record\+Size\+Limit\+Extension()}{tlsFormatClientRecordSizeLimitExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Record\+Size\+Limit\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Record\+Size\+Limit extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Record\+Size\+Limit extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 312 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
314 \{
315    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
316 
317 \textcolor{preprocessor}{#if (TLS\_RECORD\_SIZE\_LIMIT\_SUPPORT == ENABLED)}
318    \textcolor{keywordtype}{size\_t} recordSizeLimit;
319    \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
320 
321    \textcolor{comment}{//Add the RecordSizeLimit extension}
322    extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
323    \textcolor{comment}{//Type of the extension}
324    extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7aa248475139394e15aa9a3fab1feabc83}{TLS\_EXT\_RECORD\_SIZE\_LIMIT});
325 
326    \textcolor{comment}{//An endpoint must not send a value higher than the protocol-defined}
327    \textcolor{comment}{//maximum record size (refer to RFC 8449, section 4)}
328    recordSizeLimit = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(context->rxBufferMaxLen, \hyperlink{tls_8h_a87485283e0c2c0a9b1b3e5ef9df52975}{TLS\_MAX\_RECORD\_LENGTH});
329 
330    \textcolor{comment}{//Check whether TLS 1.3 is supported}
331    \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_ab44dc642afbfbd72926ab1f94634cd4d}{TLS\_VERSION\_1\_3} &&
332       context->transportProtocol == \hyperlink{tls_8h_a25cb7e3df9004160eb21eac9377dc89fa2fbbbd6c318570d570225144f3c6c244}{TLS\_TRANSPORT\_PROTOCOL\_STREAM})
333    \{
334       \textcolor{comment}{//The value includes the content type and padding added in TLS 1.3}
335       recordSizeLimit++;
336    \}
337 
338    \textcolor{comment}{//The value of RecordSizeLimit is the maximum size of record in octets}
339    \textcolor{comment}{//that the endpoint is willing to receive}
340    \hyperlink{cpu__endian_8h_a8e657bcdf3842380d2d0006859029240}{STORE16BE}(recordSizeLimit, extension->value);
341 
342    \textcolor{comment}{//The extension data field contains a 16-bit unsigned integer}
343    n = \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
344    \textcolor{comment}{//Fix the length of the extension}
345    extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
346 
347    \textcolor{comment}{//Compute the length, in bytes, of the RecordSizeLimit extension}
348    n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
349 \textcolor{preprocessor}{#endif}
350 
351    \textcolor{comment}{//Total number of bytes that have been written}
352    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
353 
354    \textcolor{comment}{//Successful processing}
355    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
356 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_ac31c814e50949f47e7ca07502229fb21}\label{tls__client__extensions_8h_ac31c814e50949f47e7ca07502229fb21}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Renego\+Info\+Extension@{tls\+Format\+Client\+Renego\+Info\+Extension}}
\index{tls\+Format\+Client\+Renego\+Info\+Extension@{tls\+Format\+Client\+Renego\+Info\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Renego\+Info\+Extension()}{tlsFormatClientRenegoInfoExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Renego\+Info\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Renegotiation\+Info extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Renegotiation\+Info extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 787 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
789 \{
790    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
791 
792 \textcolor{preprocessor}{#if (TLS\_MAX\_VERSION >= SSL\_VERSION\_3\_0 && TLS\_MIN\_VERSION <= TLS\_VERSION\_1\_2)}
793    \textcolor{comment}{//TLS 1.3 forbids renegotiation}
794    \textcolor{keywordflow}{if}(context->versionMin <= \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2})
795    \{
796 \textcolor{preprocessor}{#if (TLS\_SECURE\_RENEGOTIATION\_SUPPORT == ENABLED)}
797       \textcolor{comment}{//Check whether secure renegotiation is enabled}
798       \textcolor{keywordflow}{if}(context->secureRenegoEnabled)
799       \{
800          \textcolor{comment}{//During secure renegotiation, the client must include the}
801          \textcolor{comment}{//RenegotiationInfo extension containing the saved client\_verify\_data}
802          \textcolor{keywordflow}{if}(context->secureRenegoFlag)
803          \{
804             \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
805             \hyperlink{tls_8h_a91a1f867efbc9e94610e512a667e3e16}{TlsRenegoInfo} *renegoInfo;
806 
807             \textcolor{comment}{//Determine the length of the verify data}
808             n = context->clientVerifyDataLen;
809 
810             \textcolor{comment}{//Add the RenegotiationInfo extension}
811             extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
812             \textcolor{comment}{//Type of the extension}
813             extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a10b93b38aef9aea795816607063e5d98}{TLS\_EXT\_RENEGOTIATION\_INFO});
814 
815             \textcolor{comment}{//Point to the renegotiated\_connection field}
816             renegoInfo = (\hyperlink{tls_8h_a91a1f867efbc9e94610e512a667e3e16}{TlsRenegoInfo} *) extension->value;
817             \textcolor{comment}{//Set the length of the verify data}
818             renegoInfo->length = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
819 
820             \textcolor{comment}{//Copy the verify data from the Finished message sent by the client}
821             \textcolor{comment}{//on the immediately previous handshake}
822             memcpy(renegoInfo->value, context->clientVerifyData, n);
823 
824             \textcolor{comment}{//Consider the length field that precedes the renegotiated\_connection}
825             \textcolor{comment}{//field}
826             n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a91a1f867efbc9e94610e512a667e3e16}{TlsRenegoInfo});
827             \textcolor{comment}{//Fix the length of the extension}
828             extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
829 
830             \textcolor{comment}{//Compute the length, in bytes, of the RenegotiationInfo extension}
831             n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
832          \}
833       \}
834 \textcolor{preprocessor}{#endif}
835    \}
836 \textcolor{preprocessor}{#endif}
837 
838    \textcolor{comment}{//Total number of bytes that have been written}
839    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
840 
841    \textcolor{comment}{//Successful processing}
842    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
843 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a4d9277592681463451ceea0efdc26340}\label{tls__client__extensions_8h_a4d9277592681463451ceea0efdc26340}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Sni\+Extension@{tls\+Format\+Client\+Sni\+Extension}}
\index{tls\+Format\+Client\+Sni\+Extension@{tls\+Format\+Client\+Sni\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Sni\+Extension()}{tlsFormatClientSniExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Sni\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format S\+NI extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Server\+Name extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 178 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
180 \{
181    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
182 
183 \textcolor{preprocessor}{#if (TLS\_SNI\_SUPPORT == ENABLED)}
184    \textcolor{comment}{//In order to provide the server name, clients may include a ServerName}
185    \textcolor{comment}{//extension}
186    \textcolor{keywordflow}{if}(context->serverName != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
187    \{
188       \textcolor{comment}{//Determine the length of the server name}
189       n = strlen(context->serverName);
190 
191       \textcolor{comment}{//The server name must be a valid DNS hostname}
192       \textcolor{keywordflow}{if}(\hyperlink{tls__misc_8c_a821d4cff18a6ac6efc5079ccba1836cc}{tlsCheckDnsHostname}(context->serverName, n))
193       \{
194          \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
195          \hyperlink{tls_8h_a15e86cf6f06b8178e14735d6e4c83cb1}{TlsServerNameList} *serverNameList;
196          \hyperlink{tls_8h_a6f611c0a8ca46d6a2d45dfac2c92b2fc}{TlsServerName} *serverName;
197 
198          \textcolor{comment}{//Add SNI (Server Name Indication) extension}
199          extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
200          \textcolor{comment}{//Type of the extension}
201          extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7ad7a6fff7cdad82f0dd2601d0f3d0cd27}{TLS\_EXT\_SERVER\_NAME});
202 
203          \textcolor{comment}{//Point to the list of server names}
204          serverNameList = (\hyperlink{tls_8h_a15e86cf6f06b8178e14735d6e4c83cb1}{TlsServerNameList} *) extension->value;
205          \textcolor{comment}{//In practice, current client implementations only send one name}
206          serverName = (\hyperlink{tls_8h_a6f611c0a8ca46d6a2d45dfac2c92b2fc}{TlsServerName} *) serverNameList->value;
207 
208          \textcolor{comment}{//Fill in the type and the length fields}
209          serverName->type = \hyperlink{tls_8h_a1096de9b487e6a6550bbca632604cea1a5c69aeb541b02e8236093fa37448dfa4}{TLS\_NAME\_TYPE\_HOSTNAME};
210          serverName->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
211          \textcolor{comment}{//Copy server name}
212          memcpy(serverName->hostname, context->serverName, n);
213 
214          \textcolor{comment}{//Compute the length, in byte, of the structure}
215          n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a6f611c0a8ca46d6a2d45dfac2c92b2fc}{TlsServerName});
216          \textcolor{comment}{//Fix the length of the list}
217          serverNameList->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
218 
219          \textcolor{comment}{//Consider the 2-byte length field that precedes the list}
220          n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a15e86cf6f06b8178e14735d6e4c83cb1}{TlsServerNameList});
221          \textcolor{comment}{//Fix the length of the extension}
222          extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
223 
224          \textcolor{comment}{//Compute the length, in bytes, of the ServerName extension}
225          n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
226       \}
227       \textcolor{keywordflow}{else}
228       \{
229          \textcolor{comment}{//The server name is not a valid DNS hostname}
230          n = 0;
231       \}
232    \}
233 \textcolor{preprocessor}{#endif}
234 
235    \textcolor{comment}{//Total number of bytes that have been written}
236    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
237 
238    \textcolor{comment}{//Successful processing}
239    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
240 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_ad9bb10c56b22f756ab454fd63dcba4d7}\label{tls__client__extensions_8h_ad9bb10c56b22f756ab454fd63dcba4d7}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Client\+Supported\+Versions\+Extension@{tls\+Format\+Client\+Supported\+Versions\+Extension}}
\index{tls\+Format\+Client\+Supported\+Versions\+Extension@{tls\+Format\+Client\+Supported\+Versions\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Client\+Supported\+Versions\+Extension()}{tlsFormatClientSupportedVersionsExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Client\+Supported\+Versions\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Supported\+Versions extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Supported\+Versions extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 84 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
86 \{
87    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
88 
89 \textcolor{preprocessor}{#if (TLS\_MAX\_VERSION >= TLS\_VERSION\_1\_2 && TLS\_MIN\_VERSION <= TLS\_VERSION\_1\_3)}
90    \textcolor{comment}{//In TLS 1.2, the client can indicate its version preferences in the}
91    \textcolor{comment}{//SupportedVersions extension, in preference to the legacy\_version field}
92    \textcolor{comment}{//of the ClientHello}
93    \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2})
94    \{
95       \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
96       \hyperlink{tls_8h_a47fa2b51d8550d068fce6f01a24c03a8}{TlsSupportedVersionList} *supportedVersionList;
97 
98       \textcolor{comment}{//Add the SupportedVersions extension}
99       extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
100       \textcolor{comment}{//Type of the extension}
101       extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a83028c78d0fca0376acb719c27fb1e6a}{TLS\_EXT\_SUPPORTED\_VERSIONS});
102 
103       \textcolor{comment}{//Point to the extension data field}
104       supportedVersionList = (\hyperlink{tls_8h_a47fa2b51d8550d068fce6f01a24c03a8}{TlsSupportedVersionList} *) extension->value;
105 
106       \textcolor{comment}{//The extension contains a list of supported versions in preference}
107       \textcolor{comment}{//order, with the most preferred version first}
108       n = 0;
109 
110 #if (\hyperlink{dtls__misc_8h_a9a0919875a70a673c9e69852738a8055}{DTLS\_SUPPORT} == \hyperlink{os__port_8h_a73c228f87e038e8295ee8ea8eceaa5ac}{ENABLED})
111       \textcolor{comment}{//DTLS protocol?}
112       \textcolor{keywordflow}{if}(context->transportProtocol == \hyperlink{tls_8h_a25cb7e3df9004160eb21eac9377dc89fa3055717a6d464160f611ee26a81c7d92}{TLS\_TRANSPORT\_PROTOCOL\_DATAGRAM})
113       \{
114          \textcolor{comment}{//Check whether DTLS 1.2 is supported}
115          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2} && context->versionMin <= 
      \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2})
116             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{dtls__misc_8h_a18aa230c9e3a222d1566d74f15f13818}{DTLS\_VERSION\_1\_2});
117 
118          \textcolor{comment}{//Check whether DTLS 1.0 is supported}
119          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_a9e359f668824d16983a41f8deb338979}{TLS\_VERSION\_1\_1} && context->versionMin <= 
      \hyperlink{tls_8h_a9e359f668824d16983a41f8deb338979}{TLS\_VERSION\_1\_1})
120             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{dtls__misc_8h_afcf6494322cd28c6fc73db506ad03ba9}{DTLS\_VERSION\_1\_0});
121       \}
122       \textcolor{keywordflow}{else}
123 \textcolor{preprocessor}{#endif}
124       \textcolor{comment}{//TLS protocol?}
125       \{
126          \textcolor{comment}{//Check whether TLS 1.3 is supported}
127          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_ab44dc642afbfbd72926ab1f94634cd4d}{TLS\_VERSION\_1\_3} && context->versionMin <= 
      \hyperlink{tls_8h_ab44dc642afbfbd72926ab1f94634cd4d}{TLS\_VERSION\_1\_3})
128             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_ab44dc642afbfbd72926ab1f94634cd4d}{TLS\_VERSION\_1\_3});
129 
130          \textcolor{comment}{//Check whether TLS 1.2 is supported}
131          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2} && context->versionMin <= 
      \hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2})
132             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_af97e91c5fb95fb0957e5f37ec9e9eae8}{TLS\_VERSION\_1\_2});
133 
134          \textcolor{comment}{//Check whether TLS 1.1 is supported}
135          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_a9e359f668824d16983a41f8deb338979}{TLS\_VERSION\_1\_1} && context->versionMin <= 
      \hyperlink{tls_8h_a9e359f668824d16983a41f8deb338979}{TLS\_VERSION\_1\_1})
136             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a9e359f668824d16983a41f8deb338979}{TLS\_VERSION\_1\_1});
137 
138          \textcolor{comment}{//Check whether TLS 1.0 is supported}
139          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_adcc8f4321c8f3b847fbea16ca0ff337e}{TLS\_VERSION\_1\_0} && context->versionMin <= 
      \hyperlink{tls_8h_adcc8f4321c8f3b847fbea16ca0ff337e}{TLS\_VERSION\_1\_0})
140             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_adcc8f4321c8f3b847fbea16ca0ff337e}{TLS\_VERSION\_1\_0});
141 
142          \textcolor{comment}{//Check whether SSL 3.0 is supported}
143          \textcolor{keywordflow}{if}(context->versionMax >= \hyperlink{tls_8h_a8d19a9661e2ca28062ba4a00799e8bdb}{SSL\_VERSION\_3\_0} && context->versionMin <= 
      \hyperlink{tls_8h_a8d19a9661e2ca28062ba4a00799e8bdb}{SSL\_VERSION\_3\_0})
144             supportedVersionList->value[n++] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8d19a9661e2ca28062ba4a00799e8bdb}{SSL\_VERSION\_3\_0});
145       \}
146 
147       \textcolor{comment}{//Compute the length, in bytes, of the list}
148       n *= \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
149       \textcolor{comment}{//Fix the length of the list}
150       supportedVersionList->length = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) n;
151 
152       \textcolor{comment}{//Consider the length field that precedes the list}
153       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a47fa2b51d8550d068fce6f01a24c03a8}{TlsSupportedVersionList});
154       \textcolor{comment}{//Fix the length of the extension}
155       extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
156 
157       \textcolor{comment}{//Compute the length, in bytes, of the SupportedVersions extension}
158       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
159    \}
160 \textcolor{preprocessor}{#endif}
161 
162    \textcolor{comment}{//Total number of bytes that have been written}
163    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
164 
165    \textcolor{comment}{//Successful processing}
166    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
167 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_abe810d75943c4423f122d87d30119c5c}\label{tls__client__extensions_8h_abe810d75943c4423f122d87d30119c5c}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Server\+Cert\+Type\+List\+Extension@{tls\+Format\+Server\+Cert\+Type\+List\+Extension}}
\index{tls\+Format\+Server\+Cert\+Type\+List\+Extension@{tls\+Format\+Server\+Cert\+Type\+List\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Server\+Cert\+Type\+List\+Extension()}{tlsFormatServerCertTypeListExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Server\+Cert\+Type\+List\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Server\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Server\+Cert\+Type extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 682 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
684 \{
685    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
686 
687 \textcolor{preprocessor}{#if (TLS\_RAW\_PUBLIC\_KEY\_SUPPORT == ENABLED)}
688    \textcolor{comment}{//Ensure the client is able to process raw public keys}
689    \textcolor{keywordflow}{if}(context->rpkVerifyCallback != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
690    \{
691       \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
692       \hyperlink{tls_8h_aef3d0205a40e8c95b8d7019053d3e7ca}{TlsCertTypeList} *serverCertTypeList;
693 
694       \textcolor{comment}{//Add the ServerCertType extension}
695       extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
696       \textcolor{comment}{//Type of the extension}
697       extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7a5be7581b64f1ed6051200823629ca71b}{TLS\_EXT\_SERVER\_CERT\_TYPE});
698 
699       \textcolor{comment}{//The ServerCertType extension in the ClientHello indicates the types of}
700       \textcolor{comment}{//certificates the client is able to process when provided by the server}
701       \textcolor{comment}{//in a subsequent certificate payload}
702       serverCertTypeList = (\hyperlink{tls_8h_aef3d0205a40e8c95b8d7019053d3e7ca}{TlsCertTypeList} *) extension->value;
703 
704       \textcolor{comment}{//The ServerCertType extension carries a list of supported certificate}
705       \textcolor{comment}{//types, sorted by client preference}
706       n = 0;
707 
708       \textcolor{comment}{//Raw public key type}
709       serverCertTypeList->value[n++] = \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0a598a87140d01a36216289f5dfb6c0f35}{TLS\_CERT\_FORMAT\_RAW\_PUBLIC\_KEY};
710       \textcolor{comment}{//X.509 certificate type}
711       serverCertTypeList->value[n++] = \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0aa099e08287ecdea1676dce7f30d35270}{TLS\_CERT\_FORMAT\_X509};
712 
713       \textcolor{comment}{//Fix the length of the list}
714       serverCertTypeList->length = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
715 
716       \textcolor{comment}{//Consider the length field that precedes the list}
717       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_aef3d0205a40e8c95b8d7019053d3e7ca}{TlsCertTypeList});
718       \textcolor{comment}{//Fix the length of the extension}
719       extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
720 
721       \textcolor{comment}{//Compute the length, in bytes, of the ServerCertType extension}
722       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
723    \}
724 \textcolor{preprocessor}{#endif}
725 
726    \textcolor{comment}{//Total number of bytes that have been written}
727    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
728 
729    \textcolor{comment}{//Successful processing}
730    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
731 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a61e515de2ffab301ccd6db65f8b23388}\label{tls__client__extensions_8h_a61e515de2ffab301ccd6db65f8b23388}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Format\+Supported\+Groups\+Extension@{tls\+Format\+Supported\+Groups\+Extension}}
\index{tls\+Format\+Supported\+Groups\+Extension@{tls\+Format\+Supported\+Groups\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Format\+Supported\+Groups\+Extension()}{tlsFormatSupportedGroupsExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Format\+Supported\+Groups\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{cipher\+Suite\+Types,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Supported\+Groups extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em cipher\+Suite\+Types} & Types of cipher suites proposed by the client \\
\hline
\mbox{\tt in}  & {\em p} & Output stream where to write the Supported\+Groups extension \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 368 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
370 \{
371    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} = 0;
372 
373 \textcolor{preprocessor}{#if (TLS\_ECDH\_SUPPORT == ENABLED || TLS\_FFDHE\_SUPPORT == ENABLED)}
374    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
375    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} numSupportedGroups;
376    \textcolor{keyword}{const} \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} *supportedGroups;
377    \hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *extension;
378    \hyperlink{tls_8h_a697f1e9ded788afc0e198e055676b13c}{TlsSupportedGroupList} *supportedGroupList;
379 
380    \textcolor{comment}{//Add the SupportedGroups extension}
381    extension = (\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
382    \textcolor{comment}{//Type of the extension}
383    extension->type = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tls_8h_a8cfe31c9efd27b98a98e37f2dd1278c7ac6f999fb6a46da62edab19585132600e}{TLS\_EXT\_SUPPORTED\_GROUPS});
384 
385    \textcolor{comment}{//Point to the list of supported groups}
386    supportedGroupList = (\hyperlink{tls_8h_a697f1e9ded788afc0e198e055676b13c}{TlsSupportedGroupList} *) extension->value;
387    \textcolor{comment}{//The groups are ordered according to client's preferences}
388    n = 0;
389 
390    \textcolor{comment}{//Any preferred ECDHE or FFDHE groups?}
391    \textcolor{keywordflow}{if}(context->numSupportedGroups > 0)
392    \{
393       \textcolor{comment}{//Point to the list of preferred named groups}
394       supportedGroups = context->supportedGroups;
395       numSupportedGroups = context->numSupportedGroups;
396    \}
397    \textcolor{keywordflow}{else}
398    \{
399       \textcolor{comment}{//Point to the list of default named groups}
400       supportedGroups = \hyperlink{tls__client__extensions_8c_a45b3c1365328e7b6d0fd372126d29337}{tlsSupportedGroups};
401       numSupportedGroups = \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{tls__client__extensions_8c_a45b3c1365328e7b6d0fd372126d29337}{tlsSupportedGroups});
402    \}
403 
404    \textcolor{comment}{//Loop through the list of named groups}
405    \textcolor{keywordflow}{for}(i = 0; i < numSupportedGroups; i++)
406    \{
407 \textcolor{preprocessor}{#if (TLS\_ECDH\_SUPPORT == ENABLED)}
408       \textcolor{comment}{//Elliptic curve group?}
409       \textcolor{keywordflow}{if}(\hyperlink{tls__misc_8c_a1d99ba7208ae993d388e7849fa5dce71}{tlsGetCurveInfo}(context, supportedGroups[i]) != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
410       \{
411          \textcolor{comment}{//Any ECC cipher suite proposed by the client?}
412          \textcolor{keywordflow}{if}((cipherSuiteTypes & \hyperlink{tls__cipher__suites_8h_aa19934da0d53bda533624f13ba98303ba876aff9a6f283b9cc44eeb7c668cad43}{TLS\_CIPHER\_SUITE\_TYPE\_ECC}) != 0 ||
413             (cipherSuiteTypes & \hyperlink{tls__cipher__suites_8h_aa19934da0d53bda533624f13ba98303ba944e55ede9a5d1931be5ab8eb2d85a23}{TLS\_CIPHER\_SUITE\_TYPE\_TLS13}) != 0)
414          \{
415             \textcolor{comment}{//Add the current named group to the list}
416             supportedGroupList->value[n++] = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(supportedGroups[i]);
417          \}
418       \}
419       \textcolor{keywordflow}{else}
420 \textcolor{preprocessor}{#endif}
421 \textcolor{preprocessor}{#if (TLS\_FFDHE\_SUPPORT == ENABLED)}
422       \textcolor{comment}{//Finite field group?}
423       \textcolor{keywordflow}{if}(\hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tlsGetFfdheGroup}(context, supportedGroups[i]) != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
424       \{
425          \textcolor{comment}{//Any FFDHE cipher suite proposed by the client?}
426          \textcolor{keywordflow}{if}((cipherSuiteTypes & \hyperlink{tls__cipher__suites_8h_aa19934da0d53bda533624f13ba98303ba5e5187cd3cdc6697daf22b738a6d15e3}{TLS\_CIPHER\_SUITE\_TYPE\_FFDHE}) != 0 ||
427             (cipherSuiteTypes & \hyperlink{tls__cipher__suites_8h_aa19934da0d53bda533624f13ba98303ba944e55ede9a5d1931be5ab8eb2d85a23}{TLS\_CIPHER\_SUITE\_TYPE\_TLS13}) != 0)
428          \{
429             \textcolor{comment}{//Add the current named group to the list}
430             supportedGroupList->value[n++] = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(supportedGroups[i]);
431          \}
432       \}
433       \textcolor{keywordflow}{else}
434 \textcolor{preprocessor}{#endif}
435       \textcolor{comment}{//Unknown group?}
436       \{
437          \textcolor{comment}{//Discard current named group}
438       \}
439    \}
440 
441    \textcolor{comment}{//If the client supports and wants ECDHE and FFDHE key exchanges, it must}
442    \textcolor{comment}{//use a single SupportedGroups extension to include all supported groups}
443    \textcolor{comment}{//(both ECDHE and FFDHE groups)}
444    \textcolor{keywordflow}{if}(n != 0)
445    \{
446       \textcolor{comment}{//Compute the length, in bytes, of the list}
447       n *= 2;
448       \textcolor{comment}{//Fix the length of the list}
449       supportedGroupList->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
450 
451       \textcolor{comment}{//Consider the 2-byte length field that precedes the list}
452       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_a697f1e9ded788afc0e198e055676b13c}{TlsSupportedGroupList});
453       \textcolor{comment}{//Fix the length of the extension}
454       extension->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
455 
456       \textcolor{comment}{//Compute the length, in bytes, of the SupportedGroups extension}
457       n += \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_adc894469d534a49c4295cf3a1551a1f6}{TlsExtension});
458    \}
459 \textcolor{preprocessor}{#endif}
460 
461    \textcolor{comment}{//Total number of bytes that have been written}
462    *written = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
463 
464    \textcolor{comment}{//Successful processing}
465    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
466 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_ad002dcf307670ef4d0692506650c9567}\label{tls__client__extensions_8h_ad002dcf307670ef4d0692506650c9567}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Client\+Cert\+Type\+Extension@{tls\+Parse\+Client\+Cert\+Type\+Extension}}
\index{tls\+Parse\+Client\+Cert\+Type\+Extension@{tls\+Parse\+Client\+Cert\+Type\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Client\+Cert\+Type\+Extension()}{tlsParseClientCertTypeExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Client\+Cert\+Type\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{client\+Cert\+Type }\end{DoxyParamCaption})}



Parse Client\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em client\+Cert\+Type} & Pointer to the Client\+Cert\+Type extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1177 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
1179 \{
1180 \textcolor{preprocessor}{#if (TLS\_RAW\_PUBLIC\_KEY\_SUPPORT == ENABLED)}
1181    \textcolor{comment}{//ClientCertType extension found?}
1182    \textcolor{keywordflow}{if}(clientCertType != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1183    \{
1184       \textcolor{comment}{//The value conveyed in the extension must be selected from one of the}
1185       \textcolor{comment}{//values provided in the ClientCertType extension sent in the ClientHello}
1186       \textcolor{keywordflow}{if}(*clientCertType != \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0aa099e08287ecdea1676dce7f30d35270}{TLS\_CERT\_FORMAT\_X509} &&
1187          *clientCertType != \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0a598a87140d01a36216289f5dfb6c0f35}{TLS\_CERT\_FORMAT\_RAW\_PUBLIC\_KEY})
1188       \{
1189          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
1190       \}
1191 
1192       \textcolor{comment}{//The ClientCertType extension in the ServerHello indicates the type}
1193       \textcolor{comment}{//of certificates the client is requested to provide in a subsequent}
1194       \textcolor{comment}{//certificate payload}
1195       context->certFormat = (\hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0}{TlsCertificateFormat}) *clientCertType;
1196    \}
1197 \textcolor{preprocessor}{#endif}
1198 
1199    \textcolor{comment}{//Successful processing}
1200    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1201 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a48aa76764f8864824dbb375c3ea3b765}\label{tls__client__extensions_8h_a48aa76764f8864824dbb375c3ea3b765}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Alpn\+Extension@{tls\+Parse\+Server\+Alpn\+Extension}}
\index{tls\+Parse\+Server\+Alpn\+Extension@{tls\+Parse\+Server\+Alpn\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Alpn\+Extension()}{tlsParseServerAlpnExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Alpn\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{tls_8h_a437df336a6795a38ec9bcfb7c2ab4b2f}{Tls\+Protocol\+Name\+List} $\ast$}]{protocol\+Name\+List }\end{DoxyParamCaption})}



Parse A\+L\+PN extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em protocol\+Name\+List} & Pointer to the A\+L\+PN extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1097 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
1099 \{
1100 \textcolor{preprocessor}{#if (TLS\_ALPN\_SUPPORT == ENABLED)}
1101    \textcolor{comment}{//ALPN extension found?}
1102    \textcolor{keywordflow}{if}(protocolNameList != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1103    \{
1104       \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1105       \textcolor{keyword}{const} \hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName} *protocolName;
1106 
1107       \textcolor{comment}{//If a client receives an extension type in the ServerHello that it}
1108       \textcolor{comment}{//did not request in the associated ClientHello, it must abort the}
1109       \textcolor{comment}{//handshake with an unsupported\_extension fatal alert}
1110       \textcolor{keywordflow}{if}(context->protocolList == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1111          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
1112 
1113       \textcolor{comment}{//Retrieve the length of the list}
1114       length = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(protocolNameList->length);
1115 
1116       \textcolor{comment}{//The list must not be be empty}
1117       \textcolor{keywordflow}{if}(length == 0)
1118          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca9468adacac8c37004024dd0095ba2768}{ERROR\_DECODING\_FAILED};
1119 
1120       \textcolor{comment}{//Point to the selected protocol}
1121       protocolName = (\hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName} *) protocolNameList->value;
1122 
1123       \textcolor{comment}{//The list must contain exactly one protocol name}
1124       \textcolor{keywordflow}{if}(length < \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName}))
1125          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca9468adacac8c37004024dd0095ba2768}{ERROR\_DECODING\_FAILED};
1126       \textcolor{keywordflow}{if}(length != (\textcolor{keyword}{sizeof}(\hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName}) + protocolName->length))
1127          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca9468adacac8c37004024dd0095ba2768}{ERROR\_DECODING\_FAILED};
1128 
1129       \textcolor{comment}{//Retrieve the length of the protocol name}
1130       length -= \textcolor{keyword}{sizeof}(\hyperlink{tls_8h_ac7efedb92628fa0d6c715e009381a8c0}{TlsProtocolName});
1131 
1132       \textcolor{comment}{//Empty strings must not be included in the list}
1133       \textcolor{keywordflow}{if}(length == 0)
1134          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca9468adacac8c37004024dd0095ba2768}{ERROR\_DECODING\_FAILED};
1135 
1136       \textcolor{comment}{//Check whether the protocol is supported by the client}
1137       \textcolor{keywordflow}{if}(!\hyperlink{tls__extensions_8c_a5b3ac44fd8575310d00ab10cbbd6dfdd}{tlsIsAlpnProtocolSupported}(context, protocolName->value, length))
1138       \{
1139          \textcolor{comment}{//Report an error if unknown ALPN protocols are disallowed}
1140          \textcolor{keywordflow}{if}(!context->unknownProtocolsAllowed)
1141             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
1142       \}
1143 
1144       \textcolor{comment}{//Sanity check}
1145       \textcolor{keywordflow}{if}(context->selectedProtocol != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1146       \{
1147          \textcolor{comment}{//Release memory}
1148          \hyperlink{tls_8h_a3bf186204f261ff5d65b31794917f742}{tlsFreeMem}(context->selectedProtocol);
1149          context->selectedProtocol = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1150       \}
1151 
1152       \textcolor{comment}{//Allocate a memory block to hold the protocol name}
1153       context->selectedProtocol = \hyperlink{tls_8h_a00504a83fb06cb4206f7205664ffeeb4}{tlsAllocMem}(length + 1);
1154       \textcolor{comment}{//Failed to allocate memory?}
1155       \textcolor{keywordflow}{if}(context->selectedProtocol == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1156          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
1157 
1158       \textcolor{comment}{//Save protocol name}
1159       memcpy(context->selectedProtocol, protocolName->value, length);
1160       \textcolor{comment}{//Properly terminate the string with a NULL character}
1161       context->selectedProtocol[\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}] = \textcolor{charliteral}{'\(\backslash\)0'};
1162    \}
1163 \textcolor{preprocessor}{#endif}
1164 
1165    \textcolor{comment}{//Successful processing}
1166    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1167 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a4fb6de89c85a0a0e3d7e42e55d6f0fe6}\label{tls__client__extensions_8h_a4fb6de89c85a0a0e3d7e42e55d6f0fe6}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Cert\+Type\+Extension@{tls\+Parse\+Server\+Cert\+Type\+Extension}}
\index{tls\+Parse\+Server\+Cert\+Type\+Extension@{tls\+Parse\+Server\+Cert\+Type\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Cert\+Type\+Extension()}{tlsParseServerCertTypeExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Cert\+Type\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{server\+Cert\+Type }\end{DoxyParamCaption})}



Parse Server\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em server\+Cert\+Type} & Pointer to the Server\+Cert\+Type extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1211 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
1213 \{
1214 \textcolor{preprocessor}{#if (TLS\_RAW\_PUBLIC\_KEY\_SUPPORT == ENABLED)}
1215    \textcolor{comment}{//ServerCertType extension found?}
1216    \textcolor{keywordflow}{if}(serverCertType != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1217    \{
1218       \textcolor{comment}{//If a client receives an extension type in the ServerHello that it did}
1219       \textcolor{comment}{//not request in the associated ClientHello, it must abort the handshake}
1220       \textcolor{comment}{//with an unsupported\_extension fatal alert}
1221       \textcolor{keywordflow}{if}(context->rpkVerifyCallback == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
1222          *serverCertType != \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0aa099e08287ecdea1676dce7f30d35270}{TLS\_CERT\_FORMAT\_X509})
1223       \{
1224          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
1225       \}
1226 
1227       \textcolor{comment}{//The value conveyed in the extension must be selected from one of the}
1228       \textcolor{comment}{//values provided in the ServerCertType extension sent in the ClientHello}
1229       \textcolor{keywordflow}{if}(*serverCertType != \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0aa099e08287ecdea1676dce7f30d35270}{TLS\_CERT\_FORMAT\_X509} &&
1230          *serverCertType != \hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0a598a87140d01a36216289f5dfb6c0f35}{TLS\_CERT\_FORMAT\_RAW\_PUBLIC\_KEY})
1231       \{
1232          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
1233       \}
1234 
1235       \textcolor{comment}{//With the ServerCertType extension in the ServerHello, the TLS server}
1236       \textcolor{comment}{//indicates the certificate type carried in the certificate payload}
1237       context->peerCertFormat = (\hyperlink{tls_8h_a14c2a51c1d8cf969aa455b69e405c0d0}{TlsCertificateFormat}) *serverCertType;
1238    \}
1239 \textcolor{preprocessor}{#endif}
1240 
1241    \textcolor{comment}{//Successful processing}
1242    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1243 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a111f4eb896f7a1e7b81c26949926d163}\label{tls__client__extensions_8h_a111f4eb896f7a1e7b81c26949926d163}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension@{tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension}}
\index{tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension@{tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension()}{tlsParseServerEcPointFormatsExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Ec\+Point\+Formats\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{tls_8h_a56cd71342730891de1eb587381a26731}{Tls\+Ec\+Point\+Format\+List} $\ast$}]{ec\+Point\+Format\+List }\end{DoxyParamCaption})}



Parse Ec\+Point\+Formats extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em ec\+Point\+Format\+List} & Pointer to the Ec\+Point\+Formats extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1049 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
1051 \{
1052    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1053 
1054    \textcolor{comment}{//Initialize status code}
1055    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1056 
1057 \textcolor{preprocessor}{#if (TLS\_ECDH\_ANON\_KE\_SUPPORT == ENABLED || TLS\_ECDHE\_RSA\_KE\_SUPPORT == ENABLED || \(\backslash\)}
1058 \textcolor{preprocessor}{   TLS\_ECDHE\_ECDSA\_KE\_SUPPORT == ENABLED || TLS\_ECDHE\_PSK\_KE\_SUPPORT == ENABLED)}
1059    \textcolor{comment}{//EcPointFormats extension found?}
1060    \textcolor{keywordflow}{if}(ecPointFormatList != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1061    \{
1062       \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1063 
1064       \textcolor{comment}{//Loop through the list of supported EC point formats}
1065       \textcolor{keywordflow}{for}(i = 0; i < ecPointFormatList->length; i++)
1066       \{
1067          \textcolor{comment}{//Uncompressed point format?}
1068          \textcolor{keywordflow}{if}(ecPointFormatList->value[i] == \hyperlink{tls_8h_a45b8a57398a9bd960e3f3186a7d3cd38a149b16635a32aa8ed87166485790f152}{TLS\_EC\_POINT\_FORMAT\_UNCOMPRESSED}
      )
1069          \{
1070             \textcolor{keywordflow}{break};
1071          \}
1072       \}
1073 
1074       \textcolor{comment}{//If the EcPointFormats extension is sent, it must contain the value 0}
1075       \textcolor{comment}{//as one of the items in the list of point formats (refer to RFC 4492,}
1076       \textcolor{comment}{//section 5.2)}
1077       \textcolor{keywordflow}{if}(i >= ecPointFormatList->length)
1078       \{
1079          \textcolor{comment}{//Report an error}
1080          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
1081       \}
1082    \}
1083 \textcolor{preprocessor}{#endif}
1084 
1085    \textcolor{comment}{//Return status code}
1086    \textcolor{keywordflow}{return} error;
1087 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a96534351b950c17505b01e28719d40b7}\label{tls__client__extensions_8h_a96534351b950c17505b01e28719d40b7}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Ems\+Extension@{tls\+Parse\+Server\+Ems\+Extension}}
\index{tls\+Parse\+Server\+Ems\+Extension@{tls\+Parse\+Server\+Ems\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Ems\+Extension()}{tlsParseServerEmsExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Ems\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{extended\+Master\+Secret }\end{DoxyParamCaption})}



Parse Extended\+Master\+Secret extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em extended\+Master\+Secret} & Pointer to the Extended\+Master\+Secret extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1253 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
1255 \{
1256 \textcolor{preprocessor}{#if (TLS\_EXT\_MASTER\_SECRET\_SUPPORT == ENABLED)}
1257    \textcolor{comment}{//ExtendedMasterSecret extension found?}
1258    \textcolor{keywordflow}{if}(extendedMasterSecret != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1259    \{
1260       \textcolor{comment}{//The countermeasure described in RFC 7627 cannot be used with SSL 3.0}
1261       \textcolor{keywordflow}{if}(context->version == \hyperlink{tls_8h_a8d19a9661e2ca28062ba4a00799e8bdb}{SSL\_VERSION\_3\_0})
1262          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
1263 
1264       \textcolor{comment}{//Abbreviated handshake?}
1265       \textcolor{keywordflow}{if}(context->resume)
1266       \{
1267          \textcolor{comment}{//If the original session did not use the ExtendedMasterSecret}
1268          \textcolor{comment}{//extension but the new ServerHello contains the extension, the}
1269          \textcolor{comment}{//client must abort the handshake}
1270          \textcolor{keywordflow}{if}(!context->extendedMasterSecretExtReceived)
1271             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1272       \}
1273 
1274       \textcolor{comment}{//A valid ExtendedMasterSecret extension has been received}
1275       context->extendedMasterSecretExtReceived = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1276    \}
1277    \textcolor{keywordflow}{else}
1278    \{
1279       \textcolor{comment}{//Abbreviated handshake?}
1280       \textcolor{keywordflow}{if}(context->resume)
1281       \{
1282          \textcolor{comment}{//If the original session used the ExtendedMasterSecret extension}
1283          \textcolor{comment}{//but the new ServerHello does not contain the extension, the client}
1284          \textcolor{comment}{//must abort the handshake}
1285          \textcolor{keywordflow}{if}(context->extendedMasterSecretExtReceived)
1286             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1287       \}
1288 
1289       \textcolor{comment}{//The ServerHello does not contain any ExtendedMasterSecret extension}
1290       context->extendedMasterSecretExtReceived = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1291    \}
1292 \textcolor{preprocessor}{#endif}
1293 
1294    \textcolor{comment}{//Successful processing}
1295    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1296 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a2e070756a890d030b3d44e52ca561cd1}\label{tls__client__extensions_8h_a2e070756a890d030b3d44e52ca561cd1}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Max\+Frag\+Len\+Extension@{tls\+Parse\+Server\+Max\+Frag\+Len\+Extension}}
\index{tls\+Parse\+Server\+Max\+Frag\+Len\+Extension@{tls\+Parse\+Server\+Max\+Frag\+Len\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Max\+Frag\+Len\+Extension()}{tlsParseServerMaxFragLenExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Max\+Frag\+Len\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{max\+Frag\+Len }\end{DoxyParamCaption})}



Parse Max\+Fragment\+Length extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em max\+Frag\+Len} & Pointer to the Max\+Fragment\+Length extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 940 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
942 \{
943 \textcolor{preprocessor}{#if (TLS\_MAX\_FRAG\_LEN\_SUPPORT == ENABLED)}
944    \textcolor{comment}{//MaxFragmentLength extension found?}
945    \textcolor{keywordflow}{if}(maxFragLen != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
946    \{
947       \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
948 
949       \textcolor{comment}{//Retrieve the value advertised by the server}
950       \textcolor{keywordflow}{switch}(*maxFragLen)
951       \{
952       \textcolor{keywordflow}{case} \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63a4c1a1521181c432d51d61dc4f295d027}{TLS\_MAX\_FRAGMENT\_LENGTH\_512}:
953          n = 512;
954          \textcolor{keywordflow}{break};
955       \textcolor{keywordflow}{case} \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63aeee4f23ba8be12a29158044f629a04cf}{TLS\_MAX\_FRAGMENT\_LENGTH\_1024}:
956          n = 1024;
957          \textcolor{keywordflow}{break};
958       \textcolor{keywordflow}{case} \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63ad6ba9b8c7be1f57b904f4e1304295fad}{TLS\_MAX\_FRAGMENT\_LENGTH\_2048}:
959          n = 2048;
960          \textcolor{keywordflow}{break};
961       \textcolor{keywordflow}{case} \hyperlink{tls_8h_a9d0a45f7cb05f78ef159005b86bf0a63ac32ed0270e2b99db48fe7835eb1525bc}{TLS\_MAX\_FRAGMENT\_LENGTH\_4096}:
962          n = 4096;
963          \textcolor{keywordflow}{break};
964       \textcolor{keywordflow}{default}:
965          n = 0;
966          \textcolor{keywordflow}{break};
967       \}
968 
969       \textcolor{comment}{//If a client receives a maximum fragment length negotiation response}
970       \textcolor{comment}{//that differs from the length it requested, it must also abort the}
971       \textcolor{comment}{//handshake with an illegal\_parameter alert}
972       \textcolor{keywordflow}{if}(n != context->maxFragLen)
973          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
974    \}
975 \textcolor{preprocessor}{#endif}
976 
977    \textcolor{comment}{//Successful processing}
978    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
979 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_a5585164093c76ef6fa5f2199dac4b98b}\label{tls__client__extensions_8h_a5585164093c76ef6fa5f2199dac4b98b}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Record\+Size\+Limit\+Extension@{tls\+Parse\+Server\+Record\+Size\+Limit\+Extension}}
\index{tls\+Parse\+Server\+Record\+Size\+Limit\+Extension@{tls\+Parse\+Server\+Record\+Size\+Limit\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Record\+Size\+Limit\+Extension()}{tlsParseServerRecordSizeLimitExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Record\+Size\+Limit\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{record\+Size\+Limit }\end{DoxyParamCaption})}



Parse Record\+Size\+Limit extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em record\+Size\+Limit} & Pointer to the Record\+Size\+Limit extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 989 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
991 \{
992 \textcolor{preprocessor}{#if (TLS\_RECORD\_SIZE\_LIMIT\_SUPPORT == ENABLED)}
993    \textcolor{comment}{//RecordSizeLimit extension found?}
994    \textcolor{keywordflow}{if}(recordSizeLimit != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
995    \{
996       \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
997 
998       \textcolor{comment}{//The value of RecordSizeLimit is the maximum size of record in octets}
999       \textcolor{comment}{//that the peer is willing to receive}
1000       n = \hyperlink{cpu__endian_8h_ae21854587c05993c850b537156470088}{LOAD16BE}(recordSizeLimit);
1001 
1002       \textcolor{comment}{//Endpoints must not send a RecordSizeLimit extension with a value}
1003       \textcolor{comment}{//smaller than 64}
1004       \textcolor{keywordflow}{if}(n < 64)
1005       \{
1006          \textcolor{comment}{//An endpoint must treat receipt of a smaller value as a fatal error}
1007          \textcolor{comment}{//and generate an illegal\_parameter alert}
1008          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
1009       \}
1010 
1011       \textcolor{comment}{//TLS 1.3 currently selected?}
1012       \textcolor{keywordflow}{if}(context->version == \hyperlink{tls_8h_ab44dc642afbfbd72926ab1f94634cd4d}{TLS\_VERSION\_1\_3})
1013       \{
1014          \textcolor{comment}{//The value includes the content type and padding added in TLS 1.3}
1015          n--;
1016       \}
1017 
1018       \textcolor{comment}{//The peer can include any limit up to the protocol-defined limit for}
1019       \textcolor{comment}{//maximum record size. Even if a larger value is provided by a peer, an}
1020       \textcolor{comment}{//endpoint must not send records larger than the protocol-defined limit}
1021       context->recordSizeLimit = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(n, \hyperlink{tls_8h_a87485283e0c2c0a9b1b3e5ef9df52975}{TLS\_MAX\_RECORD\_LENGTH});
1022 
1023       \textcolor{comment}{//The RecordSizeLimit extension has been successfully negotiated}
1024       context->recordSizeLimitExtReceived = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1025    \}
1026    \textcolor{keywordflow}{else}
1027    \{
1028       \textcolor{comment}{//If this extension is not negotiated, endpoints can send records of any}
1029       \textcolor{comment}{//size permitted by the protocol or other negotiated extensions}
1030       context->recordSizeLimit = \hyperlink{tls_8h_a87485283e0c2c0a9b1b3e5ef9df52975}{TLS\_MAX\_RECORD\_LENGTH};
1031 
1032       \textcolor{comment}{//The RecordSizeLimit extension is not supported by the server}
1033       context->recordSizeLimitExtReceived = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1034    \}
1035 \textcolor{preprocessor}{#endif}
1036 
1037    \textcolor{comment}{//Successful processing}
1038    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1039 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_ab1f51cd1e13b9aa71e4e5e9bee4c6910}\label{tls__client__extensions_8h_ab1f51cd1e13b9aa71e4e5e9bee4c6910}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Renego\+Info\+Extension@{tls\+Parse\+Server\+Renego\+Info\+Extension}}
\index{tls\+Parse\+Server\+Renego\+Info\+Extension@{tls\+Parse\+Server\+Renego\+Info\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Renego\+Info\+Extension()}{tlsParseServerRenegoInfoExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Renego\+Info\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structTlsHelloExtensions}{Tls\+Hello\+Extensions} $\ast$}]{extensions }\end{DoxyParamCaption})}



Parse Renegotiation\+Info extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em extensions} & Server\+Hello extensions offered by the server \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1306 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
1308 \{
1309 \textcolor{preprocessor}{#if (TLS\_SECURE\_RENEGOTIATION\_SUPPORT == ENABLED)}
1310    \textcolor{comment}{//Initial handshake?}
1311    \textcolor{keywordflow}{if}(context->clientVerifyDataLen == 0)
1312    \{
1313       \textcolor{comment}{//RenegotiationInfo extension found?}
1314       \textcolor{keywordflow}{if}(extensions->\hyperlink{structTlsHelloExtensions_aecf5a78a44bd06ba8018bd5f4a5043de}{renegoInfo} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1315       \{
1316          \textcolor{comment}{//If the extension is present, set the secure\_renegotiation flag to TRUE}
1317          context->secureRenegoFlag = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1318 
1319          \textcolor{comment}{//Verify that the length of the renegotiated\_connection field is zero}
1320          \textcolor{keywordflow}{if}(extensions->\hyperlink{structTlsHelloExtensions_aecf5a78a44bd06ba8018bd5f4a5043de}{renegoInfo}->length != 0)
1321          \{
1322             \textcolor{comment}{//If it is not, the client must abort the handshake by sending a}
1323             \textcolor{comment}{//fatal handshake failure alert}
1324             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1325          \}
1326       \}
1327       \textcolor{keywordflow}{else}
1328       \{
1329          \textcolor{comment}{//If the extension is not present, the server does not support secure}
1330          \textcolor{comment}{//renegotiation}
1331          context->secureRenegoFlag = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1332       \}
1333    \}
1334    \textcolor{comment}{//Secure renegotiation?}
1335    \textcolor{keywordflow}{else}
1336    \{
1337       \textcolor{comment}{//RenegotiationInfo extension found?}
1338       \textcolor{keywordflow}{if}(extensions->\hyperlink{structTlsHelloExtensions_aecf5a78a44bd06ba8018bd5f4a5043de}{renegoInfo} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1339       \{
1340          \textcolor{comment}{//Check the length of the renegotiated\_connection field}
1341          \textcolor{keywordflow}{if}(extensions->\hyperlink{structTlsHelloExtensions_aecf5a78a44bd06ba8018bd5f4a5043de}{renegoInfo}->length != (context->clientVerifyDataLen +
1342             context->serverVerifyDataLen))
1343          \{
1344             \textcolor{comment}{//The client must abort the handshake}
1345             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1346          \}
1347 
1348          \textcolor{comment}{//The client must verify that the first half of the field is equal to}
1349          \textcolor{comment}{//the saved client\_verify\_data value}
1350          \textcolor{keywordflow}{if}(memcmp(extensions->\hyperlink{structTlsHelloExtensions_aecf5a78a44bd06ba8018bd5f4a5043de}{renegoInfo}->value, context->clientVerifyData,
1351             context->clientVerifyDataLen))
1352          \{
1353             \textcolor{comment}{//If it is not, the client must abort the handshake}
1354             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1355          \}
1356 
1357          \textcolor{comment}{//The client must verify that the second half of the field is equal to}
1358          \textcolor{comment}{//the saved server\_verify\_data value}
1359          \textcolor{keywordflow}{if}(memcmp(extensions->\hyperlink{structTlsHelloExtensions_aecf5a78a44bd06ba8018bd5f4a5043de}{renegoInfo}->value + context->clientVerifyDataLen,
1360             context->serverVerifyData, context->serverVerifyDataLen))
1361          \{
1362             \textcolor{comment}{//If it is not, the client must abort the handshake}
1363             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1364          \}
1365 
1366 \textcolor{preprocessor}{#if (TLS\_EXT\_MASTER\_SECRET\_SUPPORT == ENABLED)}
1367          \textcolor{comment}{//ExtendedMasterSecret extension found?}
1368          \textcolor{keywordflow}{if}(extensions->\hyperlink{structTlsHelloExtensions_a04cc0ffcf992700820ec12d6f43212bf}{extendedMasterSecret} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1369          \{
1370             \textcolor{comment}{//If the initial handshake did not use the ExtendedMasterSecret}
1371             \textcolor{comment}{//extension but the new ServerHello contains the extension, the}
1372             \textcolor{comment}{//client must abort the handshake}
1373             \textcolor{keywordflow}{if}(!context->extendedMasterSecretExtReceived)
1374                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1375          \}
1376          \textcolor{keywordflow}{else}
1377          \{
1378             \textcolor{comment}{//If the initial handshake used the ExtendedMasterSecret extension}
1379             \textcolor{comment}{//but the new ServerHello does not contain the extension, the}
1380             \textcolor{comment}{//client must abort the handshake}
1381             \textcolor{keywordflow}{if}(context->extendedMasterSecretExtReceived)
1382                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1383          \}
1384 \textcolor{preprocessor}{#endif}
1385       \}
1386       \textcolor{keywordflow}{else}
1387       \{
1388          \textcolor{comment}{//If the RenegotiationInfo extension is not present, the client}
1389          \textcolor{comment}{//must abort the handshake}
1390          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
1391       \}
1392    \}
1393 \textcolor{preprocessor}{#endif}
1394 
1395    \textcolor{comment}{//Successful processing}
1396    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1397 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__client__extensions_8h_abb7e3afa03320f12445a027bcec125ea}\label{tls__client__extensions_8h_abb7e3afa03320f12445a027bcec125ea}} 
\index{tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}!tls\+Parse\+Server\+Sni\+Extension@{tls\+Parse\+Server\+Sni\+Extension}}
\index{tls\+Parse\+Server\+Sni\+Extension@{tls\+Parse\+Server\+Sni\+Extension}!tls\+\_\+client\+\_\+extensions.\+h@{tls\+\_\+client\+\_\+extensions.\+h}}
\subsubsection{\texorpdfstring{tls\+Parse\+Server\+Sni\+Extension()}{tlsParseServerSniExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Parse\+Server\+Sni\+Extension (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{tls_8h_a15e86cf6f06b8178e14735d6e4c83cb1}{Tls\+Server\+Name\+List} $\ast$}]{server\+Name\+List }\end{DoxyParamCaption})}



Parse S\+NI extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em server\+Name\+List} & Pointer to the Server\+Name extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 913 of file tls\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
915 \{
916 \textcolor{preprocessor}{#if (TLS\_SNI\_SUPPORT == ENABLED)}
917    \textcolor{comment}{//SNI extension found?}
918    \textcolor{keywordflow}{if}(serverNameList != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
919    \{
920       \textcolor{comment}{//If a client receives an extension type in the ServerHello that it did}
921       \textcolor{comment}{//not request in the associated ClientHello, it must abort the handshake}
922       \textcolor{comment}{//with an unsupported\_extension fatal alert}
923       \textcolor{keywordflow}{if}(context->serverName == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
924          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
925    \}
926 \textcolor{preprocessor}{#endif}
927 
928    \textcolor{comment}{//Successful processing}
929    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
930 \}
\end{DoxyCode}
