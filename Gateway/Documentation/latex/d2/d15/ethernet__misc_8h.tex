\hypertarget{ethernet__misc_8h}{}\section{cyclone\+\_\+tcp/core/ethernet\+\_\+misc.h File Reference}
\label{ethernet__misc_8h}\index{cyclone\+\_\+tcp/core/ethernet\+\_\+misc.\+h@{cyclone\+\_\+tcp/core/ethernet\+\_\+misc.\+h}}


Helper functions for Ethernet.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/ethernet.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ethernet__misc_8h_a5335a5d9048656a2448d9c43477e2915}{eth\+Pad\+Frame} (\hyperlink{structNetBuffer}{Net\+Buffer} $\ast$buffer, size\+\_\+t $\ast$\hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Ethernet frame padding. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ethernet__misc_8h_a0124b663f82423d4e4decf61e742419b}{eth\+Encode\+Vlan\+Tag} (\hyperlink{structNetBuffer}{Net\+Buffer} $\ast$buffer, size\+\_\+t $\ast$\hyperlink{pic32mz_2isr__support_8h_ac0542d92dfcd62c19170fd963f9e5052}{offset}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} vlan\+Id, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{ppp_8h_a1d127017fb298b889f4ba24752d08b8e}{type})
\begin{DoxyCompactList}\small\item\em V\+L\+AN tag encoding. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ethernet__misc_8h_ae418db17934113d25154e41b47689fd3}{eth\+Decode\+Vlan\+Tag} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$frame, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$vlan\+Id, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$\hyperlink{ppp_8h_a1d127017fb298b889f4ba24752d08b8e}{type})
\begin{DoxyCompactList}\small\item\em V\+L\+AN tag deccoding. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ethernet__misc_8h_a80b44da0541051f314be19c7e63a2ce0}{eth\+Check\+Dest\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$mac\+Addr)
\begin{DoxyCompactList}\small\item\em Destination M\+AC address filtering. \end{DoxyCompactList}\item 
void \hyperlink{ethernet__misc_8h_acd6a284456dd8a9e7a21e3fce3711f3b}{eth\+Update\+In\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$dest\+Mac\+Addr)
\begin{DoxyCompactList}\small\item\em Update Ethernet input statistics. \end{DoxyCompactList}\item 
void \hyperlink{ethernet__misc_8h_a567573a40fd60c02c187b48c3e715d55}{eth\+Update\+Out\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$dest\+Mac\+Addr, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update Ethernet output statistics. \end{DoxyCompactList}\item 
void \hyperlink{ethernet__misc_8h_a0478aefa56bfc5d10a3046062a5464d6}{eth\+Update\+Error\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} error)
\begin{DoxyCompactList}\small\item\em Update Ethernet error statistics. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ethernet__misc_8h_adf186ad9e87b20cf9c8940e43dd9fea8}{eth\+Calc\+Crc} (const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Ethernet C\+RC calculation. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ethernet__misc_8h_a7f86288f9e2517184cc9f195f5d26f39}{eth\+Calc\+Crc\+Ex} (const \hyperlink{structNetBuffer}{Net\+Buffer} $\ast$buffer, size\+\_\+t \hyperlink{pic32mz_2isr__support_8h_ac0542d92dfcd62c19170fd963f9e5052}{offset}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Calculate C\+RC over a multi-\/part buffer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ethernet__misc_8h_a516450f33b1c15e3648a75e0141cac22}{eth\+Check\+Crc} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$frame, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Ethernet C\+RC verification. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ethernet__misc_8h_ade727849dd0a05220a66bf870c0a201f}{eth\+Padding} \mbox{[}64\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Helper functions for Ethernet. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{ethernet__misc_8h_adf186ad9e87b20cf9c8940e43dd9fea8}\label{ethernet__misc_8h_adf186ad9e87b20cf9c8940e43dd9fea8}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Calc\+Crc@{eth\+Calc\+Crc}}
\index{eth\+Calc\+Crc@{eth\+Calc\+Crc}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Calc\+Crc()}{ethCalcCrc()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} eth\+Calc\+Crc (\begin{DoxyParamCaption}\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Ethernet C\+RC calculation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the data over which to calculate the C\+RC \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Resulting C\+RC value 
\end{DoxyReturn}


Definition at line 439 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
440 \{
441 \textcolor{comment}{//A lookup table can be used to speed up CRC calculation}
442 \textcolor{preprocessor}{#if (ETH\_FAST\_CRC\_SUPPORT == ENABLED)}
443    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
444 
445    \textcolor{comment}{//Point to the data over which to calculate the CRC}
446    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
447    \textcolor{comment}{//CRC preset value}
448    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} crc = 0xFFFFFFFF;
449 
450    \textcolor{comment}{//Loop through data}
451    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
452    \{
453       \textcolor{comment}{//The message is processed byte by byte}
454       crc = (crc >> 8) ^ \hyperlink{ethernet__misc_8c_ae50df6f0f3567b27f3f957baa92216ca}{crc32Table}[(crc & 0xFF) ^ p[i]];
455    \}
456 
457    \textcolor{comment}{//Return 1's complement value}
458    \textcolor{keywordflow}{return} ~crc;
459 
460 \textcolor{comment}{//Bit by bit CRC calculation}
461 \textcolor{preprocessor}{#else}
462    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
463    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
464 
465    \textcolor{comment}{//Point to the data over which to calculate the CRC}
466    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *p = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
467    \textcolor{comment}{//CRC preset value}
468    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} crc = 0xFFFFFFFF;
469 
470    \textcolor{comment}{//Loop through data}
471    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
472    \{
473       \textcolor{comment}{//Update CRC value}
474       crc ^= p[i];
475       \textcolor{comment}{//The message is processed bit by bit}
476       \textcolor{keywordflow}{for}(j = 0; j < 8; j++)
477       \{
478          \textcolor{keywordflow}{if}(crc & 0x00000001)
479             crc = (crc >> 1) ^ 0xEDB88320;
480          \textcolor{keywordflow}{else}
481             crc = crc >> 1;
482       \}
483    \}
484 
485    \textcolor{comment}{//Return 1's complement value}
486    \textcolor{keywordflow}{return} ~crc;
487 \textcolor{preprocessor}{#endif}
488 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a7f86288f9e2517184cc9f195f5d26f39}\label{ethernet__misc_8h_a7f86288f9e2517184cc9f195f5d26f39}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Calc\+Crc\+Ex@{eth\+Calc\+Crc\+Ex}}
\index{eth\+Calc\+Crc\+Ex@{eth\+Calc\+Crc\+Ex}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Calc\+Crc\+Ex()}{ethCalcCrcEx()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} eth\+Calc\+Crc\+Ex (\begin{DoxyParamCaption}\item[{const \hyperlink{structNetBuffer}{Net\+Buffer} $\ast$}]{buffer,  }\item[{size\+\_\+t}]{offset,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Calculate C\+RC over a multi-\/part buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buffer} & Pointer to the multi-\/part buffer \\
\hline
\mbox{\tt in}  & {\em offset} & Offset from the beginning of the buffer \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Resulting C\+RC value 
\end{DoxyReturn}


Definition at line 499 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
500 \{
501    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
502    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
503    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} crc;
504    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
505 \textcolor{preprocessor}{#if (ETH\_FAST\_CRC\_SUPPORT == DISABLED)}
506    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
507 \textcolor{preprocessor}{#endif}
508 
509    \textcolor{comment}{//CRC preset value}
510    crc = 0xFFFFFFFF;
511 
512    \textcolor{comment}{//Loop through data chunks}
513    \textcolor{keywordflow}{for}(i = 0; i < buffer->\hyperlink{structNetBuffer_a43ab1f87d0236d4e01c19ff14f899618}{chunkCount} && \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0; i++)
514    \{
515       \textcolor{comment}{//Is there any data to process in the current chunk?}
516       \textcolor{keywordflow}{if}(offset < buffer->chunk[i].\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
517       \{
518          \textcolor{comment}{//Point to the first data byte}
519          p = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) buffer->\hyperlink{structNetBuffer_a5d399f3f37224030dcac9c4da3ca41eb}{chunk}[i].\hyperlink{structChunkDesc_a014aac6efdc5722e058a9b67ca5f8358}{address} + \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset};
520          \textcolor{comment}{//Compute the number of bytes to process}
521          n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(buffer->\hyperlink{structNetBuffer_a5d399f3f37224030dcac9c4da3ca41eb}{chunk}[i].\hyperlink{structChunkDesc_a4bdd57a9363511126fe5cd6d30c51c81}{length} - \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset}, length);
522          \textcolor{comment}{//Adjust byte counter}
523          length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
524 
525          \textcolor{comment}{//Process current chunk}
526          \textcolor{keywordflow}{while}(n > 0)
527          \{
528 \textcolor{preprocessor}{#if (ETH\_FAST\_CRC\_SUPPORT == ENABLED)}
529             \textcolor{comment}{//The message is processed byte by byte}
530             crc = (crc >> 8) ^ \hyperlink{ethernet__misc_8c_ae50df6f0f3567b27f3f957baa92216ca}{crc32Table}[(crc & 0xFF) ^ *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}];
531 \textcolor{preprocessor}{#else}
532             \textcolor{comment}{//Update CRC value}
533             crc ^= *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
534 
535             \textcolor{comment}{//The message is processed bit by bit}
536             \textcolor{keywordflow}{for}(k = 0; k < 8; k++)
537             \{
538                \textcolor{keywordflow}{if}(crc & 0x00000001)
539                   crc = (crc >> 1) ^ 0xEDB88320;
540                \textcolor{keywordflow}{else}
541                   crc = crc >> 1;
542             \}
543 \textcolor{preprocessor}{#endif}
544             \textcolor{comment}{//Next byte}
545             p++;
546             n--;
547          \}
548 
549          \textcolor{comment}{//Process the next block from the start}
550          \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} = 0;
551       \}
552       \textcolor{keywordflow}{else}
553       \{
554          \textcolor{comment}{//Skip the current chunk}
555          \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} -= buffer->\hyperlink{structNetBuffer_a5d399f3f37224030dcac9c4da3ca41eb}{chunk}[i].\hyperlink{structChunkDesc_a4bdd57a9363511126fe5cd6d30c51c81}{length};
556       \}
557    \}
558 
559    \textcolor{comment}{//Return 1's complement value}
560    \textcolor{keywordflow}{return} ~crc;
561 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a516450f33b1c15e3648a75e0141cac22}\label{ethernet__misc_8h_a516450f33b1c15e3648a75e0141cac22}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Check\+Crc@{eth\+Check\+Crc}}
\index{eth\+Check\+Crc@{eth\+Check\+Crc}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Check\+Crc()}{ethCheckCrc()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eth\+Check\+Crc (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{frame,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Ethernet C\+RC verification. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em frame} & Pointer to the received Ethernet frame \\
\hline
\mbox{\tt in}  & {\em length} & Length of the frame, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 572 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
574 \{
575    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} crc;
576 
577    \textcolor{comment}{//Malformed Ethernet frame?}
578    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < (\textcolor{keyword}{sizeof}(\hyperlink{ethernet_8h_a431dfb940d831c1426e2f13891116519}{EthHeader}) + \hyperlink{ethernet_8h_a6be302136e0434536d049406760485b1}{ETH\_CRC\_SIZE}))
579    \{
580       \textcolor{comment}{//Drop the received frame}
581       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
582    \}
583 
584    \textcolor{comment}{//CRC verification not supported by hardware?}
585    \textcolor{keywordflow}{if}(!interface->nicDriver->autoCrcVerif)
586    \{
587       \textcolor{comment}{//The value of the residue is 0x2144DF1C when no CRC errors}
588       \textcolor{comment}{//are detected}
589       \textcolor{keywordflow}{if}(\hyperlink{ethernet__misc_8c_adf186ad9e87b20cf9c8940e43dd9fea8}{ethCalcCrc}(frame, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}) != 0x2144DF1C)
590       \{
591          \textcolor{comment}{//Drop the received frame}
592          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca15c9ff8d015de6399f5862746f6656e2}{ERROR\_WRONG\_CHECKSUM};
593       \}
594    \}
595 
596    \textcolor{comment}{//Retrieve CRC value}
597    crc = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(frame + \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - \hyperlink{ethernet_8h_a6be302136e0434536d049406760485b1}{ETH\_CRC\_SIZE});
598    \textcolor{comment}{//Reseed the pseudo-random number generator}
599    \hyperlink{net_8c_a4ea5894937acf76289c0cb2ab1e06f9e}{netInitRand}(crc);
600 
601    \textcolor{comment}{//Successful CRC verification}
602    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
603 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a80b44da0541051f314be19c7e63a2ce0}\label{ethernet__misc_8h_a80b44da0541051f314be19c7e63a2ce0}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Check\+Dest\+Addr@{eth\+Check\+Dest\+Addr}}
\index{eth\+Check\+Dest\+Addr@{eth\+Check\+Dest\+Addr}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Check\+Dest\+Addr()}{ethCheckDestAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eth\+Check\+Dest\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$}]{mac\+Addr }\end{DoxyParamCaption})}



Destination M\+AC address filtering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em mac\+Addr} & Destination M\+AC address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 261 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
262 \{
263    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
264    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
265    \hyperlink{structMacFilterEntry}{MacFilterEntry} *entry;
266    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *logicalInterface;
267 
268    \textcolor{comment}{//Filter out any invalid addresses}
269    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
270 
271    \textcolor{comment}{//Point to the logical interface}
272    logicalInterface = \hyperlink{nic_8c_a650d776d6513c3bb88671c3aedd782f0}{nicGetLogicalInterface}(interface);
273 
274    \textcolor{comment}{//Interface MAC address?}
275    \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a800d9f928930baf027e925976c44b9b2}{macCompAddr}(macAddr, &logicalInterface->macAddr))
276    \{
277       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
278    \}
279    \textcolor{comment}{//Broadcast address?}
280    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a800d9f928930baf027e925976c44b9b2}{macCompAddr}(macAddr, &\hyperlink{ethernet_8c_ae1313f9f72de49c713dea514e09ae0e3}{MAC\_BROADCAST\_ADDR}))
281    \{
282       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
283    \}
284    \textcolor{comment}{//Multicast address?}
285    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a039998d9b03dc52280cda15b57d88cb3}{macIsMulticastAddr}(macAddr))
286    \{
287       \textcolor{comment}{//Go through the MAC filter table}
288       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ethernet_8h_ab64acae68b5723774fa272c62efd7c2b}{MAC\_ADDR\_FILTER\_SIZE}; i++)
289       \{
290          \textcolor{comment}{//Point to the current entry}
291          entry = &interface->macAddrFilter[i];
292 
293          \textcolor{comment}{//Valid entry?}
294          \textcolor{keywordflow}{if}(entry->\hyperlink{structMacFilterEntry_a4a1195d4086f58ef57862fa43551e73a}{refCount} > 0)
295          \{
296             \textcolor{comment}{//Check whether the destination MAC address matches}
297             \textcolor{comment}{//a relevant multicast address}
298             \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a800d9f928930baf027e925976c44b9b2}{macCompAddr}(&entry->\hyperlink{structMacFilterEntry_a30caa211d6cc1bb2416165526a2ab6cb}{addr}, macAddr))
299             \{
300                \textcolor{comment}{//The MAC address is acceptable}
301                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
302                \textcolor{comment}{//Stop immediately}
303                \textcolor{keywordflow}{break};
304             \}
305          \}
306       \}
307    \}
308 
309    \textcolor{comment}{//Return status code}
310    \textcolor{keywordflow}{return} error;
311 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_ae418db17934113d25154e41b47689fd3}\label{ethernet__misc_8h_ae418db17934113d25154e41b47689fd3}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Decode\+Vlan\+Tag@{eth\+Decode\+Vlan\+Tag}}
\index{eth\+Decode\+Vlan\+Tag@{eth\+Decode\+Vlan\+Tag}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Decode\+Vlan\+Tag()}{ethDecodeVlanTag()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eth\+Decode\+Vlan\+Tag (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{frame,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$}]{vlan\+Id,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$}]{type }\end{DoxyParamCaption})}



V\+L\+AN tag deccoding. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em frame} & Pointer to the received Ethernet frame \\
\hline
\mbox{\tt in}  & {\em length} & Length of the frame, in bytes \\
\hline
\mbox{\tt out}  & {\em vlan\+Id} & V\+L\+AN identifier \\
\hline
\mbox{\tt out}  & {\em type} & Ethernet type \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 225 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
227 \{
228    \hyperlink{ethernet_8h_ae83b165278ec9105643c370c300f0436}{VlanTag} *vlanTag;
229 
230    \textcolor{comment}{//Malformed Ethernet frame?}
231    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ethernet_8h_ae83b165278ec9105643c370c300f0436}{VlanTag}))
232    \{
233       \textcolor{comment}{//Drop the received frame}
234       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
235    \}
236 
237    \textcolor{comment}{//Point to the VLAN tag}
238    vlanTag = (\hyperlink{ethernet_8h_ae83b165278ec9105643c370c300f0436}{VlanTag} *) frame;
239 
240    \textcolor{comment}{//The VID is encoded in a 12-bit field. The null VID indicates that the}
241    \textcolor{comment}{//tag header contains only priority information (refer to IEEE 802.1q,}
242    \textcolor{comment}{//section 9.6)}
243    *vlanId = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(vlanTag->tci) & \hyperlink{ethernet_8h_aed074544b771eb808f1cd02a9f3c8b46}{VLAN\_VID\_MASK};
244 
245    \textcolor{comment}{//The EtherType field indicates which protocol is encapsulated in the}
246    \textcolor{comment}{//payload}
247    *\hyperlink{resource__manager_8h_a12e46a33bfe90638e58ef067c6fd4a6e}{type} = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(vlanTag->type);
248 
249    \textcolor{comment}{//Successful processing}
250    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
251 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a0124b663f82423d4e4decf61e742419b}\label{ethernet__misc_8h_a0124b663f82423d4e4decf61e742419b}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Encode\+Vlan\+Tag@{eth\+Encode\+Vlan\+Tag}}
\index{eth\+Encode\+Vlan\+Tag@{eth\+Encode\+Vlan\+Tag}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Encode\+Vlan\+Tag()}{ethEncodeVlanTag()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eth\+Encode\+Vlan\+Tag (\begin{DoxyParamCaption}\item[{\hyperlink{structNetBuffer}{Net\+Buffer} $\ast$}]{buffer,  }\item[{size\+\_\+t $\ast$}]{offset,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{vlan\+Id,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{type }\end{DoxyParamCaption})}



V\+L\+AN tag encoding. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buffer} & Multi-\/part buffer containing the payload \\
\hline
\mbox{\tt in,out}  & {\em offset} & Offset to the first payload byte \\
\hline
\mbox{\tt in}  & {\em vlan\+Id} & V\+L\+AN identifier \\
\hline
\mbox{\tt in}  & {\em type} & Ethernet type \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 190 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
192 \{
193    \hyperlink{ethernet_8h_ae83b165278ec9105643c370c300f0436}{VlanTag} *vlanTag;
194 
195    \textcolor{comment}{//Sanity check}
196    \textcolor{keywordflow}{if}(*\hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} < \textcolor{keyword}{sizeof}(\hyperlink{ethernet_8h_ae83b165278ec9105643c370c300f0436}{VlanTag}))
197       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
198 
199    \textcolor{comment}{//Make room for the VLAN tag}
200    *\hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} -= \textcolor{keyword}{sizeof}(\hyperlink{ethernet_8h_ae83b165278ec9105643c370c300f0436}{VlanTag});
201    \textcolor{comment}{//Point to the VLAN tag}
202    vlanTag = \hyperlink{net__mem_8c_a20d30c9db547b3b2743368b589cf482b}{netBufferAt}(buffer, *\hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset});
203 
204    \textcolor{comment}{//The TCI field is divided into PCP, DEI, and VID}
205    vlanTag->tci = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(vlanId);
206 
207    \textcolor{comment}{//The EtherType field indicates which protocol is encapsulated in the}
208    \textcolor{comment}{//payload}
209    vlanTag->type = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(\hyperlink{resource__manager_8h_a12e46a33bfe90638e58ef067c6fd4a6e}{type});
210 
211    \textcolor{comment}{//Successful processing}
212    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
213 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a5335a5d9048656a2448d9c43477e2915}\label{ethernet__misc_8h_a5335a5d9048656a2448d9c43477e2915}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Pad\+Frame@{eth\+Pad\+Frame}}
\index{eth\+Pad\+Frame@{eth\+Pad\+Frame}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Pad\+Frame()}{ethPadFrame()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} eth\+Pad\+Frame (\begin{DoxyParamCaption}\item[{\hyperlink{structNetBuffer}{Net\+Buffer} $\ast$}]{buffer,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}



Ethernet frame padding. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buffer} & Multi-\/part buffer containing the Ethernet frame \\
\hline
\mbox{\tt in,out}  & {\em length} & Length of the Ethernet frame, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 149 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
150 \{
151    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
152    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
153 
154    \textcolor{comment}{//Ethernet frames have a minimum length of 64 byte}
155    \textcolor{keywordflow}{if}(*\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < (\hyperlink{ethernet_8h_a8ec3ce465132401b12ea5409b14bea92}{ETH\_MIN\_FRAME\_SIZE} - \hyperlink{ethernet_8h_a6be302136e0434536d049406760485b1}{ETH\_CRC\_SIZE}))
156    \{
157       \textcolor{comment}{//Add padding as necessary}
158       n = (\hyperlink{ethernet_8h_a8ec3ce465132401b12ea5409b14bea92}{ETH\_MIN\_FRAME\_SIZE} - \hyperlink{ethernet_8h_a6be302136e0434536d049406760485b1}{ETH\_CRC\_SIZE}) - *
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
159 
160       \textcolor{comment}{//Append padding bytes}
161       error = \hyperlink{net__mem_8c_aceae1188a93321e1d4daed11bb8005df}{netBufferAppend}(buffer, \hyperlink{ethernet__misc_8c_ade727849dd0a05220a66bf870c0a201f}{ethPadding}, n);
162 
163       \textcolor{comment}{//Check status code}
164       \textcolor{keywordflow}{if}(!error)
165       \{
166          \textcolor{comment}{//Adjust frame length}
167          *\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
168       \}
169    \}
170    \textcolor{keywordflow}{else}
171    \{
172       \textcolor{comment}{//No padding needed}
173       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
174    \}
175 
176    \textcolor{comment}{//Return status code}
177    \textcolor{keywordflow}{return} error;
178 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a0478aefa56bfc5d10a3046062a5464d6}\label{ethernet__misc_8h_a0478aefa56bfc5d10a3046062a5464d6}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Update\+Error\+Stats@{eth\+Update\+Error\+Stats}}
\index{eth\+Update\+Error\+Stats@{eth\+Update\+Error\+Stats}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Update\+Error\+Stats()}{ethUpdateErrorStats()}}
{\footnotesize\ttfamily void eth\+Update\+Error\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t}}]{error }\end{DoxyParamCaption})}



Update Ethernet error statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em error} & Status code describing the error \\
\hline
\end{DoxyParams}


Definition at line 401 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
402 \{
403    \textcolor{comment}{//Check error code}
404    \textcolor{keywordflow}{switch}(error)
405    \{
406    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS}:
407    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER}:
408       \textcolor{comment}{//Number of inbound packets which were chosen to be discarded even}
409       \textcolor{comment}{//though no errors had been detected}
410       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifInDiscards, 1);
411       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifTable[interface->index].ifInDiscards, 1);
412       \textcolor{keywordflow}{break};
413    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH}:
414    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca15c9ff8d015de6399f5862746f6656e2}{ERROR\_WRONG\_CHECKSUM}:
415       \textcolor{comment}{//Number of inbound packets that contained errors}
416       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifInErrors, 1);
417       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifTable[interface->index].ifInErrors, 1);
418       \textcolor{keywordflow}{break};
419    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca5a1904e109856f036391fa141fc8b5b3}{ERROR\_INVALID\_PROTOCOL}:
420       \textcolor{comment}{//Number of packets received via the interface which were discarded}
421       \textcolor{comment}{//because of an unknown or unsupported protocol}
422       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifInUnknownProtos, 1);
423       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifTable[interface->index].ifInUnknownProtos, 1);
424       \textcolor{keywordflow}{break};
425    \textcolor{keywordflow}{default}:
426       \textcolor{comment}{//Just for sanity}
427       \textcolor{keywordflow}{break};
428    \}
429 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_acd6a284456dd8a9e7a21e3fce3711f3b}\label{ethernet__misc_8h_acd6a284456dd8a9e7a21e3fce3711f3b}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Update\+In\+Stats@{eth\+Update\+In\+Stats}}
\index{eth\+Update\+In\+Stats@{eth\+Update\+In\+Stats}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Update\+In\+Stats()}{ethUpdateInStats()}}
{\footnotesize\ttfamily void eth\+Update\+In\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$}]{dest\+Mac\+Addr }\end{DoxyParamCaption})}



Update Ethernet input statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Mac\+Addr} & Destination M\+AC address \\
\hline
\end{DoxyParams}


Definition at line 320 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
321 \{
322    \textcolor{comment}{//Check whether the destination address is a unicast, broadcast or multicast address}
323    \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a800d9f928930baf027e925976c44b9b2}{macCompAddr}(destMacAddr, &\hyperlink{ethernet_8c_ae1313f9f72de49c713dea514e09ae0e3}{MAC\_BROADCAST\_ADDR}))
324    \{
325       \textcolor{comment}{//Number of non-unicast packets delivered to a higher-layer protocol}
326       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifInNUcastPkts, 1);
327 
328       \textcolor{comment}{//Number of broadcast packets delivered to a higher-layer protocol}
329       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifXTable[interface->index].ifInBroadcastPkts, 1);
330       \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCInBroadcastPkts, 1);
331    \}
332    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a039998d9b03dc52280cda15b57d88cb3}{macIsMulticastAddr}(destMacAddr))
333    \{
334       \textcolor{comment}{//Number of non-unicast packets delivered to a higher-layer protocol}
335       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifInNUcastPkts, 1);
336 
337       \textcolor{comment}{//Number of multicast packets delivered to a higher-layer protocol}
338       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifXTable[interface->index].ifInMulticastPkts, 1);
339       \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCInMulticastPkts, 1);
340    \}
341    \textcolor{keywordflow}{else}
342    \{
343       \textcolor{comment}{//Number of unicast packets delivered to a higher-layer protocol}
344       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifInUcastPkts, 1);
345       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifTable[interface->index].ifInUcastPkts, 1);
346       \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCInUcastPkts, 1);
347    \}
348 \}
\end{DoxyCode}
\mbox{\Hypertarget{ethernet__misc_8h_a567573a40fd60c02c187b48c3e715d55}\label{ethernet__misc_8h_a567573a40fd60c02c187b48c3e715d55}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Update\+Out\+Stats@{eth\+Update\+Out\+Stats}}
\index{eth\+Update\+Out\+Stats@{eth\+Update\+Out\+Stats}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Update\+Out\+Stats()}{ethUpdateOutStats()}}
{\footnotesize\ttfamily void eth\+Update\+Out\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$}]{dest\+Mac\+Addr,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update Ethernet output statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Mac\+Addr} & Destination M\+AC address \\
\hline
\mbox{\tt in}  & {\em length} & Length of the Ethernet frame, in bytes \\
\hline
\end{DoxyParams}


Definition at line 358 of file ethernet\+\_\+misc.\+c.


\begin{DoxyCode}
360 \{
361    \textcolor{comment}{//Total number of octets transmitted out of the interface}
362    \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
363    \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifTable[interface->index].ifOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
364    \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
365 
366    \textcolor{comment}{//Check whether the destination address is a unicast, broadcast or multicast address}
367    \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a800d9f928930baf027e925976c44b9b2}{macCompAddr}(destMacAddr, &\hyperlink{ethernet_8c_ae1313f9f72de49c713dea514e09ae0e3}{MAC\_BROADCAST\_ADDR}))
368    \{
369       \textcolor{comment}{//Number of non-unicast packets that higher-level protocols requested be transmitted}
370       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifOutNUcastPkts, 1);
371 
372       \textcolor{comment}{//Number of broadcast packets that higher-level protocols requested be transmitted}
373       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifXTable[interface->index].ifOutBroadcastPkts, 1);
374       \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCOutBroadcastPkts, 1);
375    \}
376    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a039998d9b03dc52280cda15b57d88cb3}{macIsMulticastAddr}(destMacAddr))
377    \{
378       \textcolor{comment}{//Number of non-unicast packets that higher-level protocols requested be transmitted}
379       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifOutNUcastPkts, 1);
380 
381       \textcolor{comment}{//Number of multicast packets that higher-level protocols requested be transmitted}
382       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifXTable[interface->index].ifOutMulticastPkts, 1);
383       \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCOutMulticastPkts, 1);
384    \}
385    \textcolor{keywordflow}{else}
386    \{
387       \textcolor{comment}{//Number of unicast packets that higher-level protocols requested be transmitted}
388       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ifGroup.ifTable[interface->index].ifOutUcastPkts, 1);
389       \hyperlink{if__mib__module_8h_a0e07279ae5b68d07360596c9e0e57434}{IF\_MIB\_INC\_COUNTER32}(ifTable[interface->index].ifOutUcastPkts, 1);
390       \hyperlink{if__mib__module_8h_a90c0dc3fec6404a807c39d628473ffd4}{IF\_MIB\_INC\_COUNTER64}(ifXTable[interface->index].ifHCOutUcastPkts, 1);
391    \}
392 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{ethernet__misc_8h_ade727849dd0a05220a66bf870c0a201f}\label{ethernet__misc_8h_ade727849dd0a05220a66bf870c0a201f}} 
\index{ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}!eth\+Padding@{eth\+Padding}}
\index{eth\+Padding@{eth\+Padding}!ethernet\+\_\+misc.\+h@{ethernet\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{eth\+Padding}{ethPadding}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} eth\+Padding\mbox{[}64\mbox{]}}



Definition at line 56 of file ethernet\+\_\+misc.\+c.

