\hypertarget{mpi_8c}{}\section{cyclone\+\_\+crypto/mpi/mpi.c File Reference}
\label{mpi_8c}\index{cyclone\+\_\+crypto/mpi/mpi.\+c@{cyclone\+\_\+crypto/mpi/mpi.\+c}}


M\+PI (Multiple Precision Integer Arithmetic)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mpi/mpi.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mpi_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpi\+Init} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r})
\begin{DoxyCompactList}\small\item\em Initialize a multiple precision integer. \end{DoxyCompactList}\item 
void \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpi\+Free} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r})
\begin{DoxyCompactList}\small\item\em Release a multiple precision integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpi\+Grow} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} size)
\begin{DoxyCompactList}\small\item\em Adjust the size of multiple precision integer. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpi\+Get\+Length} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Get the actual length in words. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpi\+Get\+Byte\+Length} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Get the actual length in bytes. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpi\+Get\+Bit\+Length} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Get the actual length in bits. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpi\+Set\+Bit\+Value} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} index, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Set the bit value at the specified index. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpi\+Get\+Bit\+Value} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} index)
\begin{DoxyCompactList}\small\item\em Get the bit value at the specified index. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpi\+Comp} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compare two multiple precision integers. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpi\+Comp\+Int} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compare a multiple precision integer with an integer. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}{mpi\+Comp\+Abs} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compare the absolute value of two multiple precision integers. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpi\+Copy} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Copy a multiple precision integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpi\+Set\+Value} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Set the value of a multiple precision integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a9753c7bf919b7c41e48512ba572c3bbb}{mpi\+Rand} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context)
\begin{DoxyCompactList}\small\item\em Generate a random value. \end{DoxyCompactList}\item 
\+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ad89f0bcea9a7d43aba86eabc74ea8a28}{mpi\+Check\+Probable\+Prime} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Test whether a number is probable prime. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpi\+Import} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337f}{Mpi\+Format} format)
\begin{DoxyCompactList}\small\item\em Octet string to integer conversion. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_aad846b0b5a3560243e1bf8601ad1b6a5}{mpi\+Export} (const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337f}{Mpi\+Format} format)
\begin{DoxyCompactList}\small\item\em Integer to octet string conversion. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}{mpi\+Add} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Multiple precision addition. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a6a109fc4369fd532596a72fe4f296978}{mpi\+Add\+Int} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Add an integer to a multiple precision integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpi\+Sub} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Multiple precision subtraction. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a77f0e675dfb77c89650dee4c39561891}{mpi\+Sub\+Int} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Subtract an integer from a multiple precision integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a797880ba43b70ac3de9a85448352c2d7}{mpi\+Add\+Abs} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Helper routine for multiple precision addition. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpi\+Sub\+Abs} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Helper routine for multiple precision subtraction. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}{mpi\+Shift\+Left} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
\begin{DoxyCompactList}\small\item\em Left shift operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a550a7330971d895957015b810b25c805}{mpi\+Shift\+Right} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
\begin{DoxyCompactList}\small\item\em Right shift operation. \end{DoxyCompactList}\item 
\+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ab569712730a9f92397577952e8b76195}{mpi\+Mul} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Multiple precision multiplication. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a795a312d2fb3e06ebaad41ec73be720d}{mpi\+Mul\+Int} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Multiply a multiple precision integer by an integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a5a17de8c3a761f2a5e0dfa0c95045f7b}{mpi\+Div} (\hyperlink{structMpi}{Mpi} $\ast$q, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Multiple precision division. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a94e269d841bb3f3c8df56b1689aa9efb}{mpi\+Div\+Int} (\hyperlink{structMpi}{Mpi} $\ast$q, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Divide a multiple precision integer by an integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpi\+Mod} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})
\begin{DoxyCompactList}\small\item\em Modulo operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a3b74ec289f433703fc3f2b9438314779}{mpi\+Add\+Mod} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})
\begin{DoxyCompactList}\small\item\em Modular addition. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a221d32159642449acd2971bbcd93d6dc}{mpi\+Sub\+Mod} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})
\begin{DoxyCompactList}\small\item\em Modular subtraction. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpi\+Mul\+Mod} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})
\begin{DoxyCompactList}\small\item\em Modular multiplication. \end{DoxyCompactList}\item 
\+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_afc1dd8761f7c1ab83117f4300c3b1ac1}{mpi\+Inv\+Mod} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})
\begin{DoxyCompactList}\small\item\em Modular inverse. \end{DoxyCompactList}\item 
\+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ac87e0f68f127213d7b66ecdf570ecc0e}{mpi\+Exp\+Mod} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$e, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p})
\begin{DoxyCompactList}\small\item\em Modular exponentiation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpi\+Montgomery\+Mul} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t})
\begin{DoxyCompactList}\small\item\em Montgomery multiplication. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mpi_8c_ac7026f0f0b151cfe9b70539ab5609e3d}{mpi\+Montgomery\+Red} (\hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{sha512_8c_a3934111e8801bd86b261f4bac043efa6}{k}, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t})
\begin{DoxyCompactList}\small\item\em Montgomery reduction. \end{DoxyCompactList}\item 
void \hyperlink{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}{mpi\+Mul\+Acc\+Core} (\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}, const \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Multiply-\/accumulate operation. \end{DoxyCompactList}\item 
void \hyperlink{mpi_8c_ab19a888d464742a542cf3d759137289c}{mpi\+Dump} (F\+I\+LE $\ast$stream, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$prepend, const \hyperlink{structMpi}{Mpi} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Display the contents of a multiple precision integer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
M\+PI (Multiple Precision Integer Arithmetic) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{mpi_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{mpi_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{mpi.\+c@{mpi.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file mpi.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}\label{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Add@{mpi\+Add}}
\index{mpi\+Add@{mpi\+Add}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Add()}{mpiAdd()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Add (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Multiple precision addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A + B \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 696 of file mpi.\+c.


\begin{DoxyCode}
697 \{
698    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
699    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} sign;
700 
701    \textcolor{comment}{//Retrieve the sign of A}
702    sign = a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
703 
704    \textcolor{comment}{//Both operands have the same sign?}
705    \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} == b->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign})
706    \{
707       \textcolor{comment}{//Perform addition}
708       error = \hyperlink{mpi_8c_a797880ba43b70ac3de9a85448352c2d7}{mpiAddAbs}(r, a, b);
709       \textcolor{comment}{//Set the sign of the resulting number}
710       r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = sign;
711    \}
712    \textcolor{comment}{//Operands have different signs?}
713    \textcolor{keywordflow}{else}
714    \{
715       \textcolor{comment}{//Compare the absolute value of A and B}
716       \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}{mpiCompAbs}(a, b) >= 0)
717       \{
718          \textcolor{comment}{//Perform subtraction}
719          error = \hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpiSubAbs}(r, a, b);
720          \textcolor{comment}{//Set the sign of the resulting number}
721          r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = sign;
722       \}
723       \textcolor{keywordflow}{else}
724       \{
725          \textcolor{comment}{//Perform subtraction}
726          error = \hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpiSubAbs}(r, b, a);
727          \textcolor{comment}{//Set the sign of the resulting number}
728          r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = -sign;
729       \}
730    \}
731 
732    \textcolor{comment}{//Return status code}
733    \textcolor{keywordflow}{return} error;
734 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a797880ba43b70ac3de9a85448352c2d7}\label{mpi_8c_a797880ba43b70ac3de9a85448352c2d7}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Add\+Abs@{mpi\+Add\+Abs}}
\index{mpi\+Add\+Abs@{mpi\+Add\+Abs}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Add\+Abs()}{mpiAddAbs()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Add\+Abs (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Helper routine for multiple precision addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = $\vert$A + B$\vert$ \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 842 of file mpi.\+c.


\begin{DoxyCode}
843 \{
844    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
845    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
846    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
847    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
848    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} d;
849 
850    \textcolor{comment}{//R and B are the same instance?}
851    \textcolor{keywordflow}{if}(r == b)
852    \{
853       \textcolor{comment}{//Swap A and B}
854       \textcolor{keyword}{const} \hyperlink{structMpi}{Mpi} *\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t} = \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
855       a = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
856       b = \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
857    \}
858    \textcolor{comment}{//R is neither A nor B?}
859    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(r != a)
860    \{
861       \textcolor{comment}{//Copy the first operand to R}
862       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(r, a));
863    \}
864 
865    \textcolor{comment}{//Determine the actual length of B}
866    n = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(b);
867    \textcolor{comment}{//Extend the size of the destination register as needed}
868    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, n));
869 
870    \textcolor{comment}{//The result is always positive}
871    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
872    \textcolor{comment}{//Clear carry bit}
873    c = 0;
874 
875    \textcolor{comment}{//Add operands}
876    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
877    \{
878       \textcolor{comment}{//Add carry bit}
879       d = r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] + \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
880       \textcolor{comment}{//Update carry bit}
881       \textcolor{keywordflow}{if}(d != 0) c = 0;
882       \textcolor{comment}{//Perform addition}
883       d += b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i];
884       \textcolor{comment}{//Update carry bit}
885       \textcolor{keywordflow}{if}(d < b->\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[i]) c = 1;
886       \textcolor{comment}{//Save result}
887       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = d;
888    \}
889 
890    \textcolor{comment}{//Loop as long as the carry bit is set}
891    \textcolor{keywordflow}{for}(i = n; c && i < r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size}; i++)
892    \{
893       \textcolor{comment}{//Add carry bit}
894       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] += \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
895       \textcolor{comment}{//Update carry bit}
896       \textcolor{keywordflow}{if}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] != 0) c = 0;
897    \}
898 
899    \textcolor{comment}{//Check the final carry bit}
900    \textcolor{keywordflow}{if}(c && n >= r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
901    \{
902       \textcolor{comment}{//Extend the size of the destination register}
903       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, n + 1));
904       \textcolor{comment}{//Add carry bit}
905       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = 1;
906    \}
907 
908 end:
909    \textcolor{comment}{//Return status code}
910    \textcolor{keywordflow}{return} error;
911 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a6a109fc4369fd532596a72fe4f296978}\label{mpi_8c_a6a109fc4369fd532596a72fe4f296978}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Add\+Int@{mpi\+Add\+Int}}
\index{mpi\+Add\+Int@{mpi\+Add\+Int}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Add\+Int()}{mpiAddInt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Add\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{b }\end{DoxyParamCaption})}



Add an integer to a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A + B \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 745 of file mpi.\+c.


\begin{DoxyCode}
746 \{
747    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
748    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
749 
750    \textcolor{comment}{//Convert the second operand to a multiple precision integer}
751    value = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} : -\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
752    t.\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? 1 : -1;
753    t.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 1;
754    t.\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
755 
756    \textcolor{comment}{//Perform addition}
757    \textcolor{keywordflow}{return} \hyperlink{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}{mpiAdd}(r, a, &t);
758 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a3b74ec289f433703fc3f2b9438314779}\label{mpi_8c_a3b74ec289f433703fc3f2b9438314779}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Add\+Mod@{mpi\+Add\+Mod}}
\index{mpi\+Add\+Mod@{mpi\+Add\+Mod}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Add\+Mod()}{mpiAddMod()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Add\+Mod (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p }\end{DoxyParamCaption})}



Modular addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A + B mod P \\
\hline
\mbox{\tt in}  & {\em a} & The first operand A \\
\hline
\mbox{\tt in}  & {\em b} & The second operand B \\
\hline
\mbox{\tt in}  & {\em p} & The modulus P \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1390 of file mpi.\+c.


\begin{DoxyCode}
1391 \{
1392    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1393 
1394    \textcolor{comment}{//Perform modular addition}
1395    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}{mpiAdd}(r, a, b));
1396    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(r, r, p));
1397 
1398 end:
1399    \textcolor{comment}{//Return status code}
1400    \textcolor{keywordflow}{return} error;
1401 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ad89f0bcea9a7d43aba86eabc74ea8a28}\label{mpi_8c_ad89f0bcea9a7d43aba86eabc74ea8a28}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Check\+Probable\+Prime@{mpi\+Check\+Probable\+Prime}}
\index{mpi\+Check\+Probable\+Prime@{mpi\+Check\+Probable\+Prime}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Check\+Probable\+Prime()}{mpiCheckProbablePrime()}}
{\footnotesize\ttfamily \+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Check\+Probable\+Prime (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a }\end{DoxyParamCaption})}



Test whether a number is probable prime. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 514 of file mpi.\+c.


\begin{DoxyCode}
515 \{
516    \textcolor{comment}{//The algorithm is implemented by hardware}
517    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
518 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}\label{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Comp@{mpi\+Comp}}
\index{mpi\+Comp@{mpi\+Comp}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Comp()}{mpiComp()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} mpi\+Comp (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Compare two multiple precision integers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & The first multiple precision integer to be compared \\
\hline
\mbox{\tt in}  & {\em b} & The second multiple precision integer to be compared \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Comparison result 
\end{DoxyReturn}


Definition at line 295 of file mpi.\+c.


\begin{DoxyCode}
296 \{
297    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
298    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
299 
300    \textcolor{comment}{//Determine the actual length of A and B}
301    m = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(a);
302    n = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(b);
303 
304    \textcolor{comment}{//Compare lengths}
305    \textcolor{keywordflow}{if}(!m && !n)
306       \textcolor{keywordflow}{return} 0;
307    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(m > n)
308       \textcolor{keywordflow}{return} a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
309    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(m < n)
310       \textcolor{keywordflow}{return} -b->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
311 
312    \textcolor{comment}{//Compare signs}
313    \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} > 0 && b->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} < 0)
314       \textcolor{keywordflow}{return} 1;
315    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} < 0 && b->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} > 0)
316       \textcolor{keywordflow}{return} -1;
317 
318    \textcolor{comment}{//Then compare values}
319    \textcolor{keywordflow}{while}(n--)
320    \{
321       \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n] > b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n])
322          \textcolor{keywordflow}{return} a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
323       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n] < b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n])
324          \textcolor{keywordflow}{return} -a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
325    \}
326 
327    \textcolor{comment}{//Multiple precision integers are equals}
328    \textcolor{keywordflow}{return} 0;
329 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}\label{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Comp\+Abs@{mpi\+Comp\+Abs}}
\index{mpi\+Comp\+Abs@{mpi\+Comp\+Abs}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Comp\+Abs()}{mpiCompAbs()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} mpi\+Comp\+Abs (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Compare the absolute value of two multiple precision integers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & The first multiple precision integer to be compared \\
\hline
\mbox{\tt in}  & {\em b} & The second multiple precision integer to be compared \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Comparison result 
\end{DoxyReturn}


Definition at line 362 of file mpi.\+c.


\begin{DoxyCode}
363 \{
364    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
365    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
366 
367    \textcolor{comment}{//Determine the actual length of A and B}
368    m = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(a);
369    n = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(b);
370 
371    \textcolor{comment}{//Compare lengths}
372    \textcolor{keywordflow}{if}(!m && !n)
373       \textcolor{keywordflow}{return} 0;
374    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(m > n)
375       \textcolor{keywordflow}{return} 1;
376    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(m < n)
377       \textcolor{keywordflow}{return} -1;
378 
379    \textcolor{comment}{//Then compare values}
380    \textcolor{keywordflow}{while}(n--)
381    \{
382       \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n] > b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n])
383          \textcolor{keywordflow}{return} 1;
384       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n] < b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n])
385          \textcolor{keywordflow}{return} -1;
386    \}
387 
388    \textcolor{comment}{//Operands are equals}
389    \textcolor{keywordflow}{return} 0;
390 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}\label{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Comp\+Int@{mpi\+Comp\+Int}}
\index{mpi\+Comp\+Int@{mpi\+Comp\+Int}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Comp\+Int()}{mpiCompInt()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} mpi\+Comp\+Int (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{b }\end{DoxyParamCaption})}



Compare a multiple precision integer with an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Multiple precision integer to be compared \\
\hline
\mbox{\tt in}  & {\em b} & Integer to be compared \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Comparison result 
\end{DoxyReturn}


Definition at line 339 of file mpi.\+c.


\begin{DoxyCode}
340 \{
341    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
342    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
343 
344    \textcolor{comment}{//Initialize a temporary multiple precision integer}
345    value = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} : -\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
346    t.\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? 1 : -1;
347    t.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 1;
348    t.\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
349 
350    \textcolor{comment}{//Return comparison result}
351    \textcolor{keywordflow}{return} \hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(a, &t);
352 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}\label{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Copy@{mpi\+Copy}}
\index{mpi\+Copy@{mpi\+Copy}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Copy()}{mpiCopy()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Copy (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a }\end{DoxyParamCaption})}



Copy a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Pointer to a multiple precision integer (destination) \\
\hline
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer (source) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 400 of file mpi.\+c.


\begin{DoxyCode}
401 \{
402    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
403    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
404 
405    \textcolor{comment}{//R and A are the same instance?}
406    \textcolor{keywordflow}{if}(r == a)
407       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
408 
409    \textcolor{comment}{//Determine the actual length of A}
410    n = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(a);
411 
412    \textcolor{comment}{//Ajust the size of the destination operand}
413    error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, n);
414    \textcolor{comment}{//Any error to report?}
415    \textcolor{keywordflow}{if}(error)
416       \textcolor{keywordflow}{return} error;
417 
418    \textcolor{comment}{//Clear the contents of the multiple precision integer}
419    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
420    \textcolor{comment}{//Let R = A}
421    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, n * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
422    \textcolor{comment}{//Set the sign of R}
423    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
424 
425    \textcolor{comment}{//Successful operation}
426    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
427 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a5a17de8c3a761f2a5e0dfa0c95045f7b}\label{mpi_8c_a5a17de8c3a761f2a5e0dfa0c95045f7b}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Div@{mpi\+Div}}
\index{mpi\+Div@{mpi\+Div}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Div()}{mpiDiv()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Div (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{q,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Multiple precision division. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em q} & The quotient Q = A / B \\
\hline
\mbox{\tt out}  & {\em r} & The remainder R = A mod B \\
\hline
\mbox{\tt in}  & {\em a} & The dividend A \\
\hline
\mbox{\tt in}  & {\em b} & The divisor B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1234 of file mpi.\+c.


\begin{DoxyCode}
1235 \{
1236    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1237    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1238    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1239    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1240    \hyperlink{structMpi}{Mpi} d;
1241    \hyperlink{structMpi}{Mpi} e;
1242 
1243    \textcolor{comment}{//Check whether the divisor is equal to zero}
1244    \textcolor{keywordflow}{if}(!\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(b, 0))
1245       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1246 
1247    \textcolor{comment}{//Initialize multiple precision integers}
1248    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
1249    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&d);
1250    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&e);
1251 
1252    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&c, a));
1253    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&d, b));
1254    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(&e, 0));
1255 
1256    m = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(&c);
1257    n = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(&d);
1258 
1259    \textcolor{keywordflow}{if}(m > n)
1260       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}{mpiShiftLeft}(&d, m - n));
1261 
1262    \textcolor{keywordflow}{while}(n++ <= m)
1263    \{
1264       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}{mpiShiftLeft}(&e, 1));
1265 
1266       \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(&c, &d) >= 0)
1267       \{
1268          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a73007f69c51d65007a8f6df964a069ef}{mpiSetBitValue}(&e, 0, 1));
1269          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpiSub}(&c, &c, &d));
1270       \}
1271 
1272       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a550a7330971d895957015b810b25c805}{mpiShiftRight}(&d, 1));
1273    \}
1274 
1275    \textcolor{keywordflow}{if}(q != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1276       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(q, &e));
1277 
1278    \textcolor{keywordflow}{if}(r != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1279       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(r, &c));
1280 
1281 end:
1282    \textcolor{comment}{//Release previously allocated memory}
1283    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
1284    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&d);
1285    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&e);
1286 
1287    \textcolor{comment}{//Return status code}
1288    \textcolor{keywordflow}{return} error;
1289 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a94e269d841bb3f3c8df56b1689aa9efb}\label{mpi_8c_a94e269d841bb3f3c8df56b1689aa9efb}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Div\+Int@{mpi\+Div\+Int}}
\index{mpi\+Div\+Int@{mpi\+Div\+Int}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Div\+Int()}{mpiDivInt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Div\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{q,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{b }\end{DoxyParamCaption})}



Divide a multiple precision integer by an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em q} & The quotient Q = A / B \\
\hline
\mbox{\tt out}  & {\em r} & The remainder R = A mod B \\
\hline
\mbox{\tt in}  & {\em a} & The dividend A \\
\hline
\mbox{\tt in}  & {\em b} & The divisor B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1301 of file mpi.\+c.


\begin{DoxyCode}
1302 \{
1303    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1304    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
1305 
1306    \textcolor{comment}{//Convert the divisor to a multiple precision integer}
1307    value = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} : -\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
1308    t.\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? 1 : -1;
1309    t.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 1;
1310    t.\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1311 
1312    \textcolor{comment}{//Perform division}
1313    \textcolor{keywordflow}{return} \hyperlink{mpi_8c_a5a17de8c3a761f2a5e0dfa0c95045f7b}{mpiDiv}(q, r, a, &t);
1314 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ab19a888d464742a542cf3d759137289c}\label{mpi_8c_ab19a888d464742a542cf3d759137289c}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Dump@{mpi\+Dump}}
\index{mpi\+Dump@{mpi\+Dump}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Dump()}{mpiDump()}}
{\footnotesize\ttfamily void mpi\+Dump (\begin{DoxyParamCaption}\item[{F\+I\+LE $\ast$}]{stream,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{prepend,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a }\end{DoxyParamCaption})}



Display the contents of a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em stream} & Pointer to a F\+I\+LE object that identifies an output stream \\
\hline
\mbox{\tt in}  & {\em prepend} & String to prepend to the left of each line \\
\hline
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\end{DoxyParams}


Definition at line 1873 of file mpi.\+c.


\begin{DoxyCode}
1874 \{
1875    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1876 
1877    \textcolor{comment}{//Process each word}
1878    \textcolor{keywordflow}{for}(i = 0; i < a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size}; i++)
1879    \{
1880       \textcolor{comment}{//Beginning of a new line?}
1881       \textcolor{keywordflow}{if}(i == 0 || ((a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - i - 1) % 8) == 7)
1882          fprintf(stream, \textcolor{stringliteral}{"%s"}, prepend);
1883 
1884       \textcolor{comment}{//Display current data}
1885       fprintf(stream, \textcolor{stringliteral}{"%08X "}, a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1 - i]);
1886 
1887       \textcolor{comment}{//End of current line?}
1888       \textcolor{keywordflow}{if}(((a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - i - 1) % 8) == 0 || i == (a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1))
1889          fprintf(stream, \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"});
1890    \}
1891 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ac87e0f68f127213d7b66ecdf570ecc0e}\label{mpi_8c_ac87e0f68f127213d7b66ecdf570ecc0e}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Exp\+Mod@{mpi\+Exp\+Mod}}
\index{mpi\+Exp\+Mod@{mpi\+Exp\+Mod}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Exp\+Mod()}{mpiExpMod()}}
{\footnotesize\ttfamily \+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Exp\+Mod (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{e,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p }\end{DoxyParamCaption})}



Modular exponentiation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A $^\wedge$ E mod P \\
\hline
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\mbox{\tt in}  & {\em e} & Exponent \\
\hline
\mbox{\tt in}  & {\em p} & Modulus \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1534 of file mpi.\+c.


\begin{DoxyCode}
1535 \{
1536    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1537    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1538    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} j;
1539    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1540    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} d;
1541    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
1542    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} u;
1543    \hyperlink{structMpi}{Mpi} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
1544    \hyperlink{structMpi}{Mpi} c2;
1545    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
1546    \hyperlink{structMpi}{Mpi} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}[8];
1547 
1548    \textcolor{comment}{//Initialize multiple precision integers}
1549    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&b);
1550    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c2);
1551    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&t);
1552 
1553    \textcolor{comment}{//Initialize precomputed values}
1554    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(s); i++)
1555    \{
1556       \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&s[i]);
1557    \}
1558 
1559    \textcolor{comment}{//Very small exponents are often selected with low Hamming weight.}
1560    \textcolor{comment}{//The sliding window mechanism should be disabled in that case}
1561    d = (\hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(e) <= 32) ? 1 : 4;
1562 
1563    \textcolor{comment}{//Even modulus?}
1564    \textcolor{keywordflow}{if}(\hyperlink{mpi_8h_a53b82ca5e6d72401169ab98f73b9f0e5}{mpiIsEven}(p))
1565    \{
1566       \textcolor{comment}{//Let B = A^2}
1567       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpiMulMod}(&b, a, a, p));
1568       \textcolor{comment}{//Let S[0] = A}
1569       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&s[0], a));
1570 
1571       \textcolor{comment}{//Precompute S[i] = A^(2 * i + 1)}
1572       \textcolor{keywordflow}{for}(i = 1; i < (1 << (d - 1)); i++)
1573       \{
1574          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpiMulMod}(&s[i], &s[i - 1], &b, p));
1575       \}
1576 
1577       \textcolor{comment}{//Let R = 1}
1578       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(r, 1));
1579 
1580       \textcolor{comment}{//The exponent is processed in a left-to-right fashion}
1581       i = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(e) - 1;
1582 
1583       \textcolor{comment}{//Perform sliding window exponentiation}
1584       \textcolor{keywordflow}{while}(i >= 0)
1585       \{
1586          \textcolor{comment}{//The sliding window exponentiation algorithm decomposes E}
1587          \textcolor{comment}{//into zero and nonzero windows}
1588          \textcolor{keywordflow}{if}(!\hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpiGetBitValue}(e, i))
1589          \{
1590             \textcolor{comment}{//Compute R = R^2}
1591             \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpiMulMod}(r, r, r, p));
1592             \textcolor{comment}{//Next bit to be processed}
1593             i--;
1594          \}
1595          \textcolor{keywordflow}{else}
1596          \{
1597             \textcolor{comment}{//Find the longest window}
1598             n = \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(i - d + 1, 0);
1599 
1600             \textcolor{comment}{//The least significant bit of the window must be equal to 1}
1601             \textcolor{keywordflow}{while}(!\hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpiGetBitValue}(e, n)) n++;
1602 
1603             \textcolor{comment}{//The algorithm processes more than one bit per iteration}
1604             \textcolor{keywordflow}{for}(u = 0, j = i; j >= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j--)
1605             \{
1606                \textcolor{comment}{//Compute R = R^2}
1607                \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpiMulMod}(r, r, r, p));
1608                \textcolor{comment}{//Compute the relevant index to be used in the precomputed table}
1609                u = (u << 1) | \hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpiGetBitValue}(e, j);
1610             \}
1611 
1612             \textcolor{comment}{//Perform a single multiplication per iteration}
1613             \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab94435373793a664364ccd91dbd808b7}{mpiMulMod}(r, r, &s[u >> 1], p));
1614             \textcolor{comment}{//Next bit to be processed}
1615             i = n - 1;
1616          \}
1617       \}
1618    \}
1619    \textcolor{keywordflow}{else}
1620    \{
1621       \textcolor{comment}{//Compute the smaller C = (2^32)^k such as C > P}
1622       k = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(p);
1623 
1624       \textcolor{comment}{//Compute C^2 mod P}
1625       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(&c2, 1));
1626       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}{mpiShiftLeft}(&c2, 2 * k * (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8)));
1627       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(&c2, &c2, p));
1628 
1629       \textcolor{comment}{//Let B = A * C mod P}
1630       \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(a, p) >= 0)
1631       \{
1632          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(&b, a, p));
1633          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(&b, &b, &c2, k, p, &t));
1634       \}
1635       \textcolor{keywordflow}{else}
1636       \{
1637          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(&b, a, &c2, k, p, &t));
1638       \}
1639 
1640       \textcolor{comment}{//Let R = B^2 * C^-1 mod P}
1641       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(r, &b, &b, k, p, &t));
1642       \textcolor{comment}{//Let S[0] = B}
1643       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&s[0], &b));
1644 
1645       \textcolor{comment}{//Precompute S[i] = B^(2 * i + 1) * C^-1 mod P}
1646       \textcolor{keywordflow}{for}(i = 1; i < (1 << (d - 1)); i++)
1647       \{
1648          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(&s[i], &s[i - 1], r, k, p, &t));
1649       \}
1650 
1651       \textcolor{comment}{//Let R = C mod P}
1652       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(r, &c2));
1653       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac7026f0f0b151cfe9b70539ab5609e3d}{mpiMontgomeryRed}(r, r, k, p, &t));
1654 
1655       \textcolor{comment}{//The exponent is processed in a left-to-right fashion}
1656       i = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(e) - 1;
1657 
1658       \textcolor{comment}{//Perform sliding window exponentiation}
1659       \textcolor{keywordflow}{while}(i >= 0)
1660       \{
1661          \textcolor{comment}{//The sliding window exponentiation algorithm decomposes E}
1662          \textcolor{comment}{//into zero and nonzero windows}
1663          \textcolor{keywordflow}{if}(!\hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpiGetBitValue}(e, i))
1664          \{
1665             \textcolor{comment}{//Compute R = R^2 * C^-1 mod P}
1666             \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(r, r, r, k, p, &t));
1667             \textcolor{comment}{//Next bit to be processed}
1668             i--;
1669          \}
1670          \textcolor{keywordflow}{else}
1671          \{
1672             \textcolor{comment}{//Find the longest window}
1673             n = \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(i - d + 1, 0);
1674 
1675             \textcolor{comment}{//The least significant bit of the window must be equal to 1}
1676             \textcolor{keywordflow}{while}(!\hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpiGetBitValue}(e, n)) n++;
1677 
1678             \textcolor{comment}{//The algorithm processes more than one bit per iteration}
1679             \textcolor{keywordflow}{for}(u = 0, j = i; j >= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j--)
1680             \{
1681                \textcolor{comment}{//Compute R = R^2 * C^-1 mod P}
1682                \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(r, r, r, k, p, &t));
1683                \textcolor{comment}{//Compute the relevant index to be used in the precomputed table}
1684                u = (u << 1) | \hyperlink{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}{mpiGetBitValue}(e, j);
1685             \}
1686 
1687             \textcolor{comment}{//Compute R = R * T[u/2] * C^-1 mod P}
1688             \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(r, r, &s[u >> 1], k, p, &t));
1689             \textcolor{comment}{//Next bit to be processed}
1690             i = n - 1;
1691          \}
1692       \}
1693 
1694       \textcolor{comment}{//Compute R = R * C^-1 mod P}
1695       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac7026f0f0b151cfe9b70539ab5609e3d}{mpiMontgomeryRed}(r, r, k, p, &t));
1696    \}
1697 
1698 end:
1699    \textcolor{comment}{//Release multiple precision integers}
1700    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&b);
1701    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c2);
1702    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&t);
1703 
1704    \textcolor{comment}{//Release precomputed values}
1705    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(s); i++)
1706    \{
1707       \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&s[i]);
1708    \}
1709 
1710    \textcolor{comment}{//Return status code}
1711    \textcolor{keywordflow}{return} error;
1712 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_aad846b0b5a3560243e1bf8601ad1b6a5}\label{mpi_8c_aad846b0b5a3560243e1bf8601ad1b6a5}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Export@{mpi\+Export}}
\index{mpi\+Export@{mpi\+Export}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Export()}{mpiExport()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Export (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{length,  }\item[{\hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337f}{Mpi\+Format}}]{format }\end{DoxyParamCaption})}



Integer to octet string conversion. 

Converts an integer to an octet string of a specified length


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Non-\/negative integer to be converted \\
\hline
\mbox{\tt out}  & {\em data} & Octet string resulting from the conversion \\
\hline
\mbox{\tt in}  & {\em length} & Intended length of the resulting octet string \\
\hline
\mbox{\tt in}  & {\em format} & Output format \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 618 of file mpi.\+c.


\begin{DoxyCode}
619 \{
620    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
621    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
622    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
623 
624    \textcolor{comment}{//Initialize status code}
625    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
626 
627    \textcolor{comment}{//Check input format}
628    \textcolor{keywordflow}{if}(format == \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa637c0a6e803a47db52875c6818674c60}{MPI\_FORMAT\_LITTLE\_ENDIAN})
629    \{
630       \textcolor{comment}{//Get the actual length in bytes}
631       n = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(a);
632 
633       \textcolor{comment}{//Make sure the output buffer is large enough}
634       \textcolor{keywordflow}{if}(n <= \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
635       \{
636          \textcolor{comment}{//Clear output buffer}
637          \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 0, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
638 
639          \textcolor{comment}{//Export data}
640          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}++)
641          \{
642             *\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i / \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}] >> ((i % 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}) * 8);
643          \}
644       \}
645       \textcolor{keywordflow}{else}
646       \{
647          \textcolor{comment}{//Report an error}
648          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
649       \}
650    \}
651    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(format == \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN})
652    \{
653       \textcolor{comment}{//Get the actual length in bytes}
654       n = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(a);
655 
656       \textcolor{comment}{//Make sure the output buffer is large enough}
657       \textcolor{keywordflow}{if}(n <= \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
658       \{
659          \textcolor{comment}{//Clear output buffer}
660          \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 0, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
661 
662          \textcolor{comment}{//Point to the least significant word}
663          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - 1;
664 
665          \textcolor{comment}{//Export data}
666          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}--)
667          \{
668             *\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i / \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}] >> ((i % 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}) * 8);
669          \}
670       \}
671       \textcolor{keywordflow}{else}
672       \{
673          \textcolor{comment}{//Report an error}
674          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
675       \}
676    \}
677    \textcolor{keywordflow}{else}
678    \{
679       \textcolor{comment}{//Report an error}
680       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
681    \}
682 
683    \textcolor{comment}{//Return status code}
684    \textcolor{keywordflow}{return} error;
685 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}\label{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Free@{mpi\+Free}}
\index{mpi\+Free@{mpi\+Free}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Free()}{mpiFree()}}
{\footnotesize\ttfamily void mpi\+Free (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r }\end{DoxyParamCaption})}



Release a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em r} & Pointer to the multiple precision integer to be freed \\
\hline
\end{DoxyParams}


Definition at line 62 of file mpi.\+c.


\begin{DoxyCode}
63 \{
64    \textcolor{comment}{//Any memory previously allocated?}
65    \textcolor{keywordflow}{if}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
66    \{
67       \textcolor{comment}{//Erase contents before releasing memory}
68       \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
69       \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data});
70    \}
71 
72    \textcolor{comment}{//Set size to zero}
73    r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 0;
74    r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
75 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}\label{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Get\+Bit\+Length@{mpi\+Get\+Bit\+Length}}
\index{mpi\+Get\+Bit\+Length@{mpi\+Get\+Bit\+Length}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Get\+Bit\+Length()}{mpiGetBitLength()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} mpi\+Get\+Bit\+Length (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a }\end{DoxyParamCaption})}



Get the actual length in bits. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The actual bit count 
\end{DoxyReturn}


Definition at line 195 of file mpi.\+c.


\begin{DoxyCode}
196 \{
197    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
198    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
199 
200    \textcolor{comment}{//Check whether the specified multiple precision integer is empty}
201    \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} == 0)
202       \textcolor{keywordflow}{return} 0;
203 
204    \textcolor{comment}{//Start from the most significant word}
205    \textcolor{keywordflow}{for}(n = a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1; n > 0; n--)
206    \{
207       \textcolor{comment}{//Loop as long as the current word is zero}
208       \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n] != 0)
209          \textcolor{keywordflow}{break};
210    \}
211 
212    \textcolor{comment}{//Get the current word}
213    m = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}];
214    \textcolor{comment}{//Convert the length to a bit count}
215    n *= \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8;
216 
217    \textcolor{comment}{//Adjust the bit count}
218    \textcolor{keywordflow}{for}(; m != 0; m >>= 1)
219    \{
220       n++;
221    \}
222 
223    \textcolor{comment}{//Return the actual length in bits}
224    \textcolor{keywordflow}{return} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
225 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}\label{mpi_8c_ad62c1f7143a1cc46b080bea217f20ede}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Get\+Bit\+Value@{mpi\+Get\+Bit\+Value}}
\index{mpi\+Get\+Bit\+Value@{mpi\+Get\+Bit\+Value}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Get\+Bit\+Value()}{mpiGetBitValue()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} mpi\+Get\+Bit\+Value (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{index }\end{DoxyParamCaption})}



Get the bit value at the specified index. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\mbox{\tt in}  & {\em index} & Position where to read the bit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The actual bit value 
\end{DoxyReturn}


Definition at line 270 of file mpi.\+c.


\begin{DoxyCode}
271 \{
272    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n1;
273    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n2;
274 
275    \textcolor{comment}{//Retrieve the position of the bit to be read}
276    n1 = index / (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
277    n2 = index % (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
278 
279    \textcolor{comment}{//Index out of range?}
280    \textcolor{keywordflow}{if}(n1 >= a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
281       \textcolor{keywordflow}{return} 0;
282 
283    \textcolor{comment}{//Return the actual bit value}
284    \textcolor{keywordflow}{return} (a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n1] >> n2) & 0x01;
285 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}\label{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Get\+Byte\+Length@{mpi\+Get\+Byte\+Length}}
\index{mpi\+Get\+Byte\+Length@{mpi\+Get\+Byte\+Length}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Get\+Byte\+Length()}{mpiGetByteLength()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} mpi\+Get\+Byte\+Length (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a }\end{DoxyParamCaption})}



Get the actual length in bytes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The actual byte count 
\end{DoxyReturn}


Definition at line 156 of file mpi.\+c.


\begin{DoxyCode}
157 \{
158    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
159    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
160 
161    \textcolor{comment}{//Check whether the specified multiple precision integer is empty}
162    \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} == 0)
163       \textcolor{keywordflow}{return} 0;
164 
165    \textcolor{comment}{//Start from the most significant word}
166    \textcolor{keywordflow}{for}(n = a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1; n > 0; n--)
167    \{
168       \textcolor{comment}{//Loop as long as the current word is zero}
169       \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n] != 0)
170          \textcolor{keywordflow}{break};
171    \}
172 
173    \textcolor{comment}{//Get the current word}
174    m = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}];
175    \textcolor{comment}{//Convert the length to a byte count}
176    n *= \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE};
177 
178    \textcolor{comment}{//Adjust the byte count}
179    \textcolor{keywordflow}{for}(; m != 0; m >>= 8)
180    \{
181       n++;
182    \}
183 
184    \textcolor{comment}{//Return the actual length in bytes}
185    \textcolor{keywordflow}{return} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
186 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}\label{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Get\+Length@{mpi\+Get\+Length}}
\index{mpi\+Get\+Length@{mpi\+Get\+Length}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Get\+Length()}{mpiGetLength()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} mpi\+Get\+Length (\begin{DoxyParamCaption}\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a }\end{DoxyParamCaption})}



Get the actual length in words. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to a multiple precision integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The actual length in words 
\end{DoxyReturn}


Definition at line 129 of file mpi.\+c.


\begin{DoxyCode}
130 \{
131    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
132 
133    \textcolor{comment}{//Check whether the specified multiple precision integer is empty}
134    \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} == 0)
135       \textcolor{keywordflow}{return} 0;
136 
137    \textcolor{comment}{//Start from the most significant word}
138    \textcolor{keywordflow}{for}(i = a->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1; i >= 0; i--)
139    \{
140       \textcolor{comment}{//Loop as long as the current word is zero}
141       \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] != 0)
142          \textcolor{keywordflow}{break};
143    \}
144 
145    \textcolor{comment}{//Return the actual length}
146    \textcolor{keywordflow}{return} i + 1;
147 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}\label{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Grow@{mpi\+Grow}}
\index{mpi\+Grow@{mpi\+Grow}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Grow()}{mpiGrow()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Grow (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{size }\end{DoxyParamCaption})}



Adjust the size of multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em r} & A multiple precision integer whose size is to be increased \\
\hline
\mbox{\tt in}  & {\em size} & Desired size in words \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 85 of file mpi.\+c.


\begin{DoxyCode}
86 \{
87    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} *\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
88 
89    \textcolor{comment}{//Ensure the parameter is valid}
90    size = \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(size, 1);
91 
92    \textcolor{comment}{//Check the current size}
93    \textcolor{keywordflow}{if}(r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} >= size)
94       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
95 
96    \textcolor{comment}{//Allocate a memory buffer}
97    data = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(size * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
98    \textcolor{comment}{//Failed to allocate memory?}
99    \textcolor{keywordflow}{if}(data == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
100       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
101 
102    \textcolor{comment}{//Clear buffer contents}
103    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(data, 0, size * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
104 
105    \textcolor{comment}{//Any data to copy?}
106    \textcolor{keywordflow}{if}(r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} > 0)
107    \{
108       \textcolor{comment}{//Copy original data}
109       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(data, r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
110       \textcolor{comment}{//Free previously allocated memory}
111       \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data});
112    \}
113 
114    \textcolor{comment}{//Update the size of the multiple precision integer}
115    r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = size;
116    r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
117 
118    \textcolor{comment}{//Successful operation}
119    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
120 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a844d59498f4acce9d69ae55570b521f3}\label{mpi_8c_a844d59498f4acce9d69ae55570b521f3}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Import@{mpi\+Import}}
\index{mpi\+Import@{mpi\+Import}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Import()}{mpiImport()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Import (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{length,  }\item[{\hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337f}{Mpi\+Format}}]{format }\end{DoxyParamCaption})}



Octet string to integer conversion. 

Converts an octet string to a non-\/negative integer


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Non-\/negative integer resulting from the conversion \\
\hline
\mbox{\tt in}  & {\em data} & Octet string to be converted \\
\hline
\mbox{\tt in}  & {\em length} & Length of the octet string \\
\hline
\mbox{\tt in}  & {\em format} & Input format \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 533 of file mpi.\+c.


\begin{DoxyCode}
534 \{
535    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
536    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
537 
538    \textcolor{comment}{//Check input format}
539    \textcolor{keywordflow}{if}(format == \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa637c0a6e803a47db52875c6818674c60}{MPI\_FORMAT\_LITTLE\_ENDIAN})
540    \{
541       \textcolor{comment}{//Skip trailing zeroes}
542       \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0 && \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - 1] == 0)
543       \{
544          \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}--;
545       \}
546 
547       \textcolor{comment}{//Ajust the size of the multiple precision integer}
548       error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, (\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} + \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} - 1) / 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
549 
550       \textcolor{comment}{//Check status code}
551       \textcolor{keywordflow}{if}(!error)
552       \{
553          \textcolor{comment}{//Clear the contents of the multiple precision integer}
554          \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
555          \textcolor{comment}{//Set sign}
556          r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
557 
558          \textcolor{comment}{//Import data}
559          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}++)
560          \{
561             r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i / \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}] |= *\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} << ((i % 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}) * 8);
562          \}
563       \}
564    \}
565    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(format == \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN})
566    \{
567       \textcolor{comment}{//Skip leading zeroes}
568       \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 1 && *\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} == 0)
569       \{
570          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}++;
571          \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}--;
572       \}
573 
574       \textcolor{comment}{//Ajust the size of the multiple precision integer}
575       error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, (\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} + \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} - 1) / 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
576 
577       \textcolor{comment}{//Check status code}
578       \textcolor{keywordflow}{if}(!error)
579       \{
580          \textcolor{comment}{//Clear the contents of the multiple precision integer}
581          \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
582          \textcolor{comment}{//Set sign}
583          r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
584 
585          \textcolor{comment}{//Start from the least significant byte}
586          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - 1;
587 
588          \textcolor{comment}{//Import data}
589          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}--)
590          \{
591             r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i / \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}] |= *\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} << ((i % 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE}) * 8);
592          \}
593       \}
594    \}
595    \textcolor{keywordflow}{else}
596    \{
597       \textcolor{comment}{//Report an error}
598       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
599    \}
600 
601    \textcolor{comment}{//Return status code}
602    \textcolor{keywordflow}{return} error;
603 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}\label{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Init@{mpi\+Init}}
\index{mpi\+Init@{mpi\+Init}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Init()}{mpiInit()}}
{\footnotesize\ttfamily void mpi\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r }\end{DoxyParamCaption})}



Initialize a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em r} & Pointer to the multiple precision integer to be initialized \\
\hline
\end{DoxyParams}


Definition at line 48 of file mpi.\+c.


\begin{DoxyCode}
49 \{
50    \textcolor{comment}{//Initialize structure}
51    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
52    r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 0;
53    r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
54 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_afc1dd8761f7c1ab83117f4300c3b1ac1}\label{mpi_8c_afc1dd8761f7c1ab83117f4300c3b1ac1}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Inv\+Mod@{mpi\+Inv\+Mod}}
\index{mpi\+Inv\+Mod@{mpi\+Inv\+Mod}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Inv\+Mod()}{mpiInvMod()}}
{\footnotesize\ttfamily \+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Inv\+Mod (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p }\end{DoxyParamCaption})}



Modular inverse. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A$^\wedge$-\/1 mod P \\
\hline
\mbox{\tt in}  & {\em a} & The multiple precision integer A \\
\hline
\mbox{\tt in}  & {\em p} & The modulus P \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1458 of file mpi.\+c.


\begin{DoxyCode}
1459 \{
1460    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1461    \hyperlink{structMpi}{Mpi} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
1462    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1463    \hyperlink{structMpi}{Mpi} q0;
1464    \hyperlink{structMpi}{Mpi} r0;
1465    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
1466    \hyperlink{structMpi}{Mpi} u;
1467    \hyperlink{structMpi}{Mpi} v;
1468 
1469    \textcolor{comment}{//Initialize multiple precision integers}
1470    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&b);
1471    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
1472    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&q0);
1473    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&r0);
1474    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&t);
1475    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&u);
1476    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&v);
1477 
1478    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&b, p));
1479    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&c, a));
1480    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(&u, 0));
1481    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(&v, 1));
1482 
1483    \textcolor{keywordflow}{while}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(&c, 0) > 0)
1484    \{
1485       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a5a17de8c3a761f2a5e0dfa0c95045f7b}{mpiDiv}(&q0, &r0, &b, &c));
1486 
1487       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&b, &c));
1488       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&c, &r0));
1489 
1490       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&t, &v));
1491       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab569712730a9f92397577952e8b76195}{mpiMul}(&q0, &q0, &v));
1492       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpiSub}(&v, &u, &q0));
1493       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&u, &t));
1494    \}
1495 
1496    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(&b, 1))
1497    \{
1498       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE});
1499    \}
1500 
1501    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(&u, 0) > 0)
1502    \{
1503       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(r, &u));
1504    \}
1505    \textcolor{keywordflow}{else}
1506    \{
1507       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_abd7700302eaf9c1a7929b0d4362f43a5}{mpiAdd}(r, &u, p));
1508    \}
1509 
1510 end:
1511    \textcolor{comment}{//Release previously allocated memory}
1512    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&b);
1513    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
1514    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&q0);
1515    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&r0);
1516    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&t);
1517    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&u);
1518    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&v);
1519 
1520    \textcolor{comment}{//Return status code}
1521    \textcolor{keywordflow}{return} error;
1522 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}\label{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Mod@{mpi\+Mod}}
\index{mpi\+Mod@{mpi\+Mod}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Mod()}{mpiMod()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Mod (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p }\end{DoxyParamCaption})}



Modulo operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A mod P \\
\hline
\mbox{\tt in}  & {\em a} & The multiple precision integer to be reduced \\
\hline
\mbox{\tt in}  & {\em p} & The modulus P \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1325 of file mpi.\+c.


\begin{DoxyCode}
1326 \{
1327    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1328    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} sign;
1329    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1330    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1331    \hyperlink{structMpi}{Mpi} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1332 
1333    \textcolor{comment}{//Make sure the modulus is positive}
1334    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(p, 0) <= 0)
1335       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1336 
1337    \textcolor{comment}{//Initialize multiple precision integer}
1338    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&c);
1339 
1340    \textcolor{comment}{//Save the sign of A}
1341    sign = a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
1342    \textcolor{comment}{//Determine the actual length of A}
1343    m = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(a);
1344    \textcolor{comment}{//Determine the actual length of P}
1345    n = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(p);
1346 
1347    \textcolor{comment}{//Let R = A}
1348    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(r, a));
1349 
1350    \textcolor{keywordflow}{if}(m >= n)
1351    \{
1352       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&c, p));
1353       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}{mpiShiftLeft}(&c, m - n));
1354 
1355       \textcolor{keywordflow}{while}(\hyperlink{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}{mpiCompAbs}(r, p) >= 0)
1356       \{
1357          \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}{mpiCompAbs}(r, &c) >= 0)
1358          \{
1359             \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpiSubAbs}(r, r, &c));
1360          \}
1361 
1362          \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a550a7330971d895957015b810b25c805}{mpiShiftRight}(&c, 1));
1363       \}
1364    \}
1365 
1366    \textcolor{keywordflow}{if}(sign < 0)
1367    \{
1368       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpiSubAbs}(r, p, r));
1369    \}
1370 
1371 end:
1372    \textcolor{comment}{//Release previously allocated memory}
1373    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&c);
1374 
1375    \textcolor{comment}{//Return status code}
1376    \textcolor{keywordflow}{return} error;
1377 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a465761406fc69a9665f447914bc7853f}\label{mpi_8c_a465761406fc69a9665f447914bc7853f}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Montgomery\+Mul@{mpi\+Montgomery\+Mul}}
\index{mpi\+Montgomery\+Mul@{mpi\+Montgomery\+Mul}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Montgomery\+Mul()}{mpiMontgomeryMul()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Montgomery\+Mul (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{k,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{t }\end{DoxyParamCaption})}



Montgomery multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A $\ast$ B / 2$^\wedge$k mod P \\
\hline
\mbox{\tt in}  & {\em a} & An integer A such as 0 $<$= A $<$ 2$^\wedge$k \\
\hline
\mbox{\tt in}  & {\em b} & An integer B such as 0 $<$= B $<$ 2$^\wedge$k \\
\hline
\mbox{\tt in}  & {\em k} & An integer k such as P $<$ 2$^\wedge$k \\
\hline
\mbox{\tt in}  & {\em p} & Modulus P \\
\hline
\mbox{\tt in}  & {\em t} & An preallocated integer T (for internal operation) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1726 of file mpi.\+c.


\begin{DoxyCode}
1728 \{
1729    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1730    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1731    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1732    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1733    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} q;
1734 
1735    \textcolor{comment}{//Use Newton's method to compute the inverse of P[0] mod 2^32}
1736    \textcolor{keywordflow}{for}(m = 2 - p->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[0], i = 0; i < 4; i++)
1737    \{
1738       m = m * (2 - m * p->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[0]);
1739    \}
1740 
1741    \textcolor{comment}{//Precompute -1/P[0] mod 2^32;}
1742    m = ~m + 1;
1743 
1744    \textcolor{comment}{//We assume that B is always less than 2^k}
1745    n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(b->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size}, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k});
1746 
1747    \textcolor{comment}{//Make sure T is large enough}
1748    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(t, 2 * \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} + 1));
1749    \textcolor{comment}{//Let T = 0}
1750    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(t, 0));
1751 
1752    \textcolor{comment}{//Perform Montgomery multiplication}
1753    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}; i++)
1754    \{
1755       \textcolor{comment}{//Check current index}
1756       \textcolor{keywordflow}{if}(i < a->size)
1757       \{
1758          \textcolor{comment}{//Compute q = ((T[i] + A[i] * B[0]) * m) mod 2^32}
1759          q = (t->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] + a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] * b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[0]) * m;
1760          \textcolor{comment}{//Compute T = T + A[i] * B}
1761          \hyperlink{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}{mpiMulAccCore}(t->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} + i, b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, n, a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i]);
1762       \}
1763       \textcolor{keywordflow}{else}
1764       \{
1765          \textcolor{comment}{//Compute q = (T[i] * m) mod 2^32}
1766          q = t->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] * \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1767       \}
1768 
1769       \textcolor{comment}{//Compute T = T + q * P}
1770       \hyperlink{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}{mpiMulAccCore}(t->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} + i, p->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, k, q);
1771    \}
1772 
1773    \textcolor{comment}{//Compute R = T / 2^(32 * k)}
1774    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a550a7330971d895957015b810b25c805}{mpiShiftRight}(t, k * (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8)));
1775    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(r, t));
1776 
1777    \textcolor{comment}{//A final subtraction is required}
1778    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(r, p) >= 0)
1779    \{
1780       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpiSub}(r, r, p));
1781    \}
1782 
1783 end:
1784    \textcolor{comment}{//Return status code}
1785    \textcolor{keywordflow}{return} error;
1786 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ac7026f0f0b151cfe9b70539ab5609e3d}\label{mpi_8c_ac7026f0f0b151cfe9b70539ab5609e3d}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Montgomery\+Red@{mpi\+Montgomery\+Red}}
\index{mpi\+Montgomery\+Red@{mpi\+Montgomery\+Red}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Montgomery\+Red()}{mpiMontgomeryRed()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Montgomery\+Red (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{k,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{t }\end{DoxyParamCaption})}



Montgomery reduction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A / 2$^\wedge$k mod P \\
\hline
\mbox{\tt in}  & {\em a} & An integer A such as 0 $<$= A $<$ 2$^\wedge$k \\
\hline
\mbox{\tt in}  & {\em k} & An integer k such as P $<$ 2$^\wedge$k \\
\hline
\mbox{\tt in}  & {\em p} & Modulus P \\
\hline
\mbox{\tt in}  & {\em t} & An preallocated integer T (for internal operation) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1799 of file mpi.\+c.


\begin{DoxyCode}
1800 \{
1801    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1802    \hyperlink{structMpi}{Mpi} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
1803 
1804    \textcolor{comment}{//Let B = 1}
1805    value = 1;
1806    b.\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
1807    b.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 1;
1808    b.\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1809 
1810    \textcolor{comment}{//Compute R = A / 2^k mod P}
1811    \textcolor{keywordflow}{return} \hyperlink{mpi_8c_a465761406fc69a9665f447914bc7853f}{mpiMontgomeryMul}(r, a, &b, \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k}, p, t);
1812 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ab569712730a9f92397577952e8b76195}\label{mpi_8c_ab569712730a9f92397577952e8b76195}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Mul@{mpi\+Mul}}
\index{mpi\+Mul@{mpi\+Mul}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Mul()}{mpiMul()}}
{\footnotesize\ttfamily \+\_\+\+\_\+weak \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Mul (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Multiple precision multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A $\ast$ B \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1132 of file mpi.\+c.


\begin{DoxyCode}
1133 \{
1134    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1135    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1136    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1137    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1138    \hyperlink{structMpi}{Mpi} ta;
1139    \hyperlink{structMpi}{Mpi} tb;
1140 
1141    \textcolor{comment}{//Initialize multiple precision integers}
1142    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&ta);
1143    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&tb);
1144 
1145    \textcolor{comment}{//R and A are the same instance?}
1146    \textcolor{keywordflow}{if}(r == a)
1147    \{
1148       \textcolor{comment}{//Copy A to TA}
1149       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&ta, a));
1150       \textcolor{comment}{//Use TA instead of A}
1151       a = &ta;
1152    \}
1153 
1154    \textcolor{comment}{//R and B are the same instance?}
1155    \textcolor{keywordflow}{if}(r == b)
1156    \{
1157       \textcolor{comment}{//Copy B to TB}
1158       \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a30e6f6e9d6916d0bbe24d8b19559ac7f}{mpiCopy}(&tb, b));
1159       \textcolor{comment}{//Use TB instead of B}
1160       b = &tb;
1161    \}
1162 
1163    \textcolor{comment}{//Determine the actual length of A and B}
1164    m = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(a);
1165    n = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(b);
1166 
1167    \textcolor{comment}{//Adjust the size of R}
1168    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, m + n));
1169    \textcolor{comment}{//Set the sign of R}
1170    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} == b->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign}) ? 1 : -1;
1171 
1172    \textcolor{comment}{//Clear the contents of the destination integer}
1173    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
1174 
1175    \textcolor{comment}{//Perform multiplication}
1176    \textcolor{keywordflow}{if}(m < n)
1177    \{
1178       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}; i++)
1179       \{
1180          \hyperlink{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}{mpiMulAccCore}(&r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i], b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, n, a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i]);
1181       \}
1182    \}
1183    \textcolor{keywordflow}{else}
1184    \{
1185       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
1186       \{
1187          \hyperlink{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}{mpiMulAccCore}(&r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i], a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, m, b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i]);
1188       \}
1189    \}
1190 
1191 end:
1192    \textcolor{comment}{//Release multiple precision integers}
1193    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&ta);
1194    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&tb);
1195 
1196    \textcolor{comment}{//Return status code}
1197    \textcolor{keywordflow}{return} error;
1198 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}\label{mpi_8c_ab8b9c5ffac4266759fb8e35c3c6c7f0d}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Mul\+Acc\+Core@{mpi\+Mul\+Acc\+Core}}
\index{mpi\+Mul\+Acc\+Core@{mpi\+Mul\+Acc\+Core}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Mul\+Acc\+Core()}{mpiMulAccCore()}}
{\footnotesize\ttfamily void mpi\+Mul\+Acc\+Core (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{m,  }\item[{const \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{b }\end{DoxyParamCaption})}



Multiply-\/accumulate operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em m} & Size of A in words \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}


Definition at line 1825 of file mpi.\+c.


\begin{DoxyCode}
1826 \{
1827    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1828    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1829    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u;
1830    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} v;
1831    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1832 
1833    \textcolor{comment}{//Clear variables}
1834    c = 0;
1835    u = 0;
1836    v = 0;
1837 
1838    \textcolor{comment}{//Perform multiplication}
1839    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}; i++)
1840    \{
1841       p = (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
1842       u = (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) p;
1843       v = (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) (p >> 32);
1844 
1845       u += \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1846       \textcolor{keywordflow}{if}(u < c) v++;
1847 
1848       u += \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i];
1849       \textcolor{keywordflow}{if}(u < \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i]) v++;
1850 
1851       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = u;
1852       c = v;
1853    \}
1854 
1855    \textcolor{comment}{//Propagate carry}
1856    \textcolor{keywordflow}{for}(; c != 0; i++)
1857    \{
1858       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] += \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
1859       c = (\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] < \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c});
1860    \}
1861 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a795a312d2fb3e06ebaad41ec73be720d}\label{mpi_8c_a795a312d2fb3e06ebaad41ec73be720d}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Mul\+Int@{mpi\+Mul\+Int}}
\index{mpi\+Mul\+Int@{mpi\+Mul\+Int}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Mul\+Int()}{mpiMulInt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Mul\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{b }\end{DoxyParamCaption})}



Multiply a multiple precision integer by an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A $\ast$ B \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1209 of file mpi.\+c.


\begin{DoxyCode}
1210 \{
1211    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1212    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
1213 
1214    \textcolor{comment}{//Convert the second operand to a multiple precision integer}
1215    value = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} : -\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
1216    t.\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? 1 : -1;
1217    t.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 1;
1218    t.\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1219 
1220    \textcolor{comment}{//Perform multiplication}
1221    \textcolor{keywordflow}{return} \hyperlink{mpi_8c_ab569712730a9f92397577952e8b76195}{mpiMul}(r, a, &t);
1222 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_ab94435373793a664364ccd91dbd808b7}\label{mpi_8c_ab94435373793a664364ccd91dbd808b7}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Mul\+Mod@{mpi\+Mul\+Mod}}
\index{mpi\+Mul\+Mod@{mpi\+Mul\+Mod}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Mul\+Mod()}{mpiMulMod()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Mul\+Mod (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p }\end{DoxyParamCaption})}



Modular multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A $\ast$ B mod P \\
\hline
\mbox{\tt in}  & {\em a} & The first operand A \\
\hline
\mbox{\tt in}  & {\em b} & The second operand B \\
\hline
\mbox{\tt in}  & {\em p} & The modulus P \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1436 of file mpi.\+c.


\begin{DoxyCode}
1437 \{
1438    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1439 
1440    \textcolor{comment}{//Perform modular multiplication}
1441    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ab569712730a9f92397577952e8b76195}{mpiMul}(r, a, b));
1442    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(r, r, p));
1443 
1444 end:
1445    \textcolor{comment}{//Return status code}
1446    \textcolor{keywordflow}{return} error;
1447 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a9753c7bf919b7c41e48512ba572c3bbb}\label{mpi_8c_a9753c7bf919b7c41e48512ba572c3bbb}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Rand@{mpi\+Rand}}
\index{mpi\+Rand@{mpi\+Rand}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Rand()}{mpiRand()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Rand (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{length,  }\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context }\end{DoxyParamCaption})}



Generate a random value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Pointer to a multiple precision integer \\
\hline
\mbox{\tt in}  & {\em length} & Desired length in bits \\
\hline
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 468 of file mpi.\+c.


\begin{DoxyCode}
470 \{
471    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
472    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
473    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
474 
475    \textcolor{comment}{//Compute the required length, in words}
476    n = (\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} + (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8) - 1) / (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
477    \textcolor{comment}{//Number of bits in the most significant word}
478    m = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} % (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
479 
480    \textcolor{comment}{//Ajust the size of the multiple precision integer if necessary}
481    error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, n);
482    \textcolor{comment}{//Failed to adjust the size?}
483    \textcolor{keywordflow}{if}(error)
484       \textcolor{keywordflow}{return} error;
485 
486    \textcolor{comment}{//Clear the contents of the multiple precision integer}
487    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
488    \textcolor{comment}{//Set the sign of R}
489    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
490 
491    \textcolor{comment}{//Generate a random pattern}
492    error = prngAlgo->\hyperlink{structPrngAlgo_a079621740ef14faacfcd05b84c9036eb}{read}(prngContext, (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, n * 
      \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
493    \textcolor{comment}{//Any error to report?}
494    \textcolor{keywordflow}{if}(error)
495       \textcolor{keywordflow}{return} error;
496 
497    \textcolor{comment}{//Remove the meaningless bits in the most significant word}
498    \textcolor{keywordflow}{if}(n > 0 && m > 0)
499    \{
500       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n - 1] &= (1 << \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}) - 1;
501    \}
502 
503    \textcolor{comment}{//Successful operation}
504    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
505 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a73007f69c51d65007a8f6df964a069ef}\label{mpi_8c_a73007f69c51d65007a8f6df964a069ef}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Set\+Bit\+Value@{mpi\+Set\+Bit\+Value}}
\index{mpi\+Set\+Bit\+Value@{mpi\+Set\+Bit\+Value}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Set\+Bit\+Value()}{mpiSetBitValue()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Set\+Bit\+Value (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{index,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{value }\end{DoxyParamCaption})}



Set the bit value at the specified index. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em r} & Pointer to a multiple precision integer \\
\hline
\mbox{\tt in}  & {\em index} & Position of the bit to be written \\
\hline
\mbox{\tt in}  & {\em value} & Bit value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 236 of file mpi.\+c.


\begin{DoxyCode}
237 \{
238    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
239    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n1;
240    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n2;
241 
242    \textcolor{comment}{//Retrieve the position of the bit to be written}
243    n1 = index / (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
244    n2 = index % (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
245 
246    \textcolor{comment}{//Ajust the size of the multiple precision integer if necessary}
247    error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, n1 + 1);
248    \textcolor{comment}{//Failed to adjust the size?}
249    \textcolor{keywordflow}{if}(error)
250       \textcolor{keywordflow}{return} error;
251 
252    \textcolor{comment}{//Set bit value}
253    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value})
254       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n1] |= (1 << n2);
255    \textcolor{keywordflow}{else}
256       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[n1] &= ~(1 << n2);
257 
258    \textcolor{comment}{//No error to report}
259    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
260 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}\label{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Set\+Value@{mpi\+Set\+Value}}
\index{mpi\+Set\+Value@{mpi\+Set\+Value}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Set\+Value()}{mpiSetValue()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Set\+Value (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{a }\end{DoxyParamCaption})}



Set the value of a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Pointer to a multiple precision integer \\
\hline
\mbox{\tt in}  & {\em a} & Value to be assigned to the multiple precision integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 437 of file mpi.\+c.


\begin{DoxyCode}
438 \{
439    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
440 
441    \textcolor{comment}{//Ajust the size of the destination operand}
442    error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, 1);
443    \textcolor{comment}{//Failed to adjust the size?}
444    \textcolor{keywordflow}{if}(error)
445       \textcolor{keywordflow}{return} error;
446 
447    \textcolor{comment}{//Clear the contents of the multiple precision integer}
448    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
449    \textcolor{comment}{//Set the value or R}
450    r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[0] = (\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} >= 0) ? \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} : -\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
451    \textcolor{comment}{//Set the sign of R}
452    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} >= 0) ? 1 : -1;
453 
454    \textcolor{comment}{//Successful operation}
455    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
456 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}\label{mpi_8c_a0218e82acd7bc2a0619d1529507a88e3}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Shift\+Left@{mpi\+Shift\+Left}}
\index{mpi\+Shift\+Left@{mpi\+Shift\+Left}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Shift\+Left()}{mpiShiftLeft()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Shift\+Left (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{n }\end{DoxyParamCaption})}



Left shift operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em r} & The multiple precision integer to be shifted to the left \\
\hline
\mbox{\tt in}  & {\em n} & The number of bits to shift \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1012 of file mpi.\+c.


\begin{DoxyCode}
1013 \{
1014    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1015    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1016 
1017    \textcolor{comment}{//Number of 32-bit words to shift}
1018    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n1 = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} / (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
1019    \textcolor{comment}{//Number of bits to shift}
1020    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n2 = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} % (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
1021 
1022    \textcolor{comment}{//Check parameters}
1023    \textcolor{keywordflow}{if}(!r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} || !\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
1024       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1025 
1026    \textcolor{comment}{//Increase the size of the multiple-precision number}
1027    error = \hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} + (\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 31) / 32);
1028    \textcolor{comment}{//Check return code}
1029    \textcolor{keywordflow}{if}(error)
1030       \textcolor{keywordflow}{return} error;
1031 
1032    \textcolor{comment}{//First, shift words}
1033    \textcolor{keywordflow}{if}(n1 > 0)
1034    \{
1035       \textcolor{comment}{//Process the most significant words}
1036       \textcolor{keywordflow}{for}(i = r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1; i >= n1; i--)
1037       \{
1038          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i - n1];
1039       \}
1040 
1041       \textcolor{comment}{//Fill the rest with zeroes}
1042       \textcolor{keywordflow}{for}(i = 0; i < n1; i++)
1043       \{
1044          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = 0;
1045       \}
1046    \}
1047 
1048    \textcolor{comment}{//Then shift bits}
1049    \textcolor{keywordflow}{if}(n2 > 0)
1050    \{
1051       \textcolor{comment}{//Process the most significant words}
1052       \textcolor{keywordflow}{for}(i = r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - 1; i >= 1; i--)
1053       \{
1054          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = (r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] << n2) | (r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i - 1] >> (32 - n2));
1055       \}
1056 
1057       \textcolor{comment}{//The least significant word requires a special handling}
1058       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[0] <<= n2;
1059    \}
1060 
1061    \textcolor{comment}{//Shift operation is complete}
1062    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1063 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a550a7330971d895957015b810b25c805}\label{mpi_8c_a550a7330971d895957015b810b25c805}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Shift\+Right@{mpi\+Shift\+Right}}
\index{mpi\+Shift\+Right@{mpi\+Shift\+Right}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Shift\+Right()}{mpiShiftRight()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Shift\+Right (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{n }\end{DoxyParamCaption})}



Right shift operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em r} & The multiple precision integer to be shifted to the right \\
\hline
\mbox{\tt in}  & {\em n} & The number of bits to shift \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1073 of file mpi.\+c.


\begin{DoxyCode}
1074 \{
1075    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1076    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1077 
1078    \textcolor{comment}{//Number of 32-bit words to shift}
1079    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n1 = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} / (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
1080    \textcolor{comment}{//Number of bits to shift}
1081    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} n2 = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} % (\hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE} * 8);
1082 
1083    \textcolor{comment}{//Check parameters}
1084    \textcolor{keywordflow}{if}(n1 >= r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size})
1085    \{
1086       \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}, 0, r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} * \hyperlink{mpi_8h_a716a57c14a850e3069e9a13526a28dd3}{MPI\_INT\_SIZE});
1087       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1088    \}
1089 
1090    \textcolor{comment}{//First, shift words}
1091    \textcolor{keywordflow}{if}(n1 > 0)
1092    \{
1093       \textcolor{comment}{//Process the least significant words}
1094       \textcolor{keywordflow}{for}(m = r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - n1, i = 0; i < m; i++)
1095       \{
1096          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i + n1];
1097       \}
1098 
1099       \textcolor{comment}{//Fill the rest with zeroes}
1100       \textcolor{keywordflow}{for}(i = m; i < r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size}; i++)
1101       \{
1102          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = 0;
1103       \}
1104    \}
1105 
1106    \textcolor{comment}{//Then shift bits}
1107    \textcolor{keywordflow}{if}(n2 > 0)
1108    \{
1109       \textcolor{comment}{//Process the least significant words}
1110       \textcolor{keywordflow}{for}(m = r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} - n1 - 1, i = 0; i < m; i++)
1111       \{
1112          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = (r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] >> n2) | (r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i + 1] << (32 - n2));
1113       \}
1114 
1115       \textcolor{comment}{//The most significant word requires a special handling}
1116       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[\hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}] >>= n2;
1117    \}
1118 
1119    \textcolor{comment}{//Shift operation is complete}
1120    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1121 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}\label{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Sub@{mpi\+Sub}}
\index{mpi\+Sub@{mpi\+Sub}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Sub()}{mpiSub()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Sub (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Multiple precision subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A -\/ B \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 769 of file mpi.\+c.


\begin{DoxyCode}
770 \{
771    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
772    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} sign;
773 
774    \textcolor{comment}{//Retrieve the sign of A}
775    sign = a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign};
776 
777    \textcolor{comment}{//Both operands have the same sign?}
778    \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} == b->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign})
779    \{
780       \textcolor{comment}{//Compare the absolute value of A and B}
781       \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}{mpiCompAbs}(a, b) >= 0)
782       \{
783          \textcolor{comment}{//Perform subtraction}
784          error = \hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpiSubAbs}(r, a, b);
785          \textcolor{comment}{//Set the sign of the resulting number}
786          r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = sign;
787       \}
788       \textcolor{keywordflow}{else}
789       \{
790          \textcolor{comment}{//Perform subtraction}
791          error = \hyperlink{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}{mpiSubAbs}(r, b, a);
792          \textcolor{comment}{//Set the sign of the resulting number}
793          r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = -sign;
794       \}
795    \}
796    \textcolor{comment}{//Operands have different signs?}
797    \textcolor{keywordflow}{else}
798    \{
799       \textcolor{comment}{//Perform addition}
800       error = \hyperlink{mpi_8c_a797880ba43b70ac3de9a85448352c2d7}{mpiAddAbs}(r, a, b);
801       \textcolor{comment}{//Set the sign of the resulting number}
802       r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = sign;
803    \}
804 
805    \textcolor{comment}{//Return status code}
806    \textcolor{keywordflow}{return} error;
807 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}\label{mpi_8c_a86c362c7fde2a2e8c62b5bf9c3aa0193}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Sub\+Abs@{mpi\+Sub\+Abs}}
\index{mpi\+Sub\+Abs@{mpi\+Sub\+Abs}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Sub\+Abs()}{mpiSubAbs()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Sub\+Abs (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b }\end{DoxyParamCaption})}



Helper routine for multiple precision subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = $\vert$A -\/ B$\vert$ \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 922 of file mpi.\+c.


\begin{DoxyCode}
923 \{
924    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
925    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
926    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} d;
927    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
928    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
929    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
930 
931    \textcolor{comment}{//Check input parameters}
932    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_af576a49c1e6be8ea14fbeb408491f165}{mpiCompAbs}(a, b) < 0)
933    \{
934       \textcolor{comment}{//Swap A and B if necessary}
935       \textcolor{keyword}{const} \hyperlink{structMpi}{Mpi} *\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t} = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
936       a = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
937       b = \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
938    \}
939 
940    \textcolor{comment}{//Determine the actual length of A}
941    m = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(a);
942    \textcolor{comment}{//Determine the actual length of B}
943    n = \hyperlink{mpi_8c_a2041d0a8b1abf374bd1d0aba0da2a7c1}{mpiGetLength}(b);
944 
945    \textcolor{comment}{//Extend the size of the destination register as needed}
946    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ad8d75483b89550ecc5fa0c87c25be178}{mpiGrow}(r, m));
947 
948    \textcolor{comment}{//The result is always positive}
949    r->\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = 1;
950    \textcolor{comment}{//Clear carry bit}
951    c = 0;
952 
953    \textcolor{comment}{//Subtract operands}
954    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
955    \{
956       \textcolor{comment}{//Read first operand}
957       d = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i];
958 
959       \textcolor{comment}{//Check the carry bit}
960       \textcolor{keywordflow}{if}(c)
961       \{
962          \textcolor{comment}{//Update carry bit}
963          \textcolor{keywordflow}{if}(d != 0) c = 0;
964          \textcolor{comment}{//Propagate carry bit}
965          d -= 1;
966       \}
967 
968       \textcolor{comment}{//Update carry bit}
969       \textcolor{keywordflow}{if}(d < b->\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[i]) c = 1;
970       \textcolor{comment}{//Perform subtraction}
971       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = d - b->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i];
972    \}
973 
974    \textcolor{comment}{//Loop as long as the carry bit is set}
975    \textcolor{keywordflow}{for}(i = n; c && i < \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}; i++)
976    \{
977       \textcolor{comment}{//Update carry bit}
978       \textcolor{keywordflow}{if}(a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] != 0) c = 0;
979       \textcolor{comment}{//Propagate carry bit}
980       r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] - 1;
981    \}
982 
983    \textcolor{comment}{//R and A are not the same instance?}
984    \textcolor{keywordflow}{if}(r != a)
985    \{
986       \textcolor{comment}{//Copy the remaining words}
987       \textcolor{keywordflow}{for}(; i < \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}; i++)
988       \{
989          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = a->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i];
990       \}
991 
992       \textcolor{comment}{//Zero the upper part of R}
993       \textcolor{keywordflow}{for}(; i < r->\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size}; i++)
994       \{
995          r->\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data}[i] = 0;
996       \}
997    \}
998 
999 end:
1000    \textcolor{comment}{//Return status code}
1001    \textcolor{keywordflow}{return} error;
1002 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a77f0e675dfb77c89650dee4c39561891}\label{mpi_8c_a77f0e675dfb77c89650dee4c39561891}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Sub\+Int@{mpi\+Sub\+Int}}
\index{mpi\+Sub\+Int@{mpi\+Sub\+Int}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Sub\+Int()}{mpiSubInt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Sub\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{b }\end{DoxyParamCaption})}



Subtract an integer from a multiple precision integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A -\/ B \\
\hline
\mbox{\tt in}  & {\em a} & First operand A \\
\hline
\mbox{\tt in}  & {\em b} & Second operand B \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 818 of file mpi.\+c.


\begin{DoxyCode}
819 \{
820    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
821    \hyperlink{structMpi}{Mpi} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
822 
823    \textcolor{comment}{//Convert the second operand to a multiple precision integer}
824    value = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} : -\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
825    t.\hyperlink{structMpi_ad220415cba342d58792ae2ea00ebe34a}{sign} = (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} >= 0) ? 1 : -1;
826    t.\hyperlink{structMpi_ab7c94872ccb0b7a223c26fd3c43b0c4d}{size} = 1;
827    t.\hyperlink{structMpi_a6277ee3b97f7ef362735a5d9cfa92235}{data} = &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
828 
829    \textcolor{comment}{//Perform subtraction}
830    \textcolor{keywordflow}{return} \hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpiSub}(r, a, &t);
831 \}
\end{DoxyCode}
\mbox{\Hypertarget{mpi_8c_a221d32159642449acd2971bbcd93d6dc}\label{mpi_8c_a221d32159642449acd2971bbcd93d6dc}} 
\index{mpi.\+c@{mpi.\+c}!mpi\+Sub\+Mod@{mpi\+Sub\+Mod}}
\index{mpi\+Sub\+Mod@{mpi\+Sub\+Mod}!mpi.\+c@{mpi.\+c}}
\subsubsection{\texorpdfstring{mpi\+Sub\+Mod()}{mpiSubMod()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mpi\+Sub\+Mod (\begin{DoxyParamCaption}\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{r,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{a,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{b,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{p }\end{DoxyParamCaption})}



Modular subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A -\/ B mod P \\
\hline
\mbox{\tt in}  & {\em a} & The first operand A \\
\hline
\mbox{\tt in}  & {\em b} & The second operand B \\
\hline
\mbox{\tt in}  & {\em p} & The modulus P \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1413 of file mpi.\+c.


\begin{DoxyCode}
1414 \{
1415    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1416 
1417    \textcolor{comment}{//Perform modular subtraction}
1418    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_a3bacb7d1ff434e94cc4c9fabbfcea3fe}{mpiSub}(r, a, b));
1419    \hyperlink{mpi_8h_a5e76fea2f61391de0c215692cbd3f418}{MPI\_CHECK}(\hyperlink{mpi_8c_ac1ddf7a0ceb3cb9c2490edaef9878bf9}{mpiMod}(r, r, p));
1420 
1421 end:
1422    \textcolor{comment}{//Return status code}
1423    \textcolor{keywordflow}{return} error;
1424 \}
\end{DoxyCode}
