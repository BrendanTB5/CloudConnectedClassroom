\hypertarget{tcp__mib__impl_8h}{}\section{cyclone\+\_\+tcp/mibs/tcp\+\_\+mib\+\_\+impl.h File Reference}
\label{tcp__mib__impl_8h}\index{cyclone\+\_\+tcp/mibs/tcp\+\_\+mib\+\_\+impl.\+h@{cyclone\+\_\+tcp/mibs/tcp\+\_\+mib\+\_\+impl.\+h}}


T\+CP M\+IB module implementation.  


{\ttfamily \#include \char`\"{}mibs/mib\+\_\+common.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_a47d2f08167e182dddcf72b28ff859b61}{tcp\+Mib\+Init} (void)
\begin{DoxyCompactList}\small\item\em T\+CP M\+IB module initialization. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_a35ddfe685bb91420404b9398f79ec50d}{tcp\+Mib\+Get\+Tcp\+Curr\+Estab} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get tcp\+Curr\+Estab object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_af41cef03bdb5142b3d2a1dbe81103d00}{tcp\+Mib\+Set\+Tcp\+Connection\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t value\+Len, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} commit)
\begin{DoxyCompactList}\small\item\em Set tcp\+Connection\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_afe96222aeb20e9e0a9990ab3a55f6a83}{tcp\+Mib\+Get\+Tcp\+Connection\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get tcp\+Connection\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_ad89a3d33a6ee55c8e734b6ecf586a4b1}{tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next tcp\+Connection\+Entry object. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_aa589c3a319fc0ed4acb46ece2106e9e5}{tcp\+Mib\+Get\+Tcp\+Listener\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get tcp\+Listener\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tcp__mib__impl_8h_a9b84ab42136d7e1983edaabb2d2b2dbd}{tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next tcp\+Listener\+Entry object. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
T\+CP M\+IB module implementation. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{tcp__mib__impl_8h_ad89a3d33a6ee55c8e734b6ecf586a4b1}\label{tcp__mib__impl_8h_ad89a3d33a6ee55c8e734b6ecf586a4b1}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry@{tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry}}
\index{tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry@{tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry()}{tcpMibGetNextTcpConnectionEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Get\+Next\+Tcp\+Connection\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next tcp\+Connection\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 300 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
302 \{
303    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
304    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
305    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
306    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
307    \hyperlink{structIpAddr}{IpAddr} localIpAddr;
308    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} localPort;
309    \hyperlink{structIpAddr}{IpAddr} remoteIpAddr;
310    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} remotePort;
311    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket};
312 
313    \textcolor{comment}{//Initialize variables}
314    localIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
315    localPort = 0;
316    remoteIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
317    remotePort = 0;
318 
319    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
320    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
321       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
322 
323    \textcolor{comment}{//Copy OID prefix}
324    memcpy(nextOid, object->oid, object->oidLen);
325 
326    \textcolor{comment}{//Loop through socket descriptors}
327    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
328    \{
329       \textcolor{comment}{//Point to current socket}
330       socket = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
331 
332       \textcolor{comment}{//TCP socket?}
333       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a9dab003c4dc9f7279e806241534d4859}{SOCKET\_TYPE\_STREAM})
334       \{
335          \textcolor{comment}{//Check current state}
336          \textcolor{keywordflow}{if}(socket->state != \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca7f99d4d604cb5009b50f04f84f5cb1c6}{TCP\_STATE\_LISTEN})
337          \{
338             \textcolor{comment}{//Append the instance identifier to the OID prefix}
339             n = \textcolor{keywordtype}{object}->oidLen;
340 
341             \textcolor{comment}{//tcpConnectionLocalAddressType and tcpConnectionLocalAddress are used}
342             \textcolor{comment}{//as 1st and 2nd instance identifiers}
343             error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &socket->localIpAddr);
344             \textcolor{comment}{//Any error to report?}
345             \textcolor{keywordflow}{if}(error)
346                \textcolor{keywordflow}{return} error;
347 
348             \textcolor{comment}{//tcpConnectionLocalPort is used as 3rd instance identifier}
349             error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, socket->localPort);
350             \textcolor{comment}{//Any error to report?}
351             \textcolor{keywordflow}{if}(error)
352                \textcolor{keywordflow}{return} error;
353 
354             \textcolor{comment}{//tcpConnectionRemAddressType and tcpConnectionRemAddress are used}
355             \textcolor{comment}{//as 4th and 5th instance identifiers}
356             error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &socket->remoteIpAddr);
357             \textcolor{comment}{//Any error to report?}
358             \textcolor{keywordflow}{if}(error)
359                \textcolor{keywordflow}{return} error;
360 
361             \textcolor{comment}{//tcpConnectionRemPort is used as 6th instance identifier}
362             error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, socket->remotePort);
363             \textcolor{comment}{//Any error to report?}
364             \textcolor{keywordflow}{if}(error)
365                \textcolor{keywordflow}{return} error;
366 
367             \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
368             \textcolor{comment}{//follows the specified OID}
369             \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
370             \{
371                \textcolor{comment}{//Perform lexicographic comparison}
372                \textcolor{keywordflow}{if}(localPort == 0 && remotePort == 0)
373                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
374                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->localIpAddr, &localIpAddr) < 0)
375                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
376                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->localIpAddr, &localIpAddr) > 0)
377                   acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
378                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->localPort < localPort)
379                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
380                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->localPort > localPort)
381                   acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
382                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->remoteIpAddr, &remoteIpAddr) < 0)
383                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
384                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->remoteIpAddr, &remoteIpAddr) > 0)
385                   acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
386                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->remotePort < remotePort)
387                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
388                \textcolor{keywordflow}{else}
389                   acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
390 
391                \textcolor{comment}{//Save the closest object identifier that follows the specified}
392                \textcolor{comment}{//OID in lexicographic order}
393                \textcolor{keywordflow}{if}(acceptable)
394                \{
395                   localIpAddr = socket->localIpAddr;
396                   localPort = socket->localPort;
397                   remoteIpAddr = socket->remoteIpAddr;
398                   remotePort = socket->remotePort;
399                \}
400             \}
401          \}
402       \}
403    \}
404 
405    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
406    \textcolor{comment}{//of some object?}
407    \textcolor{keywordflow}{if}(localPort == 0 && remotePort == 0)
408       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
409 
410    \textcolor{comment}{//Append the instance identifier to the OID prefix}
411    n = \textcolor{keywordtype}{object}->oidLen;
412 
413    \textcolor{comment}{//tcpConnectionLocalAddressType and tcpConnectionLocalAddress are used}
414    \textcolor{comment}{//as 1st and 2nd instance identifiers}
415    error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &localIpAddr);
416    \textcolor{comment}{//Any error to report?}
417    \textcolor{keywordflow}{if}(error)
418       \textcolor{keywordflow}{return} error;
419 
420    \textcolor{comment}{//tcpConnectionLocalPort is used as 3rd instance identifier}
421    error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, localPort);
422    \textcolor{comment}{//Any error to report?}
423    \textcolor{keywordflow}{if}(error)
424       \textcolor{keywordflow}{return} error;
425 
426    \textcolor{comment}{//tcpConnectionRemAddressType and tcpConnectionRemAddress are used}
427    \textcolor{comment}{//as 4th and 5th instance identifiers}
428    error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &remoteIpAddr);
429    \textcolor{comment}{//Any error to report?}
430    \textcolor{keywordflow}{if}(error)
431       \textcolor{keywordflow}{return} error;
432 
433    \textcolor{comment}{//tcpConnectionRemPort is used as 6th instance identifier}
434    error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, remotePort);
435    \textcolor{comment}{//Any error to report?}
436    \textcolor{keywordflow}{if}(error)
437       \textcolor{keywordflow}{return} error;
438 
439    \textcolor{comment}{//Save the length of the resulting object identifier}
440    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
441    \textcolor{comment}{//Next object found}
442    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
443 \}
\end{DoxyCode}
\mbox{\Hypertarget{tcp__mib__impl_8h_a9b84ab42136d7e1983edaabb2d2b2dbd}\label{tcp__mib__impl_8h_a9b84ab42136d7e1983edaabb2d2b2dbd}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry@{tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry}}
\index{tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry@{tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry()}{tcpMibGetNextTcpListenerEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Get\+Next\+Tcp\+Listener\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next tcp\+Listener\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 542 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
544 \{
545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
546    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
547    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
548    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
549    \hyperlink{structIpAddr}{IpAddr} localIpAddr;
550    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} localPort;
551    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket};
552 
553    \textcolor{comment}{//Initialize variables}
554    localIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
555    localPort = 0;
556 
557    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
558    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
559       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
560 
561    \textcolor{comment}{//Copy OID prefix}
562    memcpy(nextOid, object->oid, object->oidLen);
563 
564    \textcolor{comment}{//Loop through socket descriptors}
565    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
566    \{
567       \textcolor{comment}{//Point to current socket}
568       socket = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
569 
570       \textcolor{comment}{//TCP socket?}
571       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a9dab003c4dc9f7279e806241534d4859}{SOCKET\_TYPE\_STREAM})
572       \{
573          \textcolor{comment}{//Check current state}
574          \textcolor{keywordflow}{if}(socket->state == \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca7f99d4d604cb5009b50f04f84f5cb1c6}{TCP\_STATE\_LISTEN})
575          \{
576             \textcolor{comment}{//Append the instance identifier to the OID prefix}
577             n = \textcolor{keywordtype}{object}->oidLen;
578 
579             \textcolor{comment}{//tcpListenerLocalAddressType and tcpListenerLocalAddress are used}
580             \textcolor{comment}{//as 1st and 2nd instance identifiers}
581             error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &socket->localIpAddr);
582             \textcolor{comment}{//Any error to report?}
583             \textcolor{keywordflow}{if}(error)
584                \textcolor{keywordflow}{return} error;
585 
586             \textcolor{comment}{//tcpListenerLocalPort is used as 3rd instance identifier}
587             error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, socket->localPort);
588             \textcolor{comment}{//Any error to report?}
589             \textcolor{keywordflow}{if}(error)
590                \textcolor{keywordflow}{return} error;
591 
592             \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
593             \textcolor{comment}{//follows the specified OID}
594             \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
595             \{
596                \textcolor{comment}{//Perform lexicographic comparison}
597                \textcolor{keywordflow}{if}(localPort == 0)
598                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
599                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->localIpAddr, &localIpAddr) < 0)
600                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
601                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->localIpAddr, &localIpAddr) > 0)
602                   acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
603                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->localPort < localPort)
604                   acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
605                \textcolor{keywordflow}{else}
606                   acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
607 
608                \textcolor{comment}{//Save the closest object identifier that follows the specified}
609                \textcolor{comment}{//OID in lexicographic order}
610                \textcolor{keywordflow}{if}(acceptable)
611                \{
612                   localIpAddr = socket->localIpAddr;
613                   localPort = socket->localPort;
614                \}
615             \}
616          \}
617       \}
618    \}
619 
620    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
621    \textcolor{comment}{//of some object?}
622    \textcolor{keywordflow}{if}(localPort == 0)
623       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
624 
625    \textcolor{comment}{//Append the instance identifier to the OID prefix}
626    n = \textcolor{keywordtype}{object}->oidLen;
627 
628    \textcolor{comment}{//tcpListenerLocalAddressType and tcpListenerLocalAddress are used}
629    \textcolor{comment}{//as 1st and 2nd instance identifiers}
630    error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &localIpAddr);
631    \textcolor{comment}{//Any error to report?}
632    \textcolor{keywordflow}{if}(error)
633       \textcolor{keywordflow}{return} error;
634 
635    \textcolor{comment}{//tcpListenerLocalPort is used as 3rd instance identifier}
636    error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, localPort);
637    \textcolor{comment}{//Any error to report?}
638    \textcolor{keywordflow}{if}(error)
639       \textcolor{keywordflow}{return} error;
640 
641    \textcolor{comment}{//Save the length of the resulting object identifier}
642    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
643    \textcolor{comment}{//Next object found}
644    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
645 \}
\end{DoxyCode}
\mbox{\Hypertarget{tcp__mib__impl_8h_afe96222aeb20e9e0a9990ab3a55f6a83}\label{tcp__mib__impl_8h_afe96222aeb20e9e0a9990ab3a55f6a83}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Get\+Tcp\+Connection\+Entry@{tcp\+Mib\+Get\+Tcp\+Connection\+Entry}}
\index{tcp\+Mib\+Get\+Tcp\+Connection\+Entry@{tcp\+Mib\+Get\+Tcp\+Connection\+Entry}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Get\+Tcp\+Connection\+Entry()}{tcpMibGetTcpConnectionEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Get\+Tcp\+Connection\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get tcp\+Connection\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 149 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
151 \{
152    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
153    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
154    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
155    \hyperlink{structIpAddr}{IpAddr} localIpAddr;
156    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} localPort;
157    \hyperlink{structIpAddr}{IpAddr} remoteIpAddr;
158    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} remotePort;
159    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket};
160 
161    \textcolor{comment}{//Point to the instance identifier}
162    n = \textcolor{keywordtype}{object}->oidLen;
163 
164    \textcolor{comment}{//tcpConnectionLocalAddressType and tcpConnectionLocalAddress are used}
165    \textcolor{comment}{//as 1st and 2nd instance identifiers}
166    error = \hyperlink{mib__common_8c_a080b4155dd7c955d9b87aeb7869e45e3}{mibDecodeIpAddr}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &localIpAddr);
167    \textcolor{comment}{//Invalid instance identifier?}
168    \textcolor{keywordflow}{if}(error)
169       \textcolor{keywordflow}{return} error;
170 
171    \textcolor{comment}{//tcpConnectionLocalPort is used as 3rd instance identifier}
172    error = \hyperlink{mib__common_8c_a9f6dc51e0c874e2395e852a4235a02a4}{mibDecodePort}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &localPort);
173    \textcolor{comment}{//Invalid instance identifier?}
174    \textcolor{keywordflow}{if}(error)
175       \textcolor{keywordflow}{return} error;
176 
177    \textcolor{comment}{//tcpConnectionRemAddressType and tcpConnectionRemAddress are used}
178    \textcolor{comment}{//as 4th and 5th instance identifiers}
179    error = \hyperlink{mib__common_8c_a080b4155dd7c955d9b87aeb7869e45e3}{mibDecodeIpAddr}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &remoteIpAddr);
180    \textcolor{comment}{//Invalid instance identifier?}
181    \textcolor{keywordflow}{if}(error)
182       \textcolor{keywordflow}{return} error;
183 
184    \textcolor{comment}{//tcpConnectionRemPort is used as 6th instance identifier}
185    error = \hyperlink{mib__common_8c_a9f6dc51e0c874e2395e852a4235a02a4}{mibDecodePort}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &remotePort);
186    \textcolor{comment}{//Invalid instance identifier?}
187    \textcolor{keywordflow}{if}(error)
188       \textcolor{keywordflow}{return} error;
189 
190    \textcolor{comment}{//Sanity check}
191    \textcolor{keywordflow}{if}(n != oidLen)
192       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
193 
194    \textcolor{comment}{//Loop through socket descriptors}
195    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
196    \{
197       \textcolor{comment}{//Point to current socket}
198       socket = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
199 
200       \textcolor{comment}{//TCP socket?}
201       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a9dab003c4dc9f7279e806241534d4859}{SOCKET\_TYPE\_STREAM})
202       \{
203          \textcolor{comment}{//Check local IP address}
204          \textcolor{keywordflow}{if}(!\hyperlink{ip_8c_ae42b27fb0c6c86b8e29c86f39f0aa449}{ipCompAddr}(&socket->localIpAddr, &localIpAddr))
205             \textcolor{keywordflow}{continue};
206          \textcolor{comment}{//Check local port number}
207          \textcolor{keywordflow}{if}(socket->localPort != localPort)
208             \textcolor{keywordflow}{continue};
209          \textcolor{comment}{//Check remote IP address}
210          \textcolor{keywordflow}{if}(!\hyperlink{ip_8c_ae42b27fb0c6c86b8e29c86f39f0aa449}{ipCompAddr}(&socket->remoteIpAddr, &remoteIpAddr))
211             \textcolor{keywordflow}{continue};
212          \textcolor{comment}{//Check local port number}
213          \textcolor{keywordflow}{if}(socket->remotePort != remotePort)
214             \textcolor{keywordflow}{continue};
215          \textcolor{comment}{//Check current state}
216          \textcolor{keywordflow}{if}(socket->state == \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca7f99d4d604cb5009b50f04f84f5cb1c6}{TCP\_STATE\_LISTEN})
217             \textcolor{keywordflow}{continue};
218 
219          \textcolor{comment}{//A matching socket has been found}
220          \textcolor{keywordflow}{break};
221       \}
222    \}
223 
224    \textcolor{comment}{//No matching connection found in socket table?}
225    \textcolor{keywordflow}{if}(i >= SOCKET\_MAX\_COUNT)
226       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
227 
228    \textcolor{comment}{//tcpConnectionState object?}
229    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"tcpConnectionState"}))
230    \{
231       \textcolor{comment}{//Get object value}
232       \textcolor{keywordflow}{switch}(socket->state)
233       \{
234       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca1af39131036c81d79f09174d2fb6f788}{TCP\_STATE\_CLOSED}:
235          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca526fb27a4247ff8ede2eaacfe5ddce90}{TCP\_MIB\_CONN\_STATE\_CLOSED};
236          \textcolor{keywordflow}{break};
237       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca7f99d4d604cb5009b50f04f84f5cb1c6}{TCP\_STATE\_LISTEN}:
238          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca84ffac007616b33a4ea1dbd02b622563}{TCP\_MIB\_CONN\_STATE\_LISTEN};
239          \textcolor{keywordflow}{break};
240       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca63834296a6449f272b397d54a5536bfc}{TCP\_STATE\_SYN\_SENT}:
241          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca5f607f1b86ed837721ce0d18c9e6bda4}{TCP\_MIB\_CONN\_STATE\_SYN\_SENT};
242          \textcolor{keywordflow}{break};
243       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecadfce7e58cb083022157243f993d4ddc3}{TCP\_STATE\_SYN\_RECEIVED}:
244          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca80931b2a7957377a12969e957f98b2d3}{TCP\_MIB\_CONN\_STATE\_SYN\_RECEIVED};
245          \textcolor{keywordflow}{break};
246       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecaacb7ccce8d3fcdbc6635983251b22189}{TCP\_STATE\_ESTABLISHED}:
247          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca202c0823fcbafe27a0a9b59f9e39b826}{TCP\_MIB\_CONN\_STATE\_ESTABLISHED};
248          \textcolor{keywordflow}{break};
249       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecad80d0b794cc52f39180e65bd1da1b555}{TCP\_STATE\_FIN\_WAIT\_1}:
250          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca5c0c6a5f2ef5360813dac674097377ed}{TCP\_MIB\_CONN\_STATE\_FIN\_WAIT\_1};
251          \textcolor{keywordflow}{break};
252       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecac50f13616eeb349dc1aaa5cfd3422018}{TCP\_STATE\_FIN\_WAIT\_2}:
253          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca1e05a3d41231508aa084d7a982f8db7c}{TCP\_MIB\_CONN\_STATE\_FIN\_WAIT\_2};
254          \textcolor{keywordflow}{break};
255       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecabd723866a1772c3180b372605cfbc963}{TCP\_STATE\_CLOSE\_WAIT}:
256          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca75944996f59050ab330a32ce93df3ebd}{TCP\_MIB\_CONN\_STATE\_CLOSE\_WAIT};
257          \textcolor{keywordflow}{break};
258       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca29f7d016b33a1856dfba699643c69260}{TCP\_STATE\_LAST\_ACK}:
259          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddca787a36c513a3d79f0b5dba410864715b}{TCP\_MIB\_CONN\_STATE\_LAST\_ACK};
260          \textcolor{keywordflow}{break};
261       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecad9c881087c2449f9d8c7a2a2ab188f22}{TCP\_STATE\_CLOSING}:
262          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddcac6359bd1e37f8463afe642b3d7efec43}{TCP\_MIB\_CONN\_STATE\_CLOSING};
263          \textcolor{keywordflow}{break};
264       \textcolor{keywordflow}{case} \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca8fa1774b3f785db85813df1b8e158c56}{TCP\_STATE\_TIME\_WAIT}:
265          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{tcp__mib__module_8h_ab66417a86f367fd138904fc793092ddcae1edbb3c680668b8d24dfc938fc6e4bb}{TCP\_MIB\_CONN\_STATE\_TIME\_WAIT};
266          \textcolor{keywordflow}{break};
267       \textcolor{keywordflow}{default}:
268          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = 0;
269          \textcolor{keywordflow}{break};
270       \}
271    \}
272    \textcolor{comment}{//tcpConnectionProcess object?}
273    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"tcpConnectionProcess"}))
274    \{
275       \textcolor{comment}{//ID of the process associated with this connection}
276       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->unsigned32 = 0;
277    \}
278    \textcolor{comment}{//Unknown object?}
279    \textcolor{keywordflow}{else}
280    \{
281       \textcolor{comment}{//The specified object does not exist}
282       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
283    \}
284 
285    \textcolor{comment}{//Return status code}
286    \textcolor{keywordflow}{return} error;
287 \}
\end{DoxyCode}
\mbox{\Hypertarget{tcp__mib__impl_8h_a35ddfe685bb91420404b9398f79ec50d}\label{tcp__mib__impl_8h_a35ddfe685bb91420404b9398f79ec50d}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Get\+Tcp\+Curr\+Estab@{tcp\+Mib\+Get\+Tcp\+Curr\+Estab}}
\index{tcp\+Mib\+Get\+Tcp\+Curr\+Estab@{tcp\+Mib\+Get\+Tcp\+Curr\+Estab}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Get\+Tcp\+Curr\+Estab()}{tcpMibGetTcpCurrEstab()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Get\+Tcp\+Curr\+Estab (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get tcp\+Curr\+Estab object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 85 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
87 \{
88    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
89    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket};
90 
91    \textcolor{comment}{//Initialize object value}
92    \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->gauge32 = 0;
93 
94    \textcolor{comment}{//Loop through socket descriptors}
95    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
96    \{
97       \textcolor{comment}{//Point to current socket}
98       socket = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
99 
100       \textcolor{comment}{//TCP socket?}
101       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a9dab003c4dc9f7279e806241534d4859}{SOCKET\_TYPE\_STREAM})
102       \{
103          \textcolor{comment}{//Check current state}
104          \textcolor{keywordflow}{if}(socket->state == \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecaacb7ccce8d3fcdbc6635983251b22189}{TCP\_STATE\_ESTABLISHED} ||
105             socket->state == \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfecabd723866a1772c3180b372605cfbc963}{TCP\_STATE\_CLOSE\_WAIT})
106          \{
107             \textcolor{comment}{//Number of TCP connections for which the current state}
108             \textcolor{comment}{//is either ESTABLISHED or CLOSE-WAIT}
109             \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->gauge32++;
110          \}
111       \}
112    \}
113 
114    \textcolor{comment}{//Return status code}
115    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
116 \}
\end{DoxyCode}
\mbox{\Hypertarget{tcp__mib__impl_8h_aa589c3a319fc0ed4acb46ece2106e9e5}\label{tcp__mib__impl_8h_aa589c3a319fc0ed4acb46ece2106e9e5}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Get\+Tcp\+Listener\+Entry@{tcp\+Mib\+Get\+Tcp\+Listener\+Entry}}
\index{tcp\+Mib\+Get\+Tcp\+Listener\+Entry@{tcp\+Mib\+Get\+Tcp\+Listener\+Entry}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Get\+Tcp\+Listener\+Entry()}{tcpMibGetTcpListenerEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Get\+Tcp\+Listener\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get tcp\+Listener\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 456 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
458 \{
459    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
460    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
461    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
462    \hyperlink{structIpAddr}{IpAddr} localIpAddr;
463    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} localPort;
464    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket};
465 
466    \textcolor{comment}{//Point to the instance identifier}
467    n = \textcolor{keywordtype}{object}->oidLen;
468 
469    \textcolor{comment}{//tcpListenerLocalAddressType and tcpListenerLocalAddress are used}
470    \textcolor{comment}{//as 1st and 2nd instance identifiers}
471    error = \hyperlink{mib__common_8c_a080b4155dd7c955d9b87aeb7869e45e3}{mibDecodeIpAddr}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &localIpAddr);
472    \textcolor{comment}{//Invalid instance identifier?}
473    \textcolor{keywordflow}{if}(error)
474       \textcolor{keywordflow}{return} error;
475 
476    \textcolor{comment}{//tcpListenerLocalPort is used as 3rd instance identifier}
477    error = \hyperlink{mib__common_8c_a9f6dc51e0c874e2395e852a4235a02a4}{mibDecodePort}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &localPort);
478    \textcolor{comment}{//Invalid instance identifier?}
479    \textcolor{keywordflow}{if}(error)
480       \textcolor{keywordflow}{return} error;
481 
482    \textcolor{comment}{//Sanity check}
483    \textcolor{keywordflow}{if}(n != oidLen)
484       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
485 
486    \textcolor{comment}{//Loop through socket descriptors}
487    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
488    \{
489       \textcolor{comment}{//Point to current socket}
490       socket = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
491 
492       \textcolor{comment}{//TCP socket?}
493       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a9dab003c4dc9f7279e806241534d4859}{SOCKET\_TYPE\_STREAM})
494       \{
495          \textcolor{comment}{//Check local IP address}
496          \textcolor{keywordflow}{if}(!\hyperlink{ip_8c_ae42b27fb0c6c86b8e29c86f39f0aa449}{ipCompAddr}(&socket->localIpAddr, &localIpAddr))
497             \textcolor{keywordflow}{continue};
498          \textcolor{comment}{//Check local port number}
499          \textcolor{keywordflow}{if}(socket->localPort != localPort)
500             \textcolor{keywordflow}{continue};
501          \textcolor{comment}{//Check current state}
502          \textcolor{keywordflow}{if}(socket->state != \hyperlink{tcp_8h_a4310b47e70de394d33f7cf601e35bfeca7f99d4d604cb5009b50f04f84f5cb1c6}{TCP\_STATE\_LISTEN})
503             \textcolor{keywordflow}{continue};
504 
505          \textcolor{comment}{//A matching socket has been found}
506          \textcolor{keywordflow}{break};
507       \}
508    \}
509 
510    \textcolor{comment}{//No matching connection found in socket table?}
511    \textcolor{keywordflow}{if}(i >= SOCKET\_MAX\_COUNT)
512       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
513 
514    \textcolor{comment}{//tcpListenerProcess object?}
515    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"tcpListenerProcess"}))
516    \{
517       \textcolor{comment}{//ID of the process associated with this listener}
518       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->unsigned32 = 0;
519    \}
520    \textcolor{comment}{//Unknown object?}
521    \textcolor{keywordflow}{else}
522    \{
523       \textcolor{comment}{//The specified object does not exist}
524       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
525    \}
526 
527    \textcolor{comment}{//Return status code}
528    \textcolor{keywordflow}{return} error;
529 \}
\end{DoxyCode}
\mbox{\Hypertarget{tcp__mib__impl_8h_a47d2f08167e182dddcf72b28ff859b61}\label{tcp__mib__impl_8h_a47d2f08167e182dddcf72b28ff859b61}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Init@{tcp\+Mib\+Init}}
\index{tcp\+Mib\+Init@{tcp\+Mib\+Init}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Init()}{tcpMibInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



T\+CP M\+IB module initialization. 

\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 53 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
54 \{
55    \textcolor{comment}{//Debug message}
56    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Initializing TCP-MIB base...\(\backslash\)r\(\backslash\)n"});
57 
58    \textcolor{comment}{//Clear TCP MIB base}
59    memset(&\hyperlink{tcp__mib__module_8c_ac00f1a432427cf736c78e26e863c5bc2}{tcpMibBase}, 0, \textcolor{keyword}{sizeof}(\hyperlink{tcp__mib__module_8c_ac00f1a432427cf736c78e26e863c5bc2}{tcpMibBase}));
60 
61    \textcolor{comment}{//tcpRtoAlgorithm object}
62    \hyperlink{tcp__mib__module_8c_ac00f1a432427cf736c78e26e863c5bc2}{tcpMibBase}.\hyperlink{structTcpMibBase_a071bca65cede81d7e95dd6aa1d389d33}{tcpRtoAlgorithm} = 
      \hyperlink{tcp__mib__module_8h_a3240e8239a85f7406fdb039f0bcbb035ab86c9319094fa16f5c8f9141f2f7769c}{TCP\_MIB\_RTO\_ALGORITHM\_VANJ};
63    \textcolor{comment}{//tcpRtoMin object}
64    \hyperlink{tcp__mib__module_8c_ac00f1a432427cf736c78e26e863c5bc2}{tcpMibBase}.\hyperlink{structTcpMibBase_a96d086f1316ea9a782b6c919962203f6}{tcpRtoMin} = \hyperlink{tcp_8h_a305211e7eb6a1e212f4e0647da3cf92b}{TCP\_MIN\_RTO};
65    \textcolor{comment}{//tcpRtoMax object}
66    \hyperlink{tcp__mib__module_8c_ac00f1a432427cf736c78e26e863c5bc2}{tcpMibBase}.\hyperlink{structTcpMibBase_a275ff3ea426d35f2a47ec1d03b62ff35}{tcpRtoMax} = \hyperlink{tcp_8h_ab10a9785dd0ff10bb73ddbcf6f8f43a8}{TCP\_MAX\_RTO};
67    \textcolor{comment}{//tcpMaxConn object}
68    \hyperlink{tcp__mib__module_8c_ac00f1a432427cf736c78e26e863c5bc2}{tcpMibBase}.\hyperlink{structTcpMibBase_a398130f11e3b8907959c26935837932e}{tcpMaxConn} = \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT};
69 
70    \textcolor{comment}{//Successful processing}
71    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
72 \}
\end{DoxyCode}
\mbox{\Hypertarget{tcp__mib__impl_8h_af41cef03bdb5142b3d2a1dbe81103d00}\label{tcp__mib__impl_8h_af41cef03bdb5142b3d2a1dbe81103d00}} 
\index{tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}!tcp\+Mib\+Set\+Tcp\+Connection\+Entry@{tcp\+Mib\+Set\+Tcp\+Connection\+Entry}}
\index{tcp\+Mib\+Set\+Tcp\+Connection\+Entry@{tcp\+Mib\+Set\+Tcp\+Connection\+Entry}!tcp\+\_\+mib\+\_\+impl.\+h@{tcp\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{tcp\+Mib\+Set\+Tcp\+Connection\+Entry()}{tcpMibSetTcpConnectionEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tcp\+Mib\+Set\+Tcp\+Connection\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t}]{value\+Len,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{commit }\end{DoxyParamCaption})}



Set tcp\+Connection\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em value} & Object value \\
\hline
\mbox{\tt in}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\mbox{\tt in}  & {\em commit} & This flag tells whether the changes shall be committed to the M\+IB base \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 131 of file tcp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
133 \{
134    \textcolor{comment}{//Not implemented}
135    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
136 \}
\end{DoxyCode}
