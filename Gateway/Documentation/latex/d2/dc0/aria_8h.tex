\hypertarget{aria_8h}{}\section{cyclone\+\_\+crypto/cipher/aria.h File Reference}
\label{aria_8h}\index{cyclone\+\_\+crypto/cipher/aria.\+h@{cyclone\+\_\+crypto/cipher/aria.\+h}}


A\+R\+IA encryption algorithm.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structAriaContext}{Aria\+Context}
\begin{DoxyCompactList}\small\item\em A\+R\+IA algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}{A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~16
\item 
\#define \hyperlink{aria_8h_ac6c2c91acf0d1270428113583ec5ac85}{A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{aria_8h_ace370dd0e3fa212fcfbbf49f88e3b9d2}{aria\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{aria_8h_ae240efc36bfd8aa84b833dc1451856f4}{aria\+Init} (\hyperlink{structAriaContext}{Aria\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a A\+R\+IA context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{aria_8h_acc72f166c0be9b37f388c38ab814d3ac}{aria\+Encrypt\+Block} (\hyperlink{structAriaContext}{Aria\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 16-\/byte block using A\+R\+IA algorithm. \end{DoxyCompactList}\item 
void \hyperlink{aria_8h_abde8ab660e5729feefff6e4edef40dfc}{aria\+Decrypt\+Block} (\hyperlink{structAriaContext}{Aria\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 16-\/byte block using A\+R\+IA algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{aria_8h_ace370dd0e3fa212fcfbbf49f88e3b9d2}{aria\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
A\+R\+IA encryption algorithm. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}\label{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}} 
\index{aria.\+h@{aria.\+h}!A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!aria.\+h@{aria.\+h}}
\subsubsection{\texorpdfstring{A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{ARIA\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define A\+R\+I\+A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~16}



Definition at line 38 of file aria.\+h.

\mbox{\Hypertarget{aria_8h_ac6c2c91acf0d1270428113583ec5ac85}\label{aria_8h_ac6c2c91acf0d1270428113583ec5ac85}} 
\index{aria.\+h@{aria.\+h}!A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!aria.\+h@{aria.\+h}}
\subsubsection{\texorpdfstring{A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{ARIA\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define A\+R\+I\+A\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{aria_8h_ace370dd0e3fa212fcfbbf49f88e3b9d2}{aria\+Cipher\+Algo})}



Definition at line 40 of file aria.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{aria_8h_abde8ab660e5729feefff6e4edef40dfc}\label{aria_8h_abde8ab660e5729feefff6e4edef40dfc}} 
\index{aria.\+h@{aria.\+h}!aria\+Decrypt\+Block@{aria\+Decrypt\+Block}}
\index{aria\+Decrypt\+Block@{aria\+Decrypt\+Block}!aria.\+h@{aria.\+h}}
\subsubsection{\texorpdfstring{aria\+Decrypt\+Block()}{ariaDecryptBlock()}}
{\footnotesize\ttfamily void aria\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structAriaContext}{Aria\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 16-\/byte block using A\+R\+IA algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the A\+R\+IA context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 507 of file aria.\+c.


\begin{DoxyCode}
508 \{
509    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *dk;
510    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}[4];
511    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} q[4];
512 
513    \textcolor{comment}{//Copy the ciphertext to the buffer}
514    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(p, input, \hyperlink{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}{ARIA\_BLOCK\_SIZE});
515 
516    \textcolor{comment}{//Point to the decryption round keys}
517    dk = context->\hyperlink{structAriaContext_a81471d818f7b8f7423d35cf8587bfcbe}{dk};
518 
519    \textcolor{comment}{//Apply 11 rounds}
520    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 0);
521    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 4);
522    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 8);
523    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 12);
524    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 16);
525    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 20);
526    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 24);
527    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 28);
528    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 32);
529    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 36);
530    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 40);
531 
532    \textcolor{comment}{//128-bit master keys require a total of 12 rounds}
533    \textcolor{keywordflow}{if}(context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} == 12)
534    \{
535       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(p, dk + 44);
536       \hyperlink{aria_8c_a9291e0f78019fed2c39a13668ff7bdfa}{SL2}(q, p);
537       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(q, dk + 48);
538    \}
539    \textcolor{comment}{//192-bit master keys require a total of 14 rounds}
540    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} == 14)
541    \{
542       \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 44);
543       \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 48);
544       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(p, dk + 52);
545       \hyperlink{aria_8c_a9291e0f78019fed2c39a13668ff7bdfa}{SL2}(q, p);
546       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(q, dk + 56);
547    \}
548    \textcolor{comment}{//256-bit master keys require a total of 16 rounds}
549    \textcolor{keywordflow}{else}
550    \{
551       \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 44);
552       \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 48);
553       \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, dk + 52);
554       \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, dk + 56);
555       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(p, dk + 60);
556       \hyperlink{aria_8c_a9291e0f78019fed2c39a13668ff7bdfa}{SL2}(q, p);
557       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(q, dk + 64);
558    \}
559 
560    \textcolor{comment}{//The resulting value is the plaintext}
561    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(output, q, \hyperlink{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}{ARIA\_BLOCK\_SIZE});
562 \}
\end{DoxyCode}
\mbox{\Hypertarget{aria_8h_acc72f166c0be9b37f388c38ab814d3ac}\label{aria_8h_acc72f166c0be9b37f388c38ab814d3ac}} 
\index{aria.\+h@{aria.\+h}!aria\+Encrypt\+Block@{aria\+Encrypt\+Block}}
\index{aria\+Encrypt\+Block@{aria\+Encrypt\+Block}!aria.\+h@{aria.\+h}}
\subsubsection{\texorpdfstring{aria\+Encrypt\+Block()}{ariaEncryptBlock()}}
{\footnotesize\ttfamily void aria\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structAriaContext}{Aria\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 16-\/byte block using A\+R\+IA algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the A\+R\+IA context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 442 of file aria.\+c.


\begin{DoxyCode}
443 \{
444    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ek;
445    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}[4];
446    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} q[4];
447 
448    \textcolor{comment}{//Copy the plaintext to the buffer}
449    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(p, input, \hyperlink{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}{ARIA\_BLOCK\_SIZE});
450 
451    \textcolor{comment}{//Point to the encryption round keys}
452    ek = context->\hyperlink{structAriaContext_a4950c0459aaff6fbcb5b64161f4185bf}{ek};
453 
454    \textcolor{comment}{//Apply 11 rounds}
455    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 0);
456    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 4);
457    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 8);
458    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 12);
459    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 16);
460    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 20);
461    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 24);
462    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 28);
463    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 32);
464    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 36);
465    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 40);
466 
467    \textcolor{comment}{//128-bit master keys require a total of 12 rounds}
468    \textcolor{keywordflow}{if}(context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} == 12)
469    \{
470       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(p, ek + 44);
471       \hyperlink{aria_8c_a9291e0f78019fed2c39a13668ff7bdfa}{SL2}(q, p);
472       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(q, ek + 48);
473    \}
474    \textcolor{comment}{//192-bit master keys require a total of 14 rounds}
475    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} == 14)
476    \{
477       \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 44);
478       \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 48);
479       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(p, ek + 52);
480       \hyperlink{aria_8c_a9291e0f78019fed2c39a13668ff7bdfa}{SL2}(q, p);
481       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(q, ek + 56);
482    \}
483    \textcolor{comment}{//256-bit master keys require a total of 16 rounds}
484    \textcolor{keywordflow}{else}
485    \{
486       \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 44);
487       \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 48);
488       \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(p, ek + 52);
489       \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(p, ek + 56);
490       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(p, ek + 60);
491       \hyperlink{aria_8c_a9291e0f78019fed2c39a13668ff7bdfa}{SL2}(q, p);
492       \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(q, ek + 64);
493    \}
494 
495    \textcolor{comment}{//Copy the resulting ciphertext from the buffer}
496    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(output, q, \hyperlink{aria_8h_a6e0c92c9746ea5f930830549bd2fd813}{ARIA\_BLOCK\_SIZE});
497 \}
\end{DoxyCode}
\mbox{\Hypertarget{aria_8h_ae240efc36bfd8aa84b833dc1451856f4}\label{aria_8h_ae240efc36bfd8aa84b833dc1451856f4}} 
\index{aria.\+h@{aria.\+h}!aria\+Init@{aria\+Init}}
\index{aria\+Init@{aria\+Init}!aria.\+h@{aria.\+h}}
\subsubsection{\texorpdfstring{aria\+Init()}{ariaInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} aria\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structAriaContext}{Aria\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Initialize a A\+R\+IA context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the A\+R\+IA context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 297 of file aria.\+c.


\begin{DoxyCode}
298 \{
299    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
300    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ek;
301    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *dk;
302    \textcolor{keyword}{const} \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ck1;
303    \textcolor{keyword}{const} \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ck2;
304    \textcolor{keyword}{const} \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ck3;
305    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ethernet_8h_aaa9bda35d7b2e3d98ecec180d3f628c0}{w}[16];
306 
307    \textcolor{comment}{//Check parameters}
308    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
309       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
310 
311    \textcolor{comment}{//Check the length of the master key}
312    \textcolor{keywordflow}{if}(keyLen == 16)
313    \{
314       \textcolor{comment}{//Select the relevant constants}
315       ck1 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 0;
316       ck2 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 4;
317       ck3 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 8;
318       \textcolor{comment}{//The number of rounds depends on the size of the master key}
319       context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} = 12;
320    \}
321    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(keyLen == 24)
322    \{
323       \textcolor{comment}{//Select the relevant constants}
324       ck1 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 4;
325       ck2 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 8;
326       ck3 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 0;
327       \textcolor{comment}{//The number of rounds depends on the size of the master key}
328       context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} = 14;
329    \}
330    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(keyLen == 32)
331    \{
332       \textcolor{comment}{//Select the relevant constants}
333       ck1 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 8;
334       ck2 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 0;
335       ck3 = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 4;
336       \textcolor{comment}{//The number of rounds depends on the size of the master key}
337       context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} = 16;
338    \}
339    \textcolor{keywordflow}{else}
340    \{
341       \textcolor{comment}{//Report an error}
342       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
343    \}
344 
345    \textcolor{comment}{//Compute 128-bit values KL and KR}
346    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(w, 0, \textcolor{keyword}{sizeof}(w));
347    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(w, key, keyLen);
348 
349    \textcolor{comment}{//Save KR...}
350    \hyperlink{aria_8c_af89fe22c81bedbc4b619d12edbb7d947}{MOV128}(w + 8, w + 4);
351 
352    \textcolor{comment}{//Compute intermediate values W0, W1, W2, and W3}
353    \hyperlink{aria_8c_af89fe22c81bedbc4b619d12edbb7d947}{MOV128}(w + 4, w + 0);
354    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(w + 4, ck1);
355    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(w + 4, w + 8);
356 
357    \hyperlink{aria_8c_af89fe22c81bedbc4b619d12edbb7d947}{MOV128}(w + 8, w + 4);
358    \hyperlink{aria_8c_a047a13a312ccd42bff87612e9a0ce95a}{EF}(w + 8, ck2);
359    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(w + 8, w + 0);
360 
361    \hyperlink{aria_8c_af89fe22c81bedbc4b619d12edbb7d947}{MOV128}(w + 12, w + 8);
362    \hyperlink{aria_8c_ade77ecefd188f38d597e02cc3f2b050e}{OF}(w + 12, ck3);
363    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(w + 12, w + 4);
364 
365    \textcolor{comment}{//Convert from big-endian byte order to host byte order}
366    \textcolor{keywordflow}{for}(i = 0; i < 16; i++)
367    \{
368       w[i] = \hyperlink{cpu__endian_8h_a1f0e86c75b9c4d1fc0850a4762eb2148}{betoh32}(w[i]);
369    \}
370 
371    \textcolor{comment}{//Point to the encryption round keys}
372    ek = context->\hyperlink{structAriaContext_a4950c0459aaff6fbcb5b64161f4185bf}{ek};
373 
374    \textcolor{comment}{//Compute ek1, ..., ek17 as follow}
375    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 0, w + 4, 109);
376    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 0, w + 0);
377    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 4, w + 8, 109);
378    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 4, w + 4);
379    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 8, w + 12, 109);
380    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 8, w + 8);
381    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 12, w + 0, 109);
382    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 12, w + 12);
383    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 16, w + 4, 97);
384    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 16, w + 0);
385    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 20, w + 8, 97);
386    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 20, w + 4);
387    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 24, w + 12, 97);
388    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 24, w + 8);
389    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 28, w + 0, 97);
390    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 28, w + 12);
391    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 32, w + 4, 61);
392    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 32, w + 0);
393    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 36, w + 8, 61);
394    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 36, w + 4);
395    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 40, w + 12, 61);
396    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 40, w + 8);
397    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 44, w + 0, 61);
398    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 44, w + 12);
399    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 48, w + 4, 31);
400    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 48, w + 0);
401    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 52, w + 8, 31);
402    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 52, w + 4);
403    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 56, w + 12, 31);
404    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 56, w + 8);
405    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 60, w + 0, 31);
406    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 60, w + 12);
407    \hyperlink{aria_8c_a63ae6daffa0465a02c35d61b9d0a9ccf}{ROL128}(ek + 64, w + 4, 19);
408    \hyperlink{aria_8c_add0727ddd4e21dd770e27053a9bffe40}{XOR128}(ek + 64, w + 0);
409 
410    \textcolor{comment}{//Convert from host byte order to big-endian byte order}
411    \textcolor{keywordflow}{for}(i = 0; i < 68; i++)
412    \{
413       ek[i] = \hyperlink{cpu__endian_8h_a938bc0bd4cc428c5d05dd519bde9f2be}{htobe32}(ek[i]);
414    \}
415 
416    \textcolor{comment}{//Decryption round keys are derived from the encryption round keys}
417    dk = context->\hyperlink{structAriaContext_a81471d818f7b8f7423d35cf8587bfcbe}{dk};
418    \textcolor{comment}{//Compute dk1}
419    \hyperlink{aria_8c_af89fe22c81bedbc4b619d12edbb7d947}{MOV128}(dk + 0, ek + context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} * 4);
420 
421    \textcolor{comment}{//Compute dk2, ..., dk(n)}
422    \textcolor{keywordflow}{for}(i = 1; i < context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr}; i++)
423    \{
424       \hyperlink{aria_8c_a3ea882b0dc4bfc9d79c8840905a63a15}{A}(dk + i * 4, ek + (context->\hyperlink{structAriaContext_a268fb9eff01c611d5e52da435422a329}{nr} - i) * 4);
425    \}
426 
427    \textcolor{comment}{//Compute dk(n + 1)}
428    \hyperlink{aria_8c_af89fe22c81bedbc4b619d12edbb7d947}{MOV128}(dk + i * 4, ek + 0);
429 
430    \textcolor{comment}{//No error to report}
431    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
432 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{aria_8h_ace370dd0e3fa212fcfbbf49f88e3b9d2}\label{aria_8h_ace370dd0e3fa212fcfbbf49f88e3b9d2}} 
\index{aria.\+h@{aria.\+h}!aria\+Cipher\+Algo@{aria\+Cipher\+Algo}}
\index{aria\+Cipher\+Algo@{aria\+Cipher\+Algo}!aria.\+h@{aria.\+h}}
\subsubsection{\texorpdfstring{aria\+Cipher\+Algo}{ariaCipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} aria\+Cipher\+Algo}



Definition at line 237 of file aria.\+c.

