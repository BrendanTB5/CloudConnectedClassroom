\hypertarget{rc2_8h}{}\section{cyclone\+\_\+crypto/cipher/rc2.h File Reference}
\label{rc2_8h}\index{cyclone\+\_\+crypto/cipher/rc2.\+h@{cyclone\+\_\+crypto/cipher/rc2.\+h}}


R\+C2 block cipher.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structRc2Context}{Rc2\+Context}
\begin{DoxyCompactList}\small\item\em R\+C2 algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{rc2_8h_a4c0eac4cc8a756b1379bbf1ad6b52df6}{R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~8
\item 
\#define \hyperlink{rc2_8h_a2e197accb1522e7c83665363d169f609}{R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{rc2_8h_a79b39cc36e9dca07513b417dd01817c2}{rc2\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rc2_8h_a74f247a4da253172dec8d1e0f7e32410}{rc2\+Init} (\hyperlink{structRc2Context}{Rc2\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a R\+C2 context using the supplied key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rc2_8h_acea0ab83330388b52bbc7bdc9ffbd576}{rc2\+Init\+Ex} (\hyperlink{structRc2Context}{Rc2\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} effective\+Key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a R\+C2 context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{rc2_8h_acbd93a9e25c2e70789d5dbce06450d2c}{rc2\+Encrypt\+Block} (\hyperlink{structRc2Context}{Rc2\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 16-\/byte block using R\+C2 algorithm. \end{DoxyCompactList}\item 
void \hyperlink{rc2_8h_a4ccaf0bab97f09e0310ac5e886f42a74}{rc2\+Decrypt\+Block} (\hyperlink{structRc2Context}{Rc2\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 16-\/byte block using R\+C2 algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{rc2_8h_a79b39cc36e9dca07513b417dd01817c2}{rc2\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+C2 block cipher. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{rc2_8h_a4c0eac4cc8a756b1379bbf1ad6b52df6}\label{rc2_8h_a4c0eac4cc8a756b1379bbf1ad6b52df6}} 
\index{rc2.\+h@{rc2.\+h}!R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{RC2\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define R\+C2\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~8}



Definition at line 38 of file rc2.\+h.

\mbox{\Hypertarget{rc2_8h_a2e197accb1522e7c83665363d169f609}\label{rc2_8h_a2e197accb1522e7c83665363d169f609}} 
\index{rc2.\+h@{rc2.\+h}!R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{RC2\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define R\+C2\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{rc2_8h_a79b39cc36e9dca07513b417dd01817c2}{rc2\+Cipher\+Algo})}



Definition at line 40 of file rc2.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{rc2_8h_a4ccaf0bab97f09e0310ac5e886f42a74}\label{rc2_8h_a4ccaf0bab97f09e0310ac5e886f42a74}} 
\index{rc2.\+h@{rc2.\+h}!rc2\+Decrypt\+Block@{rc2\+Decrypt\+Block}}
\index{rc2\+Decrypt\+Block@{rc2\+Decrypt\+Block}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{rc2\+Decrypt\+Block()}{rc2DecryptBlock()}}
{\footnotesize\ttfamily void rc2\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structRc2Context}{Rc2\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 16-\/byte block using R\+C2 algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C2 context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 226 of file rc2.\+c.


\begin{DoxyCode}
227 \{
228    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
229    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r0;
230    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r1;
231    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r2;
232    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r3;
233 
234    \textcolor{comment}{//The ciphertext is divided into four 16-bit registers}
235    r0 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 0);
236    r1 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 2);
237    r2 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 4);
238    r3 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 6);
239 
240    \textcolor{comment}{//Apply 16 rounds}
241    \textcolor{keywordflow}{for}(i = 15; i >= 0; i--)
242    \{
243       \textcolor{comment}{//Perform r-mixing round}
244       r3 = \hyperlink{cyclone__crypto_2core_2crypto_8h_a9da6d60b00f781fbeafbabda9b73f3e6}{ROR16}(r3, 5);
245       r3 -= (r0 & ~r2) + (r1 & r2) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4 + 3];
246       r2 = \hyperlink{cyclone__crypto_2core_2crypto_8h_a9da6d60b00f781fbeafbabda9b73f3e6}{ROR16}(r2, 3);
247       r2 -= (r3 & ~r1) + (r0 & r1) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4 + 2];
248       r1 = \hyperlink{cyclone__crypto_2core_2crypto_8h_a9da6d60b00f781fbeafbabda9b73f3e6}{ROR16}(r1, 2);
249       r1 -= (r2 & ~r0) + (r3 & r0) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4 + 1];
250       r0 = \hyperlink{cyclone__crypto_2core_2crypto_8h_a9da6d60b00f781fbeafbabda9b73f3e6}{ROR16}(r0, 1);
251       r0 -= (r1 & ~r3) + (r2 & r3) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4];
252 
253       \textcolor{comment}{//5th and 11th rounds require special processing}
254       \textcolor{keywordflow}{if}(i == 5 || i == 11)
255       \{
256          \textcolor{comment}{//Perform r-mashing round}
257          r3 -= context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r2 % 64];
258          r2 -= context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r1 % 64];
259          r1 -= context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r0 % 64];
260          r0 -= context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r3 % 64];
261       \}
262    \}
263 
264    \textcolor{comment}{//The resulting value is the plaintext}
265    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r0, output + 0);
266    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r1, output + 2);
267    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r2, output + 4);
268    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r3, output + 6);
269 \}
\end{DoxyCode}
\mbox{\Hypertarget{rc2_8h_acbd93a9e25c2e70789d5dbce06450d2c}\label{rc2_8h_acbd93a9e25c2e70789d5dbce06450d2c}} 
\index{rc2.\+h@{rc2.\+h}!rc2\+Encrypt\+Block@{rc2\+Encrypt\+Block}}
\index{rc2\+Encrypt\+Block@{rc2\+Encrypt\+Block}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{rc2\+Encrypt\+Block()}{rc2EncryptBlock()}}
{\footnotesize\ttfamily void rc2\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structRc2Context}{Rc2\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 16-\/byte block using R\+C2 algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C2 context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 173 of file rc2.\+c.


\begin{DoxyCode}
174 \{
175    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
176    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r0;
177    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r1;
178    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r2;
179    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} r3;
180 
181    \textcolor{comment}{//The plaintext is divided into four 16-bit registers}
182    r0 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 0);
183    r1 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 2);
184    r2 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 4);
185    r3 = \hyperlink{cpu__endian_8h_a182c2e79417bf46407b27a505fdb06c2}{LOAD16LE}(input + 6);
186 
187    \textcolor{comment}{//Apply 16 rounds}
188    \textcolor{keywordflow}{for}(i = 0; i < 16; i++)
189    \{
190       \textcolor{comment}{//Perform mixing round}
191       r0 += (r1 & ~r3) + (r2 & r3) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4];
192       r0 = \hyperlink{cyclone__crypto_2core_2crypto_8h_acaf43bf2405b339c22836f16b147e265}{ROL16}(r0, 1);
193       r1 += (r2 & ~r0) + (r3 & r0) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4 + 1];
194       r1 = \hyperlink{cyclone__crypto_2core_2crypto_8h_acaf43bf2405b339c22836f16b147e265}{ROL16}(r1, 2);
195       r2 += (r3 & ~r1) + (r0 & r1) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4 + 2];
196       r2 = \hyperlink{cyclone__crypto_2core_2crypto_8h_acaf43bf2405b339c22836f16b147e265}{ROL16}(r2, 3);
197       r3 += (r0 & ~r2) + (r1 & r2) + context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i * 4 + 3];
198       r3 = \hyperlink{cyclone__crypto_2core_2crypto_8h_acaf43bf2405b339c22836f16b147e265}{ROL16}(r3, 5);
199 
200       \textcolor{comment}{//5th and 11th rounds require special processing}
201       \textcolor{keywordflow}{if}(i == 4 || i == 10)
202       \{
203          \textcolor{comment}{//Perform mashing round}
204          r0 += context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r3 % 64];
205          r1 += context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r0 % 64];
206          r2 += context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r1 % 64];
207          r3 += context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[r2 % 64];
208       \}
209    \}
210 
211    \textcolor{comment}{//The resulting value is the ciphertext}
212    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r0, output + 0);
213    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r1, output + 2);
214    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r2, output + 4);
215    \hyperlink{cpu__endian_8h_a09b5a0f32b9bf8ba46ab08a113a7848c}{STORE16LE}(r3, output + 6);
216 \}
\end{DoxyCode}
\mbox{\Hypertarget{rc2_8h_a74f247a4da253172dec8d1e0f7e32410}\label{rc2_8h_a74f247a4da253172dec8d1e0f7e32410}} 
\index{rc2.\+h@{rc2.\+h}!rc2\+Init@{rc2\+Init}}
\index{rc2\+Init@{rc2\+Init}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{rc2\+Init()}{rc2Init()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rc2\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structRc2Context}{Rc2\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Initialize a R\+C2 context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C2 context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 93 of file rc2.\+c.


\begin{DoxyCode}
94 \{
95    \textcolor{comment}{//Initialize a RC2 context}
96    \textcolor{keywordflow}{return} \hyperlink{rc2_8c_acea0ab83330388b52bbc7bdc9ffbd576}{rc2InitEx}(context, key, keyLen, keyLen * 8);
97 \}
\end{DoxyCode}
\mbox{\Hypertarget{rc2_8h_acea0ab83330388b52bbc7bdc9ffbd576}\label{rc2_8h_acea0ab83330388b52bbc7bdc9ffbd576}} 
\index{rc2.\+h@{rc2.\+h}!rc2\+Init\+Ex@{rc2\+Init\+Ex}}
\index{rc2\+Init\+Ex@{rc2\+Init\+Ex}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{rc2\+Init\+Ex()}{rc2InitEx()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rc2\+Init\+Ex (\begin{DoxyParamCaption}\item[{\hyperlink{structRc2Context}{Rc2\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{effective\+Key\+Len }\end{DoxyParamCaption})}



Initialize a R\+C2 context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C2 context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key (T) \\
\hline
\mbox{\tt in}  & {\em effective\+Key\+Len} & Maximum effective key length, in bits (T1) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 109 of file rc2.\+c.


\begin{DoxyCode}
111 \{
112    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
113    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{pic32mx_2isr__support_8h_ae3781fcb0354b09ca351bdf76301666b}{t8};
114    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} tm;
115 
116    \textcolor{comment}{//Check parameters}
117    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
118       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
119 
120    \textcolor{comment}{//Make sure the key length is acceptable}
121    \textcolor{keywordflow}{if}(keyLen < 1 || keyLen > 128)
122       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
123 
124    \textcolor{comment}{//Make sure the maximum effective key length is acceptable}
125    \textcolor{keywordflow}{if}(effectiveKeyLen < 1 || effectiveKeyLen > 1024)
126       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
127 
128    \textcolor{comment}{//The key expansion algorithm begins by placing the supplied T-byte key}
129    \textcolor{comment}{//into bytes L[0], ..., L[T-1] of the key buffer}
130    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}, key, keyLen);
131 
132    \textcolor{comment}{//The key expansion algorithm then computes the effective key length in}
133    \textcolor{comment}{//bytes T8}
134    t8 = (effectiveKeyLen + 7) / 8;
135 
136    \textcolor{comment}{//The mask TM has its 8 - (8*T8 - T1) least significant bits set}
137    tm = 0xFF >> (8 * t8 - effectiveKeyLen);
138 
139    \textcolor{comment}{//First loop of the key expansion operation}
140    \textcolor{keywordflow}{for}(i = keyLen; i < 128; i++)
141    \{
142       context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[i] = \hyperlink{rc2_8c_a5c4917b2883e8358befc82347b0cdbf0}{piTable}[(context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[i - 1] + context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[i - keyLen]) & 0xFF];
143    \}
144 
145    \textcolor{comment}{//The intermediate step's bitwise AND operation reduces the search space}
146    \textcolor{comment}{//for L[128-T8] so that the effective number of key bits is T1}
147    context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[128 - \hyperlink{pic32mx_2isr__support_8h_ae3781fcb0354b09ca351bdf76301666b}{t8}] = \hyperlink{rc2_8c_a5c4917b2883e8358befc82347b0cdbf0}{piTable}[context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[128 - \hyperlink{pic32mx_2isr__support_8h_ae3781fcb0354b09ca351bdf76301666b}{t8}] & tm];
148 
149    \textcolor{comment}{//Second loop of the key expansion operation}
150    \textcolor{keywordflow}{for}(i = 128 - t8; i > 0; i--)
151    \{
152       context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[i - 1] = \hyperlink{rc2_8c_a5c4917b2883e8358befc82347b0cdbf0}{piTable}[context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[i] ^ context->\hyperlink{structRc2Context_a4bae73d72c8d515d39d11364a4ff7d99}{l}[i + t8 - 1]];
153    \}
154 
155    \textcolor{comment}{//The low-order byte of each K word is given before the high-order byte}
156    \textcolor{keywordflow}{for}(i = 0; i < 64; i++)
157    \{
158       context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i] = \hyperlink{cpu__endian_8h_a7d0c2c1dc4394b648d1513efcaa33fcd}{letoh16}(context->\hyperlink{structRc2Context_a5f8fb41c7bc89383e86d498556f010e4}{k}[i]);
159    \}
160 
161    \textcolor{comment}{//No error to report}
162    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
163 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{rc2_8h_a79b39cc36e9dca07513b417dd01817c2}\label{rc2_8h_a79b39cc36e9dca07513b417dd01817c2}} 
\index{rc2.\+h@{rc2.\+h}!rc2\+Cipher\+Algo@{rc2\+Cipher\+Algo}}
\index{rc2\+Cipher\+Algo@{rc2\+Cipher\+Algo}!rc2.\+h@{rc2.\+h}}
\subsubsection{\texorpdfstring{rc2\+Cipher\+Algo}{rc2CipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} rc2\+Cipher\+Algo}



Definition at line 71 of file rc2.\+c.

