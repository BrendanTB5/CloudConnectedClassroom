\hypertarget{snmp__community__mib__impl_8c}{}\section{cyclone\+\_\+tcp/mibs/snmp\+\_\+community\+\_\+mib\+\_\+impl.c File Reference}
\label{snmp__community__mib__impl_8c}\index{cyclone\+\_\+tcp/mibs/snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{cyclone\+\_\+tcp/mibs/snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}


S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module implementation.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/mib\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/snmp\+\_\+community\+\_\+mib\+\_\+module.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/snmp\+\_\+community\+\_\+mib\+\_\+impl.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{snmp__community__mib__impl_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__community__mib__impl_8c_a380f13afa10c3111e90f36a26ef52f30}{snmp\+Community\+Mib\+Init} (void)
\begin{DoxyCompactList}\small\item\em S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module initialization. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__community__mib__impl_8c_aa1d7b0cb3fc99f7fefe212f3ee0aa393}{snmp\+Community\+Mib\+Load} (void $\ast$context)
\begin{DoxyCompactList}\small\item\em Load S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module. \end{DoxyCompactList}\item 
void \hyperlink{snmp__community__mib__impl_8c_a53440f8e871a38d9a20ac3491c133d2f}{snmp\+Community\+Mib\+Unload} (void $\ast$context)
\begin{DoxyCompactList}\small\item\em Unload S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module. \end{DoxyCompactList}\item 
void \hyperlink{snmp__community__mib__impl_8c_add884507ba675015c4daabaac182d1fb}{snmp\+Community\+Mib\+Lock} (void)
\begin{DoxyCompactList}\small\item\em Lock S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB base. \end{DoxyCompactList}\item 
void \hyperlink{snmp__community__mib__impl_8c_a94b4fb50e8d1fc4ffa8d823511f50675}{snmp\+Community\+Mib\+Unlock} (void)
\begin{DoxyCompactList}\small\item\em Unlock S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB base. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__community__mib__impl_8c_a983ce099152ed3a9a0ecc84dcc125f29}{snmp\+Community\+Mib\+Set\+Community\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t value\+Len, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} commit)
\begin{DoxyCompactList}\small\item\em Set snmp\+Community\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__community__mib__impl_8c_acc35447af9a144168ebed1c3b3c507f7}{snmp\+Community\+Mib\+Get\+Community\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get snmp\+Community\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__community__mib__impl_8c_a8fa9a41f58db7c3f1a0497dbfb60ee3f}{snmp\+Community\+Mib\+Get\+Next\+Community\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next snmp\+Community\+Entry object. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module implementation. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
The S\+N\+M\+P-\/\+M\+IB describes managed objects which describe the behavior of an S\+N\+MP entity. Refer to R\+FC 3418 for more details

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{snmp__community__mib__impl_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 37 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_acc35447af9a144168ebed1c3b3c507f7}\label{snmp__community__mib__impl_8c_acc35447af9a144168ebed1c3b3c507f7}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Get\+Community\+Entry@{snmp\+Community\+Mib\+Get\+Community\+Entry}}
\index{snmp\+Community\+Mib\+Get\+Community\+Entry@{snmp\+Community\+Mib\+Get\+Community\+Entry}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Get\+Community\+Entry()}{snmpCommunityMibGetCommunityEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Community\+Mib\+Get\+Community\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get snmp\+Community\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 368 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
370 \{
371    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
372    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
373    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} index[\hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN} + 1];
374    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
375    \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *community;
376 
377    \textcolor{comment}{//Point to the instance identifier}
378    n = \textcolor{keywordtype}{object}->oidLen;
379 
380    \textcolor{comment}{//snmpCommunityIndex is used as instance identifier}
381    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, index,
382       \hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
383    \textcolor{comment}{//Invalid instance identifier?}
384    \textcolor{keywordflow}{if}(error)
385       \textcolor{keywordflow}{return} error;
386 
387    \textcolor{comment}{//Sanity check}
388    \textcolor{keywordflow}{if}(n != oidLen)
389       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
390 
391    \textcolor{comment}{//Point to the SNMP agent context}
392    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.
      \hyperlink{structSnmpCommunityMibBase_a0edf57727272a9be6f920afcecbfa86d}{context};
393    \textcolor{comment}{//Sanity check}
394    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
395       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
396 
397    \textcolor{comment}{//Search the community table for the specified community string}
398    community = \hyperlink{snmp__agent__misc_8c_aac1d3ba9a7753dd2afd22d27f199f7a9}{snmpFindCommunityEntry}(context, index, strlen(index));
399    \textcolor{comment}{//Unknown community string?}
400    \textcolor{keywordflow}{if}(community == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
401       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
402 
403    \textcolor{comment}{//snmpCommunityName object?}
404    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityName"}))
405    \{
406       \textcolor{comment}{//Retrieve the length of the community string}
407       n = strlen(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name});
408 
409       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
410       \textcolor{keywordflow}{if}(*valueLen >= n)
411       \{
412          \textcolor{comment}{//Copy object value}
413          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, n);
414          \textcolor{comment}{//Return object length}
415          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
416       \}
417       \textcolor{keywordflow}{else}
418       \{
419          \textcolor{comment}{//Report an error}
420          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
421       \}
422    \}
423    \textcolor{comment}{//snmpCommunitySecurityName object?}
424    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunitySecurityName"}))
425    \{
426       \textcolor{comment}{//Retrieve the length of the community string}
427       n = strlen(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name});
428 
429       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
430       \textcolor{keywordflow}{if}(*valueLen >= n)
431       \{
432          \textcolor{comment}{//Copy object value}
433          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, n);
434          \textcolor{comment}{//Return object length}
435          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
436       \}
437       \textcolor{keywordflow}{else}
438       \{
439          \textcolor{comment}{//Report an error}
440          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
441       \}
442    \}
443    \textcolor{comment}{//snmpCommunityContextEngineID object?}
444    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityContextEngineID"}))
445    \{
446       \textcolor{comment}{//Retrieve the length of the context engine identifier}
447       n = context->contextEngineLen;
448 
449       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
450       \textcolor{keywordflow}{if}(*valueLen >= n)
451       \{
452          \textcolor{comment}{//Copy object value}
453          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, context->contextEngine, n);
454          \textcolor{comment}{//Return object length}
455          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
456       \}
457       \textcolor{keywordflow}{else}
458       \{
459          \textcolor{comment}{//Report an error}
460          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
461       \}
462    \}
463    \textcolor{comment}{//snmpCommunityContextName object?}
464    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityContextName"}))
465    \{
466       \textcolor{comment}{//Retrieve the length of the context name}
467       n = strlen(context->contextName);
468 
469       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
470       \textcolor{keywordflow}{if}(*valueLen >= n)
471       \{
472          \textcolor{comment}{//Copy object value}
473          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, context->contextName, n);
474          \textcolor{comment}{//Return object length}
475          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
476       \}
477       \textcolor{keywordflow}{else}
478       \{
479          \textcolor{comment}{//Report an error}
480          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
481       \}
482    \}
483    \textcolor{comment}{//snmpCommunityTransportTag object?}
484    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityTransportTag"}))
485    \{
486       \textcolor{comment}{//The default value is the empty string}
487       *valueLen = 0;
488    \}
489    \textcolor{comment}{//snmpCommunityStorageType object?}
490    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityStorageType"}))
491    \{
492       \textcolor{comment}{//Get the storage type for this conceptual row}
493       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE};
494    \}
495    \textcolor{comment}{//snmpCommunityStatus object?}
496    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityStatus"}))
497    \{
498       \textcolor{comment}{//Get the status of this conceptual row}
499       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = community->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status};
500    \}
501    \textcolor{comment}{//Unknown object?}
502    \textcolor{keywordflow}{else}
503    \{
504       \textcolor{comment}{//The specified object does not exist}
505       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
506    \}
507 
508    \textcolor{comment}{//Return status code}
509    \textcolor{keywordflow}{return} error;
510 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_a8fa9a41f58db7c3f1a0497dbfb60ee3f}\label{snmp__community__mib__impl_8c_a8fa9a41f58db7c3f1a0497dbfb60ee3f}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Get\+Next\+Community\+Entry@{snmp\+Community\+Mib\+Get\+Next\+Community\+Entry}}
\index{snmp\+Community\+Mib\+Get\+Next\+Community\+Entry@{snmp\+Community\+Mib\+Get\+Next\+Community\+Entry}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Get\+Next\+Community\+Entry()}{snmpCommunityMibGetNextCommunityEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Community\+Mib\+Get\+Next\+Community\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next snmp\+Community\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 523 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
525 \{
526    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
527    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
528    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
529    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
530    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
531    \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *entry;
532    \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *nextEntry;
533 
534    \textcolor{comment}{//Initialize variables}
535    nextEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
536 
537    \textcolor{comment}{//Point to the SNMP agent context}
538    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.
      \hyperlink{structSnmpCommunityMibBase_a0edf57727272a9be6f920afcecbfa86d}{context};
539    \textcolor{comment}{//Sanity check}
540    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
541       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
542 
543    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
544    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
545       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
546 
547    \textcolor{comment}{//Copy OID prefix}
548    memcpy(nextOid, object->oid, object->oidLen);
549 
550    \textcolor{comment}{//Loop through the list of community strings}
551    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_ad8464259eef69f485dbcd8c5085a58e8}{SNMP\_AGENT\_MAX\_COMMUNITIES}; i++)
552    \{
553       \textcolor{comment}{//Point to the current entry}
554       entry = &context->communityTable[i];
555 
556       \textcolor{comment}{//Check the status of the row}
557       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
558       \{
559          \textcolor{comment}{//Append the instance identifier to the OID prefix}
560          n = \textcolor{keywordtype}{object}->oidLen;
561 
562          \textcolor{comment}{//snmpCommunityIndex is used as instance identifier}
563          error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n, entry->
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
564          \textcolor{comment}{//Any error to report?}
565          \textcolor{keywordflow}{if}(error)
566             \textcolor{keywordflow}{return} error;
567 
568          \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
569          \textcolor{comment}{//follows the specified OID}
570          \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
571          \{
572             \textcolor{comment}{//Perform lexicographic comparison}
573             \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
574                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
575             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, nextEntry->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}) < 0)
576                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
577             \textcolor{keywordflow}{else}
578                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
579 
580             \textcolor{comment}{//Save the closest object identifier that follows the specified}
581             \textcolor{comment}{//OID in lexicographic order}
582             \textcolor{keywordflow}{if}(acceptable)
583                nextEntry = entry;
584          \}
585       \}
586    \}
587 
588    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
589    \textcolor{comment}{//of some object?}
590    \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
591       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
592 
593    \textcolor{comment}{//Append the instance identifier to the OID prefix}
594    n = \textcolor{keywordtype}{object}->oidLen;
595 
596    \textcolor{comment}{//snmpCommunityIndex is used as instance identifier}
597    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n, nextEntry->
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
598    \textcolor{comment}{//Any error to report?}
599    \textcolor{keywordflow}{if}(error)
600       \textcolor{keywordflow}{return} error;
601 
602    \textcolor{comment}{//Save the length of the resulting object identifier}
603    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
604    \textcolor{comment}{//Next object found}
605    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
606 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_a380f13afa10c3111e90f36a26ef52f30}\label{snmp__community__mib__impl_8c_a380f13afa10c3111e90f36a26ef52f30}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Init@{snmp\+Community\+Mib\+Init}}
\index{snmp\+Community\+Mib\+Init@{snmp\+Community\+Mib\+Init}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Init()}{snmpCommunityMibInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Community\+Mib\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module initialization. 

\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 60 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
61 \{
62    \textcolor{comment}{//Debug message}
63    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Initializing SNMP COMMUNITY MIB base...\(\backslash\)r\(\backslash\)n"});
64 
65    \textcolor{comment}{//Clear SNMP COMMUNITY MIB base}
66    memset(&\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}));
67 
68    \textcolor{comment}{//Successful processing}
69    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
70 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_aa1d7b0cb3fc99f7fefe212f3ee0aa393}\label{snmp__community__mib__impl_8c_aa1d7b0cb3fc99f7fefe212f3ee0aa393}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Load@{snmp\+Community\+Mib\+Load}}
\index{snmp\+Community\+Mib\+Load@{snmp\+Community\+Mib\+Load}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Load()}{snmpCommunityMibLoad()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Community\+Mib\+Load (\begin{DoxyParamCaption}\item[{void $\ast$}]{context }\end{DoxyParamCaption})}



Load S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 79 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
80 \{
81    \textcolor{comment}{//Register SNMP agent context}
82    \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a0edf57727272a9be6f920afcecbfa86d}{context} = context;
83 
84    \textcolor{comment}{//Successful processing}
85    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
86 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_add884507ba675015c4daabaac182d1fb}\label{snmp__community__mib__impl_8c_add884507ba675015c4daabaac182d1fb}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Lock@{snmp\+Community\+Mib\+Lock}}
\index{snmp\+Community\+Mib\+Lock@{snmp\+Community\+Mib\+Lock}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Lock()}{snmpCommunityMibLock()}}
{\footnotesize\ttfamily void snmp\+Community\+Mib\+Lock (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Lock S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB base. 



Definition at line 105 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
106 \{
107    \textcolor{comment}{//Clear temporary community}
108    memset(&\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpUserEntry}{SnmpUserEntry}));
109 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_a983ce099152ed3a9a0ecc84dcc125f29}\label{snmp__community__mib__impl_8c_a983ce099152ed3a9a0ecc84dcc125f29}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Set\+Community\+Entry@{snmp\+Community\+Mib\+Set\+Community\+Entry}}
\index{snmp\+Community\+Mib\+Set\+Community\+Entry@{snmp\+Community\+Mib\+Set\+Community\+Entry}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Set\+Community\+Entry()}{snmpCommunityMibSetCommunityEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Community\+Mib\+Set\+Community\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t}]{value\+Len,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{commit }\end{DoxyParamCaption})}



Set snmp\+Community\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em value} & Object value \\
\hline
\mbox{\tt in}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\mbox{\tt in}  & {\em commit} & This flag tells whether the changes shall be committed to the M\+IB base \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 135 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
137 \{
138    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
139    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
140    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} index[\hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN} + 1];
141    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
142    \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *community;
143 
144    \textcolor{comment}{//Point to the instance identifier}
145    n = \textcolor{keywordtype}{object}->oidLen;
146 
147    \textcolor{comment}{//snmpCommunityIndex is used as instance identifier}
148    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, index,
149       \hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
150    \textcolor{comment}{//Invalid instance identifier?}
151    \textcolor{keywordflow}{if}(error)
152       \textcolor{keywordflow}{return} error;
153 
154    \textcolor{comment}{//Sanity check}
155    \textcolor{keywordflow}{if}(n != oidLen)
156       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
157 
158    \textcolor{comment}{//Point to the SNMP agent context}
159    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.
      \hyperlink{structSnmpCommunityMibBase_a0edf57727272a9be6f920afcecbfa86d}{context};
160    \textcolor{comment}{//Sanity check}
161    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
162       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
163 
164    \textcolor{comment}{//Search the community table for the specified community string}
165    community = \hyperlink{snmp__agent__misc_8c_aac1d3ba9a7753dd2afd22d27f199f7a9}{snmpFindCommunityEntry}(context, index, strlen(index));
166 
167    \textcolor{comment}{//snmpCommunityName object?}
168    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityName"}))
169    \{
170       \textcolor{comment}{//Ensure the length of the community string is valid}
171       \textcolor{keywordflow}{if}(valueLen > \hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN})
172          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
173 
174       \textcolor{comment}{//Test if the conceptual row exists in the agent}
175       \textcolor{keywordflow}{if}(community != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
176       \{
177          \textcolor{comment}{//Commit phase?}
178          \textcolor{keywordflow}{if}(commit)
179          \{
180             \textcolor{comment}{//Set community string}
181             memcpy(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
182             \textcolor{comment}{//Properly terminate the string with a NULL character}
183             community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
184          \}
185       \}
186       \textcolor{keywordflow}{else}
187       \{
188          \textcolor{comment}{//Prepare phase?}
189          \textcolor{keywordflow}{if}(!commit)
190          \{
191             \textcolor{comment}{//Save the community string for later use}
192             memcpy(\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name},
193                \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
194 
195             \textcolor{comment}{//Properly terminate the string with a NULL character}
196             \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
197          \}
198       \}
199    \}
200    \textcolor{comment}{//snmpCommunitySecurityName object?}
201    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunitySecurityName"}))
202    \{
203       \textcolor{comment}{//Write access is not required}
204    \}
205    \textcolor{comment}{//snmpCommunityContextEngineID object?}
206    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityContextEngineID"}))
207    \{
208       \textcolor{comment}{//Write access is not required}
209    \}
210    \textcolor{comment}{//snmpCommunityContextName object?}
211    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityContextName"}))
212    \{
213       \textcolor{comment}{//Write access is not required}
214    \}
215    \textcolor{comment}{//snmpCommunityTransportTag object?}
216    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityTransportTag"}))
217    \{
218       \textcolor{comment}{//Write access is not required}
219    \}
220    \textcolor{comment}{//snmpCommunityStorageType object?}
221    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityStorageType"}))
222    \{
223       \textcolor{comment}{//The snmpCommunityStorageType object specifies the storage type}
224       \textcolor{comment}{//for this conceptual row}
225       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa23d8d1e34813d8e160ef1e8f90df167d}{MIB\_STORAGE\_TYPE\_OTHER} &&
226          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE} &&
227          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa08c50a9fa5de427b5fe638fe82a2b40e}{MIB\_STORAGE\_TYPE\_NON\_VOLATILE} &&
228          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa42210747745ce2b0af7d81ca9ac81739}{MIB\_STORAGE\_TYPE\_PERMANENT} &&
229          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa319c608df40b9b341f4d6f13417a9850}{MIB\_STORAGE\_TYPE\_READ\_ONLY})
230       \{
231          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa89e595b6b9492cadd1e39bcf6b51255}{ERROR\_WRONG\_VALUE};
232       \}
233    \}
234    \textcolor{comment}{//snmpCommunityStatus object?}
235    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"snmpCommunityStatus"}))
236    \{
237       \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus} status;
238 
239       \textcolor{comment}{//Get row status}
240       status = (\hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
241 
242       \textcolor{comment}{//Check the value specified by the set operation}
243       \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE} ||
244          status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE})
245       \{
246          \textcolor{comment}{//No matching row found?}
247          \textcolor{keywordflow}{if}(community == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
248             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
249 
250          \textcolor{comment}{//Commit phase?}
251          \textcolor{keywordflow}{if}(commit)
252          \{
253             \textcolor{comment}{//Valid community string specified?}
254             \textcolor{keywordflow}{if}(\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
255                strcpy(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.
      \hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name});
256 
257             \textcolor{comment}{//A newly created row cannot be made active until a value has been}
258             \textcolor{comment}{//set for snmpCommunityName}
259             \textcolor{keywordflow}{if}(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}[0] == \textcolor{charliteral}{'\(\backslash\)0'})
260                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
261 
262             \textcolor{comment}{//Update the status of the conceptual row}
263             community->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} = status;
264          \}
265       \}
266       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a7e302e94aab90e40035ff0ad48c1aaac}{MIB\_ROW\_STATUS\_CREATE\_AND\_GO})
267       \{
268          \textcolor{comment}{//Row already instantiated?}
269          \textcolor{keywordflow}{if}(community != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
270             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
271 
272          \textcolor{comment}{//Create a new row}
273          community = \hyperlink{snmp__agent__misc_8c_ad1bc35f9a17a770f8a03e4674f8ebaa5}{snmpCreateCommunityEntry}(context);
274          \textcolor{comment}{//Row creation failed?}
275          \textcolor{keywordflow}{if}(community == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
276             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
277 
278          \textcolor{comment}{//Commit phase?}
279          \textcolor{keywordflow}{if}(commit)
280          \{
281             \textcolor{comment}{//Valid community string specified?}
282             \textcolor{keywordflow}{if}(\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
283             \{
284                \textcolor{comment}{//Save community string}
285                strcpy(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.
      \hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name});
286                \textcolor{comment}{//Set default access rights}
287                community->\hyperlink{structSnmpUserEntry_af0824f5ebfa463d31b6d9983def956eb}{mode} = \hyperlink{snmp__agent__usm_8h_a45fe7ae59b303bb7c3a6067ffe2ed5caace57b275f5ae1547ebcb27a6f5959548}{SNMP\_ACCESS\_READ\_WRITE};
288 
289                \textcolor{comment}{//The conceptual row is now available for use by the managed device}
290                community->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE};
291             \}
292             \textcolor{keywordflow}{else}
293             \{
294                \textcolor{comment}{//The newly created row cannot be made active}
295                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
296             \}
297          \}
298       \}
299       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a236ac2459eae20f25f78db63416b7ac2}{MIB\_ROW\_STATUS\_CREATE\_AND\_WAIT})
300       \{
301          \textcolor{comment}{//Row already instantiated?}
302          \textcolor{keywordflow}{if}(community != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
303             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
304 
305          \textcolor{comment}{//Create a new row}
306          community = \hyperlink{snmp__agent__misc_8c_ad1bc35f9a17a770f8a03e4674f8ebaa5}{snmpCreateCommunityEntry}(context);
307          \textcolor{comment}{//Row creation failed?}
308          \textcolor{keywordflow}{if}(community == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
309             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
310 
311          \textcolor{comment}{//Commit phase?}
312          \textcolor{keywordflow}{if}(commit)
313          \{
314             \textcolor{comment}{//Ensure the community string is valid}
315             \textcolor{keywordflow}{if}(\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.
      \hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}[0] == \textcolor{charliteral}{'\(\backslash\)0'})
316                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
317 
318             \textcolor{comment}{//Copy the community string}
319             strcpy(community->\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name}, \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.
      \hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}.\hyperlink{structSnmpUserEntry_a60ae402e93fecec705e4f7ff0755360f}{name});
320             \textcolor{comment}{//Set default access rights}
321             community->\hyperlink{structSnmpUserEntry_af0824f5ebfa463d31b6d9983def956eb}{mode} = \hyperlink{snmp__agent__usm_8h_a45fe7ae59b303bb7c3a6067ffe2ed5caace57b275f5ae1547ebcb27a6f5959548}{SNMP\_ACCESS\_READ\_WRITE};
322 
323             \textcolor{comment}{//Instances of all corresponding columns are now configured}
324             community->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE};
325          \}
326       \}
327       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a705e943dcc8e73d35667b8bdc20d639d}{MIB\_ROW\_STATUS\_DESTROY})
328       \{
329          \textcolor{comment}{//Test if the conceptual row exists in the agent}
330          \textcolor{keywordflow}{if}(community != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
331          \{
332             \textcolor{comment}{//Commit phase?}
333             \textcolor{keywordflow}{if}(commit)
334             \{
335                \textcolor{comment}{//Delete the conceptual row from the table}
336                community->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED};
337             \}
338          \}
339       \}
340       \textcolor{keywordflow}{else}
341       \{
342          \textcolor{comment}{//Unsupported action}
343          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
344       \}
345    \}
346    \textcolor{comment}{//Unknown object?}
347    \textcolor{keywordflow}{else}
348    \{
349       \textcolor{comment}{//The specified object does not exist}
350       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
351    \}
352 
353    \textcolor{comment}{//Return status code}
354    \textcolor{keywordflow}{return} error;
355 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_a53440f8e871a38d9a20ac3491c133d2f}\label{snmp__community__mib__impl_8c_a53440f8e871a38d9a20ac3491c133d2f}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Unload@{snmp\+Community\+Mib\+Unload}}
\index{snmp\+Community\+Mib\+Unload@{snmp\+Community\+Mib\+Unload}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Unload()}{snmpCommunityMibUnload()}}
{\footnotesize\ttfamily void snmp\+Community\+Mib\+Unload (\begin{DoxyParamCaption}\item[{void $\ast$}]{context }\end{DoxyParamCaption})}



Unload S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB module. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}


Definition at line 94 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
95 \{
96    \textcolor{comment}{//Unregister SNMP agent context}
97    \hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a0edf57727272a9be6f920afcecbfa86d}{context} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
98 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__community__mib__impl_8c_a94b4fb50e8d1fc4ffa8d823511f50675}\label{snmp__community__mib__impl_8c_a94b4fb50e8d1fc4ffa8d823511f50675}} 
\index{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}!snmp\+Community\+Mib\+Unlock@{snmp\+Community\+Mib\+Unlock}}
\index{snmp\+Community\+Mib\+Unlock@{snmp\+Community\+Mib\+Unlock}!snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c@{snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{snmp\+Community\+Mib\+Unlock()}{snmpCommunityMibUnlock()}}
{\footnotesize\ttfamily void snmp\+Community\+Mib\+Unlock (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Unlock S\+N\+MP C\+O\+M\+M\+U\+N\+I\+TY M\+IB base. 



Definition at line 116 of file snmp\+\_\+community\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
117 \{
118    \textcolor{comment}{//Clear temporary user}
119    memset(&\hyperlink{snmp__community__mib__module_8c_a2080f4884fbd869cf20c5c21e6f69c25}{snmpCommunityMibBase}.\hyperlink{structSnmpCommunityMibBase_a1dc8d7fc590d78767ba81645320cb1e8}{tempCommunity}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpUserEntry}{SnmpUserEntry}));
120 \}
\end{DoxyCode}
