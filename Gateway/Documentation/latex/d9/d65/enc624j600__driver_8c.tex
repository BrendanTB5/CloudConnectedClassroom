\hypertarget{enc624j600__driver_8c}{}\section{cyclone\+\_\+tcp/drivers/eth/enc624j600\+\_\+driver.c File Reference}
\label{enc624j600__driver_8c}\index{cyclone\+\_\+tcp/drivers/eth/enc624j600\+\_\+driver.\+c@{cyclone\+\_\+tcp/drivers/eth/enc624j600\+\_\+driver.\+c}}


E\+N\+C624\+J600/\+E\+N\+C424\+J600 Ethernet controller.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}drivers/eth/enc624j600\+\_\+driver.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{enc624j600__driver_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_a880f48968c7969b328d5061cd3db0f36}{N\+I\+C\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{enc624j600__driver_8c_ab2d838d05174ea53d50302ee04207993}{enc624j600\+Init} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em E\+N\+C624\+J600 controller initialization. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a63284fa7ab79850eee775a0bbc81356a}{enc624j600\+Tick} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em E\+N\+C624\+J600 timer handler. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_af805e74519a6a5f9d27968a3f35306c9}{enc624j600\+Enable\+Irq} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Enable interrupts. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a09c32a282a4de835cc39d2c62835cb9c}{enc624j600\+Disable\+Irq} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Disable interrupts. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{enc624j600__driver_8c_a855805d3f9098ad2dcc31f74b3545506}{enc624j600\+Irq\+Handler} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em E\+N\+C624\+J600 interrupt service routine. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a07877a3539388c0a915032c9ada6dba3}{enc624j600\+Event\+Handler} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em E\+N\+C624\+J600 event handler. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{enc624j600__driver_8c_a857a2615433ced088163b65d5b7da1fd}{enc624j600\+Send\+Packet} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{structNetBuffer}{Net\+Buffer} $\ast$buffer, size\+\_\+t \hyperlink{pic32mz_2isr__support_8h_ac0542d92dfcd62c19170fd963f9e5052}{offset})
\begin{DoxyCompactList}\small\item\em Send a packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{enc624j600__driver_8c_a646c0173a15d04020d09dab20571976b}{enc624j600\+Receive\+Packet} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Receive a packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{enc624j600__driver_8c_a46f1ef629a905a369d2093536767a65e}{enc624j600\+Update\+Mac\+Addr\+Filter} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Configure M\+AC address filtering. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a8a60d3a10dee4be1087b6dfad12c7668}{enc624j600\+Update\+Mac\+Config} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Adjust M\+AC configuration parameters for proper operation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{enc624j600__driver_8c_ae822836009b82106c306e4d8e0e401c6}{enc624j600\+Soft\+Reset} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Reset E\+N\+C624\+J600 controller. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600\+Write\+Reg} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ndp_8h_a1b452a6c3ab338d73213b321b6750f2b}{address}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data})
\begin{DoxyCompactList}\small\item\em Write E\+N\+C624\+J600 register. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600\+Read\+Reg} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ndp_8h_a1b452a6c3ab338d73213b321b6750f2b}{address})
\begin{DoxyCompactList}\small\item\em Read E\+N\+C624\+J600 register. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_ae2e30c47a1b58763a4a7dd5d1113a0eb}{enc624j600\+Write\+Phy\+Reg} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ndp_8h_a1b452a6c3ab338d73213b321b6750f2b}{address}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data})
\begin{DoxyCompactList}\small\item\em Write P\+HY register. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{enc624j600__driver_8c_afba8d8989f734c9a0010718baeda6c1d}{enc624j600\+Read\+Phy\+Reg} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ndp_8h_a1b452a6c3ab338d73213b321b6750f2b}{address})
\begin{DoxyCompactList}\small\item\em Read P\+HY register. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a026b75def8245ece5d36d7fb5b2e3ca3}{enc624j600\+Write\+Buffer} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{web__socket_8h_a5c1b56e6bccc2a95dbddf1a08e56e87d}{opcode}, const \hyperlink{structNetBuffer}{Net\+Buffer} $\ast$buffer, size\+\_\+t \hyperlink{pic32mz_2isr__support_8h_ac0542d92dfcd62c19170fd963f9e5052}{offset})
\begin{DoxyCompactList}\small\item\em Write S\+R\+AM buffer. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}{enc624j600\+Read\+Buffer} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{web__socket_8h_a5c1b56e6bccc2a95dbddf1a08e56e87d}{opcode}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Read S\+R\+AM buffer. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600\+Set\+Bit} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ndp_8h_a1b452a6c3ab338d73213b321b6750f2b}{address}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask})
\begin{DoxyCompactList}\small\item\em Set bit field. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600\+Clear\+Bit} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{ndp_8h_a1b452a6c3ab338d73213b321b6750f2b}{address}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask})
\begin{DoxyCompactList}\small\item\em Clear bit field. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{enc624j600__driver_8c_aeb6656f1989ed3979b48f528e60c2966}{enc624j600\+Calc\+Crc} (const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em C\+RC calculation using the polynomial 0x4\+C11\+D\+B7. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_a91817cc524dda73de3d135cd64668434}{enc624j600\+Dump\+Reg} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Dump registers for debugging purpose. \end{DoxyCompactList}\item 
void \hyperlink{enc624j600__driver_8c_ad63941a9495eba499dfabe0c3af6509e}{enc624j600\+Dump\+Phy\+Reg} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Dump P\+HY registers for debugging purpose. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structNicDriver}{Nic\+Driver} \hyperlink{enc624j600__driver_8c_a2e66975c44a1a4d032d4c32a084ecd95}{enc624j600\+Driver}
\begin{DoxyCompactList}\small\item\em E\+N\+C624\+J600 driver. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
E\+N\+C624\+J600/\+E\+N\+C424\+J600 Ethernet controller. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{enc624j600__driver_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{enc624j600__driver_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_a880f48968c7969b328d5061cd3db0f36}{N\+I\+C\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file enc624j600\+\_\+driver.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{enc624j600__driver_8c_aeb6656f1989ed3979b48f528e60c2966}\label{enc624j600__driver_8c_aeb6656f1989ed3979b48f528e60c2966}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Calc\+Crc@{enc624j600\+Calc\+Crc}}
\index{enc624j600\+Calc\+Crc@{enc624j600\+Calc\+Crc}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Calc\+Crc()}{enc624j600CalcCrc()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} enc624j600\+Calc\+Crc (\begin{DoxyParamCaption}\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



C\+RC calculation using the polynomial 0x4\+C11\+D\+B7. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the data over which to calculate the C\+RC \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Resulting C\+RC value 
\end{DoxyReturn}


Definition at line 854 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
855 \{
856    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
857    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
858 
859    \textcolor{comment}{//Point to the data over which to calculate the CRC}
860    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
861    \textcolor{comment}{//CRC preset value}
862    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} crc = 0xFFFFFFFF;
863 
864    \textcolor{comment}{//Loop through data}
865    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
866    \{
867       \textcolor{comment}{//The message is processed bit by bit}
868       \textcolor{keywordflow}{for}(j = 0; j < 8; j++)
869       \{
870          \textcolor{comment}{//Update CRC value}
871          \textcolor{keywordflow}{if}(((crc >> 31) ^ (p[i] >> j)) & 0x01)
872             crc = (crc << 1) ^ 0x04C11DB7;
873          \textcolor{keywordflow}{else}
874             crc = crc << 1;
875       \}
876    \}
877 
878    \textcolor{comment}{//Return CRC value}
879    \textcolor{keywordflow}{return} crc;
880 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}\label{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Clear\+Bit@{enc624j600\+Clear\+Bit}}
\index{enc624j600\+Clear\+Bit@{enc624j600\+Clear\+Bit}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Clear\+Bit()}{enc624j600ClearBit()}}
{\footnotesize\ttfamily void enc624j600\+Clear\+Bit (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{address,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{mask }\end{DoxyParamCaption})}



Clear bit field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em address} & Register address \\
\hline
\mbox{\tt in}  & {\em mask} & Bits to clear in the target register \\
\hline
\end{DoxyParams}


Definition at line 828 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
830 \{
831    \textcolor{comment}{//Pull the CS pin low}
832    interface->spiDriver->assertCs();
833 
834    \textcolor{comment}{//Write opcode}
835    interface->spiDriver->transfer(\hyperlink{enc624j600__driver_8h_a01410139217b023fcec069bdd2de1528}{ENC624J600\_CMD\_BFCU});
836    \textcolor{comment}{//Write register address}
837    interface->spiDriver->transfer(\hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address});
838    \textcolor{comment}{//Write bit mask}
839    interface->spiDriver->transfer(\hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}));
840    interface->spiDriver->transfer(\hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}));
841 
842    \textcolor{comment}{//Terminate the operation by raising the CS pin}
843    interface->spiDriver->deassertCs();
844 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a09c32a282a4de835cc39d2c62835cb9c}\label{enc624j600__driver_8c_a09c32a282a4de835cc39d2c62835cb9c}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Disable\+Irq@{enc624j600\+Disable\+Irq}}
\index{enc624j600\+Disable\+Irq@{enc624j600\+Disable\+Irq}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Disable\+Irq()}{enc624j600DisableIrq()}}
{\footnotesize\ttfamily void enc624j600\+Disable\+Irq (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Disable interrupts. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 200 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
201 \{
202    \textcolor{comment}{//Disable interrupts}
203    interface->extIntDriver->disableIrq();
204 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_ad63941a9495eba499dfabe0c3af6509e}\label{enc624j600__driver_8c_ad63941a9495eba499dfabe0c3af6509e}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Dump\+Phy\+Reg@{enc624j600\+Dump\+Phy\+Reg}}
\index{enc624j600\+Dump\+Phy\+Reg@{enc624j600\+Dump\+Phy\+Reg}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Dump\+Phy\+Reg()}{enc624j600DumpPhyReg()}}
{\footnotesize\ttfamily void enc624j600\+Dump\+Phy\+Reg (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Dump P\+HY registers for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 928 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
929 \{
930 \textcolor{preprocessor}{#if (TRACE\_LEVEL >= TRACE\_LEVEL\_DEBUG)}
931    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} i;
932 
933    \textcolor{comment}{//Loop through PHY registers}
934    \textcolor{keywordflow}{for}(i = 0; i < 32; i++)
935    \{
936       \textcolor{comment}{//Display current PHY register}
937       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"%02"} PRIX8 \textcolor{stringliteral}{": 0x%04"} PRIX16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, i, 
      \hyperlink{enc624j600__driver_8c_afba8d8989f734c9a0010718baeda6c1d}{enc624j600ReadPhyReg}(interface, i));
938    \}
939 
940    \textcolor{comment}{//Terminate with a line feed}
941    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"});
942 \textcolor{preprocessor}{#endif}
943 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a91817cc524dda73de3d135cd64668434}\label{enc624j600__driver_8c_a91817cc524dda73de3d135cd64668434}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Dump\+Reg@{enc624j600\+Dump\+Reg}}
\index{enc624j600\+Dump\+Reg@{enc624j600\+Dump\+Reg}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Dump\+Reg()}{enc624j600DumpReg()}}
{\footnotesize\ttfamily void enc624j600\+Dump\+Reg (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Dump registers for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 888 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
889 \{
890 \textcolor{preprocessor}{#if (TRACE\_LEVEL >= TRACE\_LEVEL\_DEBUG)}
891    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} i;
892    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} bank;
893    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address};
894 
895    \textcolor{comment}{//Display header}
896    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Bank 0  Bank 1  Bank 2  Bank 3  Unbanked\(\backslash\)r\(\backslash\)n"});
897 
898    \textcolor{comment}{//Loop through register addresses}
899    \textcolor{keywordflow}{for}(i = 0; i < 32; i += 2)
900    \{
901       \textcolor{comment}{//Display register address}
902       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"%02"} PRIX8 \textcolor{stringliteral}{": "}, i);
903 
904       \textcolor{comment}{//Loop through bank numbers}
905       \textcolor{keywordflow}{for}(bank = 0; bank < 5; bank++)
906       \{
907          \textcolor{comment}{//Format register address}
908          address = 0x7E00 | (bank << 5) | i;
909          \textcolor{comment}{//Display register contents}
910          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"0x%04"} PRIX16 \textcolor{stringliteral}{"  "}, \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, address)
      );
911       \}
912 
913       \textcolor{comment}{//Jump to the following line}
914       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"});
915    \}
916 
917    \textcolor{comment}{//Terminate with a line feed}
918    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"});
919 \textcolor{preprocessor}{#endif}
920 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_af805e74519a6a5f9d27968a3f35306c9}\label{enc624j600__driver_8c_af805e74519a6a5f9d27968a3f35306c9}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Enable\+Irq@{enc624j600\+Enable\+Irq}}
\index{enc624j600\+Enable\+Irq@{enc624j600\+Enable\+Irq}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Enable\+Irq()}{enc624j600EnableIrq()}}
{\footnotesize\ttfamily void enc624j600\+Enable\+Irq (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Enable interrupts. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 188 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
189 \{
190    \textcolor{comment}{//Enable interrupts}
191    interface->extIntDriver->enableIrq();
192 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a07877a3539388c0a915032c9ada6dba3}\label{enc624j600__driver_8c_a07877a3539388c0a915032c9ada6dba3}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Event\+Handler@{enc624j600\+Event\+Handler}}
\index{enc624j600\+Event\+Handler@{enc624j600\+Event\+Handler}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Event\+Handler()}{enc624j600EventHandler()}}
{\footnotesize\ttfamily void enc624j600\+Event\+Handler (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



E\+N\+C624\+J600 event handler. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 275 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
276 \{
277    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
278    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} status;
279    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
280 
281    \textcolor{comment}{//Read interrupt status register}
282    status = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR});
283 
284    \textcolor{comment}{//Check whether the link state has changed}
285    \textcolor{keywordflow}{if}(status & \hyperlink{enc28j60__driver_8h_a9fe92c2717bcd98bb324409ed2d84210}{EIR\_LINKIF})
286    \{
287       \textcolor{comment}{//Clear interrupt flag}
288       \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR}, EIR\_LINKIF);
289       \textcolor{comment}{//Read Ethernet status register}
290       value = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a40948a3717a1434abc1ad51c6cb53805}{ENC624J600\_REG\_ESTAT});
291 
292       \textcolor{comment}{//Check link state}
293       \textcolor{keywordflow}{if}(value & \hyperlink{enc624j600__driver_8h_a02c8b48aace5567abc7817f4e066d722}{ESTAT\_PHYLNK})
294       \{
295          \textcolor{comment}{//Read PHY status register 3}
296          value = \hyperlink{enc624j600__driver_8c_afba8d8989f734c9a0010718baeda6c1d}{enc624j600ReadPhyReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a662c80e3a5aed456075c447e2a35fcdc}{ENC624J600\_PHY\_REG\_PHSTAT3});
297 
298          \textcolor{comment}{//Get current speed}
299          \textcolor{keywordflow}{if}(value & \hyperlink{enc624j600__driver_8h_a0343289febd93838d5dadfa8c598bcaf}{PHSTAT3\_SPDDPX1})
300             interface->linkSpeed = \hyperlink{nic_8h_afef666155a43e0a2a3a1f0df9e50bab4a3001394d2b59b22c97f6957e07ca28fd}{NIC\_LINK\_SPEED\_100MBPS};
301          \textcolor{keywordflow}{else}
302             interface->linkSpeed = \hyperlink{nic_8h_afef666155a43e0a2a3a1f0df9e50bab4a43656b0244470a43d497c77353f3da84}{NIC\_LINK\_SPEED\_10MBPS};
303 
304          \textcolor{comment}{//Determine the new duplex mode}
305          \textcolor{keywordflow}{if}(value & \hyperlink{enc624j600__driver_8h_a5add533a4b74049f06e6f34935814f9b}{PHSTAT3\_SPDDPX2})
306             interface->duplexMode = \hyperlink{nic_8h_ae96e77ca948a3796e2d1900a73f133daa2c75584234136d8fd79f372116d26340}{NIC\_FULL\_DUPLEX\_MODE};
307          \textcolor{keywordflow}{else}
308             interface->duplexMode = \hyperlink{nic_8h_ae96e77ca948a3796e2d1900a73f133daa60856f1c6ecbcb1227b653fb48205f41}{NIC\_HALF\_DUPLEX\_MODE};
309 
310          \textcolor{comment}{//Link is up}
311          interface->linkState = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
312 
313          \textcolor{comment}{//Update MAC configuration parameters for proper operation}
314          \hyperlink{enc624j600__driver_8c_a8a60d3a10dee4be1087b6dfad12c7668}{enc624j600UpdateMacConfig}(interface);
315       \}
316       \textcolor{keywordflow}{else}
317       \{
318          \textcolor{comment}{//Link is down}
319          interface->linkState = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
320       \}
321 
322       \textcolor{comment}{//Process link state change event}
323       \hyperlink{nic_8c_ae9054795c5d49a4db97396bf1d16b413}{nicNotifyLinkChange}(interface);
324    \}
325 
326    \textcolor{comment}{//Check whether a packet has been received?}
327    \textcolor{keywordflow}{if}(status & \hyperlink{enc28j60__driver_8h_a11fcfa608a5040c26cc8f2c2d314ba80}{EIR\_PKTIF})
328    \{
329       \textcolor{comment}{//Clear interrupt flag}
330       \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR}, EIR\_PKTIF);
331 
332       \textcolor{comment}{//Process all pending packets}
333       \textcolor{keywordflow}{do}
334       \{
335          \textcolor{comment}{//Read incoming packet}
336          error = \hyperlink{enc624j600__driver_8c_a646c0173a15d04020d09dab20571976b}{enc624j600ReceivePacket}(interface);
337 
338          \textcolor{comment}{//No more data in the receive buffer?}
339       \} \textcolor{keywordflow}{while}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca838a7a87abb42b87d6862e98849fab2d}{ERROR\_BUFFER\_EMPTY});
340    \}
341 
342    \textcolor{comment}{//Re-enable LINKIE and PKTIE interrupts}
343    \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600SetBit}(interface, \hyperlink{enc624j600__driver_8h_a3ced4129d53a27f5678be8ca79b89734}{ENC624J600\_REG\_EIE}, 
      \hyperlink{enc28j60__driver_8h_aad07156c0f73a7ec41d0c385f2c091b1}{EIE\_LINKIE} | \hyperlink{enc28j60__driver_8h_a1171f52b3a35649112ce502a26834bdd}{EIE\_PKTIE});
344 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_ab2d838d05174ea53d50302ee04207993}\label{enc624j600__driver_8c_ab2d838d05174ea53d50302ee04207993}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Init@{enc624j600\+Init}}
\index{enc624j600\+Init@{enc624j600\+Init}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Init()}{enc624j600Init()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} enc624j600\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



E\+N\+C624\+J600 controller initialization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 71 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
72 \{
73    \hyperlink{structEnc624j600Context}{Enc624j600Context} *context;
74 
75    \textcolor{comment}{//Debug message}
76    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Initializing ENC624J600 Ethernet controller...\(\backslash\)r\(\backslash\)n"});
77 
78    \textcolor{comment}{//Initialize SPI}
79    interface->spiDriver->init();
80    \textcolor{comment}{//Initialize external interrupt line}
81    interface->extIntDriver->init();
82 
83    \textcolor{comment}{//Point to the driver context}
84    context = (\hyperlink{structEnc624j600Context}{Enc624j600Context} *) interface->nicContext;
85 
86    \textcolor{comment}{//Initialize driver specific variables}
87    context->\hyperlink{structEnc624j600Context_a6167e33bcd67d0631bc49a1761921160}{nextPacket} = \hyperlink{enc624j600__driver_8h_a09002b1c855a83847f2aef49570612c9}{ENC624J600\_RX\_BUFFER\_START};
88 
89    \textcolor{comment}{//Allocate RX buffer}
90    context->\hyperlink{structEnc624j600Context_a305c1bc66c5b374d8fa7ce52bdcb3b73}{rxBuffer} = \hyperlink{net__mem_8c_abe64a91cd872768817509cc08eed6689}{memPoolAlloc}(\hyperlink{ethernet_8h_aa40569f19ea64ddc1cf273d095e517f4}{ETH\_MAX\_FRAME\_SIZE});
91    \textcolor{comment}{//Failed to allocate memory?}
92    \textcolor{keywordflow}{if}(context->\hyperlink{structEnc624j600Context_a305c1bc66c5b374d8fa7ce52bdcb3b73}{rxBuffer} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
93       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
94 
95    \textcolor{comment}{//Issue a system reset}
96    \hyperlink{enc624j600__driver_8c_ae822836009b82106c306e4d8e0e401c6}{enc624j600SoftReset}(interface);
97 
98    \textcolor{comment}{//Disable CLKOUT output}
99    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a8c773266e645d5280ddffa8ff8740a7b}{ENC624J600\_REG\_ECON2}, 
      \hyperlink{enc624j600__driver_8h_a88b59455e4440018f6754704348260ac}{ECON2\_ETHEN} | \hyperlink{enc624j600__driver_8h_afb77920109aebf548d6fe187e768891b}{ECON2\_STRCH});
100 
101    \textcolor{comment}{//Optionally set the station MAC address}
102    \textcolor{keywordflow}{if}(\hyperlink{ethernet_8h_a800d9f928930baf027e925976c44b9b2}{macCompAddr}(&interface->macAddr, &\hyperlink{ethernet_8c_a24b2ce78dd643fe028d2e18c3b503f1f}{MAC\_UNSPECIFIED\_ADDR}))
103    \{
104       \textcolor{comment}{//Use the factory preprogrammed station address}
105       interface->macAddr.w[0] = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a72ebb8f3b6e19e647824743ff3a6f17e}{ENC624J600\_REG\_MAADR1});
106       interface->macAddr.w[1] = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a83e6c352a62dcac6a7d7a2fcf0d6867d}{ENC624J600\_REG\_MAADR2});
107       interface->macAddr.w[2] = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a28e0b93234a12a95d9b7ec423edea06f}{ENC624J600\_REG\_MAADR3});
108 
109       \textcolor{comment}{//Generate the 64-bit interface identifier}
110       \hyperlink{ethernet_8c_abbe0cae70748acbaa8c4d840ee764424}{macAddrToEui64}(&interface->macAddr, &interface->eui64);
111    \}
112    \textcolor{keywordflow}{else}
113    \{
114       \textcolor{comment}{//Override the factory preprogrammed address}
115       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a72ebb8f3b6e19e647824743ff3a6f17e}{ENC624J600\_REG\_MAADR1}, interface
      ->macAddr.w[0]);
116       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a83e6c352a62dcac6a7d7a2fcf0d6867d}{ENC624J600\_REG\_MAADR2}, interface
      ->macAddr.w[1]);
117       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a28e0b93234a12a95d9b7ec423edea06f}{ENC624J600\_REG\_MAADR3}, interface
      ->macAddr.w[2]);
118    \}
119 
120    \textcolor{comment}{//Set receive buffer location}
121    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_aba7a6fdf368ccb9bae7810a372181b44}{ENC624J600\_REG\_ERXST}, 
      \hyperlink{enc624j600__driver_8h_a09002b1c855a83847f2aef49570612c9}{ENC624J600\_RX\_BUFFER\_START});
122    \textcolor{comment}{//Program the tail pointer ERXTAIL to the last even address of the buffer}
123    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_ad8fc1a7bc6f75834ed5bf0433a8ff69d}{ENC624J600\_REG\_ERXTAIL}, 
      \hyperlink{enc624j600__driver_8h_abe09f052b14ef48b7b7f5d419d402b20}{ENC624J600\_RX\_BUFFER\_STOP});
124 
125    \textcolor{comment}{//Configure the receive filters}
126    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a9b31e982f83a3776581e6d566c7a27cb}{ENC624J600\_REG\_ERXFCON}, 
      \hyperlink{enc28j60__driver_8h_adcc185e8904cddc96ace6ee23660db6c}{ERXFCON\_HTEN} |
127       \hyperlink{enc28j60__driver_8h_ab24fd0fbd4dd4ef84ee86db0d20f655c}{ERXFCON\_CRCEN} | \hyperlink{enc624j600__driver_8h_afde6eff67f49fbc01ea5216b82459c3e}{ERXFCON\_RUNTEN} | \hyperlink{enc28j60__driver_8h_af22d9ed047710a75f3226e12945e7014}{ERXFCON\_UCEN} | 
      \hyperlink{enc28j60__driver_8h_a1b56128234d0790b0d7253f4357d2adb}{ERXFCON\_BCEN});
128 
129    \textcolor{comment}{//Initialize the hash table}
130    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_abf186b7edefd37c99bad10c5f4bd7bfb}{ENC624J600\_REG\_EHT1}, 0x0000);
131    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a127e3526c587bb75d18fa52db5c7ad10}{ENC624J600\_REG\_EHT2}, 0x0000);
132    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a2c555301faeee33c62c97fd342ad59ac}{ENC624J600\_REG\_EHT3}, 0x0000);
133    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a9991c92ee5e2dde62a3fe40b0beffced}{ENC624J600\_REG\_EHT4}, 0x0000);
134 
135    \textcolor{comment}{//All short frames will be zero-padded to 60 bytes and a valid CRC is then appended}
136    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a6fd259b63458b6cb675a02ae980d5c68}{ENC624J600\_REG\_MACON2},
137       \hyperlink{enc624j600__driver_8h_a27dd3a1c8d4a3c5aa699991d0230636e}{MACON2\_DEFER} | \hyperlink{enc624j600__driver_8h_a0dd0ee803c20736eb7659b6a527b975c}{MACON2\_PADCFG0} | \hyperlink{enc624j600__driver_8h_a882cdc5cbcabe962c2fe6cc8b36af1b3}{MACON2\_TXCRCEN} | 
      \hyperlink{enc624j600__driver_8h_a3b5660867c4a0ba65787c8c5e024728c}{MACON2\_R1});
138 
139    \textcolor{comment}{//Program the MAMXFL register with the maximum frame length to be accepted}
140    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a1668d2cc8f1cb042d4be1f455e8098e3}{ENC624J600\_REG\_MAMXFL}, 
      \hyperlink{ethernet_8h_aa40569f19ea64ddc1cf273d095e517f4}{ETH\_MAX\_FRAME\_SIZE});
141 
142    \textcolor{comment}{//PHY initialization}
143    \hyperlink{enc624j600__driver_8c_ae2e30c47a1b58763a4a7dd5d1113a0eb}{enc624j600WritePhyReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a68e2ec65e66775e3568abbc207741364}{ENC624J600\_PHY\_REG\_PHANA}, \hyperlink{enc624j600__driver_8h_aa92783e65681de5f7b622003e087f56e}{PHANA\_ADPAUS0} |
144       \hyperlink{enc624j600__driver_8h_a4531b7c1ab429c251373e29f051e32d9}{PHANA\_AD100FD} | \hyperlink{enc624j600__driver_8h_a5c287001fc09f061e4b9bcbfdfdb00b9}{PHANA\_AD100} | \hyperlink{enc624j600__driver_8h_a40006bf4f8a6cf649ad5059f866e6e9a}{PHANA\_AD10FD} | 
      \hyperlink{enc624j600__driver_8h_ab599614616e6bacac155a3c218dc64df}{PHANA\_AD10} | \hyperlink{enc624j600__driver_8h_abd64966dc8e4d0e5417a948efc99d4d1}{PHANA\_ADIEEE0});
145 
146    \textcolor{comment}{//Clear interrupt flags}
147    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR}, 0x0000);
148 
149    \textcolor{comment}{//Configure interrupts as desired}
150    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a3ced4129d53a27f5678be8ca79b89734}{ENC624J600\_REG\_EIE}, 
      \hyperlink{enc28j60__driver_8h_a6e7ec3932ab30e65b5ea60440053a4bc}{EIE\_INTIE} |
151       \hyperlink{enc28j60__driver_8h_aad07156c0f73a7ec41d0c385f2c091b1}{EIE\_LINKIE} | \hyperlink{enc28j60__driver_8h_a1171f52b3a35649112ce502a26834bdd}{EIE\_PKTIE} | \hyperlink{enc28j60__driver_8h_aa2c4d9a05314661d9b5ba5c106097d0f}{EIE\_TXIE} | \hyperlink{enc624j600__driver_8h_aa16623bc8f272101a9301af20a390051}{EIE\_TXABTIE});
152 
153    \textcolor{comment}{//Set RXEN to enable reception}
154    \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600SetBit}(interface, \hyperlink{enc624j600__driver_8h_a2b790669f834c6c0d31fbcf9416e88ac}{ENC624J600\_REG\_ECON1}, 
      \hyperlink{enc28j60__driver_8h_ace8508fae6ed0c6d29e8879194de5fbc}{ECON1\_RXEN});
155 
156    \textcolor{comment}{//Dump registers for debugging purpose}
157    \hyperlink{enc624j600__driver_8c_a91817cc524dda73de3d135cd64668434}{enc624j600DumpReg}(interface);
158    \hyperlink{enc624j600__driver_8c_ad63941a9495eba499dfabe0c3af6509e}{enc624j600DumpPhyReg}(interface);
159 
160    \textcolor{comment}{//Accept any packets from the upper layer}
161    \hyperlink{os__port__chibios_8c_afc1d64fc90afbf03baecfa636bb99ff7}{osSetEvent}(&interface->nicTxEvent);
162 
163    \textcolor{comment}{//Force the TCP/IP stack to poll the link state at startup}
164    interface->nicEvent = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
165    \textcolor{comment}{//Notify the TCP/IP stack of the event}
166    \hyperlink{os__port__chibios_8c_afc1d64fc90afbf03baecfa636bb99ff7}{osSetEvent}(&\hyperlink{net_8c_a4ad5a175123589d00e402e0c1c842fdc}{netEvent});
167 
168    \textcolor{comment}{//Successful initialization}
169    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
170 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a855805d3f9098ad2dcc31f74b3545506}\label{enc624j600__driver_8c_a855805d3f9098ad2dcc31f74b3545506}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Irq\+Handler@{enc624j600\+Irq\+Handler}}
\index{enc624j600\+Irq\+Handler@{enc624j600\+Irq\+Handler}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Irq\+Handler()}{enc624j600IrqHandler()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} enc624j600\+Irq\+Handler (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



E\+N\+C624\+J600 interrupt service routine. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if a higher priority task must be woken. Else F\+A\+L\+SE is returned 
\end{DoxyReturn}


Definition at line 213 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
214 \{
215    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} flag;
216    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} status;
217 
218    \textcolor{comment}{//This flag will be set if a higher priority task must be woken}
219    flag = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
220 
221    \textcolor{comment}{//Clear the INTIE bit, immediately after an interrupt event}
222    \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a3ced4129d53a27f5678be8ca79b89734}{ENC624J600\_REG\_EIE}, 
      \hyperlink{enc28j60__driver_8h_a6e7ec3932ab30e65b5ea60440053a4bc}{EIE\_INTIE});
223 
224    \textcolor{comment}{//Read interrupt status register}
225    status = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR});
226 
227    \textcolor{comment}{//Link status change?}
228    \textcolor{keywordflow}{if}(status & \hyperlink{enc28j60__driver_8h_a9fe92c2717bcd98bb324409ed2d84210}{EIR\_LINKIF})
229    \{
230       \textcolor{comment}{//Disable LINKIE interrupt}
231       \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a3ced4129d53a27f5678be8ca79b89734}{ENC624J600\_REG\_EIE}, 
      \hyperlink{enc28j60__driver_8h_aad07156c0f73a7ec41d0c385f2c091b1}{EIE\_LINKIE});
232 
233       \textcolor{comment}{//Set event flag}
234       interface->nicEvent = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
235       \textcolor{comment}{//Notify the TCP/IP stack of the event}
236       flag |= \hyperlink{os__port__chibios_8c_aa30d505571a03dd645af374f40bd7016}{osSetEventFromIsr}(&\hyperlink{net_8c_a4ad5a175123589d00e402e0c1c842fdc}{netEvent});
237    \}
238 
239    \textcolor{comment}{//Packet received?}
240    \textcolor{keywordflow}{if}(status & \hyperlink{enc28j60__driver_8h_a11fcfa608a5040c26cc8f2c2d314ba80}{EIR\_PKTIF})
241    \{
242       \textcolor{comment}{//Disable PKTIE interrupt}
243       \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a3ced4129d53a27f5678be8ca79b89734}{ENC624J600\_REG\_EIE}, 
      \hyperlink{enc28j60__driver_8h_a1171f52b3a35649112ce502a26834bdd}{EIE\_PKTIE});
244 
245       \textcolor{comment}{//Set event flag}
246       interface->nicEvent = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
247       \textcolor{comment}{//Notify the TCP/IP stack of the event}
248       flag |= \hyperlink{os__port__chibios_8c_aa30d505571a03dd645af374f40bd7016}{osSetEventFromIsr}(&\hyperlink{net_8c_a4ad5a175123589d00e402e0c1c842fdc}{netEvent});
249    \}
250 
251    \textcolor{comment}{//Packet transmission complete?}
252    \textcolor{keywordflow}{if}(status & (\hyperlink{enc28j60__driver_8h_af193c0a7f0208c18b1d49668e68266e0}{EIR\_TXIF} | \hyperlink{enc624j600__driver_8h_acc6a087af71aa43d7edc4b62e96c7816}{EIR\_TXABTIF}))
253    \{
254       \textcolor{comment}{//Clear interrupt flags}
255       \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR}, 
      \hyperlink{enc28j60__driver_8h_af193c0a7f0208c18b1d49668e68266e0}{EIR\_TXIF} | \hyperlink{enc624j600__driver_8h_acc6a087af71aa43d7edc4b62e96c7816}{EIR\_TXABTIF});
256 
257       \textcolor{comment}{//Notify the TCP/IP stack that the transmitter is ready to send}
258       flag |= \hyperlink{os__port__chibios_8c_aa30d505571a03dd645af374f40bd7016}{osSetEventFromIsr}(&interface->nicTxEvent);
259    \}
260 
261    \textcolor{comment}{//Once the interrupt has been serviced, the INTIE bit}
262    \textcolor{comment}{//is set again to re-enable interrupts}
263    \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600SetBit}(interface, \hyperlink{enc624j600__driver_8h_a3ced4129d53a27f5678be8ca79b89734}{ENC624J600\_REG\_EIE}, 
      \hyperlink{enc28j60__driver_8h_a6e7ec3932ab30e65b5ea60440053a4bc}{EIE\_INTIE});
264 
265    \textcolor{comment}{//A higher priority task must be woken?}
266    \textcolor{keywordflow}{return} flag;
267 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}\label{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Read\+Buffer@{enc624j600\+Read\+Buffer}}
\index{enc624j600\+Read\+Buffer@{enc624j600\+Read\+Buffer}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Read\+Buffer()}{enc624j600ReadBuffer()}}
{\footnotesize\ttfamily void enc624j600\+Read\+Buffer (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{opcode,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Read S\+R\+AM buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em opcode} & S\+R\+AM buffer operation \\
\hline
\mbox{\tt in}  & {\em data} & Buffer where to store the incoming data \\
\hline
\mbox{\tt in}  & {\em length} & Number of data to read \\
\hline
\end{DoxyParams}


Definition at line 775 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
777 \{
778    \textcolor{keywordtype}{size\_t} i;
779 
780    \textcolor{comment}{//Pull the CS pin low}
781    interface->spiDriver->assertCs();
782 
783    \textcolor{comment}{//Write opcode}
784    interface->spiDriver->transfer(\hyperlink{dns__common_8h_a5c1b56e6bccc2a95dbddf1a08e56e87d}{opcode});
785 
786    \textcolor{comment}{//Copy data from SRAM buffer}
787    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
788       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[i] = interface->spiDriver->transfer(0x00);
789 
790    \textcolor{comment}{//Terminate the operation by raising the CS pin}
791    interface->spiDriver->deassertCs();
792 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_afba8d8989f734c9a0010718baeda6c1d}\label{enc624j600__driver_8c_afba8d8989f734c9a0010718baeda6c1d}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Read\+Phy\+Reg@{enc624j600\+Read\+Phy\+Reg}}
\index{enc624j600\+Read\+Phy\+Reg@{enc624j600\+Read\+Phy\+Reg}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Read\+Phy\+Reg()}{enc624j600ReadPhyReg()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} enc624j600\+Read\+Phy\+Reg (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{address }\end{DoxyParamCaption})}



Read P\+HY register. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em address} & P\+HY register address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Register value 
\end{DoxyReturn}


Definition at line 695 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
696 \{
697    \textcolor{comment}{//Write the address of the PHY register to read from}
698    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a4884cbdb46d7e674dd9354cd98ca4048}{ENC624J600\_REG\_MIREGADR}, 
      \hyperlink{enc624j600__driver_8h_ab6c8ea2b43cf18b9fd50358b044143aa}{MIREGADR\_R8} | \hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address});
699    \textcolor{comment}{//Start read operation}
700    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a92ab899861051b00580d971207a8b919}{ENC624J600\_REG\_MICMD}, 
      \hyperlink{enc28j60__driver_8h_a5c468f805202bfc0737c024cbd1be32c}{MICMD\_MIIRD});
701 
702    \textcolor{comment}{//Wait at least 25.6us before polling the BUSY bit}
703    \hyperlink{os__port_8h_ad6cd1305d1073d4c3072f114828f8998}{usleep}(100);
704    \textcolor{comment}{//Wait for the read operation to complete}
705    \textcolor{keywordflow}{while}(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_af16115ee17dbaad47c53195d9120e8e8}{ENC624J600\_REG\_MISTAT}) & 
      \hyperlink{enc28j60__driver_8h_a22b9a31e2a6d031cd672eed1ad883ba8}{MISTAT\_BUSY});
706 
707    \textcolor{comment}{//Clear command register}
708    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a92ab899861051b00580d971207a8b919}{ENC624J600\_REG\_MICMD}, 0x00);
709 
710    \textcolor{comment}{//Return register contents}
711    \textcolor{keywordflow}{return} \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_ab653a69d6ef1b5115cccf2296add9156}{ENC624J600\_REG\_MIRD});
712 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}\label{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Read\+Reg@{enc624j600\+Read\+Reg}}
\index{enc624j600\+Read\+Reg@{enc624j600\+Read\+Reg}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Read\+Reg()}{enc624j600ReadReg()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} enc624j600\+Read\+Reg (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{address }\end{DoxyParamCaption})}



Read E\+N\+C624\+J600 register. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em address} & Register address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Register value 
\end{DoxyReturn}


Definition at line 644 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
645 \{
646    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
647 
648    \textcolor{comment}{//Pull the CS pin low}
649    interface->spiDriver->assertCs();
650 
651    \textcolor{comment}{//Write opcode}
652    interface->spiDriver->transfer(\hyperlink{enc624j600__driver_8h_a5f16845f7e322382caab4ea9a83c3cee}{ENC624J600\_CMD\_RCRU});
653    \textcolor{comment}{//Write register address}
654    interface->spiDriver->transfer(\hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address});
655    \textcolor{comment}{//Read the lower 8 bits of data}
656    data = interface->spiDriver->transfer(0x00);
657    \textcolor{comment}{//Read the upper 8 bits of data}
658    data |= interface->spiDriver->transfer(0x00) << 8;
659 
660    \textcolor{comment}{//Terminate the operation by raising the CS pin}
661    interface->spiDriver->deassertCs();
662 
663    \textcolor{comment}{//Return register contents}
664    \textcolor{keywordflow}{return} \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
665 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a646c0173a15d04020d09dab20571976b}\label{enc624j600__driver_8c_a646c0173a15d04020d09dab20571976b}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Receive\+Packet@{enc624j600\+Receive\+Packet}}
\index{enc624j600\+Receive\+Packet@{enc624j600\+Receive\+Packet}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Receive\+Packet()}{enc624j600ReceivePacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} enc624j600\+Receive\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Receive a packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 411 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
412 \{
413    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
414    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
415    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} status;
416    \hyperlink{structEnc624j600Context}{Enc624j600Context} *context;
417 
418    \textcolor{comment}{//Point to the driver context}
419    context = (\hyperlink{structEnc624j600Context}{Enc624j600Context} *) interface->nicContext;
420 
421    \textcolor{comment}{//Verify that a packet is waiting by ensuring that PKTCNT is non-zero}
422    \textcolor{keywordflow}{if}(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a40948a3717a1434abc1ad51c6cb53805}{ENC624J600\_REG\_ESTAT}) & 
      \hyperlink{enc624j600__driver_8h_ae3b475e5b5c3eeb793d9dab2b677d8b7}{ESTAT\_PKTCNT})
423    \{
424       \textcolor{comment}{//Point to the next packet}
425       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a4f420ed176c81b73e975763a1019dc0d}{ENC624J600\_REG\_ERXRDPT}, context
      ->\hyperlink{structEnc624j600Context_a6167e33bcd67d0631bc49a1761921160}{nextPacket});
426 
427       \textcolor{comment}{//Read the first two bytes, which are the address of the next packet}
428       \hyperlink{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}{enc624j600ReadBuffer}(interface, \hyperlink{enc624j600__driver_8h_ac85d55f0c937d273e37b671545769e81}{ENC624J600\_CMD\_RRXDATA},
429          (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &context->\hyperlink{structEnc624j600Context_a6167e33bcd67d0631bc49a1761921160}{nextPacket}, \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}));
430 
431       \textcolor{comment}{//Get the length of the received frame in bytes}
432       \hyperlink{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}{enc624j600ReadBuffer}(interface, \hyperlink{enc624j600__driver_8h_ac85d55f0c937d273e37b671545769e81}{ENC624J600\_CMD\_RRXDATA},
433          (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &n, \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}));
434 
435       \textcolor{comment}{//Read the receive status vector (RSV)}
436       \hyperlink{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}{enc624j600ReadBuffer}(interface, \hyperlink{enc624j600__driver_8h_ac85d55f0c937d273e37b671545769e81}{ENC624J600\_CMD\_RRXDATA},
437          (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &status, \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}));
438 
439       \textcolor{comment}{//Make sure no error occurred}
440       \textcolor{keywordflow}{if}(status & \hyperlink{enc28j60__driver_8h_a460a417f4684e6096570fa67cf47e437}{RSV\_RECEIVED\_OK})
441       \{
442          \textcolor{comment}{//Limit the number of data to read}
443          n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(n, \hyperlink{ethernet_8h_aa40569f19ea64ddc1cf273d095e517f4}{ETH\_MAX\_FRAME\_SIZE});
444          \textcolor{comment}{//Read the Ethernet frame}
445          \hyperlink{enc624j600__driver_8c_ae03d5897520d9134040d14a3acf0d1d9}{enc624j600ReadBuffer}(interface, 
      \hyperlink{enc624j600__driver_8h_ac85d55f0c937d273e37b671545769e81}{ENC624J600\_CMD\_RRXDATA}, context->\hyperlink{structEnc624j600Context_a305c1bc66c5b374d8fa7ce52bdcb3b73}{rxBuffer}, n);
446          \textcolor{comment}{//Valid packet received}
447          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
448       \}
449       \textcolor{keywordflow}{else}
450       \{
451          \textcolor{comment}{//The received packet contains an error}
452          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caccf6070ae61f26a48b523757a3168ad2}{ERROR\_INVALID\_PACKET};
453       \}
454 
455       \textcolor{comment}{//Update the ERXTAIL pointer value to the point where the packet}
456       \textcolor{comment}{//has been processed, taking care to wrap back at the end of the}
457       \textcolor{comment}{//received memory buffer}
458       \textcolor{keywordflow}{if}(context->\hyperlink{structEnc624j600Context_a6167e33bcd67d0631bc49a1761921160}{nextPacket} == \hyperlink{enc624j600__driver_8h_a09002b1c855a83847f2aef49570612c9}{ENC624J600\_RX\_BUFFER\_START})
459          \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_ad8fc1a7bc6f75834ed5bf0433a8ff69d}{ENC624J600\_REG\_ERXTAIL}, 
      \hyperlink{enc624j600__driver_8h_abe09f052b14ef48b7b7f5d419d402b20}{ENC624J600\_RX\_BUFFER\_STOP});
460       \textcolor{keywordflow}{else}
461          \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_ad8fc1a7bc6f75834ed5bf0433a8ff69d}{ENC624J600\_REG\_ERXTAIL}, 
      context->\hyperlink{structEnc624j600Context_a6167e33bcd67d0631bc49a1761921160}{nextPacket} - 2);
462 
463       \textcolor{comment}{//Set PKTDEC to decrement the PKTCNT bits}
464       \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600SetBit}(interface, \hyperlink{enc624j600__driver_8h_a2b790669f834c6c0d31fbcf9416e88ac}{ENC624J600\_REG\_ECON1}, 
      \hyperlink{enc624j600__driver_8h_a254258e87611fddb7f6798e4de74eef5}{ECON1\_PKTDEC});
465    \}
466    \textcolor{keywordflow}{else}
467    \{
468       \textcolor{comment}{//No more data in the receive buffer}
469       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca838a7a87abb42b87d6862e98849fab2d}{ERROR\_BUFFER\_EMPTY};
470    \}
471 
472    \textcolor{comment}{//Check whether a valid packet has been received}
473    \textcolor{keywordflow}{if}(!error)
474    \{
475       \textcolor{comment}{//Pass the packet to the upper layer}
476       \hyperlink{nic_8c_a5e5ef3b84649c36ebfe1e70edb1a0f75}{nicProcessPacket}(interface, context->\hyperlink{structEnc624j600Context_a305c1bc66c5b374d8fa7ce52bdcb3b73}{rxBuffer}, n);
477    \}
478 
479    \textcolor{comment}{//Return status code}
480    \textcolor{keywordflow}{return} error;
481 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a857a2615433ced088163b65d5b7da1fd}\label{enc624j600__driver_8c_a857a2615433ced088163b65d5b7da1fd}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Send\+Packet@{enc624j600\+Send\+Packet}}
\index{enc624j600\+Send\+Packet@{enc624j600\+Send\+Packet}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Send\+Packet()}{enc624j600SendPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} enc624j600\+Send\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{structNetBuffer}{Net\+Buffer} $\ast$}]{buffer,  }\item[{size\+\_\+t}]{offset }\end{DoxyParamCaption})}



Send a packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em buffer} & Multi-\/part buffer containing the data to send \\
\hline
\mbox{\tt in}  & {\em offset} & Offset to the first data byte \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 355 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
357 \{
358    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
359 
360    \textcolor{comment}{//Retrieve the length of the packet}
361    length = \hyperlink{net__mem_8c_ac9dbcd9e28e61d8f4f6d2e9af2607b68}{netBufferGetLength}(buffer) - \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset};
362 
363    \textcolor{comment}{//Check the frame length}
364    \textcolor{keywordflow}{if}(length > 1536)
365    \{
366       \textcolor{comment}{//The transmitter can accept another packet}
367       \hyperlink{os__port__chibios_8c_afc1d64fc90afbf03baecfa636bb99ff7}{osSetEvent}(&interface->nicTxEvent);
368       \textcolor{comment}{//Report an error}
369       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
370    \}
371 
372    \textcolor{comment}{//Make sure the link is up before transmitting the frame}
373    \textcolor{keywordflow}{if}(!interface->linkState)
374    \{
375       \textcolor{comment}{//The transmitter can accept another packet}
376       \hyperlink{os__port__chibios_8c_afc1d64fc90afbf03baecfa636bb99ff7}{osSetEvent}(&interface->nicTxEvent);
377       \textcolor{comment}{//Drop current packet}
378       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
379    \}
380 
381    \textcolor{comment}{//Ensure that the transmitter is ready to send}
382    \textcolor{keywordflow}{if}(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a2b790669f834c6c0d31fbcf9416e88ac}{ENC624J600\_REG\_ECON1}) & 
      \hyperlink{enc28j60__driver_8h_a3a2e731dca9ed10137c429b3d2db006f}{ECON1\_TXRTS})
383       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
384 
385    \textcolor{comment}{//Point to the SRAM buffer}
386    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a1cf7061711044505a98f49cf93d18a71}{ENC624J600\_REG\_EGPWRPT}, 
      \hyperlink{enc624j600__driver_8h_a2a43b1b527483fde78186904e451b65b}{ENC624J600\_TX\_BUFFER\_START});
387    \textcolor{comment}{//Copy the packet to the SRAM buffer}
388    \hyperlink{enc624j600__driver_8c_a026b75def8245ece5d36d7fb5b2e3ca3}{enc624j600WriteBuffer}(interface, \hyperlink{enc624j600__driver_8h_a4490732306dcfb87425ddc123c7b3e18}{ENC624J600\_CMD\_WGPDATA}, 
      buffer, \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset});
389 
390    \textcolor{comment}{//Program ETXST to the start address of the packet}
391    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a31115575fe7e5d002b24e24638f3d62d}{ENC624J600\_REG\_ETXST}, 
      \hyperlink{enc624j600__driver_8h_a2a43b1b527483fde78186904e451b65b}{ENC624J600\_TX\_BUFFER\_START});
392    \textcolor{comment}{//Program ETXLEN with the length of data copied to the memory}
393    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a1de6571d82a00bdfd8a4bb801ae72b1e}{ENC624J600\_REG\_ETXLEN}, length);
394 
395    \textcolor{comment}{//Clear TXIF and TXABTIF interrupt flags}
396    \hyperlink{enc624j600__driver_8c_a09faaca50d803a573ba96f4f47a7a332}{enc624j600ClearBit}(interface, \hyperlink{enc624j600__driver_8h_a75cd3b730e10d1c33915c9fee58f048f}{ENC624J600\_REG\_EIR}, 
      \hyperlink{enc28j60__driver_8h_af193c0a7f0208c18b1d49668e68266e0}{EIR\_TXIF} | \hyperlink{enc624j600__driver_8h_acc6a087af71aa43d7edc4b62e96c7816}{EIR\_TXABTIF});
397    \textcolor{comment}{//Set the TXRTS bit to initiate transmission}
398    \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600SetBit}(interface, \hyperlink{enc624j600__driver_8h_a2b790669f834c6c0d31fbcf9416e88ac}{ENC624J600\_REG\_ECON1}, ECON1\_TXRTS);
399 
400    \textcolor{comment}{//Successful processing}
401    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
402 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}\label{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Set\+Bit@{enc624j600\+Set\+Bit}}
\index{enc624j600\+Set\+Bit@{enc624j600\+Set\+Bit}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Set\+Bit()}{enc624j600SetBit()}}
{\footnotesize\ttfamily void enc624j600\+Set\+Bit (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{address,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{mask }\end{DoxyParamCaption})}



Set bit field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em address} & Register address \\
\hline
\mbox{\tt in}  & {\em mask} & Bits to set in the target register \\
\hline
\end{DoxyParams}


Definition at line 802 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
804 \{
805    \textcolor{comment}{//Pull the CS pin low}
806    interface->spiDriver->assertCs();
807 
808    \textcolor{comment}{//Write opcode}
809    interface->spiDriver->transfer(\hyperlink{enc624j600__driver_8h_a2499634b0c70214dbb67c4be4facd7ee}{ENC624J600\_CMD\_BFSU});
810    \textcolor{comment}{//Write register address}
811    interface->spiDriver->transfer(\hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address});
812    \textcolor{comment}{//Write bit mask}
813    interface->spiDriver->transfer(\hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}));
814    interface->spiDriver->transfer(\hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}));
815 
816    \textcolor{comment}{//Terminate the operation by raising the CS pin}
817    interface->spiDriver->deassertCs();
818 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_ae822836009b82106c306e4d8e0e401c6}\label{enc624j600__driver_8c_ae822836009b82106c306e4d8e0e401c6}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Soft\+Reset@{enc624j600\+Soft\+Reset}}
\index{enc624j600\+Soft\+Reset@{enc624j600\+Soft\+Reset}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Soft\+Reset()}{enc624j600SoftReset()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} enc624j600\+Soft\+Reset (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Reset E\+N\+C624\+J600 controller. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 579 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
580 \{
581    \textcolor{comment}{//Wait for the SPI interface to be ready}
582    \textcolor{keywordflow}{do}
583    \{
584       \textcolor{comment}{//Write 0x1234 to EUDAST}
585       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a93a93265036b2d5a2be0ec3376ba5a98}{ENC624J600\_REG\_EUDAST}, 0x1234);
586       \textcolor{comment}{//Read back register and check contents}
587    \} \textcolor{keywordflow}{while}(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a93a93265036b2d5a2be0ec3376ba5a98}{ENC624J600\_REG\_EUDAST}) != 0
      x1234);
588 
589    \textcolor{comment}{//Poll CLKRDY and wait for it to become set}
590    \textcolor{keywordflow}{while}(!(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a40948a3717a1434abc1ad51c6cb53805}{ENC624J600\_REG\_ESTAT}) & 
      \hyperlink{enc28j60__driver_8h_a4283378a63dc5913f07e96ea96cf8cdb}{ESTAT\_CLKRDY}));
591 
592    \textcolor{comment}{//Issue a system reset command by setting ETHRST}
593    \hyperlink{enc624j600__driver_8c_ad1d01499e75a8e4ab238919a2dee5a3f}{enc624j600SetBit}(interface, \hyperlink{enc624j600__driver_8h_a8c773266e645d5280ddffa8ff8740a7b}{ENC624J600\_REG\_ECON2}, 
      \hyperlink{enc624j600__driver_8h_a1f092639cace44a81b9e8574ffa4d8db}{ECON2\_ETHRST});
594    \textcolor{comment}{//Wait at least 25us for the reset to take place}
595    \hyperlink{os__port_8h_af36a7a9c1ad704d0da2e660dab735b2a}{sleep}(1);
596 
597    \textcolor{comment}{//Read EUDAST to confirm that the system reset took place.}
598    \textcolor{comment}{//EUDAST should have reverted back to its reset default}
599    \textcolor{keywordflow}{if}(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_a93a93265036b2d5a2be0ec3376ba5a98}{ENC624J600\_REG\_EUDAST}) != 0x0000)
600       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
601 
602    \textcolor{comment}{//Wait at least 256us for the PHY registers and PHY}
603    \textcolor{comment}{//status bits to become available}
604    \hyperlink{os__port_8h_af36a7a9c1ad704d0da2e660dab735b2a}{sleep}(1);
605 
606    \textcolor{comment}{//The controller is now ready to accept further commands}
607    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
608 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a63284fa7ab79850eee775a0bbc81356a}\label{enc624j600__driver_8c_a63284fa7ab79850eee775a0bbc81356a}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Tick@{enc624j600\+Tick}}
\index{enc624j600\+Tick@{enc624j600\+Tick}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Tick()}{enc624j600Tick()}}
{\footnotesize\ttfamily void enc624j600\+Tick (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



E\+N\+C624\+J600 timer handler. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 178 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
179 \{
180 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a46f1ef629a905a369d2093536767a65e}\label{enc624j600__driver_8c_a46f1ef629a905a369d2093536767a65e}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Update\+Mac\+Addr\+Filter@{enc624j600\+Update\+Mac\+Addr\+Filter}}
\index{enc624j600\+Update\+Mac\+Addr\+Filter@{enc624j600\+Update\+Mac\+Addr\+Filter}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Update\+Mac\+Addr\+Filter()}{enc624j600UpdateMacAddrFilter()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} enc624j600\+Update\+Mac\+Addr\+Filter (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Configure M\+AC address filtering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 490 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
491 \{
492    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
493    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
494    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} crc;
495    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} hashTable[4];
496    \hyperlink{structMacFilterEntry}{MacFilterEntry} *entry;
497 
498    \textcolor{comment}{//Debug message}
499    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Updating MAC filter...\(\backslash\)r\(\backslash\)n"});
500 
501    \textcolor{comment}{//Clear hash table}
502    memset(hashTable, 0, \textcolor{keyword}{sizeof}(hashTable));
503 
504    \textcolor{comment}{//The MAC address filter contains the list of MAC addresses to accept}
505    \textcolor{comment}{//when receiving an Ethernet frame}
506    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ethernet_8h_ab64acae68b5723774fa272c62efd7c2b}{MAC\_ADDR\_FILTER\_SIZE}; i++)
507    \{
508       \textcolor{comment}{//Point to the current entry}
509       entry = &interface->macAddrFilter[i];
510 
511       \textcolor{comment}{//Valid entry?}
512       \textcolor{keywordflow}{if}(entry->\hyperlink{structMacFilterEntry_a4a1195d4086f58ef57862fa43551e73a}{refCount} > 0)
513       \{
514          \textcolor{comment}{//Compute CRC over the current MAC address}
515          crc = \hyperlink{enc624j600__driver_8c_aeb6656f1989ed3979b48f528e60c2966}{enc624j600CalcCrc}(&entry->\hyperlink{structMacFilterEntry_a30caa211d6cc1bb2416165526a2ab6cb}{addr}, \textcolor{keyword}{sizeof}(
      \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{MacAddr}));
516          \textcolor{comment}{//Calculate the corresponding index in the table}
517          k = (crc >> 23) & 0x3F;
518          \textcolor{comment}{//Update hash table contents}
519          hashTable[k / 16] |= (1 << (k % 16));
520       \}
521    \}
522 
523    \textcolor{comment}{//Write the hash table to the ENC624J600 controller}
524    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_abf186b7edefd37c99bad10c5f4bd7bfb}{ENC624J600\_REG\_EHT1}, hashTable[0]);
525    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a127e3526c587bb75d18fa52db5c7ad10}{ENC624J600\_REG\_EHT2}, hashTable[1]);
526    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a2c555301faeee33c62c97fd342ad59ac}{ENC624J600\_REG\_EHT3}, hashTable[2]);
527    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a9991c92ee5e2dde62a3fe40b0beffced}{ENC624J600\_REG\_EHT4}, hashTable[3]);
528 
529    \textcolor{comment}{//Debug message}
530    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  EHT1 = %04"} PRIX16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_abf186b7edefd37c99bad10c5f4bd7bfb}{ENC624J600\_REG\_EHT1}));
531    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  EHT2 = %04"} PRIX16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a127e3526c587bb75d18fa52db5c7ad10}{ENC624J600\_REG\_EHT2}));
532    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  EHT3 = %04"} PRIX16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a2c555301faeee33c62c97fd342ad59ac}{ENC624J600\_REG\_EHT3}));
533    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  EHT4 = %04"} PRIX16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a9991c92ee5e2dde62a3fe40b0beffced}{ENC624J600\_REG\_EHT4}));
534 
535    \textcolor{comment}{//Successful processing}
536    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
537 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a8a60d3a10dee4be1087b6dfad12c7668}\label{enc624j600__driver_8c_a8a60d3a10dee4be1087b6dfad12c7668}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Update\+Mac\+Config@{enc624j600\+Update\+Mac\+Config}}
\index{enc624j600\+Update\+Mac\+Config@{enc624j600\+Update\+Mac\+Config}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Update\+Mac\+Config()}{enc624j600UpdateMacConfig()}}
{\footnotesize\ttfamily void enc624j600\+Update\+Mac\+Config (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Adjust M\+AC configuration parameters for proper operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 545 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
546 \{
547    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} duplexMode;
548 
549    \textcolor{comment}{//Determine the new duplex mode by reading the PHYDPX bit}
550    duplexMode = \hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, 
      \hyperlink{enc624j600__driver_8h_a40948a3717a1434abc1ad51c6cb53805}{ENC624J600\_REG\_ESTAT}) & \hyperlink{enc624j600__driver_8h_a5f56394f4da600dce28fa95fee6a0510}{ESTAT\_PHYDPX};
551 
552    \textcolor{comment}{//Full-duplex mode?}
553    \textcolor{keywordflow}{if}(duplexMode)
554    \{
555       \textcolor{comment}{//Configure the FULDPX bit to match the current duplex mode}
556       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a6fd259b63458b6cb675a02ae980d5c68}{ENC624J600\_REG\_MACON2}, 
      \hyperlink{enc624j600__driver_8h_a27dd3a1c8d4a3c5aa699991d0230636e}{MACON2\_DEFER} |
557          \hyperlink{enc624j600__driver_8h_ad8d232c8fdd97edb3208adaeb18164d5}{MACON2\_PADCFG2} | \hyperlink{enc624j600__driver_8h_a0dd0ee803c20736eb7659b6a527b975c}{MACON2\_PADCFG0} | 
      \hyperlink{enc624j600__driver_8h_a882cdc5cbcabe962c2fe6cc8b36af1b3}{MACON2\_TXCRCEN} | \hyperlink{enc624j600__driver_8h_a3b5660867c4a0ba65787c8c5e024728c}{MACON2\_R1} | \hyperlink{enc624j600__driver_8h_abdb27bbd925df821478eeacefe42608e}{MACON2\_FULDPX});
558       \textcolor{comment}{//Configure the Back-to-Back Inter-Packet Gap register}
559       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_abdea1cbc5950dfb89545ad8418c837f3}{ENC624J600\_REG\_MABBIPG}, 0x15);
560    \}
561    \textcolor{comment}{//Half-duplex mode?}
562    \textcolor{keywordflow}{else}
563    \{
564       \textcolor{comment}{//Configure the FULDPX bit to match the current duplex mode}
565       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a6fd259b63458b6cb675a02ae980d5c68}{ENC624J600\_REG\_MACON2}, 
      \hyperlink{enc624j600__driver_8h_a27dd3a1c8d4a3c5aa699991d0230636e}{MACON2\_DEFER} |
566          \hyperlink{enc624j600__driver_8h_ad8d232c8fdd97edb3208adaeb18164d5}{MACON2\_PADCFG2} | \hyperlink{enc624j600__driver_8h_a0dd0ee803c20736eb7659b6a527b975c}{MACON2\_PADCFG0} | 
      \hyperlink{enc624j600__driver_8h_a882cdc5cbcabe962c2fe6cc8b36af1b3}{MACON2\_TXCRCEN} | \hyperlink{enc624j600__driver_8h_a3b5660867c4a0ba65787c8c5e024728c}{MACON2\_R1});
567       \textcolor{comment}{//Configure the Back-to-Back Inter-Packet Gap register}
568       \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_abdea1cbc5950dfb89545ad8418c837f3}{ENC624J600\_REG\_MABBIPG}, 0x12);
569    \}
570 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a026b75def8245ece5d36d7fb5b2e3ca3}\label{enc624j600__driver_8c_a026b75def8245ece5d36d7fb5b2e3ca3}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Write\+Buffer@{enc624j600\+Write\+Buffer}}
\index{enc624j600\+Write\+Buffer@{enc624j600\+Write\+Buffer}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Write\+Buffer()}{enc624j600WriteBuffer()}}
{\footnotesize\ttfamily void enc624j600\+Write\+Buffer (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{opcode,  }\item[{const \hyperlink{structNetBuffer}{Net\+Buffer} $\ast$}]{buffer,  }\item[{size\+\_\+t}]{offset }\end{DoxyParamCaption})}



Write S\+R\+AM buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em opcode} & S\+R\+AM buffer operation \\
\hline
\mbox{\tt in}  & {\em buffer} & Multi-\/part buffer containing the data to be written \\
\hline
\mbox{\tt in}  & {\em offset} & Offset to the first data byte \\
\hline
\end{DoxyParams}


Definition at line 723 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
725 \{
726    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
727    \textcolor{keywordtype}{size\_t} j;
728    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
729    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
730 
731    \textcolor{comment}{//Pull the CS pin low}
732    interface->spiDriver->assertCs();
733 
734    \textcolor{comment}{//Write opcode}
735    interface->spiDriver->transfer(\hyperlink{dns__common_8h_a5c1b56e6bccc2a95dbddf1a08e56e87d}{opcode});
736 
737    \textcolor{comment}{//Loop through data chunks}
738    \textcolor{keywordflow}{for}(i = 0; i < buffer->\hyperlink{structNetBuffer_a43ab1f87d0236d4e01c19ff14f899618}{chunkCount}; i++)
739    \{
740       \textcolor{comment}{//Is there any data to copy from the current chunk?}
741       \textcolor{keywordflow}{if}(offset < buffer->chunk[i].\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
742       \{
743          \textcolor{comment}{//Point to the first byte to be read}
744          p = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) buffer->\hyperlink{structNetBuffer_a5d399f3f37224030dcac9c4da3ca41eb}{chunk}[i].\hyperlink{structChunkDesc_a014aac6efdc5722e058a9b67ca5f8358}{address} + \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset};
745          \textcolor{comment}{//Compute the number of bytes to copy at a time}
746          n = buffer->\hyperlink{structNetBuffer_a5d399f3f37224030dcac9c4da3ca41eb}{chunk}[i].\hyperlink{structChunkDesc_a4bdd57a9363511126fe5cd6d30c51c81}{length} - \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset};
747 
748          \textcolor{comment}{//Copy data to SRAM buffer}
749          \textcolor{keywordflow}{for}(j = 0; j < n; j++)
750             interface->spiDriver->transfer(p[j]);
751 
752          \textcolor{comment}{//Process the next block from the start}
753          \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} = 0;
754       \}
755       \textcolor{keywordflow}{else}
756       \{
757          \textcolor{comment}{//Skip the current chunk}
758          \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} -= buffer->\hyperlink{structNetBuffer_a5d399f3f37224030dcac9c4da3ca41eb}{chunk}[i].\hyperlink{structChunkDesc_a4bdd57a9363511126fe5cd6d30c51c81}{length};
759       \}
760    \}
761 
762    \textcolor{comment}{//Terminate the operation by raising the CS pin}
763    interface->spiDriver->deassertCs();
764 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_ae2e30c47a1b58763a4a7dd5d1113a0eb}\label{enc624j600__driver_8c_ae2e30c47a1b58763a4a7dd5d1113a0eb}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Write\+Phy\+Reg@{enc624j600\+Write\+Phy\+Reg}}
\index{enc624j600\+Write\+Phy\+Reg@{enc624j600\+Write\+Phy\+Reg}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Write\+Phy\+Reg()}{enc624j600WritePhyReg()}}
{\footnotesize\ttfamily void enc624j600\+Write\+Phy\+Reg (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{address,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{data }\end{DoxyParamCaption})}



Write P\+HY register. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em address} & P\+HY register address \\
\hline
\mbox{\tt in}  & {\em data} & Register value \\
\hline
\end{DoxyParams}


Definition at line 675 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
677 \{
678    \textcolor{comment}{//Write the address of the PHY register to write to}
679    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a4884cbdb46d7e674dd9354cd98ca4048}{ENC624J600\_REG\_MIREGADR}, 
      \hyperlink{enc624j600__driver_8h_ab6c8ea2b43cf18b9fd50358b044143aa}{MIREGADR\_R8} | \hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address});
680    \textcolor{comment}{//Write the 16 bits of data into the MIWR register}
681    \hyperlink{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}{enc624j600WriteReg}(interface, \hyperlink{enc624j600__driver_8h_a483d1c5f11f24d04b12b7e8c3e40b0c7}{ENC624J600\_REG\_MIWR}, 
      \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data});
682 
683    \textcolor{comment}{//Wait until the PHY register has been written}
684    \textcolor{keywordflow}{while}(\hyperlink{enc624j600__driver_8c_a88160570aba301ba14bbba57f65c5f6f}{enc624j600ReadReg}(interface, \hyperlink{enc624j600__driver_8h_af16115ee17dbaad47c53195d9120e8e8}{ENC624J600\_REG\_MISTAT}) & 
      \hyperlink{enc28j60__driver_8h_a22b9a31e2a6d031cd672eed1ad883ba8}{MISTAT\_BUSY});
685 \}
\end{DoxyCode}
\mbox{\Hypertarget{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}\label{enc624j600__driver_8c_a36b590a9ccbfc29551d312389b5efc67}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Write\+Reg@{enc624j600\+Write\+Reg}}
\index{enc624j600\+Write\+Reg@{enc624j600\+Write\+Reg}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Write\+Reg()}{enc624j600WriteReg()}}
{\footnotesize\ttfamily void enc624j600\+Write\+Reg (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{address,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{data }\end{DoxyParamCaption})}



Write E\+N\+C624\+J600 register. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em address} & Register address \\
\hline
\mbox{\tt in}  & {\em data} & Register value \\
\hline
\end{DoxyParams}


Definition at line 618 of file enc624j600\+\_\+driver.\+c.


\begin{DoxyCode}
620 \{
621    \textcolor{comment}{//Pull the CS pin low}
622    interface->spiDriver->assertCs();
623 
624    \textcolor{comment}{//Write opcode}
625    interface->spiDriver->transfer(\hyperlink{enc624j600__driver_8h_abcf3fc51e0ad33ec57970690894e978a}{ENC624J600\_CMD\_WCRU});
626    \textcolor{comment}{//Write register address}
627    interface->spiDriver->transfer(\hyperlink{dhcpv6__common_8h_aaee906fadd211e863c2e29a3690b25c4}{address});
628    \textcolor{comment}{//Write register value}
629    interface->spiDriver->transfer(\hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}));
630    interface->spiDriver->transfer(\hyperlink{os__port_8h_aeb61a4e8fff2f4624a632a3189cbd3a0}{MSB}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}));
631 
632    \textcolor{comment}{//Terminate the operation by raising the CS pin}
633    interface->spiDriver->deassertCs();
634 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{enc624j600__driver_8c_a2e66975c44a1a4d032d4c32a084ecd95}\label{enc624j600__driver_8c_a2e66975c44a1a4d032d4c32a084ecd95}} 
\index{enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}!enc624j600\+Driver@{enc624j600\+Driver}}
\index{enc624j600\+Driver@{enc624j600\+Driver}!enc624j600\+\_\+driver.\+c@{enc624j600\+\_\+driver.\+c}}
\subsubsection{\texorpdfstring{enc624j600\+Driver}{enc624j600Driver}}
{\footnotesize\ttfamily const \hyperlink{structNicDriver}{Nic\+Driver} enc624j600\+Driver}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   \hyperlink{nic_8h_ac1ce8659a9797513ecd9cc1afedce40ba84802cab6ee937691c3d76122ffaffcd}{NIC\_TYPE\_ETHERNET},
   \hyperlink{ethernet_8h_a6f29d2b24a262d91b7158713728d45f2}{ETH\_MTU},
   \hyperlink{enc624j600__driver_8c_ab2d838d05174ea53d50302ee04207993}{enc624j600Init},
   \hyperlink{enc624j600__driver_8c_a63284fa7ab79850eee775a0bbc81356a}{enc624j600Tick},
   \hyperlink{enc624j600__driver_8c_af805e74519a6a5f9d27968a3f35306c9}{enc624j600EnableIrq},
   \hyperlink{enc624j600__driver_8c_a09c32a282a4de835cc39d2c62835cb9c}{enc624j600DisableIrq},
   \hyperlink{enc624j600__driver_8c_a07877a3539388c0a915032c9ada6dba3}{enc624j600EventHandler},
   \hyperlink{enc624j600__driver_8c_a857a2615433ced088163b65d5b7da1fd}{enc624j600SendPacket},
   \hyperlink{enc624j600__driver_8c_a46f1ef629a905a369d2093536767a65e}{enc624j600UpdateMacAddrFilter},
   \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
   \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
   \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
   \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},
   \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},
   \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},
   \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}
\}
\end{DoxyCode}


E\+N\+C624\+J600 driver. 



Definition at line 44 of file enc624j600\+\_\+driver.\+c.

