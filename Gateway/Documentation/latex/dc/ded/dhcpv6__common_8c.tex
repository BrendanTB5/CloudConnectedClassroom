\hypertarget{dhcpv6__common_8c}{}\section{cyclone\+\_\+tcp/dhcpv6/dhcpv6\+\_\+common.c File Reference}
\label{dhcpv6__common_8c}\index{cyclone\+\_\+tcp/dhcpv6/dhcpv6\+\_\+common.\+c@{cyclone\+\_\+tcp/dhcpv6/dhcpv6\+\_\+common.\+c}}


Definitions common to D\+H\+C\+Pv6 client, server and relay agent.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}dhcpv6/dhcpv6\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{dhcpv6__common_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_a90777ced99a67be301c4f3de730a8e7d}{D\+H\+C\+P\+V6\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{dhcpv6__common_8h_ae3d249bb8993edf1fb41f1ac349078f1}{Dhcpv6\+Status\+Code} \hyperlink{dhcpv6__common_8c_a5eafbb8cf026dbdf9df9dd882d4c1713}{dhcpv6\+Get\+Status\+Code} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ppp_8h_a789f9812dfd8d65750fad784fd195953}{options}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Retrieve status code. \end{DoxyCompactList}\item 
\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option} $\ast$ \hyperlink{dhcpv6__common_8c_ac0a7db4b0542d3f4b7270bfb239ce6f0}{dhcpv6\+Add\+Option} (void $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t $\ast$message\+Len, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Code, const void $\ast$option\+Value, size\+\_\+t option\+Len)
\begin{DoxyCompactList}\small\item\em Add an option to a D\+H\+C\+Pv6 message. \end{DoxyCompactList}\item 
\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option} $\ast$ \hyperlink{dhcpv6__common_8c_a2eb2dd75bbf989d4353b310527465fdc}{dhcpv6\+Add\+Sub\+Option} (\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option} $\ast$base\+Option, size\+\_\+t $\ast$message\+Len, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Code, const void $\ast$option\+Value, size\+\_\+t option\+Len)
\begin{DoxyCompactList}\small\item\em Add a suboption under an existing base option. \end{DoxyCompactList}\item 
\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option} $\ast$ \hyperlink{dhcpv6__common_8c_a6678e0579ff5fe27d71f2ca45f35b54b}{dhcpv6\+Get\+Option} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ppp_8h_a789f9812dfd8d65750fad784fd195953}{options}, size\+\_\+t options\+Length, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Code)
\begin{DoxyCompactList}\small\item\em Find the specified option in a D\+H\+C\+Pv6 message. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} \hyperlink{dhcpv6__common_8c_ae04cea0e44f0c28da17198d59517ac10}{dhcpv6\+Rand} (\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Multiplication by a randomization factor. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} \hyperlink{dhcpv6__common_8c_ac3da027b4816200bf97e015db9e2f512}{dhcpv6\+Rand\+Range} (\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} min, \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} max)
\begin{DoxyCompactList}\small\item\em Get a random value in the specified range. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} \hyperlink{dhcpv6__common_8c_afd1207a3dea473503c7fc4aee69c6213}{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}
\item 
const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} \hyperlink{dhcpv6__common_8c_a3110dbd5a38a0232ba10624d4ee76bb2}{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Definitions common to D\+H\+C\+Pv6 client, server and relay agent. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
The Dynamic Host Configuration Protocol for I\+Pv6 enables D\+H\+CP servers to pass configuration parameters such as I\+Pv6 network addresses to I\+Pv6 nodes. This protocol is a stateful counterpart to I\+Pv6 Stateless Address Autoconfiguration (R\+FC 2462), and can be used separately or concurrently with the latter to obtain configuration parameters. Refer to R\+FC 3315

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{dhcpv6__common_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{dhcpv6__common_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_a90777ced99a67be301c4f3de730a8e7d}{D\+H\+C\+P\+V6\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 40 of file dhcpv6\+\_\+common.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{dhcpv6__common_8c_ac0a7db4b0542d3f4b7270bfb239ce6f0}\label{dhcpv6__common_8c_ac0a7db4b0542d3f4b7270bfb239ce6f0}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!dhcpv6\+Add\+Option@{dhcpv6\+Add\+Option}}
\index{dhcpv6\+Add\+Option@{dhcpv6\+Add\+Option}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{dhcpv6\+Add\+Option()}{dhcpv6AddOption()}}
{\footnotesize\ttfamily \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option}$\ast$ dhcpv6\+Add\+Option (\begin{DoxyParamCaption}\item[{void $\ast$}]{message,  }\item[{size\+\_\+t $\ast$}]{message\+Len,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Code,  }\item[{const void $\ast$}]{option\+Value,  }\item[{size\+\_\+t}]{option\+Len }\end{DoxyParamCaption})}



Add an option to a D\+H\+C\+Pv6 message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the D\+H\+C\+Pv6 message \\
\hline
\mbox{\tt in,out}  & {\em message\+Len} & Length of the overall D\+H\+C\+Pv6 message \\
\hline
\mbox{\tt in}  & {\em option\+Code} & Option code \\
\hline
\mbox{\tt in}  & {\em option\+Value} & Option value \\
\hline
\mbox{\tt in}  & {\em option\+Len} & Length of the option value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If the option was successfully added, a pointer to the freshly created option is returned. Otherwise N\+U\+LL pointer is returned 
\end{DoxyReturn}


Definition at line 111 of file dhcpv6\+\_\+common.\+c.


\begin{DoxyCode}
113 \{
114    \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *option;
115 
116    \textcolor{comment}{//Check the length of the DHCPv6 message}
117    \textcolor{keywordflow}{if}(*messageLen < \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a32f2f44ec9a8d2ee5e2977a7fcddaf85}{Dhcpv6Message}))
118       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
119    \textcolor{comment}{//Check the length of the option}
120    \textcolor{keywordflow}{if}(optionLen > \hyperlink{stdint_8h_a3ea490c9b3617d4479bd80ef93cd5602}{UINT16\_MAX})
121       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
122 
123    \textcolor{comment}{//Make sure there is enough room to add the option}
124    \textcolor{keywordflow}{if}((*messageLen + \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + optionLen) > 
      \hyperlink{dhcpv6__common_8h_a4b2fa99ee47d1cc91da2b57fa69b324f}{DHCPV6\_MAX\_MSG\_SIZE})
125       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
126 
127    \textcolor{comment}{//Point to the end of the DHCPv6 message}
128    option = (\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} + *messageLen);
129    \textcolor{comment}{//Write specified option at current location}
130    option->code = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(optionCode);
131    option->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(optionLen);
132    \textcolor{comment}{//Copy option data}
133    memcpy(option->value, optionValue, optionLen);
134 
135    \textcolor{comment}{//Update the length of the DHCPv6 message}
136    *messageLen += \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + optionLen;
137    \textcolor{comment}{//Return a pointer to the freshly created option}
138    \textcolor{keywordflow}{return} option;
139 \}
\end{DoxyCode}
\mbox{\Hypertarget{dhcpv6__common_8c_a2eb2dd75bbf989d4353b310527465fdc}\label{dhcpv6__common_8c_a2eb2dd75bbf989d4353b310527465fdc}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!dhcpv6\+Add\+Sub\+Option@{dhcpv6\+Add\+Sub\+Option}}
\index{dhcpv6\+Add\+Sub\+Option@{dhcpv6\+Add\+Sub\+Option}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{dhcpv6\+Add\+Sub\+Option()}{dhcpv6AddSubOption()}}
{\footnotesize\ttfamily \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option}$\ast$ dhcpv6\+Add\+Sub\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option} $\ast$}]{base\+Option,  }\item[{size\+\_\+t $\ast$}]{message\+Len,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Code,  }\item[{const void $\ast$}]{option\+Value,  }\item[{size\+\_\+t}]{option\+Len }\end{DoxyParamCaption})}



Add a suboption under an existing base option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em base\+Option} & Pointer to the base option \\
\hline
\mbox{\tt in,out}  & {\em message\+Len} & Length of the overall D\+H\+C\+Pv6 message \\
\hline
\mbox{\tt in}  & {\em option\+Code} & Option code \\
\hline
\mbox{\tt in}  & {\em option\+Value} & Option value \\
\hline
\mbox{\tt in}  & {\em option\+Len} & Length of the option value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If the option was successfully added, a pointer to the freshly created option is returned. Otherwise N\+U\+LL pointer is returned 
\end{DoxyReturn}


Definition at line 153 of file dhcpv6\+\_\+common.\+c.


\begin{DoxyCode}
155 \{
156    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
157    \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *option;
158 
159    \textcolor{comment}{//The pointer to the base option must be valid}
160    \textcolor{keywordflow}{if}(baseOption == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
161       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
162    \textcolor{comment}{//Check the length of the DHCPv6 message}
163    \textcolor{keywordflow}{if}(*messageLen < \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a32f2f44ec9a8d2ee5e2977a7fcddaf85}{Dhcpv6Message}))
164       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
165    \textcolor{comment}{//Check the length of the suboption}
166    \textcolor{keywordflow}{if}(optionLen > \hyperlink{stdint_8h_a3ea490c9b3617d4479bd80ef93cd5602}{UINT16\_MAX})
167       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
168 
169    \textcolor{comment}{//Make sure there is enough room to add the option}
170    \textcolor{keywordflow}{if}((*messageLen + \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + optionLen) > 
      \hyperlink{dhcpv6__common_8h_a4b2fa99ee47d1cc91da2b57fa69b324f}{DHCPV6\_MAX\_MSG\_SIZE})
171       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
172 
173    \textcolor{comment}{//Get the actual length of the base option}
174    n = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(baseOption->length);
175 
176    \textcolor{comment}{//Point to the location that follows the base option}
177    option = (\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *) (baseOption->value + n);
178 
179    \textcolor{comment}{//Write specified option at current location}
180    option->code = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(optionCode);
181    option->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(optionLen);
182    \textcolor{comment}{//Copy option data}
183    memcpy(option->value, optionValue, optionLen);
184 
185    \textcolor{comment}{//Update the length of the base option}
186    n += \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + optionLen;
187    \textcolor{comment}{//Convert the 16-bit value to network byte order}
188    baseOption->length = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(n);
189 
190    \textcolor{comment}{//Update the length of the DHCPv6 message}
191    *messageLen += \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + optionLen;
192    \textcolor{comment}{//Return a pointer to the freshly created option}
193    \textcolor{keywordflow}{return} option;
194 \}
\end{DoxyCode}
\mbox{\Hypertarget{dhcpv6__common_8c_a6678e0579ff5fe27d71f2ca45f35b54b}\label{dhcpv6__common_8c_a6678e0579ff5fe27d71f2ca45f35b54b}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!dhcpv6\+Get\+Option@{dhcpv6\+Get\+Option}}
\index{dhcpv6\+Get\+Option@{dhcpv6\+Get\+Option}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{dhcpv6\+Get\+Option()}{dhcpv6GetOption()}}
{\footnotesize\ttfamily \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6\+Option}$\ast$ dhcpv6\+Get\+Option (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{options,  }\item[{size\+\_\+t}]{options\+Length,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Code }\end{DoxyParamCaption})}



Find the specified option in a D\+H\+C\+Pv6 message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em options} & Pointer to the Options field \\
\hline
\mbox{\tt in}  & {\em options\+Length} & Length of the Options field \\
\hline
\mbox{\tt in}  & {\em option\+Code} & Code of the option to find \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If the specified option was found, a pointer to the corresponding option is returned. Otherwise N\+U\+LL pointer is returned 
\end{DoxyReturn}


Definition at line 206 of file dhcpv6\+\_\+common.\+c.


\begin{DoxyCode}
208 \{
209    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
210    \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *option;
211 
212    \textcolor{comment}{//Parse DHCPv6 options}
213    \textcolor{keywordflow}{for}(i = 0; i < optionsLength; )
214    \{
215       \textcolor{comment}{//Point to the current option}
216       option = (\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *) (\hyperlink{tcp_8h_a789f9812dfd8d65750fad784fd195953}{options} + i);
217 
218       \textcolor{comment}{//Make sure the option is valid}
219       \textcolor{keywordflow}{if}((i + \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option})) > optionsLength)
220          \textcolor{keywordflow}{break};
221       \textcolor{comment}{//Check the length of the option data}
222       \textcolor{keywordflow}{if}((i + \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->length)) > optionsLength)
223          \textcolor{keywordflow}{break};
224 
225       \textcolor{comment}{//Option code matches the specified one?}
226       \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->code) == optionCode)
227          \textcolor{keywordflow}{return} option;
228 
229       \textcolor{comment}{//Jump to the next option}
230       i += \textcolor{keyword}{sizeof}(\hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option}) + \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->length);
231    \}
232 
233    \textcolor{comment}{//The specified option code was not found}
234    \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
235 \}
\end{DoxyCode}
\mbox{\Hypertarget{dhcpv6__common_8c_a5eafbb8cf026dbdf9df9dd882d4c1713}\label{dhcpv6__common_8c_a5eafbb8cf026dbdf9df9dd882d4c1713}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!dhcpv6\+Get\+Status\+Code@{dhcpv6\+Get\+Status\+Code}}
\index{dhcpv6\+Get\+Status\+Code@{dhcpv6\+Get\+Status\+Code}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{dhcpv6\+Get\+Status\+Code()}{dhcpv6GetStatusCode()}}
{\footnotesize\ttfamily \hyperlink{dhcpv6__common_8h_ae3d249bb8993edf1fb41f1ac349078f1}{Dhcpv6\+Status\+Code} dhcpv6\+Get\+Status\+Code (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{options,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Retrieve status code. 

This function returns a status indication related to the D\+H\+C\+Pv6 message or option in which it appears


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em options} & Pointer to the Options field \\
\hline
\mbox{\tt in}  & {\em length} & Length of the Options field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status code 
\end{DoxyReturn}


Definition at line 70 of file dhcpv6\+\_\+common.\+c.


\begin{DoxyCode}
71 \{
72    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dhcpv6__common_8h_ade31e7fd99344e8c35f2c373af659551}{statusCode};
73    \hyperlink{dhcpv6__common_8h_a89f7acb5d12dede28c2b98290018051e}{Dhcpv6Option} *option;
74    \hyperlink{dhcpv6__common_8h_affcf2015dbadfac241b6eee2e6c2a13f}{Dhcpv6StatusCodeOption} *statusCodeOption;
75 
76    \textcolor{comment}{//Search for the Status Code option}
77    option = \hyperlink{dhcpv6__common_8c_a6678e0579ff5fe27d71f2ca45f35b54b}{dhcpv6GetOption}(\hyperlink{tcp_8h_a789f9812dfd8d65750fad784fd195953}{options}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, 
      \hyperlink{dhcpv6__common_8h_ace3d7da87df06edf56819a49ebf00574a8d726542fb7af3010e528657c9204bcb}{DHCPV6\_OPTION\_STATUS\_CODE});
78 
79    \textcolor{comment}{//Check whether the option has been found}
80    \textcolor{keywordflow}{if}(option != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(option->length) >= \textcolor{keyword}{sizeof}(
      \hyperlink{dhcpv6__common_8h_affcf2015dbadfac241b6eee2e6c2a13f}{Dhcpv6StatusCodeOption}))
81    \{
82       \textcolor{comment}{//The option contains a status code and a status message}
83       statusCodeOption = (\hyperlink{dhcpv6__common_8h_affcf2015dbadfac241b6eee2e6c2a13f}{Dhcpv6StatusCodeOption} *) option->value;
84 
85       \textcolor{comment}{//Convert the status code from network byte order}
86       statusCode = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(statusCodeOption->statusCode);
87    \}
88    \textcolor{keywordflow}{else}
89    \{
90       \textcolor{comment}{//If the Status Code option does not appear in a message in which the option}
91       \textcolor{comment}{//could appear, the status of the message is assumed to be Success}
92       statusCode = \hyperlink{dhcpv6__common_8h_ae3d249bb8993edf1fb41f1ac349078f1ae42228ed0a2112512e652d5b51af56fe}{DHCPV6\_STATUS\_SUCCESS};
93    \}
94 
95    \textcolor{comment}{//Return status code}
96    \textcolor{keywordflow}{return} (\hyperlink{dhcpv6__common_8h_ae3d249bb8993edf1fb41f1ac349078f1}{Dhcpv6StatusCode}) \hyperlink{dhcpv6__common_8h_ade31e7fd99344e8c35f2c373af659551}{statusCode};
97 \}
\end{DoxyCode}
\mbox{\Hypertarget{dhcpv6__common_8c_ae04cea0e44f0c28da17198d59517ac10}\label{dhcpv6__common_8c_ae04cea0e44f0c28da17198d59517ac10}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!dhcpv6\+Rand@{dhcpv6\+Rand}}
\index{dhcpv6\+Rand@{dhcpv6\+Rand}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{dhcpv6\+Rand()}{dhcpv6Rand()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} dhcpv6\+Rand (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t}}]{value }\end{DoxyParamCaption})}



Multiplication by a randomization factor. 

Each of the computations of a new RT include a randomization factor R\+A\+ND, which is a random number chosen with a uniform distribution between -\/0.\+1 and +0.1. The randomization factor is included to minimize synchronization of messages transmitted by D\+H\+C\+Pv6 clients


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em value} & Input value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Value resulting from the randomization process 
\end{DoxyReturn}


Definition at line 250 of file dhcpv6\+\_\+common.\+c.


\begin{DoxyCode}
251 \{
252    \textcolor{comment}{//Use a randomization factor chosen with a uniform}
253    \textcolor{comment}{//distribution between -0.1 and +0.1}
254    \textcolor{keywordflow}{return} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} * \hyperlink{dhcpv6__common_8c_ac3da027b4816200bf97e015db9e2f512}{dhcpv6RandRange}(-100, 100) / 1000;
255 \}
\end{DoxyCode}
\mbox{\Hypertarget{dhcpv6__common_8c_ac3da027b4816200bf97e015db9e2f512}\label{dhcpv6__common_8c_ac3da027b4816200bf97e015db9e2f512}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!dhcpv6\+Rand\+Range@{dhcpv6\+Rand\+Range}}
\index{dhcpv6\+Rand\+Range@{dhcpv6\+Rand\+Range}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{dhcpv6\+Rand\+Range()}{dhcpv6RandRange()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} dhcpv6\+Rand\+Range (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t}}]{min,  }\item[{\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t}}]{max }\end{DoxyParamCaption})}



Get a random value in the specified range. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em min} & Lower bound \\
\hline
\mbox{\tt in}  & {\em max} & Upper bound \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Random value in the specified range 
\end{DoxyReturn}


Definition at line 265 of file dhcpv6\+\_\+common.\+c.


\begin{DoxyCode}
266 \{
267    \textcolor{comment}{//Return a random value in the given range}
268    \textcolor{keywordflow}{return} min + \hyperlink{net_8c_a7bb00b31d641749ac8ce742261eb1f6d}{netGetRand}() % (max - min + 1);
269 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{dhcpv6__common_8c_afd1207a3dea473503c7fc4aee69c6213}\label{dhcpv6__common_8c_afd1207a3dea473503c7fc4aee69c6213}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR@{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}}
\index{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR@{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}{DHCPV6\_ALL\_RELAY\_AGENTS\_AND\_SERVERS\_ADDR}}
{\footnotesize\ttfamily const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+R\+E\+L\+A\+Y\+\_\+\+A\+G\+E\+N\+T\+S\+\_\+\+A\+N\+D\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
   \hyperlink{ipv6_8h_a67dca0e4992a187ca175893818cff905}{IPV6\_ADDR}(0xFF02, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002)
\end{DoxyCode}


Definition at line 51 of file dhcpv6\+\_\+common.\+c.

\mbox{\Hypertarget{dhcpv6__common_8c_a3110dbd5a38a0232ba10624d4ee76bb2}\label{dhcpv6__common_8c_a3110dbd5a38a0232ba10624d4ee76bb2}} 
\index{dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}!D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR@{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}}
\index{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR@{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}!dhcpv6\+\_\+common.\+c@{dhcpv6\+\_\+common.\+c}}
\subsubsection{\texorpdfstring{D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}{DHCPV6\_ALL\_SERVERS\_ADDR}}
{\footnotesize\ttfamily const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} D\+H\+C\+P\+V6\+\_\+\+A\+L\+L\+\_\+\+S\+E\+R\+V\+E\+R\+S\+\_\+\+A\+D\+DR}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
   \hyperlink{ipv6_8h_a67dca0e4992a187ca175893818cff905}{IPV6\_ADDR}(0xFF05, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0003)
\end{DoxyCode}


Definition at line 55 of file dhcpv6\+\_\+common.\+c.

