\hypertarget{des_8h}{}\section{cyclone\+\_\+crypto/cipher/des.h File Reference}
\label{des_8h}\index{cyclone\+\_\+crypto/cipher/des.\+h@{cyclone\+\_\+crypto/cipher/des.\+h}}


D\+ES (Data Encryption Standard)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structDesContext}{Des\+Context}
\begin{DoxyCompactList}\small\item\em D\+ES algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~8
\item 
\#define \hyperlink{des_8h_acf6025bcfd46cd3a05477583828f32f7}{D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{des_8h_a436ae8b9f8e27c5f377f37aaf6b14428}{des\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{des_8h_afadda7acbe44a36384a5d463e9356cb2}{des\+Init} (\hyperlink{structDesContext}{Des\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a D\+ES context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{des_8h_aa775fbbff698bd0168c4d0fc84869a8f}{des\+Encrypt\+Block} (\hyperlink{structDesContext}{Des\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 8-\/byte block using D\+ES algorithm. \end{DoxyCompactList}\item 
void \hyperlink{des_8h_a3211e55b31b1e6c04f84e385494bd31c}{des\+Decrypt\+Block} (\hyperlink{structDesContext}{Des\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 8-\/byte block using D\+ES algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{des_8h_a436ae8b9f8e27c5f377f37aaf6b14428}{des\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
D\+ES (Data Encryption Standard) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{des_8h_a8a583bbd17418046705ca55b6dbbe652}\label{des_8h_a8a583bbd17418046705ca55b6dbbe652}} 
\index{des.\+h@{des.\+h}!D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!des.\+h@{des.\+h}}
\subsubsection{\texorpdfstring{D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{DES\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define D\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~8}



Definition at line 38 of file des.\+h.

\mbox{\Hypertarget{des_8h_acf6025bcfd46cd3a05477583828f32f7}\label{des_8h_acf6025bcfd46cd3a05477583828f32f7}} 
\index{des.\+h@{des.\+h}!D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!des.\+h@{des.\+h}}
\subsubsection{\texorpdfstring{D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{DES\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define D\+E\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{des_8h_a436ae8b9f8e27c5f377f37aaf6b14428}{des\+Cipher\+Algo})}



Definition at line 40 of file des.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{des_8h_a3211e55b31b1e6c04f84e385494bd31c}\label{des_8h_a3211e55b31b1e6c04f84e385494bd31c}} 
\index{des.\+h@{des.\+h}!des\+Decrypt\+Block@{des\+Decrypt\+Block}}
\index{des\+Decrypt\+Block@{des\+Decrypt\+Block}!des.\+h@{des.\+h}}
\subsubsection{\texorpdfstring{des\+Decrypt\+Block()}{desDecryptBlock()}}
{\footnotesize\ttfamily void des\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structDesContext}{Des\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 8-\/byte block using D\+ES algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the D\+ES context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 386 of file des.\+c.


\begin{DoxyCode}
387 \{
388    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
389    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} left;
390    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} right;
391    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp;
392 
393    \textcolor{comment}{//Keys in the key schedule must be applied in reverse order}
394    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ks = context->\hyperlink{structDesContext_af0d2a0720c948a57d588cc95f8c60a06}{ks} + 30;
395 
396    \textcolor{comment}{//Copy the ciphertext from the input buffer}
397    left = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 0);
398    right = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 4);
399 
400    \textcolor{comment}{//Initial permutation}
401    \hyperlink{des_8c_a9db7ea9a125f4dc02bb8591ea81ee3ee}{DES\_IP}(left, right);
402 
403    \textcolor{comment}{//16 rounds of computation are needed}
404    \textcolor{keywordflow}{for}(i = 0; i < 16; i++, ks -= 2)
405    \{
406       \hyperlink{des_8c_a0a6c0a841dd3b32a696cbb2c7948de41}{DES\_ROUND}(left, right, ks);
407    \}
408 
409    \textcolor{comment}{//Inverse IP permutation}
410    \hyperlink{des_8c_a9c1815859597b51850fed659f4f3dace}{DES\_FP}(right, left);
411 
412    \textcolor{comment}{//Copy the resulting plaintext}
413    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(right, output + 0);
414    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(left, output + 4);
415 \}
\end{DoxyCode}
\mbox{\Hypertarget{des_8h_aa775fbbff698bd0168c4d0fc84869a8f}\label{des_8h_aa775fbbff698bd0168c4d0fc84869a8f}} 
\index{des.\+h@{des.\+h}!des\+Encrypt\+Block@{des\+Encrypt\+Block}}
\index{des\+Encrypt\+Block@{des\+Encrypt\+Block}!des.\+h@{des.\+h}}
\subsubsection{\texorpdfstring{des\+Encrypt\+Block()}{desEncryptBlock()}}
{\footnotesize\ttfamily void des\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structDesContext}{Des\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 8-\/byte block using D\+ES algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the D\+ES context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 347 of file des.\+c.


\begin{DoxyCode}
348 \{
349    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
350    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} left;
351    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} right;
352    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} temp;
353 
354    \textcolor{comment}{//Key schedule}
355    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} *ks = context->\hyperlink{structDesContext_af0d2a0720c948a57d588cc95f8c60a06}{ks};
356 
357    \textcolor{comment}{//Copy the plaintext from the input buffer}
358    left = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 0);
359    right = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(input + 4);
360 
361    \textcolor{comment}{//Initial permutation}
362    \hyperlink{des_8c_a9db7ea9a125f4dc02bb8591ea81ee3ee}{DES\_IP}(left, right);
363 
364    \textcolor{comment}{//16 rounds of computation are needed}
365    \textcolor{keywordflow}{for}(i = 0; i < 16; i++, ks += 2)
366    \{
367       \hyperlink{des_8c_a0a6c0a841dd3b32a696cbb2c7948de41}{DES\_ROUND}(left, right, ks);
368    \}
369 
370    \textcolor{comment}{//Inverse IP permutation}
371    \hyperlink{des_8c_a9c1815859597b51850fed659f4f3dace}{DES\_FP}(right, left);
372 
373    \textcolor{comment}{//Copy the resulting ciphertext}
374    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(right, output + 0);
375    \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(left, output + 4);
376 \}
\end{DoxyCode}
\mbox{\Hypertarget{des_8h_afadda7acbe44a36384a5d463e9356cb2}\label{des_8h_afadda7acbe44a36384a5d463e9356cb2}} 
\index{des.\+h@{des.\+h}!des\+Init@{des\+Init}}
\index{des\+Init@{des\+Init}!des.\+h@{des.\+h}}
\subsubsection{\texorpdfstring{des\+Init()}{desInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} des\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structDesContext}{Des\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Initialize a D\+ES context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the D\+ES context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key (must be set to 8) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 271 of file des.\+c.


\begin{DoxyCode}
272 \{
273    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
274    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
275    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} d;
276 
277    \textcolor{comment}{//Check parameters}
278    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
279       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
280 
281    \textcolor{comment}{//Invalid key length?}
282    \textcolor{keywordflow}{if}(keyLen != 8)
283       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
284 
285    \textcolor{comment}{//Copy the key}
286    c = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(key + 0);
287    d = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(key + 4);
288 
289    \textcolor{comment}{//Permuted choice 1}
290    \hyperlink{des_8c_a64f190cf042d0d87d57f7337066068c0}{DES\_PC1}(c, d);
291 
292    \textcolor{comment}{//Generate the key schedule}
293    \textcolor{keywordflow}{for}(i = 0; i < 16; i++)
294    \{
295       \textcolor{comment}{//Individual blocks are shifted left}
296       \textcolor{keywordflow}{if}(i == 0 || i == 1 || i == 8 || i == 15)
297       \{
298          c = \hyperlink{des_8c_a78e4547299de7bcb50068736636a8327}{ROL28}(c, 1);
299          d = \hyperlink{des_8c_a78e4547299de7bcb50068736636a8327}{ROL28}(d, 1);
300       \}
301       \textcolor{keywordflow}{else}
302       \{
303          c = \hyperlink{des_8c_a78e4547299de7bcb50068736636a8327}{ROL28}(c, 2);
304          d = \hyperlink{des_8c_a78e4547299de7bcb50068736636a8327}{ROL28}(d, 2);
305       \}
306 
307       \textcolor{comment}{//Permuted choice 2}
308       context->\hyperlink{structDesContext_af0d2a0720c948a57d588cc95f8c60a06}{ks}[2 * i] =
309          ((c << 4)  & 0x24000000) | ((c << 28) & 0x10000000) |
310          ((c << 14) & 0x08000000) | ((c << 18) & 0x02080000) |
311          ((c << 6)  & 0x01000000) | ((c << 9)  & 0x00200000) |
312          ((c >> 1)  & 0x00100000) | ((c << 10) & 0x00040000) |
313          ((c << 2)  & 0x00020000) | ((c >> 10) & 0x00010000) |
314          ((d >> 13) & 0x00002000) | ((d >> 4)  & 0x00001000) |
315          ((d << 6)  & 0x00000800) | ((d >> 1)  & 0x00000400) |
316          ((d >> 14) & 0x00000200) | ((d)       & 0x00000100) |
317          ((d >> 5)  & 0x00000020) | ((d >> 10) & 0x00000010) |
318          ((d >> 3)  & 0x00000008) | ((d >> 18) & 0x00000004) |
319          ((d >> 26) & 0x00000002) | ((d >> 24) & 0x00000001);
320 
321       context->\hyperlink{structDesContext_af0d2a0720c948a57d588cc95f8c60a06}{ks}[2 * i + 1] =
322          ((c << 15) & 0x20000000) | ((c << 17) & 0x10000000) |
323          ((c << 10) & 0x08000000) | ((c << 22) & 0x04000000) |
324          ((c >> 2)  & 0x02000000) | ((c << 1)  & 0x01000000) |
325          ((c << 16) & 0x00200000) | ((c << 11) & 0x00100000) |
326          ((c << 3)  & 0x00080000) | ((c >> 6)  & 0x00040000) |
327          ((c << 15) & 0x00020000) | ((c >> 4)  & 0x00010000) |
328          ((d >> 2)  & 0x00002000) | ((d << 8)  & 0x00001000) |
329          ((d >> 14) & 0x00000808) | ((d >> 9)  & 0x00000400) |
330          ((d)       & 0x00000200) | ((d << 7)  & 0x00000100) |
331          ((d >> 7)  & 0x00000020) | ((d >> 3)  & 0x00000011) |
332          ((d << 2)  & 0x00000004) | ((d >> 21) & 0x00000002);
333    \}
334 
335    \textcolor{comment}{//No error to report}
336    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
337 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{des_8h_a436ae8b9f8e27c5f377f37aaf6b14428}\label{des_8h_a436ae8b9f8e27c5f377f37aaf6b14428}} 
\index{des.\+h@{des.\+h}!des\+Cipher\+Algo@{des\+Cipher\+Algo}}
\index{des\+Cipher\+Algo@{des\+Cipher\+Algo}!des.\+h@{des.\+h}}
\subsubsection{\texorpdfstring{des\+Cipher\+Algo}{desCipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} des\+Cipher\+Algo}



Definition at line 249 of file des.\+c.

