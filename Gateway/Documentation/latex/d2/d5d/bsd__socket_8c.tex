\hypertarget{bsd__socket_8c}{}\section{cyclone\+\_\+tcp/core/bsd\+\_\+socket.c File Reference}
\label{bsd__socket_8c}\index{cyclone\+\_\+tcp/core/bsd\+\_\+socket.\+c@{cyclone\+\_\+tcp/core/bsd\+\_\+socket.\+c}}


B\+SD socket A\+PI.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/bsd\+\_\+socket.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/socket.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{bsd__socket_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_a504b110fd24efa75f5f67ea38ec79ef9}{B\+S\+D\+\_\+\+S\+O\+C\+K\+E\+T\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socket\+Translate\+Error\+Code} (\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} error)
\begin{DoxyCompactList}\small\item\em Translate error code. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} family, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ppp_8h_a1d127017fb298b889f4ba24752d08b8e}{type}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{lcp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol})
\begin{DoxyCompactList}\small\item\em Create a socket that is bound to a specific transport service provider. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ac58f14ae6f6539a7c18fefe2cbba3cda}{bind} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, const \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} addrlen)
\begin{DoxyCompactList}\small\item\em Associate a local address with a socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a2deceb276f0a16d0dacf920964a4d7f2}{connect} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, const \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} addrlen)
\begin{DoxyCompactList}\small\item\em Establish a connection to a specified socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a2d0de04655168d929019ee3deefc5a13}{listen} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} backlog)
\begin{DoxyCompactList}\small\item\em Place a socket in the listening state. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ae502b207e3a5a9a172a03275b850302b}{accept} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$addrlen)
\begin{DoxyCompactList}\small\item\em Permit an incoming connection attempt on a socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a408a73b0a323686664f7701515d77846}{send} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags})
\begin{DoxyCompactList}\small\item\em Send data to a connected socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ac6bc4971dc509e476f30dcb7b1fb48d1}{sendto} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags}, const \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} addrlen)
\begin{DoxyCompactList}\small\item\em Send a datagram to a specific destination. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a9d6144a22e9e2bf776b92ef5986ff3f4}{recv} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t size, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags})
\begin{DoxyCompactList}\small\item\em Receive data from a connected socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a7363c08d1ec430ba8f2da2a8ca62123b}{recvfrom} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t size, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags}, \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$addrlen)
\begin{DoxyCompactList}\small\item\em Receive a datagram. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ad1359e5306ef4a065ac567bb58c6ed82}{getsockname} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$addrlen)
\begin{DoxyCompactList}\small\item\em Retrieves the local name for a socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a393d5d2370d0c1dee376c69fc47e9688}{getpeername} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{structsockaddr}{sockaddr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$addrlen)
\begin{DoxyCompactList}\small\item\em Retrieves the address of the peer to which a socket is connected. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ac9d99325aacac0a4a6c3a374b871f96d}{setsockopt} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{tls_8h_abbb6c7c49508c1ac374683f2d1159e08}{level}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} optname, const void $\ast$optval, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} optlen)
\begin{DoxyCompactList}\small\item\em The setsockopt function sets a socket option. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_af1d37952cd27c54305f8e8102f2abc93}{getsockopt} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{tls_8h_abbb6c7c49508c1ac374683f2d1159e08}{level}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} optname, void $\ast$optval, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$optlen)
\begin{DoxyCompactList}\small\item\em The getsockopt function retrieves a socket option. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a3683319ac6b6c0bed6d77ecadb4fc37f}{ioctlsocket} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} cmd, void $\ast$arg)
\begin{DoxyCompactList}\small\item\em Control the I/O mode of a socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a9b1883a0e76c305b489afab84208214e}{fcntl} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} cmd, void $\ast$arg)
\begin{DoxyCompactList}\small\item\em Perform specific operation. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ac851da2d3329074a2ff05dc48cc6c934}{shutdown} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} how)
\begin{DoxyCompactList}\small\item\em The shutdown function disables sends or receives on a socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_ab350756e9fd26ec93a8a7a4995785d23}{closesocket} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s})
\begin{DoxyCompactList}\small\item\em The closesocket function closes an existing socket. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_abff426482a94920952fcd25843c0464c}{select} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} nfds, \hyperlink{structfd__set}{fd\+\_\+set} $\ast$readfds, \hyperlink{structfd__set}{fd\+\_\+set} $\ast$writefds, \hyperlink{structfd__set}{fd\+\_\+set} $\ast$exceptfds, const \hyperlink{structtimeval}{timeval} $\ast$timeout)
\begin{DoxyCompactList}\small\item\em Determine the status of one or more sockets. \end{DoxyCompactList}\item 
void \hyperlink{bsd__socket_8c_ae706260b57df1a389383213983263176}{select\+Fd\+Zero} (\hyperlink{structfd__set}{fd\+\_\+set} $\ast$fds)
\begin{DoxyCompactList}\small\item\em Initializes a descriptor set. \end{DoxyCompactList}\item 
void \hyperlink{bsd__socket_8c_abc9f09d90b70e38f41dacebb8447b524}{select\+Fd\+Set} (\hyperlink{structfd__set}{fd\+\_\+set} $\ast$fds, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s})
\begin{DoxyCompactList}\small\item\em Add a descriptor to an existing set. \end{DoxyCompactList}\item 
void \hyperlink{bsd__socket_8c_a33d187c3e4319fad4b8aadaf7a2aedf8}{select\+Fd\+Clr} (\hyperlink{structfd__set}{fd\+\_\+set} $\ast$fds, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s})
\begin{DoxyCompactList}\small\item\em Remove a descriptor from an existing set. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a143e1f45fe34421167561f59fa061ff1}{select\+Fd\+Is\+Set} (\hyperlink{structfd__set}{fd\+\_\+set} $\ast$fds, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{ndp_8h_a2dee666f0c1fe072c549ff86b1d0a8ab}{s})
\begin{DoxyCompactList}\small\item\em Check whether a descriptor is set. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_aa474a355020fce96cd3590b628a298fe}{gethostbyname} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \hyperlink{structhostent}{hostent} $\ast$info)
\begin{DoxyCompactList}\small\item\em Retrieve host address corresponding to a host name. \end{DoxyCompactList}\item 
\hyperlink{bsd__socket_8h_a98b38134a62f24554da0ffcabde8062c}{in\+\_\+addr\+\_\+t} \hyperlink{bsd__socket_8c_a10ade0040b68c1b0d774654a7bb524e3}{inet\+\_\+addr} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$cp)
\begin{DoxyCompactList}\small\item\em Convert a dot-\/decimal string into binary data in network byte order. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_abbeaeda3efebfb2033ef3418623b9ffe}{inet\+\_\+aton} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$cp, \hyperlink{structin__addr}{in\+\_\+addr} $\ast$inp)
\begin{DoxyCompactList}\small\item\em Convert a dot-\/decimal string into binary form. \end{DoxyCompactList}\item 
const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$ \hyperlink{bsd__socket_8c_a29f9499712dc70a267ba54ff0bb75021}{inet\+\_\+ntoa} (\hyperlink{structin__addr}{in\+\_\+addr} in, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$cp)
\begin{DoxyCompactList}\small\item\em Convert a binary I\+Pv4 address to dot-\/decimal notation. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{bsd__socket_8c_a93502f1c0698058b1be39e2022829893}{inet\+\_\+pton} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} af, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$src, void $\ast$dst)
\begin{DoxyCompactList}\small\item\em Convert an I\+Pv4 or I\+Pv6 address from text to binary form. \end{DoxyCompactList}\item 
const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$ \hyperlink{bsd__socket_8c_a31845193f4c4c66bbb00189b5b99bb07}{inet\+\_\+ntop} (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} af, const void $\ast$src, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$dst, \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} size)
\begin{DoxyCompactList}\small\item\em Convert an I\+Pv4 or I\+Pv6 address from binary to text. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structin6__addr}{in6\+\_\+addr} \hyperlink{bsd__socket_8c_ac7c24836e783eb6e5382a54d9586605f}{in6addr\+\_\+any}
\item 
const \hyperlink{structin6__addr}{in6\+\_\+addr} \hyperlink{bsd__socket_8c_aa1ce010104daa144d2349c931828bb67}{in6addr\+\_\+loopback}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
B\+SD socket A\+PI. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{bsd__socket_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{bsd__socket_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_a504b110fd24efa75f5f67ea38ec79ef9}{B\+S\+D\+\_\+\+S\+O\+C\+K\+E\+T\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file bsd\+\_\+socket.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{bsd__socket_8c_ae502b207e3a5a9a172a03275b850302b}\label{bsd__socket_8c_ae502b207e3a5a9a172a03275b850302b}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!accept@{accept}}
\index{accept@{accept}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{accept()}{accept()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} accept (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$}]{addrlen }\end{DoxyParamCaption})}



Permit an incoming connection attempt on a socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket in the listening state \\
\hline
\mbox{\tt out}  & {\em addr} & Address of the connecting entity (optional) \\
\hline
\mbox{\tt in,out}  & {\em addrlen} & Length in bytes of the address (optional) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, accept returns a descriptor for the new socket. Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 391 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
392 \{
393    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port};
394    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
395    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
396    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *newSock;
397 
398    \textcolor{comment}{//Make sure the socket descriptor is valid}
399    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
400    \{
401       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
402    \}
403 
404    \textcolor{comment}{//Point to the socket structure}
405    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
406 
407    \textcolor{comment}{//Permit an incoming connection attempt on a socket}
408    newSock = \hyperlink{socket_8c_a00ec8a49fe1ee3597a0f7a2afbe46f00}{socketAccept}(sock, &ipAddr, &port);
409 
410    \textcolor{comment}{//No connection request is pending in the SYN queue?}
411    \textcolor{keywordflow}{if}(newSock == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
412    \{
413       \textcolor{comment}{//Report an error}
414       sock->errnoCode = \hyperlink{bsd__socket_8h_a4a3a0b3605fd3b2336455062ee8e25f0}{EWOULDBLOCK};
415       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
416    \}
417 
418    \textcolor{comment}{//The address is optional}
419    \textcolor{keywordflow}{if}(addr != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && addrlen != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
420    \{
421 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
422       \textcolor{comment}{//IPv4 address?}
423       \textcolor{keywordflow}{if}(ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} == \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in}{sockaddr\_in}))
424       \{
425          \textcolor{comment}{//Point to the IPv4 address information}
426          \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
427 
428          \textcolor{comment}{//Set address family and port number}
429          sa->\hyperlink{structsockaddr__in_a1b187e5b6abc36bcf03efe678448ed75}{sin\_family} = \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET};
430          sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(port);
431          \textcolor{comment}{//Copy IPv4 address}
432          sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} = ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr};
433 
434          \textcolor{comment}{//Return the actual length of the address}
435          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_aa09b4858e60b678043d2b6ae464bec9b}{sockaddr\_in});
436       \}
437       \textcolor{keywordflow}{else}
438 \textcolor{preprocessor}{#endif}
439 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
440       \textcolor{comment}{//IPv6 address?}
441       \textcolor{keywordflow}{if}(ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} == \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in6}{sockaddr\_in6}))
442       \{
443          \textcolor{comment}{//Point to the IPv6 address information}
444          \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
445 
446          \textcolor{comment}{//Set address family and port number}
447          sa->\hyperlink{structsockaddr__in6_ac529d8e83c6d57c56d1cb7ddf61b0e8b}{sin6\_family} = \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6};
448          sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(port);
449          \textcolor{comment}{//Copy IPv6 address}
450          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.\hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr}, &ipAddr.
      \hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr});
451 
452          \textcolor{comment}{//Return the actual length of the address}
453          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6});
454       \}
455       \textcolor{keywordflow}{else}
456 \textcolor{preprocessor}{#endif}
457       \textcolor{comment}{//Invalid address?}
458       \{
459          \textcolor{comment}{//Close socket}
460          \hyperlink{socket_8c_ac5012e9f71c97e2ea0410f2c5baccb0e}{socketClose}(newSock);
461          \textcolor{comment}{//Report an error}
462          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
463          \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
464       \}
465    \}
466 
467    \textcolor{comment}{//Return the descriptor to the new socket}
468    \textcolor{keywordflow}{return} newSock->descriptor;
469 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ac58f14ae6f6539a7c18fefe2cbba3cda}\label{bsd__socket_8c_ac58f14ae6f6539a7c18fefe2cbba3cda}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!bind@{bind}}
\index{bind@{bind}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{bind()}{bind()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} bind (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{const \hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t}}]{addrlen }\end{DoxyParamCaption})}



Associate a local address with a socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor identifying an unbound socket \\
\hline
\mbox{\tt in}  & {\em addr} & Local address to assign to the bound socket \\
\hline
\mbox{\tt in}  & {\em addrlen} & Length in bytes of the address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, bind returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS. Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 150 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
151 \{
152    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
153    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port};
154    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
155    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
156 
157    \textcolor{comment}{//Make sure the socket descriptor is valid}
158    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
159    \{
160       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
161    \}
162 
163    \textcolor{comment}{//Point to the socket structure}
164    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
165 
166    \textcolor{comment}{//Check the length of the address}
167    \textcolor{keywordflow}{if}(addrlen < (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr}{sockaddr}))
168    \{
169       \textcolor{comment}{//Report an error}
170       sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
171       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
172    \}
173 
174 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
175    \textcolor{comment}{//IPv4 address?}
176    \textcolor{keywordflow}{if}(addr->\hyperlink{structsockaddr_a24dbd3e20c62f767f18ddaec18ed3b63}{sa\_family} == \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET} && addrlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(
      \hyperlink{structsockaddr__in}{sockaddr\_in}))
177    \{
178       \textcolor{comment}{//Point to the IPv4 address information}
179       \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
180       \textcolor{comment}{//Get port number}
181       port = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port});
182 
183       \textcolor{comment}{//Copy IPv4 address}
184       \textcolor{keywordflow}{if}(sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} == \hyperlink{bsd__socket_8h_a5d1940045dc2e7de552f3d4ff13a74ab}{INADDR\_ANY})
185       \{
186          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = 0;
187          ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr} = \hyperlink{ipv4_8h_aa9d277a6ff68d361eaf48d6af73e78e8}{IPV4\_UNSPECIFIED\_ADDR};
188       \}
189       \textcolor{keywordflow}{else}
190       \{
191          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr});
192          ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr} = sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr};
193       \}
194    \}
195    \textcolor{keywordflow}{else}
196 \textcolor{preprocessor}{#endif}
197 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
198    \textcolor{comment}{//IPv6 address?}
199    \textcolor{keywordflow}{if}(addr->\hyperlink{structsockaddr_a24dbd3e20c62f767f18ddaec18ed3b63}{sa\_family} == \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6} && addrlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(
      \hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6}))
200    \{
201       \textcolor{comment}{//Point to the IPv6 address information}
202       \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
203       \textcolor{comment}{//Get port number}
204       port = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port});
205 
206       \textcolor{comment}{//Copy IPv6 address}
207       \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.\hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr}, &
      \hyperlink{bsd__socket_8c_ac7c24836e783eb6e5382a54d9586605f}{in6addr\_any}))
208       \{
209          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = 0;
210          ipAddr.\hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr} = \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR};
211       \}
212       \textcolor{keywordflow}{else}
213       \{
214          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr});
215          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(&ipAddr.\hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr}, sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.
      \hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr});
216       \}
217    \}
218    \textcolor{keywordflow}{else}
219 \textcolor{preprocessor}{#endif}
220    \textcolor{comment}{//Invalid address?}
221    \{
222       \textcolor{comment}{//Report an error}
223       sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
224       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
225    \}
226 
227    \textcolor{comment}{//Associate the local address with the socket}
228    error = \hyperlink{socket_8c_a56de93ca9f66782811dbe151d6da0b9c}{socketBind}(sock, &ipAddr, port);
229 
230    \textcolor{comment}{//Any error to report?}
231    \textcolor{keywordflow}{if}(error)
232    \{
233       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
234       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
235    \}
236 
237    \textcolor{comment}{//Successful processing}
238    \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
239 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ab350756e9fd26ec93a8a7a4995785d23}\label{bsd__socket_8c_ab350756e9fd26ec93a8a7a4995785d23}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!closesocket@{closesocket}}
\index{closesocket@{closesocket}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{closesocket()}{closesocket()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} closesocket (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s }\end{DoxyParamCaption})}



The closesocket function closes an existing socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, closesocket returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 1616 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1617 \{
1618    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
1619 
1620    \textcolor{comment}{//Make sure the socket descriptor is valid}
1621    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
1622    \{
1623       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1624    \}
1625 
1626    \textcolor{comment}{//Point to the socket structure}
1627    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
1628 
1629    \textcolor{comment}{//Close socket}
1630    \hyperlink{socket_8c_ac5012e9f71c97e2ea0410f2c5baccb0e}{socketClose}(sock);
1631 
1632    \textcolor{comment}{//Successful processing}
1633    \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1634 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a2deceb276f0a16d0dacf920964a4d7f2}\label{bsd__socket_8c_a2deceb276f0a16d0dacf920964a4d7f2}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!connect@{connect}}
\index{connect@{connect}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{connect()}{connect()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} connect (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{const \hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t}}]{addrlen }\end{DoxyParamCaption})}



Establish a connection to a specified socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor identifying an unconnected socket \\
\hline
\mbox{\tt in}  & {\em addr} & Address to which the connection should be established \\
\hline
\mbox{\tt in}  & {\em addrlen} & Length in bytes of the address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, connect returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS. Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 251 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
252 \{
253    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
254    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port};
255    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
256    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
257 
258    \textcolor{comment}{//Make sure the socket descriptor is valid}
259    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
260    \{
261       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
262    \}
263 
264    \textcolor{comment}{//Point to the socket structure}
265    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
266 
267    \textcolor{comment}{//Check the length of the address}
268    \textcolor{keywordflow}{if}(addrlen < (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr}{sockaddr}))
269    \{
270       sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
271       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
272    \}
273 
274 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
275    \textcolor{comment}{//IPv4 address?}
276    \textcolor{keywordflow}{if}(addr->\hyperlink{structsockaddr_a24dbd3e20c62f767f18ddaec18ed3b63}{sa\_family} == \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET} && addrlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(
      \hyperlink{structsockaddr__in}{sockaddr\_in}))
277    \{
278       \textcolor{comment}{//Point to the IPv4 address information}
279       \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
280       \textcolor{comment}{//Get port number}
281       port = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port});
282 
283       \textcolor{comment}{//Copy IPv4 address}
284       \textcolor{keywordflow}{if}(sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} == \hyperlink{bsd__socket_8h_a5d1940045dc2e7de552f3d4ff13a74ab}{INADDR\_ANY})
285       \{
286          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = 0;
287          ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr} = \hyperlink{ipv4_8h_aa9d277a6ff68d361eaf48d6af73e78e8}{IPV4\_UNSPECIFIED\_ADDR};
288       \}
289       \textcolor{keywordflow}{else}
290       \{
291          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr});
292          ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr} = sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr};
293       \}
294    \}
295    \textcolor{keywordflow}{else}
296 \textcolor{preprocessor}{#endif}
297 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
298    \textcolor{comment}{//IPv6 address?}
299    \textcolor{keywordflow}{if}(addr->\hyperlink{structsockaddr_a24dbd3e20c62f767f18ddaec18ed3b63}{sa\_family} == \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6} && addrlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(
      \hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6}))
300    \{
301       \textcolor{comment}{//Point to the IPv6 address information}
302       \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
303       \textcolor{comment}{//Get port number}
304       port = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port});
305 
306       \textcolor{comment}{//Copy IPv6 address}
307       \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.\hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr}, &
      \hyperlink{bsd__socket_8c_ac7c24836e783eb6e5382a54d9586605f}{in6addr\_any}))
308       \{
309          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = 0;
310          ipAddr.\hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr} = \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR};
311       \}
312       \textcolor{keywordflow}{else}
313       \{
314          ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr});
315          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(&ipAddr.\hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr}, sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.
      \hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr});
316       \}
317    \}
318    \textcolor{keywordflow}{else}
319 \textcolor{preprocessor}{#endif}
320    \textcolor{comment}{//Invalid address?}
321    \{
322       \textcolor{comment}{//Report an error}
323       sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
324       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
325    \}
326 
327    \textcolor{comment}{//Establish connection}
328    error = \hyperlink{socket_8c_aff3e3c0abc332f42189fce8f362fbd63}{socketConnect}(sock, &ipAddr, port);
329 
330    \textcolor{comment}{//Any error to report?}
331    \textcolor{keywordflow}{if}(error)
332    \{
333       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
334       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
335    \}
336 
337    \textcolor{comment}{//Successful processing}
338    \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
339 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a9b1883a0e76c305b489afab84208214e}\label{bsd__socket_8c_a9b1883a0e76c305b489afab84208214e}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!fcntl@{fcntl}}
\index{fcntl@{fcntl}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{fcntl()}{fcntl()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} fcntl (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{cmd,  }\item[{void $\ast$}]{arg }\end{DoxyParamCaption})}



Perform specific operation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt in}  & {\em cmd} & A command to perform on the socket \\
\hline
\mbox{\tt in,out}  & {\em arg} & A pointer to a parameter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, setsockopt returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 1505 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1506 \{
1507    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
1508    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags};
1509    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
1510 
1511    \textcolor{comment}{//Make sure the socket descriptor is valid}
1512    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
1513    \{
1514       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1515    \}
1516 
1517    \textcolor{comment}{//Point to the socket structure}
1518    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
1519 
1520    \textcolor{comment}{//Get exclusive access}
1521    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
1522 
1523    \textcolor{comment}{//Make sure the parameter is valid}
1524    \textcolor{keywordflow}{if}(arg != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1525    \{
1526       \textcolor{comment}{//Check command type}
1527       \textcolor{keywordflow}{switch}(cmd)
1528       \{
1529       \textcolor{comment}{//Get the file status flags?}
1530       \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a025fad21a889c79f02ec53abe3526c32}{F\_GETFL}:
1531          \textcolor{comment}{//Cast the parameter to the relevant type}
1532          flags = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) arg;
1533          \textcolor{comment}{//Check whether non-blocking mode is currently enabled}
1534          *flags = (sock->timeout == 0) ? \hyperlink{bsd__socket_8h_a39d33ce33804efd4d52606d59071c6d8}{O\_NONBLOCK} : 0;
1535          \textcolor{comment}{//Successful processing}
1536          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1537          \textcolor{keywordflow}{break};
1538 
1539       \textcolor{comment}{//Set the file status flags?}
1540       \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_af2939853c650561d3495ed40f68f6249}{F\_SETFL}:
1541          \textcolor{comment}{//Cast the parameter to the relevant type}
1542          flags = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) arg;
1543          \textcolor{comment}{//Enable blocking or non-blocking operation}
1544          sock->timeout = (*flags & \hyperlink{bsd__socket_8h_a39d33ce33804efd4d52606d59071c6d8}{O\_NONBLOCK}) ? 0 : \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
1545          \textcolor{comment}{//Successful processing}
1546          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1547          \textcolor{keywordflow}{break};
1548 
1549       \textcolor{comment}{//Unknown command?}
1550       \textcolor{keywordflow}{default}:
1551          \textcolor{comment}{//Report an error}
1552          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
1553          ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1554          \textcolor{keywordflow}{break};
1555       \}
1556    \}
1557    \textcolor{keywordflow}{else}
1558    \{
1559       \textcolor{comment}{//Report an error}
1560       sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1561       ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1562    \}
1563 
1564    \textcolor{comment}{//Release exclusive access}
1565    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
1566 
1567    \textcolor{comment}{//return status code}
1568    \textcolor{keywordflow}{return} ret;
1569 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_aa474a355020fce96cd3590b628a298fe}\label{bsd__socket_8c_aa474a355020fce96cd3590b628a298fe}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!gethostbyname@{gethostbyname}}
\index{gethostbyname@{gethostbyname}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{gethostbyname()}{gethostbyname()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} gethostbyname (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{name,  }\item[{\hyperlink{structhostent}{hostent} $\ast$}]{info }\end{DoxyParamCaption})}



Retrieve host address corresponding to a host name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & Name of the host to resolve \\
\hline
\mbox{\tt out}  & {\em info} & Address of the specified host \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, gethostbyname returns 0. Otherwise it returns an appropriate error code 
\end{DoxyReturn}


Definition at line 1923 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1924 \{
1925    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1926    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
1927 
1928    \textcolor{comment}{//Check input parameters}
1929    \textcolor{keywordflow}{if}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || info == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1930       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1931 
1932    \textcolor{comment}{//Resolve host address}
1933    error = \hyperlink{socket_8c_a9e1dd7c4ae3261bc4bb9e287c21d3c51}{getHostByName}(\hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, &ipAddr, 0);
1934    \textcolor{comment}{//Address resolution failed?}
1935    \textcolor{keywordflow}{if}(error)
1936       \textcolor{keywordflow}{return} error;
1937 
1938 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
1939    \textcolor{comment}{//IPv4 address?}
1940    \textcolor{keywordflow}{if}(ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} == \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr}))
1941    \{
1942       \textcolor{comment}{//Set address family}
1943       info->\hyperlink{structhostent_ac50b1b1166869d7d33fb283bc0cc366e}{h\_addrtype} = \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET};
1944       \textcolor{comment}{//Copy IPv4 address}
1945       info->\hyperlink{structhostent_a541d2f4b6fc636f6afe7373229dfc541}{h\_length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr});
1946       \hyperlink{ipv4_8h_a36a3af47ec7eec9b1781964eb0494b6f}{ipv4CopyAddr}(info->\hyperlink{structhostent_acdf4c8e23515ea705f732efa3e096783}{h\_addr}, &ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr});
1947    \}
1948    \textcolor{keywordflow}{else}
1949 \textcolor{preprocessor}{#endif}
1950 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
1951    \textcolor{comment}{//IPv6 address?}
1952    \textcolor{keywordflow}{if}(ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} == \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}))
1953    \{
1954       \textcolor{comment}{//Set address family}
1955       info->\hyperlink{structhostent_ac50b1b1166869d7d33fb283bc0cc366e}{h\_addrtype} = \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6};
1956       \textcolor{comment}{//Copy IPv6 address}
1957       info->\hyperlink{structhostent_a541d2f4b6fc636f6afe7373229dfc541}{h\_length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr});
1958       \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(info->\hyperlink{structhostent_acdf4c8e23515ea705f732efa3e096783}{h\_addr}, &ipAddr.\hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr});
1959    \}
1960    \textcolor{keywordflow}{else}
1961 \textcolor{preprocessor}{#endif}
1962    \textcolor{comment}{//Invalid address?}
1963    \{
1964       \textcolor{comment}{//Report an error}
1965       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1966    \}
1967 
1968    \textcolor{comment}{//Successful processing}
1969    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1970 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a393d5d2370d0c1dee376c69fc47e9688}\label{bsd__socket_8c_a393d5d2370d0c1dee376c69fc47e9688}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!getpeername@{getpeername}}
\index{getpeername@{getpeername}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{getpeername()}{getpeername()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} getpeername (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$}]{addrlen }\end{DoxyParamCaption})}



Retrieves the address of the peer to which a socket is connected. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor identifying a socket \\
\hline
\mbox{\tt out}  & {\em addr} & Address of the peer \\
\hline
\mbox{\tt in,out}  & {\em addrlen} & Length in bytes of the address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, getpeername returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 883 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
884 \{
885    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
886    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
887 
888    \textcolor{comment}{//Make sure the socket descriptor is valid}
889    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
890    \{
891       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
892    \}
893 
894    \textcolor{comment}{//Point to the socket structure}
895    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
896 
897    \textcolor{comment}{//Get exclusive access}
898    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
899 
900    \textcolor{comment}{//Check whether the socket is connected to a peer}
901    \textcolor{keywordflow}{if}(sock->remoteIpAddr.length != 0)
902    \{
903 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
904       \textcolor{comment}{//IPv4 address?}
905       \textcolor{keywordflow}{if}(sock->remoteIpAddr.length == \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in}{sockaddr\_in}))
906       \{
907          \textcolor{comment}{//Point to the IPv4 address information}
908          \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
909 
910          \textcolor{comment}{//Set address family and port number}
911          sa->\hyperlink{structsockaddr__in_a1b187e5b6abc36bcf03efe678448ed75}{sin\_family} = \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET};
912          sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(sock->remotePort);
913 
914          \textcolor{comment}{//Copy IPv4 address}
915          sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} = sock->remoteIpAddr.ipv4Addr;
916 
917          \textcolor{comment}{//Return the actual length of the address}
918          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_aa09b4858e60b678043d2b6ae464bec9b}{sockaddr\_in});
919          \textcolor{comment}{//Successful processing}
920          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
921       \}
922       \textcolor{keywordflow}{else}
923 \textcolor{preprocessor}{#endif}
924 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
925       \textcolor{comment}{//IPv6 address?}
926       \textcolor{keywordflow}{if}(sock->remoteIpAddr.length == \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in6}{sockaddr\_in6}))
927       \{
928          \textcolor{comment}{//Point to the IPv6 address information}
929          \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
930 
931          \textcolor{comment}{//Set address family and port number}
932          sa->\hyperlink{structsockaddr__in6_ac529d8e83c6d57c56d1cb7ddf61b0e8b}{sin6\_family} = \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6};
933          sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(sock->remotePort);
934 
935          \textcolor{comment}{//Copy IPv6 address}
936          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.\hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr}, &sock->remoteIpAddr.ipv6Addr);
937 
938          \textcolor{comment}{//Return the actual length of the address}
939          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6});
940          \textcolor{comment}{//Successful processing}
941          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
942       \}
943       \textcolor{keywordflow}{else}
944 \textcolor{preprocessor}{#endif}
945       \{
946          \textcolor{comment}{//The specified length is not valid}
947          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
948          ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
949       \}
950    \}
951    \textcolor{keywordflow}{else}
952    \{
953       \textcolor{comment}{//The socket is not connected to any peer}
954       sock->errnoCode = \hyperlink{bsd__socket_8h_af23e48762a0676f49d480db91cfd5e4b}{ENOTCONN};
955       ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
956    \}
957 
958    \textcolor{comment}{//Release exclusive access}
959    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
960 
961    \textcolor{comment}{//return status code}
962    \textcolor{keywordflow}{return} ret;
963 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ad1359e5306ef4a065ac567bb58c6ed82}\label{bsd__socket_8c_ad1359e5306ef4a065ac567bb58c6ed82}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!getsockname@{getsockname}}
\index{getsockname@{getsockname}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{getsockname()}{getsockname()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} getsockname (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$}]{addrlen }\end{DoxyParamCaption})}



Retrieves the local name for a socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor identifying a socket \\
\hline
\mbox{\tt out}  & {\em addr} & Address of the socket \\
\hline
\mbox{\tt in,out}  & {\em addrlen} & Length in bytes of the address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, getsockname returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 791 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
792 \{
793    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
794    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
795 
796    \textcolor{comment}{//Make sure the socket descriptor is valid}
797    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
798    \{
799       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
800    \}
801 
802    \textcolor{comment}{//Point to the socket structure}
803    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
804 
805    \textcolor{comment}{//Get exclusive access}
806    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
807 
808    \textcolor{comment}{//Check whether the socket has been bound to an address}
809    \textcolor{keywordflow}{if}(sock->localIpAddr.length != 0)
810    \{
811 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
812       \textcolor{comment}{//IPv4 address?}
813       \textcolor{keywordflow}{if}(sock->localIpAddr.length == \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in}{sockaddr\_in}))
814       \{
815          \textcolor{comment}{//Point to the IPv4 address information}
816          \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
817 
818          \textcolor{comment}{//Set address family and port number}
819          sa->\hyperlink{structsockaddr__in_a1b187e5b6abc36bcf03efe678448ed75}{sin\_family} = \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET};
820          sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(sock->localPort);
821 
822          \textcolor{comment}{//Copy IPv4 address}
823          sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} = sock->localIpAddr.ipv4Addr;
824 
825          \textcolor{comment}{//Return the actual length of the address}
826          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_aa09b4858e60b678043d2b6ae464bec9b}{sockaddr\_in});
827          \textcolor{comment}{//Successful processing}
828          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
829       \}
830       \textcolor{keywordflow}{else}
831 \textcolor{preprocessor}{#endif}
832 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
833       \textcolor{comment}{//IPv6 address?}
834       \textcolor{keywordflow}{if}(sock->localIpAddr.length == \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in6}{sockaddr\_in6}))
835       \{
836          \textcolor{comment}{//Point to the IPv6 address information}
837          \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
838 
839          \textcolor{comment}{//Set address family and port number}
840          sa->\hyperlink{structsockaddr__in6_ac529d8e83c6d57c56d1cb7ddf61b0e8b}{sin6\_family} = \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6};
841          sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(sock->localPort);
842 
843          \textcolor{comment}{//Copy IPv6 address}
844          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.\hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr}, &sock->localIpAddr.ipv6Addr);
845 
846          \textcolor{comment}{//Return the actual length of the address}
847          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6});
848          \textcolor{comment}{//Successful processing}
849          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
850       \}
851       \textcolor{keywordflow}{else}
852 \textcolor{preprocessor}{#endif}
853       \{
854          \textcolor{comment}{//The specified length is not valid}
855          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
856          ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
857       \}
858    \}
859    \textcolor{keywordflow}{else}
860    \{
861       \textcolor{comment}{//The socket is not bound to any address}
862       sock->errnoCode = \hyperlink{bsd__socket_8h_af23e48762a0676f49d480db91cfd5e4b}{ENOTCONN};
863       ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
864    \}
865 
866    \textcolor{comment}{//Release exclusive access}
867    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
868 
869    \textcolor{comment}{//return status code}
870    \textcolor{keywordflow}{return} ret;
871 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_af1d37952cd27c54305f8e8102f2abc93}\label{bsd__socket_8c_af1d37952cd27c54305f8e8102f2abc93}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!getsockopt@{getsockopt}}
\index{getsockopt@{getsockopt}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{getsockopt()}{getsockopt()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} getsockopt (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{level,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{optname,  }\item[{void $\ast$}]{optval,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$}]{optlen }\end{DoxyParamCaption})}



The getsockopt function retrieves a socket option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt in}  & {\em level} & The level at which the option is defined \\
\hline
\mbox{\tt in}  & {\em optname} & The socket option for which the value is to be retrieved \\
\hline
\mbox{\tt out}  & {\em optval} & A pointer to the buffer in which the value for the requested option is to be returned \\
\hline
\mbox{\tt in,out}  & {\em optlen} & The size, in bytes, of the buffer pointed to by the optval parameter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, getsockopt returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 1184 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1186 \{
1187    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
1188    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *val;
1189    \hyperlink{structtimeval}{timeval} *\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
1190    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
1191 
1192    \textcolor{comment}{//Make sure the socket descriptor is valid}
1193    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
1194    \{
1195       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1196    \}
1197 
1198    \textcolor{comment}{//Point to the socket structure}
1199    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
1200 
1201    \textcolor{comment}{//Get exclusive access}
1202    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
1203 
1204    \textcolor{comment}{//Make sure the option is valid}
1205    \textcolor{keywordflow}{if}(optval != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1206    \{
1207       \textcolor{comment}{//Level at which the option is defined?}
1208       \textcolor{keywordflow}{if}(\hyperlink{tls_8h_abbb6c7c49508c1ac374683f2d1159e08}{level} == \hyperlink{bsd__socket_8h_a92d045f6ee2f343d6b28830a9fec082e}{SOL\_SOCKET})
1209       \{
1210          \textcolor{comment}{//Check option type}
1211          \textcolor{keywordflow}{switch}(optname)
1212          \{
1213 \textcolor{preprocessor}{#if (TCP\_SUPPORT == ENABLED)}
1214          \textcolor{comment}{//Get send buffer size}
1215          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_af618cbb85161ff3196d3bcdf7565ba64}{SO\_SNDBUF}:
1216             \textcolor{comment}{//Check the length of the option}
1217             \textcolor{keywordflow}{if}(*optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1218             \{
1219                \textcolor{comment}{//Cast the option value to the relevant type}
1220                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1221                \textcolor{comment}{//Return the size of the send buffer}
1222                *val = sock->txBufferSize;
1223                \textcolor{comment}{//Return the actual length of the option}
1224                *optlen = \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t});
1225                \textcolor{comment}{//Successful processing}
1226                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1227             \}
1228             \textcolor{keywordflow}{else}
1229             \{
1230                \textcolor{comment}{//The option length is not valid}
1231                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1232                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1233             \}
1234 
1235             \textcolor{comment}{//We are done}
1236             \textcolor{keywordflow}{break};
1237 
1238          \textcolor{comment}{//Get receive buffer size}
1239          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a0db12e960ac303030400d9fd95391b52}{SO\_RCVBUF}:
1240             \textcolor{comment}{//Check the length of the option}
1241             \textcolor{keywordflow}{if}(*optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1242             \{
1243                \textcolor{comment}{//Cast the option value to the relevant type}
1244                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1245                \textcolor{comment}{//Return the size of the receive buffer}
1246                *val = sock->rxBufferSize;
1247                \textcolor{comment}{//Return the actual length of the option}
1248                *optlen = \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t});
1249                \textcolor{comment}{//Successful processing}
1250                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1251             \}
1252             \textcolor{keywordflow}{else}
1253             \{
1254                \textcolor{comment}{//The option length is not valid}
1255                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1256                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1257             \}
1258 
1259             \textcolor{comment}{//We are done}
1260             \textcolor{keywordflow}{break};
1261 \textcolor{preprocessor}{#endif}
1262          \textcolor{comment}{//Get send timeout or receive timeout}
1263          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_ab9d2f7ca5c94bd51cdab3e1913b66e2d}{SO\_SNDTIMEO}:
1264          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_af2d1ed6a34336a6f3df80fb518325846}{SO\_RCVTIMEO}:
1265             \textcolor{comment}{//Check the length of the option}
1266             \textcolor{keywordflow}{if}(*optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_a9eafd437d0a2c94a00a62180dfc114a3}{timeval}))
1267             \{
1268                \textcolor{comment}{//Cast the option value to the relevant type}
1269                t = (\hyperlink{structtimeval}{timeval} *) optval;
1270 
1271                \textcolor{comment}{//Return the timeout value}
1272                \textcolor{keywordflow}{if}(sock->timeout == \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY})
1273                \{
1274                   t->\hyperlink{structtimeval_a0f13475993d31d28005d68841a07da98}{tv\_sec} = 0;
1275                   t->\hyperlink{structtimeval_a63f01f050d9abb6422ced75deeb3333f}{tv\_usec} = 0;
1276                \}
1277                \textcolor{keywordflow}{else}
1278                \{
1279                   t->\hyperlink{structtimeval_a0f13475993d31d28005d68841a07da98}{tv\_sec} = sock->timeout / 1000;
1280                   t->\hyperlink{structtimeval_a63f01f050d9abb6422ced75deeb3333f}{tv\_usec} = (sock->timeout % 1000) * 1000;
1281                \}
1282 
1283                \textcolor{comment}{//Return the actual length of the option}
1284                *optlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_a9eafd437d0a2c94a00a62180dfc114a3}{timeval});
1285                \textcolor{comment}{//Successful processing}
1286                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1287             \}
1288             \textcolor{keywordflow}{else}
1289             \{
1290                \textcolor{comment}{//The option length is not valid}
1291                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1292                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1293             \}
1294 
1295             \textcolor{comment}{//We are done}
1296             \textcolor{keywordflow}{break};
1297 
1298          \textcolor{comment}{//Get error status}
1299          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a040d4fd00495232970a03425bc00e77a}{SO\_ERROR}:
1300             \textcolor{comment}{//Check the length of the option}
1301             \textcolor{keywordflow}{if}(*optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1302             \{
1303                \textcolor{comment}{//Cast the option value to the relevant type}
1304                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1305                \textcolor{comment}{//Return the error code}
1306                *val = sock->errnoCode;
1307                \textcolor{comment}{//Return the actual length of the option}
1308                *optlen = \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t});
1309 
1310                \textcolor{comment}{//Clear error status}
1311                sock->errnoCode = 0;
1312 
1313                \textcolor{comment}{//Successful processing}
1314                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1315             \}
1316             \textcolor{keywordflow}{else}
1317             \{
1318                \textcolor{comment}{//The option length is not valid}
1319                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1320                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1321             \}
1322 
1323             \textcolor{comment}{//We are done}
1324             \textcolor{keywordflow}{break};
1325 
1326          \textcolor{comment}{//Unknown option}
1327          \textcolor{keywordflow}{default}:
1328             \textcolor{comment}{//Report an error}
1329             sock->errnoCode = \hyperlink{bsd__socket_8h_acd570f8ab92198653b4459773dc3bca3}{ENOPROTOOPT};
1330             ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1331             \textcolor{keywordflow}{break};
1332          \}
1333       \}
1334       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{tls_8h_abbb6c7c49508c1ac374683f2d1159e08}{level} == \hyperlink{bsd__socket_8h_abf96615d54d7d81630efc2e8f1770223}{IPPROTO\_IP})
1335       \{
1336          \textcolor{comment}{//Check option type}
1337          \textcolor{keywordflow}{switch}(optname)
1338          \{
1339          \textcolor{comment}{//Time-to-live value}
1340          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a4e304dc3f19993aee2a94bb63ee5f2fa}{IP\_TTL}:
1341             \textcolor{comment}{//Check the length of the option}
1342             \textcolor{keywordflow}{if}(*optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1343             \{
1344                \textcolor{comment}{//Cast the option value to the relevant type}
1345                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1346                \textcolor{comment}{//Return the current TTL value}
1347                *val = sock->ttl;
1348                \textcolor{comment}{//Return the actual length of the option}
1349                *optlen = \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t});
1350 
1351                \textcolor{comment}{//Successful processing}
1352                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1353             \}
1354             \textcolor{keywordflow}{else}
1355             \{
1356                \textcolor{comment}{//The option length is not valid}
1357                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1358                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1359             \}
1360 
1361             \textcolor{comment}{//We are done}
1362             \textcolor{keywordflow}{break};
1363 
1364          \textcolor{comment}{//Time-to-live value for multicast packets}
1365          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_abf2be8a26ec89482c3c440028aacc523}{IP\_MULTICAST\_TTL}:
1366             \textcolor{comment}{//Check the length of the option}
1367             \textcolor{keywordflow}{if}(*optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1368             \{
1369                \textcolor{comment}{//Cast the option value to the relevant type}
1370                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1371                \textcolor{comment}{//Return the current TTL value}
1372                *val = sock->ttl;
1373                \textcolor{comment}{//Return the actual length of the option}
1374                *optlen = \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t});
1375 
1376                \textcolor{comment}{//Successful processing}
1377                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1378             \}
1379             \textcolor{keywordflow}{else}
1380             \{
1381                \textcolor{comment}{//The option length is not valid}
1382                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1383                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1384             \}
1385 
1386             \textcolor{comment}{//We are done}
1387             \textcolor{keywordflow}{break};
1388 
1389          \textcolor{comment}{//Unknown option}
1390          \textcolor{keywordflow}{default}:
1391             \textcolor{comment}{//Report an error}
1392             sock->errnoCode = \hyperlink{bsd__socket_8h_acd570f8ab92198653b4459773dc3bca3}{ENOPROTOOPT};
1393             ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1394             \textcolor{keywordflow}{break};
1395          \}
1396       \}
1397       \textcolor{keywordflow}{else}
1398       \{
1399          \textcolor{comment}{//The specified level is not valid}
1400          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
1401          ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1402       \}
1403    \}
1404    \textcolor{keywordflow}{else}
1405    \{
1406       \textcolor{comment}{//The option is not valid}
1407       sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1408       ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1409    \}
1410 
1411    \textcolor{comment}{//Release exclusive access}
1412    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
1413 
1414    \textcolor{comment}{//return status code}
1415    \textcolor{keywordflow}{return} ret;
1416 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a10ade0040b68c1b0d774654a7bb524e3}\label{bsd__socket_8c_a10ade0040b68c1b0d774654a7bb524e3}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!inet\+\_\+addr@{inet\+\_\+addr}}
\index{inet\+\_\+addr@{inet\+\_\+addr}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{inet\+\_\+addr()}{inet\_addr()}}
{\footnotesize\ttfamily \hyperlink{bsd__socket_8h_a98b38134a62f24554da0ffcabde8062c}{in\+\_\+addr\+\_\+t} inet\+\_\+addr (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{cp }\end{DoxyParamCaption})}



Convert a dot-\/decimal string into binary data in network byte order. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cp} & N\+U\+L\+L-\/terminated string representing the I\+Pv4 address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Binary data in network byte order 
\end{DoxyReturn}


Definition at line 1979 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1980 \{
1981 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
1982    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1983    \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr} ipv4Addr;
1984 
1985    \textcolor{comment}{//Convert a dot-decimal string to a binary IPv4 address}
1986    error = \hyperlink{ipv4_8c_a9315bca33ed7faace2bebcf6e96f8847}{ipv4StringToAddr}(cp, &ipv4Addr);
1987 
1988    \textcolor{comment}{//Check status code}
1989    \textcolor{keywordflow}{if}(error)
1990    \{
1991       \textcolor{comment}{//The input is invalid}
1992       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a3d2472d6cf31b73eeb829110dd0fffea}{INADDR\_NONE};
1993    \}
1994    \textcolor{keywordflow}{else}
1995    \{
1996       \textcolor{comment}{//Return the binary representation}
1997       \textcolor{keywordflow}{return} ipv4Addr;
1998    \}
1999 \textcolor{preprocessor}{#else}
2000    \textcolor{comment}{//IPv4 is not implemented}
2001    \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a3d2472d6cf31b73eeb829110dd0fffea}{INADDR\_NONE};
2002 \textcolor{preprocessor}{#endif}
2003 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_abbeaeda3efebfb2033ef3418623b9ffe}\label{bsd__socket_8c_abbeaeda3efebfb2033ef3418623b9ffe}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!inet\+\_\+aton@{inet\+\_\+aton}}
\index{inet\+\_\+aton@{inet\+\_\+aton}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{inet\+\_\+aton()}{inet\_aton()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} inet\+\_\+aton (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{cp,  }\item[{\hyperlink{structin__addr}{in\+\_\+addr} $\ast$}]{inp }\end{DoxyParamCaption})}



Convert a dot-\/decimal string into binary form. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cp} & N\+U\+L\+L-\/terminated string representing the I\+Pv4 address \\
\hline
\mbox{\tt out}  & {\em inp} & Binary data in network byte order \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns non-\/zero if the address is valid, zero if not 
\end{DoxyReturn}


Definition at line 2013 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
2014 \{
2015 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
2016    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2017    \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr} ipv4Addr;
2018 
2019    \textcolor{comment}{//Convert a dot-decimal string to a binary IPv4 address}
2020    error = \hyperlink{ipv4_8c_a9315bca33ed7faace2bebcf6e96f8847}{ipv4StringToAddr}(cp, &ipv4Addr);
2021 
2022    \textcolor{comment}{//Check status code}
2023    \textcolor{keywordflow}{if}(error)
2024    \{
2025       \textcolor{comment}{//The input is invalid}
2026       \textcolor{keywordflow}{return} 0;
2027    \}
2028    \textcolor{keywordflow}{else}
2029    \{
2030       \textcolor{comment}{//Copy the binary representation of the IPv4 address}
2031       inp->\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} = ipv4Addr;
2032       \textcolor{comment}{//The conversion succeeded}
2033       \textcolor{keywordflow}{return} 1;
2034    \}
2035 \textcolor{preprocessor}{#else}
2036    \textcolor{comment}{//IPv4 is not implemented}
2037    \textcolor{keywordflow}{return} 0;
2038 \textcolor{preprocessor}{#endif}
2039 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a29f9499712dc70a267ba54ff0bb75021}\label{bsd__socket_8c_a29f9499712dc70a267ba54ff0bb75021}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!inet\+\_\+ntoa@{inet\+\_\+ntoa}}
\index{inet\+\_\+ntoa@{inet\+\_\+ntoa}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{inet\+\_\+ntoa()}{inet\_ntoa()}}
{\footnotesize\ttfamily const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}$\ast$ inet\+\_\+ntoa (\begin{DoxyParamCaption}\item[{\hyperlink{structin__addr}{in\+\_\+addr}}]{in,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{cp }\end{DoxyParamCaption})}



Convert a binary I\+Pv4 address to dot-\/decimal notation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em in} & Binary representation of the I\+Pv4 address \\
\hline
\mbox{\tt out}  & {\em cp} & Pointer to the buffer where to format the string \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the formatted string 
\end{DoxyReturn}


Definition at line 2049 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
2050 \{
2051 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
2052    \textcolor{comment}{//Convert the binary IPv4 address to dot-decimal notation}
2053    \textcolor{keywordflow}{return} \hyperlink{ipv4_8c_a6d826409fb54a5cc0ce23c5f88f5c7c1}{ipv4AddrToString}(in.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr}, cp);
2054 \textcolor{preprocessor}{#else}
2055    \textcolor{comment}{//Properly terminate the string}
2056    cp[0] = \textcolor{charliteral}{'\(\backslash\)0'};
2057    \textcolor{comment}{//Return a pointer to the formatted string}
2058    \textcolor{keywordflow}{return} cp;
2059 \textcolor{preprocessor}{#endif}
2060 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a31845193f4c4c66bbb00189b5b99bb07}\label{bsd__socket_8c_a31845193f4c4c66bbb00189b5b99bb07}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!inet\+\_\+ntop@{inet\+\_\+ntop}}
\index{inet\+\_\+ntop@{inet\+\_\+ntop}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{inet\+\_\+ntop()}{inet\_ntop()}}
{\footnotesize\ttfamily const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}$\ast$ inet\+\_\+ntop (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{af,  }\item[{const void $\ast$}]{src,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{dst,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t}}]{size }\end{DoxyParamCaption})}



Convert an I\+Pv4 or I\+Pv6 address from binary to text. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em af} & Address family \\
\hline
\mbox{\tt in}  & {\em src} & Binary representation of the IP address \\
\hline
\mbox{\tt out}  & {\em dst} & N\+U\+L\+L-\/terminated string representing the IP address \\
\hline
\mbox{\tt in}  & {\em size} & Number of bytes available in the buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, the function returns a pointer to the formatted string. N\+U\+LL is returned if there was an error 
\end{DoxyReturn}


Definition at line 2144 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
2145 \{
2146 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
2147    \textcolor{comment}{//IPv4 address?}
2148    \textcolor{keywordflow}{if}(af == \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET})
2149    \{
2150       \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr} ipv4Addr;
2151 
2152       \textcolor{comment}{//Copy the binary representation of the IPv4 address}
2153       \hyperlink{ipv4_8h_a36a3af47ec7eec9b1781964eb0494b6f}{ipv4CopyAddr}(&ipv4Addr, src);
2154 
2155       \textcolor{comment}{//Convert the IPv4 address from text to binary form}
2156       \textcolor{keywordflow}{return} \hyperlink{ipv4_8c_a6d826409fb54a5cc0ce23c5f88f5c7c1}{ipv4AddrToString}(ipv4Addr, dst);
2157    \}
2158    \textcolor{keywordflow}{else}
2159 \textcolor{preprocessor}{#endif}
2160 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
2161    \textcolor{comment}{//IPv6 address?}
2162    \textcolor{keywordflow}{if}(af == \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6})
2163    \{
2164       \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr} ipv6Addr;
2165 
2166       \textcolor{comment}{//Copy the binary representation of the IPv6 address}
2167       \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(&ipv6Addr, src);
2168 
2169       \textcolor{comment}{//Convert the IPv6 address from text to binary form}
2170       \textcolor{keywordflow}{return} \hyperlink{ipv6_8c_a96e27d88ffdf1b2ca6fca448dc6b4e7e}{ipv6AddrToString}(&ipv6Addr, dst);
2171    \}
2172    \textcolor{keywordflow}{else}
2173 \textcolor{preprocessor}{#endif}
2174    \textcolor{comment}{//Invalid address family?}
2175    \{
2176       \textcolor{comment}{//Report an error}
2177       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
2178    \}
2179 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a93502f1c0698058b1be39e2022829893}\label{bsd__socket_8c_a93502f1c0698058b1be39e2022829893}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!inet\+\_\+pton@{inet\+\_\+pton}}
\index{inet\+\_\+pton@{inet\+\_\+pton}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{inet\+\_\+pton()}{inet\_pton()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} inet\+\_\+pton (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{af,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{src,  }\item[{void $\ast$}]{dst }\end{DoxyParamCaption})}



Convert an I\+Pv4 or I\+Pv6 address from text to binary form. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em af} & Address family \\
\hline
\mbox{\tt in}  & {\em src} & N\+U\+L\+L-\/terminated string representing the IP address \\
\hline
\mbox{\tt out}  & {\em dst} & Binary representation of the IP address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 1 on success. 0 is returned if the address is not valid. If the address family is not valid, -\/1 is returned 
\end{DoxyReturn}


Definition at line 2072 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
2073 \{
2074    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2075 
2076 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
2077    \textcolor{comment}{//IPv4 address?}
2078    \textcolor{keywordflow}{if}(af == \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET})
2079    \{
2080       \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr} ipv4Addr;
2081 
2082       \textcolor{comment}{//Convert the IPv4 address from text to binary form}
2083       error = \hyperlink{ipv4_8c_a9315bca33ed7faace2bebcf6e96f8847}{ipv4StringToAddr}(src, &ipv4Addr);
2084 
2085       \textcolor{comment}{//Check status code}
2086       \textcolor{keywordflow}{if}(error)
2087       \{
2088          \textcolor{comment}{//The input is invalid}
2089          \textcolor{keywordflow}{return} 0;
2090       \}
2091       \textcolor{keywordflow}{else}
2092       \{
2093          \textcolor{comment}{//Copy the binary representation of the IPv4 address}
2094          \hyperlink{ipv4_8h_a36a3af47ec7eec9b1781964eb0494b6f}{ipv4CopyAddr}(dst, &ipv4Addr);
2095          \textcolor{comment}{//The conversion succeeded}
2096          \textcolor{keywordflow}{return} 1;
2097       \}
2098    \}
2099    \textcolor{keywordflow}{else}
2100 \textcolor{preprocessor}{#endif}
2101 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
2102    \textcolor{comment}{//IPv6 address?}
2103    \textcolor{keywordflow}{if}(af == \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6})
2104    \{
2105       \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr} ipv6Addr;
2106 
2107       \textcolor{comment}{//Convert the IPv6 address from text to binary form}
2108       error = \hyperlink{ipv6_8c_a89a8cf0be05e4f9ff083e6e345b52c5f}{ipv6StringToAddr}(src, &ipv6Addr);
2109 
2110       \textcolor{comment}{//Check status code}
2111       \textcolor{keywordflow}{if}(error)
2112       \{
2113          \textcolor{comment}{//The input is invalid}
2114          \textcolor{keywordflow}{return} 0;
2115       \}
2116       \textcolor{keywordflow}{else}
2117       \{
2118          \textcolor{comment}{//Copy the binary representation of the IPv6 address}
2119          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(dst, &ipv6Addr);
2120          \textcolor{comment}{//The conversion succeeded}
2121          \textcolor{keywordflow}{return} 1;
2122       \}
2123    \}
2124    \textcolor{keywordflow}{else}
2125 \textcolor{preprocessor}{#endif}
2126    \textcolor{comment}{//Invalid address family?}
2127    \{
2128       \textcolor{comment}{//Report an error}
2129       \textcolor{keywordflow}{return} -1;
2130    \}
2131 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a3683319ac6b6c0bed6d77ecadb4fc37f}\label{bsd__socket_8c_a3683319ac6b6c0bed6d77ecadb4fc37f}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!ioctlsocket@{ioctlsocket}}
\index{ioctlsocket@{ioctlsocket}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{ioctlsocket()}{ioctlsocket()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} ioctlsocket (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{cmd,  }\item[{void $\ast$}]{arg }\end{DoxyParamCaption})}



Control the I/O mode of a socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt in}  & {\em cmd} & A command to perform on the socket \\
\hline
\mbox{\tt in,out}  & {\em arg} & A pointer to a parameter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, setsockopt returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 1428 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1429 \{
1430    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
1431    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *val;
1432    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
1433 
1434    \textcolor{comment}{//Make sure the socket descriptor is valid}
1435    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
1436    \{
1437       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1438    \}
1439 
1440    \textcolor{comment}{//Point to the socket structure}
1441    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
1442 
1443    \textcolor{comment}{//Get exclusive access}
1444    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
1445 
1446    \textcolor{comment}{//Make sure the parameter is valid}
1447    \textcolor{keywordflow}{if}(arg != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1448    \{
1449       \textcolor{comment}{//Check command type}
1450       \textcolor{keywordflow}{switch}(cmd)
1451       \{
1452 \textcolor{preprocessor}{#if (TCP\_SUPPORT == ENABLED)}
1453       \textcolor{comment}{//Get the number of characters waiting to be read}
1454       \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_ac68826c621a12d91544dab200c86c75a}{FIONREAD}:
1455          \textcolor{comment}{//Cast the parameter to the relevant type}
1456          val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) arg;
1457          \textcolor{comment}{//Return the number of characters in the receive buffer}
1458          *val = sock->rcvUser;
1459          \textcolor{comment}{//Successful processing}
1460          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1461          \textcolor{keywordflow}{break};
1462 \textcolor{preprocessor}{#endif}
1463       \textcolor{comment}{//Enable or disable non-blocking mode}
1464       \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_af48a6e38eb0ae226621514b44b9844eb}{FIONBIO}:
1465          \textcolor{comment}{//Cast the parameter to the relevant type}
1466          val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) arg;
1467          \textcolor{comment}{//Enable blocking or non-blocking operation}
1468          sock->timeout = (*val != 0) ? 0 : \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
1469          \textcolor{comment}{//Successful processing}
1470          ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1471          \textcolor{keywordflow}{break};
1472 
1473       \textcolor{comment}{//Unknown command?}
1474       \textcolor{keywordflow}{default}:
1475          \textcolor{comment}{//Report an error}
1476          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
1477          ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1478          \textcolor{keywordflow}{break};
1479       \}
1480    \}
1481    \textcolor{keywordflow}{else}
1482    \{
1483       \textcolor{comment}{//The parameter is not valid}
1484       sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1485       ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1486    \}
1487 
1488    \textcolor{comment}{//Release exclusive access}
1489    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{net_8c_afe31551ad26115fae8e575654346d441}{netMutex});
1490 
1491    \textcolor{comment}{//return status code}
1492    \textcolor{keywordflow}{return} ret;
1493 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a2d0de04655168d929019ee3deefc5a13}\label{bsd__socket_8c_a2d0de04655168d929019ee3deefc5a13}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!listen@{listen}}
\index{listen@{listen}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{listen()}{listen()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} listen (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{backlog }\end{DoxyParamCaption})}



Place a socket in the listening state. 

Place a socket in a state in which it is listening for an incoming connection


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor identifying a bound, unconnected socket \\
\hline
\mbox{\tt in}  & {\em backlog} & Maximum length of the queue of pending connections \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, listen returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS. Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 353 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
354 \{
355    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
356    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
357 
358    \textcolor{comment}{//Make sure the socket descriptor is valid}
359    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
360    \{
361       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
362    \}
363 
364    \textcolor{comment}{//Point to the socket structure}
365    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
366 
367    \textcolor{comment}{//Place the socket in the listening state}
368    error = \hyperlink{socket_8c_a96b275d0dd033cf5fc36ba1a9c4543e3}{socketListen}(sock, backlog);
369 
370    \textcolor{comment}{//Any error to report?}
371    \textcolor{keywordflow}{if}(error)
372    \{
373       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
374       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
375    \}
376 
377    \textcolor{comment}{//Successful processing}
378    \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
379 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a9d6144a22e9e2bf776b92ef5986ff3f4}\label{bsd__socket_8c_a9d6144a22e9e2bf776b92ef5986ff3f4}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!recv@{recv}}
\index{recv@{recv}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{recv()}{recv()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} recv (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{size,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{flags }\end{DoxyParamCaption})}



Receive data from a connected socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a connected socket \\
\hline
\mbox{\tt out}  & {\em data} & Buffer where to store the incoming data \\
\hline
\mbox{\tt in}  & {\em size} & Maximum number of bytes that can be received \\
\hline
\mbox{\tt in}  & {\em flags} & Set of flags that influences the behavior of this function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, recv returns the number of bytes received. If the connection has been gracefully closed, the return value is zero. Otherwise, a value of S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR is returned 
\end{DoxyReturn}


Definition at line 647 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
648 \{
649    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
650    \textcolor{keywordtype}{size\_t} received;
651    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
652 
653    \textcolor{comment}{//Make sure the socket descriptor is valid}
654    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
655    \{
656       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
657    \}
658 
659    \textcolor{comment}{//Point to the socket structure}
660    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
661 
662    \textcolor{comment}{//Receive data}
663    error = \hyperlink{socket_8c_a894c7bf0bfd4e3886fc584ed7ebbb087}{socketReceive}(sock, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size, &received, \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags} << 8);
664 
665    \textcolor{comment}{//Any error to report?}
666    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM})
667    \{
668       \textcolor{comment}{//If the connection has been gracefully closed, the return value is zero}
669       \textcolor{keywordflow}{return} 0;
670    \}
671    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
672    \{
673       \textcolor{comment}{//Otherwise, a value of SOCKET\_ERROR is returned}
674       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
675       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
676    \}
677 
678    \textcolor{comment}{//Return the number of bytes received}
679    \textcolor{keywordflow}{return} received;
680 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a7363c08d1ec430ba8f2da2a8ca62123b}\label{bsd__socket_8c_a7363c08d1ec430ba8f2da2a8ca62123b}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!recvfrom@{recvfrom}}
\index{recvfrom@{recvfrom}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{recvfrom()}{recvfrom()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} recvfrom (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{size,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{flags,  }\item[{\hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t} $\ast$}]{addrlen }\end{DoxyParamCaption})}



Receive a datagram. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt out}  & {\em data} & Buffer where to store the incoming data \\
\hline
\mbox{\tt in}  & {\em size} & Maximum number of bytes that can be received \\
\hline
\mbox{\tt in}  & {\em flags} & Set of flags that influences the behavior of this function \\
\hline
\mbox{\tt out}  & {\em addr} & Source address upon return (optional) \\
\hline
\mbox{\tt in,out}  & {\em addrlen} & Length in bytes of the address (optional) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, recvfrom returns the number of bytes received. If the connection has been gracefully closed, the return value is zero. Otherwise, a value of S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR is returned 
\end{DoxyReturn}


Definition at line 696 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
698 \{
699    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
700    \textcolor{keywordtype}{size\_t} received;
701    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port};
702    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
703    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
704 
705    \textcolor{comment}{//Make sure the socket descriptor is valid}
706    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
707    \{
708       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
709    \}
710 
711    \textcolor{comment}{//Point to the socket structure}
712    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
713 
714    \textcolor{comment}{//Receive data}
715    error = \hyperlink{socket_8c_a26af4b642b71708e1408fc94483f90bb}{socketReceiveFrom}(sock, &ipAddr, &port, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size, &received, 
      \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags} << 8);
716 
717    \textcolor{comment}{//Any error to report?}
718    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM})
719    \{
720       \textcolor{comment}{//If the connection has been gracefully closed, the return value is zero}
721       \textcolor{keywordflow}{return} 0;
722    \}
723    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
724    \{
725       \textcolor{comment}{//Otherwise, a value of SOCKET\_ERROR is returned}
726       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
727       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
728    \}
729 
730    \textcolor{comment}{//The address is optional}
731    \textcolor{keywordflow}{if}(addr != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && addrlen != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
732    \{
733 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
734       \textcolor{comment}{//IPv4 address?}
735       \textcolor{keywordflow}{if}(ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} == \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in}{sockaddr\_in}))
736       \{
737          \textcolor{comment}{//Point to the IPv4 address information}
738          \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
739 
740          \textcolor{comment}{//Set address family and port number}
741          sa->\hyperlink{structsockaddr__in_a1b187e5b6abc36bcf03efe678448ed75}{sin\_family} = \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET};
742          sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(port);
743          \textcolor{comment}{//Copy IPv4 address}
744          sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr} = ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr};
745 
746          \textcolor{comment}{//Return the actual length of the address}
747          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_aa09b4858e60b678043d2b6ae464bec9b}{sockaddr\_in});
748       \}
749       \textcolor{keywordflow}{else}
750 \textcolor{preprocessor}{#endif}
751 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
752       \textcolor{comment}{//IPv6 address?}
753       \textcolor{keywordflow}{if}(ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} == \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}) && *addrlen >= (
      \hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr__in6}{sockaddr\_in6}))
754       \{
755          \textcolor{comment}{//Point to the IPv6 address information}
756          \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
757 
758          \textcolor{comment}{//Set address family and port number}
759          sa->\hyperlink{structsockaddr__in6_ac529d8e83c6d57c56d1cb7ddf61b0e8b}{sin6\_family} = \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6};
760          sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port} = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(port);
761          \textcolor{comment}{//Copy IPv6 address}
762          \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.\hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr}, &ipAddr.
      \hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr});
763 
764          \textcolor{comment}{//Return the actual length of the address}
765          *addrlen = \textcolor{keyword}{sizeof}(\hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6});
766       \}
767       \textcolor{keywordflow}{else}
768 \textcolor{preprocessor}{#endif}
769       \textcolor{comment}{//Invalid address?}
770       \{
771          \textcolor{comment}{//Report an error}
772          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
773          \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
774       \}
775    \}
776 
777    \textcolor{comment}{//Return the number of bytes received}
778    \textcolor{keywordflow}{return} received;
779 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_abff426482a94920952fcd25843c0464c}\label{bsd__socket_8c_abff426482a94920952fcd25843c0464c}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!select@{select}}
\index{select@{select}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{select()}{select()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} select (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{nfds,  }\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{readfds,  }\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{writefds,  }\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{exceptfds,  }\item[{const \hyperlink{structtimeval}{timeval} $\ast$}]{timeout }\end{DoxyParamCaption})}



Determine the status of one or more sockets. 

The select function determines the status of one or more sockets, waiting if necessary, to perform synchronous I/O


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em nfds} & Unused parameter included only for compatibility with Berkeley socket \\
\hline
\mbox{\tt in,out}  & {\em readfds} & An optional pointer to a set of sockets to be checked for readability \\
\hline
\mbox{\tt in,out}  & {\em writefds} & An optional pointer to a set of sockets to be checked for writability \\
\hline
\mbox{\tt in,out}  & {\em exceptfds} & An optional pointer to a set of sockets to be checked for errors \\
\hline
\mbox{\tt in}  & {\em timeout} & The maximum time for select to wait. Set the timeout parameter to null for blocking operations \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The select function returns the total number of socket handles that are ready and contained in the \hyperlink{structfd__set}{fd\+\_\+set} structures, zero if the time limit expired, or S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR if an error occurred 
\end{DoxyReturn}


Definition at line 1654 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1656 \{
1657    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1658    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} j;
1659    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1660    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
1661    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1662    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} eventMask;
1663    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} eventFlags;
1664    \hyperlink{structOsEvent}{OsEvent} event;
1665    \hyperlink{structfd__set}{fd\_set} *fds;
1666 
1667    \textcolor{comment}{//Parse all the descriptor sets}
1668    \textcolor{keywordflow}{for}(i = 0; i < 3; i++)
1669    \{
1670       \textcolor{comment}{//Select the suitable descriptor set}
1671       \textcolor{keywordflow}{switch}(i)
1672       \{
1673       \textcolor{keywordflow}{case} 0:
1674          \textcolor{comment}{//Set of sockets to be checked for readability}
1675          fds = readfds;
1676          \textcolor{keywordflow}{break};
1677       \textcolor{keywordflow}{case} 1:
1678          \textcolor{comment}{//Set of sockets to be checked for writability}
1679          fds = writefds;
1680          \textcolor{keywordflow}{break};
1681       \textcolor{keywordflow}{default}:
1682          \textcolor{comment}{//Set of sockets to be checked for errors}
1683          fds = exceptfds;
1684          \textcolor{keywordflow}{break};
1685       \}
1686 
1687       \textcolor{comment}{//Each descriptor is optional and may be omitted}
1688       \textcolor{keywordflow}{if}(fds != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1689       \{
1690          \textcolor{comment}{//Parse the current set of sockets}
1691          \textcolor{keywordflow}{for}(j = 0; j < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; j++)
1692          \{
1693             \textcolor{comment}{//Invalid socket descriptor?}
1694             \textcolor{keywordflow}{if}(fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[j] < 0 || fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[j] >= 
      \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
1695             \{
1696                \textcolor{comment}{//Report an error}
1697                \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1698             \}
1699          \}
1700       \}
1701    \}
1702 
1703    \textcolor{comment}{//Create an event object to get notified of socket events}
1704    \textcolor{keywordflow}{if}(!\hyperlink{os__port__chibios_8c_ac1658f3fed1eb64efcd47e4503a9ef2e}{osCreateEvent}(&event))
1705    \{
1706       \textcolor{comment}{//Failed to create event}
1707       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1708    \}
1709 
1710    \textcolor{comment}{//Parse all the descriptor sets}
1711    \textcolor{keywordflow}{for}(i = 0; i < 3; i++)
1712    \{
1713       \textcolor{comment}{//Select the suitable descriptor set}
1714       \textcolor{keywordflow}{switch}(i)
1715       \{
1716       \textcolor{keywordflow}{case} 0:
1717          \textcolor{comment}{//Set of sockets to be checked for readability}
1718          fds = readfds;
1719          eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea72985d7e82625f037ca8a6734f49996c}{SOCKET\_EVENT\_RX\_READY};
1720          \textcolor{keywordflow}{break};
1721       \textcolor{keywordflow}{case} 1:
1722          \textcolor{comment}{//Set of sockets to be checked for writability}
1723          fds = writefds;
1724          eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea078fc309f8e29689ee08e584f00a73b6}{SOCKET\_EVENT\_TX\_READY};
1725          \textcolor{keywordflow}{break};
1726       \textcolor{keywordflow}{default}:
1727          \textcolor{comment}{//Set of sockets to be checked for errors}
1728          fds = exceptfds;
1729          eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea7a2ec59a16cf8b477fa5d5617131e649}{SOCKET\_EVENT\_CLOSED};
1730          \textcolor{keywordflow}{break};
1731       \}
1732 
1733       \textcolor{comment}{//Each descriptor is optional and may be omitted}
1734       \textcolor{keywordflow}{if}(fds != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1735       \{
1736          \textcolor{comment}{//Parse the current set of sockets}
1737          \textcolor{keywordflow}{for}(j = 0; j < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; j++)
1738          \{
1739             \textcolor{comment}{//Get the descriptor associated with the current entry}
1740             s = fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[j];
1741             \textcolor{comment}{//Subscribe to the requested events}
1742             \hyperlink{socket_8c_a2a034bca17a40ea29d238c8f45d8a842}{socketRegisterEvents}(&\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[s], &event, eventMask);
1743          \}
1744       \}
1745    \}
1746 
1747    \textcolor{comment}{//Retrieve timeout value}
1748    \textcolor{keywordflow}{if}(timeout != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1749       time = timeout->\hyperlink{structtimeval_a0f13475993d31d28005d68841a07da98}{tv\_sec} * 1000 + timeout->\hyperlink{structtimeval_a63f01f050d9abb6422ced75deeb3333f}{tv\_usec} / 1000;
1750    \textcolor{keywordflow}{else}
1751       time = \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
1752 
1753    \textcolor{comment}{//Block the current task until an event occurs}
1754    \hyperlink{os__port__chibios_8c_a1dc707247e44dfefae5bec4a322fc78a}{osWaitForEvent}(&event, time);
1755 
1756    \textcolor{comment}{//Count the number of events in the signaled state}
1757    n = 0;
1758 
1759    \textcolor{comment}{//Parse all the descriptor sets}
1760    \textcolor{keywordflow}{for}(i = 0; i < 3; i++)
1761    \{
1762       \textcolor{comment}{//Select the suitable descriptor set}
1763       \textcolor{keywordflow}{switch}(i)
1764       \{
1765       \textcolor{keywordflow}{case} 0:
1766          \textcolor{comment}{//Set of sockets to be checked for readability}
1767          fds = readfds;
1768          eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea72985d7e82625f037ca8a6734f49996c}{SOCKET\_EVENT\_RX\_READY};
1769          \textcolor{keywordflow}{break};
1770       \textcolor{keywordflow}{case} 1:
1771          \textcolor{comment}{//Set of sockets to be checked for writability}
1772          fds = writefds;
1773          eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea078fc309f8e29689ee08e584f00a73b6}{SOCKET\_EVENT\_TX\_READY};
1774          \textcolor{keywordflow}{break};
1775       \textcolor{keywordflow}{default}:
1776          \textcolor{comment}{//Set of sockets to be checked for errors}
1777          fds = exceptfds;
1778          eventMask = \hyperlink{socket_8h_add8a4c36456f478ab23bd4372aebde6ea7a2ec59a16cf8b477fa5d5617131e649}{SOCKET\_EVENT\_CLOSED};
1779          \textcolor{keywordflow}{break};
1780       \}
1781 
1782       \textcolor{comment}{//Each descriptor is optional and may be omitted}
1783       \textcolor{keywordflow}{if}(fds != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1784       \{
1785          \textcolor{comment}{//Parse the current set of sockets}
1786          \textcolor{keywordflow}{for}(j = 0; j < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; )
1787          \{
1788             \textcolor{comment}{//Get the descriptor associated with the current entry}
1789             s = fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[j];
1790             \textcolor{comment}{//Retrieve event flags for the current socket}
1791             eventFlags = \hyperlink{socket_8c_ac445bb2c530b9c51d11d3bb07b13c1c4}{socketGetEvents}(&\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[s]);
1792             \textcolor{comment}{//Unsubscribe previously registered events}
1793             \hyperlink{socket_8c_a3baa68d9d7c771a38463123a595075ff}{socketUnregisterEvents}(&\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[s]);
1794 
1795             \textcolor{comment}{//Event flag is set?}
1796             \textcolor{keywordflow}{if}(eventFlags & eventMask)
1797             \{
1798                \textcolor{comment}{//Track the number of events in the signaled state}
1799                n++;
1800                \textcolor{comment}{//Jump to the next socket descriptor}
1801                j++;
1802             \}
1803             \textcolor{keywordflow}{else}
1804             \{
1805                \textcolor{comment}{//Remove descriptor from the current set}
1806                \hyperlink{bsd__socket_8c_a33d187c3e4319fad4b8aadaf7a2aedf8}{selectFdClr}(fds, s);
1807             \}
1808          \}
1809       \}
1810    \}
1811 
1812    \textcolor{comment}{//Delete event object}
1813    \hyperlink{os__port__chibios_8c_a25827a49278bad6150b04b47165fda3d}{osDeleteEvent}(&event);
1814    \textcolor{comment}{//Return the number of events in the signaled state}
1815    \textcolor{keywordflow}{return} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1816 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a33d187c3e4319fad4b8aadaf7a2aedf8}\label{bsd__socket_8c_a33d187c3e4319fad4b8aadaf7a2aedf8}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!select\+Fd\+Clr@{select\+Fd\+Clr}}
\index{select\+Fd\+Clr@{select\+Fd\+Clr}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{select\+Fd\+Clr()}{selectFdClr()}}
{\footnotesize\ttfamily void select\+Fd\+Clr (\begin{DoxyParamCaption}\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{fds,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s }\end{DoxyParamCaption})}



Remove a descriptor from an existing set. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fds} & Pointer to a descriptor set \\
\hline
\mbox{\tt in}  & {\em s} & Descriptor that identifies the socket to remove \\
\hline
\end{DoxyParams}


Definition at line 1866 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1867 \{
1868    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1869    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} j;
1870 
1871    \textcolor{comment}{//Loop through descriptors}
1872    \textcolor{keywordflow}{for}(i = 0; i < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; i++)
1873    \{
1874       \textcolor{comment}{//Specified descriptor found?}
1875       \textcolor{keywordflow}{if}(fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[i] == \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s})
1876       \{
1877          \textcolor{comment}{//Adjust the size of the descriptor set}
1878          fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}--;
1879 
1880          \textcolor{comment}{//Remove the entry from the descriptor set}
1881          \textcolor{keywordflow}{for}(j = i; j < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; j++)
1882             fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[j] = fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[j + 1];
1883 
1884          \textcolor{comment}{//Return immediately}
1885          \textcolor{keywordflow}{return};
1886       \}
1887    \}
1888 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a143e1f45fe34421167561f59fa061ff1}\label{bsd__socket_8c_a143e1f45fe34421167561f59fa061ff1}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!select\+Fd\+Is\+Set@{select\+Fd\+Is\+Set}}
\index{select\+Fd\+Is\+Set@{select\+Fd\+Is\+Set}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{select\+Fd\+Is\+Set()}{selectFdIsSet()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} select\+Fd\+Is\+Set (\begin{DoxyParamCaption}\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{fds,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s }\end{DoxyParamCaption})}



Check whether a descriptor is set. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fds} & Pointer to a descriptor set \\
\hline
\mbox{\tt in}  & {\em s} & Descriptor that identifies the socket to test \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Nonzero if s is a member of the set. Otherwise, zero 
\end{DoxyReturn}


Definition at line 1898 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1899 \{
1900    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1901 
1902    \textcolor{comment}{//Loop through descriptors}
1903    \textcolor{keywordflow}{for}(i = 0; i < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; i++)
1904    \{
1905       \textcolor{comment}{//Check whether the specified descriptor is set}
1906       \textcolor{keywordflow}{if}(fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[i] == \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s})
1907          \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1908    \}
1909 
1910    \textcolor{comment}{//The specified descriptor is not currently set}
1911    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1912 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_abc9f09d90b70e38f41dacebb8447b524}\label{bsd__socket_8c_abc9f09d90b70e38f41dacebb8447b524}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!select\+Fd\+Set@{select\+Fd\+Set}}
\index{select\+Fd\+Set@{select\+Fd\+Set}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{select\+Fd\+Set()}{selectFdSet()}}
{\footnotesize\ttfamily void select\+Fd\+Set (\begin{DoxyParamCaption}\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{fds,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s }\end{DoxyParamCaption})}



Add a descriptor to an existing set. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fds} & Pointer to a descriptor set \\
\hline
\mbox{\tt in}  & {\em s} & Descriptor that identifies the socket to add \\
\hline
\end{DoxyParams}


Definition at line 1837 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1838 \{
1839    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
1840 
1841    \textcolor{comment}{//Loop through descriptors}
1842    \textcolor{keywordflow}{for}(i = 0; i < fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}; i++)
1843    \{
1844       \textcolor{comment}{//The specified descriptor is already set?}
1845       \textcolor{keywordflow}{if}(fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[i] == \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s})
1846          \textcolor{keywordflow}{return};
1847    \}
1848 
1849    \textcolor{comment}{//Ensure the descriptor set is not full}
1850    \textcolor{keywordflow}{if}(i < \hyperlink{bsd__socket_8h_a86c5dbf5a99358e288f573d6a1e0873f}{FD\_SETSIZE})
1851    \{
1852       \textcolor{comment}{//The specified descriptor can be safely added}
1853       fds->\hyperlink{structfd__set_abf0bd009091ff72addaa2396f8fe9d8c}{fd\_array}[i] = \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
1854       \textcolor{comment}{//Adjust the size of the descriptor set}
1855       fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count}++;
1856    \}
1857 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ae706260b57df1a389383213983263176}\label{bsd__socket_8c_ae706260b57df1a389383213983263176}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!select\+Fd\+Zero@{select\+Fd\+Zero}}
\index{select\+Fd\+Zero@{select\+Fd\+Zero}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{select\+Fd\+Zero()}{selectFdZero()}}
{\footnotesize\ttfamily void select\+Fd\+Zero (\begin{DoxyParamCaption}\item[{\hyperlink{structfd__set}{fd\+\_\+set} $\ast$}]{fds }\end{DoxyParamCaption})}



Initializes a descriptor set. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fds} & Pointer to a descriptor set \\
\hline
\end{DoxyParams}


Definition at line 1824 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1825 \{
1826    \textcolor{comment}{//Reset the descriptor count}
1827    fds->\hyperlink{structfd__set_a7f64eb4ba04934ec80743cc4ecf006ec}{fd\_count} = 0;
1828 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a408a73b0a323686664f7701515d77846}\label{bsd__socket_8c_a408a73b0a323686664f7701515d77846}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!send@{send}}
\index{send@{send}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{send()}{send()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} send (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{flags }\end{DoxyParamCaption})}



Send data to a connected socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a connected socket \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to a buffer containing the data to be transmitted \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to be transmitted \\
\hline
\mbox{\tt in}  & {\em flags} & Set of flags that influences the behavior of this function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, send returns the total number of bytes sent, which can be less than the number requested to be sent in the length parameter. Otherwise, a value of S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR is returned 
\end{DoxyReturn}


Definition at line 483 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
484 \{
485    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
486    \textcolor{keywordtype}{size\_t} written;
487    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
488 
489    \textcolor{comment}{//Make sure the socket descriptor is valid}
490    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
491    \{
492       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
493    \}
494 
495    \textcolor{comment}{//Point to the socket structure}
496    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
497 
498    \textcolor{comment}{//Send data}
499    error = \hyperlink{socket_8c_aa4eeb3a3294d14d681675ba9f0d3e568}{socketSend}(sock, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &written, \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags} << 8);
500 
501    \textcolor{comment}{//Any error to report?}
502    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
503    \{
504       \textcolor{comment}{//Check whether some data has been written}
505       \textcolor{keywordflow}{if}(written > 0)
506       \{
507          \textcolor{comment}{//If a timeout error occurs and some data has been written, the}
508          \textcolor{comment}{//count of bytes transferred so far is returned...}
509       \}
510       \textcolor{keywordflow}{else}
511       \{
512          \textcolor{comment}{//If no data has been written, a value of SOCKET\_ERROR is returned}
513          sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
514          \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
515       \}
516    \}
517    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
518    \{
519       \textcolor{comment}{//Otherwise, a value of SOCKET\_ERROR is returned}
520       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
521       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
522    \}
523 
524    \textcolor{comment}{//Return the number of bytes transferred so far}
525    \textcolor{keywordflow}{return} written;
526 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ac6bc4971dc509e476f30dcb7b1fb48d1}\label{bsd__socket_8c_ac6bc4971dc509e476f30dcb7b1fb48d1}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!sendto@{sendto}}
\index{sendto@{sendto}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{sendto()}{sendto()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} sendto (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{flags,  }\item[{const \hyperlink{structsockaddr}{sockaddr} $\ast$}]{addr,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t}}]{addrlen }\end{DoxyParamCaption})}



Send a datagram to a specific destination. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to a buffer containing the data to be transmitted \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to be transmitted \\
\hline
\mbox{\tt in}  & {\em flags} & Set of flags that influences the behavior of this function \\
\hline
\mbox{\tt in}  & {\em addr} & Destination address \\
\hline
\mbox{\tt in}  & {\em addrlen} & Length in bytes of the destination address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, sendto returns the total number of bytes sent, which can be less than the number requested to be sent in the length parameter. Otherwise, a value of S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR is returned 
\end{DoxyReturn}


Definition at line 542 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
544 \{
545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
546    \textcolor{keywordtype}{size\_t} written;
547    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port};
548    \hyperlink{structIpAddr}{IpAddr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
549    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
550 
551    \textcolor{comment}{//Make sure the socket descriptor is valid}
552    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
553    \{
554       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
555    \}
556 
557    \textcolor{comment}{//Point to the socket structure}
558    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
559 
560    \textcolor{comment}{//Check the length of the address}
561    \textcolor{keywordflow}{if}(addrlen < (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structsockaddr}{sockaddr}))
562    \{
563       \textcolor{comment}{//Report an error}
564       sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
565       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
566    \}
567 
568 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
569    \textcolor{comment}{//IPv4 address?}
570    \textcolor{keywordflow}{if}(addr->\hyperlink{structsockaddr_a24dbd3e20c62f767f18ddaec18ed3b63}{sa\_family} == \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET} && addrlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(
      \hyperlink{structsockaddr__in}{sockaddr\_in}))
571    \{
572       \textcolor{comment}{//Point to the IPv4 address information}
573       \hyperlink{structsockaddr__in}{sockaddr\_in} *sa = (\hyperlink{structsockaddr__in}{sockaddr\_in} *) addr;
574 
575       \textcolor{comment}{//Get port number}
576       port = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(sa->\hyperlink{structsockaddr__in_a3cf9239fdd8bd32855d66a4b86349fbb}{sin\_port});
577       \textcolor{comment}{//Copy IPv4 address}
578       ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr});
579       ipAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr} = sa->\hyperlink{structsockaddr__in_a30c6a5a4acce80d162371161077946b6}{sin\_addr}.\hyperlink{structin__addr_a3b6ef12385f913cc23a199205d9bf858}{s\_addr};
580    \}
581    \textcolor{keywordflow}{else}
582 \textcolor{preprocessor}{#endif}
583 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
584    \textcolor{comment}{//IPv6 address?}
585    \textcolor{keywordflow}{if}(addr->\hyperlink{structsockaddr_a24dbd3e20c62f767f18ddaec18ed3b63}{sa\_family} == \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6} && addrlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(
      \hyperlink{bsd__socket_8h_a98e68b59e2ef4a8ad88903d63e546873}{sockaddr\_in6}))
586    \{
587       \textcolor{comment}{//Point to the IPv6 address information}
588       \hyperlink{structsockaddr__in6}{sockaddr\_in6} *sa = (\hyperlink{structsockaddr__in6}{sockaddr\_in6} *) addr;
589 
590       \textcolor{comment}{//Get port number}
591       port = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(sa->\hyperlink{structsockaddr__in6_a4fc2b7a478d258e9e778772701096022}{sin6\_port});
592       \textcolor{comment}{//Copy IPv6 address}
593       ipAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr});
594       \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(&ipAddr.\hyperlink{structIpAddr_a9bc2340a9c0bc5a0b8aa9695b74e2ee6}{ipv6Addr}, sa->\hyperlink{structsockaddr__in6_a1ac1ff5bdfe91ac993cec3a80eddcccb}{sin6\_addr}.
      \hyperlink{structin6__addr_aa1d600770ac35faa253a53aecd9b3786}{s6\_addr});
595    \}
596    \textcolor{keywordflow}{else}
597 \textcolor{preprocessor}{#endif}
598    \textcolor{comment}{//Invalid address?}
599    \{
600       \textcolor{comment}{//Report an error}
601       sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
602       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
603    \}
604 
605    \textcolor{comment}{//Send data}
606    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(sock, &ipAddr, port, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &written, 
      \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags} << 8);
607 
608    \textcolor{comment}{//Any error to report?}
609    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
610    \{
611       \textcolor{comment}{//Check whether some data has been written}
612       \textcolor{keywordflow}{if}(written > 0)
613       \{
614          \textcolor{comment}{//If a timeout error occurs and some data has been written, the}
615          \textcolor{comment}{//count of bytes transferred so far is returned...}
616       \}
617       \textcolor{keywordflow}{else}
618       \{
619          \textcolor{comment}{//If no data has been written, a value of SOCKET\_ERROR is returned}
620          sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
621          \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
622       \}
623    \}
624    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
625    \{
626       \textcolor{comment}{//Otherwise, a value of SOCKET\_ERROR is returned}
627       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
628       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
629    \}
630 
631    \textcolor{comment}{//Return the number of bytes transferred so far}
632    \textcolor{keywordflow}{return} written;
633 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ac9d99325aacac0a4a6c3a374b871f96d}\label{bsd__socket_8c_ac9d99325aacac0a4a6c3a374b871f96d}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!setsockopt@{setsockopt}}
\index{setsockopt@{setsockopt}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{setsockopt()}{setsockopt()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} setsockopt (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{level,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{optname,  }\item[{const void $\ast$}]{optval,  }\item[{\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\+\_\+t}}]{optlen }\end{DoxyParamCaption})}



The setsockopt function sets a socket option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt in}  & {\em level} & The level at which the option is defined \\
\hline
\mbox{\tt in}  & {\em optname} & The socket option for which the value is to be set \\
\hline
\mbox{\tt in}  & {\em optval} & A pointer to the buffer in which the value for the requested option is specified \\
\hline
\mbox{\tt in}  & {\em optlen} & The size, in bytes, of the buffer pointed to by the optval parameter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, setsockopt returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 977 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
979 \{
980    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
981    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *val;
982    \hyperlink{structtimeval}{timeval} *\hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
983    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
984 
985    \textcolor{comment}{//Make sure the socket descriptor is valid}
986    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
987    \{
988       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
989    \}
990 
991    \textcolor{comment}{//Point to the socket structure}
992    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
993 
994    \textcolor{comment}{//Make sure the option is valid}
995    \textcolor{keywordflow}{if}(optval != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
996    \{
997       \textcolor{comment}{//Level at which the option is defined?}
998       \textcolor{keywordflow}{if}(\hyperlink{tls_8h_abbb6c7c49508c1ac374683f2d1159e08}{level} == \hyperlink{bsd__socket_8h_a92d045f6ee2f343d6b28830a9fec082e}{SOL\_SOCKET})
999       \{
1000          \textcolor{comment}{//Check option type}
1001          \textcolor{keywordflow}{switch}(optname)
1002          \{
1003          \textcolor{comment}{//The socket can be bound to an address which is already in use}
1004          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a5589f74fada0d0cd47bd6ea8741a58ee}{SO\_REUSEADDR}:
1005             \textcolor{comment}{//Ignore the specified option}
1006             ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1007             \textcolor{comment}{//We are done}
1008             \textcolor{keywordflow}{break};
1009 
1010          \textcolor{comment}{//Allow transmission and receipt of broadcast messages}
1011          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_ad05e5d66b4608d73747c4a10b802a737}{SO\_BROADCAST}:
1012             \textcolor{comment}{//Ignore the specified option}
1013             ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1014             \textcolor{comment}{//We are done}
1015             \textcolor{keywordflow}{break};
1016 
1017          \textcolor{comment}{//Set send buffer size}
1018          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_af618cbb85161ff3196d3bcdf7565ba64}{SO\_SNDBUF}:
1019             \textcolor{comment}{//Check the length of the option}
1020             \textcolor{keywordflow}{if}(optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1021             \{
1022                \textcolor{comment}{//Cast the option value to the relevant type}
1023                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1024                \textcolor{comment}{//Adjust the size of the send buffer}
1025                \hyperlink{socket_8c_aedf25ddaf93caf6fb4a9e47dae20c831}{socketSetTxBufferSize}(sock, *val);
1026                \textcolor{comment}{//Successful processing}
1027                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1028             \}
1029             \textcolor{keywordflow}{else}
1030             \{
1031                \textcolor{comment}{//The option length is not valid}
1032                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1033                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1034             \}
1035 
1036             \textcolor{comment}{//We are done}
1037             \textcolor{keywordflow}{break};
1038 
1039          \textcolor{comment}{//Set receive buffer size}
1040          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a0db12e960ac303030400d9fd95391b52}{SO\_RCVBUF}:
1041             \textcolor{comment}{//Check the length of the option}
1042             \textcolor{keywordflow}{if}(optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1043             \{
1044                \textcolor{comment}{//Cast the option value to the relevant type}
1045                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1046                \textcolor{comment}{//Adjust the size of the receive buffer}
1047                \hyperlink{socket_8c_ade5d61125056ad265723b44f236bdb20}{socketSetRxBufferSize}(sock, *val);
1048                \textcolor{comment}{//Successful processing}
1049                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1050             \}
1051             \textcolor{keywordflow}{else}
1052             \{
1053                \textcolor{comment}{//The option length is not valid}
1054                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1055                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1056             \}
1057 
1058             \textcolor{comment}{//We are done}
1059             \textcolor{keywordflow}{break};
1060 
1061          \textcolor{comment}{//Set send timeout or receive timeout}
1062          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_ab9d2f7ca5c94bd51cdab3e1913b66e2d}{SO\_SNDTIMEO}:
1063          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_af2d1ed6a34336a6f3df80fb518325846}{SO\_RCVTIMEO}:
1064             \textcolor{comment}{//Check the length of the option}
1065             \textcolor{keywordflow}{if}(optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{structtimeval}{timeval}))
1066             \{
1067                \textcolor{comment}{//Cast the option value to the relevant type}
1068                t = (\hyperlink{structtimeval}{timeval} *) optval;
1069 
1070                \textcolor{comment}{//If the specified value is of zero, I/O operations shall not time out}
1071                \textcolor{keywordflow}{if}(!t->\hyperlink{structtimeval_a0f13475993d31d28005d68841a07da98}{tv\_sec} && !t->\hyperlink{structtimeval_a63f01f050d9abb6422ced75deeb3333f}{tv\_usec})
1072                   \hyperlink{socket_8c_abdd29ac0ba4a644c726f5b1280680099}{socketSetTimeout}(sock, \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY});
1073                \textcolor{keywordflow}{else}
1074                   \hyperlink{socket_8c_abdd29ac0ba4a644c726f5b1280680099}{socketSetTimeout}(sock, t->\hyperlink{structtimeval_a0f13475993d31d28005d68841a07da98}{tv\_sec} * 1000 + t->
      \hyperlink{structtimeval_a63f01f050d9abb6422ced75deeb3333f}{tv\_usec} / 1000);
1075 
1076                \textcolor{comment}{//Successful processing}
1077                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1078             \}
1079             \textcolor{keywordflow}{else}
1080             \{
1081                \textcolor{comment}{//The option length is not valid}
1082                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1083                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1084             \}
1085 
1086             \textcolor{comment}{//We are done}
1087             \textcolor{keywordflow}{break};
1088 
1089          \textcolor{comment}{//Unknown option}
1090          \textcolor{keywordflow}{default}:
1091             \textcolor{comment}{//Report an error}
1092             sock->errnoCode = \hyperlink{bsd__socket_8h_acd570f8ab92198653b4459773dc3bca3}{ENOPROTOOPT};
1093             ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1094             \textcolor{keywordflow}{break};
1095          \}
1096       \}
1097       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{tls_8h_abbb6c7c49508c1ac374683f2d1159e08}{level} == \hyperlink{bsd__socket_8h_abf96615d54d7d81630efc2e8f1770223}{IPPROTO\_IP})
1098       \{
1099          \textcolor{comment}{//Check option type}
1100          \textcolor{keywordflow}{switch}(optname)
1101          \{
1102          \textcolor{comment}{//Time-to-live value}
1103          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_a4e304dc3f19993aee2a94bb63ee5f2fa}{IP\_TTL}:
1104             \textcolor{comment}{//Check the length of the option}
1105             \textcolor{keywordflow}{if}(optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1106             \{
1107                \textcolor{comment}{//Cast the option value to the relevant type}
1108                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1109                \textcolor{comment}{//Save TTL value}
1110                sock->ttl = *val;
1111                \textcolor{comment}{//Successful processing}
1112                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1113             \}
1114             \textcolor{keywordflow}{else}
1115             \{
1116                \textcolor{comment}{//The option length is not valid}
1117                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1118                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1119             \}
1120             
1121             \textcolor{comment}{//We are done}
1122             \textcolor{keywordflow}{break};
1123 
1124          \textcolor{comment}{//Time-to-live value for multicast packets}
1125          \textcolor{keywordflow}{case} \hyperlink{bsd__socket_8h_abf2be8a26ec89482c3c440028aacc523}{IP\_MULTICAST\_TTL}:
1126             \textcolor{comment}{//Check the length of the option}
1127             \textcolor{keywordflow}{if}(optlen >= (\hyperlink{bsd__socket_8h_a0084847d0372a0f415e269bc4cb3b615}{socklen\_t}) \textcolor{keyword}{sizeof}(\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t}))
1128             \{
1129                \textcolor{comment}{//Cast the option value to the relevant type}
1130                val = (\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} *) optval;
1131                \textcolor{comment}{//Save TTL value}
1132                sock->multicastTtl = *val;
1133                \textcolor{comment}{//Successful processing}
1134                ret = \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1135             \}
1136             \textcolor{keywordflow}{else}
1137             \{
1138                \textcolor{comment}{//The option length is not valid}
1139                sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1140                ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1141             \}
1142             
1143             \textcolor{comment}{//We are done}
1144             \textcolor{keywordflow}{break};
1145 
1146          \textcolor{comment}{//Unknown option}
1147          \textcolor{keywordflow}{default}:
1148             \textcolor{comment}{//Report an error}
1149             sock->errnoCode = \hyperlink{bsd__socket_8h_acd570f8ab92198653b4459773dc3bca3}{ENOPROTOOPT};
1150             ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1151             \textcolor{keywordflow}{break};
1152          \}
1153       \}
1154       \textcolor{keywordflow}{else}
1155       \{
1156          \textcolor{comment}{//The specified level is not valid}
1157          sock->errnoCode = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
1158          ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1159       \}
1160    \}
1161    \textcolor{keywordflow}{else}
1162    \{
1163       \textcolor{comment}{//The option is not valid}
1164       sock->errnoCode = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
1165       ret = \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1166    \}
1167 
1168    \textcolor{comment}{//return status code}
1169    \textcolor{keywordflow}{return} ret;
1170 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_ac851da2d3329074a2ff05dc48cc6c934}\label{bsd__socket_8c_ac851da2d3329074a2ff05dc48cc6c934}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{shutdown()}{shutdown()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} shutdown (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{s,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{how }\end{DoxyParamCaption})}



The shutdown function disables sends or receives on a socket. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Descriptor that identifies a socket \\
\hline
\mbox{\tt in}  & {\em how} & A flag that describes what types of operation will no longer be allowed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If no error occurs, shutdown returns S\+O\+C\+K\+E\+T\+\_\+\+S\+U\+C\+C\+E\+SS Otherwise, it returns S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR 
\end{DoxyReturn}


Definition at line 1580 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
1581 \{
1582    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1583    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
1584 
1585    \textcolor{comment}{//Make sure the socket descriptor is valid}
1586    \textcolor{keywordflow}{if}(s < 0 || s >= \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT})
1587    \{
1588       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1589    \}
1590 
1591    \textcolor{comment}{//Point to the socket structure}
1592    sock = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s}];
1593 
1594    \textcolor{comment}{//Shut down socket}
1595    error = \hyperlink{socket_8c_acc736b53dba4a0d3b11b63f75cdcfffb}{socketShutdown}(sock, how);
1596 
1597    \textcolor{comment}{//Any error to report?}
1598    \textcolor{keywordflow}{if}(error)
1599    \{
1600       sock->errnoCode = \hyperlink{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}{socketTranslateErrorCode}(error);
1601       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
1602    \}
1603 
1604    \textcolor{comment}{//Successful processing}
1605    \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a5c6a7f02dab3ced67786f07c2b4eff38}{SOCKET\_SUCCESS};
1606 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}\label{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!socket@{socket}}
\index{socket@{socket}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{socket()}{socket()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} socket (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{family,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{type,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{protocol }\end{DoxyParamCaption})}



Create a socket that is bound to a specific transport service provider. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em family} & Address family \\
\hline
\mbox{\tt in}  & {\em type} & Type specification for the new socket \\
\hline
\mbox{\tt in}  & {\em protocol} & Protocol to be used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, a file descriptor for the new socket is returned. On failure, S\+O\+C\+K\+E\+T\+\_\+\+E\+R\+R\+OR is returned 
\end{DoxyReturn}


Definition at line 108 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
109 \{
110    \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *sock;
111 
112    \textcolor{comment}{//Check address family}
113    \textcolor{keywordflow}{if}(family == \hyperlink{bsd__socket_8h_a9930604d0e32588eae76f43ca38e7826}{AF\_INET} || family == \hyperlink{bsd__socket_8h_aa03706b2738b9a58d4985dfbe99e1bac}{AF\_INET6})
114    \{
115       \textcolor{comment}{//Create a socket}
116       sock = \hyperlink{socket_8c_aa139bbf42b326b52eb08cf52771ac337}{socketOpen}(\hyperlink{resource__manager_8h_a12e46a33bfe90638e58ef067c6fd4a6e}{type}, \hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol});
117    \}
118    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(family == \hyperlink{bsd__socket_8h_aa89aa4cd481fe17260c3f5d493cc23f5}{AF\_PACKET})
119    \{
120       \textcolor{comment}{//Create a socket}
121       sock = \hyperlink{socket_8c_aa139bbf42b326b52eb08cf52771ac337}{socketOpen}(\hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a4cdd66d5c35beeed721c6b43a779315c}{SOCKET\_TYPE\_RAW\_ETH}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(
      \hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol}));
122    \}
123    \textcolor{keywordflow}{else}
124    \{
125       \textcolor{comment}{//The address family is not valid}
126       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
127    \}
128 
129    \textcolor{comment}{//Failed to create a new socket?}
130    \textcolor{keywordflow}{if}(!sock)
131    \{
132       \textcolor{comment}{//Report an error}
133       \textcolor{keywordflow}{return} \hyperlink{bsd__socket_8h_a633b0396ff93d336a088412a190a5072}{SOCKET\_ERROR};
134    \}
135 
136    \textcolor{comment}{//Return the socket descriptor}
137    \textcolor{keywordflow}{return} sock->descriptor;
138 \}
\end{DoxyCode}
\mbox{\Hypertarget{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}\label{bsd__socket_8c_a7569f5bd575db2d94d1b79b14e537dbc}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!socket\+Translate\+Error\+Code@{socket\+Translate\+Error\+Code}}
\index{socket\+Translate\+Error\+Code@{socket\+Translate\+Error\+Code}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{socket\+Translate\+Error\+Code()}{socketTranslateErrorCode()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} socket\+Translate\+Error\+Code (\begin{DoxyParamCaption}\item[{\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t}}]{error }\end{DoxyParamCaption})}



Translate error code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em error} & Error code to be translated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+SD error code 
\end{DoxyReturn}


Definition at line 58 of file bsd\+\_\+socket.\+c.


\begin{DoxyCode}
59 \{
60    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} ret;
61 
62    \textcolor{comment}{//Translate error code}
63    \textcolor{keywordflow}{switch}(error)
64    \{
65    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR}:
66       ret = 0;
67       \textcolor{keywordflow}{break};
68    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT}:
69       ret = \hyperlink{bsd__socket_8h_a4a3a0b3605fd3b2336455062ee8e25f0}{EWOULDBLOCK};
70       \textcolor{keywordflow}{break};
71    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER}:
72       ret = \hyperlink{bsd__socket_8h_a2d1678d5a7cc8ce499643f3b8957def4}{EINVAL};
73       \textcolor{keywordflow}{break};
74    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae6789100dbdd64f265c5ac1ec3d75382}{ERROR\_CONNECTION\_RESET}:
75       ret = \hyperlink{bsd__socket_8h_add4258b08af02fbe4590fbaae7260037}{ECONNRESET};
76       \textcolor{keywordflow}{break};
77    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caf13ecb3f9a3314ab1eec8859427852c5}{ERROR\_ALREADY\_CONNECTED}:
78       ret = \hyperlink{bsd__socket_8h_a164ca8549da7a385e2fe1cba823b9eaf}{EISCONN};
79       \textcolor{keywordflow}{break};
80    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED}:
81       ret = \hyperlink{bsd__socket_8h_af23e48762a0676f49d480db91cfd5e4b}{ENOTCONN};
82       \textcolor{keywordflow}{break};
83    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca23f338e4dcebc53bd379ec05a1fc7ffb}{ERROR\_CONNECTION\_CLOSING}:
84       ret = \hyperlink{bsd__socket_8h_a2a55c5dd8b54ff5aace6c274c6726d68}{ESHUTDOWN};
85       \textcolor{keywordflow}{break};
86    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0a6ba075ed4da57d15cfd4b151a2b3d6}{ERROR\_CONNECTION\_FAILED}:
87       ret = \hyperlink{bsd__socket_8h_aad88020b394ef1aa4af2f4ef9b4c8b39}{ECONNREFUSED};
88       \textcolor{keywordflow}{break};
89    \textcolor{keywordflow}{default}:
90       ret = \hyperlink{bsd__socket_8h_a3f317946e043623f9d6b93dbf60e6316}{EFAULT};
91       \textcolor{keywordflow}{break};
92    \}
93 
94    \textcolor{comment}{//Return BSD status code}
95    \textcolor{keywordflow}{return} ret;
96 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{bsd__socket_8c_ac7c24836e783eb6e5382a54d9586605f}\label{bsd__socket_8c_ac7c24836e783eb6e5382a54d9586605f}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!in6addr\+\_\+any@{in6addr\+\_\+any}}
\index{in6addr\+\_\+any@{in6addr\+\_\+any}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{in6addr\+\_\+any}{in6addr\_any}}
{\footnotesize\ttfamily const \hyperlink{structin6__addr}{in6\+\_\+addr} in6addr\+\_\+any}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
   \{\{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\}\}
\end{DoxyCode}


Definition at line 45 of file bsd\+\_\+socket.\+c.

\mbox{\Hypertarget{bsd__socket_8c_aa1ce010104daa144d2349c931828bb67}\label{bsd__socket_8c_aa1ce010104daa144d2349c931828bb67}} 
\index{bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}!in6addr\+\_\+loopback@{in6addr\+\_\+loopback}}
\index{in6addr\+\_\+loopback@{in6addr\+\_\+loopback}!bsd\+\_\+socket.\+c@{bsd\+\_\+socket.\+c}}
\subsubsection{\texorpdfstring{in6addr\+\_\+loopback}{in6addr\_loopback}}
{\footnotesize\ttfamily const \hyperlink{structin6__addr}{in6\+\_\+addr} in6addr\+\_\+loopback}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
   \{\{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01\}\}
\end{DoxyCode}


Definition at line 48 of file bsd\+\_\+socket.\+c.

