\hypertarget{heap__2_8c}{}\section{third\+\_\+party/freertos/portable/memmang/heap\+\_\+2.c File Reference}
\label{heap__2_8c}\index{third\+\_\+party/freertos/portable/memmang/heap\+\_\+2.\+c@{third\+\_\+party/freertos/portable/memmang/heap\+\_\+2.\+c}}
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Free\+R\+T\+O\+S.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}task.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structA__BLOCK__LINK}{A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+L\+I\+NK}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{heap__2_8c_ab622d8c674f2a417a666a7ed89109e79}{M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE}
\item 
\#define \hyperlink{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}~( \hyperlink{FreeRTOSConfig_8h_a9f213227674effff0122a75d94d87938}{config\+T\+O\+T\+A\+L\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE} -\/ \hyperlink{pic32mz_2portmacro_8h_ab9091ce3940d8bd93ec850122a2c6a1c}{port\+B\+Y\+T\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} )
\item 
\#define \hyperlink{heap__2_8c_ab71bae5a95671265c828339d44c44b25}{heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~( ( size\+\_\+t ) ( \hyperlink{heap__2_8c_a10691c3939df51f3b227369827076687}{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE} $\ast$ 2 ) )
\item 
\#define \hyperlink{heap__2_8c_a55396870242c952746147671bf78a149}{prv\+Insert\+Block\+Into\+Free\+List}(px\+Block\+To\+Insert)
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structA__BLOCK__LINK}{A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+L\+I\+NK} \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{heap__2_8c_a3e55181f788f17d9a3e7d226a5206e4f}{prv\+Heap\+Init} (void)
\item 
void $\ast$ \hyperlink{heap__2_8c_a0379669d07d76cc81e3028123113b271}{pv\+Port\+Malloc} (size\+\_\+t x\+Wanted\+Size)
\item 
void \hyperlink{heap__2_8c_a1e7cea2fd1bc894ea3b5f5e8179d259b}{v\+Port\+Free} (void $\ast$pv)
\item 
size\+\_\+t \hyperlink{heap__2_8c_a0c28a12b313bc248be0cb7a37ed81bb7}{x\+Port\+Get\+Free\+Heap\+Size} (void)
\item 
void \hyperlink{heap__2_8c_a8bf103ce32ce8473574e9920af8b4eec}{v\+Port\+Initialise\+Blocks} (void)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{heap__2_8c_a286aa29b13471f0d9f5a7ce688682694}{uc\+Heap} \mbox{[}\hyperlink{FreeRTOSConfig_8h_a9f213227674effff0122a75d94d87938}{config\+T\+O\+T\+A\+L\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}\mbox{]}
\item 
static const \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{heap__2_8c_a10691c3939df51f3b227369827076687}{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE} = ( ( sizeof ( \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t} ) + ( \hyperlink{pic32mz_2portmacro_8h_ab9091ce3940d8bd93ec850122a2c6a1c}{port\+B\+Y\+T\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} -\/ 1 ) ) \& $\sim$port\+B\+Y\+T\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+N\+T\+\_\+\+M\+A\+SK )
\item 
static \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t} \hyperlink{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}{x\+Start}
\item 
static \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t} \hyperlink{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}{x\+End}
\item 
static size\+\_\+t \hyperlink{heap__2_8c_a338244e3e604d3b290a3ef1903e97e4b}{x\+Free\+Bytes\+Remaining} = \hyperlink{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}\label{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE@{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}}
\index{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE@{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}{configADJUSTED\_HEAP\_SIZE}}
{\footnotesize\ttfamily \#define config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE~( \hyperlink{FreeRTOSConfig_8h_a9f213227674effff0122a75d94d87938}{config\+T\+O\+T\+A\+L\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE} -\/ \hyperlink{pic32mz_2portmacro_8h_ab9091ce3940d8bd93ec850122a2c6a1c}{port\+B\+Y\+T\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} )}



Definition at line 54 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_ab71bae5a95671265c828339d44c44b25}\label{heap__2_8c_ab71bae5a95671265c828339d44c44b25}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{heapMINIMUM\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define heap\+M\+I\+N\+I\+M\+U\+M\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~( ( size\+\_\+t ) ( \hyperlink{heap__2_8c_a10691c3939df51f3b227369827076687}{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE} $\ast$ 2 ) )}



Definition at line 81 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_ab622d8c674f2a417a666a7ed89109e79}\label{heap__2_8c_ab622d8c674f2a417a666a7ed89109e79}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE@{M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE}}
\index{M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE@{M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE}{MPU\_WRAPPERS\_INCLUDED\_FROM\_API\_FILE}}
{\footnotesize\ttfamily \#define M\+P\+U\+\_\+\+W\+R\+A\+P\+P\+E\+R\+S\+\_\+\+I\+N\+C\+L\+U\+D\+E\+D\+\_\+\+F\+R\+O\+M\+\_\+\+A\+P\+I\+\_\+\+F\+I\+LE}



Definition at line 42 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_a55396870242c952746147671bf78a149}\label{heap__2_8c_a55396870242c952746147671bf78a149}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!prv\+Insert\+Block\+Into\+Free\+List@{prv\+Insert\+Block\+Into\+Free\+List}}
\index{prv\+Insert\+Block\+Into\+Free\+List@{prv\+Insert\+Block\+Into\+Free\+List}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{prv\+Insert\+Block\+Into\+Free\+List}{prvInsertBlockIntoFreeList}}
{\footnotesize\ttfamily \#define prv\+Insert\+Block\+Into\+Free\+List(\begin{DoxyParamCaption}\item[{}]{px\+Block\+To\+Insert }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
\{                                                                                   \(\backslash\)
BlockLink\_t *pxIterator;                                                            \(\backslash\)
size\_t xBlockSize;                                                                  \(\backslash\)
                                                                                    \(\backslash\)
    xBlockSize = pxBlockToInsert->xBlockSize;                                       \(\backslash\)
                                                                                    \(\backslash\)
    \textcolor{comment}{/* Iterate through the list until a block is found that has a larger size */}    \(\backslash\)
    \textcolor{comment}{/* than the block we are inserting. */}                                          \(\backslash\)
    for( pxIterator = &\hyperlink{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}{xStart}; pxIterator->\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock}->
      \hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} < xBlockSize; pxIterator = pxIterator->pxNextFreeBlock )   \(\backslash\)
    \{                                                                               \(\backslash\)
        \textcolor{comment}{/* There is nothing to do here - just iterate to the correct position. */}   \(\backslash\)
    \}                                                                               \(\backslash\)
                                                                                    \(\backslash\)
    \textcolor{comment}{/* Update the list to include the block being inserted in the correct */}        \(\backslash\)
    \textcolor{comment}{/* position. */}                                                                 \(\backslash\)
    pxBlockToInsert->pxNextFreeBlock = pxIterator->pxNextFreeBlock;                 \(\backslash\)
    pxIterator->pxNextFreeBlock = pxBlockToInsert;                                  \(\backslash\)
\}
\end{DoxyCode}


Definition at line 97 of file heap\+\_\+2.\+c.



\subsection{Typedef Documentation}
\mbox{\Hypertarget{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}\label{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!Block\+Link\+\_\+t@{Block\+Link\+\_\+t}}
\index{Block\+Link\+\_\+t@{Block\+Link\+\_\+t}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{Block\+Link\+\_\+t}{BlockLink\_t}}
{\footnotesize\ttfamily typedef struct \hyperlink{structA__BLOCK__LINK}{A\+\_\+\+B\+L\+O\+C\+K\+\_\+\+L\+I\+NK}  \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t}}



\subsection{Function Documentation}
\mbox{\Hypertarget{heap__2_8c_a3e55181f788f17d9a3e7d226a5206e4f}\label{heap__2_8c_a3e55181f788f17d9a3e7d226a5206e4f}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!prv\+Heap\+Init@{prv\+Heap\+Init}}
\index{prv\+Heap\+Init@{prv\+Heap\+Init}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{prv\+Heap\+Init()}{prvHeapInit()}}
{\footnotesize\ttfamily static void prv\+Heap\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 249 of file heap\+\_\+2.\+c.


\begin{DoxyCode}
250 \{
251 \hyperlink{structA__BLOCK__LINK}{BlockLink\_t} *pxFirstFreeBlock;
252 \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *pucAlignedHeap;
253 
254     \textcolor{comment}{/* Ensure the heap starts on a correctly aligned boundary. */}
255     pucAlignedHeap = ( \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} * ) ( ( ( \hyperlink{FreeRTOS_8h_a53bae25f223b7156dce0fc6e6b1b2295}{portPOINTER\_SIZE\_TYPE} ) &
      \hyperlink{heap__2_8c_a286aa29b13471f0d9f5a7ce688682694}{ucHeap}[ \hyperlink{pic32mx_2portmacro_8h_ab9091ce3940d8bd93ec850122a2c6a1c}{portBYTE\_ALIGNMENT} ] ) & ( ~( ( 
      \hyperlink{FreeRTOS_8h_a53bae25f223b7156dce0fc6e6b1b2295}{portPOINTER\_SIZE\_TYPE} ) portBYTE\_ALIGNMENT\_MASK ) ) );
256 
257     \textcolor{comment}{/* xStart is used to hold a pointer to the first item in the list of free}
258 \textcolor{comment}{    blocks.  The void cast is used to prevent compiler warnings. */}
259     \hyperlink{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}{xStart}.\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock} = ( \textcolor{keywordtype}{void} * ) pucAlignedHeap;
260     \hyperlink{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}{xStart}.\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} = ( size\_t ) 0;
261 
262     \textcolor{comment}{/* xEnd is used to mark the end of the list of free blocks. */}
263     \hyperlink{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}{xEnd}.\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} = \hyperlink{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}{configADJUSTED\_HEAP\_SIZE};
264     \hyperlink{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}{xEnd}.\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
265 
266     \textcolor{comment}{/* To start with there is a single free block that is sized to take up the}
267 \textcolor{comment}{    entire heap space. */}
268     pxFirstFreeBlock = ( \textcolor{keywordtype}{void} * ) pucAlignedHeap;
269     pxFirstFreeBlock->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} = \hyperlink{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}{configADJUSTED\_HEAP\_SIZE};
270     pxFirstFreeBlock->\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock} = &\hyperlink{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}{xEnd};
271 \}
\end{DoxyCode}
\mbox{\Hypertarget{heap__2_8c_a0379669d07d76cc81e3028123113b271}\label{heap__2_8c_a0379669d07d76cc81e3028123113b271}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!pv\+Port\+Malloc@{pv\+Port\+Malloc}}
\index{pv\+Port\+Malloc@{pv\+Port\+Malloc}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{pv\+Port\+Malloc()}{pvPortMalloc()}}
{\footnotesize\ttfamily void$\ast$ pv\+Port\+Malloc (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{x\+Wanted\+Size }\end{DoxyParamCaption})}



Definition at line 118 of file heap\+\_\+2.\+c.


\begin{DoxyCode}
119 \{
120 \hyperlink{structA__BLOCK__LINK}{BlockLink\_t} *pxBlock, *pxPreviousBlock, *pxNewBlockLink;
121 \textcolor{keyword}{static} \hyperlink{pic32mx_2portmacro_8h_a46fb21e00ae0729d7515c0fbf2269796}{BaseType\_t} xHeapHasBeenInitialised = \hyperlink{projdefs_8h_aa56260e937e7e203026707e5ba944273}{pdFALSE};
122 \textcolor{keywordtype}{void} *pvReturn = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
123 
124     \hyperlink{task_8h_a366b302eba79d10b5ee2a3756f0fcc43}{vTaskSuspendAll}();
125     \{
126         \textcolor{comment}{/* If this is the first call to malloc then the heap will require}
127 \textcolor{comment}{        initialisation to setup the list of free blocks. */}
128         \textcolor{keywordflow}{if}( xHeapHasBeenInitialised == \hyperlink{projdefs_8h_aa56260e937e7e203026707e5ba944273}{pdFALSE} )
129         \{
130             \hyperlink{heap__2_8c_a3e55181f788f17d9a3e7d226a5206e4f}{prvHeapInit}();
131             xHeapHasBeenInitialised = \hyperlink{projdefs_8h_af268cf937960eb029256bd9c4d949fbe}{pdTRUE};
132         \}
133 
134         \textcolor{comment}{/* The wanted size is increased so it can contain a BlockLink\_t}
135 \textcolor{comment}{        structure in addition to the requested amount of bytes. */}
136         \textcolor{keywordflow}{if}( xWantedSize > 0 )
137         \{
138             xWantedSize += \hyperlink{heap__2_8c_a10691c3939df51f3b227369827076687}{heapSTRUCT\_SIZE};
139 
140             \textcolor{comment}{/* Ensure that blocks are always aligned to the required number of bytes. */}
141             \textcolor{keywordflow}{if}( ( xWantedSize & portBYTE\_ALIGNMENT\_MASK ) != 0 )
142             \{
143                 \textcolor{comment}{/* Byte alignment required. */}
144                 xWantedSize += ( \hyperlink{pic32mx_2portmacro_8h_ab9091ce3940d8bd93ec850122a2c6a1c}{portBYTE\_ALIGNMENT} - ( xWantedSize & 
      portBYTE\_ALIGNMENT\_MASK ) );
145             \}
146         \}
147 
148         \textcolor{keywordflow}{if}( ( xWantedSize > 0 ) && ( xWantedSize < \hyperlink{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}{configADJUSTED\_HEAP\_SIZE} ) )
149         \{
150             \textcolor{comment}{/* Blocks are stored in byte order - traverse the list from the start}
151 \textcolor{comment}{            (smallest) block until one of adequate size is found. */}
152             pxPreviousBlock = &\hyperlink{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}{xStart};
153             pxBlock = \hyperlink{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}{xStart}.\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock};
154             \textcolor{keywordflow}{while}( ( pxBlock->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} < xWantedSize ) && ( pxBlock->
      \hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} ) )
155             \{
156                 pxPreviousBlock = pxBlock;
157                 pxBlock = pxBlock->\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock};
158             \}
159 
160             \textcolor{comment}{/* If we found the end marker then a block of adequate size was not found. */}
161             \textcolor{keywordflow}{if}( pxBlock != &\hyperlink{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}{xEnd} )
162             \{
163                 \textcolor{comment}{/* Return the memory space - jumping over the BlockLink\_t structure}
164 \textcolor{comment}{                at its start. */}
165                 pvReturn = ( \textcolor{keywordtype}{void} * ) ( ( ( \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} * ) pxPreviousBlock->
      \hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock} ) + \hyperlink{heap__2_8c_a10691c3939df51f3b227369827076687}{heapSTRUCT\_SIZE} );
166 
167                 \textcolor{comment}{/* This block is being returned for use so must be taken out of the}
168 \textcolor{comment}{                list of free blocks. */}
169                 pxPreviousBlock->\hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock} = pxBlock->
      \hyperlink{structA__BLOCK__LINK_aaef1b26e95b0b7b7ebffc91fa6ce874f}{pxNextFreeBlock};
170 
171                 \textcolor{comment}{/* If the block is larger than required it can be split into two. */}
172                 \textcolor{keywordflow}{if}( ( pxBlock->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} - xWantedSize ) > 
      \hyperlink{heap__2_8c_ab71bae5a95671265c828339d44c44b25}{heapMINIMUM\_BLOCK\_SIZE} )
173                 \{
174                     \textcolor{comment}{/* This block is to be split into two.  Create a new block}
175 \textcolor{comment}{                    following the number of bytes requested. The void cast is}
176 \textcolor{comment}{                    used to prevent byte alignment warnings from the compiler. */}
177                     pxNewBlockLink = ( \textcolor{keywordtype}{void} * ) ( ( ( \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} * ) pxBlock ) + xWantedSize );
178 
179                     \textcolor{comment}{/* Calculate the sizes of two blocks split from the single}
180 \textcolor{comment}{                    block. */}
181                     pxNewBlockLink->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} = pxBlock->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} - xWantedSize;
182                     pxBlock->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} = xWantedSize;
183 
184                     \textcolor{comment}{/* Insert the new block into the list of free blocks. */}
185                     \hyperlink{heap__2_8c_a55396870242c952746147671bf78a149}{prvInsertBlockIntoFreeList}( ( pxNewBlockLink ) );
186                 \}
187 
188                 \hyperlink{heap__2_8c_a338244e3e604d3b290a3ef1903e97e4b}{xFreeBytesRemaining} -= pxBlock->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize};
189             \}
190         \}
191 
192         \hyperlink{FreeRTOS_8h_af326afe922ffa6da245c98dc227a3293}{traceMALLOC}( pvReturn, xWantedSize );
193     \}
194     ( void ) \hyperlink{task_8h_a003f8ae6d649225abd030cc76e1c7d0e}{xTaskResumeAll}();
195 
196 \textcolor{preprocessor}{    #if( configUSE\_MALLOC\_FAILED\_HOOK == 1 )}
197     \{
198         \textcolor{keywordflow}{if}( pvReturn == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
199         \{
200             \textcolor{keyword}{extern} \textcolor{keywordtype}{void} vApplicationMallocFailedHook( \textcolor{keywordtype}{void} );
201             vApplicationMallocFailedHook();
202         \}
203     \}
204 \textcolor{preprocessor}{    #endif}
205 
206     \textcolor{keywordflow}{return} pvReturn;
207 \}
\end{DoxyCode}
\mbox{\Hypertarget{heap__2_8c_a1e7cea2fd1bc894ea3b5f5e8179d259b}\label{heap__2_8c_a1e7cea2fd1bc894ea3b5f5e8179d259b}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!v\+Port\+Free@{v\+Port\+Free}}
\index{v\+Port\+Free@{v\+Port\+Free}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{v\+Port\+Free()}{vPortFree()}}
{\footnotesize\ttfamily void v\+Port\+Free (\begin{DoxyParamCaption}\item[{void $\ast$}]{pv }\end{DoxyParamCaption})}



Definition at line 210 of file heap\+\_\+2.\+c.


\begin{DoxyCode}
211 \{
212 \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *puc = ( \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} * ) pv;
213 \hyperlink{structA__BLOCK__LINK}{BlockLink\_t} *pxLink;
214 
215     \textcolor{keywordflow}{if}( pv != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )
216     \{
217         \textcolor{comment}{/* The memory being freed will have an BlockLink\_t structure immediately}
218 \textcolor{comment}{        before it. */}
219         puc -= \hyperlink{heap__2_8c_a10691c3939df51f3b227369827076687}{heapSTRUCT\_SIZE};
220 
221         \textcolor{comment}{/* This unexpected casting is to keep some compilers from issuing}
222 \textcolor{comment}{        byte alignment warnings. */}
223         pxLink = ( \textcolor{keywordtype}{void} * ) puc;
224 
225         \hyperlink{task_8h_a366b302eba79d10b5ee2a3756f0fcc43}{vTaskSuspendAll}();
226         \{
227             \textcolor{comment}{/* Add this block to the list of free blocks. */}
228             \hyperlink{heap__2_8c_a55396870242c952746147671bf78a149}{prvInsertBlockIntoFreeList}( ( ( 
      \hyperlink{structA__BLOCK__LINK}{BlockLink\_t} * ) pxLink ) );
229             \hyperlink{heap__2_8c_a338244e3e604d3b290a3ef1903e97e4b}{xFreeBytesRemaining} += pxLink->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize};
230             \hyperlink{FreeRTOS_8h_a941bb09090b5788f0c27d9690118eed2}{traceFREE}( pv, pxLink->\hyperlink{structA__BLOCK__LINK_ad5dcf5df03d8be6186c567be9e2c657b}{xBlockSize} );
231         \}
232         ( void ) \hyperlink{task_8h_a003f8ae6d649225abd030cc76e1c7d0e}{xTaskResumeAll}();
233     \}
234 \}
\end{DoxyCode}
\mbox{\Hypertarget{heap__2_8c_a8bf103ce32ce8473574e9920af8b4eec}\label{heap__2_8c_a8bf103ce32ce8473574e9920af8b4eec}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!v\+Port\+Initialise\+Blocks@{v\+Port\+Initialise\+Blocks}}
\index{v\+Port\+Initialise\+Blocks@{v\+Port\+Initialise\+Blocks}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{v\+Port\+Initialise\+Blocks()}{vPortInitialiseBlocks()}}
{\footnotesize\ttfamily void v\+Port\+Initialise\+Blocks (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line 243 of file heap\+\_\+2.\+c.


\begin{DoxyCode}
244 \{
245     \textcolor{comment}{/* This just exists to keep the linker quiet. */}
246 \}
\end{DoxyCode}
\mbox{\Hypertarget{heap__2_8c_a0c28a12b313bc248be0cb7a37ed81bb7}\label{heap__2_8c_a0c28a12b313bc248be0cb7a37ed81bb7}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!x\+Port\+Get\+Free\+Heap\+Size@{x\+Port\+Get\+Free\+Heap\+Size}}
\index{x\+Port\+Get\+Free\+Heap\+Size@{x\+Port\+Get\+Free\+Heap\+Size}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{x\+Port\+Get\+Free\+Heap\+Size()}{xPortGetFreeHeapSize()}}
{\footnotesize\ttfamily size\+\_\+t x\+Port\+Get\+Free\+Heap\+Size (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line 237 of file heap\+\_\+2.\+c.


\begin{DoxyCode}
238 \{
239     \textcolor{keywordflow}{return} \hyperlink{heap__2_8c_a338244e3e604d3b290a3ef1903e97e4b}{xFreeBytesRemaining};
240 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{heap__2_8c_a10691c3939df51f3b227369827076687}\label{heap__2_8c_a10691c3939df51f3b227369827076687}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE@{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE}}
\index{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE@{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE}{heapSTRUCT\_SIZE}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} heap\+S\+T\+R\+U\+C\+T\+\_\+\+S\+I\+ZE = ( ( sizeof ( \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t} ) + ( \hyperlink{pic32mz_2portmacro_8h_ab9091ce3940d8bd93ec850122a2c6a1c}{port\+B\+Y\+T\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+NT} -\/ 1 ) ) \& $\sim$port\+B\+Y\+T\+E\+\_\+\+A\+L\+I\+G\+N\+M\+E\+N\+T\+\_\+\+M\+A\+SK )\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 80 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_a286aa29b13471f0d9f5a7ce688682694}\label{heap__2_8c_a286aa29b13471f0d9f5a7ce688682694}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!uc\+Heap@{uc\+Heap}}
\index{uc\+Heap@{uc\+Heap}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{uc\+Heap}{ucHeap}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} uc\+Heap\mbox{[}\hyperlink{FreeRTOSConfig_8h_a9f213227674effff0122a75d94d87938}{config\+T\+O\+T\+A\+L\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 67 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}\label{heap__2_8c_a327bc354b43d50b80986aecd259bc5cf}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!x\+End@{x\+End}}
\index{x\+End@{x\+End}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{x\+End}{xEnd}}
{\footnotesize\ttfamily \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t} x\+End\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 84 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_a338244e3e604d3b290a3ef1903e97e4b}\label{heap__2_8c_a338244e3e604d3b290a3ef1903e97e4b}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!x\+Free\+Bytes\+Remaining@{x\+Free\+Bytes\+Remaining}}
\index{x\+Free\+Bytes\+Remaining@{x\+Free\+Bytes\+Remaining}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{x\+Free\+Bytes\+Remaining}{xFreeBytesRemaining}}
{\footnotesize\ttfamily size\+\_\+t x\+Free\+Bytes\+Remaining = \hyperlink{heap__2_8c_a3e68bebe7509a99550e1358cbca8e23f}{config\+A\+D\+J\+U\+S\+T\+E\+D\+\_\+\+H\+E\+A\+P\+\_\+\+S\+I\+ZE}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 88 of file heap\+\_\+2.\+c.

\mbox{\Hypertarget{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}\label{heap__2_8c_a02f2ab4cbfe2167dc3bbdaf9b6c629c9}} 
\index{heap\+\_\+2.\+c@{heap\+\_\+2.\+c}!x\+Start@{x\+Start}}
\index{x\+Start@{x\+Start}!heap\+\_\+2.\+c@{heap\+\_\+2.\+c}}
\subsubsection{\texorpdfstring{x\+Start}{xStart}}
{\footnotesize\ttfamily \hyperlink{heap__2_8c_ad9a44f586d03fc020ee6f5939defb314}{Block\+Link\+\_\+t} x\+Start\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 84 of file heap\+\_\+2.\+c.

