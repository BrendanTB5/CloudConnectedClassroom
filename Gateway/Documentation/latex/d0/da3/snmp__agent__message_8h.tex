\hypertarget{snmp__agent__message_8h}{}\section{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+message.h File Reference}
\label{snmp__agent__message_8h}\index{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+message.\+h@{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+message.\+h}}
{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structSnmpMessage}{Snmp\+Message}
\begin{DoxyCompactList}\small\item\em S\+N\+MP message. \end{DoxyCompactList}\item 
struct \hyperlink{structSnmpVarBind}{Snmp\+Var\+Bind}
\begin{DoxyCompactList}\small\item\em Variable binding. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{snmp__agent__message_8h_a427a42504af415cf18980225fbb82c35}{S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}~48
\item 
\#define \hyperlink{snmp__agent__message_8h_a9f50f90ce69145c0be4a696fe2d68d06}{S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}~37
\item 
\#define \hyperlink{snmp__agent__message_8h_a5a63cbdae2efb8c04fde936b1824bcef}{S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}~105
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{snmp__agent__message_8h_a0371fc59a7828dbd4b15565d83078837}{snmp\+Init\+Message} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Initialize a S\+N\+MP message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_ad2dc2a16291cb8620fce860e1fe3c606}{snmp\+Init\+Response} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Initialize a Get\+Response-\/\+P\+DU. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a804b9d2437d32dbc6c85f1b7769e727d}{snmp\+Compute\+Message\+Overhead} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Compute S\+N\+MP message overhead. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a0e9ed71e6fdefac5c1cf9b68ce5bebb2}{snmp\+Parse\+Message\+Header} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Parse S\+N\+MP message header. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_add8b6631f98a66746371b33fabf28c91}{snmp\+Write\+Message\+Header} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Format S\+N\+MP message header. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a16a9e30e049c906b864fbd7107c823ca}{snmp\+Parse\+Community} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Parse community name. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a454fe2bf97385fe807528d12f971d278}{snmp\+Write\+Community} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Format community name. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a9df2434771d530036f055dd55001463f}{snmp\+Parse\+Global\+Data} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Parse msg\+Global\+Data field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a4ce450369f078f72b6ce399a35660fe1}{snmp\+Write\+Global\+Data} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Format msg\+Global\+Data field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a1fc1b78ad11740dda041262c137e54f7}{snmp\+Parse\+Security\+Parameters} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Parse msg\+Security\+Parameters field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a16d70e9258620be2f2e4c1afff2a9ec6}{snmp\+Write\+Security\+Parameters} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Format msg\+Security\+Parameters field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_ab071abb69f6040b7bac407d27551724b}{snmp\+Parse\+Scoped\+Pdu} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Parse scoped\+P\+DU field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a2d4b4ddfcafc940a9d9987ce8b8e91bc}{snmp\+Write\+Scoped\+Pdu} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Format scoped\+P\+DU. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_ad9655d8d1cbaed7edb34ee76a2987cae}{snmp\+Parse\+Pdu\+Header} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Parse P\+DU header. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a8b5e6d1e43fef67326204bf6999d9b18}{snmp\+Write\+Pdu\+Header} (\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Format P\+DU header. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_ad76ec89787d10854f6d306201edd3ed5}{snmp\+Encode\+Int32} (\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$dest, size\+\_\+t $\ast$\hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Encode a 32-\/bit signed integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_aac8a5ef4f5de9b431d0f768ab0973d8d}{snmp\+Encode\+Unsigned\+Int32} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$dest, size\+\_\+t $\ast$\hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Encode a 32-\/bit unsigned integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a82c5b0d3de226dbb6f580cd3ad50fb74}{snmp\+Encode\+Unsigned\+Int64} (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} \hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$dest, size\+\_\+t $\ast$\hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Encode a 64-\/bit unsigned integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a31bbd1ea85a71a71e20f31d86301938f}{snmp\+Decode\+Int32} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$src, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Decode a 32-\/bit signed integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_a8c9d74480ba6bf5a0a9a033f3a25e0a7}{snmp\+Decode\+Unsigned\+Int32} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$src, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Decode a 32-\/bit unsigned integer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__message_8h_af7552056f1143f7768639e0ade5ad868}{snmp\+Decode\+Unsigned\+Int64} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$src, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Decode a 64-\/bit unsigned integer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{snmp__agent__message_8h_a427a42504af415cf18980225fbb82c35}\label{snmp__agent__message_8h_a427a42504af415cf18980225fbb82c35}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD@{S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}}
\index{S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD@{S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}{SNMP\_V1\_MSG\_HEADER\_OVERHEAD}}
{\footnotesize\ttfamily \#define S\+N\+M\+P\+\_\+\+V1\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD~48}



Definition at line 39 of file snmp\+\_\+agent\+\_\+message.\+h.

\mbox{\Hypertarget{snmp__agent__message_8h_a9f50f90ce69145c0be4a696fe2d68d06}\label{snmp__agent__message_8h_a9f50f90ce69145c0be4a696fe2d68d06}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD@{S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}}
\index{S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD@{S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}{SNMP\_V2C\_MSG\_HEADER\_OVERHEAD}}
{\footnotesize\ttfamily \#define S\+N\+M\+P\+\_\+\+V2\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD~37}



Definition at line 41 of file snmp\+\_\+agent\+\_\+message.\+h.

\mbox{\Hypertarget{snmp__agent__message_8h_a5a63cbdae2efb8c04fde936b1824bcef}\label{snmp__agent__message_8h_a5a63cbdae2efb8c04fde936b1824bcef}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD@{S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}}
\index{S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD@{S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD}{SNMP\_V3\_MSG\_HEADER\_OVERHEAD}}
{\footnotesize\ttfamily \#define S\+N\+M\+P\+\_\+\+V3\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+V\+E\+R\+H\+E\+AD~105}



Definition at line 43 of file snmp\+\_\+agent\+\_\+message.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{snmp__agent__message_8h_a804b9d2437d32dbc6c85f1b7769e727d}\label{snmp__agent__message_8h_a804b9d2437d32dbc6c85f1b7769e727d}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Compute\+Message\+Overhead@{snmp\+Compute\+Message\+Overhead}}
\index{snmp\+Compute\+Message\+Overhead@{snmp\+Compute\+Message\+Overhead}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Compute\+Message\+Overhead()}{snmpComputeMessageOverhead()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Compute\+Message\+Overhead (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Compute S\+N\+MP message overhead. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the S\+N\+MP message \\
\hline
\end{DoxyParams}


Definition at line 201 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
202 \{
203    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
204 
205 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED)}
206    \textcolor{comment}{//SNMPv1 version?}
207    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa3dfaf92130ae745ea9945787a64458a7}{SNMP\_VERSION\_1})
208    \{
209       \textcolor{comment}{//SNMPv1 message header overhead}
210       n = \hyperlink{snmp__agent__message_8h_a427a42504af415cf18980225fbb82c35}{SNMP\_V1\_MSG\_HEADER\_OVERHEAD};
211       \textcolor{comment}{//Take into consideration variable-length fields}
212       n += message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen} + message->\hyperlink{structSnmpMessage_a70d5dc7f03456b144b0d29a6a30b0a21}{enterpriseOidLen};
213    \}
214    \textcolor{keywordflow}{else}
215 \textcolor{preprocessor}{#endif}
216 \textcolor{preprocessor}{#if (SNMP\_V2C\_SUPPORT == ENABLED)}
217    \textcolor{comment}{//SNMPv2c version?}
218    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfaa35575472195d72a958b8482d425c2b5}{SNMP\_VERSION\_2C})
219    \{
220       \textcolor{comment}{//SNMPv2c message header overhead}
221       n = \hyperlink{snmp__agent__message_8h_a9f50f90ce69145c0be4a696fe2d68d06}{SNMP\_V2C\_MSG\_HEADER\_OVERHEAD};
222       \textcolor{comment}{//Take into consideration variable-length fields}
223       n += message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen};
224    \}
225    \textcolor{keywordflow}{else}
226 \textcolor{preprocessor}{#endif}
227 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
228    \textcolor{comment}{//SNMPv3 version?}
229    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
230    \{
231       \textcolor{comment}{//SNMPv3 message header overhead}
232       n = \hyperlink{snmp__agent__message_8h_a5a63cbdae2efb8c04fde936b1824bcef}{SNMP\_V3\_MSG\_HEADER\_OVERHEAD};
233 
234       \textcolor{comment}{//Take into consideration variable-length fields}
235       n += message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} + message->
      \hyperlink{structSnmpMessage_ac9a168d33bda6c99336def2b01440b3b}{msgUserNameLen} +
236          message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} + message->
      \hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} +
237          message->\hyperlink{structSnmpMessage_ad933640b1912b549e6f1a9280a5ce7b7}{contextEngineIdLen} + message->\hyperlink{structSnmpMessage_a64d47bc4ef9cdfaae0494c8b224b26cb}{contextNameLen};
238    \}
239    \textcolor{keywordflow}{else}
240 \textcolor{preprocessor}{#endif}
241    \textcolor{comment}{//Invalid SNMP version?}
242    \{
243       \textcolor{comment}{//Report an error}
244       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
245    \}
246 
247    \textcolor{comment}{//Sanity check}
248    \textcolor{keywordflow}{if}(n > (\hyperlink{snmp__common_8h_af5a22cbaa4973c106e664d5d01316fae}{SNMP\_MAX\_MSG\_SIZE} - \hyperlink{snmp__agent__usm_8h_a24f4b911ae5fb0514433c4ec76e5e30f}{SNMP\_MSG\_ENCRYPTION\_OVERHEAD}))
249       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
250 
251    \textcolor{comment}{//Make room for the message header at the beginning of the buffer}
252    message->\hyperlink{structSnmpMessage_a8c51e21ca5943c3dceaa76b267539bfb}{varBindList} = message->\hyperlink{structSnmpMessage_a60405510f10de109ac78bf7ae8427f24}{buffer} + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
253    \textcolor{comment}{//Maximum length of the variable binding list}
254    message->\hyperlink{structSnmpMessage_a926db41b5b7d0a3bc6394ebb63c310b0}{varBindListMaxLen} = (\hyperlink{snmp__common_8h_af5a22cbaa4973c106e664d5d01316fae}{SNMP\_MAX\_MSG\_SIZE} - 
      \hyperlink{snmp__agent__usm_8h_a24f4b911ae5fb0514433c4ec76e5e30f}{SNMP\_MSG\_ENCRYPTION\_OVERHEAD}) - n;
255 
256    \textcolor{comment}{//Successful processing}
257    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
258 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a31bbd1ea85a71a71e20f31d86301938f}\label{snmp__agent__message_8h_a31bbd1ea85a71a71e20f31d86301938f}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Decode\+Int32@{snmp\+Decode\+Int32}}
\index{snmp\+Decode\+Int32@{snmp\+Decode\+Int32}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Decode\+Int32()}{snmpDecodeInt32()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Decode\+Int32 (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{src,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Decode a 32-\/bit signed integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src} & Buffer that contains the encoded value \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to be processed \\
\hline
\mbox{\tt out}  & {\em value} & Resulting integer value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1671 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1672 \{
1673    \textcolor{keywordtype}{size\_t} i;
1674 
1675    \textcolor{comment}{//Check parameters}
1676    \textcolor{keywordflow}{if}(src == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1677       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1678    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < 1)
1679       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1680 
1681    \textcolor{comment}{//The contents octets shall be a two's complement binary}
1682    \textcolor{comment}{//number equal to the integer value}
1683    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = (src[0] & 0x80) ? -1 : 0;
1684 
1685    \textcolor{comment}{//Process contents octets}
1686    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
1687    \{
1688       \textcolor{comment}{//Rotate left operation}
1689       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} <<= 8;
1690       \textcolor{comment}{//Reconstruct integer value}
1691       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} |= src[i];
1692    \}
1693 
1694    \textcolor{comment}{//Successful processing}
1695    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1696 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a8c9d74480ba6bf5a0a9a033f3a25e0a7}\label{snmp__agent__message_8h_a8c9d74480ba6bf5a0a9a033f3a25e0a7}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Decode\+Unsigned\+Int32@{snmp\+Decode\+Unsigned\+Int32}}
\index{snmp\+Decode\+Unsigned\+Int32@{snmp\+Decode\+Unsigned\+Int32}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Decode\+Unsigned\+Int32()}{snmpDecodeUnsignedInt32()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Decode\+Unsigned\+Int32 (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{src,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Decode a 32-\/bit unsigned integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src} & Buffer that contains the encoded value \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to be processed \\
\hline
\mbox{\tt out}  & {\em value} & Resulting integer value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1707 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1708 \{
1709    \textcolor{keywordtype}{size\_t} i;
1710 
1711    \textcolor{comment}{//Check parameters}
1712    \textcolor{keywordflow}{if}(src == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1713       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1714    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < 1)
1715       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1716 
1717    \textcolor{comment}{//Only accept non-negative numbers}
1718    \textcolor{keywordflow}{if}(src[0] & 0x80)
1719       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1720 
1721    \textcolor{comment}{//Initialize integer value}
1722    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = 0;
1723 
1724    \textcolor{comment}{//Process contents octets}
1725    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
1726    \{
1727       \textcolor{comment}{//Rotate left operation}
1728       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} <<= 8;
1729       \textcolor{comment}{//Reconstruct integer value}
1730       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} |= src[i];
1731    \}
1732 
1733    \textcolor{comment}{//Successful processing}
1734    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1735 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_af7552056f1143f7768639e0ade5ad868}\label{snmp__agent__message_8h_af7552056f1143f7768639e0ade5ad868}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Decode\+Unsigned\+Int64@{snmp\+Decode\+Unsigned\+Int64}}
\index{snmp\+Decode\+Unsigned\+Int64@{snmp\+Decode\+Unsigned\+Int64}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Decode\+Unsigned\+Int64()}{snmpDecodeUnsignedInt64()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Decode\+Unsigned\+Int64 (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{src,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Decode a 64-\/bit unsigned integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em src} & Buffer that contains the encoded value \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes to be processed \\
\hline
\mbox{\tt out}  & {\em value} & Resulting integer value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1746 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1747 \{
1748    \textcolor{keywordtype}{size\_t} i;
1749 
1750    \textcolor{comment}{//Check parameters}
1751    \textcolor{keywordflow}{if}(src == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1752       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1753    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < 1)
1754       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1755 
1756    \textcolor{comment}{//Only accept non-negative numbers}
1757    \textcolor{keywordflow}{if}(src[0] & 0x80)
1758       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1759 
1760    \textcolor{comment}{//Initialize integer value}
1761    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = 0;
1762 
1763    \textcolor{comment}{//Process contents octets}
1764    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}; i++)
1765    \{
1766       \textcolor{comment}{//Rotate left operation}
1767       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} <<= 8;
1768       \textcolor{comment}{//Reconstruct integer value}
1769       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} |= src[i];
1770    \}
1771 
1772    \textcolor{comment}{//Successful processing}
1773    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1774 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_ad76ec89787d10854f6d306201edd3ed5}\label{snmp__agent__message_8h_ad76ec89787d10854f6d306201edd3ed5}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Encode\+Int32@{snmp\+Encode\+Int32}}
\index{snmp\+Encode\+Int32@{snmp\+Encode\+Int32}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Encode\+Int32()}{snmpEncodeInt32()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Encode\+Int32 (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\+\_\+t}}]{value,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{dest,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}



Encode a 32-\/bit signed integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em value} & Integer value \\
\hline
\mbox{\tt out}  & {\em dest} & Buffer where to encode the integer \\
\hline
\mbox{\tt out}  & {\em length} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1514 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1515 \{
1516    \textcolor{keywordtype}{size\_t} i;
1517    \textcolor{keywordtype}{size\_t} j;
1518    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *src;
1519 
1520    \textcolor{comment}{//Check parameters}
1521    \textcolor{keywordflow}{if}(dest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1522       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1523 
1524    \textcolor{comment}{//The integer is encoded MSB first}
1525    \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = (\hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t}) \hyperlink{cpu__endian_8h_a938bc0bd4cc428c5d05dd519bde9f2be}{htobe32}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
1526    \textcolor{comment}{//Cast the integer to byte array}
1527    src = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1528 
1529    \textcolor{comment}{//An integer value is always encoded in the smallest possible number of octets}
1530    \textcolor{keywordflow}{for}(i = 0; i < 3; i++)
1531    \{
1532       \textcolor{comment}{//The upper 9 bits shall not have the same value (all 0 or all 1)}
1533       \textcolor{keywordflow}{if}((src[i] != 0x00 || (src[i + 1] & 0x80) != 0x00) &&
1534          (src[i] != 0xFF || (src[i + 1] & 0x80) != 0x80))
1535       \{
1536          \textcolor{keywordflow}{break};
1537       \}
1538    \}
1539 
1540    \textcolor{comment}{//Point to the beginning of the output buffer}
1541    j = 0;
1542 
1543    \textcolor{comment}{//Copy integer value}
1544    \textcolor{keywordflow}{while}(i < 4)
1545    \{
1546       dest[j++] = src[i++];
1547    \}
1548 
1549    \textcolor{comment}{//Total number of bytes that have been written}
1550    *\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = j;
1551 
1552    \textcolor{comment}{//Successful processing}
1553    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1554 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_aac8a5ef4f5de9b431d0f768ab0973d8d}\label{snmp__agent__message_8h_aac8a5ef4f5de9b431d0f768ab0973d8d}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Encode\+Unsigned\+Int32@{snmp\+Encode\+Unsigned\+Int32}}
\index{snmp\+Encode\+Unsigned\+Int32@{snmp\+Encode\+Unsigned\+Int32}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Encode\+Unsigned\+Int32()}{snmpEncodeUnsignedInt32()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Encode\+Unsigned\+Int32 (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{value,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{dest,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}



Encode a 32-\/bit unsigned integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em value} & Integer value \\
\hline
\mbox{\tt out}  & {\em dest} & Buffer where to encode the integer \\
\hline
\mbox{\tt out}  & {\em length} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1565 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1566 \{
1567    \textcolor{keywordtype}{size\_t} i;
1568    \textcolor{keywordtype}{size\_t} j;
1569    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *src;
1570 
1571    \textcolor{comment}{//Check parameters}
1572    \textcolor{keywordflow}{if}(dest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1573       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1574 
1575    \textcolor{comment}{//The integer is encoded MSB first}
1576    \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = \hyperlink{cpu__endian_8h_a938bc0bd4cc428c5d05dd519bde9f2be}{htobe32}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
1577    \textcolor{comment}{//Cast the integer to byte array}
1578    src = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1579 
1580    \textcolor{comment}{//An integer value is always encoded in the smallest possible number of octets}
1581    \textcolor{keywordflow}{for}(i = 0; i < 3; i++)
1582    \{
1583       \textcolor{comment}{//Check the upper 8 bits}
1584       \textcolor{keywordflow}{if}(src[i] != 0x00)
1585          \textcolor{keywordflow}{break};
1586    \}
1587 
1588    \textcolor{comment}{//Point to the beginning of the output buffer}
1589    j = 0;
1590 
1591    \textcolor{comment}{//Check the most significant bit}
1592    \textcolor{keywordflow}{if}(src[i] & 0x80)
1593       dest[j++] = 0;
1594 
1595    \textcolor{comment}{//Copy integer value}
1596    \textcolor{keywordflow}{while}(i < 4)
1597    \{
1598       dest[j++] = src[i++];
1599    \}
1600 
1601    \textcolor{comment}{//Total number of bytes that have been written}
1602    *\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = j;
1603 
1604    \textcolor{comment}{//Successful processing}
1605    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1606 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a82c5b0d3de226dbb6f580cd3ad50fb74}\label{snmp__agent__message_8h_a82c5b0d3de226dbb6f580cd3ad50fb74}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Encode\+Unsigned\+Int64@{snmp\+Encode\+Unsigned\+Int64}}
\index{snmp\+Encode\+Unsigned\+Int64@{snmp\+Encode\+Unsigned\+Int64}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Encode\+Unsigned\+Int64()}{snmpEncodeUnsignedInt64()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Encode\+Unsigned\+Int64 (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t}}]{value,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{dest,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}



Encode a 64-\/bit unsigned integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em value} & Integer value \\
\hline
\mbox{\tt out}  & {\em dest} & Buffer where to encode the integer \\
\hline
\mbox{\tt out}  & {\em length} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1617 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1618 \{
1619    \textcolor{keywordtype}{size\_t} i;
1620    \textcolor{keywordtype}{size\_t} j;
1621    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *src;
1622 
1623    \textcolor{comment}{//Check parameters}
1624    \textcolor{keywordflow}{if}(dest == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1625       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1626 
1627    \textcolor{comment}{//The integer is encoded MSB first}
1628    \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = \hyperlink{cpu__endian_8h_a02eed9f02bd58916880c33c57510bea5}{htobe64}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
1629    \textcolor{comment}{//Cast the integer to byte array}
1630    src = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1631 
1632    \textcolor{comment}{//An integer value is always encoded in the smallest possible number of octets}
1633    \textcolor{keywordflow}{for}(i = 0; i < 7; i++)
1634    \{
1635       \textcolor{comment}{//Check the upper 8 bits}
1636       \textcolor{keywordflow}{if}(src[i] != 0x00)
1637          \textcolor{keywordflow}{break};
1638    \}
1639 
1640    \textcolor{comment}{//Point to the beginning of the output buffer}
1641    j = 0;
1642 
1643    \textcolor{comment}{//Check the most significant bit}
1644    \textcolor{keywordflow}{if}(src[i] & 0x80)
1645    \{
1646       dest[j++] = 0;
1647    \}
1648 
1649    \textcolor{comment}{//Copy integer value}
1650    \textcolor{keywordflow}{while}(i < 8)
1651    \{
1652       dest[j++] = src[i++];
1653    \}
1654 
1655    \textcolor{comment}{//Total number of bytes that have been written}
1656    *\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = j;
1657 
1658    \textcolor{comment}{//Successful processing}
1659    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1660 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a0371fc59a7828dbd4b15565d83078837}\label{snmp__agent__message_8h_a0371fc59a7828dbd4b15565d83078837}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Init\+Message@{snmp\+Init\+Message}}
\index{snmp\+Init\+Message@{snmp\+Init\+Message}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Init\+Message()}{snmpInitMessage()}}
{\footnotesize\ttfamily void snmp\+Init\+Message (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Initialize a S\+N\+MP message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the S\+N\+MP message \\
\hline
\end{DoxyParams}


Definition at line 52 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
53 \{
54    \textcolor{comment}{//Current position in the message}
55    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
56    \textcolor{comment}{//Length of the message}
57    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} = 0;
58 
59    \textcolor{comment}{//SNMP version identifier}
60    message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} = \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa3dfaf92130ae745ea9945787a64458a7}{SNMP\_VERSION\_1};
61 
62 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED || SNMP\_V2C\_SUPPORT == ENABLED)}
63    \textcolor{comment}{//Initialize community name}
64    message->\hyperlink{structSnmpMessage_ac9976028507798166e3f542d5806c811}{community} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
65    message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen} = 0;
66 \textcolor{preprocessor}{#endif}
67 
68 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
69    \textcolor{comment}{//Initialize msgGlobalData fields}
70    message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId} = 0;
71    message->\hyperlink{structSnmpMessage_a078984d1faa7cb4eb2e7978261c8cba6}{msgMaxSize} = 0;
72    message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} = 0;
73    message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel} = 0;
74 
75    \textcolor{comment}{//Initialize msgSecurityParameters fields}
76    message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
77    message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} = 0;
78    message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots} = 0;
79    message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime} = 0;
80    message->\hyperlink{structSnmpMessage_a83e0d7035f301d07352eb2d3b6b1679a}{msgUserName} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
81    message->\hyperlink{structSnmpMessage_ac9a168d33bda6c99336def2b01440b3b}{msgUserNameLen} = 0;
82    message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
83    message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} = 0;
84    message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
85    message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = 0;
86 
87    \textcolor{comment}{//Initialize scopedPDU fields}
88    message->\hyperlink{structSnmpMessage_a737a67e1857fb23d90d149cfb0d21e1c}{contextEngineId} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
89    message->\hyperlink{structSnmpMessage_ad933640b1912b549e6f1a9280a5ce7b7}{contextEngineIdLen} = 0;
90    message->\hyperlink{structSnmpMessage_ab7b3dc54e8e1538249e1e0e08123f0f9}{contextName} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
91    message->\hyperlink{structSnmpMessage_a64d47bc4ef9cdfaae0494c8b224b26cb}{contextNameLen} = 0;
92 \textcolor{preprocessor}{#endif}
93 
94    \textcolor{comment}{//Initialize PDU fields}
95    message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} = \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa2c6d80868e156130b005e1d303f1672a}{SNMP\_PDU\_GET\_REQUEST};
96    message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId} = 0;
97    message->\hyperlink{structSnmpMessage_afb6f5e5cf7da54678aff6c79dd5948ce}{errorStatus} = \hyperlink{snmp__common_8h_afec1d446e343fe7cfe268cf4b7753fd2aaf909d71634fc281c206312026fa9a20}{SNMP\_ERROR\_NONE};
98    message->\hyperlink{structSnmpMessage_a6be5f10373d70dd0972a43a24299a8f7}{errorIndex} = 0;
99 
100 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED)}
101    message->\hyperlink{structSnmpMessage_a807a5b8b2aaf91ba7ad7c5130f7de5fe}{enterpriseOid} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
102    message->\hyperlink{structSnmpMessage_a70d5dc7f03456b144b0d29a6a30b0a21}{enterpriseOidLen} = 0;
103    message->\hyperlink{structSnmpMessage_a3c51309a93e0740209c2ee75307c0f04}{agentAddr} = \hyperlink{ipv4_8h_aa9d277a6ff68d361eaf48d6af73e78e8}{IPV4\_UNSPECIFIED\_ADDR};
104    message->\hyperlink{structSnmpMessage_abef516557dd784fbaffa335e9e63353c}{genericTrapType} = 0;
105    message->\hyperlink{structSnmpMessage_aca9391c4afa530ea6d4a12d48b8b424a}{specificTrapCode} = 0;
106    message->\hyperlink{structSnmpMessage_afbc78f992a1722fce0dbeb050600d070}{timestamp} = 0;
107 \textcolor{preprocessor}{#endif}
108 
109 \textcolor{preprocessor}{#if (SNMP\_V2C\_SUPPORT == ENABLED || SNMP\_V3\_SUPPORT == ENABLED)}
110    message->\hyperlink{structSnmpMessage_a636216d602b0d25cd83d25b42f828105}{nonRepeaters} = 0;
111    message->\hyperlink{structSnmpMessage_afa0f8f0e8eb0a126a401704cef25d3d3}{maxRepetitions} = 0;
112 \textcolor{preprocessor}{#endif}
113 
114    \textcolor{comment}{//Initialize the list of variable bindings}
115    message->\hyperlink{structSnmpMessage_a8c51e21ca5943c3dceaa76b267539bfb}{varBindList} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
116    message->\hyperlink{structSnmpMessage_a877d26bc0ae8ef5c78ac645a2ba112ea}{varBindListLen} = 0;
117    message->\hyperlink{structSnmpMessage_a926db41b5b7d0a3bc6394ebb63c310b0}{varBindListMaxLen} = 0;
118    message->\hyperlink{structSnmpMessage_a91aaa1028c1cec2114812bec3ba91e2e}{oidLen} = 0;
119 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_ad2dc2a16291cb8620fce860e1fe3c606}\label{snmp__agent__message_8h_ad2dc2a16291cb8620fce860e1fe3c606}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Init\+Response@{snmp\+Init\+Response}}
\index{snmp\+Init\+Response@{snmp\+Init\+Response}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Init\+Response()}{snmpInitResponse()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Init\+Response (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Initialize a Get\+Response-\/\+P\+DU. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 128 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
129 \{
130    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
131 
132    \textcolor{comment}{//SNMP version identifier}
133    context->response.version = context->request.version;
134 
135 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED || SNMP\_V2C\_SUPPORT == ENABLED)}
136    \textcolor{comment}{//Community name}
137    context->response.community = context->request.community;
138    context->response.communityLen = context->request.communityLen;
139 \textcolor{preprocessor}{#endif}
140 
141 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
142    \textcolor{comment}{//Message identifier}
143    context->response.msgId = context->request.msgId;
144    \textcolor{comment}{//Maximum message size supported by the sender}
145    context->response.msgMaxSize = \hyperlink{snmp__common_8h_af5a22cbaa4973c106e664d5d01316fae}{SNMP\_MAX\_MSG\_SIZE};
146 
147    \textcolor{comment}{//Bit fields which control processing of the message}
148    context->response.msgFlags = context->request.msgFlags &
149       (\hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a8b9b4731d377864f4e13821af7cd3329}{SNMP\_MSG\_FLAG\_AUTH} | \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a09a0d3b1da3227488bf9ccc2cc8a48e2}{SNMP\_MSG\_FLAG\_PRIV});
150 
151    \textcolor{comment}{//Security model used by the sender}
152    context->response.msgSecurityModel = context->request.msgSecurityModel;
153 
154    \textcolor{comment}{//Authoritative engine identifier}
155    context->response.msgAuthEngineId = context->contextEngine;
156    context->response.msgAuthEngineIdLen = context->contextEngineLen;
157 
158    \textcolor{comment}{//Number of times the SNMP engine has rebooted}
159    context->response.msgAuthEngineBoots = context->engineBoots;
160    \textcolor{comment}{//Number of seconds since last reboot}
161    context->response.msgAuthEngineTime = context->engineTime;
162 
163    \textcolor{comment}{//User name}
164    context->response.msgUserName = context->request.msgUserName;
165    context->response.msgUserNameLen = context->request.msgUserNameLen;
166 
167    \textcolor{comment}{//Authentication parameters}
168    context->response.msgAuthParameters = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
169    context->response.msgAuthParametersLen = context->request.msgAuthParametersLen;
170 
171    \textcolor{comment}{//Privacy parameters}
172    context->response.msgPrivParameters = context->privParameters;
173    context->response.msgPrivParametersLen = context->request.msgPrivParametersLen;
174 
175    \textcolor{comment}{//Context engine identifier}
176    context->response.contextEngineId = context->contextEngine;
177    context->response.contextEngineIdLen = context->contextEngineLen;
178 
179    \textcolor{comment}{//Context name}
180    context->response.contextName = context->request.contextName;
181    context->response.contextNameLen = context->request.contextNameLen;
182 \textcolor{preprocessor}{#endif}
183 
184    \textcolor{comment}{//PDU type}
185    context->response.pduType = \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa3e99f6cb071a2b5a8e8b840ec30e8de2}{SNMP\_PDU\_GET\_RESPONSE};
186    \textcolor{comment}{//Request identifier}
187    context->response.requestId = context->request.requestId;
188 
189    \textcolor{comment}{//Make room for the message header at the beginning of the buffer}
190    error = \hyperlink{snmp__agent__message_8c_a804b9d2437d32dbc6c85f1b7769e727d}{snmpComputeMessageOverhead}(&context->response);
191    \textcolor{comment}{//Return status code}
192    \textcolor{keywordflow}{return} error;
193 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a16a9e30e049c906b864fbd7107c823ca}\label{snmp__agent__message_8h_a16a9e30e049c906b864fbd7107c823ca}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Parse\+Community@{snmp\+Parse\+Community}}
\index{snmp\+Parse\+Community@{snmp\+Parse\+Community}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Parse\+Community()}{snmpParseCommunity()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Parse\+Community (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Parse community name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 398 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
399 \{
400 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED || SNMP\_V2C\_SUPPORT == ENABLED)}
401    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
402    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
403 
404    \textcolor{comment}{//Read community name}
405    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, &tag);
406    \textcolor{comment}{//Failed to decode ASN.1 tag?}
407    \textcolor{keywordflow}{if}(error)
408       \textcolor{keywordflow}{return} error;
409 
410    \textcolor{comment}{//Enforce encoding, class and type}
411    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
412    \textcolor{comment}{//The tag does not match the criteria?}
413    \textcolor{keywordflow}{if}(error)
414       \textcolor{keywordflow}{return} error;
415 
416    \textcolor{comment}{//Save community name}
417    message->\hyperlink{structSnmpMessage_ac9976028507798166e3f542d5806c811}{community} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
418    message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
419 
420    \textcolor{comment}{//Advance data pointer}
421    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
422    \textcolor{comment}{//Remaining bytes to process}
423    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
424 
425    \textcolor{comment}{//No error to report}
426    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
427 #\textcolor{keywordflow}{else}
428    \textcolor{comment}{//Not implemented}
429    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
430 #endif
431 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a9df2434771d530036f055dd55001463f}\label{snmp__agent__message_8h_a9df2434771d530036f055dd55001463f}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Parse\+Global\+Data@{snmp\+Parse\+Global\+Data}}
\index{snmp\+Parse\+Global\+Data@{snmp\+Parse\+Global\+Data}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Parse\+Global\+Data()}{snmpParseGlobalData()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Parse\+Global\+Data (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Parse msg\+Global\+Data field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 480 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
481 \{
482 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
483    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
484    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
485    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
486    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
487 
488    \textcolor{comment}{//Read the msgGlobalData field}
489    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, &tag);
490    \textcolor{comment}{//Failed to decode ASN.1 tag?}
491    \textcolor{keywordflow}{if}(error)
492       \textcolor{keywordflow}{return} error;
493 
494    \textcolor{comment}{//Advance pointer over the msgGlobalData field}
495    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
496    \textcolor{comment}{//Remaining bytes to process}
497    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
498 
499    \textcolor{comment}{//Point to the first field of the sequence}
500    p = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
501    length = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
502 
503    \textcolor{comment}{//The msgID is used between two SNMP entities to coordinate request}
504    \textcolor{comment}{//messages and responses}
505    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId});
506    \textcolor{comment}{//Failed to decode ASN.1 tag?}
507    \textcolor{keywordflow}{if}(error)
508       \textcolor{keywordflow}{return} error;
509 
510    \textcolor{comment}{//Make sure the value is in the range 0..2147483647}
511    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId} < 0)
512       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca502c4621b59b0b51a9f8337d6a902c9c}{ERROR\_WRONG\_ENCODING};
513 
514    \textcolor{comment}{//Point to the next field}
515    p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
516    length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
517 
518    \textcolor{comment}{//The msgMaxSize field of the message conveys the maximum message size}
519    \textcolor{comment}{//supported by the sender of the message}
520    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_a078984d1faa7cb4eb2e7978261c8cba6}{msgMaxSize});
521    \textcolor{comment}{//Failed to decode ASN.1 tag?}
522    \textcolor{keywordflow}{if}(error)
523       \textcolor{keywordflow}{return} error;
524 
525    \textcolor{comment}{//Make sure the value is in the range 484..2147483647}
526    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a078984d1faa7cb4eb2e7978261c8cba6}{msgMaxSize} < 484)
527       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca502c4621b59b0b51a9f8337d6a902c9c}{ERROR\_WRONG\_ENCODING};
528 
529    \textcolor{comment}{//Point to the next field}
530    p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
531    length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
532 
533    \textcolor{comment}{//The msgFlags field of the message contains several bit fields which}
534    \textcolor{comment}{//control processing of the message}
535    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
536    \textcolor{comment}{//Failed to decode ASN.1 tag?}
537    \textcolor{keywordflow}{if}(error)
538       \textcolor{keywordflow}{return} error;
539 
540    \textcolor{comment}{//Enforce encoding, class and type}
541    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
542    \textcolor{comment}{//The tag does not match the criteria?}
543    \textcolor{keywordflow}{if}(error)
544       \textcolor{keywordflow}{return} error;
545 
546    \textcolor{comment}{//The msgFlags field consists of a single byte}
547    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}))
548       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca502c4621b59b0b51a9f8337d6a902c9c}{ERROR\_WRONG\_ENCODING};
549 
550    \textcolor{comment}{//Save the bit field}
551    message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0];
552 
553    \textcolor{comment}{//If the authFlag is not set and privFlag is set, then the snmpInvalidMsgs}
554    \textcolor{comment}{//counter is incremented and the message is silently discarded}
555    \textcolor{keywordflow}{if}(!(message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a8b9b4731d377864f4e13821af7cd3329}{SNMP\_MSG\_FLAG\_AUTH}) &&
556       (message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a09a0d3b1da3227488bf9ccc2cc8a48e2}{SNMP\_MSG\_FLAG\_PRIV}))
557    \{
558       \textcolor{comment}{//Total number of packets received by the SNMP engine which were dropped}
559       \textcolor{comment}{//because there were invalid or inconsistent components in the message}
560       \hyperlink{snmp__mpd__mib__module_8h_a2d19dbc90fa3c77e8c43f9c7d8923c55}{SNMP\_MPD\_MIB\_INC\_COUNTER32}(snmpInvalidMsgs, 1);
561 
562       \textcolor{comment}{//The message is discarded without further processing}
563       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
564    \}
565 
566    \textcolor{comment}{//Point to the next field}
567    p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
568    length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
569 
570    \textcolor{comment}{//The msgSecurityModel field identifies which security model was used}
571    \textcolor{comment}{//by the sender to generate the message}
572    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->
      \hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel});
573    \textcolor{comment}{//Failed to decode ASN.1 tag?}
574    \textcolor{keywordflow}{if}(error)
575       \textcolor{keywordflow}{return} error;
576 
577    \textcolor{comment}{//Make sure the value is in the range 1..2147483647}
578    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel} < 1)
579       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca502c4621b59b0b51a9f8337d6a902c9c}{ERROR\_WRONG\_ENCODING};
580 
581    \textcolor{comment}{//Successful processing}
582    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
583 \textcolor{preprocessor}{#else}
584    \textcolor{comment}{//Not implemented}
585    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
586 \textcolor{preprocessor}{#endif}
587 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a0e9ed71e6fdefac5c1cf9b68ce5bebb2}\label{snmp__agent__message_8h_a0e9ed71e6fdefac5c1cf9b68ce5bebb2}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Parse\+Message\+Header@{snmp\+Parse\+Message\+Header}}
\index{snmp\+Parse\+Message\+Header@{snmp\+Parse\+Message\+Header}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Parse\+Message\+Header()}{snmpParseMessageHeader()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Parse\+Message\+Header (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Parse S\+N\+MP message header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 267 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
268 \{
269    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
270    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
271    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
272    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
273 
274    \textcolor{comment}{//Point to the first byte of the SNMP message}
275    p = message->\hyperlink{structSnmpMessage_a60405510f10de109ac78bf7ae8427f24}{buffer};
276    \textcolor{comment}{//Retrieve the length of the SNMP message}
277    length = message->\hyperlink{structSnmpMessage_a02cd31ab221cd718f39cf8621f98c0b6}{bufferLen};
278 
279    \textcolor{comment}{//The SNMP message is encapsulated within a sequence}
280    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(p, length, &tag);
281    \textcolor{comment}{//Failed to decode ASN.1 tag?}
282    \textcolor{keywordflow}{if}(error)
283       \textcolor{keywordflow}{return} error;
284 
285    \textcolor{comment}{//Point to the first field of the sequence}
286    p = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
287    length = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
288 
289    \textcolor{comment}{//Read version identifier}
290    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version});
291    \textcolor{comment}{//Failed to decode ASN.1 tag?}
292    \textcolor{keywordflow}{if}(error)
293       \textcolor{keywordflow}{return} error;
294 
295    \textcolor{comment}{//Make sure the SNMP version identifier is valid}
296    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} != \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa3dfaf92130ae745ea9945787a64458a7}{SNMP\_VERSION\_1} &&
297       message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} != \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfaa35575472195d72a958b8482d425c2b5}{SNMP\_VERSION\_2C} &&
298       message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} != \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
299    \{
300       \textcolor{comment}{//The SNMP version is not acceptable}
301       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
302    \}
303 
304    \textcolor{comment}{//Advance data pointer}
305    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) p + tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
306    \textcolor{comment}{//Remaining bytes to process}
307    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} = length - tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
308 
309    \textcolor{comment}{//Successful processing}
310    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
311 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_ad9655d8d1cbaed7edb34ee76a2987cae}\label{snmp__agent__message_8h_ad9655d8d1cbaed7edb34ee76a2987cae}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Parse\+Pdu\+Header@{snmp\+Parse\+Pdu\+Header}}
\index{snmp\+Parse\+Pdu\+Header@{snmp\+Parse\+Pdu\+Header}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Parse\+Pdu\+Header()}{snmpParsePduHeader()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Parse\+Pdu\+Header (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Parse P\+DU header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1204 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1205 \{
1206    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1207    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1208    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1209    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1210 
1211    \textcolor{comment}{//The PDU is encapsulated within a sequence}
1212    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, &tag);
1213    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1214    \textcolor{keywordflow}{if}(error)
1215       \textcolor{keywordflow}{return} error;
1216 
1217    \textcolor{comment}{//Check encoding}
1218    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} != \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE})
1219       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca502c4621b59b0b51a9f8337d6a902c9c}{ERROR\_WRONG\_ENCODING};
1220    \textcolor{comment}{//Enforce class}
1221    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
1222       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
1223 
1224    \textcolor{comment}{//Save PDU type}
1225    message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} = (\hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299a}{SnmpPduType}) tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType};
1226 
1227    \textcolor{comment}{//Point to the first field}
1228    p = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1229    \textcolor{comment}{//Remaining bytes to process}
1230    length = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1231 
1232    \textcolor{comment}{//Read request-id field}
1233    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId});
1234    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1235    \textcolor{keywordflow}{if}(error)
1236       \textcolor{keywordflow}{return} error;
1237 
1238    \textcolor{comment}{//Point to the next field}
1239    p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1240    length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1241 
1242 \textcolor{preprocessor}{#if (SNMP\_V2C\_SUPPORT == ENABLED || SNMP\_V3\_SUPPORT == ENABLED)}
1243    \textcolor{comment}{//GetBulkRequest-PDU?}
1244    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aae1b25cf12cf1954685f1f7e8d36670ed}{SNMP\_PDU\_GET\_BULK\_REQUEST})
1245    \{
1246       \textcolor{comment}{//Read non-repeaters field}
1247       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_a636216d602b0d25cd83d25b42f828105}{nonRepeaters});
1248       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1249       \textcolor{keywordflow}{if}(error)
1250          \textcolor{keywordflow}{return} error;
1251 
1252       \textcolor{comment}{//If the value in the non-repeaters field is less than zero, then the}
1253       \textcolor{comment}{//value of the field is set to zero}
1254       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a636216d602b0d25cd83d25b42f828105}{nonRepeaters} < 0)
1255          message->\hyperlink{structSnmpMessage_a636216d602b0d25cd83d25b42f828105}{nonRepeaters} = 0;
1256 
1257       \textcolor{comment}{//Point to the next field}
1258       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1259       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1260 
1261       \textcolor{comment}{//Read max-repetitions field}
1262       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->
      \hyperlink{structSnmpMessage_afa0f8f0e8eb0a126a401704cef25d3d3}{maxRepetitions});
1263       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1264       \textcolor{keywordflow}{if}(error)
1265          \textcolor{keywordflow}{return} error;
1266 
1267       \textcolor{comment}{//If the value in the max-repetitions field is less than zero, then the}
1268       \textcolor{comment}{//value of the field is set to zero}
1269       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_afa0f8f0e8eb0a126a401704cef25d3d3}{maxRepetitions} < 0)
1270          message->\hyperlink{structSnmpMessage_afa0f8f0e8eb0a126a401704cef25d3d3}{maxRepetitions} = 0;
1271    \}
1272    \textcolor{keywordflow}{else}
1273 \textcolor{preprocessor}{#endif}
1274    \{
1275       \textcolor{comment}{//Read error-status field}
1276       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_afb6f5e5cf7da54678aff6c79dd5948ce}{errorStatus});
1277       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1278       \textcolor{keywordflow}{if}(error)
1279          \textcolor{keywordflow}{return} error;
1280 
1281       \textcolor{comment}{//Point to the next field}
1282       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1283       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1284 
1285       \textcolor{comment}{//Read error-index field}
1286       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag, &message->\hyperlink{structSnmpMessage_a6be5f10373d70dd0972a43a24299a8f7}{errorIndex});
1287       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1288       \textcolor{keywordflow}{if}(error)
1289          \textcolor{keywordflow}{return} error;
1290    \}
1291 
1292    \textcolor{comment}{//Point to the next field}
1293    p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1294    length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1295 
1296    \textcolor{comment}{//The variable bindings are encapsulated within a sequence}
1297    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(p, length, &tag);
1298    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1299    \textcolor{keywordflow}{if}(error)
1300       \textcolor{keywordflow}{return} error;
1301 
1302    \textcolor{comment}{//Save the location of the variable binding list}
1303    message->\hyperlink{structSnmpMessage_a8c51e21ca5943c3dceaa76b267539bfb}{varBindList} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1304    message->\hyperlink{structSnmpMessage_a877d26bc0ae8ef5c78ac645a2ba112ea}{varBindListLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1305 
1306    \textcolor{comment}{//Successful processing}
1307    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1308 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_ab071abb69f6040b7bac407d27551724b}\label{snmp__agent__message_8h_ab071abb69f6040b7bac407d27551724b}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Parse\+Scoped\+Pdu@{snmp\+Parse\+Scoped\+Pdu}}
\index{snmp\+Parse\+Scoped\+Pdu@{snmp\+Parse\+Scoped\+Pdu}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Parse\+Scoped\+Pdu()}{snmpParseScopedPdu()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Parse\+Scoped\+Pdu (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Parse scoped\+P\+DU field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1047 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1048 \{
1049 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
1050    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1051    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1052    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1053    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1054 
1055    \textcolor{comment}{//Read the scopedPDU field}
1056    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, &tag);
1057    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1058    \textcolor{keywordflow}{if}(error)
1059       \textcolor{keywordflow}{return} error;
1060 
1061    \textcolor{comment}{//Point to the first field of the sequence}
1062    p = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1063    length = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1064 
1065    \textcolor{comment}{//Read contextEngineID field}
1066    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
1067    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1068    \textcolor{keywordflow}{if}(error)
1069       \textcolor{keywordflow}{return} error;
1070 
1071    \textcolor{comment}{//Enforce encoding, class and type}
1072    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
1073    \textcolor{comment}{//The tag does not match the criteria?}
1074    \textcolor{keywordflow}{if}(error)
1075       \textcolor{keywordflow}{return} error;
1076 
1077    \textcolor{comment}{//Save context engine identifier}
1078    message->\hyperlink{structSnmpMessage_a737a67e1857fb23d90d149cfb0d21e1c}{contextEngineId} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1079    message->\hyperlink{structSnmpMessage_ad933640b1912b549e6f1a9280a5ce7b7}{contextEngineIdLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1080 
1081    \textcolor{comment}{//Point to the next field}
1082    p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1083    length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1084 
1085    \textcolor{comment}{//Read contextName field}
1086    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
1087    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1088    \textcolor{keywordflow}{if}(error)
1089       \textcolor{keywordflow}{return} error;
1090 
1091    \textcolor{comment}{//Enforce encoding, class and type}
1092    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
1093    \textcolor{comment}{//The tag does not match the criteria?}
1094    \textcolor{keywordflow}{if}(error)
1095       \textcolor{keywordflow}{return} error;
1096 
1097    \textcolor{comment}{//Save context name}
1098    message->\hyperlink{structSnmpMessage_ab7b3dc54e8e1538249e1e0e08123f0f9}{contextName} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1099    message->\hyperlink{structSnmpMessage_a64d47bc4ef9cdfaae0494c8b224b26cb}{contextNameLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1100 
1101    \textcolor{comment}{//Point to the first byte of the PDU}
1102    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) p + tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1103    \textcolor{comment}{//Length of the PDU}
1104    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} = length - tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1105 
1106    \textcolor{comment}{//Return status code}
1107    \textcolor{keywordflow}{return} error;
1108 \textcolor{preprocessor}{#else}
1109    \textcolor{comment}{//Not implemented}
1110    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1111 \textcolor{preprocessor}{#endif}
1112 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a1fc1b78ad11740dda041262c137e54f7}\label{snmp__agent__message_8h_a1fc1b78ad11740dda041262c137e54f7}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Parse\+Security\+Parameters@{snmp\+Parse\+Security\+Parameters}}
\index{snmp\+Parse\+Security\+Parameters@{snmp\+Parse\+Security\+Parameters}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Parse\+Security\+Parameters()}{snmpParseSecurityParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Parse\+Security\+Parameters (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Parse msg\+Security\+Parameters field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 694 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
695 \{
696 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
697    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
698    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
699    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
700    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
701 
702    \textcolor{comment}{//Read the msgSecurityParameters field}
703    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, &tag);
704    \textcolor{comment}{//Failed to decode ASN.1 tag?}
705    \textcolor{keywordflow}{if}(error)
706       \textcolor{keywordflow}{return} error;
707 
708    \textcolor{comment}{//Enforce encoding, class and type}
709    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
710    \textcolor{comment}{//The tag does not match the criteria?}
711    \textcolor{keywordflow}{if}(error)
712       \textcolor{keywordflow}{return} error;
713 
714    \textcolor{comment}{//Advance pointer over the msgSecurityParameters field}
715    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
716    \textcolor{comment}{//Remaining bytes to process}
717    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
718 
719    \textcolor{comment}{//Point to the very first field of the sequence}
720    p = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
721    length = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
722 
723    \textcolor{comment}{//User-based security model?}
724    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel} == \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a21c6309103699e29211c87fd78c79521}{SNMP\_SECURITY\_MODEL\_USM})
725    \{
726       \textcolor{comment}{//The USM security parameters are encapsulated within a sequence}
727       error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(p, length, &tag);
728       \textcolor{comment}{//Failed to decode ASN.1 tag?}
729       \textcolor{keywordflow}{if}(error)
730          \textcolor{keywordflow}{return} error;
731 
732       \textcolor{comment}{//Point to the first field of the sequence}
733       p = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
734       length = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
735 
736       \textcolor{comment}{//Read the msgAuthoritativeEngineID field}
737       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
738       \textcolor{comment}{//Failed to decode ASN.1 tag?}
739       \textcolor{keywordflow}{if}(error)
740          \textcolor{keywordflow}{return} error;
741 
742       \textcolor{comment}{//Enforce encoding, class and type}
743       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
744       \textcolor{comment}{//The tag does not match the criteria?}
745       \textcolor{keywordflow}{if}(error)
746          \textcolor{keywordflow}{return} error;
747 
748       \textcolor{comment}{//Save authoritative engine identifier}
749       message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
750       message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
751 
752       \textcolor{comment}{//Point to the next field}
753       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
754       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
755 
756       \textcolor{comment}{//Read the msgAuthoritativeEngineBoots field}
757       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag,
758          &message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots});
759       \textcolor{comment}{//Failed to decode ASN.1 tag?}
760       \textcolor{keywordflow}{if}(error)
761          \textcolor{keywordflow}{return} error;
762 
763       \textcolor{comment}{//Point to the next field}
764       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
765       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
766 
767       \textcolor{comment}{//Read the msgAuthoritativeEngineTime field}
768       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(p, length, &tag,
769          &message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime});
770       \textcolor{comment}{//Failed to decode ASN.1 tag?}
771       \textcolor{keywordflow}{if}(error)
772          \textcolor{keywordflow}{return} error;
773 
774       \textcolor{comment}{//Point to the next field}
775       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
776       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
777 
778       \textcolor{comment}{//Read the msgUserName field}
779       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
780       \textcolor{comment}{//Failed to decode ASN.1 tag?}
781       \textcolor{keywordflow}{if}(error)
782          \textcolor{keywordflow}{return} error;
783 
784       \textcolor{comment}{//Enforce encoding, class and type}
785       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
786       \textcolor{comment}{//The tag does not match the criteria?}
787       \textcolor{keywordflow}{if}(error)
788          \textcolor{keywordflow}{return} error;
789 
790       \textcolor{comment}{//Check the length of the user name}
791       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} > 32)
792          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca502c4621b59b0b51a9f8337d6a902c9c}{ERROR\_WRONG\_ENCODING};
793 
794       \textcolor{comment}{//Save user name}
795       message->\hyperlink{structSnmpMessage_a83e0d7035f301d07352eb2d3b6b1679a}{msgUserName} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
796       message->\hyperlink{structSnmpMessage_ac9a168d33bda6c99336def2b01440b3b}{msgUserNameLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
797 
798       \textcolor{comment}{//Point to the next field}
799       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
800       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
801 
802       \textcolor{comment}{//Read the msgAuthenticationParameters field}
803       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
804       \textcolor{comment}{//Failed to decode ASN.1 tag?}
805       \textcolor{keywordflow}{if}(error)
806          \textcolor{keywordflow}{return} error;
807 
808       \textcolor{comment}{//Enforce encoding, class and type}
809       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
810       \textcolor{comment}{//The tag does not match the criteria?}
811       \textcolor{keywordflow}{if}(error)
812          \textcolor{keywordflow}{return} error;
813 
814       \textcolor{comment}{//Save authentication parameters}
815       message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
816       message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
817 
818       \textcolor{comment}{//Point to the next field}
819       p += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
820       length -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
821 
822       \textcolor{comment}{//Read the msgPrivacyParameters field}
823       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(p, length, &tag);
824       \textcolor{comment}{//Failed to decode ASN.1 tag?}
825       \textcolor{keywordflow}{if}(error)
826          \textcolor{keywordflow}{return} error;
827 
828       \textcolor{comment}{//Enforce encoding, class and type}
829       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
830       \textcolor{comment}{//The tag does not match the criteria?}
831       \textcolor{keywordflow}{if}(error)
832          \textcolor{keywordflow}{return} error;
833 
834       \textcolor{comment}{//Save privacy parameters}
835       message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
836       message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
837    \}
838    \textcolor{keywordflow}{else}
839    \{
840       \textcolor{comment}{//Total number of packets received by the SNMP engine which were dropped}
841       \textcolor{comment}{//because they referenced a securityModel that was not known to or}
842       \textcolor{comment}{//supported by the SNMP engine}
843       \hyperlink{snmp__mpd__mib__module_8h_a2d19dbc90fa3c77e8c43f9c7d8923c55}{SNMP\_MPD\_MIB\_INC\_COUNTER32}(snmpUnknownSecurityModels, 1);
844 
845       \textcolor{comment}{//The message is discarded without further processing}
846       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
847    \}
848 
849    \textcolor{comment}{//Successful processing}
850    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
851 \textcolor{preprocessor}{#else}
852    \textcolor{comment}{//Not implemented}
853    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
854 \textcolor{preprocessor}{#endif}
855 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a454fe2bf97385fe807528d12f971d278}\label{snmp__agent__message_8h_a454fe2bf97385fe807528d12f971d278}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Write\+Community@{snmp\+Write\+Community}}
\index{snmp\+Write\+Community@{snmp\+Write\+Community}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Write\+Community()}{snmpWriteCommunity()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Write\+Community (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Format community name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 440 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
441 \{
442 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED || SNMP\_V2C\_SUPPORT == ENABLED)}
443    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
444    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
445    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
446 
447    \textcolor{comment}{//The community name is an octet string}
448    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
449    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
450    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
451    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen};
452    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) message->\hyperlink{structSnmpMessage_ac9976028507798166e3f542d5806c811}{community};
453 
454    \textcolor{comment}{//Write the corresponding ASN.1 tag}
455    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, &n);
456    \textcolor{comment}{//Any error to report?}
457    \textcolor{keywordflow}{if}(error)
458       \textcolor{keywordflow}{return} error;
459 
460    \textcolor{comment}{//Point to the first byte of the community name}
461    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
462    \textcolor{comment}{//Total length of the message}
463    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
464 
465    \textcolor{comment}{//Successful processing}
466    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
467 \textcolor{preprocessor}{#else}
468    \textcolor{comment}{//Not implemented}
469    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
470 \textcolor{preprocessor}{#endif}
471 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a4ce450369f078f72b6ce399a35660fe1}\label{snmp__agent__message_8h_a4ce450369f078f72b6ce399a35660fe1}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Write\+Global\+Data@{snmp\+Write\+Global\+Data}}
\index{snmp\+Write\+Global\+Data@{snmp\+Write\+Global\+Data}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Write\+Global\+Data()}{snmpWriteGlobalData()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Write\+Global\+Data (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Format msg\+Global\+Data field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 596 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
597 \{
598 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
599    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
600    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
601    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
602    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
603    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
604 
605    \textcolor{comment}{//The msgGlobalData field is encoded in reverse order}
606    p = message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos};
607    \textcolor{comment}{//Length of the msgGlobalData field}
608    length = 0;
609 
610    \textcolor{comment}{//Write msgSecurityModel field}
611    error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
612    \textcolor{comment}{//Any error to report?}
613    \textcolor{keywordflow}{if}(error)
614       \textcolor{keywordflow}{return} error;
615 
616    \textcolor{comment}{//Move backward}
617    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
618    \textcolor{comment}{//Update the length of the msgGlobalData field}
619    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
620 
621    \textcolor{comment}{//The msgFlags field consists of a single byte}
622    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
623    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
624    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
625    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
626    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = &message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags};
627 
628    \textcolor{comment}{//Write the corresponding ASN.1 tag}
629    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
630    \textcolor{comment}{//Any error to report?}
631    \textcolor{keywordflow}{if}(error)
632       \textcolor{keywordflow}{return} error;
633 
634    \textcolor{comment}{//Move backward}
635    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
636    \textcolor{comment}{//Update the length of the msgGlobalData field}
637    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
638 
639    \textcolor{comment}{//Write msgMaxSize field}
640    error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_a078984d1faa7cb4eb2e7978261c8cba6}{msgMaxSize}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
641    \textcolor{comment}{//Any error to report?}
642    \textcolor{keywordflow}{if}(error)
643       \textcolor{keywordflow}{return} error;
644 
645    \textcolor{comment}{//Move backward}
646    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
647    \textcolor{comment}{//Update the length of the msgGlobalData field}
648    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
649 
650    \textcolor{comment}{//Write msgID field}
651    error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
652    \textcolor{comment}{//Any error to report?}
653    \textcolor{keywordflow}{if}(error)
654       \textcolor{keywordflow}{return} error;
655 
656    \textcolor{comment}{//Move backward}
657    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
658    \textcolor{comment}{//Update the length of the msgGlobalData field}
659    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
660 
661    \textcolor{comment}{//The parameters are encapsulated within a sequence}
662    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
663    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
664    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE};
665    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
666    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
667 
668    \textcolor{comment}{//Write the corresponding ASN.1 tag}
669    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
670    \textcolor{comment}{//Any error to report?}
671    \textcolor{keywordflow}{if}(error)
672       \textcolor{keywordflow}{return} error;
673 
674    \textcolor{comment}{//Point to the first byte of the msgGlobalData field}
675    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = p - \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
676    \textcolor{comment}{//Total length of the message}
677    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += length + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
678 
679    \textcolor{comment}{//Successful processing}
680    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
681 \textcolor{preprocessor}{#else}
682    \textcolor{comment}{//Not implemented}
683    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
684 \textcolor{preprocessor}{#endif}
685 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_add8b6631f98a66746371b33fabf28c91}\label{snmp__agent__message_8h_add8b6631f98a66746371b33fabf28c91}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Write\+Message\+Header@{snmp\+Write\+Message\+Header}}
\index{snmp\+Write\+Message\+Header@{snmp\+Write\+Message\+Header}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Write\+Message\+Header()}{snmpWriteMessageHeader()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Write\+Message\+Header (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Format S\+N\+MP message header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 320 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
321 \{
322    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
323    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
324    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
325 
326    \textcolor{comment}{//SNMPv1 or SNMPv2c version?}
327    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa3dfaf92130ae745ea9945787a64458a7}{SNMP\_VERSION\_1} ||
328       message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfaa35575472195d72a958b8482d425c2b5}{SNMP\_VERSION\_2C})
329    \{
330       \textcolor{comment}{//Write the community name}
331       error = \hyperlink{snmp__agent__message_8c_a454fe2bf97385fe807528d12f971d278}{snmpWriteCommunity}(message);
332       \textcolor{comment}{//Any error to report?}
333       \textcolor{keywordflow}{if}(error)
334          \textcolor{keywordflow}{return} error;
335    \}
336    \textcolor{comment}{//SNMPv3 version?}
337    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
338    \{
339       \textcolor{comment}{//Write msgSecurityParameters field}
340       error = \hyperlink{snmp__agent__message_8c_a16d70e9258620be2f2e4c1afff2a9ec6}{snmpWriteSecurityParameters}(message);
341       \textcolor{comment}{//Any error to report?}
342       \textcolor{keywordflow}{if}(error)
343          \textcolor{keywordflow}{return} error;
344 
345       \textcolor{comment}{//Write msgGlobalData field}
346       error = \hyperlink{snmp__agent__message_8c_a4ce450369f078f72b6ce399a35660fe1}{snmpWriteGlobalData}(message);
347       \textcolor{comment}{//Any error to report?}
348       \textcolor{keywordflow}{if}(error)
349          \textcolor{keywordflow}{return} error;
350    \}
351    \textcolor{comment}{//Invalid version?}
352    \textcolor{keywordflow}{else}
353    \{
354       \textcolor{comment}{//Report an error}
355       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
356    \}
357 
358    \textcolor{comment}{//Write version identifier}
359    error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, message->
      \hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, &n);
360    \textcolor{comment}{//Any error to report?}
361    \textcolor{keywordflow}{if}(error)
362       \textcolor{keywordflow}{return} error;
363 
364    \textcolor{comment}{//Move backward}
365    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
366    \textcolor{comment}{//Update the length of the message}
367    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
368 
369    \textcolor{comment}{//The SNMP message is encapsulated within a sequence}
370    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
371    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
372    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE};
373    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length};
374    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
375 
376    \textcolor{comment}{//Write the corresponding ASN.1 tag}
377    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, &n);
378    \textcolor{comment}{//Any error to report?}
379    \textcolor{keywordflow}{if}(error)
380       \textcolor{keywordflow}{return} error;
381 
382    \textcolor{comment}{//Move backward}
383    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
384    \textcolor{comment}{//Total length of the SNMP message}
385    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
386 
387    \textcolor{comment}{//Successful processing}
388    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
389 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a8b5e6d1e43fef67326204bf6999d9b18}\label{snmp__agent__message_8h_a8b5e6d1e43fef67326204bf6999d9b18}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Write\+Pdu\+Header@{snmp\+Write\+Pdu\+Header}}
\index{snmp\+Write\+Pdu\+Header@{snmp\+Write\+Pdu\+Header}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Write\+Pdu\+Header()}{snmpWritePduHeader()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Write\+Pdu\+Header (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Format P\+DU header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1317 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1318 \{
1319    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1320    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1321    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1322    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1323    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1324 
1325    \textcolor{comment}{//The PDU header will be encoded in reverse order...}
1326    p = message->\hyperlink{structSnmpMessage_a8c51e21ca5943c3dceaa76b267539bfb}{varBindList};
1327    \textcolor{comment}{//Length of the PDU}
1328    length = message->\hyperlink{structSnmpMessage_a877d26bc0ae8ef5c78ac645a2ba112ea}{varBindListLen};
1329 
1330    \textcolor{comment}{//The variable bindings are encapsulated within a sequence}
1331    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1332    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
1333    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE};
1334    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1335    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1336 
1337    \textcolor{comment}{//Write the corresponding ASN.1 tag}
1338    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1339    \textcolor{comment}{//Any error to report?}
1340    \textcolor{keywordflow}{if}(error)
1341       \textcolor{keywordflow}{return} error;
1342 
1343    \textcolor{comment}{//Move backward}
1344    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1345    \textcolor{comment}{//Update the length of the PDU}
1346    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1347 
1348    \textcolor{comment}{//GetRequest-PDU, GetResponse-PDU, InformRequest-PDU, SNMPv2-Trap-PDU}
1349    \textcolor{comment}{//or Report-PDU?}
1350    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa2c6d80868e156130b005e1d303f1672a}{SNMP\_PDU\_GET\_REQUEST} ||
1351       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa3e99f6cb071a2b5a8e8b840ec30e8de2}{SNMP\_PDU\_GET\_RESPONSE} ||
1352       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa4060cecdb63948db5da6be30b623244b}{SNMP\_PDU\_INFORM\_REQUEST} ||
1353       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa194e27ffa1ad6456408b07aff153d6ff}{SNMP\_PDU\_TRAP\_V2} ||
1354       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aaae8744a84989fc7505be8d6a41914943}{SNMP\_PDU\_REPORT})
1355    \{
1356       \textcolor{comment}{//Write error index}
1357       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_a6be5f10373d70dd0972a43a24299a8f7}{errorIndex}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1358       \textcolor{comment}{//Any error to report?}
1359       \textcolor{keywordflow}{if}(error)
1360          \textcolor{keywordflow}{return} error;
1361 
1362       \textcolor{comment}{//Move backward}
1363       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1364       \textcolor{comment}{//Update the length of the PDU}
1365       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1366 
1367       \textcolor{comment}{//Write error status}
1368       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_afb6f5e5cf7da54678aff6c79dd5948ce}{errorStatus}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1369       \textcolor{comment}{//Any error to report?}
1370       \textcolor{keywordflow}{if}(error)
1371          \textcolor{keywordflow}{return} error;
1372 
1373       \textcolor{comment}{//Move backward}
1374       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1375       \textcolor{comment}{//Update the length of the PDU}
1376       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1377 
1378       \textcolor{comment}{//Write request identifier}
1379       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1380       \textcolor{comment}{//Any error to report?}
1381       \textcolor{keywordflow}{if}(error)
1382          \textcolor{keywordflow}{return} error;
1383 
1384       \textcolor{comment}{//Move backward}
1385       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1386       \textcolor{comment}{//Update the length of the PDU}
1387       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1388    \}
1389 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED)}
1390    \textcolor{comment}{//Trap-PDU?}
1391    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa51084b3eb61f91ceedeb5e426c15ffe0}{SNMP\_PDU\_TRAP})
1392    \{
1393       \textcolor{comment}{//Encode the object value using ASN.1 rules}
1394       error = \hyperlink{snmp__agent__message_8c_aac8a5ef4f5de9b431d0f768ab0973d8d}{snmpEncodeUnsignedInt32}(message->\hyperlink{structSnmpMessage_afbc78f992a1722fce0dbeb050600d070}{timestamp}, message->
      \hyperlink{structSnmpMessage_a60405510f10de109ac78bf7ae8427f24}{buffer}, &n);
1395       \textcolor{comment}{//Any error to report?}
1396       \textcolor{keywordflow}{if}(error)
1397          \textcolor{keywordflow}{return} error;
1398 
1399       \textcolor{comment}{//The time stamp is encoded in ASN.1 format}
1400       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1401       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_a3e5b654afb75017df541bd2ce5dbf9cc}{ASN1\_CLASS\_APPLICATION};
1402       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{mib__common_8h_a990c41dc57823de6a945221194bdefffa13fd57cc818acf51f5eabb5d0ad6c484}{MIB\_TYPE\_TIME\_TICKS};
1403       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1404       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = message->\hyperlink{structSnmpMessage_a60405510f10de109ac78bf7ae8427f24}{buffer};
1405 
1406       \textcolor{comment}{//Write the corresponding ASN.1 tag}
1407       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1408       \textcolor{comment}{//Any error to report?}
1409       \textcolor{keywordflow}{if}(error)
1410          \textcolor{keywordflow}{return} error;
1411 
1412       \textcolor{comment}{//Move backward}
1413       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1414       \textcolor{comment}{//Update the length of the PDU}
1415       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1416 
1417       \textcolor{comment}{//Write specific trap code}
1418       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_aca9391c4afa530ea6d4a12d48b8b424a}{specificTrapCode}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1419       \textcolor{comment}{//Any error to report?}
1420       \textcolor{keywordflow}{if}(error)
1421          \textcolor{keywordflow}{return} error;
1422 
1423       \textcolor{comment}{//Move backward}
1424       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1425       \textcolor{comment}{//Update the length of the PDU}
1426       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1427 
1428       \textcolor{comment}{//Write generic trap type}
1429       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_abef516557dd784fbaffa335e9e63353c}{genericTrapType}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1430       \textcolor{comment}{//Any error to report?}
1431       \textcolor{keywordflow}{if}(error)
1432          \textcolor{keywordflow}{return} error;
1433 
1434       \textcolor{comment}{//Move backward}
1435       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1436       \textcolor{comment}{//Update the length of the PDU}
1437       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1438 
1439       \textcolor{comment}{//The agent address is encoded in ASN.1 format}
1440       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1441       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_a3e5b654afb75017df541bd2ce5dbf9cc}{ASN1\_CLASS\_APPLICATION};
1442       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{mib__common_8h_a990c41dc57823de6a945221194bdefffa86745373c87bb6b6902ab67fd6c63245}{MIB\_TYPE\_IP\_ADDRESS};
1443       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr});
1444       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &message->\hyperlink{structSnmpMessage_a3c51309a93e0740209c2ee75307c0f04}{agentAddr};
1445 
1446       \textcolor{comment}{//Write the corresponding ASN.1 tag}
1447       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1448       \textcolor{comment}{//Any error to report?}
1449       \textcolor{keywordflow}{if}(error)
1450          \textcolor{keywordflow}{return} error;
1451 
1452       \textcolor{comment}{//Move backward}
1453       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1454       \textcolor{comment}{//Update the length of the PDU}
1455       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1456 
1457       \textcolor{comment}{//The enterprise OID is encoded in ASN.1 format}
1458       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1459       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
1460       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa586ebdd8b160ea2185cff78381dfe4b0}{ASN1\_TYPE\_OBJECT\_IDENTIFIER};
1461       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_a70d5dc7f03456b144b0d29a6a30b0a21}{enterpriseOidLen};
1462       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = message->\hyperlink{structSnmpMessage_a807a5b8b2aaf91ba7ad7c5130f7de5fe}{enterpriseOid};
1463 
1464       \textcolor{comment}{//Write the corresponding ASN.1 tag}
1465       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1466       \textcolor{comment}{//Any error to report?}
1467       \textcolor{keywordflow}{if}(error)
1468          \textcolor{keywordflow}{return} error;
1469 
1470       \textcolor{comment}{//Move backward}
1471       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1472       \textcolor{comment}{//Update the length of the PDU}
1473       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1474    \}
1475 \textcolor{preprocessor}{#endif}
1476    \textcolor{comment}{//Unknown PDU type?}
1477    \textcolor{keywordflow}{else}
1478    \{
1479       \textcolor{comment}{//Report an error}
1480       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1481    \}
1482 
1483    \textcolor{comment}{//The PDU is encapsulated within a sequence}
1484    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1485    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC};
1486    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType};
1487    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1488    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1489 
1490    \textcolor{comment}{//Write the corresponding ASN.1 tag}
1491    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1492    \textcolor{comment}{//Any error to report?}
1493    \textcolor{keywordflow}{if}(error)
1494       \textcolor{keywordflow}{return} error;
1495 
1496    \textcolor{comment}{//Point to the first byte of the PDU}
1497    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = p - \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1498    \textcolor{comment}{//Total length of the PDU}
1499    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} = length + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1500 
1501    \textcolor{comment}{//Successful processing}
1502    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1503 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a2d4b4ddfcafc940a9d9987ce8b8e91bc}\label{snmp__agent__message_8h_a2d4b4ddfcafc940a9d9987ce8b8e91bc}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Write\+Scoped\+Pdu@{snmp\+Write\+Scoped\+Pdu}}
\index{snmp\+Write\+Scoped\+Pdu@{snmp\+Write\+Scoped\+Pdu}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Write\+Scoped\+Pdu()}{snmpWriteScopedPdu()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Write\+Scoped\+Pdu (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Format scoped\+P\+DU. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1121 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
1122 \{
1123 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
1124    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1125    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1126    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1127    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1128    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1129 
1130    \textcolor{comment}{//Point to the first byte of the PDU}
1131    p = message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos};
1132    \textcolor{comment}{//Retrieve the length of the PDU}
1133    length = message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length};
1134 
1135    \textcolor{comment}{//The contextName is an octet string}
1136    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1137    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
1138    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
1139    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_a64d47bc4ef9cdfaae0494c8b224b26cb}{contextNameLen};
1140    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) message->\hyperlink{structSnmpMessage_ab7b3dc54e8e1538249e1e0e08123f0f9}{contextName};
1141 
1142    \textcolor{comment}{//Write the corresponding ASN.1 tag}
1143    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1144    \textcolor{comment}{//Any error to report?}
1145    \textcolor{keywordflow}{if}(error)
1146       \textcolor{keywordflow}{return} error;
1147 
1148    \textcolor{comment}{//Move backward}
1149    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1150    \textcolor{comment}{//Update the length of the scopedPduData}
1151    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1152 
1153    \textcolor{comment}{//The contextEngineID is an octet string}
1154    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1155    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
1156    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
1157    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_ad933640b1912b549e6f1a9280a5ce7b7}{contextEngineIdLen};
1158    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = message->\hyperlink{structSnmpMessage_a737a67e1857fb23d90d149cfb0d21e1c}{contextEngineId};
1159 
1160    \textcolor{comment}{//Write the corresponding ASN.1 tag}
1161    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1162    \textcolor{comment}{//Any error to report?}
1163    \textcolor{keywordflow}{if}(error)
1164       \textcolor{keywordflow}{return} error;
1165 
1166    \textcolor{comment}{//Move backward}
1167    p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1168    \textcolor{comment}{//Update the length of the scopedPduData}
1169    length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1170 
1171    \textcolor{comment}{//The scopedPduData is encapsulated within a sequence}
1172    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1173    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
1174    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE};
1175    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1176    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1177 
1178    \textcolor{comment}{//Write the corresponding ASN.1 tag}
1179    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1180    \textcolor{comment}{//Any error to report?}
1181    \textcolor{keywordflow}{if}(error)
1182       \textcolor{keywordflow}{return} error;
1183 
1184    \textcolor{comment}{//Point to the first byte of the scopedPDU}
1185    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = p - \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1186    \textcolor{comment}{//Length of the scopedPDU}
1187    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} = length + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1188 
1189    \textcolor{comment}{//Successful processing}
1190    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1191 \textcolor{preprocessor}{#else}
1192    \textcolor{comment}{//Not implemented}
1193    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1194 \textcolor{preprocessor}{#endif}
1195 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__message_8h_a16d70e9258620be2f2e4c1afff2a9ec6}\label{snmp__agent__message_8h_a16d70e9258620be2f2e4c1afff2a9ec6}} 
\index{snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}!snmp\+Write\+Security\+Parameters@{snmp\+Write\+Security\+Parameters}}
\index{snmp\+Write\+Security\+Parameters@{snmp\+Write\+Security\+Parameters}!snmp\+\_\+agent\+\_\+message.\+h@{snmp\+\_\+agent\+\_\+message.\+h}}
\subsubsection{\texorpdfstring{snmp\+Write\+Security\+Parameters()}{snmpWriteSecurityParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Write\+Security\+Parameters (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Format msg\+Security\+Parameters field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 864 of file snmp\+\_\+agent\+\_\+message.\+c.


\begin{DoxyCode}
865 \{
866 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
867    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
868    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
869    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
870    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
871    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
872 
873    \textcolor{comment}{//The msgSecurityParameters field is encoded in reverse order}
874    p = message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos};
875    \textcolor{comment}{//Length of the msgSecurityParameters field}
876    length = 0;
877 
878    \textcolor{comment}{//User-based security model?}
879    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel} == \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a21c6309103699e29211c87fd78c79521}{SNMP\_SECURITY\_MODEL\_USM})
880    \{
881       \textcolor{comment}{//Encode the msgPrivacyParameters field as an octet string}
882       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
883       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
884       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
885       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen};
886       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters};
887 
888       \textcolor{comment}{//Write the corresponding ASN.1 tag}
889       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
890       \textcolor{comment}{//Any error to report?}
891       \textcolor{keywordflow}{if}(error)
892          \textcolor{keywordflow}{return} error;
893 
894       \textcolor{comment}{//Move backward}
895       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
896       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
897       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
898 
899       \textcolor{comment}{//Authentication required?}
900       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} > 0)
901       \{
902          \textcolor{comment}{//Make room for the message digest}
903          p -= message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen};
904          \textcolor{comment}{//Update the length of the msgSecurityParameters field}
905          length += message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen};
906 
907          \textcolor{comment}{//Clear the message digest}
908          memset(p, 0, message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen});
909       \}
910 
911       \textcolor{comment}{//Save the location of the msgAuthenticationParameters field}
912       message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters} = \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
913 
914       \textcolor{comment}{//Encoded the msgAuthenticationParameters field as an octet string}
915       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
916       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
917       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
918       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen};
919       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
920 
921       \textcolor{comment}{//Write the corresponding ASN.1 tag}
922       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
923       \textcolor{comment}{//Any error to report?}
924       \textcolor{keywordflow}{if}(error)
925          \textcolor{keywordflow}{return} error;
926 
927       \textcolor{comment}{//Move backward}
928       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
929       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
930       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
931 
932       \textcolor{comment}{//Encode the msgUserName field as an octet string}
933       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
934       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
935       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
936       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_ac9a168d33bda6c99336def2b01440b3b}{msgUserNameLen};
937       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) message->\hyperlink{structSnmpMessage_a83e0d7035f301d07352eb2d3b6b1679a}{msgUserName};
938 
939       \textcolor{comment}{//Write the corresponding ASN.1 tag}
940       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
941       \textcolor{comment}{//Any error to report?}
942       \textcolor{keywordflow}{if}(error)
943          \textcolor{keywordflow}{return} error;
944 
945       \textcolor{comment}{//Move backward}
946       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
947       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
948       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
949 
950       \textcolor{comment}{//Write the msgAuthoritativeEngineTime field}
951       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
952       \textcolor{comment}{//Any error to report?}
953       \textcolor{keywordflow}{if}(error)
954          \textcolor{keywordflow}{return} error;
955 
956       \textcolor{comment}{//Move backward}
957       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
958       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
959       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
960 
961       \textcolor{comment}{//Write the msgAuthoritativeEngineBoots field}
962       error = \hyperlink{asn1_8c_a150ad7208a84f75148cee37c949cc9d5}{asn1WriteInt32}(message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
963       \textcolor{comment}{//Any error to report?}
964       \textcolor{keywordflow}{if}(error)
965          \textcolor{keywordflow}{return} error;
966 
967       \textcolor{comment}{//Move backward}
968       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
969       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
970       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
971 
972       \textcolor{comment}{//The msgAuthoritativeEngineID field is an octet string}
973       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
974       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
975       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
976       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen};
977       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId};
978 
979       \textcolor{comment}{//Write the corresponding ASN.1 tag}
980       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
981       \textcolor{comment}{//Any error to report?}
982       \textcolor{keywordflow}{if}(error)
983          \textcolor{keywordflow}{return} error;
984 
985       \textcolor{comment}{//Move backward}
986       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
987       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
988       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
989 
990       \textcolor{comment}{//The USM security parameters are encapsulated within a sequence}
991       tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
992       tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
993       tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE};
994       tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
995       tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
996 
997       \textcolor{comment}{//Write the corresponding ASN.1 tag}
998       error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
999       \textcolor{comment}{//Any error to report?}
1000       \textcolor{keywordflow}{if}(error)
1001          \textcolor{keywordflow}{return} error;
1002 
1003       \textcolor{comment}{//Move backward}
1004       p -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1005       \textcolor{comment}{//Update the length of the msgSecurityParameters field}
1006       length += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1007    \}
1008    \textcolor{keywordflow}{else}
1009    \{
1010       \textcolor{comment}{//The security model is not supported}
1011       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1012    \}
1013 
1014    \textcolor{comment}{//The security parameters are encapsulated within an octet string}
1015    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1016    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
1017    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
1018    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1019    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1020 
1021    \textcolor{comment}{//Write the corresponding ASN.1 tag}
1022    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, p, &n);
1023    \textcolor{comment}{//Any error to report?}
1024    \textcolor{keywordflow}{if}(error)
1025       \textcolor{keywordflow}{return} error;
1026 
1027    \textcolor{comment}{//Point to the first byte of the msgSecurityParameters field}
1028    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = p - \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1029    \textcolor{comment}{//Total length of the message}
1030    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += length + \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1031 
1032    \textcolor{comment}{//Successful processing}
1033    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1034 \textcolor{preprocessor}{#else}
1035    \textcolor{comment}{//Not implemented}
1036    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1037 \textcolor{preprocessor}{#endif}
1038 \}
\end{DoxyCode}
