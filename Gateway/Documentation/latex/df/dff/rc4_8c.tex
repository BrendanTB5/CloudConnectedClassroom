\hypertarget{rc4_8c}{}\section{cyclone\+\_\+crypto/cipher/rc4.c File Reference}
\label{rc4_8c}\index{cyclone\+\_\+crypto/cipher/rc4.\+c@{cyclone\+\_\+crypto/cipher/rc4.\+c}}


R\+C4 encryption algorithm.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cipher/rc4.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{rc4_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rc4_8c_a6cbde48d59ddfdb1d6ce7ad5eb7deddc}{rc4\+Init} (\hyperlink{structRc4Context}{Rc4\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Initialize an R\+C4 context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{rc4_8c_af54ce48919bb203446317b0cb5885c2c}{rc4\+Cipher} (\hyperlink{structRc4Context}{Rc4\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Encrypt/decrypt data with the R\+C4 algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{rc4_8c_af3de69e28244642ee730e22b97cfa7bd}{rc4\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+C4 encryption algorithm. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{rc4_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{rc4_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{rc4.\+c@{rc4.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!rc4.\+c@{rc4.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file rc4.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{rc4_8c_af54ce48919bb203446317b0cb5885c2c}\label{rc4_8c_af54ce48919bb203446317b0cb5885c2c}} 
\index{rc4.\+c@{rc4.\+c}!rc4\+Cipher@{rc4\+Cipher}}
\index{rc4\+Cipher@{rc4\+Cipher}!rc4.\+c@{rc4.\+c}}
\subsubsection{\texorpdfstring{rc4\+Cipher()}{rc4Cipher()}}
{\footnotesize\ttfamily void rc4\+Cipher (\begin{DoxyParamCaption}\item[{\hyperlink{structRc4Context}{Rc4\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Encrypt/decrypt data with the R\+C4 algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C4 context \\
\hline
\mbox{\tt in}  & {\em input} & Pointer to the data to encrypt/decrypt \\
\hline
\mbox{\tt in}  & {\em output} & Pointer to the resulting data \\
\hline
\mbox{\tt in}  & {\em length} & Length of the input data \\
\hline
\end{DoxyParams}


Definition at line 109 of file rc4.\+c.


\begin{DoxyCode}
110 \{
111    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} temp;
112 
113    \textcolor{comment}{//Restore context}
114    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i = context->\hyperlink{structRc4Context_afa2868f5817265197eabb526182b4b23}{i};
115    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j = context->\hyperlink{structRc4Context_a359e55af999b348d23a63790177e2e0b}{j};
116    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s} = context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s};
117 
118    \textcolor{comment}{//Encryption loop}
119    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
120    \{
121       \textcolor{comment}{//Adjust indices}
122       i = (i + 1) % 256;
123       j = (j + s[i]) % 256;
124 
125       \textcolor{comment}{//Swap the values of S[i] and S[j]}
126       temp = s[i];
127       s[i] = s[j];
128       s[j] = temp;
129 
130       \textcolor{comment}{//Valid input and output?}
131       \textcolor{keywordflow}{if}(input != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && output != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
132       \{
133          \textcolor{comment}{//XOR the input data with the RC4 stream}
134          *output = *input ^ s[(s[i] + s[j]) % 256];
135 
136          \textcolor{comment}{//Increment data pointers}
137          input++;
138          output++;
139       \}
140 
141       \textcolor{comment}{//Remaining bytes to process}
142       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}--;
143    \}
144 
145    \textcolor{comment}{//Save context}
146    context->\hyperlink{structRc4Context_afa2868f5817265197eabb526182b4b23}{i} = i;
147    context->\hyperlink{structRc4Context_a359e55af999b348d23a63790177e2e0b}{j} = j;
148 \}
\end{DoxyCode}
\mbox{\Hypertarget{rc4_8c_a6cbde48d59ddfdb1d6ce7ad5eb7deddc}\label{rc4_8c_a6cbde48d59ddfdb1d6ce7ad5eb7deddc}} 
\index{rc4.\+c@{rc4.\+c}!rc4\+Init@{rc4\+Init}}
\index{rc4\+Init@{rc4\+Init}!rc4.\+c@{rc4.\+c}}
\subsubsection{\texorpdfstring{rc4\+Init()}{rc4Init()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rc4\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structRc4Context}{Rc4\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Initialize an R\+C4 context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C4 context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em length} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 64 of file rc4.\+c.


\begin{DoxyCode}
65 \{
66    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
67    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
68    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} temp;
69 
70    \textcolor{comment}{//Check parameters}
71    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
72       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
73 
74    \textcolor{comment}{//Clear context}
75    context->\hyperlink{structRc4Context_afa2868f5817265197eabb526182b4b23}{i} = 0;
76    context->\hyperlink{structRc4Context_a359e55af999b348d23a63790177e2e0b}{j} = 0;
77 
78    \textcolor{comment}{//Initialize the S array with identity permutation}
79    \textcolor{keywordflow}{for}(i = 0; i < 256; i++)
80    \{
81       context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s}[i] = i;
82    \}
83 
84    \textcolor{comment}{//S is then processed for 256 iterations}
85    \textcolor{keywordflow}{for}(i = 0, j = 0; i < 256; i++)
86    \{
87       \textcolor{comment}{//Randomize the permutations using the supplied key}
88       j = (j + context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s}[i] + key[i % \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}]) % 256;
89 
90       \textcolor{comment}{//Swap the values of S[i] and S[j]}
91       temp = context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s}[i];
92       context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s}[i] = context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s}[j];
93       context->\hyperlink{structRc4Context_a4c824dd771819d672000dedd6f2a3d9d}{s}[j] = temp;
94    \}
95 
96    \textcolor{comment}{//RC4 context successfully initialized}
97    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
98 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{rc4_8c_af3de69e28244642ee730e22b97cfa7bd}\label{rc4_8c_af3de69e28244642ee730e22b97cfa7bd}} 
\index{rc4.\+c@{rc4.\+c}!rc4\+Cipher\+Algo@{rc4\+Cipher\+Algo}}
\index{rc4\+Cipher\+Algo@{rc4\+Cipher\+Algo}!rc4.\+c@{rc4.\+c}}
\subsubsection{\texorpdfstring{rc4\+Cipher\+Algo}{rc4CipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} rc4\+Cipher\+Algo}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   \textcolor{stringliteral}{"RC4"},
   \textcolor{keyword}{sizeof}(\hyperlink{structRc4Context}{Rc4Context}),
   \hyperlink{cyclone__crypto_2core_2crypto_8h_ae03a6c8f32ed798857924d908aacc49ba530b7d566dd1ff3cdec341ce3dbdd75b}{CIPHER\_ALGO\_TYPE\_STREAM},
   0,
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_a1a0f02cdb8a3295caa1b87db2785e678}{CipherAlgoInit}) \hyperlink{rc4_8c_a6cbde48d59ddfdb1d6ce7ad5eb7deddc}{rc4Init},
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_aae77a823e0d715f38ce07aa1966dd8f5}{CipherAlgoEncryptStream}) \hyperlink{rc4_8c_af54ce48919bb203446317b0cb5885c2c}{rc4Cipher},
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_aafba7bbaaf58a20e4766a30f2d14fc7f}{CipherAlgoDecryptStream}) \hyperlink{rc4_8c_af54ce48919bb203446317b0cb5885c2c}{rc4Cipher},
   \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
   NULL
\}
\end{DoxyCode}


Definition at line 42 of file rc4.\+c.

