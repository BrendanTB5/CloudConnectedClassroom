\hypertarget{m2m__ota_8c}{}\section{third\+\_\+party/atmel/devices/wilc1000/driver/source/m2m\+\_\+ota.c File Reference}
\label{m2m__ota_8c}\index{third\+\_\+party/atmel/devices/wilc1000/driver/source/m2m\+\_\+ota.\+c@{third\+\_\+party/atmel/devices/wilc1000/driver/source/m2m\+\_\+ota.\+c}}


N\+M\+C1500 IoT O\+TA Interface.  


{\ttfamily \#include \char`\"{}common\textbackslash{}include\textbackslash{}nm\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}driver\textbackslash{}include\textbackslash{}m2m\+\_\+types.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}driver\textbackslash{}include\textbackslash{}m2m\+\_\+ota.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}driver\textbackslash{}source\textbackslash{}m2m\+\_\+hif.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{m2m__ota_8c_a900f8458624a940655bc3ce149512ad4}{m2m\+\_\+ota\+\_\+cb} (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8} u8\+Op\+Code, \hyperlink{group__DataT_ga1daa745171fc6e31d942c161422a76f9}{uint16} u16\+Data\+Size, \hyperlink{group__DataT_ga100e7c691a47d6978527c479a0158245}{uint32} u32\+Addr)
\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaInitFn_gacd2a1a8ffaccc3deb1970cf1ad41ceec}{m2m\+\_\+ota\+\_\+init} (\hyperlink{group__OTATYPEDEF_ga86bdacc22dca0d0844e0825d81fb4f85}{tpf\+Ota\+Update\+Cb} pf\+Ota\+Update\+Cb, \hyperlink{group__OTATYPEDEF_gaa3fadd9ab95ba91a4f32c702dd5104d8}{tpf\+Ota\+Notif\+Cb} pf\+Ota\+Notif\+Cb)
\begin{DoxyCompactList}\small\item\em Initialize the O\+TA layer. \end{DoxyCompactList}\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaNotifStFn_ga98ab9f03996e6bf1cb21ba7259bb0058}{m2m\+\_\+ota\+\_\+notif\+\_\+set\+\_\+url} (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8} $\ast$u8\+Url)
\begin{DoxyCompactList}\small\item\em Set the O\+TA url. \end{DoxyCompactList}\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaNotifCheckFn_ga522222363c6991cb078c38b06cfa6c80}{m2m\+\_\+ota\+\_\+notif\+\_\+check\+\_\+for\+\_\+update} (void)
\begin{DoxyCompactList}\small\item\em check for ota update \end{DoxyCompactList}\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaSched_ga5dab33fa39bd9aa510b482ccd4226f81}{m2m\+\_\+ota\+\_\+notif\+\_\+sched} (\hyperlink{group__DataT_ga100e7c691a47d6978527c479a0158245}{uint32} u32\+Period)
\begin{DoxyCompactList}\small\item\em Schedule O\+TA update. \end{DoxyCompactList}\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaStartUpdatefn_gac50387eab16b3257f1c037942f2682fd}{m2m\+\_\+ota\+\_\+start\+\_\+update} (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8} $\ast$u8\+Download\+Url)
\begin{DoxyCompactList}\small\item\em Request O\+TA start update using the downloaded url. \end{DoxyCompactList}\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaRollbackfn_gafdc5f0bb3d2a23b787816494ba1e5a48}{m2m\+\_\+ota\+\_\+rollback} (void)
\begin{DoxyCompactList}\small\item\em Request O\+TA Rollback image. \end{DoxyCompactList}\item 
\hyperlink{group__BSPDefine_gaecc0323d771e41ef81a76b5f12783e22}{N\+M\+I\+\_\+\+A\+PI} \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} \hyperlink{group__OtaSwitchFirmware_ga464a45a53473152d5a78c578ae0edd8a}{m2m\+\_\+ota\+\_\+switch\+\_\+firmware} (void)
\begin{DoxyCompactList}\small\item\em Switch to the upgraded Firmware. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{group__OTATYPEDEF_ga86bdacc22dca0d0844e0825d81fb4f85}{tpf\+Ota\+Update\+Cb} \hyperlink{m2m__ota_8c_a0c2b97943aa732cfcf68afa47f2a1206}{gpf\+Ota\+Update\+Cb} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}
\item 
static \hyperlink{group__OTATYPEDEF_gaa3fadd9ab95ba91a4f32c702dd5104d8}{tpf\+Ota\+Notif\+Cb} \hyperlink{m2m__ota_8c_a43b3def63edb691574de474f22169f6b}{gpf\+Ota\+Notif\+Cb} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
N\+M\+C1500 IoT O\+TA Interface. 

Copyright (c) 2018 Microchip Technology Inc. and its subsidiaries.

\subsection{Function Documentation}
\mbox{\Hypertarget{m2m__ota_8c_a900f8458624a940655bc3ce149512ad4}\label{m2m__ota_8c_a900f8458624a940655bc3ce149512ad4}} 
\index{m2m\+\_\+ota.\+c@{m2m\+\_\+ota.\+c}!m2m\+\_\+ota\+\_\+cb@{m2m\+\_\+ota\+\_\+cb}}
\index{m2m\+\_\+ota\+\_\+cb@{m2m\+\_\+ota\+\_\+cb}!m2m\+\_\+ota.\+c@{m2m\+\_\+ota.\+c}}
\subsubsection{\texorpdfstring{m2m\+\_\+ota\+\_\+cb()}{m2m\_ota\_cb()}}
{\footnotesize\ttfamily static void m2m\+\_\+ota\+\_\+cb (\begin{DoxyParamCaption}\item[{\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}}]{u8\+Op\+Code,  }\item[{\hyperlink{group__DataT_ga1daa745171fc6e31d942c161422a76f9}{uint16}}]{u16\+Data\+Size,  }\item[{\hyperlink{group__DataT_ga100e7c691a47d6978527c479a0158245}{uint32}}]{u32\+Addr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 74 of file m2m\+\_\+ota.\+c.


\begin{DoxyCode}
75 \{
76     \hyperlink{group__DataT_gae35f10ffd0ac8dd2bc3e794da9bdfbc7}{sint8} ret = \hyperlink{nm__common_8h_a9ef27ba27aafdd1aa3a79d3ba2c36b8f}{M2M\_SUCCESS};
77     \textcolor{keywordflow}{if}(u8OpCode == M2M\_OTA\_RESP\_NOTIF\_UPDATE\_INFO)
78     \{
79         tstrOtaUpdateInfo strOtaUpdateInfo;
80         \hyperlink{nm__common_8h_ad4de761e451e6416e7e21d6abc4fb776}{m2m\_memset}((\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*)&strOtaUpdateInfo,0,\textcolor{keyword}{sizeof}(tstrOtaUpdateInfo));
81         ret = \hyperlink{m2m__hif_8c_a8170ed0e1b42ae496c6126a254457006}{hif\_receive}(u32Addr,(\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*)&strOtaUpdateInfo,\textcolor{keyword}{sizeof}(tstrOtaUpdateInfo),0);
82         \textcolor{keywordflow}{if}(ret == \hyperlink{nm__common_8h_a9ef27ba27aafdd1aa3a79d3ba2c36b8f}{M2M\_SUCCESS})
83         \{
84             \textcolor{keywordflow}{if}(\hyperlink{m2m__ota_8c_a43b3def63edb691574de474f22169f6b}{gpfOtaNotifCb})
85                 \hyperlink{m2m__ota_8c_a43b3def63edb691574de474f22169f6b}{gpfOtaNotifCb}(&strOtaUpdateInfo);
86         \}
87     \}
88     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (u8OpCode == M2M\_OTA\_RESP\_UPDATE\_STATUS)
89     \{
90         tstrOtaUpdateStatusResp strOtaUpdateStatusResp; 
91         \hyperlink{nm__common_8h_ad4de761e451e6416e7e21d6abc4fb776}{m2m\_memset}((\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*)&strOtaUpdateStatusResp,0,\textcolor{keyword}{sizeof}(tstrOtaUpdateStatusResp));
92         ret = \hyperlink{m2m__hif_8c_a8170ed0e1b42ae496c6126a254457006}{hif\_receive}(u32Addr, (\hyperlink{group__DataT_ga4df709a77647e870bbf1d955b8edc9a6}{uint8}*) &strOtaUpdateStatusResp,\textcolor{keyword}{sizeof}(
      tstrOtaUpdateStatusResp), 0);
93         \textcolor{keywordflow}{if}(ret == \hyperlink{nm__common_8h_a9ef27ba27aafdd1aa3a79d3ba2c36b8f}{M2M\_SUCCESS})
94         \{
95             \textcolor{keywordflow}{if}(\hyperlink{m2m__ota_8c_a0c2b97943aa732cfcf68afa47f2a1206}{gpfOtaUpdateCb})
96                 \hyperlink{m2m__ota_8c_a0c2b97943aa732cfcf68afa47f2a1206}{gpfOtaUpdateCb}(strOtaUpdateStatusResp.u8OtaUpdateStatusType,
      strOtaUpdateStatusResp.u8OtaUpdateStatus);
97         \}
98     \}
99     \textcolor{keywordflow}{else}
100     \{
101         \hyperlink{nm__common_8h_a34d005df494e50b05cd38b80f318d7ac}{M2M\_ERR}(\textcolor{stringliteral}{"Invaild OTA resp %d ?\(\backslash\)r\(\backslash\)n"},u8OpCode);
102     \}
103 
104 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{m2m__ota_8c_a43b3def63edb691574de474f22169f6b}\label{m2m__ota_8c_a43b3def63edb691574de474f22169f6b}} 
\index{m2m\+\_\+ota.\+c@{m2m\+\_\+ota.\+c}!gpf\+Ota\+Notif\+Cb@{gpf\+Ota\+Notif\+Cb}}
\index{gpf\+Ota\+Notif\+Cb@{gpf\+Ota\+Notif\+Cb}!m2m\+\_\+ota.\+c@{m2m\+\_\+ota.\+c}}
\subsubsection{\texorpdfstring{gpf\+Ota\+Notif\+Cb}{gpfOtaNotifCb}}
{\footnotesize\ttfamily \hyperlink{group__OTATYPEDEF_gaa3fadd9ab95ba91a4f32c702dd5104d8}{tpf\+Ota\+Notif\+Cb} gpf\+Ota\+Notif\+Cb = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 53 of file m2m\+\_\+ota.\+c.

\mbox{\Hypertarget{m2m__ota_8c_a0c2b97943aa732cfcf68afa47f2a1206}\label{m2m__ota_8c_a0c2b97943aa732cfcf68afa47f2a1206}} 
\index{m2m\+\_\+ota.\+c@{m2m\+\_\+ota.\+c}!gpf\+Ota\+Update\+Cb@{gpf\+Ota\+Update\+Cb}}
\index{gpf\+Ota\+Update\+Cb@{gpf\+Ota\+Update\+Cb}!m2m\+\_\+ota.\+c@{m2m\+\_\+ota.\+c}}
\subsubsection{\texorpdfstring{gpf\+Ota\+Update\+Cb}{gpfOtaUpdateCb}}
{\footnotesize\ttfamily \hyperlink{group__OTATYPEDEF_ga86bdacc22dca0d0844e0825d81fb4f85}{tpf\+Ota\+Update\+Cb} gpf\+Ota\+Update\+Cb = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 52 of file m2m\+\_\+ota.\+c.

