\hypertarget{x509__key__parse_8h}{}\section{cyclone\+\_\+crypto/pkix/x509\+\_\+key\+\_\+parse.h File Reference}
\label{x509__key__parse_8h}\index{cyclone\+\_\+crypto/pkix/x509\+\_\+key\+\_\+parse.\+h@{cyclone\+\_\+crypto/pkix/x509\+\_\+key\+\_\+parse.\+h}}


Parsing of A\+S\+N.\+1 encoded keys.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+common.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a17bacf95e872d7fdcd6cec43b1724dd6}{x509\+Parse\+Subject\+Public\+Key\+Info} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$subject\+Public\+Key\+Info)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Public\+Key\+Info structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a2de67fd41226a162fa5f3fb14539108f}{x509\+Parse\+Algorithm\+Identifier} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$subject\+Public\+Key\+Info)
\begin{DoxyCompactList}\small\item\em Parse Algorithm\+Identifier structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a9af828c1f9152b3f008a9334d071bac2}{x509\+Parse\+Rsa\+Public\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPublicKey}{X509\+Rsa\+Public\+Key} $\ast$rsa\+Public\+Key)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+Public\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_aad327c7f3da9180fbf94b8e4363bda40}{x509\+Parse\+Rsa\+Pss\+Parameters} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a695e24dfcc2e5669cb0ad6068298ce3f}{x509\+Parse\+Rsa\+Pss\+Hash\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS hash algorithm. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_aa5112ced5c08b4f31070b83a7f87b330}{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS mask generation algorithm. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a65e7c656a4fe02a8f5cfb6ef873f0834}{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS mask generation hash algorithm. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_aa9f385740a40d71e149e795c3bb3e4e0}{x509\+Parse\+Rsa\+Pss\+Salt\+Length} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS salt length. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a3d52f72e0b1285700bcc30b5b6b54ac1}{x509\+Parse\+Dsa\+Public\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509DsaPublicKey}{X509\+Dsa\+Public\+Key} $\ast$dsa\+Public\+Key)
\begin{DoxyCompactList}\small\item\em Parse D\+S\+A\+Public\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_afa7c44bc9c776d4bdb4a03519ef894a5}{x509\+Parse\+Dsa\+Parameters} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509DsaParameters}{X509\+Dsa\+Parameters} $\ast$dsa\+Params)
\begin{DoxyCompactList}\small\item\em Parse D\+SA domain parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_ae09cd9fb14828d4666570022bdf094ab}{x509\+Parse\+Ec\+Public\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509EcPublicKey}{X509\+Ec\+Public\+Key} $\ast$ec\+Public\+Key)
\begin{DoxyCompactList}\small\item\em Parse E\+C\+Public\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a2caeec4d90cfecef949ee31dcaefaf83}{x509\+Parse\+Ec\+Parameters} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$ec\+Params)
\begin{DoxyCompactList}\small\item\em Parse E\+C\+Parameters structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a46b55059a7e4840fa58c40d2c2b44cd4}{x509\+Import\+Rsa\+Public\+Key} (const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$public\+Key\+Info, \hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$public\+Key)
\begin{DoxyCompactList}\small\item\em Import an R\+SA public key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_aa028d369d57dd4e935aed069e8274de9}{x509\+Import\+Dsa\+Public\+Key} (const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$public\+Key\+Info, \hyperlink{structDsaPublicKey}{Dsa\+Public\+Key} $\ast$public\+Key)
\begin{DoxyCompactList}\small\item\em Import a D\+SA public key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a9679c73982634a74e0a2a819820a9b46}{x509\+Import\+Ec\+Public\+Key} (const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$public\+Key\+Info, \hyperlink{structEcPoint}{Ec\+Point} $\ast$public\+Key)
\begin{DoxyCompactList}\small\item\em Import an EC public key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a33bcbd04df4e936a5781b70bd473a508}{x509\+Import\+Ec\+Parameters} (const \hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$ec\+Params, \hyperlink{structEcDomainParameters}{Ec\+Domain\+Parameters} $\ast$params)
\begin{DoxyCompactList}\small\item\em Import EC domain parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__key__parse_8h_a927d8a10e25e8155a113cda1630f67dc}{x509\+Import\+Eddsa\+Public\+Key} (const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$public\+Key\+Info, \hyperlink{structEddsaPublicKey}{Eddsa\+Public\+Key} $\ast$public\+Key)
\begin{DoxyCompactList}\small\item\em Import an Ed\+D\+SA public key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Parsing of A\+S\+N.\+1 encoded keys. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{x509__key__parse_8h_aa028d369d57dd4e935aed069e8274de9}\label{x509__key__parse_8h_aa028d369d57dd4e935aed069e8274de9}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Import\+Dsa\+Public\+Key@{x509\+Import\+Dsa\+Public\+Key}}
\index{x509\+Import\+Dsa\+Public\+Key@{x509\+Import\+Dsa\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Import\+Dsa\+Public\+Key()}{x509ImportDsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Import\+Dsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{public\+Key\+Info,  }\item[{\hyperlink{structDsaPublicKey}{Dsa\+Public\+Key} $\ast$}]{public\+Key }\end{DoxyParamCaption})}



Import a D\+SA public key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em public\+Key\+Info} & Public key information \\
\hline
\mbox{\tt out}  & {\em public\+Key} & D\+SA public key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 890 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
892 \{
893    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
894 
895 \textcolor{preprocessor}{#if (DSA\_SUPPORT == ENABLED)}
896    \textcolor{comment}{//DSA algorithm identifier?}
897    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen}, 
      \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID},
898       \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
899    \{
900       \textcolor{comment}{//Sanity check}
901       \textcolor{keywordflow}{if}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.\hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
902          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.\hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
903          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.\hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
904          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_aca3c9dc2e4fefc2e5ac0f1db6baedccc}{dsaPublicKey}.\hyperlink{structX509DsaPublicKey_a8a2e4dd10c344dfeae0d55487b2bfce8}{y} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
905       \{
906          \textcolor{comment}{//Read parameter p}
907          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structDsaPublicKey_a273f5bed06a946fd672c94283f49fc3e}{p}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.
      \hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p},
908             publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.\hyperlink{structX509DsaParameters_a492453aa50210c40372c6d76ff955c7f}{pLen}, \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
909 
910          \textcolor{comment}{//Check status code}
911          \textcolor{keywordflow}{if}(!error)
912          \{
913             \textcolor{comment}{//Read parameter q}
914             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structDsaPublicKey_a7961fbb82f0c5c56b577d2247ffc9172}{q}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.
      \hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q},
915                publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.\hyperlink{structX509DsaParameters_a2cb0e6cf41cb0b07dfccedc79bce007e}{qLen}, \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
916          \}
917 
918          \textcolor{comment}{//Check status code}
919          \textcolor{keywordflow}{if}(!error)
920          \{
921             \textcolor{comment}{//Read parameter g}
922             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structDsaPublicKey_a910d43db2650efb256373b06521a23bf}{g}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.
      \hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g},
923                publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams}.\hyperlink{structX509DsaParameters_a84e6f3a0159da3fff5bf9315be4cf5f7}{gLen}, \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
924          \}
925 
926          \textcolor{comment}{//Check status code}
927          \textcolor{keywordflow}{if}(!error)
928          \{
929             \textcolor{comment}{//Read public value}
930             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structDsaPublicKey_a47d0a3368a5a61e48cc36ed0414392a6}{y}, publicKeyInfo->
      \hyperlink{structX509SubjectPublicKeyInfo_aca3c9dc2e4fefc2e5ac0f1db6baedccc}{dsaPublicKey}.\hyperlink{structX509DsaPublicKey_a8a2e4dd10c344dfeae0d55487b2bfce8}{y},
931                publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_aca3c9dc2e4fefc2e5ac0f1db6baedccc}{dsaPublicKey}.\hyperlink{structX509DsaPublicKey_ae8ad5e10e6090c0b95a083b49efe18b2}{yLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
932          \}
933 
934          \textcolor{comment}{//Check status code}
935          \textcolor{keywordflow}{if}(!error)
936          \{
937             \textcolor{comment}{//Debug message}
938             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"DSA public key:\(\backslash\)r\(\backslash\)n"});
939             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parameter p:\(\backslash\)r\(\backslash\)n"});
940             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structDsaPublicKey_a273f5bed06a946fd672c94283f49fc3e}{p});
941             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parameter q:\(\backslash\)r\(\backslash\)n"});
942             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structDsaPublicKey_a7961fbb82f0c5c56b577d2247ffc9172}{q});
943             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parameter g:\(\backslash\)r\(\backslash\)n"});
944             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structDsaPublicKey_a910d43db2650efb256373b06521a23bf}{g});
945             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public value y:\(\backslash\)r\(\backslash\)n"});
946             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structDsaPublicKey_a47d0a3368a5a61e48cc36ed0414392a6}{y});
947          \}
948       \}
949       \textcolor{keywordflow}{else}
950       \{
951          \textcolor{comment}{//The public key is not valid}
952          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
953       \}
954    \}
955    \textcolor{keywordflow}{else}
956 \textcolor{preprocessor}{#endif}
957    \textcolor{comment}{//Invalid algorithm identifier?}
958    \{
959       \textcolor{comment}{//Report an error}
960       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
961    \}
962 
963    \textcolor{comment}{//Return status code}
964    \textcolor{keywordflow}{return} error;
965 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a33bcbd04df4e936a5781b70bd473a508}\label{x509__key__parse_8h_a33bcbd04df4e936a5781b70bd473a508}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Import\+Ec\+Parameters@{x509\+Import\+Ec\+Parameters}}
\index{x509\+Import\+Ec\+Parameters@{x509\+Import\+Ec\+Parameters}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Import\+Ec\+Parameters()}{x509ImportEcParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Import\+Ec\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$}]{ec\+Params,  }\item[{\hyperlink{structEcDomainParameters}{Ec\+Domain\+Parameters} $\ast$}]{params }\end{DoxyParamCaption})}



Import EC domain parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ec\+Params} & Pointer to the E\+C\+Parameters structure \\
\hline
\mbox{\tt out}  & {\em params} & EC domain parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1058 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
1060 \{
1061    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1062 
1063 \textcolor{preprocessor}{#if (EC\_SUPPORT == ENABLED)}
1064    \textcolor{keyword}{const} \hyperlink{structEcCurveInfo}{EcCurveInfo} *curveInfo;
1065 
1066    \textcolor{comment}{//Retrieve EC domain parameters}
1067    curveInfo = \hyperlink{ec__curves_8c_a0e60cf6994283f6bf5bcf56e86f9adbe}{ecGetCurveInfo}(ecParams->\hyperlink{structX509EcParameters_a122c5387fb2f12374a905ecfd2ca4c86}{namedCurve}, ecParams->
      \hyperlink{structX509EcParameters_ac58081bd63ed68d0cb101ff7e65667ec}{namedCurveLen});
1068 
1069    \textcolor{comment}{//Make sure the specified elliptic curve is supported}
1070    \textcolor{keywordflow}{if}(curveInfo != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1071    \{
1072       \textcolor{comment}{//Load EC domain parameters}
1073       error = \hyperlink{ec_8c_ab3d7ebcb8fd2e79990ef25e39a68f4a5}{ecLoadDomainParameters}(params, curveInfo);
1074    \}
1075    \textcolor{keywordflow}{else}
1076 \textcolor{preprocessor}{#endif}
1077    \{
1078       \textcolor{comment}{//Invalid EC domain parameters}
1079       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
1080    \}
1081 
1082    \textcolor{comment}{//Return status code}
1083    \textcolor{keywordflow}{return} error;
1084 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a9679c73982634a74e0a2a819820a9b46}\label{x509__key__parse_8h_a9679c73982634a74e0a2a819820a9b46}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Import\+Ec\+Public\+Key@{x509\+Import\+Ec\+Public\+Key}}
\index{x509\+Import\+Ec\+Public\+Key@{x509\+Import\+Ec\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Import\+Ec\+Public\+Key()}{x509ImportEcPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Import\+Ec\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{public\+Key\+Info,  }\item[{\hyperlink{structEcPoint}{Ec\+Point} $\ast$}]{public\+Key }\end{DoxyParamCaption})}



Import an EC public key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em public\+Key\+Info} & Public key information \\
\hline
\mbox{\tt out}  & {\em public\+Key} & EC public key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 975 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
977 \{
978    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
979 
980 \textcolor{preprocessor}{#if (EC\_SUPPORT == ENABLED)}
981    \textcolor{keyword}{const} \hyperlink{structEcCurveInfo}{EcCurveInfo} *curveInfo;
982    \hyperlink{structEcDomainParameters}{EcDomainParameters} params;
983 
984    \textcolor{comment}{//EC public key identifier?}
985    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen}, 
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID},
986       \textcolor{keyword}{sizeof}(\hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
987    \{
988       \textcolor{comment}{//Sanity check}
989       \textcolor{keywordflow}{if}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af45ca47e19db60631c9fdb4d4b62ed10}{ecParams}.\hyperlink{structX509EcParameters_a122c5387fb2f12374a905ecfd2ca4c86}{namedCurve} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
990          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
991       \{
992          \textcolor{comment}{//Initialize EC domain parameters}
993          \hyperlink{ec_8c_a5b5132fb8adf668ffa74ec10e7e63441}{ecInitDomainParameters}(&params);
994 
995          \textcolor{comment}{//Retrieve EC domain parameters}
996          curveInfo = \hyperlink{certificate_2x509__common_8c_a6f6416a69dd75fe6f18aab77a0f7205c}{x509GetCurveInfo}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af45ca47e19db60631c9fdb4d4b62ed10}{ecParams}.
      \hyperlink{structX509EcParameters_a122c5387fb2f12374a905ecfd2ca4c86}{namedCurve},
997             publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af45ca47e19db60631c9fdb4d4b62ed10}{ecParams}.\hyperlink{structX509EcParameters_ac58081bd63ed68d0cb101ff7e65667ec}{namedCurveLen});
998 
999          \textcolor{comment}{//Make sure the specified elliptic curve is supported}
1000          \textcolor{keywordflow}{if}(curveInfo != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1001          \{
1002             \textcolor{comment}{//Load EC domain parameters}
1003             error = \hyperlink{ec_8c_ab3d7ebcb8fd2e79990ef25e39a68f4a5}{ecLoadDomainParameters}(&params, curveInfo);
1004          \}
1005          \textcolor{keywordflow}{else}
1006          \{
1007             \textcolor{comment}{//Invalid EC domain parameters}
1008             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
1009          \}
1010 
1011          \textcolor{comment}{//Check status code}
1012          \textcolor{keywordflow}{if}(!error)
1013          \{
1014             \textcolor{comment}{//Read the EC public key}
1015             error = \hyperlink{ec_8c_ae707a9a99979ce0b291ac6c0f8d380fd}{ecImport}(&params, publicKey, publicKeyInfo->
      \hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q},
1016                publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen});
1017          \}
1018 
1019          \textcolor{comment}{//Check status code}
1020          \textcolor{keywordflow}{if}(!error)
1021          \{
1022             \textcolor{comment}{//Debug message}
1023             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public key X:\(\backslash\)r\(\backslash\)n"});
1024             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structEcPoint_a08f3fbb7a7d07607306bd8d6200629af}{x});
1025             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public key Y:\(\backslash\)r\(\backslash\)n"});
1026             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structEcPoint_a2102dff813849bd0eaed8a1a5e64ec1f}{y});
1027          \}
1028 
1029          \textcolor{comment}{//Release EC domain parameters}
1030          \hyperlink{ec_8c_a256993c154cf87c3d9d18138a1365eca}{ecFreeDomainParameters}(&params);
1031       \}
1032       \textcolor{keywordflow}{else}
1033       \{
1034          \textcolor{comment}{//The public key is not valid}
1035          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
1036       \}
1037    \}
1038    \textcolor{keywordflow}{else}
1039 \textcolor{preprocessor}{#endif}
1040    \textcolor{comment}{//Invalid algorithm identifier?}
1041    \{
1042       \textcolor{comment}{//Report an error}
1043       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
1044    \}
1045 
1046    \textcolor{comment}{//Return status code}
1047    \textcolor{keywordflow}{return} error;
1048 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a927d8a10e25e8155a113cda1630f67dc}\label{x509__key__parse_8h_a927d8a10e25e8155a113cda1630f67dc}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Import\+Eddsa\+Public\+Key@{x509\+Import\+Eddsa\+Public\+Key}}
\index{x509\+Import\+Eddsa\+Public\+Key@{x509\+Import\+Eddsa\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Import\+Eddsa\+Public\+Key()}{x509ImportEddsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Import\+Eddsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{public\+Key\+Info,  }\item[{\hyperlink{structEddsaPublicKey}{Eddsa\+Public\+Key} $\ast$}]{public\+Key }\end{DoxyParamCaption})}



Import an Ed\+D\+SA public key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em public\+Key\+Info} & Public key information \\
\hline
\mbox{\tt out}  & {\em public\+Key} & Ed\+D\+SA public key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1094 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
1096 \{
1097    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1098 
1099 \textcolor{preprocessor}{#if (ED25519\_SUPPORT == ENABLED)}
1100    \textcolor{comment}{//Ed25519 algorithm identifier?}
1101    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen}, 
      \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID},
1102       \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
1103    \{
1104       \textcolor{comment}{//Check the length of the Ed25519 public key}
1105       \textcolor{keywordflow}{if}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
1106          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen} == 
      \hyperlink{ed25519_8h_a5fdd1f73dec2be868a8ed5d2e129bb5e}{ED25519\_PUBLIC\_KEY\_LEN})
1107       \{
1108          \textcolor{comment}{//Read the Ed25519 public key}
1109          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structEddsaPublicKey_ad64b6fac961042422df3f17bd5f01f9e}{q}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.
      \hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q},
1110             publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa637c0a6e803a47db52875c6818674c60}{MPI\_FORMAT\_LITTLE\_ENDIAN});
1111       \}
1112       \textcolor{keywordflow}{else}
1113       \{
1114          \textcolor{comment}{//The public key is not valid}
1115          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
1116       \}
1117    \}
1118    \textcolor{keywordflow}{else}
1119 \textcolor{preprocessor}{#endif}
1120 \textcolor{preprocessor}{#if (ED448\_SUPPORT == ENABLED)}
1121    \textcolor{comment}{//Ed448 algorithm identifier?}
1122    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen}, 
      \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID},
1123       \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
1124    \{
1125       \textcolor{comment}{//Check the length of the Ed448 public key}
1126       \textcolor{keywordflow}{if}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
1127          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen} == \hyperlink{ed448_8h_a452cd73807c6a5607ede7ba57cbc3e6a}{ED448\_PUBLIC\_KEY\_LEN})
1128       \{
1129          \textcolor{comment}{//Read the Ed448 public key}
1130          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structEddsaPublicKey_ad64b6fac961042422df3f17bd5f01f9e}{q}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.
      \hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q},
1131             publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey}.\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa637c0a6e803a47db52875c6818674c60}{MPI\_FORMAT\_LITTLE\_ENDIAN});
1132       \}
1133       \textcolor{keywordflow}{else}
1134       \{
1135          \textcolor{comment}{//The public key is not valid}
1136          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
1137       \}
1138    \}
1139    \textcolor{keywordflow}{else}
1140 \textcolor{preprocessor}{#endif}
1141    \textcolor{comment}{//Invalid algorithm identifier?}
1142    \{
1143       \textcolor{comment}{//Report an error}
1144       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
1145    \}
1146 
1147    \textcolor{comment}{//Check status code}
1148    \textcolor{keywordflow}{if}(!error)
1149    \{
1150       \textcolor{comment}{//Debug message}
1151       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"EdDSA public key:\(\backslash\)r\(\backslash\)n"});
1152       \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"  "}, &publicKey->\hyperlink{structEddsaPublicKey_ad64b6fac961042422df3f17bd5f01f9e}{q});
1153    \}
1154 
1155    \textcolor{comment}{//Return status code}
1156    \textcolor{keywordflow}{return} error;
1157 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a46b55059a7e4840fa58c40d2c2b44cd4}\label{x509__key__parse_8h_a46b55059a7e4840fa58c40d2c2b44cd4}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Import\+Rsa\+Public\+Key@{x509\+Import\+Rsa\+Public\+Key}}
\index{x509\+Import\+Rsa\+Public\+Key@{x509\+Import\+Rsa\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Import\+Rsa\+Public\+Key()}{x509ImportRsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Import\+Rsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{public\+Key\+Info,  }\item[{\hyperlink{structRsaPublicKey}{Rsa\+Public\+Key} $\ast$}]{public\+Key }\end{DoxyParamCaption})}



Import an R\+SA public key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em public\+Key\+Info} & Public key information \\
\hline
\mbox{\tt out}  & {\em public\+Key} & R\+SA public key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 820 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
822 \{
823    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
824 
825 \textcolor{preprocessor}{#if (RSA\_SUPPORT == ENABLED)}
826    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid};
827    \textcolor{keywordtype}{size\_t} oidLen;
828 
829    \textcolor{comment}{//Get the public key algorithm identifier}
830    oid = publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid};
831    oidLen = publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen};
832 
833    \textcolor{comment}{//RSA algorithm identifier?}
834    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})) ||
835       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
836    \{
837       \textcolor{comment}{//Sanity check}
838       \textcolor{keywordflow}{if}(publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey}.\hyperlink{structX509RsaPublicKey_acda40dfd0c6f2b68e0ba227e59bfb727}{n} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
839          publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey}.\hyperlink{structX509RsaPublicKey_a13db0b045295934879aa34cea8996ef6}{e} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
840       \{
841          \textcolor{comment}{//Read modulus}
842          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n}, publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey}.
      \hyperlink{structX509RsaPublicKey_acda40dfd0c6f2b68e0ba227e59bfb727}{n},
843             publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey}.\hyperlink{structX509RsaPublicKey_a8311e7f5f00c9faaf36640f9dbd7cdb5}{nLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
844 
845          \textcolor{comment}{//Check status code}
846          \textcolor{keywordflow}{if}(!error)
847          \{
848             \textcolor{comment}{//Read public exponent}
849             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&publicKey->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e}, publicKeyInfo->
      \hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey}.\hyperlink{structX509RsaPublicKey_a13db0b045295934879aa34cea8996ef6}{e},
850                publicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey}.\hyperlink{structX509RsaPublicKey_af531c21f55e40fb06165cd151dd96fa4}{eLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
851          \}
852 
853          \textcolor{comment}{//Check status code}
854          \textcolor{keywordflow}{if}(!error)
855          \{
856             \textcolor{comment}{//Debug message}
857             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSA public key:\(\backslash\)r\(\backslash\)n"});
858             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
859             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structRsaPublicKey_a51b3d236796d7d46c15d3e6bc7e5acb2}{n});
860             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
861             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &publicKey->\hyperlink{structRsaPublicKey_af293e256864ab9ac9f80d1e6552693da}{e});
862          \}
863       \}
864       \textcolor{keywordflow}{else}
865       \{
866          \textcolor{comment}{//The public key is not valid}
867          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
868       \}
869    \}
870    \textcolor{keywordflow}{else}
871 \textcolor{preprocessor}{#endif}
872    \textcolor{comment}{//Invalid algorithm identifier?}
873    \{
874       \textcolor{comment}{//Report an error}
875       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
876    \}
877 
878    \textcolor{comment}{//Return status code}
879    \textcolor{keywordflow}{return} error;
880 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a2de67fd41226a162fa5f3fb14539108f}\label{x509__key__parse_8h_a2de67fd41226a162fa5f3fb14539108f}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Algorithm\+Identifier@{x509\+Parse\+Algorithm\+Identifier}}
\index{x509\+Parse\+Algorithm\+Identifier@{x509\+Parse\+Algorithm\+Identifier}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Algorithm\+Identifier()}{x509ParseAlgorithmIdentifier()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Algorithm\+Identifier (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{public\+Key\+Info }\end{DoxyParamCaption})}



Parse Algorithm\+Identifier structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em subject\+Public\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em public\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1187 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1189 \{
1190    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1191    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1192 
1193    \textcolor{comment}{//Debug message}
1194    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing AlgorithmIdentifier...\(\backslash\)r\(\backslash\)n"});
1195 
1196    \textcolor{comment}{//Read AlgorithmIdentifier field}
1197    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1198    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1199    \textcolor{keywordflow}{if}(error)
1200       \textcolor{keywordflow}{return} error;
1201 
1202    \textcolor{comment}{//Save the total length of the field}
1203    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1204 
1205    \textcolor{comment}{//Point to the first field}
1206    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1207    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1208 
1209    \textcolor{comment}{//Read algorithm identifier (OID)}
1210    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1211    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1212    \textcolor{keywordflow}{if}(error)
1213       \textcolor{keywordflow}{return} error;
1214 
1215    \textcolor{comment}{//Save the algorithm identifier}
1216    subjectPublicKeyInfo->oid = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1217    subjectPublicKeyInfo->oidLen = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1218 
1219    \textcolor{comment}{//Point to the next field (if any)}
1220    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1221    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1222 
1223 \textcolor{preprocessor}{#if (X509\_RSA\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1224    \textcolor{comment}{//RSA algorithm identifier?}
1225    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})))
1226    \{
1227       \textcolor{comment}{//RSA does not require any additional parameters}
1228       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1229    \}
1230    \textcolor{keywordflow}{else}
1231 \textcolor{preprocessor}{#endif}
1232 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1233    \textcolor{comment}{//RSA-PSS algorithm identifier?}
1234    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
1235    \{
1236       \textcolor{comment}{//RSA-PSS does not require any additional parameters}
1237       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1238    \}
1239    \textcolor{keywordflow}{else}
1240 \textcolor{preprocessor}{#endif}
1241 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1242    \textcolor{comment}{//DSA algorithm identifier?}
1243    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
1244    \{
1245       \textcolor{comment}{//Read DsaParameters structure}
1246       error = \hyperlink{certificate_2x509__cert__parse_8c_afa7c44bc9c776d4bdb4a03519ef894a5}{x509ParseDsaParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
1247          &subjectPublicKeyInfo->dsaParams);
1248    \}
1249    \textcolor{keywordflow}{else}
1250 \textcolor{preprocessor}{#endif}
1251 \textcolor{preprocessor}{#if (X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED)}
1252    \textcolor{comment}{//EC public key identifier?}
1253    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
1254    \{
1255       \textcolor{comment}{//Read ECParameters structure}
1256       error = \hyperlink{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}{x509ParseEcParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
1257          &subjectPublicKeyInfo->ecParams);
1258    \}
1259    \textcolor{keywordflow}{else}
1260 \textcolor{preprocessor}{#endif}
1261 \textcolor{preprocessor}{#if (X509\_ED25519\_SUPPORT == ENABLED && ED25519\_SUPPORT == ENABLED)}
1262    \textcolor{comment}{//X25519 or Ed25519 algorithm identifier?}
1263    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID})) ||
1264       !\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
1265    \{
1266       \textcolor{comment}{//For all of the OIDs, the parameters are absent}
1267       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1268    \}
1269    \textcolor{keywordflow}{else}
1270 \textcolor{preprocessor}{#endif}
1271 \textcolor{preprocessor}{#if (X509\_ED448\_SUPPORT == ENABLED && ED448\_SUPPORT == ENABLED)}
1272    \textcolor{comment}{//X448 or Ed448 algorithm identifier?}
1273    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID})) ||
1274       !\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
1275    \{
1276       \textcolor{comment}{//For all of the OIDs, the parameters are absent}
1277       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1278    \}
1279    \textcolor{keywordflow}{else}
1280 \textcolor{preprocessor}{#endif}
1281    \textcolor{comment}{//The certificate does not contain any valid public key...}
1282    \{
1283       \textcolor{comment}{//Report an error}
1284       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
1285    \}
1286 
1287    \textcolor{comment}{//Return status code}
1288    \textcolor{keywordflow}{return} error;
1289 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_afa7c44bc9c776d4bdb4a03519ef894a5}\label{x509__key__parse_8h_afa7c44bc9c776d4bdb4a03519ef894a5}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Dsa\+Parameters@{x509\+Parse\+Dsa\+Parameters}}
\index{x509\+Parse\+Dsa\+Parameters@{x509\+Parse\+Dsa\+Parameters}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Dsa\+Parameters()}{x509ParseDsaParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Dsa\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509DsaParameters}{X509\+Dsa\+Parameters} $\ast$}]{dsa\+Params }\end{DoxyParamCaption})}



Parse D\+SA domain parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em dsa\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1373 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1375 \{
1376 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1377    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1378    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1379 
1380    \textcolor{comment}{//Debug message}
1381    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing DSAParameters...\(\backslash\)r\(\backslash\)n"});
1382 
1383    \textcolor{comment}{//Read DSAParameters structure}
1384    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1385    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1386    \textcolor{keywordflow}{if}(error)
1387       \textcolor{keywordflow}{return} error;
1388 
1389    \textcolor{comment}{//Point to the first field}
1390    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1391    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1392 
1393    \textcolor{comment}{//Read the parameter p}
1394    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1395    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1396    \textcolor{keywordflow}{if}(error)
1397       \textcolor{keywordflow}{return} error;
1398 
1399    \textcolor{comment}{//Enforce encoding, class and type}
1400    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1401    \textcolor{comment}{//Invalid tag?}
1402    \textcolor{keywordflow}{if}(error)
1403       \textcolor{keywordflow}{return} error;
1404 
1405    \textcolor{comment}{//Save the parameter p}
1406    dsaParams->\hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1407    dsaParams->\hyperlink{structX509DsaParameters_a492453aa50210c40372c6d76ff955c7f}{pLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1408 
1409    \textcolor{comment}{//Point to the next field}
1410    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1411    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1412 
1413    \textcolor{comment}{//Read the parameter q}
1414    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1415    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1416    \textcolor{keywordflow}{if}(error)
1417       \textcolor{keywordflow}{return} error;
1418 
1419    \textcolor{comment}{//Enforce encoding, class and type}
1420    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1421    \textcolor{comment}{//Invalid tag?}
1422    \textcolor{keywordflow}{if}(error)
1423       \textcolor{keywordflow}{return} error;
1424 
1425    \textcolor{comment}{//Save the parameter q}
1426    dsaParams->\hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1427    dsaParams->\hyperlink{structX509DsaParameters_a2cb0e6cf41cb0b07dfccedc79bce007e}{qLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1428 
1429    \textcolor{comment}{//Point to the next field}
1430    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1431    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1432 
1433    \textcolor{comment}{//Read the parameter g}
1434    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1435    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1436    \textcolor{keywordflow}{if}(error)
1437       \textcolor{keywordflow}{return} error;
1438 
1439    \textcolor{comment}{//Enforce encoding, class and type}
1440    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1441    \textcolor{comment}{//Invalid tag?}
1442    \textcolor{keywordflow}{if}(error)
1443       \textcolor{keywordflow}{return} error;
1444 
1445    \textcolor{comment}{//Save the parameter g}
1446    dsaParams->\hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1447    dsaParams->\hyperlink{structX509DsaParameters_a84e6f3a0159da3fff5bf9315be4cf5f7}{gLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1448 
1449    \textcolor{comment}{//Successful processing}
1450    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1451 \textcolor{preprocessor}{#else}
1452    \textcolor{comment}{//Not implemented}
1453    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1454 \textcolor{preprocessor}{#endif}
1455 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a3d52f72e0b1285700bcc30b5b6b54ac1}\label{x509__key__parse_8h_a3d52f72e0b1285700bcc30b5b6b54ac1}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Dsa\+Public\+Key@{x509\+Parse\+Dsa\+Public\+Key}}
\index{x509\+Parse\+Dsa\+Public\+Key@{x509\+Parse\+Dsa\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Dsa\+Public\+Key()}{x509ParseDsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Dsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509DsaPublicKey}{X509\+Dsa\+Public\+Key} $\ast$}]{dsa\+Public\+Key }\end{DoxyParamCaption})}



Parse D\+S\+A\+Public\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em dsa\+Public\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1466 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1468 \{
1469 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1470    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1471    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1472 
1473    \textcolor{comment}{//Debug message}
1474    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing DSAPublicKey...\(\backslash\)r\(\backslash\)n"});
1475 
1476    \textcolor{comment}{//Read DSAPublicKey structure}
1477    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1478    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1479    \textcolor{keywordflow}{if}(error)
1480       \textcolor{keywordflow}{return} error;
1481 
1482    \textcolor{comment}{//Enforce encoding, class and type}
1483    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1484    \textcolor{comment}{//Invalid tag?}
1485    \textcolor{keywordflow}{if}(error)
1486       \textcolor{keywordflow}{return} error;
1487 
1488    \textcolor{comment}{//Save the DSA public value}
1489    dsaPublicKey->\hyperlink{structX509DsaPublicKey_a8a2e4dd10c344dfeae0d55487b2bfce8}{y} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1490    dsaPublicKey->\hyperlink{structX509DsaPublicKey_ae8ad5e10e6090c0b95a083b49efe18b2}{yLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1491 
1492    \textcolor{comment}{//Successful processing}
1493    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1494 \textcolor{preprocessor}{#else}
1495    \textcolor{comment}{//Not implemented}
1496    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1497 \textcolor{preprocessor}{#endif}
1498 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a2caeec4d90cfecef949ee31dcaefaf83}\label{x509__key__parse_8h_a2caeec4d90cfecef949ee31dcaefaf83}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Ec\+Parameters@{x509\+Parse\+Ec\+Parameters}}
\index{x509\+Parse\+Ec\+Parameters@{x509\+Parse\+Ec\+Parameters}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ec\+Parameters()}{x509ParseEcParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ec\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$}]{ec\+Params }\end{DoxyParamCaption})}



Parse E\+C\+Parameters structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ec\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1509 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1511 \{
1512 \textcolor{preprocessor}{#if (X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED)}
1513    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1514    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1515 
1516    \textcolor{comment}{//Debug message}
1517    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing ECParameters...\(\backslash\)r\(\backslash\)n"});
1518 
1519    \textcolor{comment}{//Read namedCurve field}
1520    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1521    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1522    \textcolor{keywordflow}{if}(error)
1523       \textcolor{keywordflow}{return} error;
1524 
1525    \textcolor{comment}{//The namedCurve field identifies all the required values for a particular}
1526    \textcolor{comment}{//set of elliptic curve domain parameters to be represented by an object}
1527    \textcolor{comment}{//identifier}
1528    ecParams->\hyperlink{structX509EcParameters_a122c5387fb2f12374a905ecfd2ca4c86}{namedCurve} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1529    ecParams->\hyperlink{structX509EcParameters_ac58081bd63ed68d0cb101ff7e65667ec}{namedCurveLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1530 
1531    \textcolor{comment}{//Successful processing}
1532    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1533 \textcolor{preprocessor}{#else}
1534    \textcolor{comment}{//Not implemented}
1535    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1536 \textcolor{preprocessor}{#endif}
1537 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_ae09cd9fb14828d4666570022bdf094ab}\label{x509__key__parse_8h_ae09cd9fb14828d4666570022bdf094ab}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Ec\+Public\+Key@{x509\+Parse\+Ec\+Public\+Key}}
\index{x509\+Parse\+Ec\+Public\+Key@{x509\+Parse\+Ec\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ec\+Public\+Key()}{x509ParseEcPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ec\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509EcPublicKey}{X509\+Ec\+Public\+Key} $\ast$}]{ec\+Public\+Key }\end{DoxyParamCaption})}



Parse E\+C\+Public\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ec\+Public\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1548 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1550 \{
1551 \textcolor{preprocessor}{#if ((X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED) || \(\backslash\)}
1552 \textcolor{preprocessor}{   (X509\_ED25519\_SUPPORT == ENABLED && ED25519\_SUPPORT == ENABLED) || \(\backslash\)}
1553 \textcolor{preprocessor}{   (X509\_ED448\_SUPPORT == ENABLED && ED448\_SUPPORT == ENABLED))}
1554    \textcolor{comment}{//Debug message}
1555    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ECPublicKey...\(\backslash\)r\(\backslash\)n"});
1556 
1557    \textcolor{comment}{//Make sure the EC public key is valid}
1558    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1559       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
1560 
1561    \textcolor{comment}{//Save the EC public key}
1562    ecPublicKey->\hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
1563    ecPublicKey->\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1564 
1565    \textcolor{comment}{//Successful processing}
1566    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1567 \textcolor{preprocessor}{#else}
1568    \textcolor{comment}{//Not implemented}
1569    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1570 \textcolor{preprocessor}{#endif}
1571 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a695e24dfcc2e5669cb0ad6068298ce3f}\label{x509__key__parse_8h_a695e24dfcc2e5669cb0ad6068298ce3f}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Rsa\+Pss\+Hash\+Algo@{x509\+Parse\+Rsa\+Pss\+Hash\+Algo}}
\index{x509\+Parse\+Rsa\+Pss\+Hash\+Algo@{x509\+Parse\+Rsa\+Pss\+Hash\+Algo}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Hash\+Algo()}{x509ParseRsaPssHashAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Hash\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS hash algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 541 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
543 \{
544 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
546    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
547 
548    \textcolor{comment}{//Read the contents of the structure}
549    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
550    \textcolor{comment}{//Failed to decode ASN.1 tag?}
551    \textcolor{keywordflow}{if}(error)
552       \textcolor{keywordflow}{return} error;
553 
554    \textcolor{comment}{//Point to the first field of the sequence}
555    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
556    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
557 
558    \textcolor{comment}{//Read hash algorithm identifier}
559    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
560    \textcolor{comment}{//Failed to decode ASN.1 tag?}
561    \textcolor{keywordflow}{if}(error)
562       \textcolor{keywordflow}{return} error;
563 
564    \textcolor{comment}{//Save the hash algorithm identifier}
565    rsaPssParams->\hyperlink{structX509RsaPssParameters_a21f002c671582b73f60617bc23116db3}{hashAlgo} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
566    rsaPssParams->\hyperlink{structX509RsaPssParameters_a91b731f749a7d1bfafbb8595f898ff2e}{hashAlgoLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
567 
568    \textcolor{comment}{//No error to report}
569    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
570 \textcolor{preprocessor}{#else}
571    \textcolor{comment}{//Not implemented}
572    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
573 \textcolor{preprocessor}{#endif}
574 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_aa5112ced5c08b4f31070b83a7f87b330}\label{x509__key__parse_8h_aa5112ced5c08b4f31070b83a7f87b330}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo@{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo}}
\index{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo@{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo()}{x509ParseRsaPssMaskGenAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS mask generation algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 511 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
513 \{
514    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
515    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
516 
517    \textcolor{comment}{//Read the contents of the structure}
518    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
519    \textcolor{comment}{//Failed to decode ASN.1 tag?}
520    \textcolor{keywordflow}{if}(error)
521       \textcolor{keywordflow}{return} error;
522 
523    \textcolor{comment}{//Point to the first field of the sequence}
524    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
525    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
526 
527    \textcolor{comment}{//Read mask generation algorithm identifier}
528    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
529    \textcolor{comment}{//Failed to decode ASN.1 tag?}
530    \textcolor{keywordflow}{if}(error)
531       \textcolor{keywordflow}{return} error;
532 
533    \textcolor{comment}{//Save the mask generation algorithm identifier}
534    rsaPssParams->\hyperlink{structX509RsaPssParameters_a7f95c185598c0a6b7e69400d96898967}{maskGenAlgo} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
535    rsaPssParams->\hyperlink{structX509RsaPssParameters_a212c882582b2c33fff6206a7a8872b7d}{maskGenAlgoLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
536 
537    \textcolor{comment}{//Point to the next field}
538    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
539    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
540 
541    \textcolor{comment}{//Read the algorithm identifier of the one-way hash function employed}
542    \textcolor{comment}{//with the mask generation function}
543    error = \hyperlink{x509__key__parse_8c_a65e7c656a4fe02a8f5cfb6ef873f0834}{x509ParseRsaPssMaskGenHashAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, rsaPssParams);
544    \textcolor{comment}{//Any error to report?}
545    \textcolor{keywordflow}{if}(error)
546       \textcolor{keywordflow}{return} error;
547 
548    \textcolor{comment}{//No error to report}
549    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
550 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a65e7c656a4fe02a8f5cfb6ef873f0834}\label{x509__key__parse_8h_a65e7c656a4fe02a8f5cfb6ef873f0834}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo@{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo}}
\index{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo@{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo()}{x509ParseRsaPssMaskGenHashAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Mask\+Gen\+Hash\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS mask generation hash algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 561 of file x509\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
563 \{
564    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
565    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
566 
567    \textcolor{comment}{//Read the contents of the structure}
568    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
569    \textcolor{comment}{//Failed to decode ASN.1 tag?}
570    \textcolor{keywordflow}{if}(error)
571       \textcolor{keywordflow}{return} error;
572 
573    \textcolor{comment}{//Point to the first field of the sequence}
574    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
575    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
576 
577    \textcolor{comment}{//Read the algorithm identifier of the one-way hash function employed}
578    \textcolor{comment}{//with the mask generation function}
579    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
580    \textcolor{comment}{//Failed to decode ASN.1 tag?}
581    \textcolor{keywordflow}{if}(error)
582       \textcolor{keywordflow}{return} error;
583 
584    \textcolor{comment}{//Save the hash algorithm identifier}
585    rsaPssParams->\hyperlink{structX509RsaPssParameters_aee2673db47b0dce26a8bc9e2c2a51942}{maskGenHashAlgo} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
586    rsaPssParams->\hyperlink{structX509RsaPssParameters_a10553f3c1ae38188028f4dbd33f5fb8a}{maskGenHashAlgoLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
587 
588    \textcolor{comment}{//No error to report}
589    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
590 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_aad327c7f3da9180fbf94b8e4363bda40}\label{x509__key__parse_8h_aad327c7f3da9180fbf94b8e4363bda40}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Rsa\+Pss\+Parameters@{x509\+Parse\+Rsa\+Pss\+Parameters}}
\index{x509\+Parse\+Rsa\+Pss\+Parameters@{x509\+Parse\+Rsa\+Pss\+Parameters}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Parameters()}{x509ParseRsaPssParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 466 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
468 \{
469 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
470    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
471    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
472 
473 \textcolor{preprocessor}{#if(X509\_SHA1\_SUPPORT == ENABLED && SHA1\_SUPPORT == ENABLED)}
474    \textcolor{comment}{//The default hash algorithm is SHA-1 (refer to RFC 4055, section 3.1)}
475    rsaPssParams->\hyperlink{structX509RsaPssParameters_a21f002c671582b73f60617bc23116db3}{hashAlgo} = \hyperlink{sha1_8h_ab109ac10e322227e63da00290a746a44}{SHA1\_OID};
476    rsaPssParams->\hyperlink{structX509RsaPssParameters_a91b731f749a7d1bfafbb8595f898ff2e}{hashAlgoLen} = \textcolor{keyword}{sizeof}(\hyperlink{sha1_8h_ab109ac10e322227e63da00290a746a44}{SHA1\_OID});
477 \textcolor{preprocessor}{#endif}
478 
479    \textcolor{comment}{//The default length of the salt is 20 (refer to RFC 4055, section 3.1)}
480    rsaPssParams->\hyperlink{structX509RsaPssParameters_a0472b015828361df56b2550e4c1ac220}{saltLen} = 20;
481 
482    \textcolor{comment}{//Read the contents of the structure}
483    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
484    \textcolor{comment}{//Failed to decode ASN.1 tag?}
485    \textcolor{keywordflow}{if}(error)
486       \textcolor{keywordflow}{return} error;
487 
488    \textcolor{comment}{//Point to the first field of the sequence}
489    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
490    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
491 
492    \textcolor{comment}{//Parse RSASSA-PSS parameters}
493    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
494    \{
495       \textcolor{comment}{//Read current parameter}
496       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
497       \textcolor{comment}{//Failed to decode ASN.1 tag?}
498       \textcolor{keywordflow}{if}(error)
499          \textcolor{keywordflow}{return} error;
500 
501       \textcolor{comment}{//The tags in this sequence are explicit}
502       \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC}, 
      0))
503       \{
504          \textcolor{comment}{//Parse hashAlgorithm field}
505          error = \hyperlink{certificate_2x509__cert__parse_8c_a695e24dfcc2e5669cb0ad6068298ce3f}{x509ParseRsaPssHashAlgo}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, rsaPssParams);
506          \textcolor{comment}{//Any error to report?}
507          \textcolor{keywordflow}{if}(error)
508             \textcolor{keywordflow}{return} error;
509       \}
510       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, 
      \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC}, 2))
511       \{
512          \textcolor{comment}{//Parse saltLength field}
513          error = \hyperlink{certificate_2x509__cert__parse_8c_aa9f385740a40d71e149e795c3bb3e4e0}{x509ParseRsaPssSaltLength}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, rsaPssParams);
514          \textcolor{comment}{//Any error to report?}
515          \textcolor{keywordflow}{if}(error)
516             \textcolor{keywordflow}{return} error;
517       \}
518 
519       \textcolor{comment}{//Next parameter}
520       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
521       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
522    \}
523 
524    \textcolor{comment}{//Successful processing}
525    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
526 \textcolor{preprocessor}{#else}
527    \textcolor{comment}{//Not implemented}
528    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
529 \textcolor{preprocessor}{#endif}
530 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_aa9f385740a40d71e149e795c3bb3e4e0}\label{x509__key__parse_8h_aa9f385740a40d71e149e795c3bb3e4e0}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Rsa\+Pss\+Salt\+Length@{x509\+Parse\+Rsa\+Pss\+Salt\+Length}}
\index{x509\+Parse\+Rsa\+Pss\+Salt\+Length@{x509\+Parse\+Rsa\+Pss\+Salt\+Length}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Salt\+Length()}{x509ParseRsaPssSaltLength()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Salt\+Length (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS salt length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 585 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
587 \{
588 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
589    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
590    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} saltLen;
591    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
592 
593    \textcolor{comment}{//Read the saltLength field}
594    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &saltLen);
595    \textcolor{comment}{//Failed to decode ASN.1 tag?}
596    \textcolor{keywordflow}{if}(error)
597       \textcolor{keywordflow}{return} error;
598 
599    \textcolor{comment}{//Sanity check}
600    \textcolor{keywordflow}{if}(saltLen < 0)
601       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
602 
603    \textcolor{comment}{//Save the length of the salt}
604    rsaPssParams->\hyperlink{structX509RsaPssParameters_a0472b015828361df56b2550e4c1ac220}{saltLen} = saltLen;
605 
606    \textcolor{comment}{//No error to report}
607    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
608 \textcolor{preprocessor}{#else}
609    \textcolor{comment}{//Not implemented}
610    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
611 \textcolor{preprocessor}{#endif}
612 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a9af828c1f9152b3f008a9334d071bac2}\label{x509__key__parse_8h_a9af828c1f9152b3f008a9334d071bac2}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Rsa\+Public\+Key@{x509\+Parse\+Rsa\+Public\+Key}}
\index{x509\+Parse\+Rsa\+Public\+Key@{x509\+Parse\+Rsa\+Public\+Key}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Public\+Key()}{x509ParseRsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPublicKey}{X509\+Rsa\+Public\+Key} $\ast$}]{rsa\+Public\+Key }\end{DoxyParamCaption})}



Parse R\+S\+A\+Public\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Public\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1300 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1302 \{
1303 \textcolor{preprocessor}{#if (X509\_RSA\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1304    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1305    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1306 
1307    \textcolor{comment}{//Debug message}
1308    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing RSAPublicKey...\(\backslash\)r\(\backslash\)n"});
1309 
1310    \textcolor{comment}{//Read RSAPublicKey structure}
1311    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1312    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1313    \textcolor{keywordflow}{if}(error)
1314       \textcolor{keywordflow}{return} error;
1315 
1316    \textcolor{comment}{//Point to the first field}
1317    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1318    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1319 
1320    \textcolor{comment}{//Read Modulus field}
1321    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1322    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1323    \textcolor{keywordflow}{if}(error)
1324       \textcolor{keywordflow}{return} error;
1325 
1326    \textcolor{comment}{//Enforce encoding, class and type}
1327    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1328    \textcolor{comment}{//Invalid tag?}
1329    \textcolor{keywordflow}{if}(error)
1330       \textcolor{keywordflow}{return} error;
1331 
1332    \textcolor{comment}{//Get the modulus}
1333    rsaPublicKey->\hyperlink{structX509RsaPublicKey_acda40dfd0c6f2b68e0ba227e59bfb727}{n} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1334    rsaPublicKey->\hyperlink{structX509RsaPublicKey_a8311e7f5f00c9faaf36640f9dbd7cdb5}{nLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1335 
1336    \textcolor{comment}{//Point to the next field}
1337    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1338    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1339 
1340    \textcolor{comment}{//Read PublicExponent field}
1341    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1342    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1343    \textcolor{keywordflow}{if}(error)
1344       \textcolor{keywordflow}{return} error;
1345 
1346    \textcolor{comment}{//Enforce encoding, class and type}
1347    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1348    \textcolor{comment}{//Invalid tag?}
1349    \textcolor{keywordflow}{if}(error)
1350       \textcolor{keywordflow}{return} error;
1351 
1352    \textcolor{comment}{//Get the public exponent}
1353    rsaPublicKey->\hyperlink{structX509RsaPublicKey_a13db0b045295934879aa34cea8996ef6}{e} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1354    rsaPublicKey->\hyperlink{structX509RsaPublicKey_af531c21f55e40fb06165cd151dd96fa4}{eLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1355 
1356    \textcolor{comment}{//Successful processing}
1357    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1358 \textcolor{preprocessor}{#else}
1359    \textcolor{comment}{//Not implemented}
1360    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1361 \textcolor{preprocessor}{#endif}
1362 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__key__parse_8h_a17bacf95e872d7fdcd6cec43b1724dd6}\label{x509__key__parse_8h_a17bacf95e872d7fdcd6cec43b1724dd6}} 
\index{x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}!x509\+Parse\+Subject\+Public\+Key\+Info@{x509\+Parse\+Subject\+Public\+Key\+Info}}
\index{x509\+Parse\+Subject\+Public\+Key\+Info@{x509\+Parse\+Subject\+Public\+Key\+Info}!x509\+\_\+key\+\_\+parse.\+h@{x509\+\_\+key\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Public\+Key\+Info()}{x509ParseSubjectPublicKeyInfo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Public\+Key\+Info (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{public\+Key\+Info }\end{DoxyParamCaption})}



Parse Subject\+Public\+Key\+Info structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em subject\+Public\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em public\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1045 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1047 \{
1048    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1049    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1050    \textcolor{keywordtype}{size\_t} oidLen;
1051    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid};
1052    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1053 
1054    \textcolor{comment}{//Debug message}
1055    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SubjectPublicKeyInfo...\(\backslash\)r\(\backslash\)n"});
1056 
1057    \textcolor{comment}{//Read SubjectPublicKeyInfo field}
1058    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1059    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1060    \textcolor{keywordflow}{if}(error)
1061       \textcolor{keywordflow}{return} error;
1062 
1063    \textcolor{comment}{//Save the total length of the field}
1064    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1065 
1066    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1067    subjectPublicKeyInfo->rawData = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
1068    subjectPublicKeyInfo->rawDataLen = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1069 
1070    \textcolor{comment}{//Point to the first field}
1071    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1072    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1073 
1074    \textcolor{comment}{//Read AlgorithmIdentifier field}
1075    error = \hyperlink{certificate_2x509__cert__parse_8c_a2de67fd41226a162fa5f3fb14539108f}{x509ParseAlgorithmIdentifier}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, subjectPublicKeyInfo);
1076    \textcolor{comment}{//Any error to report?}
1077    \textcolor{keywordflow}{if}(error)
1078       \textcolor{keywordflow}{return} error;
1079 
1080    \textcolor{comment}{//Point to the next field}
1081    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1082    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1083 
1084    \textcolor{comment}{//The SubjectPublicKey structure is encapsulated within a bit string}
1085    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1086    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1087    \textcolor{keywordflow}{if}(error)
1088       \textcolor{keywordflow}{return} error;
1089 
1090    \textcolor{comment}{//Enforce encoding, class and type}
1091    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
1092    \textcolor{comment}{//Invalid tag?}
1093    \textcolor{keywordflow}{if}(error)
1094       \textcolor{keywordflow}{return} error;
1095 
1096    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
1097    \textcolor{comment}{//of unused bits in the final subsequent octet}
1098    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1 || tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] != 0x00)
1099       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1100 
1101    \textcolor{comment}{//Retrieve signature algorithm identifier}
1102    oid = subjectPublicKeyInfo->oid;
1103    oidLen = subjectPublicKeyInfo->oidLen;
1104 
1105 \textcolor{preprocessor}{#if (X509\_RSA\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1106    \textcolor{comment}{//RSA algorithm identifier?}
1107    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})))
1108    \{
1109       \textcolor{comment}{//Read RSAPublicKey structure}
1110       error = \hyperlink{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}{x509ParseRsaPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1111          &subjectPublicKeyInfo->rsaPublicKey);
1112    \}
1113    \textcolor{keywordflow}{else}
1114 \textcolor{preprocessor}{#endif}
1115 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1116    \textcolor{comment}{//RSA-PSS algorithm identifier?}
1117    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
1118    \{
1119       \textcolor{comment}{//Read RSAPublicKey structure}
1120       error = \hyperlink{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}{x509ParseRsaPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1121          &subjectPublicKeyInfo->rsaPublicKey);
1122    \}
1123    \textcolor{keywordflow}{else}
1124 \textcolor{preprocessor}{#endif}
1125 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1126    \textcolor{comment}{//DSA algorithm identifier?}
1127    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
1128    \{
1129       \textcolor{comment}{//Read DSAPublicKey structure}
1130       error = \hyperlink{certificate_2x509__cert__parse_8c_a3d52f72e0b1285700bcc30b5b6b54ac1}{x509ParseDsaPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1131          &subjectPublicKeyInfo->dsaPublicKey);
1132    \}
1133    \textcolor{keywordflow}{else}
1134 \textcolor{preprocessor}{#endif}
1135 \textcolor{preprocessor}{#if (X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED)}
1136    \textcolor{comment}{//EC public key identifier?}
1137    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
1138    \{
1139       \textcolor{comment}{//Read ECPublicKey structure}
1140       error = \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509ParseEcPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1141          &subjectPublicKeyInfo->ecPublicKey);
1142    \}
1143    \textcolor{keywordflow}{else}
1144 \textcolor{preprocessor}{#endif}
1145 \textcolor{preprocessor}{#if (X509\_ED25519\_SUPPORT == ENABLED && ED25519\_SUPPORT == ENABLED)}
1146    \textcolor{comment}{//X25519 or Ed25519 algorithm identifier?}
1147    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID})) ||
1148       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
1149    \{
1150       \textcolor{comment}{//Read ECPublicKey structure}
1151       error = \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509ParseEcPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1152          &subjectPublicKeyInfo->ecPublicKey);
1153    \}
1154    \textcolor{keywordflow}{else}
1155 \textcolor{preprocessor}{#endif}
1156 \textcolor{preprocessor}{#if (X509\_ED448\_SUPPORT == ENABLED && ED448\_SUPPORT == ENABLED)}
1157    \textcolor{comment}{//X448 or Ed448 algorithm identifier?}
1158    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID})) ||
1159       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
1160    \{
1161       \textcolor{comment}{//Read ECPublicKey structure}
1162       error = \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509ParseEcPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1163          &subjectPublicKeyInfo->ecPublicKey);
1164    \}
1165    \textcolor{keywordflow}{else}
1166 \textcolor{preprocessor}{#endif}
1167    \textcolor{comment}{//The certificate does not contain any valid public key...}
1168    \{
1169       \textcolor{comment}{//Report an error}
1170       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
1171    \}
1172 
1173    \textcolor{comment}{//Return status code}
1174    \textcolor{keywordflow}{return} error;
1175 \}
\end{DoxyCode}
