\hypertarget{coap__option_8c}{}\section{cyclone\+\_\+tcp/coap/coap\+\_\+option.c File Reference}
\label{coap__option_8c}\index{cyclone\+\_\+tcp/coap/coap\+\_\+option.\+c@{cyclone\+\_\+tcp/coap/coap\+\_\+option.\+c}}


Co\+AP option formatting and parsing.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}coap/coap\+\_\+client.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}coap/coap\+\_\+option.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{coap__option_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_a7725033334034dcb4eb808f148f791fb}{C\+O\+A\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a2c821303d697ba7fb5ae13fe449ee1a2}{coap\+Parse\+Options} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$consumed)
\begin{DoxyCompactList}\small\item\em Parse the list of Co\+AP options. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coap\+Parse\+Option} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} prev\+Option\+Num, \hyperlink{structCoapOption}{Coap\+Option} $\ast$option, size\+\_\+t $\ast$consumed)
\begin{DoxyCompactList}\small\item\em Parse Co\+AP option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}{coap\+Format\+Option} (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} prev\+Option\+Num, \hyperlink{structCoapOption}{Coap\+Option} $\ast$option, size\+\_\+t $\ast$written)
\begin{DoxyCompactList}\small\item\em Format Co\+AP option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_ac85bcf585186dad1590600b012bb6306}{coap\+Set\+Option} (\hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} option\+Index, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$option\+Value, size\+\_\+t option\+Len)
\begin{DoxyCompactList}\small\item\em Add an option to the specified Co\+AP message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a91f101e0e5423c2a63513028664b9152}{coap\+Set\+Uint\+Option} (\hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} option\+Index, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} option\+Value)
\begin{DoxyCompactList}\small\item\em Add a uint option to the specified Co\+AP message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a2ca7f6e12a7410553748b0c63f3a2c5f}{coap\+Get\+Option} (const \hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} option\+Index, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$$\ast$option\+Value, size\+\_\+t $\ast$option\+Len)
\begin{DoxyCompactList}\small\item\em Get the value of the specified option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a4098de0a9fbec04954546ce1978572d9}{coap\+Get\+Uint\+Option} (const \hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} option\+Index, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$option\+Value)
\begin{DoxyCompactList}\small\item\em Get the value of the specified uint option. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a3e993d9bb8e13c9209934cc78db79e70}{coap\+Delete\+Option} (\hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} option\+Index)
\begin{DoxyCompactList}\small\item\em Remove an option from the specified Co\+AP message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_a5290b7f4d6589e73860b03a660d33cb1}{coap\+Split\+Repeatable\+Option} (\hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$option\+Value, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} separator)
\begin{DoxyCompactList}\small\item\em Encode a path or query component into multiple repeatable options. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{coap__option_8c_aed9b91fe21f215447138d088edbd6050}{coap\+Join\+Repeatable\+Option} (const \hyperlink{structCoapMessage}{Coap\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$option\+Value, size\+\_\+t max\+Len, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} separator)
\begin{DoxyCompactList}\small\item\em Decode a path or query component from multiple repeatable options. \end{DoxyCompactList}\item 
const \hyperlink{structCoapOptionParameters}{Coap\+Option\+Parameters} $\ast$ \hyperlink{coap__option_8c_a1ebd1045f145d9d0bea23ee12ad4fc49}{coap\+Get\+Option\+Parameters} (\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} option\+Num)
\begin{DoxyCompactList}\small\item\em Retrieve parameters for a given option number. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCoapOptionParameters}{Coap\+Option\+Parameters} \hyperlink{coap__option_8c_a5c68dcd0b43760bf767cd229833c7a24}{coap\+Option\+List} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em List of supported Co\+AP options. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Co\+AP option formatting and parsing. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{coap__option_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{coap__option_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_a7725033334034dcb4eb808f148f791fb}{C\+O\+A\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file coap\+\_\+option.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{coap__option_8c_a3e993d9bb8e13c9209934cc78db79e70}\label{coap__option_8c_a3e993d9bb8e13c9209934cc78db79e70}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Delete\+Option@{coap\+Delete\+Option}}
\index{coap\+Delete\+Option@{coap\+Delete\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Delete\+Option()}{coapDeleteOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Delete\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{option\+Index }\end{DoxyParamCaption})}



Remove an option from the specified Co\+AP message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\mbox{\tt in}  & {\em option\+Index} & Occurrence index (for repeatable options only) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 688 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
690 \{
691    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
692    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} found;
693    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
694    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
695    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
696    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} index;
697    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} prevOptionNum;
698    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
699    \hyperlink{structCoapOption}{CoapOption} option;
700 
701    \textcolor{comment}{//Initialize variables}
702    found = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
703    index = 0;
704 
705    \textcolor{comment}{//Point to the first byte of the CoAP message}
706    p = message->\hyperlink{structCoapMessage_ab8ec8f8181bf0b24d5d63f6701df0ecf}{buffer};
707    \textcolor{comment}{//Retrieve the length of the message}
708    length = message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length};
709 
710    \textcolor{comment}{//Parse message header}
711    error = \hyperlink{coap__message_8c_a2cc8b59729ae7fe5e0953dd1febc7f50}{coapParseMessageHeader}(p, length, &n);
712    \textcolor{comment}{//Any error to report?}
713    \textcolor{keywordflow}{if}(error)
714       \textcolor{keywordflow}{return} error;
715 
716    \textcolor{comment}{//Point to the first option of the message}
717    p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
718    \textcolor{comment}{//Number of bytes left to process}
719    length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
720 
721    \textcolor{comment}{//For the first option in a message, a preceding option instance with}
722    \textcolor{comment}{//Option Number zero is assumed}
723    prevOptionNum = 0;
724 
725    \textcolor{comment}{//Loop through CoAP options}
726    \textcolor{keywordflow}{while}(length > 0)
727    \{
728       \textcolor{comment}{//Payload marker found?}
729       \textcolor{keywordflow}{if}(*p == \hyperlink{coap__common_8h_ab4e38910080deed0a5df4aec116d3999}{COAP\_PAYLOAD\_MARKER})
730          \textcolor{keywordflow}{break};
731 
732       \textcolor{comment}{//Parse current option}
733       error = \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coapParseOption}(p, length, prevOptionNum, &option, &n);
734       \textcolor{comment}{//Any error to report?}
735       \textcolor{keywordflow}{if}(error)
736          \textcolor{keywordflow}{return} error;
737 
738       \textcolor{comment}{//Options are inserted in ascending order}
739       \textcolor{keywordflow}{if}(option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} > optionNum)
740          \textcolor{keywordflow}{break};
741 
742       \textcolor{comment}{//Matching option number?}
743       \textcolor{keywordflow}{if}(option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} == optionNum)
744       \{
745          \textcolor{comment}{//Matching occurrence found?}
746          \textcolor{keywordflow}{if}(index++ == optionIndex)
747          \{
748             \textcolor{comment}{//The current option will be removed}
749             found = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
750             \textcolor{keywordflow}{break};
751          \}
752       \}
753 
754       \textcolor{comment}{//Keep track of the current option number}
755       prevOptionNum = option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number};
756 
757       \textcolor{comment}{//Jump to the next option}
758       p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
759       length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
760    \}
761 
762    \textcolor{comment}{//Check whether the option has been found}
763    \textcolor{keywordflow}{if}(found)
764    \{
765       \textcolor{comment}{//Remove the current occurrence of the option}
766       memmove(p, p + n, length - n);
767       \textcolor{comment}{//Number of bytes left to process}
768       length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
769       \textcolor{comment}{//Adjust the length of the CoAP message}
770       message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
771 
772       \textcolor{comment}{//Check whether another CoAP option is following}
773       \textcolor{keywordflow}{if}(length > 0 && *p != \hyperlink{coap__common_8h_ab4e38910080deed0a5df4aec116d3999}{COAP\_PAYLOAD\_MARKER})
774       \{
775          \textcolor{comment}{//Parse the following option}
776          error = \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coapParseOption}(p, length, optionNum, &option, &n);
777          \textcolor{comment}{//Any error to report?}
778          \textcolor{keywordflow}{if}(error)
779             \textcolor{keywordflow}{return} error;
780 
781          \textcolor{comment}{//The first pass calculates the required length}
782          error = \hyperlink{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}{coapFormatOption}(\hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, prevOptionNum, &option, &m);
783          \textcolor{comment}{//Any error to report?}
784          \textcolor{keywordflow}{if}(error)
785             \textcolor{keywordflow}{return} error;
786 
787          \textcolor{comment}{//Test if the length of the option has changed}
788          \textcolor{keywordflow}{if}(m > n)
789          \{
790             \textcolor{comment}{//Move the rest of the CoAP message}
791             memmove(p + m - option.\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length}, p + n - option.\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length},
792                length + option.\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} - n);
793 
794             \textcolor{comment}{//Fix the value of the option}
795             option.\hyperlink{structCoapOption_ac57cd3a56c1d18248b7f6d3a5a827aeb}{value} += m - \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
796             \textcolor{comment}{//Fix the length of the message}
797             message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length} += m - \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
798          \}
799 
800          \textcolor{comment}{//The second pass fixes the Option Delta field}
801          error = \hyperlink{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}{coapFormatOption}(p, prevOptionNum, &option, &m);
802          \textcolor{comment}{//Any error to report?}
803          \textcolor{keywordflow}{if}(error)
804             \textcolor{keywordflow}{return} error;
805       \}
806    \}
807 
808    \textcolor{comment}{//Return status code}
809    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
810 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}\label{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Format\+Option@{coap\+Format\+Option}}
\index{coap\+Format\+Option@{coap\+Format\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Format\+Option()}{coapFormatOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Format\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{prev\+Option\+Num,  }\item[{\hyperlink{structCoapOption}{Coap\+Option} $\ast$}]{option,  }\item[{size\+\_\+t $\ast$}]{written }\end{DoxyParamCaption})}



Format Co\+AP option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p} & Buffer where to format the Co\+AP option (optional parameter) \\
\hline
\mbox{\tt in}  & {\em prev\+Option\+Num} & Option number of the previous instance \\
\hline
\mbox{\tt in}  & {\em option} & Co\+AP option content \\
\hline
\mbox{\tt out}  & {\em written} & Total number of bytes that have been written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 262 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
264 \{
265    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
266    \hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader} *header;
267 
268    \textcolor{comment}{//The Option Delta is the difference between the Option Number of this}
269    \textcolor{comment}{//option and that of the previous option (or zero for the first option)}
270    option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} = option->\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} - prevOptionNum;
271 
272    \textcolor{comment}{//Point to the buffer where to write the CoAP option}
273    header = (\hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
274    \textcolor{comment}{//Length of the CoAP option}
275    n = \textcolor{keyword}{sizeof}(\hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader});
276 
277    \textcolor{comment}{//Encode the Option Delta field}
278    \textcolor{keywordflow}{if}(option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} >= \hyperlink{coap__option_8h_aa15cd40b6e696aba002eca8bca888dda}{COAP\_OPT\_DELTA\_MINUS\_16\_BITS})
279    \{
280       \textcolor{comment}{//The first parameter is optional}
281       \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
282       \{
283          \textcolor{comment}{//Fix the initial byte of the CoAP option}
284          header->delta = \hyperlink{coap__option_8h_a51442280fa6eba154d573efcc964c829}{COAP\_OPT\_DELTA\_16\_BITS};
285 
286          \textcolor{comment}{//A 16-bit unsigned integer in network byte order follows the}
287          \textcolor{comment}{//initial byte and indicates the Option Delta minus 269}
288          \hyperlink{cpu__endian_8h_a8e657bcdf3842380d2d0006859029240}{STORE16BE}(option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} - \hyperlink{coap__option_8h_aa15cd40b6e696aba002eca8bca888dda}{COAP\_OPT\_DELTA\_MINUS\_16\_BITS}, 
      \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} + n);
289       \}
290 
291       \textcolor{comment}{//Adjust the length of the CoAP option}
292       n += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
293    \}
294    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} >= \hyperlink{coap__option_8h_a6ee839dcadf001d08356b6d1fe67686b}{COAP\_OPT\_DELTA\_MINUS\_8\_BITS})
295    \{
296       \textcolor{comment}{//The first parameter is optional}
297       \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
298       \{
299          \textcolor{comment}{//Fix the initial byte of the CoAP option}
300          header->delta = \hyperlink{coap__option_8h_a314f5bc1db8e3321a56af23af0b72135}{COAP\_OPT\_DELTA\_8\_BITS};
301 
302          \textcolor{comment}{//An 8-bit unsigned integer follows the initial byte and}
303          \textcolor{comment}{//indicates the Option Delta minus 13}
304          \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} - 
      \hyperlink{coap__option_8h_a6ee839dcadf001d08356b6d1fe67686b}{COAP\_OPT\_DELTA\_MINUS\_8\_BITS});
305       \}
306 
307       \textcolor{comment}{//Adjust the length of the CoAP option}
308       n += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
309    \}
310    \textcolor{keywordflow}{else}
311    \{
312       \textcolor{comment}{//The first parameter is optional}
313       \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
314       \{
315          \textcolor{comment}{//The Option Delta is directly encoded in the initial byte}
316          header->delta = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta};
317       \}
318    \}
319 
320    \textcolor{comment}{//Encode the Option Length field}
321    \textcolor{keywordflow}{if}(option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} >= \hyperlink{coap__option_8h_acf623ac28854c663ba6ddbc0d62c31d4}{COAP\_OPT\_LEN\_MINUS\_16\_BITS})
322    \{
323       \textcolor{comment}{//The first parameter is optional}
324       \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
325       \{
326          \textcolor{comment}{//Fix the initial byte of the CoAP option}
327          header->length = \hyperlink{coap__option_8h_a98f724d85af119f473bb679987380266}{COAP\_OPT\_LEN\_16\_BITS};
328 
329          \textcolor{comment}{//A 16-bit unsigned integer in network byte order precedes the}
330          \textcolor{comment}{//Option Value and indicates the Option Length minus 269}
331          \hyperlink{cpu__endian_8h_a8e657bcdf3842380d2d0006859029240}{STORE16BE}(option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} - \hyperlink{coap__option_8h_acf623ac28854c663ba6ddbc0d62c31d4}{COAP\_OPT\_LEN\_MINUS\_16\_BITS}, 
      \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} + n);
332       \}
333 
334       \textcolor{comment}{//Adjust the length of the CoAP option}
335       n += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
336    \}
337    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} >= \hyperlink{coap__option_8h_a7d27cf4e516ee507cb712e1ef3e89c7c}{COAP\_OPT\_LEN\_MINUS\_8\_BITS})
338    \{
339       \textcolor{comment}{//The first parameter is optional}
340       \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
341       \{
342          \textcolor{comment}{//Fix the initial byte of the CoAP option}
343          header->length = \hyperlink{coap__option_8h_ac0bd513ec602745085dba9d9a720992f}{COAP\_OPT\_LEN\_8\_BITS};
344 
345          \textcolor{comment}{//An 8-bit unsigned integer precedes the Option Value and}
346          \textcolor{comment}{//indicates the Option Length minus 13}
347          \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) (option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} - 
      \hyperlink{coap__option_8h_a7d27cf4e516ee507cb712e1ef3e89c7c}{COAP\_OPT\_LEN\_MINUS\_8\_BITS});
348       \}
349 
350       \textcolor{comment}{//Adjust the length of the CoAP option}
351       n += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
352    \}
353    \textcolor{keywordflow}{else}
354    \{
355       \textcolor{comment}{//The first parameter is optional}
356       \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
357       \{
358          \textcolor{comment}{//The Option Length is directly encoded in the initial byte}
359          header->length = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}) option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length};
360       \}
361    \}
362 
363    \textcolor{comment}{//The first parameter is optional}
364    \textcolor{keywordflow}{if}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
365    \{
366       \textcolor{comment}{//The Option Value is a sequence of exactly Option Length bytes}
367       memmove(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} + n, option->\hyperlink{structCoapOption_ac57cd3a56c1d18248b7f6d3a5a827aeb}{value}, option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length});
368    \}
369 
370    \textcolor{comment}{//Total number of bytes that have been written}
371    *written = n + option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length};
372 
373    \textcolor{comment}{//Successful processing}
374    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
375 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a2ca7f6e12a7410553748b0c63f3a2c5f}\label{coap__option_8c_a2ca7f6e12a7410553748b0c63f3a2c5f}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Get\+Option@{coap\+Get\+Option}}
\index{coap\+Get\+Option@{coap\+Get\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Get\+Option()}{coapGetOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Get\+Option (\begin{DoxyParamCaption}\item[{const \hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{option\+Index,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$$\ast$}]{option\+Value,  }\item[{size\+\_\+t $\ast$}]{option\+Len }\end{DoxyParamCaption})}



Get the value of the specified option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\mbox{\tt in}  & {\em option\+Index} & Occurrence index (for repeatable options only) \\
\hline
\mbox{\tt out}  & {\em option\+Value} & Pointer to the first byte of the option value \\
\hline
\mbox{\tt out}  & {\em option\+Len} & Length of the option, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 571 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
573 \{
574    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
575    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
576    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
577    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} index;
578    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
579    \hyperlink{structCoapOption}{CoapOption} option;
580 
581    \textcolor{comment}{//Initialize index}
582    index = 0;
583 
584    \textcolor{comment}{//Point to the first byte of the CoAP message}
585    p = message->\hyperlink{structCoapMessage_ab8ec8f8181bf0b24d5d63f6701df0ecf}{buffer};
586    \textcolor{comment}{//Retrieve the length of the message}
587    length = message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length};
588 
589    \textcolor{comment}{//Parse message header}
590    error = \hyperlink{coap__message_8c_a2cc8b59729ae7fe5e0953dd1febc7f50}{coapParseMessageHeader}(p, length, &n);
591    \textcolor{comment}{//Any error to report?}
592    \textcolor{keywordflow}{if}(error)
593       \textcolor{keywordflow}{return} error;
594 
595    \textcolor{comment}{//Point to the first option of the message}
596    p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
597    \textcolor{comment}{//Number of bytes left to process}
598    length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
599 
600    \textcolor{comment}{//For the first option in a message, a preceding option instance with}
601    \textcolor{comment}{//Option Number zero is assumed}
602    option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} = 0;
603 
604    \textcolor{comment}{//Loop through CoAP options}
605    \textcolor{keywordflow}{while}(length > 0)
606    \{
607       \textcolor{comment}{//Payload marker found?}
608       \textcolor{keywordflow}{if}(*p == \hyperlink{coap__common_8h_ab4e38910080deed0a5df4aec116d3999}{COAP\_PAYLOAD\_MARKER})
609          \textcolor{keywordflow}{break};
610 
611       \textcolor{comment}{//Parse current option}
612       error = \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coapParseOption}(p, length, option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number}, &option, &n);
613       \textcolor{comment}{//Any error to report?}
614       \textcolor{keywordflow}{if}(error)
615          \textcolor{keywordflow}{return} error;
616 
617       \textcolor{comment}{//Matching option number?}
618       \textcolor{keywordflow}{if}(option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} == optionNum)
619       \{
620          \textcolor{comment}{//Matching occurrence found?}
621          \textcolor{keywordflow}{if}(index++ == optionIndex)
622          \{
623             \textcolor{comment}{//Return option value}
624             *optionValue = option.\hyperlink{structCoapOption_ac57cd3a56c1d18248b7f6d3a5a827aeb}{value};
625             *optionLen = option.\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length};
626 
627             \textcolor{comment}{//We are done}
628             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
629          \}
630       \}
631 
632       \textcolor{comment}{//Jump to the next option}
633       p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
634       length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
635    \}
636 
637    \textcolor{comment}{//The specified option number does not exist}
638    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4cca37264afee88cb14cd105f0d59607}{ERROR\_NOT\_FOUND};
639 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a1ebd1045f145d9d0bea23ee12ad4fc49}\label{coap__option_8c_a1ebd1045f145d9d0bea23ee12ad4fc49}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Get\+Option\+Parameters@{coap\+Get\+Option\+Parameters}}
\index{coap\+Get\+Option\+Parameters@{coap\+Get\+Option\+Parameters}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Get\+Option\+Parameters()}{coapGetOptionParameters()}}
{\footnotesize\ttfamily const \hyperlink{structCoapOptionParameters}{Coap\+Option\+Parameters}$\ast$ coap\+Get\+Option\+Parameters (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num }\end{DoxyParamCaption})}



Retrieve parameters for a given option number. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Option parameters 
\end{DoxyReturn}


Definition at line 950 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
951 \{
952    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
953    \textcolor{keyword}{const} \hyperlink{structCoapOptionParameters}{CoapOptionParameters} *optionParams;
954 
955    \textcolor{comment}{//Initialize variable}
956    optionParams = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
957 
958    \textcolor{comment}{//Loop through the list of supported options}
959    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{coap__option_8c_a5c68dcd0b43760bf767cd229833c7a24}{coapOptionList}); i++)
960    \{
961       \textcolor{comment}{//Check option number against the expected value}
962       \textcolor{keywordflow}{if}(\hyperlink{coap__option_8c_a5c68dcd0b43760bf767cd229833c7a24}{coapOptionList}[i].number == optionNum)
963       \{
964          optionParams = &\hyperlink{coap__option_8c_a5c68dcd0b43760bf767cd229833c7a24}{coapOptionList}[i];
965          \textcolor{keywordflow}{break};
966       \}
967    \}
968 
969    \textcolor{comment}{//Return option parameters}
970    \textcolor{keywordflow}{return} optionParams;
971 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a4098de0a9fbec04954546ce1978572d9}\label{coap__option_8c_a4098de0a9fbec04954546ce1978572d9}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Get\+Uint\+Option@{coap\+Get\+Uint\+Option}}
\index{coap\+Get\+Uint\+Option@{coap\+Get\+Uint\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Get\+Uint\+Option()}{coapGetUintOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Get\+Uint\+Option (\begin{DoxyParamCaption}\item[{const \hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{option\+Index,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{option\+Value }\end{DoxyParamCaption})}



Get the value of the specified uint option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number to search for \\
\hline
\mbox{\tt in}  & {\em option\+Index} & Occurrence index (for repeatable options only) \\
\hline
\mbox{\tt out}  & {\em option\+Value} & Option value (unsigned integer) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 651 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
653 \{
654    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
655    \textcolor{keywordtype}{size\_t} i;
656    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
657    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
658 
659    \textcolor{comment}{//Search the CoAP message for the specified option number}
660    error = \hyperlink{coap__option_8c_a2ca7f6e12a7410553748b0c63f3a2c5f}{coapGetOption}(message, optionNum, optionIndex, &p, &n);
661    \textcolor{comment}{//Any error to report ?}
662    \textcolor{keywordflow}{if}(error)
663       \textcolor{keywordflow}{return} error;
664 
665    \textcolor{comment}{//Initialize integer value}
666    *optionValue = 0;
667 
668    \textcolor{comment}{//Convert the integer from network byte order}
669    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
670    \{
671       *optionValue <<= 8;
672       *optionValue += p[i];
673    \}
674 
675    \textcolor{comment}{//Successful processing}
676    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
677 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_aed9b91fe21f215447138d088edbd6050}\label{coap__option_8c_aed9b91fe21f215447138d088edbd6050}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Join\+Repeatable\+Option@{coap\+Join\+Repeatable\+Option}}
\index{coap\+Join\+Repeatable\+Option@{coap\+Join\+Repeatable\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Join\+Repeatable\+Option()}{coapJoinRepeatableOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Join\+Repeatable\+Option (\begin{DoxyParamCaption}\item[{const \hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{option\+Value,  }\item[{size\+\_\+t}]{max\+Len,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}}]{separator }\end{DoxyParamCaption})}



Decode a path or query component from multiple repeatable options. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\mbox{\tt out}  & {\em option\+Value} & Buffer where to copy the path or query component \\
\hline
\mbox{\tt in}  & {\em max\+Len} & Maximum number of characters the buffer can hold \\
\hline
\mbox{\tt in}  & {\em separator} & Delimiting character \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 877 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
879 \{
880    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
881    \textcolor{keywordtype}{size\_t} i;
882    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
883    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} index;
884    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
885 
886    \textcolor{comment}{//Initialize status code}
887    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
888 
889    \textcolor{comment}{//Initialize variables}
890    i = 0;
891    index = 0;
892 
893    \textcolor{comment}{//Build path or query component}
894    \textcolor{keywordflow}{while}(!error)
895    \{
896       \textcolor{comment}{//Each option specifies one segment of the component}
897       error = \hyperlink{coap__option_8c_a2ca7f6e12a7410553748b0c63f3a2c5f}{coapGetOption}(message, optionNum, index++, &p, &n);
898 
899       \textcolor{comment}{//Check status code}
900       \textcolor{keywordflow}{if}(!error)
901       \{
902          \textcolor{comment}{//Check separator}
903          \textcolor{keywordflow}{if}(separator != \textcolor{charliteral}{'&'} || i != 0)
904          \{
905             \textcolor{comment}{//Make sure the output buffer is large enough}
906             \textcolor{keywordflow}{if}(i < maxLen)
907             \{
908                \textcolor{comment}{//Append a delimiting character}
909                optionValue[i++] = separator;
910             \}
911          \}
912 
913          \textcolor{comment}{//Make sure the output buffer is large enough}
914          \textcolor{keywordflow}{if}((i + n) <= maxLen)
915          \{
916             \textcolor{comment}{//Copy option's value}
917             memcpy(optionValue + i, p, n);
918             \textcolor{comment}{//Update the length of the absolute path}
919             i += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
920          \}
921          \textcolor{keywordflow}{else}
922          \{
923             \textcolor{comment}{//Report an error}
924             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
925          \}
926       \}
927    \}
928 
929    \textcolor{comment}{//Check status code}
930    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4cca37264afee88cb14cd105f0d59607}{ERROR\_NOT\_FOUND})
931    \{
932       \textcolor{comment}{//Catch exception}
933       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
934    \}
935 
936    \textcolor{comment}{//Properly terminate the string with a NULL character}
937    optionValue[i] = \textcolor{charliteral}{'\(\backslash\)0'};
938 
939    \textcolor{comment}{//Return status code}
940    \textcolor{keywordflow}{return} error;
941 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}\label{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Parse\+Option@{coap\+Parse\+Option}}
\index{coap\+Parse\+Option@{coap\+Parse\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Parse\+Option()}{coapParseOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Parse\+Option (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{prev\+Option\+Num,  }\item[{\hyperlink{structCoapOption}{Coap\+Option} $\ast$}]{option,  }\item[{size\+\_\+t $\ast$}]{consumed }\end{DoxyParamCaption})}



Parse Co\+AP option. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p} & Input stream where to read the Co\+AP option \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes available in the input stream \\
\hline
\mbox{\tt in}  & {\em prev\+Option\+Num} & Option number of the previous instance \\
\hline
\mbox{\tt out}  & {\em option} & Co\+AP option content \\
\hline
\mbox{\tt out}  & {\em consumed} & Total number of bytes that have been consumed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 133 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
135 \{
136    \textcolor{keyword}{const} \hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader} *header;
137 
138    \textcolor{comment}{//Malformed CoAP option?}
139    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader}))
140       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caffb4964a1e384aed30bf3d72f4082c42}{ERROR\_BUFFER\_UNDERFLOW};
141 
142    \textcolor{comment}{//Point to the CoAP option header}
143    header = (\hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader} *) \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
144 
145    \textcolor{comment}{//Point to the next field}
146    \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += \textcolor{keyword}{sizeof}(\hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader});
147    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{coap__common_8h_a160e85d47747ed5f1fcc341d31b0f5c9}{CoapOptionHeader});
148 
149    \textcolor{comment}{//Check the value of the Option Delta field}
150    \textcolor{keywordflow}{if}(header->delta == \hyperlink{coap__option_8h_a04da76f36d531264073b571860c3747b}{COAP\_OPT\_DELTA\_RESERVED})
151    \{
152       \textcolor{comment}{//If the field is set to 15 but the entire byte is not the payload}
153       \textcolor{comment}{//marker, this must be processed as a message format error}
154       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6b1c5652c82e48ada5b4348c0ebb95e6}{ERROR\_INVALID\_MESSAGE};
155    \}
156    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(header->delta == \hyperlink{coap__option_8h_a51442280fa6eba154d573efcc964c829}{COAP\_OPT\_DELTA\_16\_BITS})
157    \{
158       \textcolor{comment}{//Malformed CoAP option?}
159       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}))
160          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caffb4964a1e384aed30bf3d72f4082c42}{ERROR\_BUFFER\_UNDERFLOW};
161 
162       \textcolor{comment}{//A 16-bit unsigned integer in network byte order follows the initial}
163       \textcolor{comment}{//byte and indicates the Option Delta minus 269}
164       option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} = \hyperlink{cpu__endian_8h_ae21854587c05993c850b537156470088}{LOAD16BE}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}) + \hyperlink{coap__option_8h_aa15cd40b6e696aba002eca8bca888dda}{COAP\_OPT\_DELTA\_MINUS\_16\_BITS};
165 
166       \textcolor{comment}{//Point to the next field}
167       \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
168       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
169    \}
170    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(header->delta == \hyperlink{coap__option_8h_a314f5bc1db8e3321a56af23af0b72135}{COAP\_OPT\_DELTA\_8\_BITS})
171    \{
172       \textcolor{comment}{//Malformed CoAP option?}
173       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}))
174          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caffb4964a1e384aed30bf3d72f4082c42}{ERROR\_BUFFER\_UNDERFLOW};
175 
176       \textcolor{comment}{//An 8-bit unsigned integer follows the initial byte and indicates}
177       \textcolor{comment}{//the Option Delta minus 13}
178       option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} = *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} + \hyperlink{coap__option_8h_a6ee839dcadf001d08356b6d1fe67686b}{COAP\_OPT\_DELTA\_MINUS\_8\_BITS};
179 
180       \textcolor{comment}{//Point to the next field}
181       \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
182       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
183    \}
184    \textcolor{keywordflow}{else}
185    \{
186       \textcolor{comment}{//A value between 0 and 12 indicates the Option Delta}
187       option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} = header->delta;
188    \}
189 
190    \textcolor{comment}{//Check the value of the Option Length field}
191    \textcolor{keywordflow}{if}(header->length == \hyperlink{coap__option_8h_afcb5b8ae214f546c085eedfd7eec41a8}{COAP\_OPT\_LEN\_RESERVED})
192    \{
193       \textcolor{comment}{//If the field is set to this value, it must be processed as a}
194       \textcolor{comment}{//message format error}
195       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6b1c5652c82e48ada5b4348c0ebb95e6}{ERROR\_INVALID\_MESSAGE};
196    \}
197    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(header->length == \hyperlink{coap__option_8h_a98f724d85af119f473bb679987380266}{COAP\_OPT\_LEN\_16\_BITS})
198    \{
199       \textcolor{comment}{//Malformed CoAP option?}
200       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}))
201          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caffb4964a1e384aed30bf3d72f4082c42}{ERROR\_BUFFER\_UNDERFLOW};
202 
203       \textcolor{comment}{//A 16-bit unsigned integer in network byte order precedes the}
204       \textcolor{comment}{//Option Value and indicates the Option Length minus 269}
205       option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} = \hyperlink{cpu__endian_8h_ae21854587c05993c850b537156470088}{LOAD16BE}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}) + \hyperlink{coap__option_8h_acf623ac28854c663ba6ddbc0d62c31d4}{COAP\_OPT\_LEN\_MINUS\_16\_BITS};
206 
207       \textcolor{comment}{//Point to the next field}
208       \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
209       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
210    \}
211    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(header->length == \hyperlink{coap__option_8h_ac0bd513ec602745085dba9d9a720992f}{COAP\_OPT\_LEN\_8\_BITS})
212    \{
213       \textcolor{comment}{//Malformed CoAP option?}
214       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t}))
215          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caffb4964a1e384aed30bf3d72f4082c42}{ERROR\_BUFFER\_UNDERFLOW};
216 
217       \textcolor{comment}{//An 8-bit unsigned integer precedes the Option Value and indicates}
218       \textcolor{comment}{//the Option Length minus 13}
219       option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} = *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} + \hyperlink{coap__option_8h_a7d27cf4e516ee507cb712e1ef3e89c7c}{COAP\_OPT\_LEN\_MINUS\_8\_BITS};
220 
221       \textcolor{comment}{//Point to the next field}
222       \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
223       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t});
224    \}
225    \textcolor{keywordflow}{else}
226    \{
227       \textcolor{comment}{//A value between 0 and 12 indicates the length of the Option Value,}
228       \textcolor{comment}{//in bytes}
229       option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} = header->length;
230    \}
231 
232    \textcolor{comment}{//Malformed CoAP option?}
233    \textcolor{keywordflow}{if}(length < option->\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
234       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caffb4964a1e384aed30bf3d72f4082c42}{ERROR\_BUFFER\_UNDERFLOW};
235 
236    \textcolor{comment}{//Save option value}
237    option->\hyperlink{structCoapOption_ac57cd3a56c1d18248b7f6d3a5a827aeb}{value} = \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
238    \textcolor{comment}{//Advance data pointer}
239    \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += option->\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length};
240 
241    \textcolor{comment}{//the Option Number for each instance is calculated as the sum of its delta}
242    \textcolor{comment}{//and the Option Number of the preceding instance in the message}
243    option->\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} = option->\hyperlink{structCoapOption_af1a2406073cd0bda508b5a0f73f50517}{delta} + prevOptionNum;
244 
245    \textcolor{comment}{//Total number of bytes that have been consumed}
246    *consumed = \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} - (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) header;
247 
248    \textcolor{comment}{//Successful processing}
249    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
250 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a2c821303d697ba7fb5ae13fe449ee1a2}\label{coap__option_8c_a2c821303d697ba7fb5ae13fe449ee1a2}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Parse\+Options@{coap\+Parse\+Options}}
\index{coap\+Parse\+Options@{coap\+Parse\+Options}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Parse\+Options()}{coapParseOptions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Parse\+Options (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{p,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{consumed }\end{DoxyParamCaption})}



Parse the list of Co\+AP options. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p} & Input stream where to read the Co\+AP options \\
\hline
\mbox{\tt in}  & {\em length} & Number of bytes available in the input stream \\
\hline
\mbox{\tt out}  & {\em consumed} & Total number of bytes that have been consumed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 81 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
82 \{
83    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
84    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
85    \hyperlink{structCoapOption}{CoapOption} option;
86 
87    \textcolor{comment}{//Initialize status code}
88    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
89 
90    \textcolor{comment}{//Total number of bytes that have been consumed}
91    *consumed = 0;
92 
93    \textcolor{comment}{//For the first option in a message, a preceding option instance with}
94    \textcolor{comment}{//Option Number zero is assumed}
95    option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} = 0;
96 
97    \textcolor{comment}{//Loop through CoAP options}
98    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
99    \{
100       \textcolor{comment}{//Payload marker found?}
101       \textcolor{keywordflow}{if}(*\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} == \hyperlink{coap__common_8h_ab4e38910080deed0a5df4aec116d3999}{COAP\_PAYLOAD\_MARKER})
102          \textcolor{keywordflow}{break};
103 
104       \textcolor{comment}{//Parse current option}
105       error = \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coapParseOption}(\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number}, &option, &n);
106       \textcolor{comment}{//Any error to report?}
107       \textcolor{keywordflow}{if}(error)
108          \textcolor{keywordflow}{break};
109 
110       \textcolor{comment}{//Total number of bytes that have been consumed}
111       *consumed += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
112 
113       \textcolor{comment}{//Jump to the next option}
114       \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
115       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
116    \}
117 
118    \textcolor{comment}{//Return status code}
119    \textcolor{keywordflow}{return} error;
120 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_ac85bcf585186dad1590600b012bb6306}\label{coap__option_8c_ac85bcf585186dad1590600b012bb6306}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Set\+Option@{coap\+Set\+Option}}
\index{coap\+Set\+Option@{coap\+Set\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Set\+Option()}{coapSetOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Set\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{option\+Index,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{option\+Value,  }\item[{size\+\_\+t}]{option\+Len }\end{DoxyParamCaption})}



Add an option to the specified Co\+AP message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\mbox{\tt in}  & {\em option\+Index} & Occurrence index (for repeatable options only) \\
\hline
\mbox{\tt in}  & {\em option\+Value} & Pointer to the first byte of the option value \\
\hline
\mbox{\tt in}  & {\em option\+Len} & Length of the option, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 388 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
390 \{
391    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
392    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} replace;
393    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
394    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
395    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
396    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} index;
397    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} prevOptionNum;
398    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
399    \hyperlink{structCoapOption}{CoapOption} option;
400 
401    \textcolor{comment}{//Initialize variables}
402    replace = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
403    index = 0;
404 
405    \textcolor{comment}{//Point to the first byte of the CoAP message}
406    p = message->\hyperlink{structCoapMessage_ab8ec8f8181bf0b24d5d63f6701df0ecf}{buffer};
407    \textcolor{comment}{//Retrieve the length of the message}
408    length = message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length};
409 
410    \textcolor{comment}{//Parse message header}
411    error = \hyperlink{coap__message_8c_a2cc8b59729ae7fe5e0953dd1febc7f50}{coapParseMessageHeader}(p, length, &n);
412    \textcolor{comment}{//Any error to report?}
413    \textcolor{keywordflow}{if}(error)
414       \textcolor{keywordflow}{return} error;
415 
416    \textcolor{comment}{//Point to the first option of the message}
417    p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
418    \textcolor{comment}{//Number of bytes left to process}
419    length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
420 
421    \textcolor{comment}{//For the first option in a message, a preceding option instance with}
422    \textcolor{comment}{//Option Number zero is assumed}
423    prevOptionNum = 0;
424 
425    \textcolor{comment}{//Loop through CoAP options}
426    \textcolor{keywordflow}{while}(length > 0)
427    \{
428       \textcolor{comment}{//Payload marker found?}
429       \textcolor{keywordflow}{if}(*p == \hyperlink{coap__common_8h_ab4e38910080deed0a5df4aec116d3999}{COAP\_PAYLOAD\_MARKER})
430          \textcolor{keywordflow}{break};
431 
432       \textcolor{comment}{//Parse current option}
433       error = \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coapParseOption}(p, length, prevOptionNum, &option, &n);
434       \textcolor{comment}{//Any error to report?}
435       \textcolor{keywordflow}{if}(error)
436          \textcolor{keywordflow}{return} error;
437 
438       \textcolor{comment}{//Options are inserted in ascending order}
439       \textcolor{keywordflow}{if}(option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} > optionNum)
440          \textcolor{keywordflow}{break};
441 
442       \textcolor{comment}{//Matching option number?}
443       \textcolor{keywordflow}{if}(option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} == optionNum)
444       \{
445          \textcolor{comment}{//Matching occurrence found?}
446          \textcolor{keywordflow}{if}(index++ == optionIndex)
447          \{
448             \textcolor{comment}{//The current option will be replaced}
449             replace = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
450             \textcolor{keywordflow}{break};
451          \}
452       \}
453 
454       \textcolor{comment}{//Keep track of the current option number}
455       prevOptionNum = option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number};
456 
457       \textcolor{comment}{//Jump to the next option}
458       p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
459       length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
460    \}
461 
462    \textcolor{comment}{//Check whether the current option should be replaced}
463    \textcolor{keywordflow}{if}(replace)
464    \{
465       \textcolor{comment}{//Remove the current occurrence of the option}
466       memmove(p, p + n, length - n);
467       \textcolor{comment}{//Number of bytes left to process}
468       length -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
469       \textcolor{comment}{//Adjust the length of the CoAP message}
470       message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
471    \}
472 
473    \textcolor{comment}{//Each option instance in a message specifies the Option Number of the}
474    \textcolor{comment}{//defined CoAP option, the length of the Option Value, and the Option}
475    \textcolor{comment}{//Value itself}
476    option.\hyperlink{structCoapOption_a4930b03666d0b61415ce56e7f8b28246}{number} = optionNum;
477    option.\hyperlink{structCoapOption_a00ae0190c8ea853add596ed817f912f4}{length} = optionLen;
478    option.\hyperlink{structCoapOption_ac57cd3a56c1d18248b7f6d3a5a827aeb}{value} = optionValue;
479 
480    \textcolor{comment}{//The first pass calculates the required length}
481    error = \hyperlink{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}{coapFormatOption}(\hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, prevOptionNum, &option, &n);
482    \textcolor{comment}{//Any error to report?}
483    \textcolor{keywordflow}{if}(error)
484       \textcolor{keywordflow}{return} error;
485 
486    \textcolor{comment}{//Make sure the output buffer is large enough to hold the new option}
487    \textcolor{keywordflow}{if}((message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length} + n) > \hyperlink{coap__common_8h_a335f86dbb26e7c7c80679116ec6bb120}{COAP\_MAX\_MSG\_SIZE})
488       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
489 
490    \textcolor{comment}{//Make room for the new option}
491    memmove(p + n, p, length);
492 
493    \textcolor{comment}{//The second pass formats the CoAP option}
494    error = \hyperlink{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}{coapFormatOption}(p, prevOptionNum, &option, &n);
495    \textcolor{comment}{//Any error to report?}
496    \textcolor{keywordflow}{if}(error)
497       \textcolor{keywordflow}{return} error;
498 
499    \textcolor{comment}{//Advance data pointer}
500    p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
501    \textcolor{comment}{//Adjust the length of the CoAP message}
502    message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
503 
504    \textcolor{comment}{//Check whether another CoAP option is following}
505    \textcolor{keywordflow}{if}(length > 0 && *p != \hyperlink{coap__common_8h_ab4e38910080deed0a5df4aec116d3999}{COAP\_PAYLOAD\_MARKER} && !replace)
506    \{
507       \textcolor{comment}{//Parse the following option}
508       error = \hyperlink{coap__option_8c_aed5555040b2ae65a35975e10bfc5fb31}{coapParseOption}(p, length, prevOptionNum, &option, &n);
509       \textcolor{comment}{//Any error to report?}
510       \textcolor{keywordflow}{if}(error)
511          \textcolor{keywordflow}{return} error;
512 
513       \textcolor{comment}{//Fix the Option Delta field}
514       error = \hyperlink{coap__option_8c_a50c4e1cbc752d727a3b81af1d48b472c}{coapFormatOption}(p, optionNum, &option, &m);
515       \textcolor{comment}{//Any error to report?}
516       \textcolor{keywordflow}{if}(error)
517          \textcolor{keywordflow}{return} error;
518 
519       \textcolor{comment}{//Test if the length of the option has changed}
520       \textcolor{keywordflow}{if}(m < n)
521       \{
522          \textcolor{comment}{//Move the rest of the CoAP message}
523          memmove(p + m, p + n, length - n);
524          \textcolor{comment}{//Fix the length of the message}
525          message->\hyperlink{structCoapMessage_a0b85357992e3b1941c8621058369b842}{length} -= n - \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
526       \}
527    \}
528 
529    \textcolor{comment}{//Return status code}
530    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
531 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a91f101e0e5423c2a63513028664b9152}\label{coap__option_8c_a91f101e0e5423c2a63513028664b9152}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Set\+Uint\+Option@{coap\+Set\+Uint\+Option}}
\index{coap\+Set\+Uint\+Option@{coap\+Set\+Uint\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Set\+Uint\+Option()}{coapSetUintOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Set\+Uint\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{option\+Index,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{option\+Value }\end{DoxyParamCaption})}



Add a uint option to the specified Co\+AP message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\mbox{\tt in}  & {\em option\+Index} & Occurrence index (for repeatable options only) \\
\hline
\mbox{\tt in}  & {\em option\+Value} & Option value (unsigned integer) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 543 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
545 \{
546    \textcolor{keywordtype}{size\_t} i;
547    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} buffer[4];
548 
549    \textcolor{comment}{//A sender should represent the integer with as few bytes as possible}
550    \textcolor{keywordflow}{for}(i = 4; optionValue != 0; i--)
551    \{
552       buffer[i - 1] = optionValue & 0xFF;
553       optionValue >>= 8;
554    \}
555 
556    \textcolor{comment}{//Add the specified option to the CoAP message}
557    \textcolor{keywordflow}{return} \hyperlink{coap__option_8c_ac85bcf585186dad1590600b012bb6306}{coapSetOption}(message, optionNum, optionIndex, buffer + i, 4 - i);
558 \}
\end{DoxyCode}
\mbox{\Hypertarget{coap__option_8c_a5290b7f4d6589e73860b03a660d33cb1}\label{coap__option_8c_a5290b7f4d6589e73860b03a660d33cb1}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Split\+Repeatable\+Option@{coap\+Split\+Repeatable\+Option}}
\index{coap\+Split\+Repeatable\+Option@{coap\+Split\+Repeatable\+Option}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Split\+Repeatable\+Option()}{coapSplitRepeatableOption()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} coap\+Split\+Repeatable\+Option (\begin{DoxyParamCaption}\item[{\hyperlink{structCoapMessage}{Coap\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{option\+Num,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{option\+Value,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}}]{separator }\end{DoxyParamCaption})}



Encode a path or query component into multiple repeatable options. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the Co\+AP message \\
\hline
\mbox{\tt in}  & {\em option\+Num} & Option number \\
\hline
\mbox{\tt in}  & {\em option\+Value} & Path or a query component to be encoded \\
\hline
\mbox{\tt in}  & {\em separator} & Delimiting character \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 822 of file coap\+\_\+option.\+c.


\begin{DoxyCode}
824 \{
825    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
826    \textcolor{keywordtype}{size\_t} i;
827    \textcolor{keywordtype}{size\_t} j;
828    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} index;
829 
830    \textcolor{comment}{//Initialize status code}
831    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
832 
833    \textcolor{comment}{//Initialize variables}
834    i = 0;
835    j = 0;
836    index = 0;
837 
838    \textcolor{comment}{//Split the path or query component into multiple repeatable options}
839    \textcolor{keywordflow}{do}
840    \{
841       \textcolor{comment}{//Delimiting character found?}
842       \textcolor{keywordflow}{if}(optionValue[i] == separator || optionValue[i] == \textcolor{charliteral}{'\(\backslash\)0'})
843       \{
844          \textcolor{comment}{//Discard empty segments}
845          \textcolor{keywordflow}{if}((i - j) > 0)
846          \{
847             \textcolor{comment}{//Each option specifies one segment of the component}
848             error = \hyperlink{coap__option_8c_ac85bcf585186dad1590600b012bb6306}{coapSetOption}(message, optionNum, index++,
849                (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) optionValue + j, i - j);
850             \textcolor{comment}{//Any error to report?}
851             \textcolor{keywordflow}{if}(error)
852                \textcolor{keywordflow}{break};
853          \}
854 
855          \textcolor{comment}{//Move to the next segment}
856          j = i + 1;
857       \}
858 
859       \textcolor{comment}{//Loop until the NULL character is reached}
860    \} \textcolor{keywordflow}{while}(optionValue[i++] != \textcolor{charliteral}{'\(\backslash\)0'});
861 
862    \textcolor{comment}{//Return status code}
863    \textcolor{keywordflow}{return} error;
864 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{coap__option_8c_a5c68dcd0b43760bf767cd229833c7a24}\label{coap__option_8c_a5c68dcd0b43760bf767cd229833c7a24}} 
\index{coap\+\_\+option.\+c@{coap\+\_\+option.\+c}!coap\+Option\+List@{coap\+Option\+List}}
\index{coap\+Option\+List@{coap\+Option\+List}!coap\+\_\+option.\+c@{coap\+\_\+option.\+c}}
\subsubsection{\texorpdfstring{coap\+Option\+List}{coapOptionList}}
{\footnotesize\ttfamily const \hyperlink{structCoapOptionParameters}{Coap\+Option\+Parameters} coap\+Option\+List\mbox{[}$\,$\mbox{]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7adb294ecef03ea6bf4b06803129c5c88e}{COAP\_OPT\_IF\_MATCH},       \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \textcolor{stringliteral}{"If-Match"},       \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ea9c048a6c0716777760a2fd6a65eea32d}{COAP\_OPT\_FORMAT\_OPAQUE}, 0, 8\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a43ed7337d1560fe49c987c6544bf7bed}{COAP\_OPT\_URI\_HOST},       \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Uri-Host"},       \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 1, 255\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a991ddbf53e5995d3ea0d2edc487f27e6}{COAP\_OPT\_ETAG},           \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \textcolor{stringliteral}{"ETag"},           \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ea9c048a6c0716777760a2fd6a65eea32d}{COAP\_OPT\_FORMAT\_OPAQUE}, 1, 8\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a6894d00c37308a38fd6f0d8488745122}{COAP\_OPT\_IF\_NONE\_MATCH},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"If-None-Match"},  \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ea4a4a69a9f065b94477be88ee6086e53d}{COAP\_OPT\_FORMAT\_EMPTY},  0, 0\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7ac327e2341a2ed78310270fa285b0a7d9}{COAP\_OPT\_OBSERVE},        \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Observe"},        \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 3\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7aa74ff56f126993bc824d9e8799fb28c6}{COAP\_OPT\_URI\_PORT},       \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Uri-Port"},       \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 2\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a35437d113465586b7ba12f115c058e0f}{COAP\_OPT\_LOCATION\_PATH},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \textcolor{stringliteral}{"Location-Path"},  \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 0, 255\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7ae21071fb76ebd858362318ffa4b335bc}{COAP\_OPT\_URI\_PATH},       \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \textcolor{stringliteral}{"Uri-Path"},       \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 0, 255\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7ac9734fe9d1983c411d839fd317afbdca}{COAP\_OPT\_CONTENT\_FORMAT}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Content-Format"}, \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 2\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7ae1d2594f4e92d466cd196de5656aa449}{COAP\_OPT\_MAX\_AGE},        \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Max-Age"},        \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 4\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a8244d8c34e8fffdc435824fc32633fcf}{COAP\_OPT\_URI\_QUERY},      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \textcolor{stringliteral}{"Uri-Query"},      \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 0, 255\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7abe5445c6c39fd1830d5390ca22cf1164}{COAP\_OPT\_ACCEPT},         \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Accept"},         \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 2\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a3f4195bad38a4306256ac74016f0b19e}{COAP\_OPT\_LOCATION\_QUERY}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \textcolor{stringliteral}{"Location-Query"}, \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 0, 255\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a5c471307a51b53ed7bf1c06a21a6dc64}{COAP\_OPT\_BLOCK2},         \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Block2"},         \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 3\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a5492ac3bfefc86f9801606306e6edb18}{COAP\_OPT\_BLOCK1},         \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Block1"},         \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 3\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7af774d90229a5445b7adc681161a76543}{COAP\_OPT\_SIZE2},          \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Size2"},          \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 4\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a8c9afddbef69934dd725e3637fe0d0fa}{COAP\_OPT\_PROXY\_URI},      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Proxy-Uri"},      \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 1, 1034\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a13e3f15ded53d23f3908f89b5654e73a}{COAP\_OPT\_PROXY\_SCHEME},   \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Proxy-Scheme"},   \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02ead1990a46534b7e1fb3e0d119c509f5d7}{COAP\_OPT\_FORMAT\_STRING}, 1, 255\},
   \{\hyperlink{coap__option_8h_ab833642841b9ddc4cab90acf5cffb0e7a3c16636666320ee5efe39c033d8fe883}{COAP\_OPT\_SIZE1},          \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},  
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"Size1"},          \hyperlink{coap__option_8h_a0dafb13dafce37cff605bb260a1ed02eab80436cdb5d96f471b8cf0ea3c0525cc}{COAP\_OPT\_FORMAT\_UINT},   0, 4\}
\}
\end{DoxyCode}


List of supported Co\+AP options. 



Definition at line 49 of file coap\+\_\+option.\+c.

