\hypertarget{pkix_2x509__cert__parse_8c}{}\section{cyclone\+\_\+crypto/pkix/x509\+\_\+cert\+\_\+parse.c File Reference}
\label{pkix_2x509__cert__parse_8c}\index{cyclone\+\_\+crypto/pkix/x509\+\_\+cert\+\_\+parse.\+c@{cyclone\+\_\+crypto/pkix/x509\+\_\+cert\+\_\+parse.\+c}}
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+cert\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+key\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkc/rsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkc/dsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/ecdsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/md5.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha224.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha256.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha384.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha512.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pkix_2x509__cert__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a0c8997b0f608c1fee25bdd281e7c4acb}{x509\+Parse\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$cert\+Info)
\begin{DoxyCompactList}\small\item\em Parse a X.\+509 certificate. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a7a0742ff1b43f4cbf588b0d55f8adf33}{x509\+Parse\+Tbs\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509TbsCertificate}{X509\+Tbs\+Certificate} $\ast$tbs\+Cert)
\begin{DoxyCompactList}\small\item\em Parse T\+B\+S\+Certificate structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}{x509\+Parse\+Version} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$\hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Parse Version field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}{x509\+Parse\+Serial\+Number} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SerialNumber}{X509\+Serial\+Number} $\ast$serial\+Number)
\begin{DoxyCompactList}\small\item\em Parse Serial\+Number field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509\+Parse\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Name}{X509\+Name} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name})
\begin{DoxyCompactList}\small\item\em Parse Name structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}{x509\+Parse\+Name\+Attribute} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509NameAttribute}{X509\+Name\+Attribute} $\ast$name\+Attribute)
\begin{DoxyCompactList}\small\item\em Parse name attribute. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}{x509\+Parse\+Validity} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Validity}{X509\+Validity} $\ast$validity)
\begin{DoxyCompactList}\small\item\em Parse Validity structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509\+Parse\+Time} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structDateTime}{Date\+Time} $\ast$date\+Time)
\begin{DoxyCompactList}\small\item\em Parse U\+T\+C\+Time or Generalized\+Time field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}{x509\+Parse\+Issuer\+Unique\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length)
\begin{DoxyCompactList}\small\item\em Parse Issuer\+Unique\+ID structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}{x509\+Parse\+Subject\+Unique\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Unique\+ID structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}{x509\+Parse\+Extensions} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Extensions}{X509\+Extensions} $\ast$\hyperlink{tls13__misc_8h_a7b8cc84c920376c616d85d575080d28e}{extensions})
\begin{DoxyCompactList}\small\item\em Parse X.\+509 certificate extensions. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509\+Parse\+Extension} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Extension}{X509\+Extension} $\ast$extension)
\begin{DoxyCompactList}\small\item\em Parse X.\+509 certificate extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_abf00ff52c398cab7d1dea073565bb483}{x509\+Parse\+Basic\+Constraints} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509BasicConstraints}{X509\+Basic\+Constraints} $\ast$basic\+Constraints)
\begin{DoxyCompactList}\small\item\em Parse Basic\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a6d44bf52961bcab248b5c7c15a9388cf}{x509\+Parse\+Name\+Constraints} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509NameConstraints}{X509\+Name\+Constraints} $\ast$name\+Constraints)
\begin{DoxyCompactList}\small\item\em Parse Name\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a44c40ee0268e0602ec3f9798d05f4c06}{x509\+Parse\+Policy\+Constraints} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Policy\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a7647b97767de61288b28b741d282c8ce}{x509\+Parse\+Policy\+Mappings} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Policy\+Mappings extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_acb3f7c866ea11cc7874fcd94fe9c2ed5}{x509\+Parse\+Inhibit\+Any\+Policy} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Inhibit\+Any\+Policy extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a422fd9c0cb45ce8bdbb39b90ec97b9b2}{x509\+Parse\+Key\+Usage} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509KeyUsage}{X509\+Key\+Usage} $\ast$key\+Usage)
\begin{DoxyCompactList}\small\item\em Parse Key\+Usage extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a8d749363df6e0e19f41b6c87d9871afc}{x509\+Parse\+Extended\+Key\+Usage} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509ExtendedKeyUsage}{X509\+Extended\+Key\+Usage} $\ast$ext\+Key\+Usage)
\begin{DoxyCompactList}\small\item\em Parse Extended\+Key\+Usage extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a1834c4a293deeefdd2190cd797b043eb}{x509\+Parse\+Subject\+Alt\+Name} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509SubjectAltName}{X509\+Subject\+Alt\+Name} $\ast$subject\+Alt\+Name)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Alt\+Name extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509\+Parse\+General\+Subtrees} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse General\+Subtrees field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}{x509\+Parse\+General\+Subtree} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$general\+Name)
\begin{DoxyCompactList}\small\item\em Parse General\+Subtree field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509\+Parse\+General\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$general\+Name)
\begin{DoxyCompactList}\small\item\em Parse General\+Name field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_abb67592342a7a0bddcb6a9dfa0c6cdb4}{x509\+Parse\+Subject\+Key\+Id} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509SubjectKeyId}{X509\+Subject\+Key\+Id} $\ast$subject\+Key\+Id)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Key\+Identifier extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_ae597e501920da969d8167e52d8a90ba2}{x509\+Parse\+Authority\+Key\+Id} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509AuthorityKeyId}{X509\+Authority\+Key\+Id} $\ast$auth\+Key\+Id)
\begin{DoxyCompactList}\small\item\em Parse Authority\+Key\+Identifier extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_aa028ba917ab627bbea822b1e29c59d6f}{x509\+Parse\+Ns\+Cert\+Type} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509NsCertType}{X509\+Ns\+Cert\+Type} $\ast$ns\+Cert\+Type)
\begin{DoxyCompactList}\small\item\em Parse Netscape\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509\+Parse\+Signature\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$signature\+Algo)
\begin{DoxyCompactList}\small\item\em Parse Signature\+Algorithm structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509\+Parse\+Signature\+Value} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureValue}{X509\+Signature\+Value} $\ast$signature\+Value)
\begin{DoxyCompactList}\small\item\em Parse Signature\+Value field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509\+Parse\+Int} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Convert string to integer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{pkix_2x509__cert__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file x509\+\_\+cert\+\_\+parse.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_ae597e501920da969d8167e52d8a90ba2}\label{pkix_2x509__cert__parse_8c_ae597e501920da969d8167e52d8a90ba2}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Authority\+Key\+Id@{x509\+Parse\+Authority\+Key\+Id}}
\index{x509\+Parse\+Authority\+Key\+Id@{x509\+Parse\+Authority\+Key\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Authority\+Key\+Id()}{x509ParseAuthorityKeyId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Authority\+Key\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509AuthorityKeyId}{X509\+Authority\+Key\+Id} $\ast$}]{auth\+Key\+Id }\end{DoxyParamCaption})}



Parse Authority\+Key\+Identifier extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em auth\+Key\+Id} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1912 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1914 \{
1915    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1916    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1917 
1918    \textcolor{comment}{//Debug message}
1919    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing AuthorityKeyIdentifier...\(\backslash\)r\(\backslash\)n"});
1920 
1921    \textcolor{comment}{//An extension can be marked as critical}
1922    authKeyId->\hyperlink{structX509AuthorityKeyId_a6fcba640adab232183f55a463d066b81}{critical} = critical;
1923 
1924    \textcolor{comment}{//The AuthorityKeyIdentifier structure shall contain a valid sequence}
1925    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1926    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1927    \textcolor{keywordflow}{if}(error)
1928       \textcolor{keywordflow}{return} error;
1929 
1930    \textcolor{comment}{//Point to the first item of the sequence}
1931    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1932    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1933 
1934    \textcolor{comment}{//Parse the content of the sequence}
1935    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1936    \{
1937       \textcolor{comment}{//Read current item}
1938       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1939       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1940       \textcolor{keywordflow}{if}(error)
1941          \textcolor{keywordflow}{return} error;
1942 
1943       \textcolor{comment}{//Explicit tagging shall be used to encode the item}
1944       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
1945          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
1946 
1947       \textcolor{comment}{//keyIdentifier object found?}
1948       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
1949       \{
1950          \textcolor{comment}{//Save the authority key identifier}
1951          authKeyId->\hyperlink{structX509AuthorityKeyId_ab96ff029d18bc7035b698c9b0daa9681}{keyId} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1952          authKeyId->\hyperlink{structX509AuthorityKeyId_ae1cbf5840bbe41649ea904a2f787278d}{keyIdLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1953       \}
1954 
1955       \textcolor{comment}{//Next item}
1956       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1957       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1958    \}
1959 
1960    \textcolor{comment}{//Successful processing}
1961    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1962 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_abf00ff52c398cab7d1dea073565bb483}\label{pkix_2x509__cert__parse_8c_abf00ff52c398cab7d1dea073565bb483}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Basic\+Constraints@{x509\+Parse\+Basic\+Constraints}}
\index{x509\+Parse\+Basic\+Constraints@{x509\+Parse\+Basic\+Constraints}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Basic\+Constraints()}{x509ParseBasicConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Basic\+Constraints (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509BasicConstraints}{X509\+Basic\+Constraints} $\ast$}]{basic\+Constraints }\end{DoxyParamCaption})}



Parse Basic\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em basic\+Constraints} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1233 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1235 \{
1236    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1237    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1238    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1239 
1240    \textcolor{comment}{//Debug message}
1241    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing BasicConstraints...\(\backslash\)r\(\backslash\)n"});
1242 
1243    \textcolor{comment}{//An extension can be marked as critical}
1244    basicConstraints->\hyperlink{structX509BasicConstraints_a188f2fcfc8d1a8da81a6361affeb66e8}{critical} = critical;
1245 
1246    \textcolor{comment}{//The BasicConstraints structure shall contain a valid sequence}
1247    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1248    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1249    \textcolor{keywordflow}{if}(error)
1250       \textcolor{keywordflow}{return} error;
1251 
1252    \textcolor{comment}{//Point to the first item of the sequence}
1253    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1254    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1255 
1256    \textcolor{comment}{//The cA field is optional}
1257    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1258    \{
1259       \textcolor{comment}{//The cA boolean indicates whether the certified public key may be used}
1260       \textcolor{comment}{//to verify certificate signatures}
1261       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1262       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1263       \textcolor{keywordflow}{if}(error)
1264          \textcolor{keywordflow}{return} error;
1265 
1266       \textcolor{comment}{//Enforce encoding, class and type}
1267       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa6e8bd3d6d3cfdc39ccc2891743560462}{ASN1\_TYPE\_BOOLEAN});
1268 
1269       \textcolor{comment}{//Check status code}
1270       \textcolor{keywordflow}{if}(!error)
1271       \{
1272          \textcolor{comment}{//Make sure the length of the boolean is valid}
1273          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
1274             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1275 
1276          \textcolor{comment}{//Get boolean value}
1277          basicConstraints->\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1278 
1279          \textcolor{comment}{//Point to the next item}
1280          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1281          \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1282       \}
1283    \}
1284 
1285    \textcolor{comment}{//The pathLenConstraint field is optional}
1286    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1287    \{
1288       \textcolor{comment}{//Read the pathLenConstraint field}
1289       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &value);
1290       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1291       \textcolor{keywordflow}{if}(error)
1292          \textcolor{keywordflow}{return} error;
1293 
1294       \textcolor{comment}{//The pathLenConstraint field is meaningful only if the cA boolean is}
1295       \textcolor{comment}{//asserted (refer to RFC 5280, section 4.2.1.9)}
1296       \textcolor{keywordflow}{if}(!basicConstraints->\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA})
1297          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1298 
1299       \textcolor{comment}{//Where it appears, the pathLenConstraint field must be greater than or}
1300       \textcolor{comment}{//equal to zero (refer to RFC 5280, section 4.2.1.9)}
1301       \textcolor{keywordflow}{if}(value < 0)
1302          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1303 
1304       \textcolor{comment}{//The pathLenConstraint field gives the maximum number of non-self-issued}
1305       \textcolor{comment}{//intermediate certificates that may follow this certificate in a valid}
1306       \textcolor{comment}{//certification path}
1307       basicConstraints->\hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1308    \}
1309 
1310    \textcolor{comment}{//Successful processing}
1311    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1312 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a0c8997b0f608c1fee25bdd281e7c4acb}\label{pkix_2x509__cert__parse_8c_a0c8997b0f608c1fee25bdd281e7c4acb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Certificate@{x509\+Parse\+Certificate}}
\index{x509\+Parse\+Certificate@{x509\+Parse\+Certificate}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Certificate()}{x509ParseCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$}]{cert\+Info }\end{DoxyParamCaption})}



Parse a X.\+509 certificate. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the X.\+509 certificate to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the X.\+509 certificate \\
\hline
\mbox{\tt out}  & {\em cert\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 63 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
65 \{
66    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
67    \textcolor{keywordtype}{size\_t} totalLength;
68    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
69 
70    \textcolor{comment}{//Debug message}
71    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Parsing X.509 certificate...\(\backslash\)r\(\backslash\)n"});
72 
73    \textcolor{comment}{//Check parameters}
74    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || certInfo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
75       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
76 
77    \textcolor{comment}{//Clear the certificate information structure}
78    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(certInfo, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509CertificateInfo}{X509CertificateInfo}));
79 
80    \textcolor{comment}{//Where pathLenConstraint does not appear, no limit is imposed}
81    certInfo->\hyperlink{structX509CertificateInfo_acfa4445df39031f204f8936a2eec189e}{tbsCert}.\hyperlink{structX509TbsCertificate_aa60d8b8a952d01fd8de02c2da091563e}{extensions}.\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.
      \hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = -1;
82 
83    \textcolor{comment}{//Read the contents of the certificate}
84    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
85    \textcolor{comment}{//Failed to decode ASN.1 tag?}
86    \textcolor{keywordflow}{if}(error)
87       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
88 
89    \textcolor{comment}{//Point to the very first field}
90    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
91    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
92 
93    \textcolor{comment}{//Parse TBSCertificate structure}
94    error = \hyperlink{certificate_2x509__cert__parse_8c_aa7675ee05506115f9b21a18385282630}{x509ParseTbsCertificate}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
95       &certInfo->\hyperlink{structX509CertificateInfo_acfa4445df39031f204f8936a2eec189e}{tbsCert});
96    \textcolor{comment}{//Any error to report?}
97    \textcolor{keywordflow}{if}(error)
98       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
99 
100    \textcolor{comment}{//Point to the next field}
101    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
102    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
103 
104    \textcolor{comment}{//Parse SignatureAlgorithm structure}
105    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
106       &certInfo->\hyperlink{structX509CertificateInfo_a557f43736fe7dab190eac1cd31559281}{signatureAlgo});
107    \textcolor{comment}{//Any error to report?}
108    \textcolor{keywordflow}{if}(error)
109       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
110 
111    \textcolor{comment}{//This field must contain the same algorithm identifier as the signature}
112    \textcolor{comment}{//field in the TBSCertificate sequence (refer to RFC 5280, section 4.1.1.2)}
113    \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(certInfo->\hyperlink{structX509CertificateInfo_a557f43736fe7dab190eac1cd31559281}{signatureAlgo}.\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid}, certInfo->
      \hyperlink{structX509CertificateInfo_a557f43736fe7dab190eac1cd31559281}{signatureAlgo}.\hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen},
114       certInfo->\hyperlink{structX509CertificateInfo_acfa4445df39031f204f8936a2eec189e}{tbsCert}.\hyperlink{structX509TbsCertificate_a6b7b1c8ebc69acd3317d38394961048a}{signatureAlgo}.\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid}, certInfo->
      \hyperlink{structX509CertificateInfo_acfa4445df39031f204f8936a2eec189e}{tbsCert}.\hyperlink{structX509TbsCertificate_a6b7b1c8ebc69acd3317d38394961048a}{signatureAlgo}.\hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen}))
115    \{
116       \textcolor{comment}{//Report an error}
117       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
118    \}
119 
120    \textcolor{comment}{//Point to the next field}
121    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
122    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
123 
124    \textcolor{comment}{//Parse SignatureValue structure}
125    error = \hyperlink{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509ParseSignatureValue}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
126       &certInfo->\hyperlink{structX509CertificateInfo_a14aae7b8131fdc0d1cae4ccc6be1f02d}{signatureValue});
127    \textcolor{comment}{//Any error to report?}
128    \textcolor{keywordflow}{if}(error)
129       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
130 
131    \textcolor{comment}{//Certificate successfully parsed}
132    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
133 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a8d749363df6e0e19f41b6c87d9871afc}\label{pkix_2x509__cert__parse_8c_a8d749363df6e0e19f41b6c87d9871afc}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Extended\+Key\+Usage@{x509\+Parse\+Extended\+Key\+Usage}}
\index{x509\+Parse\+Extended\+Key\+Usage@{x509\+Parse\+Extended\+Key\+Usage}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extended\+Key\+Usage()}{x509ParseExtendedKeyUsage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extended\+Key\+Usage (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509ExtendedKeyUsage}{X509\+Extended\+Key\+Usage} $\ast$}]{ext\+Key\+Usage }\end{DoxyParamCaption})}



Parse Extended\+Key\+Usage extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ext\+Key\+Usage} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1573 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1575 \{
1576    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1577    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1578 
1579    \textcolor{comment}{//Debug message}
1580    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ExtendedKeyUsage...\(\backslash\)r\(\backslash\)n"});
1581 
1582    \textcolor{comment}{//A certificate must not include more than one instance of a particular}
1583    \textcolor{comment}{//extension (refer to RFC 5280, section 4.2)}
1584    \textcolor{keywordflow}{if}(extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} != 0)
1585       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1586 
1587    \textcolor{comment}{//An extension can be marked as critical}
1588    extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_a482c22b220014930529c692a4138e958}{critical} = critical;
1589 
1590    \textcolor{comment}{//The ExtendedKeyUsage structure shall contain a valid sequence}
1591    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1592    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1593    \textcolor{keywordflow}{if}(error)
1594       \textcolor{keywordflow}{return} error;
1595 
1596    \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.12)}
1597    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1598       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1599 
1600    \textcolor{comment}{//Point to the first item of the sequence}
1601    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1602    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1603 
1604    \textcolor{comment}{//This extension indicates one or more purposes for which the certified}
1605    \textcolor{comment}{//public key may be used}
1606    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1607    \{
1608       \textcolor{comment}{//Read KeyPurposeId field}
1609       error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1610       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1611       \textcolor{keywordflow}{if}(error)
1612          \textcolor{keywordflow}{return} error;
1613 
1614       \textcolor{comment}{//anyExtendedKeyUsage?}
1615       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1616          \hyperlink{certificate_2x509__common_8c_a68a4a910638432512485a488e9a162cd}{X509\_ANY\_EXT\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a68a4a910638432512485a488e9a162cd}{X509\_ANY\_EXT\_KEY\_USAGE\_OID})))
1617       \{
1618          \textcolor{comment}{//If a CA includes extended key usages to satisfy such applications,}
1619          \textcolor{comment}{//but does not wish to restrict usages of the key, the CA can include}
1620          \textcolor{comment}{//the special KeyPurposeId anyExtendedKeyUsage}
1621          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca7b28befa17d32564de1990ba5b45e639}{X509\_EXT\_KEY\_USAGE\_ANY};
1622       \}
1623       \textcolor{comment}{//id-kp-serverAuth?}
1624       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1625          \hyperlink{certificate_2x509__common_8c_ae7c9de2f82549acaa3f2b25b56cb187e}{X509\_KP\_SERVER\_AUTH\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae7c9de2f82549acaa3f2b25b56cb187e}{X509\_KP\_SERVER\_AUTH\_OID})))
1626       \{
1627          \textcolor{comment}{//TLS WWW server authentication}
1628          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca63ac39e8e01f7523091284efb3735c76}{X509\_EXT\_KEY\_USAGE\_SERVER\_AUTH};
1629       \}
1630       \textcolor{comment}{//id-kp-clientAuth?}
1631       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1632          \hyperlink{certificate_2x509__common_8c_a837fd5c67b1ec25f4ff5feb51d0e9a6b}{X509\_KP\_CLIENT\_AUTH\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a837fd5c67b1ec25f4ff5feb51d0e9a6b}{X509\_KP\_CLIENT\_AUTH\_OID})))
1633       \{
1634          \textcolor{comment}{//TLS WWW client authentication}
1635          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46caeb140d0686928e663c22c2e032088713}{X509\_EXT\_KEY\_USAGE\_CLIENT\_AUTH};
1636       \}
1637       \textcolor{comment}{//id-kp-codeSigning?}
1638       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1639          \hyperlink{certificate_2x509__common_8c_a17afbafce40d657df96d72ed4c68da1b}{X509\_KP\_CODE\_SIGNING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a17afbafce40d657df96d72ed4c68da1b}{X509\_KP\_CODE\_SIGNING\_OID})))
1640       \{
1641          \textcolor{comment}{//Signing of downloadable executable code}
1642          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca646fedcf77153cb44696361174c99949}{X509\_EXT\_KEY\_USAGE\_CODE\_SIGNING};
1643       \}
1644       \textcolor{comment}{//id-kp-emailProtection?}
1645       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1646          \hyperlink{certificate_2x509__common_8c_a5faa07f49865a76dc91d23067a673a37}{X509\_KP\_EMAIL\_PROTECTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a5faa07f49865a76dc91d23067a673a37}{X509\_KP\_EMAIL\_PROTECTION\_OID})))
1647       \{
1648          \textcolor{comment}{//Email protection}
1649          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46cae38d3955936ea8dabdb3d59e91874b7b}{X509\_EXT\_KEY\_USAGE\_EMAIL\_PROTECTION}
      ;
1650       \}
1651       \textcolor{comment}{//id-kp-timeStamping?}
1652       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1653          \hyperlink{certificate_2x509__common_8c_aeca16b0ea97dd1224378935cea91f6b5}{X509\_KP\_TIME\_STAMPING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_aeca16b0ea97dd1224378935cea91f6b5}{X509\_KP\_TIME\_STAMPING\_OID})))
1654       \{
1655          \textcolor{comment}{//Binding the hash of an object to a time}
1656          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca1900647c6747d7d480869b8e82706986}{X509\_EXT\_KEY\_USAGE\_TIME\_STAMPING};
1657       \}
1658       \textcolor{comment}{//id-kp-OCSPSigning?}
1659       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1660          \hyperlink{certificate_2x509__common_8c_acf696ac09d30d639c1d331e32007b1a9}{X509\_KP\_OCSP\_SIGNING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_acf696ac09d30d639c1d331e32007b1a9}{X509\_KP\_OCSP\_SIGNING\_OID})))
1661       \{
1662          \textcolor{comment}{//Signing OCSP responses}
1663          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca802e45e67a33c7eb0f856f09fce9df0a}{X509\_EXT\_KEY\_USAGE\_OCSP\_SIGNING};
1664       \}
1665       \textcolor{comment}{//Unknown key purpose?}
1666       \textcolor{keywordflow}{else}
1667       \{
1668          \textcolor{comment}{//Discard KeyPurposeId field}
1669       \}
1670 
1671       \textcolor{comment}{//Next item}
1672       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1673       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1674    \}
1675 
1676    \textcolor{comment}{//Successful processing}
1677    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1678 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}\label{pkix_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Extension@{x509\+Parse\+Extension}}
\index{x509\+Parse\+Extension@{x509\+Parse\+Extension}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extension()}{x509ParseExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extension (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Extension}{X509\+Extension} $\ast$}]{extension }\end{DoxyParamCaption})}



Parse X.\+509 certificate extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em extension} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1146 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1148 \{
1149    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1150    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1151 
1152    \textcolor{comment}{//The X.509 extension is encapsulated within a sequence}
1153    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1154    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1155    \textcolor{keywordflow}{if}(error)
1156       \textcolor{keywordflow}{return} error;
1157 
1158    \textcolor{comment}{//Save the total length of the X.509 extension}
1159    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1160 
1161    \textcolor{comment}{//Each extension includes an OID and a value}
1162    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1163    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1164 
1165    \textcolor{comment}{//Read extension OID}
1166    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1167    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1168    \textcolor{keywordflow}{if}(error)
1169       \textcolor{keywordflow}{return} error;
1170 
1171    \textcolor{comment}{//Save the object identifier}
1172    extension->\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1173    extension->\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1174 
1175    \textcolor{comment}{//Next item}
1176    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1177    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1178 
1179    \textcolor{comment}{//Read the Critical flag (if present)}
1180    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1181    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1182    \textcolor{keywordflow}{if}(error)
1183       \textcolor{keywordflow}{return} error;
1184 
1185    \textcolor{comment}{//Enforce encoding, class and type}
1186    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa6e8bd3d6d3cfdc39ccc2891743560462}{ASN1\_TYPE\_BOOLEAN});
1187 
1188    \textcolor{comment}{//Check whether the Critical field is present}
1189    \textcolor{keywordflow}{if}(!error)
1190    \{
1191       \textcolor{comment}{//Make sure the length of the boolean is valid}
1192       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
1193          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1194 
1195       \textcolor{comment}{//Each extension in a certificate is designated as either critical}
1196       \textcolor{comment}{//or non-critical}
1197       extension->\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1198 
1199       \textcolor{comment}{//Next item}
1200       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1201       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1202    \}
1203    \textcolor{keywordflow}{else}
1204    \{
1205       \textcolor{comment}{//The extension is considered as non-critical}
1206       extension->\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1207    \}
1208 
1209    \textcolor{comment}{//The extension value is encapsulated within an octet string}
1210    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1211    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1212    \textcolor{keywordflow}{if}(error)
1213       \textcolor{keywordflow}{return} error;
1214 
1215    \textcolor{comment}{//Save the value of the extension}
1216    extension->\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1217    extension->\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1218 
1219    \textcolor{comment}{//Successful processing}
1220    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1221 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}\label{pkix_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Extensions@{x509\+Parse\+Extensions}}
\index{x509\+Parse\+Extensions@{x509\+Parse\+Extensions}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extensions()}{x509ParseExtensions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extensions (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Extensions}{X509\+Extensions} $\ast$}]{extensions }\end{DoxyParamCaption})}



Parse X.\+509 certificate extensions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em extensions} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 947 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
949 \{
950    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
951    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
952    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
953    \hyperlink{structX509Extension}{X509Extension} extension;
954 
955    \textcolor{comment}{//No more data to process?}
956    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
957    \{
958       \textcolor{comment}{//The Extensions field is optional}
959       *totalLength = 0;
960       \textcolor{comment}{//Exit immediately}
961       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
962    \}
963 
964    \textcolor{comment}{//Explicit tagging is used to encode the Extensions field}
965    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
966    \textcolor{comment}{//Failed to decode ASN.1 tag?}
967    \textcolor{keywordflow}{if}(error)
968       \textcolor{keywordflow}{return} error;
969 
970    \textcolor{comment}{//Enforce encoding, class and type}
971    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       3);
972    \textcolor{comment}{//Invalid tag?}
973    \textcolor{keywordflow}{if}(error)
974    \{
975       \textcolor{comment}{//The Extensions field is optional}
976       *totalLength = 0;
977       \textcolor{comment}{//Exit immediately}
978       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
979    \}
980 
981    \textcolor{comment}{//Save the total length of the field}
982    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
983 
984    \textcolor{comment}{//Debug message}
985    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Extensions...\(\backslash\)r\(\backslash\)n"});
986 
987    \textcolor{comment}{//This field is a sequence of one or more certificate extensions}
988    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
989    \textcolor{comment}{//Failed to decode ASN.1 tag?}
990    \textcolor{keywordflow}{if}(error)
991       \textcolor{keywordflow}{return} error;
992 
993    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
994    extensions->\hyperlink{structX509Extensions_aed67fee9d790d14c3af1381cd07a7e0a}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
995    extensions->\hyperlink{structX509Extensions_affa35283aa7142110b2973474b7b1965}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
996 
997    \textcolor{comment}{//Point to the first item of the sequence}
998    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
999    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1000 
1001    \textcolor{comment}{//Loop through the extensions}
1002    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1003    \{
1004       \textcolor{comment}{//Each extension includes an OID and a value}
1005       error = \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509ParseExtension}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &extension);
1006       \textcolor{comment}{//Any error to report?}
1007       \textcolor{keywordflow}{if}(error)
1008          \textcolor{keywordflow}{return} error;
1009 
1010       \textcolor{comment}{//BasicConstraints extension found?}
1011       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1012          \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID})))
1013       \{
1014          \textcolor{comment}{//Parse BasicConstraints extension}
1015          error = \hyperlink{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}{x509ParseBasicConstraints}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1016             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints});
1017       \}
1018       \textcolor{comment}{//NameConstraints extension found?}
1019       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1020          \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID})))
1021       \{
1022          \textcolor{comment}{//Parse NameConstraints extension}
1023          error = \hyperlink{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}{x509ParseNameConstraints}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1024             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_a25c09f610754fe740c393867ee9950a9}{nameConstraints});
1025       \}
1026 \textcolor{preprocessor}{#if 0}
1027       \textcolor{comment}{//PolicyConstraints extension found?}
1028       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1029          \hyperlink{certificate_2x509__common_8c_add47aa496ac99a30c225ce3b3b5fd1c0}{X509\_POLICY\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_add47aa496ac99a30c225ce3b3b5fd1c0}{X509\_POLICY\_CONSTRAINTS\_OID})))
1030       \{
1031          \textcolor{comment}{//Parse PolicyConstraints extension}
1032          error = \hyperlink{certificate_2x509__cert__parse_8c_a69067e7a8941f2329cbbb3e3a1413887}{x509ParsePolicyConstraints}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1033             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1034       \}
1035       \textcolor{comment}{//PolicyMappings extension found?}
1036       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1037          \hyperlink{certificate_2x509__common_8c_aa356a7336c86eebe80e158f38327f5b1}{X509\_POLICY\_MAPPINGS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_aa356a7336c86eebe80e158f38327f5b1}{X509\_POLICY\_MAPPINGS\_OID})))
1038       \{
1039          \textcolor{comment}{//Parse PolicyMappings extension}
1040          error = \hyperlink{certificate_2x509__cert__parse_8c_a71cf108498b2a57b5306de9f005f5a96}{x509ParsePolicyMappings}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1041             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1042       \}
1043       \textcolor{comment}{//InhibitAnyPolicy extension found?}
1044       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1045          \hyperlink{certificate_2x509__common_8c_acc42689b362dca46f9dcf8e5190edaf0}{X509\_INHIBIT\_ANY\_POLICY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_acc42689b362dca46f9dcf8e5190edaf0}{X509\_INHIBIT\_ANY\_POLICY\_OID})))
1046       \{
1047          \textcolor{comment}{//Parse InhibitAnyPolicy extension}
1048          error = \hyperlink{certificate_2x509__cert__parse_8c_ade6829856343b371abc479c340c3175b}{x509ParseInhibitAnyPolicy}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1049             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1050       \}
1051 \textcolor{preprocessor}{#endif}
1052       \textcolor{comment}{//KeyUsage extension found?}
1053       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1054          \hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID})))
1055       \{
1056          \textcolor{comment}{//Parse KeyUsage extension}
1057          error = \hyperlink{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}{x509ParseKeyUsage}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1058             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage});
1059       \}
1060       \textcolor{comment}{//ExtendedKeyUsage extension found?}
1061       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1062          \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID})))
1063       \{
1064          \textcolor{comment}{//Parse ExtendedKeyUsage extension}
1065          error = \hyperlink{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}{x509ParseExtendedKeyUsage}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1066             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_afad9dec97dd6bba0297e67efd46ff042}{extKeyUsage});
1067       \}
1068       \textcolor{comment}{//SubjectAltName extension found?}
1069       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1070          \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID})))
1071       \{
1072          \textcolor{comment}{//Parse SubjectAltName extension}
1073          error = \hyperlink{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}{x509ParseSubjectAltName}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1074             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_a6a01ce6bc43517af604b8cf580ebd01d}{subjectAltName});
1075       \}
1076       \textcolor{comment}{//SubjectKeyIdentifier extension found?}
1077       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1078          \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID})))
1079       \{
1080          \textcolor{comment}{//Parse SubjectKeyIdentifier extension}
1081          error = \hyperlink{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}{x509ParseSubjectKeyId}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1082             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_a720e6ecde7eba80ee36a83d18a67dfd9}{subjectKeyId});
1083       \}
1084       \textcolor{comment}{//AuthorityKeyIdentifier extension found?}
1085       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1086          \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID})))
1087       \{
1088          \textcolor{comment}{//Parse AuthorityKeyIdentifier extension}
1089          error = \hyperlink{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}{x509ParseAuthorityKeyId}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1090             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_a3c41096ba469c33d9fed4c090f5713fb}{authKeyId});
1091       \}
1092       \textcolor{comment}{//NetscapeCertType extension found?}
1093       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1094          \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID})))
1095       \{
1096          \textcolor{comment}{//Parse NetscapeCertType extension}
1097          error = \hyperlink{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}{x509ParseNsCertType}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
1098             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &extensions->\hyperlink{structX509Extensions_a3600340825a23651f29c87e6da57a4bb}{nsCertType});
1099       \}
1100       \textcolor{comment}{//Unknown extension?}
1101       \textcolor{keywordflow}{else}
1102       \{
1103          \textcolor{comment}{//Check if the extension is marked as critical}
1104          \textcolor{keywordflow}{if}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical})
1105          \{
1106             \textcolor{comment}{//An application must reject the certificate if it encounters a}
1107             \textcolor{comment}{//critical extension it does not recognize or a critical extension}
1108             \textcolor{comment}{//that contains information that it cannot process}
1109             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
1110          \}
1111       \}
1112 
1113       \textcolor{comment}{//Any parsing error?}
1114       \textcolor{keywordflow}{if}(error)
1115          \textcolor{keywordflow}{return} error;
1116 
1117       \textcolor{comment}{//Next extension}
1118       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1119       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1120    \}
1121 
1122    \textcolor{comment}{//Check whether the keyCertSign bit is asserted}
1123    \textcolor{keywordflow}{if}(extensions->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage}.bitmap & \hyperlink{certificate_2x509__common_8h_a071feff2befadce3a4fe5b708cdb149ba2dc6d1748a2dd8a65a7ba5e521a1c054}{X509\_KEY\_USAGE\_KEY\_CERT\_SIGN})
1124    \{
1125       \textcolor{comment}{//If the keyCertSign bit is asserted, then the cA bit in the basic}
1126       \textcolor{comment}{//constraints extension must also be asserted (refer to RFC 5280,}
1127       \textcolor{comment}{//section 4.2.1.3)}
1128       \textcolor{keywordflow}{if}(!extensions->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA})
1129          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1130    \}
1131 
1132    \textcolor{comment}{//Successful processing}
1133    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1134 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}\label{pkix_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+General\+Name@{x509\+Parse\+General\+Name}}
\index{x509\+Parse\+General\+Name@{x509\+Parse\+General\+Name}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Name()}{x509ParseGeneralName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$}]{general\+Name }\end{DoxyParamCaption})}



Parse General\+Name field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em general\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1829 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1831 \{
1832    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1833    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1834 
1835    \textcolor{comment}{//Debug message}
1836    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing GeneralName...\(\backslash\)r\(\backslash\)n"});
1837 
1838    \textcolor{comment}{//Read current item}
1839    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1840    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1841    \textcolor{keywordflow}{if}(error)
1842       \textcolor{keywordflow}{return} error;
1843 
1844    \textcolor{comment}{//Explicit tagging shall be used to encode the subject alternative name}
1845    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
1846       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
1847 
1848    \textcolor{comment}{//Conforming CAs must not issue certificates with subjectAltNames containing}
1849    \textcolor{comment}{//empty GeneralName fields (refer to RFC 5280, section 4.2.1.6)}
1850    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1851       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1852 
1853    \textcolor{comment}{//Save subject alternative name}
1854    generalName->\hyperlink{structX509GeneralName_a014e3358c1ab42d4da4cd2535d59f05f}{type} = (\hyperlink{certificate_2x509__common_8h_a6a82f43a61ee7a3e18d71f986d7f9a59}{X509GeneralNameType}) tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType};
1855    generalName->\hyperlink{structX509GeneralName_a00814b3509e1b708f019a645511e3d3a}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1856    generalName->\hyperlink{structX509GeneralName_a2804f41c9ae3cf1fb375b1d222d4f3af}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1857 
1858    \textcolor{comment}{//Save the total length of the field}
1859    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1860 
1861    \textcolor{comment}{//Successful processing}
1862    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1863 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}\label{pkix_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+General\+Subtree@{x509\+Parse\+General\+Subtree}}
\index{x509\+Parse\+General\+Subtree@{x509\+Parse\+General\+Subtree}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Subtree()}{x509ParseGeneralSubtree()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Subtree (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$}]{general\+Name }\end{DoxyParamCaption})}



Parse General\+Subtree field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em general\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1796 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1798 \{
1799    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1800    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1801    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1802 
1803    \textcolor{comment}{//The GeneralSubtrees structure shall contain a valid sequence}
1804    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1805    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1806    \textcolor{keywordflow}{if}(error)
1807       \textcolor{keywordflow}{return} error;
1808 
1809    \textcolor{comment}{//Save the total length of the field}
1810    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1811 
1812    \textcolor{comment}{//Parse GeneralName field}
1813    error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &n, generalName);
1814 
1815    \textcolor{comment}{//Discard minimum and maximum fields}
1816    \textcolor{keywordflow}{return} error;
1817 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}\label{pkix_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+General\+Subtrees@{x509\+Parse\+General\+Subtrees}}
\index{x509\+Parse\+General\+Subtrees@{x509\+Parse\+General\+Subtrees}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Subtrees()}{x509ParseGeneralSubtrees()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Subtrees (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse General\+Subtrees field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1762 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1763 \{
1764    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1765    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1766    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
1767 
1768    \textcolor{comment}{//Loop through the list of GeneralSubtree fields}
1769    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1770    \{
1771       \textcolor{comment}{//Parse current GeneralSubtree field}
1772       error = \hyperlink{certificate_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}{x509ParseGeneralSubtree}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
1773       \textcolor{comment}{//Any error to report?}
1774       \textcolor{keywordflow}{if}(error)
1775          \textcolor{keywordflow}{return} error;
1776 
1777       \textcolor{comment}{//Next item}
1778       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1779       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1780    \}
1781 
1782    \textcolor{comment}{//Successful processing}
1783    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1784 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_acb3f7c866ea11cc7874fcd94fe9c2ed5}\label{pkix_2x509__cert__parse_8c_acb3f7c866ea11cc7874fcd94fe9c2ed5}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Inhibit\+Any\+Policy@{x509\+Parse\+Inhibit\+Any\+Policy}}
\index{x509\+Parse\+Inhibit\+Any\+Policy@{x509\+Parse\+Inhibit\+Any\+Policy}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Inhibit\+Any\+Policy()}{x509ParseInhibitAnyPolicy()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Inhibit\+Any\+Policy (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Inhibit\+Any\+Policy extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1484 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1486 \{
1487    \textcolor{comment}{//Debug message}
1488    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing InhibitAnyPolicy...\(\backslash\)r\(\backslash\)n"});
1489 
1490    \textcolor{comment}{//Successful processing}
1491    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1492 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}\label{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Int@{x509\+Parse\+Int}}
\index{x509\+Parse\+Int@{x509\+Parse\+Int}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Int()}{x509ParseInt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Int (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Convert string to integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & String containing the representation of an integral number \\
\hline
\mbox{\tt in}  & {\em length} & Length of the string \\
\hline
\mbox{\tt out}  & {\em value} & On success, the function returns the converted integral number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2140 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2141 \{
2142    \textcolor{comment}{//Initialize integer value}
2143    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = 0;
2144 
2145    \textcolor{comment}{//Parse the string}
2146    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2147    \{
2148       \textcolor{comment}{//Check whether the character is decimal digit}
2149       \textcolor{keywordflow}{if}(!\hyperlink{cyclone__crypto_2core_2crypto_8h_a6859cfefa1679722e293755ba4d51ce5}{cryptoIsdigit}(*\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}))
2150          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
2151 
2152       \textcolor{comment}{//Convert the string to integer}
2153       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} * 10 + (*\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} - \textcolor{charliteral}{'0'});
2154 
2155       \textcolor{comment}{//Next character}
2156       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}++;
2157       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}--;
2158    \}
2159 
2160    \textcolor{comment}{//Successful processing}
2161    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2162 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}\label{pkix_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Issuer\+Unique\+Id@{x509\+Parse\+Issuer\+Unique\+Id}}
\index{x509\+Parse\+Issuer\+Unique\+Id@{x509\+Parse\+Issuer\+Unique\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Issuer\+Unique\+Id()}{x509ParseIssuerUniqueId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Issuer\+Unique\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length }\end{DoxyParamCaption})}



Parse Issuer\+Unique\+ID structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 840 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
842 \{
843    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
844    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
845 
846    \textcolor{comment}{//No more data to process?}
847    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
848    \{
849       \textcolor{comment}{//The IssuerUniqueID field is optional}
850       *totalLength = 0;
851       \textcolor{comment}{//Exit immediately}
852       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
853    \}
854 
855    \textcolor{comment}{//Implicit tagging is used to encode the IssuerUniqueID field}
856    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
857    \textcolor{comment}{//Failed to decode ASN.1 tag?}
858    \textcolor{keywordflow}{if}(error)
859       \textcolor{keywordflow}{return} error;
860 
861    \textcolor{comment}{//Enforce encoding, class and type}
862    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       1);
863    \textcolor{comment}{//Invalid tag?}
864    \textcolor{keywordflow}{if}(error)
865    \{
866       \textcolor{comment}{//The IssuerUniqueID field is optional}
867       *totalLength = 0;
868       \textcolor{comment}{//Exit immediately}
869       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
870    \}
871 
872    \textcolor{comment}{//Save the total length of the field}
873    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
874 
875    \textcolor{comment}{//Debug message}
876    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing IssuerUniqueID...\(\backslash\)r\(\backslash\)n"});
877 
878    \textcolor{comment}{//Conforming applications should be capable of parsing certificates that}
879    \textcolor{comment}{//include unique identifiers, but there are no processing requirements}
880    \textcolor{comment}{//associated with the unique identifiers}
881    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
882 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a422fd9c0cb45ce8bdbb39b90ec97b9b2}\label{pkix_2x509__cert__parse_8c_a422fd9c0cb45ce8bdbb39b90ec97b9b2}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Key\+Usage@{x509\+Parse\+Key\+Usage}}
\index{x509\+Parse\+Key\+Usage@{x509\+Parse\+Key\+Usage}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Key\+Usage()}{x509ParseKeyUsage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Key\+Usage (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509KeyUsage}{X509\+Key\+Usage} $\ast$}]{key\+Usage }\end{DoxyParamCaption})}



Parse Key\+Usage extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em key\+Usage} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1504 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1506 \{
1507    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1508    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1509 
1510    \textcolor{comment}{//Debug message}
1511    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing KeyUsage...\(\backslash\)r\(\backslash\)n"});
1512 
1513    \textcolor{comment}{//A certificate must not include more than one instance of a particular}
1514    \textcolor{comment}{//extension (refer to RFC 5280, section 4.2)}
1515    \textcolor{keywordflow}{if}(keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} != 0)
1516       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1517 
1518    \textcolor{comment}{//An extension can be marked as critical}
1519    keyUsage->\hyperlink{structX509KeyUsage_a111fd22c20e3dd57cbc8036432987a57}{critical} = critical;
1520 
1521    \textcolor{comment}{//The key usage extension defines the purpose of the key contained in the}
1522    \textcolor{comment}{//certificate}
1523    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1524    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1525    \textcolor{keywordflow}{if}(error)
1526       \textcolor{keywordflow}{return} error;
1527 
1528    \textcolor{comment}{//Enforce encoding, class and type}
1529    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
1530    \textcolor{comment}{//Invalid tag?}
1531    \textcolor{keywordflow}{if}(error)
1532       \textcolor{keywordflow}{return} error;
1533 
1534    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
1535    \textcolor{comment}{//of unused bits in the final subsequent octet}
1536    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
1537       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1538 
1539    \textcolor{comment}{//Sanity check}
1540    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] >= 8)
1541       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1542 
1543    \textcolor{comment}{//Clear bit string}
1544    keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} = 0;
1545 
1546    \textcolor{comment}{//Read bits b0 to b7}
1547    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 2)
1548       keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[1]);
1549 
1550    \textcolor{comment}{//Read bits b8 to b15}
1551    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 3)
1552       keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[2]) << 8;
1553 
1554    \textcolor{comment}{//When the key usage extension appears in a certificate, at least one of}
1555    \textcolor{comment}{//the bits must be set to 1 (refer to RFC 5280, section 4.2.1.3)}
1556    \textcolor{keywordflow}{if}(keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} == 0)
1557       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1558 
1559    \textcolor{comment}{//Successful processing}
1560    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1561 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}\label{pkix_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Name@{x509\+Parse\+Name}}
\index{x509\+Parse\+Name@{x509\+Parse\+Name}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name()}{x509ParseName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Name}{X509\+Name} $\ast$}]{name }\end{DoxyParamCaption})}



Parse Name structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 417 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
419 \{
420    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
421    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
422    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
423    \hyperlink{structX509NameAttribute}{X509NameAttribute} nameAttribute;
424 
425    \textcolor{comment}{//Debug message}
426    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Name...\(\backslash\)r\(\backslash\)n"});
427 
428    \textcolor{comment}{//Clear the structure}
429    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(name, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509Name}{X509Name}));
430 
431    \textcolor{comment}{//Read the contents of the Name structure}
432    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
433    \textcolor{comment}{//Failed to decode ASN.1 tag?}
434    \textcolor{keywordflow}{if}(error)
435       \textcolor{keywordflow}{return} error;
436 
437    \textcolor{comment}{//Save the total length of the field}
438    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
439 
440    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
441    name->\hyperlink{structX509Name_a16f889e11f79b38a1ade245692857253}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
442    name->\hyperlink{structX509Name_a0f57dd73feee5e3a4aa769fa1ecf3766}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
443 
444    \textcolor{comment}{//The Name describes a hierarchical name composed of attributes}
445    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
446    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
447 
448    \textcolor{comment}{//Loop through all the attributes}
449    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
450    \{
451       \textcolor{comment}{//Read current attribute}
452       error = \hyperlink{certificate_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}{x509ParseNameAttribute}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &nameAttribute);
453       \textcolor{comment}{//Any error to report?}
454       \textcolor{keywordflow}{if}(error)
455          \textcolor{keywordflow}{return} error;
456 
457       \textcolor{comment}{//Common Name attribute found?}
458       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
459          \hyperlink{certificate_2x509__common_8c_a2b21c2e5cf2832b0e88fd6fab5a94e42}{X509\_COMMON\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a2b21c2e5cf2832b0e88fd6fab5a94e42}{X509\_COMMON\_NAME\_OID})))
460       \{
461          name->\hyperlink{structX509Name_a29948ef6424aa86551582e5bf7afa47a}{commonName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
462          name->\hyperlink{structX509Name_a5c5af434bfa902d83cae8cec8af15581}{commonNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
463       \}
464       \textcolor{comment}{//Surname attribute found?}
465       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
466          \hyperlink{certificate_2x509__common_8c_a98f5d48193ddb65ea83893b9e8db5c19}{X509\_SURNAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a98f5d48193ddb65ea83893b9e8db5c19}{X509\_SURNAME\_OID})))
467       \{
468          name->\hyperlink{structX509Name_aa9a667195b0076689e31a6995d925cc0}{surname} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
469          name->\hyperlink{structX509Name_a43f4016488337cbd57078b9b51720645}{surnameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
470       \}
471       \textcolor{comment}{//Serial Number attribute found?}
472       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
473          \hyperlink{certificate_2x509__common_8c_a4641159299e9a03993387e947ab10ed0}{X509\_SERIAL\_NUMBER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a4641159299e9a03993387e947ab10ed0}{X509\_SERIAL\_NUMBER\_OID})))
474       \{
475          name->\hyperlink{structX509Name_ab59d7753a4b9c386e9d10c5ddc609ec5}{serialNumber} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
476          name->\hyperlink{structX509Name_ad24a46ee271b93997a308179a6e8f154}{serialNumberLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
477       \}
478       \textcolor{comment}{//Country Name attribute found?}
479       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
480          \hyperlink{certificate_2x509__common_8c_a358f40098801dee2105f40d48d4d6a3c}{X509\_COUNTRY\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a358f40098801dee2105f40d48d4d6a3c}{X509\_COUNTRY\_NAME\_OID})))
481       \{
482          name->\hyperlink{structX509Name_aebedcf83915608e1929d6cc612a67c2e}{countryName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
483          name->\hyperlink{structX509Name_ae146dda0b021633e3cfc15bda3435bf9}{countryNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
484       \}
485       \textcolor{comment}{//Locality Name attribute found?}
486       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
487          \hyperlink{certificate_2x509__common_8c_a0b268786ad68f63b1e38d64a48e77436}{X509\_LOCALITY\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a0b268786ad68f63b1e38d64a48e77436}{X509\_LOCALITY\_NAME\_OID})))
488       \{
489          name->\hyperlink{structX509Name_a9e5c517817abea85a4ad7a8fa074fb76}{localityName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
490          name->\hyperlink{structX509Name_aba984d3fdf4e5c6eecb90752e54de3a7}{localityNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
491       \}
492       \textcolor{comment}{//State Or Province Name attribute found?}
493       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
494          \hyperlink{certificate_2x509__common_8c_a29d223ee0c7055add854914bad3b0907}{X509\_STATE\_OR\_PROVINCE\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a29d223ee0c7055add854914bad3b0907}{X509\_STATE\_OR\_PROVINCE\_NAME\_OID})))
495       \{
496          name->\hyperlink{structX509Name_ad7101a1d70be5540fc1246c3819383dd}{stateOrProvinceName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
497          name->\hyperlink{structX509Name_a976a693703efcb68deed5c6294d0c95e}{stateOrProvinceNameLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
498       \}
499       \textcolor{comment}{//Organization Name attribute found?}
500       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
501          \hyperlink{certificate_2x509__common_8c_ac425aa6ed62ca6e26603c42a0036bed9}{X509\_ORGANIZATION\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ac425aa6ed62ca6e26603c42a0036bed9}{X509\_ORGANIZATION\_NAME\_OID})))
502       \{
503          name->\hyperlink{structX509Name_a521dfa010d25113b7ebca412a8ef1b6b}{organizationName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
504          name->\hyperlink{structX509Name_af2841192675d2bd0f999533a723d1c1d}{organizationNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
505       \}
506       \textcolor{comment}{//Organizational Unit Name attribute found?}
507       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
508          \hyperlink{certificate_2x509__common_8c_a5e4b5b454f1950a297fa7d74db18a6cd}{X509\_ORGANIZATIONAL\_UNIT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a5e4b5b454f1950a297fa7d74db18a6cd}{X509\_ORGANIZATIONAL\_UNIT\_NAME\_OID})))
509       \{
510          name->\hyperlink{structX509Name_a4095d2020e8553687a85b462fd00eac9}{organizationalUnitName} = nameAttribute.
      \hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
511          name->\hyperlink{structX509Name_a17dc575cf29d256e44331bcb05ea67f0}{organizationalUnitNameLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
512       \}
513       \textcolor{comment}{//Title attribute found?}
514       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
515          \hyperlink{certificate_2x509__common_8c_aff61701a36132aa50d28fd5cf7a9ea0f}{X509\_TITLE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_aff61701a36132aa50d28fd5cf7a9ea0f}{X509\_TITLE\_OID})))
516       \{
517          name->\hyperlink{structX509Name_a5d2ae5a4848f91eccefbeabc69820652}{title} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
518          name->\hyperlink{structX509Name_a0058184d7e0354caeac1e7fdad588b83}{titleLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
519       \}
520       \textcolor{comment}{//Name attribute found?}
521       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
522          \hyperlink{certificate_2x509__common_8c_af6a5d0576cc12caea4ef904c8cbffddd}{X509\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_af6a5d0576cc12caea4ef904c8cbffddd}{X509\_NAME\_OID})))
523       \{
524          name->\hyperlink{structX509Name_a394c9f9f73684a428aae25966b8ba4ca}{name} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
525          name->\hyperlink{structX509Name_a7dbc2e822775eadb3fd3954acdc6f73c}{nameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
526       \}
527       \textcolor{comment}{//Given Name attribute found?}
528       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
529          \hyperlink{certificate_2x509__common_8c_a6dded88e9e1ca6542bf2fce2f18f9002}{X509\_GIVEN\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a6dded88e9e1ca6542bf2fce2f18f9002}{X509\_GIVEN\_NAME\_OID})))
530       \{
531          name->\hyperlink{structX509Name_a17920a6ac4d8f5861eb94d449de21338}{givenName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
532          name->\hyperlink{structX509Name_aacfef579b78cdecc4e865d3a59dc5901}{givenNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
533       \}
534       \textcolor{comment}{//Initials attribute found?}
535       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
536          \hyperlink{certificate_2x509__common_8c_a6b6d6b86ae6068c35861ac70d6b881f8}{X509\_INITIALS\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a6b6d6b86ae6068c35861ac70d6b881f8}{X509\_INITIALS\_OID})))
537       \{
538          name->\hyperlink{structX509Name_a4b7ee284208fc072beb26bd1ab2d8297}{initials} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
539          name->\hyperlink{structX509Name_a2b7b4d29b65c03212c5b2fb3d94c1ab1}{initialsLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
540       \}
541       \textcolor{comment}{//Generation Qualifier attribute found?}
542       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
543          \hyperlink{certificate_2x509__common_8c_af87d6b94adb88574b7bacd0da33240a7}{X509\_GENERATION\_QUALIFIER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_af87d6b94adb88574b7bacd0da33240a7}{X509\_GENERATION\_QUALIFIER\_OID})))
544       \{
545          name->\hyperlink{structX509Name_af795a7195c222e32c6ece85764672094}{generationQualifier} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
546          name->\hyperlink{structX509Name_a295dd5dd5361f04b4f15cfb6d9488d76}{generationQualifierLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
547       \}
548       \textcolor{comment}{//DN Qualifier attribute found?}
549       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
550          \hyperlink{certificate_2x509__common_8c_a734687e867f0ef28c6ffa179dbc51324}{X509\_DN\_QUALIFIER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a734687e867f0ef28c6ffa179dbc51324}{X509\_DN\_QUALIFIER\_OID})))
551       \{
552          name->\hyperlink{structX509Name_aff2c9afbb89584912d7a66f70d2e21ea}{dnQualifier} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
553          name->\hyperlink{structX509Name_a070cb2ee94a282f233a4ee5a23a7374d}{dnQualifierLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
554       \}
555       \textcolor{comment}{//Pseudonym attribute found?}
556       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
557          \hyperlink{certificate_2x509__common_8c_ac6cb01372209cfb385bccdb197214b7d}{X509\_PSEUDONYM\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ac6cb01372209cfb385bccdb197214b7d}{X509\_PSEUDONYM\_OID})))
558       \{
559          name->\hyperlink{structX509Name_ac157a7985fd1b9ea07893de309947823}{pseudonym} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
560          name->\hyperlink{structX509Name_a701db328dc75e341e16cc03f65abf062}{pseudonymLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
561       \}
562       \textcolor{comment}{//Unknown attribute?}
563       \textcolor{keywordflow}{else}
564       \{
565          \textcolor{comment}{//Discard current attribute}
566       \}
567 
568       \textcolor{comment}{//Next attribute}
569       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
570       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
571    \}
572 
573    \textcolor{comment}{//Name field successfully parsed}
574    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
575 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}\label{pkix_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Name\+Attribute@{x509\+Parse\+Name\+Attribute}}
\index{x509\+Parse\+Name\+Attribute@{x509\+Parse\+Name\+Attribute}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name\+Attribute()}{x509ParseNameAttribute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name\+Attribute (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509NameAttribute}{X509\+Name\+Attribute} $\ast$}]{name\+Attribute }\end{DoxyParamCaption})}



Parse name attribute. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em name\+Attribute} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 587 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
589 \{
590    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
591    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
592 
593    \textcolor{comment}{//Attributes are encapsulated within a set}
594    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
595    \textcolor{comment}{//Failed to decode ASN.1 tag?}
596    \textcolor{keywordflow}{if}(error)
597       \textcolor{keywordflow}{return} error;
598 
599    \textcolor{comment}{//Enforce encoding, class and type}
600    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9b2fa570f44ed585417c69fdeead6efa}{ASN1\_TYPE\_SET});
601    \textcolor{comment}{//Invalid tag?}
602    \textcolor{keywordflow}{if}(error)
603       \textcolor{keywordflow}{return} error;
604 
605    \textcolor{comment}{//Save the total length of the attribute}
606    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
607 
608    \textcolor{comment}{//Read the first field of the set}
609    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
610    \textcolor{comment}{//Failed to decode ASN.1 tag?}
611    \textcolor{keywordflow}{if}(error)
612       \textcolor{keywordflow}{return} error;
613 
614    \textcolor{comment}{//Point to the first field of the sequence}
615    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
616    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
617 
618    \textcolor{comment}{//Read attribute type}
619    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
620    \textcolor{comment}{//Failed to decode ASN.1 tag?}
621    \textcolor{keywordflow}{if}(error)
622       \textcolor{keywordflow}{return} error;
623 
624    \textcolor{comment}{//Save attribute type}
625    nameAttribute->\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
626    nameAttribute->\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
627 
628    \textcolor{comment}{//Point to the next field}
629    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
630    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
631 
632    \textcolor{comment}{//Read attribute value}
633    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
634    \textcolor{comment}{//Failed to decode ASN.1 tag?}
635    \textcolor{keywordflow}{if}(error)
636       \textcolor{keywordflow}{return} error;
637 
638    \textcolor{comment}{//Save attribute value}
639    nameAttribute->\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
640    nameAttribute->\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
641 
642    \textcolor{comment}{//Successful processing}
643    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
644 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a6d44bf52961bcab248b5c7c15a9388cf}\label{pkix_2x509__cert__parse_8c_a6d44bf52961bcab248b5c7c15a9388cf}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Name\+Constraints@{x509\+Parse\+Name\+Constraints}}
\index{x509\+Parse\+Name\+Constraints@{x509\+Parse\+Name\+Constraints}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name\+Constraints()}{x509ParseNameConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name\+Constraints (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509NameConstraints}{X509\+Name\+Constraints} $\ast$}]{name\+Constraints }\end{DoxyParamCaption})}



Parse Name\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em name\+Constraints} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1324 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1326 \{
1327    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1328    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1329 
1330    \textcolor{comment}{//Debug message}
1331    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing NameConstraints...\(\backslash\)r\(\backslash\)n"});
1332 
1333    \textcolor{comment}{//An extension can be marked as critical}
1334    nameConstraints->\hyperlink{structX509NameConstraints_a635bd3b8e0e3ec7a232529ad58f9594b}{critical} = critical;
1335 
1336    \textcolor{comment}{//The NameConstraints structure shall contain a valid sequence}
1337    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1338    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1339    \textcolor{keywordflow}{if}(error)
1340       \textcolor{keywordflow}{return} error;
1341 
1342    \textcolor{comment}{//Conforming CAs must not issue certificates where name constraints is an}
1343    \textcolor{comment}{//empty sequence (refer to RFC 5280, section 4.2.1.10)}
1344    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1345       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1346 
1347    \textcolor{comment}{//Point to the first item of the sequence}
1348    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1349    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1350 
1351    \textcolor{comment}{//The name constraints extension indicates a name space within which all}
1352    \textcolor{comment}{//subject names in subsequent certificates in a certification path must}
1353    \textcolor{comment}{//be located}
1354    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1355    \{
1356       \textcolor{comment}{//Parse GeneralSubtrees field}
1357       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1358       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1359       \textcolor{keywordflow}{if}(error)
1360          \textcolor{keywordflow}{return} error;
1361 
1362       \textcolor{comment}{//Explicit tagging shall be used to encode the GeneralSubtrees field}
1363       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
1364          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
1365 
1366       \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.10)}
1367       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1368          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1369 
1370       \textcolor{comment}{//Restrictions are defined in terms of permitted or excluded name subtrees}
1371       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
1372       \{
1373          \textcolor{comment}{//Parse the permittedSubtrees field}
1374          error = \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509ParseGeneralSubtrees}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length});
1375          \textcolor{comment}{//Any error to report?}
1376          \textcolor{keywordflow}{if}(error)
1377             \textcolor{keywordflow}{return} error;
1378 
1379          \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1380          nameConstraints->\hyperlink{structX509NameConstraints_a156421797fb4821bee39cfc265a0c2da}{permittedSubtrees} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1381          nameConstraints->\hyperlink{structX509NameConstraints_aaada0ccb4f22f65db2b71493b14327c0}{permittedSubtreesLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1382       \}
1383       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 1)
1384       \{
1385          \textcolor{comment}{//Parse the excludedSubtrees field}
1386          error = \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509ParseGeneralSubtrees}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length});
1387          \textcolor{comment}{//Any error to report?}
1388          \textcolor{keywordflow}{if}(error)
1389             \textcolor{keywordflow}{return} error;
1390 
1391          \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1392          nameConstraints->\hyperlink{structX509NameConstraints_a187e11b65d21e9eb4c9124c133c0fbbc}{excludedSubtrees} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1393          nameConstraints->\hyperlink{structX509NameConstraints_a5f03d1d2e8b8eddf4f1e99bbb61254af}{excludedSubtreesLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1394       \}
1395       \textcolor{keywordflow}{else}
1396       \{
1397          \textcolor{comment}{//Report an error}
1398          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
1399       \}
1400 
1401       \textcolor{comment}{//Next item}
1402       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1403       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1404    \}
1405 
1406    \textcolor{comment}{//Successful processing}
1407    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1408 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_aa028ba917ab627bbea822b1e29c59d6f}\label{pkix_2x509__cert__parse_8c_aa028ba917ab627bbea822b1e29c59d6f}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Ns\+Cert\+Type@{x509\+Parse\+Ns\+Cert\+Type}}
\index{x509\+Parse\+Ns\+Cert\+Type@{x509\+Parse\+Ns\+Cert\+Type}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ns\+Cert\+Type()}{x509ParseNsCertType()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ns\+Cert\+Type (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509NsCertType}{X509\+Ns\+Cert\+Type} $\ast$}]{ns\+Cert\+Type }\end{DoxyParamCaption})}



Parse Netscape\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ns\+Cert\+Type} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1974 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1976 \{
1977    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1978    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1979 
1980    \textcolor{comment}{//Debug message}
1981    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing NetscapeCertType...\(\backslash\)r\(\backslash\)n"});
1982 
1983    \textcolor{comment}{//An extension can be marked as critical}
1984    nsCertType->\hyperlink{structX509NsCertType_ae633c6008dfd10b8d487d9c4f92eae7b}{critical} = critical;
1985 
1986    \textcolor{comment}{//The NetscapeCertType extension limit the use of a certificate}
1987    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1988    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1989    \textcolor{keywordflow}{if}(error)
1990       \textcolor{keywordflow}{return} error;
1991 
1992    \textcolor{comment}{//Enforce encoding, class and type}
1993    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
1994    \textcolor{comment}{//Invalid tag?}
1995    \textcolor{keywordflow}{if}(error)
1996       \textcolor{keywordflow}{return} error;
1997 
1998    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
1999    \textcolor{comment}{//of unused bits in the final subsequent octet}
2000    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
2001       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2002 
2003    \textcolor{comment}{//Sanity check}
2004    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] >= 8)
2005       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2006 
2007    \textcolor{comment}{//Clear bit string}
2008    nsCertType->\hyperlink{structX509NsCertType_a573466b1c15b14b50697f06c64005917}{bitmap} = 0;
2009 
2010    \textcolor{comment}{//Read bits b0 to b7}
2011    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 2)
2012       nsCertType->\hyperlink{structX509NsCertType_a573466b1c15b14b50697f06c64005917}{bitmap} |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[1]);
2013 
2014    \textcolor{comment}{//Successful processing}
2015    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2016 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a44c40ee0268e0602ec3f9798d05f4c06}\label{pkix_2x509__cert__parse_8c_a44c40ee0268e0602ec3f9798d05f4c06}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Policy\+Constraints@{x509\+Parse\+Policy\+Constraints}}
\index{x509\+Parse\+Policy\+Constraints@{x509\+Parse\+Policy\+Constraints}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Policy\+Constraints()}{x509ParsePolicyConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Policy\+Constraints (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Policy\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1419 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1421 \{
1422    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1423    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1424 
1425    \textcolor{comment}{//Debug message}
1426    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing PolicyConstraints...\(\backslash\)r\(\backslash\)n"});
1427 
1428    \textcolor{comment}{//The PolicyConstraints structure shall contain a valid sequence}
1429    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1430    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1431    \textcolor{keywordflow}{if}(error)
1432       \textcolor{keywordflow}{return} error;
1433 
1434    \textcolor{comment}{//Conforming CAs must not issue certificates where policy constraints is an}
1435    \textcolor{comment}{//empty sequence (refer to RFC 5280, section 4.2.1.11)}
1436    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1437       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1438 
1439    \textcolor{comment}{//Successful processing}
1440    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1441 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a7647b97767de61288b28b741d282c8ce}\label{pkix_2x509__cert__parse_8c_a7647b97767de61288b28b741d282c8ce}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Policy\+Mappings@{x509\+Parse\+Policy\+Mappings}}
\index{x509\+Parse\+Policy\+Mappings@{x509\+Parse\+Policy\+Mappings}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Policy\+Mappings()}{x509ParsePolicyMappings()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Policy\+Mappings (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Policy\+Mappings extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1452 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1454 \{
1455    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1456    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1457 
1458    \textcolor{comment}{//Debug message}
1459    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing PolicyMappings...\(\backslash\)r\(\backslash\)n"});
1460 
1461    \textcolor{comment}{//The PolicyMappings structure shall contain a valid sequence}
1462    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1463    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1464    \textcolor{keywordflow}{if}(error)
1465       \textcolor{keywordflow}{return} error;
1466 
1467    \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.5)}
1468    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1469       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1470 
1471    \textcolor{comment}{//Successful processing}
1472    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1473 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}\label{pkix_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Serial\+Number@{x509\+Parse\+Serial\+Number}}
\index{x509\+Parse\+Serial\+Number@{x509\+Parse\+Serial\+Number}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Serial\+Number()}{x509ParseSerialNumber()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Serial\+Number (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SerialNumber}{X509\+Serial\+Number} $\ast$}]{serial\+Number }\end{DoxyParamCaption})}



Parse Serial\+Number field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em serial\+Number} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 369 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
371 \{
372    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
373    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
374 
375    \textcolor{comment}{//Debug message}
376    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SerialNumber...\(\backslash\)r\(\backslash\)n"});
377 
378    \textcolor{comment}{//Read the contents of the SerialNumber structure}
379    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
380    \textcolor{comment}{//Failed to decode ASN.1 tag?}
381    \textcolor{keywordflow}{if}(error)
382       \textcolor{keywordflow}{return} error;
383 
384    \textcolor{comment}{//Save the total length of the field}
385    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
386 
387    \textcolor{comment}{//Enforce encoding, class and type}
388    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
389    \textcolor{comment}{//Invalid tag?}
390    \textcolor{keywordflow}{if}(error)
391       \textcolor{keywordflow}{return} error;
392 
393    \textcolor{comment}{//Check the length of the serial number}
394    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
395       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
396 
397    \textcolor{comment}{//Non-conforming CAs may issue certificates with serial numbers that are}
398    \textcolor{comment}{//negative or zero. Certificate users should be prepared to gracefully}
399    \textcolor{comment}{//handle such certificates (refer to RFC 5280, section 4.1.2.2)}
400    serialNumber->\hyperlink{structX509SerialNumber_a04490ca0624096caf478beed3331d552}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
401    serialNumber->\hyperlink{structX509SerialNumber_ab076f0a46bcefa47cdc8135d5990ab78}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
402 
403    \textcolor{comment}{//No error to report}
404    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
405 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}\label{pkix_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Signature\+Algo@{x509\+Parse\+Signature\+Algo}}
\index{x509\+Parse\+Signature\+Algo@{x509\+Parse\+Signature\+Algo}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature\+Algo()}{x509ParseSignatureAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$}]{signature\+Algo }\end{DoxyParamCaption})}



Parse Signature\+Algorithm structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature\+Algo} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2028 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2030 \{
2031    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2032    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2033 
2034    \textcolor{comment}{//Debug message}
2035    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing SignatureAlgorithm...\(\backslash\)r\(\backslash\)n"});
2036 
2037    \textcolor{comment}{//Read the contents of the SignatureAlgorithm structure}
2038    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2039    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2040    \textcolor{keywordflow}{if}(error)
2041       \textcolor{keywordflow}{return} error;
2042 
2043    \textcolor{comment}{//Save the total length of the field}
2044    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2045 
2046    \textcolor{comment}{//Point to the first field of the sequence}
2047    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2048    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2049 
2050    \textcolor{comment}{//Read the signature algorithm identifier}
2051    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2052    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2053    \textcolor{keywordflow}{if}(error)
2054       \textcolor{keywordflow}{return} error;
2055 
2056    \textcolor{comment}{//Save the signature algorithm identifier}
2057    signatureAlgo->\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2058    signatureAlgo->\hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2059 
2060    \textcolor{comment}{//Point to the next field (if any)}
2061    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2062    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2063 
2064 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
2065    \textcolor{comment}{//RSASSA-PSS algorithm identifier?}
2066    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
2067    \{
2068       \textcolor{comment}{//Read RSASSA-PSS parameters}
2069       error = \hyperlink{certificate_2x509__cert__parse_8c_aad327c7f3da9180fbf94b8e4363bda40}{x509ParseRsaPssParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
2070          &signatureAlgo->\hyperlink{structX509SignatureAlgoId_aabb448030d8783d06739cdd2c660dde4}{rsaPssParams});
2071    \}
2072    \textcolor{keywordflow}{else}
2073 \textcolor{preprocessor}{#endif}
2074    \textcolor{comment}{//Unknown algorithm identifier?}
2075    \{
2076       \textcolor{comment}{//The parameters are optional}
2077       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2078    \}
2079 
2080    \textcolor{comment}{//Return status code}
2081    \textcolor{keywordflow}{return} error;
2082 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}\label{pkix_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Signature\+Value@{x509\+Parse\+Signature\+Value}}
\index{x509\+Parse\+Signature\+Value@{x509\+Parse\+Signature\+Value}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature\+Value()}{x509ParseSignatureValue()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature\+Value (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureValue}{X509\+Signature\+Value} $\ast$}]{signature\+Value }\end{DoxyParamCaption})}



Parse Signature\+Value field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature\+Value} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2094 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2096 \{
2097    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2098    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2099 
2100    \textcolor{comment}{//Debug message}
2101    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing SignatureValue...\(\backslash\)r\(\backslash\)n"});
2102 
2103    \textcolor{comment}{//Read the contents of the SignatureValue structure}
2104    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2105    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2106    \textcolor{keywordflow}{if}(error)
2107       \textcolor{keywordflow}{return} error;
2108 
2109    \textcolor{comment}{//Save the total length of the field}
2110    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2111 
2112    \textcolor{comment}{//Enforce encoding, class and type}
2113    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
2114    \textcolor{comment}{//Invalid tag?}
2115    \textcolor{keywordflow}{if}(error)
2116       \textcolor{keywordflow}{return} error;
2117 
2118    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
2119    \textcolor{comment}{//of unused bits in the final subsequent octet}
2120    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1 || tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] != 0x00)
2121       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
2122 
2123    \textcolor{comment}{//Get the signature value}
2124    signatureValue->\hyperlink{structX509SignatureValue_a3e53e8589cdfc0c22d30e85bebfa0625}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1;
2125    signatureValue->\hyperlink{structX509SignatureValue_af1bce8baf0e1a46212467145e00079d7}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1;
2126 
2127    \textcolor{comment}{//Successful processing}
2128    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2129 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a1834c4a293deeefdd2190cd797b043eb}\label{pkix_2x509__cert__parse_8c_a1834c4a293deeefdd2190cd797b043eb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Alt\+Name@{x509\+Parse\+Subject\+Alt\+Name}}
\index{x509\+Parse\+Subject\+Alt\+Name@{x509\+Parse\+Subject\+Alt\+Name}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Alt\+Name()}{x509ParseSubjectAltName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Alt\+Name (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509SubjectAltName}{X509\+Subject\+Alt\+Name} $\ast$}]{subject\+Alt\+Name }\end{DoxyParamCaption})}



Parse Subject\+Alt\+Name extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em subject\+Alt\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1690 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1692 \{
1693    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1694    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1695    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1696    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1697    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
1698 
1699    \textcolor{comment}{//Debug message}
1700    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing SubjectAltName...\(\backslash\)r\(\backslash\)n"});
1701 
1702    \textcolor{comment}{//An extension can be marked as critical}
1703    subjectAltName->\hyperlink{structX509SubjectAltName_a9e9447d4bb78391112715c74f6599dbf}{critical} = critical;
1704 
1705    \textcolor{comment}{//The SubjectAltName structure shall contain a valid sequence}
1706    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1707    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1708    \textcolor{keywordflow}{if}(error)
1709       \textcolor{keywordflow}{return} error;
1710 
1711    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1712    subjectAltName->\hyperlink{structX509SubjectAltName_a7d756442bef6565af58ede9410b2dc77}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1713    subjectAltName->\hyperlink{structX509SubjectAltName_a87435ad32eda0d4b0a9229028521812b}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1714 
1715    \textcolor{comment}{//Point to the first item of the sequence}
1716    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1717    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1718 
1719    \textcolor{comment}{//The subject alternative name extension allows identities to be bound to the}
1720    \textcolor{comment}{//subject of the certificate. These identities may be included in addition}
1721    \textcolor{comment}{//to or in place of the identity in the subject field of the certificate}
1722    \textcolor{keywordflow}{for}(i = 0; \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0; i++)
1723    \{
1724       \textcolor{comment}{//Parse GeneralName field}
1725       error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
1726       \textcolor{comment}{//Any error to report?}
1727       \textcolor{keywordflow}{if}(error)
1728          \textcolor{keywordflow}{return} error;
1729 
1730       \textcolor{comment}{//Sanity check}
1731       \textcolor{keywordflow}{if}(i < \hyperlink{certificate_2x509__common_8h_ad4b18644ac42bdeede4fe0b1643ce954}{X509\_MAX\_SUBJECT\_ALT\_NAMES})
1732       \{
1733          \textcolor{comment}{//Save subject alternative name}
1734          subjectAltName->\hyperlink{structX509SubjectAltName_ab4a56143bba771858700f363a8da4647}{generalNames}[i] = generalName;
1735       \}
1736 
1737       \textcolor{comment}{//Next item}
1738       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1739       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1740    \}
1741 
1742    \textcolor{comment}{//If the SubjectAltName extension is present, the sequence must contain at}
1743    \textcolor{comment}{//least one entry (refer to RFC 5280, section 4.2.1.6)}
1744    \textcolor{keywordflow}{if}(i == 0)
1745       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1746 
1747    \textcolor{comment}{//Save the number of subject alternative names}
1748    subjectAltName->\hyperlink{structX509SubjectAltName_a320072e6555af4e2bd76d9d154ef7eca}{numGeneralNames} = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(i, 
      \hyperlink{certificate_2x509__common_8h_ad4b18644ac42bdeede4fe0b1643ce954}{X509\_MAX\_SUBJECT\_ALT\_NAMES});
1749 
1750    \textcolor{comment}{//Successful processing}
1751    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1752 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_abb67592342a7a0bddcb6a9dfa0c6cdb4}\label{pkix_2x509__cert__parse_8c_abb67592342a7a0bddcb6a9dfa0c6cdb4}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Key\+Id@{x509\+Parse\+Subject\+Key\+Id}}
\index{x509\+Parse\+Subject\+Key\+Id@{x509\+Parse\+Subject\+Key\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Key\+Id()}{x509ParseSubjectKeyId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Key\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509SubjectKeyId}{X509\+Subject\+Key\+Id} $\ast$}]{subject\+Key\+Id }\end{DoxyParamCaption})}



Parse Subject\+Key\+Identifier extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em subject\+Key\+Id} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1875 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1877 \{
1878    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1879    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1880 
1881    \textcolor{comment}{//Debug message}
1882    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing SubjectKeyIdentifier...\(\backslash\)r\(\backslash\)n"});
1883 
1884    \textcolor{comment}{//An extension can be marked as critical}
1885    subjectKeyId->\hyperlink{structX509SubjectKeyId_abae7eb488122b99c3413adb35d04d7f2}{critical} = critical;
1886 
1887    \textcolor{comment}{//The subject key identifier extension provides a means of identifying}
1888    \textcolor{comment}{//certificates that contain a particular public key}
1889    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1890    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1891    \textcolor{keywordflow}{if}(error)
1892       \textcolor{keywordflow}{return} error;
1893 
1894    \textcolor{comment}{//Save the subject key identifier}
1895    subjectKeyId->\hyperlink{structX509SubjectKeyId_ac13791883d5af3098c8fcecd596f4737}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1896    subjectKeyId->\hyperlink{structX509SubjectKeyId_ae72259e33329d3224c90547e63f95804}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1897 
1898    \textcolor{comment}{//Successful processing}
1899    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1900 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}\label{pkix_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Unique\+Id@{x509\+Parse\+Subject\+Unique\+Id}}
\index{x509\+Parse\+Subject\+Unique\+Id@{x509\+Parse\+Subject\+Unique\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Unique\+Id()}{x509ParseSubjectUniqueId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Unique\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length }\end{DoxyParamCaption})}



Parse Subject\+Unique\+ID structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 893 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
895 \{
896    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
897    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
898 
899    \textcolor{comment}{//No more data to process?}
900    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
901    \{
902       \textcolor{comment}{//The SubjectUniqueID field is optional}
903       *totalLength = 0;
904       \textcolor{comment}{//Exit immediately}
905       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
906    \}
907 
908    \textcolor{comment}{//Implicit tagging is used to encode the SubjectUniqueID field}
909    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
910    \textcolor{comment}{//Failed to decode ASN.1 tag?}
911    \textcolor{keywordflow}{if}(error)
912       \textcolor{keywordflow}{return} error;
913 
914    \textcolor{comment}{//Enforce encoding, class and type}
915    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       2);
916    \textcolor{comment}{//Invalid tag?}
917    \textcolor{keywordflow}{if}(error)
918    \{
919       \textcolor{comment}{//The SubjectUniqueID field is optional}
920       *totalLength = 0;
921       \textcolor{comment}{//Exit immediately}
922       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
923    \}
924 
925    \textcolor{comment}{//Save the total length of the field}
926    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
927 
928    \textcolor{comment}{//Debug message}
929    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SubjectUniqueID...\(\backslash\)r\(\backslash\)n"});
930 
931    \textcolor{comment}{//Conforming applications should be capable of parsing certificates that}
932    \textcolor{comment}{//include unique identifiers, but there are no processing requirements}
933    \textcolor{comment}{//associated with the unique identifiers}
934    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
935 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a7a0742ff1b43f4cbf588b0d55f8adf33}\label{pkix_2x509__cert__parse_8c_a7a0742ff1b43f4cbf588b0d55f8adf33}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Tbs\+Certificate@{x509\+Parse\+Tbs\+Certificate}}
\index{x509\+Parse\+Tbs\+Certificate@{x509\+Parse\+Tbs\+Certificate}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Tbs\+Certificate()}{x509ParseTbsCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Tbs\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509TbsCertificate}{X509\+Tbs\+Certificate} $\ast$}]{tbs\+Cert }\end{DoxyParamCaption})}



Parse T\+B\+S\+Certificate structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em tbs\+Cert} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 145 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
147 \{
148    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
149    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
150    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
151 
152    \textcolor{comment}{//Debug message}
153    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing TBSCertificate...\(\backslash\)r\(\backslash\)n"});
154 
155    \textcolor{comment}{//Read the contents of the TBSCertificate structure}
156    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
157    \textcolor{comment}{//Failed to decode ASN.1 tag?}
158    \textcolor{keywordflow}{if}(error)
159       \textcolor{keywordflow}{return} error;
160 
161    \textcolor{comment}{//Save the total length of the field}
162    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
163 
164    \textcolor{comment}{//The ASN.1 DER-encoded TBSCertificate is used as the input to the}
165    \textcolor{comment}{//signature function}
166    tbsCert->\hyperlink{structX509TbsCertificate_ace5ec9ea3582843c4e81cdbbe4c3d0aa}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
167    tbsCert->\hyperlink{structX509TbsCertificate_af8694e963e30d044b217305d089e7ecd}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
168 
169    \textcolor{comment}{//Point to the very first field of the TBSCertificate}
170    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
171    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
172 
173    \textcolor{comment}{//Parse Version field}
174    error = \hyperlink{certificate_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}{x509ParseVersion}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version});
175    \textcolor{comment}{//Any parsing error?}
176    \textcolor{keywordflow}{if}(error)
177       \textcolor{keywordflow}{return} error;
178 
179    \textcolor{comment}{//Point to the next field}
180    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
181    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
182 
183    \textcolor{comment}{//Parse SerialNumber field}
184    error = \hyperlink{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}{x509ParseSerialNumber}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_ae21529587634708bc0f5cc3aa0558a3a}{serialNumber});
185    \textcolor{comment}{//Any parsing error?}
186    \textcolor{keywordflow}{if}(error)
187       \textcolor{keywordflow}{return} error;
188 
189    \textcolor{comment}{//Point to the next field}
190    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
191    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
192 
193    \textcolor{comment}{//Parse Signature field}
194    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a6b7b1c8ebc69acd3317d38394961048a}{signatureAlgo});
195    \textcolor{comment}{//Any parsing error?}
196    \textcolor{keywordflow}{if}(error)
197       \textcolor{keywordflow}{return} error;
198 
199    \textcolor{comment}{//Point to the next field}
200    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
201    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
202 
203    \textcolor{comment}{//Parse Issuer field}
204    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a8f9e1f73fbccfe993464a10bf6420a69}{issuer});
205    \textcolor{comment}{//Any parsing error?}
206    \textcolor{keywordflow}{if}(error)
207       \textcolor{keywordflow}{return} error;
208 
209    \textcolor{comment}{//Point to the next field}
210    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
211    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
212 
213    \textcolor{comment}{//Parse Validity field}
214    error = \hyperlink{certificate_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}{x509ParseValidity}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_ad2149392b07cf44a8b6421572a93a70e}{validity});
215    \textcolor{comment}{//Any parsing error?}
216    \textcolor{keywordflow}{if}(error)
217       \textcolor{keywordflow}{return} error;
218 
219    \textcolor{comment}{//Point to the next field}
220    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
221    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
222 
223    \textcolor{comment}{//Parse Subject field}
224    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a68e21bffb3f287f4e57378b275e1d178}{subject});
225    \textcolor{comment}{//Any parsing error?}
226    \textcolor{keywordflow}{if}(error)
227       \textcolor{keywordflow}{return} error;
228 
229    \textcolor{comment}{//Point to the next field}
230    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
231    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
232 
233    \textcolor{comment}{//Parse SubjectPublicKeyInfo field}
234    error = \hyperlink{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}{x509ParseSubjectPublicKeyInfo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
235       &tbsCert->\hyperlink{structX509TbsCertificate_ae6d392cbe0fcd240ab1dabaac465ca95}{subjectPublicKeyInfo});
236    \textcolor{comment}{//Any parsing error?}
237    \textcolor{keywordflow}{if}(error)
238       \textcolor{keywordflow}{return} error;
239 
240    \textcolor{comment}{//Point to the next field}
241    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
242    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
243 
244    \textcolor{comment}{//Parse IssuerUniqueID field}
245    error = \hyperlink{certificate_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}{x509ParseIssuerUniqueId}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
246    \textcolor{comment}{//Any parsing error?}
247    \textcolor{keywordflow}{if}(error)
248       \textcolor{keywordflow}{return} error;
249 
250    \textcolor{comment}{//The IssuerUniqueID field is optional}
251    \textcolor{keywordflow}{if}(n > 0)
252    \{
253       \textcolor{comment}{//This field must only appear if the version is 2 or 3}
254       \textcolor{keywordflow}{if}(tbsCert->\hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
255          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
256    \}
257 
258    \textcolor{comment}{//Point to the next field}
259    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
260    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
261 
262    \textcolor{comment}{//Parse SubjectUniqueID field}
263    error = \hyperlink{certificate_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}{x509ParseSubjectUniqueId}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
264    \textcolor{comment}{//Any parsing error?}
265    \textcolor{keywordflow}{if}(error)
266       \textcolor{keywordflow}{return} error;
267 
268    \textcolor{comment}{//The SubjectUniqueID field is optional}
269    \textcolor{keywordflow}{if}(n > 0)
270    \{
271       \textcolor{comment}{//This field must only appear if the version is 2 or 3}
272       \textcolor{keywordflow}{if}(tbsCert->\hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
273          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
274    \}
275 
276    \textcolor{comment}{//Point to the next field}
277    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
278    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
279 
280    \textcolor{comment}{//Parse Extensions field}
281    error = \hyperlink{certificate_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}{x509ParseExtensions}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_aa60d8b8a952d01fd8de02c2da091563e}{extensions});
282    \textcolor{comment}{//Any parsing error?}
283    \textcolor{keywordflow}{if}(error)
284       \textcolor{keywordflow}{return} error;
285 
286    \textcolor{comment}{//The Extensions field is optional}
287    \textcolor{keywordflow}{if}(n > 0)
288    \{
289       \textcolor{comment}{//This field must only appear if the version is 3}
290       \textcolor{keywordflow}{if}(tbsCert->\hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26addaa01d4830baa29e7e19044f0a656eb}{X509\_VERSION\_3})
291          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
292    \}
293 
294    \textcolor{comment}{//No error to report}
295    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
296 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}\label{pkix_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Time@{x509\+Parse\+Time}}
\index{x509\+Parse\+Time@{x509\+Parse\+Time}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Time()}{x509ParseTime()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Time (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structDateTime}{Date\+Time} $\ast$}]{date\+Time }\end{DoxyParamCaption})}



Parse U\+T\+C\+Time or Generalized\+Time field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em date\+Time} & date resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 709 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
711 \{
712    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
713    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
714    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
715 
716    \textcolor{comment}{//Debug message}
717    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing Time...\(\backslash\)r\(\backslash\)n"});
718 
719    \textcolor{comment}{//Read current ASN.1 tag}
720    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
721    \textcolor{comment}{//Failed to decode ASN.1 tag?}
722    \textcolor{keywordflow}{if}(error)
723       \textcolor{keywordflow}{return} error;
724 
725    \textcolor{comment}{//Save the total length of the field}
726    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
727 
728    \textcolor{comment}{//The date may be encoded as UTCTime or GeneralizedTime}
729    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9f9c0acd29e300911008f2f14d38603d}{ASN1\_TYPE\_UTC\_TIME}))
730    \{
731       \textcolor{comment}{//Check the length of the UTCTime field}
732       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 13)
733          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
734 
735       \textcolor{comment}{//The UTCTime uses a 2-digit representation of the year}
736       error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, 2, &value);
737       \textcolor{comment}{//Any error to report?}
738       \textcolor{keywordflow}{if}(error)
739          \textcolor{keywordflow}{return} error;
740 
741       \textcolor{comment}{//If YY is greater than or equal to 50, the year shall be interpreted}
742       \textcolor{comment}{//as 19YY. If YY is less than 50, the year shall be interpreted as 20YY}
743       \textcolor{keywordflow}{if}(value >= 50)
744          dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 1900 + \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
745       \textcolor{keywordflow}{else}
746          dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 2000 + \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
747 
748       \textcolor{comment}{//Point to the next field}
749       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 2;
750    \}
751    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa27cd934568bfa45864e37d5ba434b3f9}{ASN1\_TYPE\_GENERALIZED\_TIME}))
752    \{
753       \textcolor{comment}{//Check the length of the GeneralizedTime field}
754       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 15)
755          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
756 
757       \textcolor{comment}{//The GeneralizedTime uses a 4-digit representation of the year}
758       error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, 4, &value);
759       \textcolor{comment}{//Any error to report?}
760       \textcolor{keywordflow}{if}(error)
761          \textcolor{keywordflow}{return} error;
762 
763       \textcolor{comment}{//Save the resulting value}
764       dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
765 
766       \textcolor{comment}{//Point to the next field}
767       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 4;
768    \}
769    \textcolor{keywordflow}{else}
770    \{
771       \textcolor{comment}{//The tag does not contain a valid date}
772       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
773    \}
774 
775    \textcolor{comment}{//Month}
776    error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 2, &value);
777    \textcolor{comment}{//Any error to report?}
778    \textcolor{keywordflow}{if}(error)
779       \textcolor{keywordflow}{return} error;
780 
781    \textcolor{comment}{//Save the resulting value}
782    dateTime->\hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
783 
784    \textcolor{comment}{//Day}
785    error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 2, 2, &value);
786    \textcolor{comment}{//Any error to report?}
787    \textcolor{keywordflow}{if}(error)
788       \textcolor{keywordflow}{return} error;
789 
790    \textcolor{comment}{//Save the resulting value}
791    dateTime->\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
792 
793    \textcolor{comment}{//Hours}
794    error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 4, 2, &value);
795    \textcolor{comment}{//Any error to report?}
796    \textcolor{keywordflow}{if}(error)
797       \textcolor{keywordflow}{return} error;
798 
799    \textcolor{comment}{//Save the resulting value}
800    dateTime->\hyperlink{structDateTime_a46fa4e0c13c7fc19c8ae97a5642c4a15}{hours} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
801 
802    \textcolor{comment}{//Minutes}
803    error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 6, 2, &value);
804    \textcolor{comment}{//Any error to report?}
805    \textcolor{keywordflow}{if}(error)
806       \textcolor{keywordflow}{return} error;
807 
808    \textcolor{comment}{//Save the resulting value}
809    dateTime->\hyperlink{structDateTime_a9e705a28fc51e333616553313107d579}{minutes} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
810 
811    \textcolor{comment}{//Seconds}
812    error = \hyperlink{pkix_2x509__cert__parse_8c_a635c796deb07a45dd0ba16daf1d837f9}{x509ParseInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 8, 2, &value);
813    \textcolor{comment}{//Any error to report?}
814    \textcolor{keywordflow}{if}(error)
815       \textcolor{keywordflow}{return} error;
816 
817    \textcolor{comment}{//The encoding shall terminate with a "Z"}
818    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[10] != \textcolor{charliteral}{'Z'})
819       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
820 
821    \textcolor{comment}{//Save the resulting value}
822    dateTime->\hyperlink{structDateTime_a428828f757146b36432b4669e8b27eeb}{seconds} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
823 
824    \textcolor{comment}{//Milliseconds}
825    dateTime->\hyperlink{structDateTime_a8b3982e7347da9a62c2bfc6c273da909}{milliseconds} = 0;
826 
827    \textcolor{comment}{//UTCTime or GeneralizedTime field successfully parsed}
828    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
829 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}\label{pkix_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Validity@{x509\+Parse\+Validity}}
\index{x509\+Parse\+Validity@{x509\+Parse\+Validity}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Validity()}{x509ParseValidity()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Validity (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Validity}{X509\+Validity} $\ast$}]{validity }\end{DoxyParamCaption})}



Parse Validity structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em validity} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 656 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
658 \{
659    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
660    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
661    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
662 
663    \textcolor{comment}{//Debug message}
664    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Validity...\(\backslash\)r\(\backslash\)n"});
665 
666    \textcolor{comment}{//Read the contents of the Validity structure}
667    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
668    \textcolor{comment}{//Failed to decode ASN.1 tag?}
669    \textcolor{keywordflow}{if}(error)
670       \textcolor{keywordflow}{return} error;
671 
672    \textcolor{comment}{//Save the total length of the field}
673    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
674 
675    \textcolor{comment}{//Point to the very first field of the sequence}
676    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
677    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
678 
679    \textcolor{comment}{//The NotBefore field may be encoded as UTCTime or GeneralizedTime}
680    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &validity->
      \hyperlink{structX509Validity_a54d94f88fced1072aaacb4824757aee0}{notBefore});
681    \textcolor{comment}{//Failed to decode ASN.1 tag?}
682    \textcolor{keywordflow}{if}(error)
683       \textcolor{keywordflow}{return} error;
684 
685    \textcolor{comment}{//Point to the next field}
686    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
687    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
688 
689    \textcolor{comment}{//The NotAfter field may be encoded as UTCTime or GeneralizedTime}
690    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &validity->
      \hyperlink{structX509Validity_a23debc3797b2921431fce9658ecc1b73}{notAfter});
691    \textcolor{comment}{//Failed to decode ASN.1 tag?}
692    \textcolor{keywordflow}{if}(error)
693       \textcolor{keywordflow}{return} error;
694 
695    \textcolor{comment}{//Validity field successfully parsed}
696    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
697 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}\label{pkix_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Version@{x509\+Parse\+Version}}
\index{x509\+Parse\+Version@{x509\+Parse\+Version}!pkix/x509\+\_\+cert\+\_\+parse.\+c@{pkix/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Version()}{x509ParseVersion()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Version (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$}]{version }\end{DoxyParamCaption})}



Parse Version field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em version} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 308 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
310 \{
311    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
312    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
313    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
314 
315    \textcolor{comment}{//Debug message}
316    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Version...\(\backslash\)r\(\backslash\)n"});
317 
318    \textcolor{comment}{//Explicit tagging shall be used to encode version}
319    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
320    \textcolor{comment}{//Failed to decode ASN.1 tag?}
321    \textcolor{keywordflow}{if}(error)
322       \textcolor{keywordflow}{return} error;
323 
324    \textcolor{comment}{//Enforce encoding, class and type}
325    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       0);
326 
327    \textcolor{comment}{//Invalid tag?}
328    \textcolor{keywordflow}{if}(error)
329    \{
330       \textcolor{comment}{//Assume X.509 version 1 format}
331       *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26a146bf525f16981660f60fd6c0bdeeee7}{X509\_VERSION\_1};
332       \textcolor{comment}{//Skip the current field}
333       *totalLength = 0;
334 
335       \textcolor{comment}{//Exit immediately}
336       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
337    \}
338 
339    \textcolor{comment}{//Save the total length of the field}
340    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
341 
342    \textcolor{comment}{//Read the inner tag}
343    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag, &value);
344    \textcolor{comment}{//Failed to decode ASN.1 tag?}
345    \textcolor{keywordflow}{if}(error)
346       \textcolor{keywordflow}{return} error;
347 
348    \textcolor{comment}{//Check version field}
349    \textcolor{keywordflow}{if}(value > \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26addaa01d4830baa29e7e19044f0a656eb}{X509\_VERSION\_3})
350       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
351 
352    \textcolor{comment}{//Save certificate version}
353    *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = (\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509Version}) value;
354 
355    \textcolor{comment}{//No error to report}
356    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
357 \}
\end{DoxyCode}
