\hypertarget{snmp__vacm__mib__impl_8h}{}\section{cyclone\+\_\+tcp/mibs/snmp\+\_\+vacm\+\_\+mib\+\_\+impl.h File Reference}
\label{snmp__vacm__mib__impl_8h}\index{cyclone\+\_\+tcp/mibs/snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{cyclone\+\_\+tcp/mibs/snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}


S\+N\+MP V\+A\+CM M\+IB module implementation.  


{\ttfamily \#include \char`\"{}mibs/mib\+\_\+common.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a9bb8f3ea3866a4a9af16212a5ad38947}{snmp\+Vacm\+Mib\+Init} (void)
\begin{DoxyCompactList}\small\item\em S\+N\+MP V\+A\+CM M\+IB module initialization. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a224d5faa59852dc34056f7632bac3406}{snmp\+Vacm\+Mib\+Load} (void $\ast$context)
\begin{DoxyCompactList}\small\item\em Load S\+N\+MP V\+A\+CM M\+IB module. \end{DoxyCompactList}\item 
void \hyperlink{snmp__vacm__mib__impl_8h_ad737b5fb5a8a7edb530aadc596b38185}{snmp\+Vacm\+Mib\+Unload} (void $\ast$context)
\begin{DoxyCompactList}\small\item\em Unload S\+N\+MP V\+A\+CM M\+IB module. \end{DoxyCompactList}\item 
void \hyperlink{snmp__vacm__mib__impl_8h_a3e6c72053ec35776124c60d71fddae0b}{snmp\+Vacm\+Mib\+Lock} (void)
\begin{DoxyCompactList}\small\item\em Lock S\+N\+MP V\+A\+CM M\+IB base. \end{DoxyCompactList}\item 
void \hyperlink{snmp__vacm__mib__impl_8h_a9a9894b8d5828d16cfbc691dd61065ed}{snmp\+Vacm\+Mib\+Unlock} (void)
\begin{DoxyCompactList}\small\item\em Unlock S\+N\+MP V\+A\+CM M\+IB base. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_aca10f0a1000f3ef7e35dd1c13643bf99}{snmp\+Vacm\+Mib\+Get\+Context\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get vacm\+Context\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_acdac1eb25ab8d301091b259687916603}{snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next vacm\+Context\+Entry object. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_aa70d3f29e3a7bf20c217fca46562816f}{snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t value\+Len, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} commit)
\begin{DoxyCompactList}\small\item\em Set vacm\+Security\+To\+Group\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a41a55957add87f3abba2b166056fa99a}{snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get vacm\+Security\+To\+Group\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_ac5df74df0b7bd0386a79e7398c7f51ef}{snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next vacm\+Security\+To\+Group\+Entry object. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a2dbb2b2f5905520e005c33b0bb004f1a}{snmp\+Vacm\+Mib\+Set\+Access\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t value\+Len, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} commit)
\begin{DoxyCompactList}\small\item\em Set vacm\+Access\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_ae55d04b9d53d3b10c003740dc4178b64}{snmp\+Vacm\+Mib\+Get\+Access\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get vacm\+Access\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_aa3c2b1eb595349a9626740e469f9242b}{snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next vacm\+Access\+Entry object. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_addc2160f389eb29adec3bed1b66588c0}{snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t value\+Len, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} commit)
\begin{DoxyCompactList}\small\item\em Set vacm\+View\+Spin\+Lock object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a133715378a49a78a34cf24732aaf484f}{snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get vacm\+View\+Spin\+Lock object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_af88e9c4c7e828354ea879be466fff966}{snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t value\+Len, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} commit)
\begin{DoxyCompactList}\small\item\em Set vacm\+View\+Tree\+Family\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a3c1e1c6c04e8aa6015601b279631f59d}{snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get vacm\+View\+Tree\+Family\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__vacm__mib__impl_8h_a1dbee28281e0aa510014909996896735}{snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next vacm\+View\+Tree\+Family\+Entry object. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+N\+MP V\+A\+CM M\+IB module implementation. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_ae55d04b9d53d3b10c003740dc4178b64}\label{snmp__vacm__mib__impl_8h_ae55d04b9d53d3b10c003740dc4178b64}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Access\+Entry@{snmp\+Vacm\+Mib\+Get\+Access\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Access\+Entry@{snmp\+Vacm\+Mib\+Get\+Access\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Access\+Entry()}{snmpVacmMibGetAccessEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Access\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get vacm\+Access\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1085 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1087 \{
1088    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1089    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1090    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} groupName[\hyperlink{snmp__common_8h_a0810d82091ca56abdd23f86a04944c32}{SNMP\_MAX\_GROUP\_NAME\_LEN} + 1];
1091    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} \hyperlink{ndp_8h_adf7f706b22c25e9ed77265df8517f6fc}{contextPrefix}[\hyperlink{snmp__common_8h_a59ce7ec8feba50f15272257094e14ac8}{SNMP\_MAX\_CONTEXT\_NAME\_LEN} + 1];
1092    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} securityModel;
1093    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} securityLevel;
1094    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
1095    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *entry;
1096 
1097    \textcolor{comment}{//Point to the instance identifier}
1098    n = \textcolor{keywordtype}{object}->oidLen;
1099 
1100    \textcolor{comment}{//vacmGroupName is used as 1st instance identifier}
1101    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, groupName,
1102       \hyperlink{snmp__common_8h_a0810d82091ca56abdd23f86a04944c32}{SNMP\_MAX\_GROUP\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1103    \textcolor{comment}{//Invalid instance identifier?}
1104    \textcolor{keywordflow}{if}(error)
1105       \textcolor{keywordflow}{return} error;
1106 
1107    \textcolor{comment}{//vacmAccessContextPrefix is used as 2nd instance identifier}
1108    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, contextPrefix,
1109       \hyperlink{snmp__common_8h_a59ce7ec8feba50f15272257094e14ac8}{SNMP\_MAX\_CONTEXT\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1110    \textcolor{comment}{//Invalid instance identifier?}
1111    \textcolor{keywordflow}{if}(error)
1112       \textcolor{keywordflow}{return} error;
1113 
1114    \textcolor{comment}{//vacmAccessSecurityModel is used as 3rd instance identifier}
1115    error = \hyperlink{mib__common_8c_a87f69547e6c08947fd243a6a82ca6672}{mibDecodeIndex}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &securityModel);
1116    \textcolor{comment}{//Invalid instance identifier?}
1117    \textcolor{keywordflow}{if}(error)
1118       \textcolor{keywordflow}{return} error;
1119 
1120    \textcolor{comment}{//vacmAccessSecurityLevel is used as 4th instance identifier}
1121    error = \hyperlink{mib__common_8c_a87f69547e6c08947fd243a6a82ca6672}{mibDecodeIndex}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &securityLevel);
1122    \textcolor{comment}{//Invalid instance identifier?}
1123    \textcolor{keywordflow}{if}(error)
1124       \textcolor{keywordflow}{return} error;
1125 
1126    \textcolor{comment}{//Sanity check}
1127    \textcolor{keywordflow}{if}(n != oidLen)
1128       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1129 
1130    \textcolor{comment}{//Point to the SNMP agent context}
1131    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
1132    \textcolor{comment}{//Sanity check}
1133    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1134       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1135 
1136    \textcolor{comment}{//Search the table for a matching row}
1137    entry = \hyperlink{snmp__agent__vacm_8c_a16bfa3443eca536bcb326f47e117dd41}{snmpFindAccessEntry}(context, groupName, contextPrefix,
1138       securityModel, securityLevel);
1139    \textcolor{comment}{//No matching row found?}
1140    \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1141       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1142 
1143    \textcolor{comment}{//vacmAccessContextMatch object?}
1144    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessContextMatch"}))
1145    \{
1146       \textcolor{comment}{//Get object value}
1147       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = entry->\hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch};
1148    \}
1149    \textcolor{comment}{//vacmAccessReadViewName object?}
1150    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessReadViewName"}))
1151    \{
1152       \textcolor{comment}{//Retrieve the length of the read view name}
1153       n = strlen(entry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName});
1154 
1155       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
1156       \textcolor{keywordflow}{if}(*valueLen >= n)
1157       \{
1158          \textcolor{comment}{//Copy object value}
1159          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, entry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}, n);
1160          \textcolor{comment}{//Return object length}
1161          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1162       \}
1163       \textcolor{keywordflow}{else}
1164       \{
1165          \textcolor{comment}{//Report an error}
1166          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1167       \}
1168    \}
1169    \textcolor{comment}{//vacmAccessWriteViewName object?}
1170    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessWriteViewName"}))
1171    \{
1172       \textcolor{comment}{//Retrieve the length of the write view name}
1173       n = strlen(entry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName});
1174 
1175       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
1176       \textcolor{keywordflow}{if}(*valueLen >= n)
1177       \{
1178          \textcolor{comment}{//Copy object value}
1179          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, entry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}, n);
1180          \textcolor{comment}{//Return object length}
1181          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1182       \}
1183       \textcolor{keywordflow}{else}
1184       \{
1185          \textcolor{comment}{//Report an error}
1186          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1187       \}
1188    \}
1189    \textcolor{comment}{//vacmAccessNotifyViewName object?}
1190    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessNotifyViewName"}))
1191    \{
1192       \textcolor{comment}{//Retrieve the length of the notify view name}
1193       n = strlen(entry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName});
1194 
1195       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
1196       \textcolor{keywordflow}{if}(*valueLen >= n)
1197       \{
1198          \textcolor{comment}{//Copy object value}
1199          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, entry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}, n);
1200          \textcolor{comment}{//Return object length}
1201          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1202       \}
1203       \textcolor{keywordflow}{else}
1204       \{
1205          \textcolor{comment}{//Report an error}
1206          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1207       \}
1208    \}
1209    \textcolor{comment}{//vacmAccessStorageType object?}
1210    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessStorageType"}))
1211    \{
1212       \textcolor{comment}{//Get the storage type for this conceptual row}
1213       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE};
1214    \}
1215    \textcolor{comment}{//vacmAccessStatus object?}
1216    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessStatus"}))
1217    \{
1218       \textcolor{comment}{//Get the status of this conceptual row}
1219       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status};
1220    \}
1221    \textcolor{comment}{//Unknown object?}
1222    \textcolor{keywordflow}{else}
1223    \{
1224       \textcolor{comment}{//The specified object does not exist}
1225       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1226    \}
1227 
1228    \textcolor{comment}{//Return status code}
1229    \textcolor{keywordflow}{return} error;
1230 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_aca10f0a1000f3ef7e35dd1c13643bf99}\label{snmp__vacm__mib__impl_8h_aca10f0a1000f3ef7e35dd1c13643bf99}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Context\+Entry@{snmp\+Vacm\+Mib\+Get\+Context\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Context\+Entry@{snmp\+Vacm\+Mib\+Get\+Context\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Context\+Entry()}{snmpVacmMibGetContextEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Context\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get vacm\+Context\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 135 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
137 \{
138    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
139    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
140    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} contextName[\hyperlink{snmp__common_8h_a59ce7ec8feba50f15272257094e14ac8}{SNMP\_MAX\_CONTEXT\_NAME\_LEN} + 1];
141    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
142 
143    \textcolor{comment}{//Point to the instance identifier}
144    n = \textcolor{keywordtype}{object}->oidLen;
145 
146    \textcolor{comment}{//vacmContextName is used as instance identifier}
147    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, contextName,
148       \hyperlink{snmp__common_8h_a59ce7ec8feba50f15272257094e14ac8}{SNMP\_MAX\_CONTEXT\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
149    \textcolor{comment}{//Invalid instance identifier?}
150    \textcolor{keywordflow}{if}(error)
151       \textcolor{keywordflow}{return} error;
152 
153    \textcolor{comment}{//Sanity check}
154    \textcolor{keywordflow}{if}(n != oidLen)
155       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
156 
157    \textcolor{comment}{//Point to the SNMP agent context}
158    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
159    \textcolor{comment}{//Sanity check}
160    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
161       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
162 
163    \textcolor{comment}{//Check context name}
164    \textcolor{keywordflow}{if}(strcmp(contextName, context->contextName))
165       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
166 
167    \textcolor{comment}{//vacmContextName object?}
168    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmContextName"}))
169    \{
170 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
171       \textcolor{comment}{//Retrieve the length of the context name}
172       n = strlen(context->contextName);
173 
174       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
175       \textcolor{keywordflow}{if}(*valueLen >= n)
176       \{
177          \textcolor{comment}{//Copy object value}
178          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, context->contextName, n);
179          \textcolor{comment}{//Return object length}
180          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
181       \}
182       \textcolor{keywordflow}{else}
183       \{
184          \textcolor{comment}{//Report an error}
185          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
186       \}
187 \textcolor{preprocessor}{#else}
188       \textcolor{comment}{//The empty contextName (zero length) represents the default context}
189       *valueLen = 0;
190 \textcolor{preprocessor}{#endif}
191    \}
192    \textcolor{comment}{//Unknown object?}
193    \textcolor{keywordflow}{else}
194    \{
195       \textcolor{comment}{//The specified object does not exist}
196       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
197    \}
198 
199    \textcolor{comment}{//Return status code}
200    \textcolor{keywordflow}{return} error;
201 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_aa3c2b1eb595349a9626740e469f9242b}\label{snmp__vacm__mib__impl_8h_aa3c2b1eb595349a9626740e469f9242b}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry()}{snmpVacmMibGetNextAccessEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Next\+Access\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next vacm\+Access\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1243 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1245 \{
1246    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1247    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1248    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1249    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
1250    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
1251    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *entry;
1252    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *nextEntry;
1253 
1254    \textcolor{comment}{//Initialize variables}
1255    nextEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1256 
1257    \textcolor{comment}{//Point to the SNMP agent context}
1258    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
1259    \textcolor{comment}{//Sanity check}
1260    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1261       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1262 
1263    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
1264    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
1265       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1266 
1267    \textcolor{comment}{//Copy OID prefix}
1268    memcpy(nextOid, object->oid, object->oidLen);
1269 
1270    \textcolor{comment}{//Loop through the list of access rights}
1271    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a8fbe14dcee7eac378b325a34dd7ea056}{SNMP\_AGENT\_ACCESS\_TABLE\_SIZE}; i++)
1272    \{
1273       \textcolor{comment}{//Point to the current entry}
1274       entry = &context->accessTable[i];
1275 
1276       \textcolor{comment}{//Check the status of the row}
1277       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
1278       \{
1279          \textcolor{comment}{//Append the instance identifier to the OID prefix}
1280          n = \textcolor{keywordtype}{object}->oidLen;
1281 
1282          \textcolor{comment}{//vacmGroupName is used as 1st instance identifier}
1283          error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
1284             entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1285          \textcolor{comment}{//Invalid instance identifier?}
1286          \textcolor{keywordflow}{if}(error)
1287             \textcolor{keywordflow}{return} error;
1288 
1289          \textcolor{comment}{//vacmAccessContextPrefix is used as 2nd instance identifier}
1290          error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
1291             entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1292          \textcolor{comment}{//Invalid instance identifier?}
1293          \textcolor{keywordflow}{if}(error)
1294             \textcolor{keywordflow}{return} error;
1295 
1296          \textcolor{comment}{//vacmAccessSecurityModel is used as 3rd instance identifier}
1297          error = \hyperlink{mib__common_8c_aedf45951f2f23c0f1250f087a620dea5}{mibEncodeIndex}(nextOid, *nextOidLen, &n,
1298             entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel});
1299          \textcolor{comment}{//Invalid instance identifier?}
1300          \textcolor{keywordflow}{if}(error)
1301             \textcolor{keywordflow}{return} error;
1302 
1303          \textcolor{comment}{//vacmAccessSecurityLevel is used as 4th instance identifier}
1304          error = \hyperlink{mib__common_8c_aedf45951f2f23c0f1250f087a620dea5}{mibEncodeIndex}(nextOid, *nextOidLen, &n,
1305             entry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel});
1306          \textcolor{comment}{//Invalid instance identifier?}
1307          \textcolor{keywordflow}{if}(error)
1308             \textcolor{keywordflow}{return} error;
1309 
1310          \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
1311          \textcolor{comment}{//follows the specified OID}
1312          \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
1313          \{
1314             \textcolor{comment}{//Perform lexicographic comparison}
1315             \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1316                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1317             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}) < strlen(nextEntry->
      \hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}))
1318                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1319             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}) > strlen(nextEntry->
      \hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}))
1320                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1321             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, nextEntry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}) < 0)
1322                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1323             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, nextEntry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}) > 0)
1324                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1325             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) < strlen(nextEntry->
      \hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}))
1326                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1327             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) > strlen(nextEntry->
      \hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}))
1328                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1329             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, nextEntry->
      \hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) < 0)
1330                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1331             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, nextEntry->
      \hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) > 0)
1332                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1333             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} < nextEntry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel})
1334                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1335             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} > nextEntry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel})
1336                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1337             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel} < nextEntry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel})
1338                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1339             \textcolor{keywordflow}{else}
1340                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1341 
1342             \textcolor{comment}{//Save the closest object identifier that follows the specified}
1343             \textcolor{comment}{//OID in lexicographic order}
1344             \textcolor{keywordflow}{if}(acceptable)
1345                nextEntry = entry;
1346          \}
1347       \}
1348    \}
1349 
1350    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
1351    \textcolor{comment}{//of some object?}
1352    \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1353       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1354 
1355    \textcolor{comment}{//Append the instance identifier to the OID prefix}
1356    n = \textcolor{keywordtype}{object}->oidLen;
1357 
1358    \textcolor{comment}{//vacmGroupName is used as 1st instance identifier}
1359    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
1360       nextEntry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1361    \textcolor{comment}{//Invalid instance identifier?}
1362    \textcolor{keywordflow}{if}(error)
1363       \textcolor{keywordflow}{return} error;
1364 
1365    \textcolor{comment}{//vacmAccessContextPrefix is used as 2nd instance identifier}
1366    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
1367       nextEntry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1368    \textcolor{comment}{//Invalid instance identifier?}
1369    \textcolor{keywordflow}{if}(error)
1370       \textcolor{keywordflow}{return} error;
1371 
1372    \textcolor{comment}{//vacmAccessSecurityModel is used as 3rd instance identifier}
1373    error = \hyperlink{mib__common_8c_aedf45951f2f23c0f1250f087a620dea5}{mibEncodeIndex}(nextOid, *nextOidLen, &n, nextEntry->
      \hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel});
1374    \textcolor{comment}{//Invalid instance identifier?}
1375    \textcolor{keywordflow}{if}(error)
1376       \textcolor{keywordflow}{return} error;
1377 
1378    \textcolor{comment}{//vacmAccessSecurityLevel is used as 4th instance identifier}
1379    error = \hyperlink{mib__common_8c_aedf45951f2f23c0f1250f087a620dea5}{mibEncodeIndex}(nextOid, *nextOidLen, &n, nextEntry->
      \hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel});
1380    \textcolor{comment}{//Invalid instance identifier?}
1381    \textcolor{keywordflow}{if}(error)
1382       \textcolor{keywordflow}{return} error;
1383 
1384    \textcolor{comment}{//Save the length of the resulting object identifier}
1385    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1386    \textcolor{comment}{//Next object found}
1387    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1388 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_acdac1eb25ab8d301091b259687916603}\label{snmp__vacm__mib__impl_8h_acdac1eb25ab8d301091b259687916603}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry()}{snmpVacmMibGetNextContextEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Next\+Context\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next vacm\+Context\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 214 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
216 \{
217    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
218    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
219    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
220 
221    \textcolor{comment}{//Point to the SNMP agent context}
222    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
223    \textcolor{comment}{//Sanity check}
224    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
225       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
226 
227    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
228    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
229       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
230 
231    \textcolor{comment}{//Copy OID prefix}
232    memcpy(nextOid, object->oid, object->oidLen);
233 
234    \textcolor{comment}{//Append the instance identifier to the OID prefix}
235    n = \textcolor{keywordtype}{object}->oidLen;
236 
237 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
238    \textcolor{comment}{//vacmContextName is used as instance identifier}
239    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
240       context->contextName, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
241 \textcolor{preprocessor}{#else}
242    \textcolor{comment}{//The empty contextName (zero length) represents the default context}
243    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n, \textcolor{stringliteral}{""}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
244 \textcolor{preprocessor}{#endif}
245 
246    \textcolor{comment}{//Any error to report?}
247    \textcolor{keywordflow}{if}(error)
248       \textcolor{keywordflow}{return} error;
249 
250    \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
251    \textcolor{comment}{//follows the specified OID}
252    \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
253    \{
254       \textcolor{comment}{//Save the length of the resulting object identifier}
255       *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
256       \textcolor{comment}{//Next object found}
257       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
258    \}
259 
260    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
261    \textcolor{comment}{//of some object}
262    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
263 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_ac5df74df0b7bd0386a79e7398c7f51ef}\label{snmp__vacm__mib__impl_8h_ac5df74df0b7bd0386a79e7398c7f51ef}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry()}{snmpVacmMibGetNextSecurityToGroupEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Next\+Security\+To\+Group\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next vacm\+Security\+To\+Group\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 625 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
627 \{
628    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
629    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
630    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
631    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
632    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
633    \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *entry;
634    \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *nextEntry;
635 
636    \textcolor{comment}{//Initialize variables}
637    nextEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
638 
639    \textcolor{comment}{//Point to the SNMP agent context}
640    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
641    \textcolor{comment}{//Sanity check}
642    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
643       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
644 
645    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
646    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
647       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
648 
649    \textcolor{comment}{//Copy OID prefix}
650    memcpy(nextOid, object->oid, object->oidLen);
651 
652    \textcolor{comment}{//Loop through the list of groups}
653    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a51c46973cabcfc46d84b0dbeb9365752}{SNMP\_AGENT\_GROUP\_TABLE\_SIZE}; i++)
654    \{
655       \textcolor{comment}{//Point to the current entry}
656       entry = &context->groupTable[i];
657 
658       \textcolor{comment}{//Check the status of the row}
659       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
660       \{
661          \textcolor{comment}{//Append the instance identifier to the OID prefix}
662          n = \textcolor{keywordtype}{object}->oidLen;
663 
664          \textcolor{comment}{//vacmSecurityModel is used as 1st instance identifier}
665          error = \hyperlink{mib__common_8c_aedf45951f2f23c0f1250f087a620dea5}{mibEncodeIndex}(nextOid, *nextOidLen, &n, entry->
      \hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel});
666          \textcolor{comment}{//Any error to report?}
667          \textcolor{keywordflow}{if}(error)
668             \textcolor{keywordflow}{return} error;
669 
670          \textcolor{comment}{//vacmSecurityName is used as 2nd instance identifier}
671          error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n, entry->
      \hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName},
672             \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
673          \textcolor{comment}{//Any error to report?}
674          \textcolor{keywordflow}{if}(error)
675             \textcolor{keywordflow}{return} error;
676 
677          \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
678          \textcolor{comment}{//follows the specified OID}
679          \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
680          \{
681             \textcolor{comment}{//Perform lexicographic comparison}
682             \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
683                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
684             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel} < nextEntry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel})
685                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
686             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel} > nextEntry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel})
687                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
688             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}) < strlen(nextEntry->
      \hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}))
689                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
690             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}) > strlen(nextEntry->
      \hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}))
691                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
692             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}, nextEntry->
      \hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}) < 0)
693                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
694             \textcolor{keywordflow}{else}
695                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
696 
697             \textcolor{comment}{//Save the closest object identifier that follows the specified}
698             \textcolor{comment}{//OID in lexicographic order}
699             \textcolor{keywordflow}{if}(acceptable)
700                nextEntry = entry;
701          \}
702       \}
703    \}
704 
705    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
706    \textcolor{comment}{//of some object?}
707    \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
708       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
709 
710    \textcolor{comment}{//Append the instance identifier to the OID prefix}
711    n = \textcolor{keywordtype}{object}->oidLen;
712 
713    \textcolor{comment}{//vacmSecurityModel is used as 1st instance identifier}
714    error = \hyperlink{mib__common_8c_aedf45951f2f23c0f1250f087a620dea5}{mibEncodeIndex}(nextOid, *nextOidLen, &n, nextEntry->
      \hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel});
715    \textcolor{comment}{//Any error to report?}
716    \textcolor{keywordflow}{if}(error)
717       \textcolor{keywordflow}{return} error;
718 
719    \textcolor{comment}{//vacmSecurityName is used as 2nd instance identifier}
720    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
721       nextEntry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
722    \textcolor{comment}{//Any error to report?}
723    \textcolor{keywordflow}{if}(error)
724       \textcolor{keywordflow}{return} error;
725 
726    \textcolor{comment}{//Save the length of the resulting object identifier}
727    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
728    \textcolor{comment}{//Next object found}
729    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
730 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a1dbee28281e0aa510014909996896735}\label{snmp__vacm__mib__impl_8h_a1dbee28281e0aa510014909996896735}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry@{snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry()}{snmpVacmMibGetNextViewTreeFamilyEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Next\+View\+Tree\+Family\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next vacm\+View\+Tree\+Family\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1781 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1783 \{
1784    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1785    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1786    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1787    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
1788    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
1789    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *entry;
1790    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *nextEntry;
1791 
1792    \textcolor{comment}{//Initialize variables}
1793    nextEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1794 
1795    \textcolor{comment}{//Point to the SNMP agent context}
1796    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
1797    \textcolor{comment}{//Sanity check}
1798    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1799       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1800 
1801    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
1802    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
1803       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1804 
1805    \textcolor{comment}{//Copy OID prefix}
1806    memcpy(nextOid, object->oid, object->oidLen);
1807 
1808    \textcolor{comment}{//Loop through the list of MIB views}
1809    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a3bd40db59e400b8c4000a718a6da88e1}{SNMP\_AGENT\_VIEW\_TABLE\_SIZE}; i++)
1810    \{
1811       \textcolor{comment}{//Point to the current entry}
1812       entry = &context->viewTable[i];
1813 
1814       \textcolor{comment}{//Check the status of the row}
1815       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
1816       \{
1817          \textcolor{comment}{//Append the instance identifier to the OID prefix}
1818          n = \textcolor{keywordtype}{object}->oidLen;
1819 
1820          \textcolor{comment}{//vacmViewTreeFamilyViewName is used as 1st instance identifier}
1821          error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
1822             entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1823          \textcolor{comment}{//Invalid instance identifier?}
1824          \textcolor{keywordflow}{if}(error)
1825             \textcolor{keywordflow}{return} error;
1826 
1827          \textcolor{comment}{//vacmViewTreeFamilySubtree is used as 2nd instance identifier}
1828          error = \hyperlink{mib__common_8c_a464c1e3c1d179721c877f39c5aba969f}{mibEncodeObjectIdentifier}(nextOid, *nextOidLen, &n,
1829             entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1830          \textcolor{comment}{//Invalid instance identifier?}
1831          \textcolor{keywordflow}{if}(error)
1832             \textcolor{keywordflow}{return} error;
1833 
1834          \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
1835          \textcolor{comment}{//follows the specified OID}
1836          \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
1837          \{
1838             \textcolor{comment}{//Perform lexicographic comparison}
1839             \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1840                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1841             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}) < strlen(nextEntry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}))
1842                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1843             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}) > strlen(nextEntry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}))
1844                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1845             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, nextEntry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}) < 0)
1846                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1847             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, nextEntry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}) > 0)
1848                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1849             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen} < nextEntry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen})
1850                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1851             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen} > nextEntry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen})
1852                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1853             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(memcmp(entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, nextEntry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, nextEntry->
      \hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen}) < 0)
1854                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1855             \textcolor{keywordflow}{else}
1856                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1857 
1858             \textcolor{comment}{//Save the closest object identifier that follows the specified}
1859             \textcolor{comment}{//OID in lexicographic order}
1860             \textcolor{keywordflow}{if}(acceptable)
1861                nextEntry = entry;
1862          \}
1863       \}
1864    \}
1865 
1866    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
1867    \textcolor{comment}{//of some object?}
1868    \textcolor{keywordflow}{if}(nextEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1869       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1870 
1871    \textcolor{comment}{//Append the instance identifier to the OID prefix}
1872    n = \textcolor{keywordtype}{object}->oidLen;
1873 
1874    \textcolor{comment}{//vacmViewTreeFamilyViewName is used as 1st instance identifier}
1875    error = \hyperlink{mib__common_8c_af9ee67937a6b8128aff72ee3c89dc87f}{mibEncodeString}(nextOid, *nextOidLen, &n,
1876       nextEntry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1877    \textcolor{comment}{//Invalid instance identifier?}
1878    \textcolor{keywordflow}{if}(error)
1879       \textcolor{keywordflow}{return} error;
1880 
1881    \textcolor{comment}{//vacmViewTreeFamilySubtree is used as 2nd instance identifier}
1882    error = \hyperlink{mib__common_8c_a464c1e3c1d179721c877f39c5aba969f}{mibEncodeObjectIdentifier}(nextOid, *nextOidLen, &n,
1883       nextEntry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, nextEntry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1884    \textcolor{comment}{//Invalid instance identifier?}
1885    \textcolor{keywordflow}{if}(error)
1886       \textcolor{keywordflow}{return} error;
1887 
1888    \textcolor{comment}{//Save the length of the resulting object identifier}
1889    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1890    \textcolor{comment}{//Next object found}
1891    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1892 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a41a55957add87f3abba2b166056fa99a}\label{snmp__vacm__mib__impl_8h_a41a55957add87f3abba2b166056fa99a}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry@{snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry@{snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry()}{snmpVacmMibGetSecurityToGroupEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+Security\+To\+Group\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get vacm\+Security\+To\+Group\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 528 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
530 \{
531    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
532    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
533    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} securityModel;
534    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} securityName[\hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN} + 1];
535    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
536    \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *entry;
537 
538    \textcolor{comment}{//Point to the instance identifier}
539    n = \textcolor{keywordtype}{object}->oidLen;
540 
541    \textcolor{comment}{//vacmSecurityModel is used as 1st instance identifier}
542    error = \hyperlink{mib__common_8c_a87f69547e6c08947fd243a6a82ca6672}{mibDecodeIndex}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &securityModel);
543    \textcolor{comment}{//Invalid instance identifier?}
544    \textcolor{keywordflow}{if}(error)
545       \textcolor{keywordflow}{return} error;
546 
547    \textcolor{comment}{//vacmSecurityName is used as 2nd instance identifier}
548    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, securityName,
549       \hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
550    \textcolor{comment}{//Invalid instance identifier?}
551    \textcolor{keywordflow}{if}(error)
552       \textcolor{keywordflow}{return} error;
553 
554    \textcolor{comment}{//Sanity check}
555    \textcolor{keywordflow}{if}(n != oidLen)
556       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
557 
558    \textcolor{comment}{//Point to the SNMP agent context}
559    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
560    \textcolor{comment}{//Sanity check}
561    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
562       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
563 
564    \textcolor{comment}{//Search the table for a matching row}
565    entry = \hyperlink{snmp__agent__vacm_8c_ae62d86e2a0e05b31d66602f6b884e842}{snmpFindGroupEntry}(context, securityModel, securityName,
566       strlen(securityName));
567    \textcolor{comment}{//No matching row found?}
568    \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
569       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
570 
571    \textcolor{comment}{//vacmGroupName object?}
572    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmGroupName"}))
573    \{
574       \textcolor{comment}{//Retrieve the length of the group name}
575       n = strlen(entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName});
576 
577       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
578       \textcolor{keywordflow}{if}(*valueLen >= n)
579       \{
580          \textcolor{comment}{//Copy object value}
581          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}, n);
582          \textcolor{comment}{//Return object length}
583          *valueLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
584       \}
585       \textcolor{keywordflow}{else}
586       \{
587          \textcolor{comment}{//Report an error}
588          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
589       \}
590    \}
591    \textcolor{comment}{//vacmSecurityToGroupStorageType object?}
592    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmSecurityToGroupStorageType"}))
593    \{
594       \textcolor{comment}{//Get the storage type for this conceptual row}
595       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE};
596    \}
597    \textcolor{comment}{//vacmSecurityToGroupStatus object?}
598    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmSecurityToGroupStatus"}))
599    \{
600       \textcolor{comment}{//Get the status of this conceptual row}
601       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status};
602    \}
603    \textcolor{comment}{//Unknown object?}
604    \textcolor{keywordflow}{else}
605    \{
606       \textcolor{comment}{//The specified object does not exist}
607       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
608    \}
609 
610    \textcolor{comment}{//Return status code}
611    \textcolor{keywordflow}{return} error;
612 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a133715378a49a78a34cf24732aaf484f}\label{snmp__vacm__mib__impl_8h_a133715378a49a78a34cf24732aaf484f}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock@{snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock}}
\index{snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock@{snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock()}{snmpVacmMibGetViewSpinLock()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+View\+Spin\+Lock (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get vacm\+View\+Spin\+Lock object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1422 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1424 \{
1425    \textcolor{comment}{//Get the current value of the spin lock}
1426    \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_abafbd601b9a27b6e57d7ef267e9c4874}{vacmViewSpinLock};
1427 
1428    \textcolor{comment}{//Return status code}
1429    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1430 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a3c1e1c6c04e8aa6015601b279631f59d}\label{snmp__vacm__mib__impl_8h_a3c1e1c6c04e8aa6015601b279631f59d}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry@{snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry}}
\index{snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry@{snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry()}{snmpVacmMibGetViewTreeFamilyEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Get\+View\+Tree\+Family\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get vacm\+View\+Tree\+Family\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1678 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1680 \{
1681    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1682    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1683    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} viewName[\hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN} + 1];
1684    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} subtree[\hyperlink{snmp__common_8h_a7eee56441ee1b961702e8b4cbe9586a7}{SNMP\_MAX\_OID\_SIZE}];
1685    \textcolor{keywordtype}{size\_t} subtreeLen;
1686    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
1687    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *entry;
1688 
1689    \textcolor{comment}{//Point to the instance identifier}
1690    n = \textcolor{keywordtype}{object}->oidLen;
1691 
1692    \textcolor{comment}{//vacmViewTreeFamilyViewName is used as 1st instance identifier}
1693    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, viewName,
1694       \hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1695    \textcolor{comment}{//Invalid instance identifier?}
1696    \textcolor{keywordflow}{if}(error)
1697       \textcolor{keywordflow}{return} error;
1698 
1699    \textcolor{comment}{//vacmViewTreeFamilySubtree is used as 2nd instance identifier}
1700    error = \hyperlink{mib__common_8c_a2304625e3e2526d7e90d2726f5770707}{mibDecodeObjectIdentifier}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, subtree,
1701       \hyperlink{snmp__common_8h_a7eee56441ee1b961702e8b4cbe9586a7}{SNMP\_MAX\_OID\_SIZE}, &subtreeLen, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1702    \textcolor{comment}{//Invalid instance identifier?}
1703    \textcolor{keywordflow}{if}(error)
1704       \textcolor{keywordflow}{return} error;
1705 
1706    \textcolor{comment}{//Sanity check}
1707    \textcolor{keywordflow}{if}(n != oidLen)
1708       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1709 
1710    \textcolor{comment}{//Point to the SNMP agent context}
1711    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
1712    \textcolor{comment}{//Sanity check}
1713    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1714       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1715 
1716    \textcolor{comment}{//Search the table for a matching row}
1717    entry = \hyperlink{snmp__agent__vacm_8c_afd75c739785a988749fc503fcd64d325}{snmpFindViewEntry}(context, viewName, subtree, subtreeLen);
1718    \textcolor{comment}{//No matching row found?}
1719    \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1720       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1721 
1722    \textcolor{comment}{//vacmViewTreeFamilyMask object?}
1723    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyMask"}))
1724    \{
1725       \textcolor{comment}{//Make sure the buffer is large enough to hold the entire object}
1726       \textcolor{keywordflow}{if}(*valueLen >= entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen})
1727       \{
1728          \textcolor{comment}{//Copy object value}
1729          memcpy(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, entry->\hyperlink{structSnmpViewEntry_a692738ca6f958b97c6c1b9b58e2f5e91}{mask}, entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen});
1730          \textcolor{comment}{//Return object length}
1731          *valueLen = entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen};
1732       \}
1733       \textcolor{keywordflow}{else}
1734       \{
1735          \textcolor{comment}{//Report an error}
1736          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1737       \}
1738    \}
1739    \textcolor{comment}{//vacmViewTreeFamilyType object?}
1740    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyType"}))
1741    \{
1742       \textcolor{comment}{//This object indicates whether the corresponding instances of}
1743       \textcolor{comment}{//vacmViewTreeFamilySubtree and vacmViewTreeFamilyMask define a family}
1744       \textcolor{comment}{//of view subtrees which is included in or excluded from the MIB view}
1745       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = entry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type};
1746    \}
1747    \textcolor{comment}{//vacmViewTreeFamilyStorageType object?}
1748    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyStorageType"}))
1749    \{
1750       \textcolor{comment}{//Get the storage type for this conceptual row}
1751       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE};
1752    \}
1753    \textcolor{comment}{//vacmViewTreeFamilyStatus object?}
1754    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyStatus"}))
1755    \{
1756       \textcolor{comment}{//Get the status of this conceptual row}
1757       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer = entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status};
1758    \}
1759    \textcolor{comment}{//Unknown object?}
1760    \textcolor{keywordflow}{else}
1761    \{
1762       \textcolor{comment}{//The specified object does not exist}
1763       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1764    \}
1765 
1766    \textcolor{comment}{//Return status code}
1767    \textcolor{keywordflow}{return} error;
1768 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a9bb8f3ea3866a4a9af16212a5ad38947}\label{snmp__vacm__mib__impl_8h_a9bb8f3ea3866a4a9af16212a5ad38947}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Init@{snmp\+Vacm\+Mib\+Init}}
\index{snmp\+Vacm\+Mib\+Init@{snmp\+Vacm\+Mib\+Init}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Init()}{snmpVacmMibInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



S\+N\+MP V\+A\+CM M\+IB module initialization. 

\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 55 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
56 \{
57    \textcolor{comment}{//Debug message}
58    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Initializing SNMP VACM MIB base...\(\backslash\)r\(\backslash\)n"});
59 
60    \textcolor{comment}{//Clear SNMP VACM MIB base}
61    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}, 0, \textcolor{keyword}{sizeof}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}));
62 
63    \textcolor{comment}{//usmUserSpinLock object}
64    \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_abafbd601b9a27b6e57d7ef267e9c4874}{vacmViewSpinLock} = 
      \hyperlink{net_8c_af45ea0afc9806749114ec85e507014e1}{netGetRandRange}(1, \hyperlink{stdint_8h_a181807730d4a375f848ba139813ce04f}{INT32\_MAX});
65 
66    \textcolor{comment}{//Successful processing}
67    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
68 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a224d5faa59852dc34056f7632bac3406}\label{snmp__vacm__mib__impl_8h_a224d5faa59852dc34056f7632bac3406}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Load@{snmp\+Vacm\+Mib\+Load}}
\index{snmp\+Vacm\+Mib\+Load@{snmp\+Vacm\+Mib\+Load}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Load()}{snmpVacmMibLoad()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Load (\begin{DoxyParamCaption}\item[{void $\ast$}]{context }\end{DoxyParamCaption})}



Load S\+N\+MP V\+A\+CM M\+IB module. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 77 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
78 \{
79    \textcolor{comment}{//Register SNMP agent context}
80    \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context} = context;
81 
82    \textcolor{comment}{//Successful processing}
83    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
84 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a3e6c72053ec35776124c60d71fddae0b}\label{snmp__vacm__mib__impl_8h_a3e6c72053ec35776124c60d71fddae0b}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Lock@{snmp\+Vacm\+Mib\+Lock}}
\index{snmp\+Vacm\+Mib\+Lock@{snmp\+Vacm\+Mib\+Lock}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Lock()}{snmpVacmMibLock()}}
{\footnotesize\ttfamily void snmp\+Vacm\+Mib\+Lock (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Lock S\+N\+MP V\+A\+CM M\+IB base. 



Definition at line 103 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
104 \{
105    \textcolor{comment}{//Clear temporary objects}
106    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry}));
107    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry}));
108    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpViewEntry}{SnmpViewEntry}));
109 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a2dbb2b2f5905520e005c33b0bb004f1a}\label{snmp__vacm__mib__impl_8h_a2dbb2b2f5905520e005c33b0bb004f1a}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Set\+Access\+Entry@{snmp\+Vacm\+Mib\+Set\+Access\+Entry}}
\index{snmp\+Vacm\+Mib\+Set\+Access\+Entry@{snmp\+Vacm\+Mib\+Set\+Access\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Set\+Access\+Entry()}{snmpVacmMibSetAccessEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Set\+Access\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t}]{value\+Len,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{commit }\end{DoxyParamCaption})}



Set vacm\+Access\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em value} & Object value \\
\hline
\mbox{\tt in}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\mbox{\tt in}  & {\em commit} & This flag tells whether the changes shall be committed to the M\+IB base \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 745 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
747 \{
748    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
749    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
750    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} groupName[\hyperlink{snmp__common_8h_a0810d82091ca56abdd23f86a04944c32}{SNMP\_MAX\_GROUP\_NAME\_LEN} + 1];
751    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} \hyperlink{ndp_8h_adf7f706b22c25e9ed77265df8517f6fc}{contextPrefix}[\hyperlink{snmp__common_8h_a59ce7ec8feba50f15272257094e14ac8}{SNMP\_MAX\_CONTEXT\_NAME\_LEN} + 1];
752    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} securityModel;
753    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} securityLevel;
754    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
755    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *entry;
756 
757    \textcolor{comment}{//Point to the instance identifier}
758    n = \textcolor{keywordtype}{object}->oidLen;
759 
760    \textcolor{comment}{//vacmGroupName is used as 1st instance identifier}
761    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, groupName,
762       \hyperlink{snmp__common_8h_a0810d82091ca56abdd23f86a04944c32}{SNMP\_MAX\_GROUP\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
763    \textcolor{comment}{//Invalid instance identifier?}
764    \textcolor{keywordflow}{if}(error)
765       \textcolor{keywordflow}{return} error;
766 
767    \textcolor{comment}{//vacmAccessContextPrefix is used as 2nd instance identifier}
768    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, contextPrefix,
769       \hyperlink{snmp__common_8h_a59ce7ec8feba50f15272257094e14ac8}{SNMP\_MAX\_CONTEXT\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
770    \textcolor{comment}{//Invalid instance identifier?}
771    \textcolor{keywordflow}{if}(error)
772       \textcolor{keywordflow}{return} error;
773 
774    \textcolor{comment}{//vacmAccessSecurityModel is used as 3rd instance identifier}
775    error = \hyperlink{mib__common_8c_a87f69547e6c08947fd243a6a82ca6672}{mibDecodeIndex}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &securityModel);
776    \textcolor{comment}{//Invalid instance identifier?}
777    \textcolor{keywordflow}{if}(error)
778       \textcolor{keywordflow}{return} error;
779 
780    \textcolor{comment}{//vacmAccessSecurityLevel is used as 4th instance identifier}
781    error = \hyperlink{mib__common_8c_a87f69547e6c08947fd243a6a82ca6672}{mibDecodeIndex}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &securityLevel);
782    \textcolor{comment}{//Invalid instance identifier?}
783    \textcolor{keywordflow}{if}(error)
784       \textcolor{keywordflow}{return} error;
785 
786    \textcolor{comment}{//Sanity check}
787    \textcolor{keywordflow}{if}(n != oidLen)
788       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
789 
790    \textcolor{comment}{//Make sure the group name is valid}
791    \textcolor{keywordflow}{if}(groupName[0] == \textcolor{charliteral}{'\(\backslash\)0'})
792       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
793 
794    \textcolor{comment}{//Make sure the security model is valid}
795    \textcolor{keywordflow}{if}(securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a9f02fa28fe8ccae6ee20c874584e5de8}{SNMP\_SECURITY\_MODEL\_ANY} &&
796       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695ae3de1e0065ac71136736dfc32a7d6704}{SNMP\_SECURITY\_MODEL\_V1} &&
797       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695ae2bc999bcb1df0c455037f8184589959}{SNMP\_SECURITY\_MODEL\_V2C} &&
798       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a21c6309103699e29211c87fd78c79521}{SNMP\_SECURITY\_MODEL\_USM} &&
799       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695aaa403fb90a2b7947af8cc1fb168936a1}{SNMP\_SECURITY\_MODEL\_TSM})
800    \{
801       \textcolor{comment}{//The security model is not supported}
802       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
803    \}
804 
805    \textcolor{comment}{//Make sure the security level is valid}
806    \textcolor{keywordflow}{if}(securityLevel != \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612ae263055fd5ff66ac93f6d5a1b9885116}{SNMP\_SECURITY\_LEVEL\_NO\_AUTH\_NO\_PRIV} &&
807       securityLevel != \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612adde91d744f2e65bb9eac4f26b7cff9e0}{SNMP\_SECURITY\_LEVEL\_AUTH\_NO\_PRIV} &&
808       securityLevel != \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612ab2d046c82ee883f1d60d66c71b282127}{SNMP\_SECURITY\_LEVEL\_AUTH\_PRIV})
809    \{
810       \textcolor{comment}{//The security level is not supported}
811       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
812    \}
813 
814    \textcolor{comment}{//Point to the SNMP agent context}
815    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
816    \textcolor{comment}{//Sanity check}
817    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
818       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
819 
820    \textcolor{comment}{//Search the table for a matching row}
821    entry = \hyperlink{snmp__agent__vacm_8c_a16bfa3443eca536bcb326f47e117dd41}{snmpFindAccessEntry}(context, groupName, contextPrefix,
822       securityModel, securityLevel);
823 
824    \textcolor{comment}{//vacmAccessContextMatch object?}
825    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessContextMatch"}))
826    \{
827       \textcolor{comment}{//Ensure the value of the object is acceptable}
828       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20a4bc95716a2bab835d5d91ff473f286f9}{SNMP\_CONTEXT\_MATCH\_EXACT} &&
829          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20ae58792f19c0d822290006765a2cffe6c}{SNMP\_CONTEXT\_MATCH\_PREFIX})
830       \{
831          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa89e595b6b9492cadd1e39bcf6b51255}{ERROR\_WRONG\_VALUE};
832       \}
833 
834       \textcolor{comment}{//Test if the conceptual row exists in the agent}
835       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
836       \{
837          \textcolor{comment}{//Commit phase?}
838          \textcolor{keywordflow}{if}(commit)
839          \{
840             \textcolor{comment}{//Set the value of the column}
841             entry->\hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch} = (\hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20}{SnmpContextMatch}) 
      \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
842          \}
843       \}
844       \textcolor{keywordflow}{else}
845       \{
846          \textcolor{comment}{//Prepare phase?}
847          \textcolor{keywordflow}{if}(!commit)
848          \{
849             \textcolor{comment}{//Save the value of the column for later use}
850             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch} = (\hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20}{SnmpContextMatch}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
851          \}
852       \}
853    \}
854    \textcolor{comment}{//vacmAccessReadViewName object?}
855    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessReadViewName"}))
856    \{
857       \textcolor{comment}{//Ensure the length of the read view name is valid}
858       \textcolor{keywordflow}{if}(valueLen > \hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN})
859          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
860 
861       \textcolor{comment}{//Test if the conceptual row exists in the agent}
862       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
863       \{
864          \textcolor{comment}{//Commit phase?}
865          \textcolor{keywordflow}{if}(commit)
866          \{
867             \textcolor{comment}{//Set read view name}
868             memcpy(entry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
869             \textcolor{comment}{//Properly terminate the string with a NULL character}
870             entry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
871          \}
872       \}
873       \textcolor{keywordflow}{else}
874       \{
875          \textcolor{comment}{//Prepare phase?}
876          \textcolor{keywordflow}{if}(!commit)
877          \{
878             \textcolor{comment}{//Save the read view name for later use}
879             memcpy(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName},
880                \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
881 
882             \textcolor{comment}{//Properly terminate the string with a NULL character}
883             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
884          \}
885       \}
886    \}
887    \textcolor{comment}{//vacmAccessWriteViewName object?}
888    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessWriteViewName"}))
889    \{
890       \textcolor{comment}{//Ensure the length of the write view name is valid}
891       \textcolor{keywordflow}{if}(valueLen > \hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN})
892          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
893 
894       \textcolor{comment}{//Test if the conceptual row exists in the agent}
895       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
896       \{
897          \textcolor{comment}{//Commit phase?}
898          \textcolor{keywordflow}{if}(commit)
899          \{
900             \textcolor{comment}{//Set write view name}
901             memcpy(entry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
902             \textcolor{comment}{//Properly terminate the string with a NULL character}
903             entry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
904          \}
905       \}
906       \textcolor{keywordflow}{else}
907       \{
908          \textcolor{comment}{//Prepare phase?}
909          \textcolor{keywordflow}{if}(!commit)
910          \{
911             \textcolor{comment}{//Save the write view name for later use}
912             memcpy(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName},
913                \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
914 
915             \textcolor{comment}{//Properly terminate the string with a NULL character}
916             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
917          \}
918       \}
919    \}
920    \textcolor{comment}{//vacmAccessNotifyViewName object?}
921    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessNotifyViewName"}))
922    \{
923       \textcolor{comment}{//Ensure the length of the notify view name is valid}
924       \textcolor{keywordflow}{if}(valueLen > \hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN})
925          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
926 
927       \textcolor{comment}{//Test if the conceptual row exists in the agent}
928       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
929       \{
930          \textcolor{comment}{//Commit phase?}
931          \textcolor{keywordflow}{if}(commit)
932          \{
933             \textcolor{comment}{//Set notify view name}
934             memcpy(entry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
935             \textcolor{comment}{//Properly terminate the string with a NULL character}
936             entry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
937          \}
938       \}
939       \textcolor{keywordflow}{else}
940       \{
941          \textcolor{comment}{//Prepare phase?}
942          \textcolor{keywordflow}{if}(!commit)
943          \{
944             \textcolor{comment}{//Save the notify view name for later use}
945             memcpy(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName},
946                \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
947 
948             \textcolor{comment}{//Properly terminate the string with a NULL character}
949             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
950          \}
951       \}
952    \}
953    \textcolor{comment}{//vacmAccessStorageType object?}
954    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessStorageType"}))
955    \{
956       \textcolor{comment}{//The vacmAccessStorageType object specifies the storage type}
957       \textcolor{comment}{//for this conceptual row}
958       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa23d8d1e34813d8e160ef1e8f90df167d}{MIB\_STORAGE\_TYPE\_OTHER} &&
959          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE} &&
960          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa08c50a9fa5de427b5fe638fe82a2b40e}{MIB\_STORAGE\_TYPE\_NON\_VOLATILE} &&
961          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa42210747745ce2b0af7d81ca9ac81739}{MIB\_STORAGE\_TYPE\_PERMANENT} &&
962          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa319c608df40b9b341f4d6f13417a9850}{MIB\_STORAGE\_TYPE\_READ\_ONLY})
963       \{
964          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa89e595b6b9492cadd1e39bcf6b51255}{ERROR\_WRONG\_VALUE};
965       \}
966    \}
967    \textcolor{comment}{//vacmAccessStatus object?}
968    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmAccessStatus"}))
969    \{
970       \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus} status;
971 
972       \textcolor{comment}{//Get row status}
973       status = (\hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
974 
975       \textcolor{comment}{//Check the value specified by the set operation}
976       \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE} ||
977          status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE})
978       \{
979          \textcolor{comment}{//No matching row found?}
980          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
981             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
982 
983          \textcolor{comment}{//Commit phase?}
984          \textcolor{keywordflow}{if}(commit)
985          \{
986             \textcolor{comment}{//Update the status of the conceptual row}
987             entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} = status;
988          \}
989       \}
990       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a7e302e94aab90e40035ff0ad48c1aaac}{MIB\_ROW\_STATUS\_CREATE\_AND\_GO} ||
991          status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a236ac2459eae20f25f78db63416b7ac2}{MIB\_ROW\_STATUS\_CREATE\_AND\_WAIT})
992       \{
993          \textcolor{comment}{//Row already instantiated?}
994          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
995             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
996 
997          \textcolor{comment}{//Create a new row}
998          entry = \hyperlink{snmp__agent__vacm_8c_a61ba0b95e342f8b5416fa8bbb3507d3c}{snmpCreateAccessEntry}(context);
999          \textcolor{comment}{//Row creation failed?}
1000          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1001             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
1002 
1003          \textcolor{comment}{//Commit phase?}
1004          \textcolor{keywordflow}{if}(commit)
1005          \{
1006             \textcolor{comment}{//Save group name}
1007             strcpy(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, groupName);
1008             \textcolor{comment}{//Save context name prefix}
1009             strcpy(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, contextPrefix);
1010             \textcolor{comment}{//Save security model}
1011             entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} = (\hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{SnmpSecurityModel}) securityModel;
1012             \textcolor{comment}{//Save security level}
1013             entry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel} = (\hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612}{SnmpSecurityLevel}) securityLevel;
1014 
1015             \textcolor{comment}{//Initialize columns with default values}
1016             entry->\hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch} = \hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20a4bc95716a2bab835d5d91ff473f286f9}{SNMP\_CONTEXT\_MATCH\_EXACT};
1017             entry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}[0] = \textcolor{charliteral}{'\(\backslash\)0'};
1018             entry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}[0] = \textcolor{charliteral}{'\(\backslash\)0'};
1019             entry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}[0] = \textcolor{charliteral}{'\(\backslash\)0'};
1020 
1021             \textcolor{comment}{//Valid context match specified?}
1022             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch} != \hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20ac9a9ef1703fc7f9feb204a476acaf548}{SNMP\_CONTEXT\_MATCH\_INVALID})
1023                entry->\hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch} = \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.\hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch};
1024 
1025             \textcolor{comment}{//Valid read view name specified?}
1026             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
1027                strcpy(entry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName});
1028 
1029             \textcolor{comment}{//Valid write view name specified?}
1030             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
1031                strcpy(entry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName});
1032 
1033             \textcolor{comment}{//Valid notify notify name specified?}
1034             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.
      \hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
1035                strcpy(entry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}.\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName});
1036 
1037             \textcolor{comment}{//The conceptual row has been successfully created}
1038             \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a7e302e94aab90e40035ff0ad48c1aaac}{MIB\_ROW\_STATUS\_CREATE\_AND\_GO})
1039                entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE};
1040             \textcolor{keywordflow}{else}
1041                entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE};
1042          \}
1043       \}
1044       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a705e943dcc8e73d35667b8bdc20d639d}{MIB\_ROW\_STATUS\_DESTROY})
1045       \{
1046          \textcolor{comment}{//Test if the conceptual row exists in the agent}
1047          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1048          \{
1049             \textcolor{comment}{//Commit phase?}
1050             \textcolor{keywordflow}{if}(commit)
1051             \{
1052                \textcolor{comment}{//Delete the conceptual row from the table}
1053                entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED};
1054             \}
1055          \}
1056       \}
1057       \textcolor{keywordflow}{else}
1058       \{
1059          \textcolor{comment}{//Unsupported action}
1060          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
1061       \}
1062    \}
1063    \textcolor{comment}{//Unknown object?}
1064    \textcolor{keywordflow}{else}
1065    \{
1066       \textcolor{comment}{//The specified object does not exist}
1067       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1068    \}
1069 
1070    \textcolor{comment}{//Successful set operation}
1071    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1072 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_aa70d3f29e3a7bf20c217fca46562816f}\label{snmp__vacm__mib__impl_8h_aa70d3f29e3a7bf20c217fca46562816f}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry@{snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry}}
\index{snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry@{snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry()}{snmpVacmMibSetSecurityToGroupEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Set\+Security\+To\+Group\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t}]{value\+Len,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{commit }\end{DoxyParamCaption})}



Set vacm\+Security\+To\+Group\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em value} & Object value \\
\hline
\mbox{\tt in}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\mbox{\tt in}  & {\em commit} & This flag tells whether the changes shall be committed to the M\+IB base \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 278 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
280 \{
281    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
282    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
283    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} securityModel;
284    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} securityName[\hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN} + 1];
285    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
286    \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *entry;
287 
288    \textcolor{comment}{//Point to the instance identifier}
289    n = \textcolor{keywordtype}{object}->oidLen;
290 
291    \textcolor{comment}{//vacmSecurityModel is used as 1st instance identifier}
292    error = \hyperlink{mib__common_8c_a87f69547e6c08947fd243a6a82ca6672}{mibDecodeIndex}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &securityModel);
293    \textcolor{comment}{//Invalid instance identifier?}
294    \textcolor{keywordflow}{if}(error)
295       \textcolor{keywordflow}{return} error;
296 
297    \textcolor{comment}{//vacmSecurityName is used as 2nd instance identifier}
298    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, securityName,
299       \hyperlink{snmp__common_8h_ae889f56d8038ef202bca4b1d974bd53f}{SNMP\_MAX\_USER\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
300    \textcolor{comment}{//Invalid instance identifier?}
301    \textcolor{keywordflow}{if}(error)
302       \textcolor{keywordflow}{return} error;
303 
304    \textcolor{comment}{//Sanity check}
305    \textcolor{keywordflow}{if}(n != oidLen)
306       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
307 
308    \textcolor{comment}{//Make sure the security model is valid}
309    \textcolor{keywordflow}{if}(securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695ae3de1e0065ac71136736dfc32a7d6704}{SNMP\_SECURITY\_MODEL\_V1} &&
310       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695ae2bc999bcb1df0c455037f8184589959}{SNMP\_SECURITY\_MODEL\_V2C} &&
311       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a21c6309103699e29211c87fd78c79521}{SNMP\_SECURITY\_MODEL\_USM} &&
312       securityModel != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695aaa403fb90a2b7947af8cc1fb168936a1}{SNMP\_SECURITY\_MODEL\_TSM})
313    \{
314       \textcolor{comment}{//The security model is not supported}
315       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
316    \}
317 
318    \textcolor{comment}{//Make sure the security name is valid}
319    \textcolor{keywordflow}{if}(securityName[0] == \textcolor{charliteral}{'\(\backslash\)0'})
320       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
321 
322    \textcolor{comment}{//Point to the SNMP agent context}
323    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
324    \textcolor{comment}{//Sanity check}
325    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
326       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
327 
328    \textcolor{comment}{//Search the table for a matching row}
329    entry = \hyperlink{snmp__agent__vacm_8c_ae62d86e2a0e05b31d66602f6b884e842}{snmpFindGroupEntry}(context, securityModel, securityName,
330       strlen(securityName));
331 
332    \textcolor{comment}{//vacmGroupName object?}
333    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmGroupName"}))
334    \{
335       \textcolor{comment}{//Ensure the length of the group name is valid}
336       \textcolor{keywordflow}{if}(valueLen > \hyperlink{snmp__common_8h_a0810d82091ca56abdd23f86a04944c32}{SNMP\_MAX\_GROUP\_NAME\_LEN})
337          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
338 
339       \textcolor{comment}{//Test if the conceptual row exists in the agent}
340       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
341       \{
342          \textcolor{comment}{//Commit phase?}
343          \textcolor{keywordflow}{if}(commit)
344          \{
345             \textcolor{comment}{//Set group name}
346             memcpy(entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
347             \textcolor{comment}{//Properly terminate the string with a NULL character}
348             entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
349          \}
350       \}
351       \textcolor{keywordflow}{else}
352       \{
353          \textcolor{comment}{//Prepare phase?}
354          \textcolor{keywordflow}{if}(!commit)
355          \{
356             \textcolor{comment}{//Save the group name for later use}
357             memcpy(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.
      \hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName},
358                \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
359 
360             \textcolor{comment}{//Properly terminate the string with a NULL character}
361             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.
      \hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[valueLen] = \textcolor{charliteral}{'\(\backslash\)0'};
362          \}
363       \}
364    \}
365    \textcolor{comment}{//vacmSecurityToGroupStorageType object?}
366    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmSecurityToGroupStorageType"}))
367    \{
368       \textcolor{comment}{//The vacmSecurityToGroupStorageType object specifies the storage type}
369       \textcolor{comment}{//for this conceptual row}
370       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa23d8d1e34813d8e160ef1e8f90df167d}{MIB\_STORAGE\_TYPE\_OTHER} &&
371          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE} &&
372          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa08c50a9fa5de427b5fe638fe82a2b40e}{MIB\_STORAGE\_TYPE\_NON\_VOLATILE} &&
373          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa42210747745ce2b0af7d81ca9ac81739}{MIB\_STORAGE\_TYPE\_PERMANENT} &&
374          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa319c608df40b9b341f4d6f13417a9850}{MIB\_STORAGE\_TYPE\_READ\_ONLY})
375       \{
376          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa89e595b6b9492cadd1e39bcf6b51255}{ERROR\_WRONG\_VALUE};
377       \}
378    \}
379    \textcolor{comment}{//vacmSecurityToGroupStatus object?}
380    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmSecurityToGroupStatus"}))
381    \{
382       \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus} status;
383 
384       \textcolor{comment}{//Get row status}
385       status = (\hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
386 
387       \textcolor{comment}{//Check the value specified by the set operation}
388       \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE} ||
389          status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE})
390       \{
391          \textcolor{comment}{//No matching row found?}
392          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
393             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
394 
395          \textcolor{comment}{//Commit phase?}
396          \textcolor{keywordflow}{if}(commit)
397          \{
398             \textcolor{comment}{//Valid group name specified?}
399             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.
      \hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
400                strcpy(entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName});
401 
402             \textcolor{comment}{//A newly created row cannot be made active until a value has been}
403             \textcolor{comment}{//set for vacmGroupName}
404             \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[0] == \textcolor{charliteral}{'\(\backslash\)0'})
405                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
406 
407             \textcolor{comment}{//Update the status of the conceptual row}
408             entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} = status;
409          \}
410       \}
411       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a7e302e94aab90e40035ff0ad48c1aaac}{MIB\_ROW\_STATUS\_CREATE\_AND\_GO})
412       \{
413          \textcolor{comment}{//Row already instantiated?}
414          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
415             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
416 
417          \textcolor{comment}{//Create a new row}
418          entry = \hyperlink{snmp__agent__vacm_8c_a2f852a60dcafbf0b311726bc8e0a255c}{snmpCreateGroupEntry}(context);
419          \textcolor{comment}{//Row creation failed?}
420          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
421             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
422 
423          \textcolor{comment}{//Commit phase?}
424          \textcolor{keywordflow}{if}(commit)
425          \{
426             \textcolor{comment}{//Valid group name specified?}
427             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.
      \hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
428             \{
429                \textcolor{comment}{//Save security model}
430                entry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel} = (\hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{SnmpSecurityModel}) securityModel;
431                \textcolor{comment}{//Save security name}
432                strcpy(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}, securityName);
433                \textcolor{comment}{//Copy the group name}
434                strcpy(entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName});
435 
436                \textcolor{comment}{//The conceptual row is now available for use by the managed device}
437                entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE};
438             \}
439             \textcolor{keywordflow}{else}
440             \{
441                \textcolor{comment}{//The newly created row cannot be made active}
442                \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
443             \}
444          \}
445       \}
446       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a236ac2459eae20f25f78db63416b7ac2}{MIB\_ROW\_STATUS\_CREATE\_AND\_WAIT})
447       \{
448          \textcolor{comment}{//Row already instantiated?}
449          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
450             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
451 
452          \textcolor{comment}{//Create a new row}
453          entry = \hyperlink{snmp__agent__vacm_8c_a2f852a60dcafbf0b311726bc8e0a255c}{snmpCreateGroupEntry}(context);
454          \textcolor{comment}{//Row creation failed?}
455          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
456             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
457 
458          \textcolor{comment}{//Commit phase?}
459          \textcolor{keywordflow}{if}(commit)
460          \{
461             \textcolor{comment}{//Save security model}
462             entry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel} = (\hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{SnmpSecurityModel}) securityModel;
463             \textcolor{comment}{//Save security name}
464             strcpy(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}, securityName);
465 
466             \textcolor{comment}{//Valid group name specified?}
467             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.
      \hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[0] != \textcolor{charliteral}{'\(\backslash\)0'})
468             \{
469                \textcolor{comment}{//Copy the group name}
470                strcpy(entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}.\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName});
471 
472                \textcolor{comment}{//Instances of all corresponding columns are now configured}
473                entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE};
474             \}
475             \textcolor{keywordflow}{else}
476             \{
477                \textcolor{comment}{//Initialize columns with default values}
478                entry->\hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName}[0] = \textcolor{charliteral}{'\(\backslash\)0'};
479 
480                \textcolor{comment}{//Until instances of all corresponding columns are appropriately}
481                \textcolor{comment}{//configured, the value of the corresponding instance of the}
482                \textcolor{comment}{//vacmSecurityToGroupStatus column is notReady}
483                entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097ab6c550e32b731ff9573ce8db2f299a2b}{MIB\_ROW\_STATUS\_NOT\_READY};
484             \}
485          \}
486       \}
487       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a705e943dcc8e73d35667b8bdc20d639d}{MIB\_ROW\_STATUS\_DESTROY})
488       \{
489          \textcolor{comment}{//Test if the conceptual row exists in the agent}
490          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
491          \{
492             \textcolor{comment}{//Commit phase?}
493             \textcolor{keywordflow}{if}(commit)
494             \{
495                \textcolor{comment}{//Delete the conceptual row from the table}
496                entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED};
497             \}
498          \}
499       \}
500       \textcolor{keywordflow}{else}
501       \{
502          \textcolor{comment}{//Unsupported action}
503          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
504       \}
505    \}
506    \textcolor{comment}{//Unknown object?}
507    \textcolor{keywordflow}{else}
508    \{
509       \textcolor{comment}{//The specified object does not exist}
510       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
511    \}
512 
513    \textcolor{comment}{//Return status code}
514    \textcolor{keywordflow}{return} error;
515 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_addc2160f389eb29adec3bed1b66588c0}\label{snmp__vacm__mib__impl_8h_addc2160f389eb29adec3bed1b66588c0}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock@{snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock}}
\index{snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock@{snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock()}{snmpVacmMibSetViewSpinLock()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Set\+View\+Spin\+Lock (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t}]{value\+Len,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{commit }\end{DoxyParamCaption})}



Set vacm\+View\+Spin\+Lock object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em value} & Object value \\
\hline
\mbox{\tt in}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\mbox{\tt in}  & {\em commit} & This flag tells whether the changes shall be committed to the M\+IB base \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1403 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1405 \{
1406    \textcolor{comment}{//Test and increment spin lock}
1407    \textcolor{keywordflow}{return} \hyperlink{mib__common_8c_a8898a2653904cfbf5e06cd1e14b4a37b}{mibTestAndIncSpinLock}(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_abafbd601b9a27b6e57d7ef267e9c4874}{vacmViewSpinLock},
1408       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer, commit);
1409 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_af88e9c4c7e828354ea879be466fff966}\label{snmp__vacm__mib__impl_8h_af88e9c4c7e828354ea879be466fff966}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry@{snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry}}
\index{snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry@{snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry()}{snmpVacmMibSetViewTreeFamilyEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Vacm\+Mib\+Set\+View\+Tree\+Family\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{const \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t}]{value\+Len,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{commit }\end{DoxyParamCaption})}



Set vacm\+View\+Tree\+Family\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt in}  & {\em value} & Object value \\
\hline
\mbox{\tt in}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\mbox{\tt in}  & {\em commit} & This flag tells whether the changes shall be committed to the M\+IB base \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1445 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
1447 \{
1448    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1449    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1450    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} viewName[\hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN} + 1];
1451    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} subtree[\hyperlink{snmp__common_8h_a7eee56441ee1b961702e8b4cbe9586a7}{SNMP\_MAX\_OID\_SIZE}];
1452    \textcolor{keywordtype}{size\_t} subtreeLen;
1453    \hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *context;
1454    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *entry;
1455 
1456    \textcolor{comment}{//Point to the instance identifier}
1457    n = \textcolor{keywordtype}{object}->oidLen;
1458 
1459    \textcolor{comment}{//vacmViewTreeFamilyViewName is used as 1st instance identifier}
1460    error = \hyperlink{mib__common_8c_a1d2f3bd24afe689ea31baf797bbf8f0c}{mibDecodeString}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, viewName,
1461       \hyperlink{snmp__common_8h_a8188d8ada88e9fc2c0a6d2010105b14c}{SNMP\_MAX\_VIEW\_NAME\_LEN}, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1462    \textcolor{comment}{//Invalid instance identifier?}
1463    \textcolor{keywordflow}{if}(error)
1464       \textcolor{keywordflow}{return} error;
1465 
1466    \textcolor{comment}{//vacmViewTreeFamilySubtree is used as 2nd instance identifier}
1467    error = \hyperlink{mib__common_8c_a2304625e3e2526d7e90d2726f5770707}{mibDecodeObjectIdentifier}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, subtree,
1468       \hyperlink{snmp__common_8h_a7eee56441ee1b961702e8b4cbe9586a7}{SNMP\_MAX\_OID\_SIZE}, &subtreeLen, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1469    \textcolor{comment}{//Invalid instance identifier?}
1470    \textcolor{keywordflow}{if}(error)
1471       \textcolor{keywordflow}{return} error;
1472 
1473    \textcolor{comment}{//Sanity check}
1474    \textcolor{keywordflow}{if}(n != oidLen)
1475       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1476 
1477    \textcolor{comment}{//Make sure the view name is valid}
1478    \textcolor{keywordflow}{if}(viewName[0] == \textcolor{charliteral}{'\(\backslash\)0'})
1479       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1480 
1481    \textcolor{comment}{//Point to the SNMP agent context}
1482    context = (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{SnmpAgentContext} *) \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context};
1483    \textcolor{comment}{//Sanity check}
1484    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1485       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
1486 
1487    \textcolor{comment}{//Search the table for a matching row}
1488    entry = \hyperlink{snmp__agent__vacm_8c_afd75c739785a988749fc503fcd64d325}{snmpFindViewEntry}(context, viewName, subtree, subtreeLen);
1489 
1490    \textcolor{comment}{//vacmViewTreeFamilyMask object?}
1491    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyMask"}))
1492    \{
1493       \textcolor{comment}{//Ensure the length of the bit mask is valid}
1494       \textcolor{keywordflow}{if}(valueLen > \hyperlink{snmp__common_8h_a3f142408a36a20aa0c4214559ff23903}{SNMP\_MAX\_BIT\_MASK\_SIZE})
1495          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1496 
1497       \textcolor{comment}{//Test if the conceptual row exists in the agent}
1498       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1499       \{
1500          \textcolor{comment}{//Commit phase?}
1501          \textcolor{keywordflow}{if}(commit)
1502          \{
1503             \textcolor{comment}{//Set the bit mask}
1504             memcpy(entry->\hyperlink{structSnmpViewEntry_a692738ca6f958b97c6c1b9b58e2f5e91}{mask}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
1505             \textcolor{comment}{//Set the length of the bit mask}
1506             entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen} = valueLen;
1507          \}
1508       \}
1509       \textcolor{keywordflow}{else}
1510       \{
1511          \textcolor{comment}{//Prepare phase?}
1512          \textcolor{keywordflow}{if}(!commit)
1513          \{
1514             \textcolor{comment}{//Save the bit mask for later use}
1515             memcpy(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.
      \hyperlink{structSnmpViewEntry_a692738ca6f958b97c6c1b9b58e2f5e91}{mask}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->octetString, valueLen);
1516             \textcolor{comment}{//Save the length of the bit mask}
1517             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen} = valueLen;
1518          \}
1519       \}
1520    \}
1521    \textcolor{comment}{//vacmViewTreeFamilyType object?}
1522    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyType"}))
1523    \{
1524       \textcolor{comment}{//Ensure the value of the object is acceptable}
1525       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aaa95645902fe19983f42883dd4bf51b15c}{SNMP\_VIEW\_TYPE\_INCLUDED} &&
1526          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aaa948f6903ac71d2534ab127fbaa147fc0}{SNMP\_VIEW\_TYPE\_EXCLUDED})
1527       \{
1528          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa89e595b6b9492cadd1e39bcf6b51255}{ERROR\_WRONG\_VALUE};
1529       \}
1530 
1531       \textcolor{comment}{//Test if the conceptual row exists in the agent}
1532       \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1533       \{
1534          \textcolor{comment}{//Commit phase?}
1535          \textcolor{keywordflow}{if}(commit)
1536          \{
1537             \textcolor{comment}{//Set the value of the column}
1538             entry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} = (\hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aa}{SnmpViewType}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
1539          \}
1540       \}
1541       \textcolor{keywordflow}{else}
1542       \{
1543          \textcolor{comment}{//Prepare phase?}
1544          \textcolor{keywordflow}{if}(!commit)
1545          \{
1546             \textcolor{comment}{//Save the value of the column for later use}
1547             \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} = (
      \hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aa}{SnmpViewType}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
1548          \}
1549       \}
1550    \}
1551    \textcolor{comment}{//vacmViewTreeFamilyStorageType object?}
1552    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyStorageType"}))
1553    \{
1554       \textcolor{comment}{//The vacmViewTreeFamilyStorageType object specifies the storage type}
1555       \textcolor{comment}{//for this conceptual row}
1556       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa23d8d1e34813d8e160ef1e8f90df167d}{MIB\_STORAGE\_TYPE\_OTHER} &&
1557          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fab1109cfa48bf598ea9cb07d8f41f7536}{MIB\_STORAGE\_TYPE\_VOLATILE} &&
1558          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa08c50a9fa5de427b5fe638fe82a2b40e}{MIB\_STORAGE\_TYPE\_NON\_VOLATILE} &&
1559          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa42210747745ce2b0af7d81ca9ac81739}{MIB\_STORAGE\_TYPE\_PERMANENT} &&
1560          \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer != \hyperlink{mib__common_8h_a6045d2fe4e80ff6ad14510d1e2cd616fa319c608df40b9b341f4d6f13417a9850}{MIB\_STORAGE\_TYPE\_READ\_ONLY})
1561       \{
1562          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa89e595b6b9492cadd1e39bcf6b51255}{ERROR\_WRONG\_VALUE};
1563       \}
1564    \}
1565    \textcolor{comment}{//vacmViewTreeFamilyStatus object?}
1566    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"vacmViewTreeFamilyStatus"}))
1567    \{
1568       \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus} status;
1569 
1570       \textcolor{comment}{//Get row status}
1571       status = (\hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097}{MibRowStatus}) \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->integer;
1572 
1573       \textcolor{comment}{//Check the value specified by the set operation}
1574       \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE} ||
1575          status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE})
1576       \{
1577          \textcolor{comment}{//No matching row found?}
1578          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1579             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
1580 
1581          \textcolor{comment}{//Commit phase?}
1582          \textcolor{keywordflow}{if}(commit)
1583          \{
1584             \textcolor{comment}{//Update the status of the conceptual row}
1585             entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} = status;
1586          \}
1587       \}
1588       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a7e302e94aab90e40035ff0ad48c1aaac}{MIB\_ROW\_STATUS\_CREATE\_AND\_GO} ||
1589          status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a236ac2459eae20f25f78db63416b7ac2}{MIB\_ROW\_STATUS\_CREATE\_AND\_WAIT})
1590       \{
1591          \textcolor{comment}{//Row already instantiated?}
1592          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1593             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
1594 
1595          \textcolor{comment}{//Create a new row}
1596          entry = \hyperlink{snmp__agent__vacm_8c_a0c0146554c1b728d85beebe146735091}{snmpCreateViewEntry}(context);
1597          \textcolor{comment}{//Row creation failed?}
1598          \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1599             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7446f962c635e715f75bc4aff05feb77}{ERROR\_WRITE\_FAILED};
1600 
1601          \textcolor{comment}{//Commit phase?}
1602          \textcolor{keywordflow}{if}(commit)
1603          \{
1604             \textcolor{comment}{//Save view name}
1605             strcpy(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, viewName);
1606             \textcolor{comment}{//Save subtree}
1607             memcpy(entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, subtree, subtreeLen);
1608             \textcolor{comment}{//Save the length of the subtree}
1609             entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen} = subtreeLen;
1610 
1611             \textcolor{comment}{//Initialize columns with default values}
1612             entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen} = 0;
1613             entry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} = \hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aaa95645902fe19983f42883dd4bf51b15c}{SNMP\_VIEW\_TYPE\_INCLUDED};
1614 
1615             \textcolor{comment}{//Valid bit mask specified?}
1616             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen} != 0)
1617             \{
1618                \textcolor{comment}{//Copy the bit mask}
1619                memcpy(entry->\hyperlink{structSnmpViewEntry_a692738ca6f958b97c6c1b9b58e2f5e91}{mask}, \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.\hyperlink{structSnmpViewEntry_a692738ca6f958b97c6c1b9b58e2f5e91}{mask},
1620                   \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.
      \hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen});
1621 
1622                \textcolor{comment}{//Set the length of the bit mask}
1623                entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen} = \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.
      \hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen};
1624             \}
1625 
1626             \textcolor{comment}{//Valid type specified?}
1627             \textcolor{keywordflow}{if}(\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} != 
      \hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aaab3fbf9abc4a6244ef3cda45e64993ed1}{SNMP\_VIEW\_TYPE\_INVALID})
1628                entry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} = \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}.
      \hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type};
1629 
1630             \textcolor{comment}{//The conceptual row has been successfully created}
1631             \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a7e302e94aab90e40035ff0ad48c1aaac}{MIB\_ROW\_STATUS\_CREATE\_AND\_GO})
1632                entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE};
1633             \textcolor{keywordflow}{else}
1634                entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a4b22a7de003761700ca3bde5898fd2e9}{MIB\_ROW\_STATUS\_NOT\_IN\_SERVICE};
1635          \}
1636       \}
1637       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a705e943dcc8e73d35667b8bdc20d639d}{MIB\_ROW\_STATUS\_DESTROY})
1638       \{
1639          \textcolor{comment}{//Test if the conceptual row exists in the agent}
1640          \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1641          \{
1642             \textcolor{comment}{//Commit phase?}
1643             \textcolor{keywordflow}{if}(commit)
1644             \{
1645                \textcolor{comment}{//Delete the conceptual row from the table}
1646                entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} = \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED};
1647             \}
1648          \}
1649       \}
1650       \textcolor{keywordflow}{else}
1651       \{
1652          \textcolor{comment}{//Unsupported action}
1653          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafaae3a6b1efb8378ac642c5670d71885}{ERROR\_INCONSISTENT\_VALUE};
1654       \}
1655    \}
1656    \textcolor{comment}{//Unknown object?}
1657    \textcolor{keywordflow}{else}
1658    \{
1659       \textcolor{comment}{//The specified object does not exist}
1660       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
1661    \}
1662 
1663    \textcolor{comment}{//Successful set operation}
1664    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1665 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_ad737b5fb5a8a7edb530aadc596b38185}\label{snmp__vacm__mib__impl_8h_ad737b5fb5a8a7edb530aadc596b38185}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Unload@{snmp\+Vacm\+Mib\+Unload}}
\index{snmp\+Vacm\+Mib\+Unload@{snmp\+Vacm\+Mib\+Unload}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Unload()}{snmpVacmMibUnload()}}
{\footnotesize\ttfamily void snmp\+Vacm\+Mib\+Unload (\begin{DoxyParamCaption}\item[{void $\ast$}]{context }\end{DoxyParamCaption})}



Unload S\+N\+MP V\+A\+CM M\+IB module. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}


Definition at line 92 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
93 \{
94    \textcolor{comment}{//Unregister SNMP agent context}
95    \hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a39d2eb3c1c876fbc0882a7bfc4c6d765}{context} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
96 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__vacm__mib__impl_8h_a9a9894b8d5828d16cfbc691dd61065ed}\label{snmp__vacm__mib__impl_8h_a9a9894b8d5828d16cfbc691dd61065ed}} 
\index{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}!snmp\+Vacm\+Mib\+Unlock@{snmp\+Vacm\+Mib\+Unlock}}
\index{snmp\+Vacm\+Mib\+Unlock@{snmp\+Vacm\+Mib\+Unlock}!snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h@{snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+h}}
\subsubsection{\texorpdfstring{snmp\+Vacm\+Mib\+Unlock()}{snmpVacmMibUnlock()}}
{\footnotesize\ttfamily void snmp\+Vacm\+Mib\+Unlock (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Unlock S\+N\+MP V\+A\+CM M\+IB base. 



Definition at line 116 of file snmp\+\_\+vacm\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
117 \{
118    \textcolor{comment}{//Clear temporary objects}
119    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a3e98c29d9d2edab22f9ed6b066146136}{tempGroupEntry}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry}));
120    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_aeda8d1f2a245f0b882d38bd60b6c5a80}{tempAccessEntry}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry}));
121    memset(&\hyperlink{snmp__vacm__mib__module_8c_a9a59857a295b670ff8ef1a2471c306ff}{snmpVacmMibBase}.\hyperlink{structSnmpVacmMibBase_a9311a7e596e0c31f2b7b50106d8b4321}{tempViewEntry}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{structSnmpViewEntry}{SnmpViewEntry}));
122 \}
\end{DoxyCode}
