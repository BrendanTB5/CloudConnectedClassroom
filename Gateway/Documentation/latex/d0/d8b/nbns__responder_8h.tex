\hypertarget{nbns__responder_8h}{}\section{cyclone\+\_\+tcp/netbios/nbns\+\_\+responder.h File Reference}
\label{nbns__responder_8h}\index{cyclone\+\_\+tcp/netbios/nbns\+\_\+responder.\+h@{cyclone\+\_\+tcp/netbios/nbns\+\_\+responder.\+h}}


N\+B\+NS responder (Net\+B\+I\+OS Name Service)  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/udp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}dns/dns\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}netbios/nbns\+\_\+common.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{nbns__responder_8h_ada1ce04cfb640ee2c748e706caef41e0}{N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT}~\hyperlink{os__port_8h_a73c228f87e038e8295ee8ea8eceaa5ac}{E\+N\+A\+B\+L\+ED}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{nbns__responder_8h_a9a34493b2ffcd754326e8e9aed89eb92}{nbns\+Process\+Query} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv4_8h_a0e92b64e038199f1bb6383f2a76f30b6}{Ipv4\+Pseudo\+Header} $\ast$pseudo\+Header, const \hyperlink{udp_8h_a6877bae1da8326482f5e311875e52bce}{Udp\+Header} $\ast$udp\+Header, const \hyperlink{nbns__common_8h_a31dec1106c9cf3a1e242d985ac447238}{Nbns\+Header} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Process N\+B\+NS query message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{nbns__responder_8h_a8eafd7559bbfd2031cf6752b43272816}{nbns\+Send\+Response} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{dest\+Ip\+Addr}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{udp_8h_af15d713ad2bc92686abfa6ab012b5039}{dest\+Port}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{nbns__common_8h_a4fc3a0c58dfbd1e68224521185cb9384}{id})
\begin{DoxyCompactList}\small\item\em Send N\+B\+NS response message. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
N\+B\+NS responder (Net\+B\+I\+OS Name Service) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{nbns__responder_8h_ada1ce04cfb640ee2c748e706caef41e0}\label{nbns__responder_8h_ada1ce04cfb640ee2c748e706caef41e0}} 
\index{nbns\+\_\+responder.\+h@{nbns\+\_\+responder.\+h}!N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT@{N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT}}
\index{N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT@{N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT}!nbns\+\_\+responder.\+h@{nbns\+\_\+responder.\+h}}
\subsubsection{\texorpdfstring{N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT}{NBNS\_RESPONDER\_SUPPORT}}
{\footnotesize\ttfamily \#define N\+B\+N\+S\+\_\+\+R\+E\+S\+P\+O\+N\+D\+E\+R\+\_\+\+S\+U\+P\+P\+O\+RT~\hyperlink{os__port_8h_a73c228f87e038e8295ee8ea8eceaa5ac}{E\+N\+A\+B\+L\+ED}}



Definition at line 42 of file nbns\+\_\+responder.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{nbns__responder_8h_a9a34493b2ffcd754326e8e9aed89eb92}\label{nbns__responder_8h_a9a34493b2ffcd754326e8e9aed89eb92}} 
\index{nbns\+\_\+responder.\+h@{nbns\+\_\+responder.\+h}!nbns\+Process\+Query@{nbns\+Process\+Query}}
\index{nbns\+Process\+Query@{nbns\+Process\+Query}!nbns\+\_\+responder.\+h@{nbns\+\_\+responder.\+h}}
\subsubsection{\texorpdfstring{nbns\+Process\+Query()}{nbnsProcessQuery()}}
{\footnotesize\ttfamily void nbns\+Process\+Query (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv4_8h_a0e92b64e038199f1bb6383f2a76f30b6}{Ipv4\+Pseudo\+Header} $\ast$}]{pseudo\+Header,  }\item[{const \hyperlink{udp_8h_a6877bae1da8326482f5e311875e52bce}{Udp\+Header} $\ast$}]{udp\+Header,  }\item[{const \hyperlink{nbns__common_8h_a31dec1106c9cf3a1e242d985ac447238}{Nbns\+Header} $\ast$}]{message,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Process N\+B\+NS query message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em pseudo\+Header} & U\+DP pseudo header \\
\hline
\mbox{\tt in}  & {\em udp\+Header} & U\+DP header \\
\hline
\mbox{\tt in}  & {\em message} & Pointer to the N\+B\+NS query message \\
\hline
\mbox{\tt in}  & {\em length} & Length of the message \\
\hline
\end{DoxyParams}


Definition at line 54 of file nbns\+\_\+responder.\+c.


\begin{DoxyCode}
56 \{
57    \textcolor{keywordtype}{size\_t} pos;
58    \hyperlink{dns__common_8h_ac1ef063cc8bc932118463092c282f188}{DnsQuestion} *question;
59 
60    \textcolor{comment}{//The NBNS query shall contain one question}
61    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->qdcount) != 1)
62       \textcolor{keywordflow}{return};
63 
64    \textcolor{comment}{//Parse NetBIOS name}
65    pos = \hyperlink{nbns__common_8c_a883186d42b150c72047c02e9ee490770}{nbnsParseName}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, \textcolor{keyword}{sizeof}(
      \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{DnsHeader}), \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
66 
67    \textcolor{comment}{//Invalid name?}
68    \textcolor{keywordflow}{if}(!pos)
69       \textcolor{keywordflow}{return};
70    \textcolor{comment}{//Malformed NBNS query message?}
71    \textcolor{keywordflow}{if}((pos + \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_ac1ef063cc8bc932118463092c282f188}{DnsQuestion})) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
72       \textcolor{keywordflow}{return};
73 
74    \textcolor{comment}{//Point to the corresponding entry}
75    question = \hyperlink{dns__common_8h_a66ca704f3f850dcbb2f3ceefe90afcc5}{DNS\_GET\_QUESTION}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, pos);
76 
77    \textcolor{comment}{//Check the class and the type of the request}
78    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(question->qclass) != \hyperlink{dns__common_8h_aa541e7289dae8934f7f37e74c15cc5a5ae4d96c0329f035328ba190627f2782e9}{DNS\_RR\_CLASS\_IN})
79       \textcolor{keywordflow}{return};
80    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(question->qtype) != \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a2c6f8e31b0a836590f0173f34e3d082c}{DNS\_RR\_TYPE\_NB})
81       \textcolor{keywordflow}{return};
82 
83    \textcolor{comment}{//Compare NetBIOS names}
84    \textcolor{keywordflow}{if}(\hyperlink{nbns__common_8c_af63e6277864b3b60286e2d72e977bf7a}{nbnsCompareName}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, \textcolor{keyword}{sizeof}(
      \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{DnsHeader}), interface->hostname))
85    \{
86       \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{tcp_8h_af15d713ad2bc92686abfa6ab012b5039}{destPort};
87       \hyperlink{structIpAddr}{IpAddr} \hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr};
88 
89       \textcolor{comment}{//A response packet is always sent to the source UDP port and}
90       \textcolor{comment}{//source IP address of the request packet}
91       destIpAddr.\hyperlink{structIpAddr_ae61478bd1e79361fca7dd04a21aeb2f8}{length} = \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr});
92       destIpAddr.\hyperlink{structIpAddr_a8de6f49cb0461f57c1eda49bb1088916}{ipv4Addr} = pseudoHeader->srcAddr;
93 
94       \textcolor{comment}{//Convert the port number to host byte order}
95       destPort = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(udpHeader->srcPort);
96 
97       \textcolor{comment}{//Send NBNS response}
98       \hyperlink{nbns__responder_8c_a8eafd7559bbfd2031cf6752b43272816}{nbnsSendResponse}(interface, &destIpAddr, destPort, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->id);
99    \}
100 \}
\end{DoxyCode}
\mbox{\Hypertarget{nbns__responder_8h_a8eafd7559bbfd2031cf6752b43272816}\label{nbns__responder_8h_a8eafd7559bbfd2031cf6752b43272816}} 
\index{nbns\+\_\+responder.\+h@{nbns\+\_\+responder.\+h}!nbns\+Send\+Response@{nbns\+Send\+Response}}
\index{nbns\+Send\+Response@{nbns\+Send\+Response}!nbns\+\_\+responder.\+h@{nbns\+\_\+responder.\+h}}
\subsubsection{\texorpdfstring{nbns\+Send\+Response()}{nbnsSendResponse()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} nbns\+Send\+Response (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$}]{dest\+Ip\+Addr,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{dest\+Port,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{id }\end{DoxyParamCaption})}



Send N\+B\+NS response message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Ip\+Addr} & Destination IP address \\
\hline
\mbox{\tt in}  & {\em dest\+Port} & destination port \\
\hline
\mbox{\tt in}  & {\em id} & 16-\/bit identifier to be used when sending N\+B\+NS query \\
\hline
\end{DoxyParams}


Definition at line 111 of file nbns\+\_\+responder.\+c.


\begin{DoxyCode}
113 \{
114    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
115    \textcolor{keywordtype}{size\_t} \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
116    \textcolor{keywordtype}{size\_t} \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset};
117    \hyperlink{structNetBuffer}{NetBuffer} *buffer;
118    \hyperlink{nbns__common_8h_a31dec1106c9cf3a1e242d985ac447238}{NbnsHeader} *\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message};
119    \hyperlink{nbns__common_8h_abdcf413c012c8910ced7035094a5c957}{NbnsAddrEntry} *addrEntry;
120    \hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord} *record;
121 
122    \textcolor{comment}{//Allocate a memory buffer to hold the NBNS response message}
123    buffer = \hyperlink{udp_8c_a2c65cad7c5665fe03f94364e7e52b2be}{udpAllocBuffer}(\hyperlink{dns__common_8h_a8578d0d73531c18ef02299543f9b232e}{DNS\_MESSAGE\_MAX\_SIZE}, &offset);
124    \textcolor{comment}{//Failed to allocate buffer?}
125    \textcolor{keywordflow}{if}(buffer == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
126       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
127 
128    \textcolor{comment}{//Point to the NBNS header}
129    message = \hyperlink{net__mem_8c_a20d30c9db547b3b2743368b589cf482b}{netBufferAt}(buffer, offset);
130 
131    \textcolor{comment}{//Take the identifier from the query message}
132    message->id = \hyperlink{dns__common_8h_a4fc3a0c58dfbd1e68224521185cb9384}{id};
133 
134    \textcolor{comment}{//Format NBNS response header}
135    message->qr = 1;
136    message->opcode = \hyperlink{dns__common_8h_a9f7c2277e233fdeda3757e48282d3314af37862c9f8865288e6df0392930ec0a3}{DNS\_OPCODE\_QUERY};
137    message->aa = 1;
138    message->tc = 0;
139    message->rd = 1;
140    message->ra = 1;
141    message->z = 0;
142    message->b = 0;
143    message->rcode = \hyperlink{dns__common_8h_a4e14ab5567efbae42f570bc5bbd1d209a3673e53909ca3bf211abc3f0600158e0}{DNS\_RCODE\_NO\_ERROR};
144 
145    \textcolor{comment}{//The NBNS response contains 1 answer resource record}
146    message->qdcount = 0;
147    message->ancount = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(1);
148    message->nscount = 0;
149    message->arcount = 0;
150 
151    \textcolor{comment}{//NBNS response message length}
152    length = \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{DnsHeader});
153 
154    \textcolor{comment}{//Encode the host name using the NBNS name notation}
155    length += \hyperlink{nbns__common_8c_a2ffccdee63ab330c3b5720619c241fa8}{nbnsEncodeName}(interface->hostname, (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) message + length);
156 
157    \textcolor{comment}{//Point to the corresponding resource record}
158    record = \hyperlink{dns__common_8h_a4f1a2722ba292be26060ec5693e1f280}{DNS\_GET\_RESOURCE\_RECORD}(message, length);
159 
160    \textcolor{comment}{//Fill in resource record}
161    record->rtype = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a2c6f8e31b0a836590f0173f34e3d082c}{DNS\_RR\_TYPE\_NB});
162    record->rclass = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{dns__common_8h_aa541e7289dae8934f7f37e74c15cc5a5ae4d96c0329f035328ba190627f2782e9}{DNS\_RR\_CLASS\_IN});
163    record->ttl = \hyperlink{cpu__endian_8h_ac54311f25fef1611a699b949c7410f64}{HTONL}(\hyperlink{nbns__common_8h_aa04e699099d69eb61f316d7550cfa32a}{NBNS\_DEFAULT\_RESOURCE\_RECORD\_TTL});
164    record->rdlength = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\textcolor{keyword}{sizeof}(\hyperlink{nbns__common_8h_abdcf413c012c8910ced7035094a5c957}{NbnsAddrEntry}));
165 
166    \textcolor{comment}{//Point to the address entry array}
167    addrEntry = (\hyperlink{nbns__common_8h_abdcf413c012c8910ced7035094a5c957}{NbnsAddrEntry} *) record->rdata;
168 
169    \textcolor{comment}{//Fill in address entry}
170    addrEntry->flags = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{nbns__common_8h_a74c2dcc7bacb7bcd8cc1be291ab3c4c3af908bf51925379c899f86b3fad4e8275}{NBNS\_G\_UNIQUE} | \hyperlink{nbns__common_8h_a74c2dcc7bacb7bcd8cc1be291ab3c4c3aabb4b26121a1e6492b5ed67620a31b91}{NBNS\_ONT\_BNODE});
171    addrEntry->addr = interface->ipv4Context.addrList[0].addr;
172 
173    \textcolor{comment}{//Update the length of the NBNS response message}
174    length += \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord}) + \textcolor{keyword}{sizeof}(\hyperlink{nbns__common_8h_abdcf413c012c8910ced7035094a5c957}{NbnsAddrEntry});
175 
176    \textcolor{comment}{//Adjust the length of the multi-part buffer}
177    \hyperlink{net__mem_8c_ac0a46f396754e069dd1ee65cdc559b28}{netBufferSetLength}(buffer, offset + length);
178 
179    \textcolor{comment}{//Debug message}
180    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Sending NBNS message (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, length);
181    \textcolor{comment}{//Dump message}
182    \hyperlink{dns__debug_8c_aa6a38c4e74d8b059c64c30456d5c26ad}{dnsDumpMessage}((\hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{DnsHeader} *) message, length);
183 
184    \textcolor{comment}{//A response packet is always sent to the source UDP port and source IP}
185    \textcolor{comment}{//address of the request packet}
186    error = \hyperlink{udp_8c_a72a529f723ed1b75bfe98d0708f28eb1}{udpSendDatagramEx}(interface, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, \hyperlink{nbns__common_8h_ab90f2670e8b34ee01fe3052166b7a279}{NBNS\_PORT}, destIpAddr,
187       \hyperlink{tcp_8h_af15d713ad2bc92686abfa6ab012b5039}{destPort}, buffer, offset, \hyperlink{ip_8h_ad2b4b992325fba597d230405d65e6c98ac6b038dad7629acb28d7fe2f77faa9c5}{IP\_FLAG\_DONT\_ROUTE} | 
      \hyperlink{ipv4_8h_a23220cfb7e593785a73a64a092829228}{IPV4\_DEFAULT\_TTL});
188 
189    \textcolor{comment}{//Free previously allocated memory}
190    \hyperlink{net__mem_8c_aa33fc4dd2a71649194052f297c707d08}{netBufferFree}(buffer);
191 
192    \textcolor{comment}{//Return status code}
193    \textcolor{keywordflow}{return} error;
194 \}
\end{DoxyCode}
