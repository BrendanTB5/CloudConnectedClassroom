\hypertarget{ipv4__misc_8c}{}\section{cyclone\+\_\+tcp/ipv4/ipv4\+\_\+misc.c File Reference}
\label{ipv4__misc_8c}\index{cyclone\+\_\+tcp/ipv4/ipv4\+\_\+misc.\+c@{cyclone\+\_\+tcp/ipv4/ipv4\+\_\+misc.\+c}}


Helper functions for I\+Pv4.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$ctype.\+h$>$}\newline
{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ipv4/ipv4.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ipv4/ipv4\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/mib2\+\_\+module.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/ip\+\_\+mib\+\_\+module.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ipv4__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_a0384acc5ed8c18c2d0afe444d5d8084f}{I\+P\+V4\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv4__misc_8c_a25b32f544793344eefc4f5c6dcd5e394}{ipv4\+Check\+Source\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Source I\+Pv4 address filtering. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv4__misc_8c_aeed51fbc5f6dedba3c539939c1997a8d}{ipv4\+Check\+Dest\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Destination I\+Pv4 address filtering. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv4__misc_8c_af1ec532996ca54986f87e67a354e03e1}{ipv4\+Select\+Source\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$$\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ndp_8h_ab217f0ee2104c7c5529a4ece1f77e02c}{dest\+Addr}, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} $\ast$\hyperlink{ethernet_8h_a522a68dc3582289088de6b36018e9ea0}{src\+Addr})
\begin{DoxyCompactList}\small\item\em I\+Pv4 source address selection. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv4__misc_8c_accb4841f1cb2665a6392644031a27713}{ipv4\+Is\+On\+Link} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether an I\+Pv4 address is on-\/link. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}{ipv4\+Is\+Broadcast\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether an I\+Pv4 address is a broadcast address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv4__misc_8c_ae1a1091c35e9a8ba4656688bdb76dc11}{ipv4\+Is\+Tentative\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether an I\+Pv4 address is a tentative address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv4__misc_8c_a843b5656c76604af9819b95276b46f34}{ipv4\+Is\+Local\+Host\+Addr} (\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether the specified I\+Pv4 is assigned to the host. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4\+Get\+Addr\+Scope} (\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Retrieve the scope of an I\+Pv4 address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ipv4__misc_8c_a9989b2425b80b92995bb2f00784f4ca3}{ipv4\+Get\+Prefix\+Length} (\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask})
\begin{DoxyCompactList}\small\item\em Calculate prefix length for a given subnet mask. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv4__misc_8c_a454228b972ac4244316ad7fbbf73db7a}{ipv4\+Get\+Broadcast\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr})
\begin{DoxyCompactList}\small\item\em Get I\+Pv4 broadcast address. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv4__misc_8c_a8db099da5d43d11be212cc5ac0090631}{ipv4\+Map\+Multicast\+Addr\+To\+Mac} (\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr}, \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$mac\+Addr)
\begin{DoxyCompactList}\small\item\em Map an host group address to a M\+A\+C-\/layer multicast address. \end{DoxyCompactList}\item 
void \hyperlink{ipv4__misc_8c_ae54af470bc1e5dbcd8e80719e0b24e59}{ipv4\+Update\+In\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{dest\+Ip\+Addr}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update I\+Pv4 input statistics. \end{DoxyCompactList}\item 
void \hyperlink{ipv4__misc_8c_a6dcb6ccf3fb5fe97289b11941d36c695}{ipv4\+Update\+Out\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} \hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{dest\+Ip\+Addr}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update I\+Pv4 output statistics. \end{DoxyCompactList}\item 
void \hyperlink{ipv4__misc_8c_a97921408616501cdc0795a3c4047646c}{ipv4\+Update\+Error\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} error)
\begin{DoxyCompactList}\small\item\em Update Ethernet error statistics. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Helper functions for I\+Pv4. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{ipv4__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{ipv4__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_a0384acc5ed8c18c2d0afe444d5d8084f}{I\+P\+V4\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file ipv4\+\_\+misc.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{ipv4__misc_8c_aeed51fbc5f6dedba3c539939c1997a8d}\label{ipv4__misc_8c_aeed51fbc5f6dedba3c539939c1997a8d}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Check\+Dest\+Addr@{ipv4\+Check\+Dest\+Addr}}
\index{ipv4\+Check\+Dest\+Addr@{ipv4\+Check\+Dest\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Check\+Dest\+Addr()}{ipv4CheckDestAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv4\+Check\+Dest\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Destination I\+Pv4 address filtering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & Destination I\+Pv4 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 79 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
80 \{
81    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
82    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
83    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *entry;
84 
85    \textcolor{comment}{//Filter out any invalid addresses}
86    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
87 
88    \textcolor{comment}{//Broadcast address?}
89    \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}{ipv4IsBroadcastAddr}(interface, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
90    \{
91       \textcolor{comment}{//Always accept broadcast address}
92       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
93    \}
94    \textcolor{comment}{//Multicast address?}
95    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_aada5b622e70acf16bd1cd5a9c08ea107}{ipv4IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
96    \{
97       \textcolor{comment}{//Go through the multicast filter table}
98       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv4_8h_abad540441745129e90052cdfd1b27943}{IPV4\_MULTICAST\_FILTER\_SIZE}; i++)
99       \{
100          \hyperlink{structIpv4FilterEntry}{Ipv4FilterEntry} *entry;
101 
102          \textcolor{comment}{//Point to the current entry}
103          entry = &interface->ipv4Context.multicastFilter[i];
104 
105          \textcolor{comment}{//Valid entry?}
106          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4FilterEntry_a6841595a84b65414b1b30aa0ef5ef1e6}{refCount} > 0)
107          \{
108             \textcolor{comment}{//Check whether the destination IPv4 address matches}
109             \textcolor{comment}{//a relevant multicast address}
110             \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4FilterEntry_a81c9fd6af892b3527845d3b39d3b256d}{addr} == \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr})
111             \{
112                \textcolor{comment}{//The multicast address is acceptable}
113                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
114                \textcolor{comment}{//Stop immediately}
115                \textcolor{keywordflow}{break};
116             \}
117          \}
118       \}
119    \}
120    \textcolor{comment}{//Unicast address?}
121    \textcolor{keywordflow}{else}
122    \{
123       \textcolor{comment}{//Loop through the list of IPv4 addresses assigned to the interface}
124       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv4_8h_a360065ed2949f3d5f9f7e6ac4e9ad7e1}{IPV4\_ADDR\_LIST\_SIZE}; i++)
125       \{
126          \textcolor{comment}{//Point to the current entry}
127          entry = &interface->ipv4Context.addrList[i];
128 
129          \textcolor{comment}{//Valid entry?}
130          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4FilterEntry_abc0b2be8dd44f499324d119243959111}{state} != \hyperlink{ipv4_8h_a7bc59b5d625b1217a91f1db3917e8358a0334165f8ccc85e66349e123ead01c61}{IPV4\_ADDR\_STATE\_INVALID})
131          \{
132             \textcolor{comment}{//Check whether the destination address matches a valid unicast}
133             \textcolor{comment}{//address assigned to the interface}
134             \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4FilterEntry_a81c9fd6af892b3527845d3b39d3b256d}{addr} == \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr})
135             \{
136                \textcolor{comment}{//The destination address is acceptable}
137                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
138                \textcolor{comment}{//We are done}
139                \textcolor{keywordflow}{break};
140             \}
141          \}
142       \}
143    \}
144 
145    \textcolor{comment}{//Return status code}
146    \textcolor{keywordflow}{return} error;
147 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a25b32f544793344eefc4f5c6dcd5e394}\label{ipv4__misc_8c_a25b32f544793344eefc4f5c6dcd5e394}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Check\+Source\+Addr@{ipv4\+Check\+Source\+Addr}}
\index{ipv4\+Check\+Source\+Addr@{ipv4\+Check\+Source\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Check\+Source\+Addr()}{ipv4CheckSourceAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv4\+Check\+Source\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Source I\+Pv4 address filtering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & Source I\+Pv4 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 55 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
56 \{
57    \textcolor{comment}{//Broadcast and multicast addresses must not be used as source address}
58    \textcolor{comment}{//(refer to RFC 1122, section 3.2.1.3)}
59    \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}{ipv4IsBroadcastAddr}(interface, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}) || 
      \hyperlink{ipv4_8h_aada5b622e70acf16bd1cd5a9c08ea107}{ipv4IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
60    \{
61       \textcolor{comment}{//Debug message}
62       \hyperlink{debug_8h_a72b9761add7486364dba449091cd2579}{TRACE\_WARNING}(\textcolor{stringliteral}{"Wrong source IPv4 address!\(\backslash\)r\(\backslash\)n"});
63       \textcolor{comment}{//The source address not is acceptable}
64       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
65    \}
66 
67    \textcolor{comment}{//The source address is acceptable}
68    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
69 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}\label{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Get\+Addr\+Scope@{ipv4\+Get\+Addr\+Scope}}
\index{ipv4\+Get\+Addr\+Scope@{ipv4\+Get\+Addr\+Scope}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Get\+Addr\+Scope()}{ipv4GetAddrScope()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} ipv4\+Get\+Addr\+Scope (\begin{DoxyParamCaption}\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Retrieve the scope of an I\+Pv4 address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv4 address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
I\+Pv4 address scope 
\end{DoxyReturn}


Definition at line 523 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
524 \{
525    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} scope;
526 
527    \textcolor{comment}{//Broadcast address?}
528    \textcolor{keywordflow}{if}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr} == \hyperlink{ipv4_8h_a1b7329007670c2e728ddaa434a01c992}{IPV4\_BROADCAST\_ADDR})
529    \{
530       \textcolor{comment}{//The broadcast address is never forwarded by the routers connecting}
531       \textcolor{comment}{//the local network to other networks}
532       scope = \hyperlink{ipv4_8h_a4335ce5b7755139a7f07440b588b9f01a82186e2df193a5f62c45dd11c1acccdb}{IPV4\_ADDR\_SCOPE\_LINK\_LOCAL};
533    \}
534    \textcolor{comment}{//Multicast address?}
535    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_aada5b622e70acf16bd1cd5a9c08ea107}{ipv4IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
536    \{
537       \textcolor{comment}{//Local Network Control Block?}
538       \textcolor{keywordflow}{if}((\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr} & \hyperlink{ipv4_8h_aa7713a9c69091cb27b6b8df5a0037e6c}{IPV4\_MULTICAST\_LNCB\_MASK}) == 
      \hyperlink{ipv4_8h_a535be476f0fd161a0dc73536fa60029c}{IPV4\_MULTICAST\_LNCB\_PREFIX})
539       \{
540          \textcolor{comment}{//Addresses in the Local Network Control Block are used for protocol}
541          \textcolor{comment}{//control traffic that is not forwarded off link}
542          scope = \hyperlink{ipv4_8h_a4335ce5b7755139a7f07440b588b9f01a82186e2df193a5f62c45dd11c1acccdb}{IPV4\_ADDR\_SCOPE\_LINK\_LOCAL};
543       \}
544       \textcolor{comment}{//Any other multicast address?}
545       \textcolor{keywordflow}{else}
546       \{
547          \textcolor{comment}{//Other addresses are assigned global scope}
548          scope = \hyperlink{ipv4_8h_a4335ce5b7755139a7f07440b588b9f01aded0d4add8838232cf71ce9976caf57d}{IPV4\_ADDR\_SCOPE\_GLOBAL};
549       \}
550    \}
551    \textcolor{comment}{//Unicast address?}
552    \textcolor{keywordflow}{else}
553    \{
554       \textcolor{comment}{//Loopback address?}
555       \textcolor{keywordflow}{if}((\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr} & \hyperlink{ipv4_8h_a1995754bb37c9d4bc47dd415a4a6c7f3}{IPV4\_LOOPBACK\_MASK}) == 
      \hyperlink{ipv4_8h_a1d0c834d64d754374e59762fbb4ef2ef}{IPV4\_LOOPBACK\_PREFIX})
556       \{
557          \textcolor{comment}{//IPv4 loopback addresses, which have the prefix 127.0.0.0/8,}
558          \textcolor{comment}{//are assigned interface-local scope}
559          scope = \hyperlink{ipv4_8h_a4335ce5b7755139a7f07440b588b9f01aa5ecf3242cfcd8bbf6d538ef4cdce819}{IPV4\_ADDR\_SCOPE\_INTERFACE\_LOCAL};
560       \}
561       \textcolor{comment}{//Link-local address?}
562       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr} & \hyperlink{ipv4_8h_abe116a582fb2fe7f888c922ddcff9893}{IPV4\_LINK\_LOCAL\_MASK}) == 
      \hyperlink{ipv4_8h_a34d57806676628c8e7efa164977b01c4}{IPV4\_LINK\_LOCAL\_PREFIX})
563       \{
564          \textcolor{comment}{//IPv4 auto-configuration addresses, which have the prefix}
565          \textcolor{comment}{//169.254.0.0/16, are assigned link-local scope}
566          scope = \hyperlink{ipv4_8h_a4335ce5b7755139a7f07440b588b9f01a82186e2df193a5f62c45dd11c1acccdb}{IPV4\_ADDR\_SCOPE\_LINK\_LOCAL};
567       \}
568       \textcolor{comment}{//Any other unicast address?}
569       \textcolor{keywordflow}{else}
570       \{
571          \textcolor{comment}{//Other addresses are assigned global scope}
572          scope = \hyperlink{ipv4_8h_a4335ce5b7755139a7f07440b588b9f01aded0d4add8838232cf71ce9976caf57d}{IPV4\_ADDR\_SCOPE\_GLOBAL};
573       \}
574    \}
575 
576    \textcolor{comment}{//Return the scope of the specified IPv4 address}
577    \textcolor{keywordflow}{return} scope;
578 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a454228b972ac4244316ad7fbbf73db7a}\label{ipv4__misc_8c_a454228b972ac4244316ad7fbbf73db7a}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Get\+Broadcast\+Addr@{ipv4\+Get\+Broadcast\+Addr}}
\index{ipv4\+Get\+Broadcast\+Addr@{ipv4\+Get\+Broadcast\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Get\+Broadcast\+Addr()}{ipv4GetBroadcastAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv4\+Get\+Broadcast\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} $\ast$}]{addr }\end{DoxyParamCaption})}



Get I\+Pv4 broadcast address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Pointer to the desired network interface \\
\hline
\mbox{\tt out}  & {\em addr} & I\+Pv4 broadcast address \\
\hline
\end{DoxyParams}


Definition at line 613 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
614 \{
615    \textcolor{comment}{//Check parameters}
616    \textcolor{keywordflow}{if}(interface == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
617       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
618 
619    \textcolor{comment}{//The broadcast address is obtained by performing a bitwise OR operation}
620    \textcolor{comment}{//between the bit complement of the subnet mask and the host IP address}
621    *\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr} = interface->ipv4Context.addrList[0].addr;
622    *\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr} |= ~interface->ipv4Context.addrList[0].subnetMask;
623 
624    \textcolor{comment}{//Successful processing}
625    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
626 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a9989b2425b80b92995bb2f00784f4ca3}\label{ipv4__misc_8c_a9989b2425b80b92995bb2f00784f4ca3}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Get\+Prefix\+Length@{ipv4\+Get\+Prefix\+Length}}
\index{ipv4\+Get\+Prefix\+Length@{ipv4\+Get\+Prefix\+Length}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Get\+Prefix\+Length()}{ipv4GetPrefixLength()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} ipv4\+Get\+Prefix\+Length (\begin{DoxyParamCaption}\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{mask }\end{DoxyParamCaption})}



Calculate prefix length for a given subnet mask. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mask} & Subnet mask \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Prefix length 
\end{DoxyReturn}


Definition at line 587 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
588 \{
589    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
590 
591    \textcolor{comment}{//Convert from network byte order to host byte order}
592    \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask} = \hyperlink{cpu__endian_8h_a22f92ea3318059b7d88dfbd98d0cbc3e}{ntohl}(\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask});
593 
594    \textcolor{comment}{//Count of the number of leading 1 bits in the network mask}
595    \textcolor{keywordflow}{for}(i = 0; i < 32; i++)
596    \{
597       \textcolor{comment}{//Check the value of the current bit}
598       \textcolor{keywordflow}{if}(!(\hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask} & (1U << (31 - i))))
599          \textcolor{keywordflow}{break};
600    \}
601 
602    \textcolor{comment}{//Return prefix length}
603    \textcolor{keywordflow}{return} i;
604 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}\label{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Is\+Broadcast\+Addr@{ipv4\+Is\+Broadcast\+Addr}}
\index{ipv4\+Is\+Broadcast\+Addr@{ipv4\+Is\+Broadcast\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Is\+Broadcast\+Addr()}{ipv4IsBroadcastAddr()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv4\+Is\+Broadcast\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether an I\+Pv4 address is a broadcast address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv4 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv4 address is a broadcast address, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 386 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
387 \{
388    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
389    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *entry;
390 
391    \textcolor{comment}{//Check whether the specified IPv4 address is the broadcast address}
392    \textcolor{keywordflow}{if}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr} == \hyperlink{ipv4_8h_a1b7329007670c2e728ddaa434a01c992}{IPV4\_BROADCAST\_ADDR})
393       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
394 
395    \textcolor{comment}{//Loop through the list of IPv4 addresses assigned to the interface}
396    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv4_8h_a360065ed2949f3d5f9f7e6ac4e9ad7e1}{IPV4\_ADDR\_LIST\_SIZE}; i++)
397    \{
398       \textcolor{comment}{//Point to the current entry}
399       entry = &interface->ipv4Context.addrList[i];
400 
401       \textcolor{comment}{//Valid entry?}
402       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4AddrEntry_a36c6c6703cbac5cd8fd16ffd1abd7622}{state} != \hyperlink{ipv4_8h_a7bc59b5d625b1217a91f1db3917e8358a0334165f8ccc85e66349e123ead01c61}{IPV4\_ADDR\_STATE\_INVALID})
403       \{
404          \textcolor{comment}{//Check whether the specified IPv4 address belongs to the same subnet}
405          \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_a88d43e9ebd77bf6daf904145afe77fa4}{ipv4IsOnSubnet}(entry, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
406          \{
407             \textcolor{comment}{//Make sure the subnet mask is not 255.255.255.255}
408             \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4AddrEntry_abf3ce17e6967f88d615be5ace1b12da7}{subnetMask} != \hyperlink{ipv4_8h_a1b7329007670c2e728ddaa434a01c992}{IPV4\_BROADCAST\_ADDR})
409             \{
410                \textcolor{comment}{//Directed broadcast address?}
411                \textcolor{keywordflow}{if}((\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr} | entry->\hyperlink{structIpv4AddrEntry_abf3ce17e6967f88d615be5ace1b12da7}{subnetMask}) == 
      \hyperlink{ipv4_8h_a1b7329007670c2e728ddaa434a01c992}{IPV4\_BROADCAST\_ADDR})
412                \{
413                   \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
414                \}
415             \}
416          \}
417       \}
418    \}
419 
420    \textcolor{comment}{//The specified IPv4 address is not a broadcast address}
421    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
422 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a843b5656c76604af9819b95276b46f34}\label{ipv4__misc_8c_a843b5656c76604af9819b95276b46f34}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Is\+Local\+Host\+Addr@{ipv4\+Is\+Local\+Host\+Addr}}
\index{ipv4\+Is\+Local\+Host\+Addr@{ipv4\+Is\+Local\+Host\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Is\+Local\+Host\+Addr()}{ipv4IsLocalHostAddr()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv4\+Is\+Local\+Host\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether the specified I\+Pv4 is assigned to the host. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv4 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv4 address matches any address assigned to the host, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 468 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
469 \{
470    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
471    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
472    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} flag;
473    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *interface;
474    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *entry;
475 
476    \textcolor{comment}{//Initialize flag}
477    flag = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
478 
479    \textcolor{comment}{//Loopback address?}
480    \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_a5e9cce08eaafe8ec8c37cc3917e39c7b}{ipv4IsLoopbackAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
481    \{
482       \textcolor{comment}{//The 127.0.0.0/8 block is assigned for use as the host loopback address.}
483       \textcolor{comment}{//A datagram sent by a higher-level protocol to an address anywhere within}
484       \textcolor{comment}{//this block loops back inside the host (refer to RFC 5735, section 3)}
485       flag = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
486    \}
487    \textcolor{keywordflow}{else}
488    \{
489       \textcolor{comment}{//Loop through network interfaces}
490       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{net_8h_a116f850ebcb023ffa3e6b8de10c5cb35}{NET\_INTERFACE\_COUNT} && !flag; i++)
491       \{
492          \textcolor{comment}{//Point to the current interface}
493          \textcolor{keyword}{interface }= &\hyperlink{net_8c_a7ecafab0039ec54d1d7a1e9e7402379b}{netInterface}[i];
494 
495          \textcolor{comment}{//Iterate through the list of addresses assigned to the interface}
496          \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{ipv4_8h_a360065ed2949f3d5f9f7e6ac4e9ad7e1}{IPV4\_ADDR\_LIST\_SIZE} && !flag; j++)
497          \{
498             \textcolor{comment}{//Point to the current entry}
499             entry = &interface->ipv4Context.addrList[j];
500 
501             \textcolor{comment}{//Check whether the specified IPv4 address matches any address}
502             \textcolor{comment}{//assigned to the host}
503             \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4AddrEntry_a36c6c6703cbac5cd8fd16ffd1abd7622}{state} == \hyperlink{ipv4_8h_a7bc59b5d625b1217a91f1db3917e8358a10bd90ad767ea6ae259e9016e6186477}{IPV4\_ADDR\_STATE\_VALID} &&
504                entry->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr} == \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr})
505             \{
506                flag = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
507             \}
508          \}
509       \}
510    \}
511 
512    \textcolor{comment}{//Return TRUE if the specified address matches any address assigned to the host}
513    \textcolor{keywordflow}{return} flag;
514 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_accb4841f1cb2665a6392644031a27713}\label{ipv4__misc_8c_accb4841f1cb2665a6392644031a27713}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Is\+On\+Link@{ipv4\+Is\+On\+Link}}
\index{ipv4\+Is\+On\+Link@{ipv4\+Is\+On\+Link}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Is\+On\+Link()}{ipv4IsOnLink()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv4\+Is\+On\+Link (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether an I\+Pv4 address is on-\/link. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv4 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv4 address is on-\/link, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 351 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
352 \{
353    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
354    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *entry;
355 
356    \textcolor{comment}{//Loop through the list of IPv4 addresses assigned to the interface}
357    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv4_8h_a360065ed2949f3d5f9f7e6ac4e9ad7e1}{IPV4\_ADDR\_LIST\_SIZE}; i++)
358    \{
359       \textcolor{comment}{//Point to the current entry}
360       entry = &interface->ipv4Context.addrList[i];
361 
362       \textcolor{comment}{//Valid entry?}
363       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4AddrEntry_a36c6c6703cbac5cd8fd16ffd1abd7622}{state} != \hyperlink{ipv4_8h_a7bc59b5d625b1217a91f1db3917e8358a0334165f8ccc85e66349e123ead01c61}{IPV4\_ADDR\_STATE\_INVALID})
364       \{
365          \textcolor{comment}{//Check whether the specified IPv4 address belongs to the same subnet}
366          \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_a88d43e9ebd77bf6daf904145afe77fa4}{ipv4IsOnSubnet}(entry, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
367          \{
368             \textcolor{comment}{//The specified IPv4 address is on-link}
369             \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
370          \}
371       \}
372    \}
373 
374    \textcolor{comment}{//The specified IPv4 address is off-link}
375    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
376 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_ae1a1091c35e9a8ba4656688bdb76dc11}\label{ipv4__misc_8c_ae1a1091c35e9a8ba4656688bdb76dc11}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Is\+Tentative\+Addr@{ipv4\+Is\+Tentative\+Addr}}
\index{ipv4\+Is\+Tentative\+Addr@{ipv4\+Is\+Tentative\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Is\+Tentative\+Addr()}{ipv4IsTentativeAddr()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv4\+Is\+Tentative\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether an I\+Pv4 address is a tentative address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv4 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv4 address is a tentative address, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 432 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
433 \{
434    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
435    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *entry;
436 
437    \textcolor{comment}{//Loop through the list of IPv4 addresses assigned to the interface}
438    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv4_8h_a360065ed2949f3d5f9f7e6ac4e9ad7e1}{IPV4\_ADDR\_LIST\_SIZE}; i++)
439    \{
440       \textcolor{comment}{//Point to the current entry}
441       entry = &interface->ipv4Context.addrList[i];
442 
443       \textcolor{comment}{//Tentative address?}
444       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4AddrEntry_a36c6c6703cbac5cd8fd16ffd1abd7622}{state} == \hyperlink{ipv4_8h_a7bc59b5d625b1217a91f1db3917e8358a4bf3bae142ae012ac2e9731495ca5818}{IPV4\_ADDR\_STATE\_TENTATIVE})
445       \{
446          \textcolor{comment}{//Check whether the specified address matches a valid unicast}
447          \textcolor{comment}{//address assigned to the interface}
448          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr} == \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr})
449          \{
450             \textcolor{comment}{//The specified IPv4 address is a tentative address}
451             \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
452          \}
453       \}
454    \}
455 
456    \textcolor{comment}{//The specified IPv4 address is not a tentative address}
457    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
458 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a8db099da5d43d11be212cc5ac0090631}\label{ipv4__misc_8c_a8db099da5d43d11be212cc5ac0090631}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Map\+Multicast\+Addr\+To\+Mac@{ipv4\+Map\+Multicast\+Addr\+To\+Mac}}
\index{ipv4\+Map\+Multicast\+Addr\+To\+Mac@{ipv4\+Map\+Multicast\+Addr\+To\+Mac}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Map\+Multicast\+Addr\+To\+Mac()}{ipv4MapMulticastAddrToMac()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv4\+Map\+Multicast\+Addr\+To\+Mac (\begin{DoxyParamCaption}\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{ip\+Addr,  }\item[{\hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$}]{mac\+Addr }\end{DoxyParamCaption})}



Map an host group address to a M\+A\+C-\/layer multicast address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv4 host group address \\
\hline
\mbox{\tt out}  & {\em mac\+Addr} & Corresponding M\+A\+C-\/layer multicast address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 636 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
637 \{
638    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
639 
640    \textcolor{comment}{//Ensure the specified IPv4 address is a valid host group address}
641    \textcolor{keywordflow}{if}(!\hyperlink{ipv4_8h_aada5b622e70acf16bd1cd5a9c08ea107}{ipv4IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
642       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
643 
644    \textcolor{comment}{//Cast the address to byte array}
645    p = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) &\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
646 
647    \textcolor{comment}{//An IP host group address is mapped to an Ethernet multicast address}
648    \textcolor{comment}{//by placing the low-order 23-bits of the IP address into the low-order}
649    \textcolor{comment}{//23 bits of the Ethernet multicast address 01-00-5E-00-00-00}
650    macAddr->b[0] = 0x01;
651    macAddr->b[1] = 0x00;
652    macAddr->b[2] = 0x5E;
653    macAddr->b[3] = p[1] & 0x7F;
654    macAddr->b[4] = p[2];
655    macAddr->b[5] = p[3];
656 
657    \textcolor{comment}{//The specified host group address was successfully}
658    \textcolor{comment}{//mapped to a MAC-layer address}
659    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
660 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_af1ec532996ca54986f87e67a354e03e1}\label{ipv4__misc_8c_af1ec532996ca54986f87e67a354e03e1}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Select\+Source\+Addr@{ipv4\+Select\+Source\+Addr}}
\index{ipv4\+Select\+Source\+Addr@{ipv4\+Select\+Source\+Addr}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Select\+Source\+Addr()}{ipv4SelectSourceAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv4\+Select\+Source\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$$\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{dest\+Addr,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr} $\ast$}]{src\+Addr }\end{DoxyParamCaption})}



I\+Pv4 source address selection. 

This function selects the source address and the relevant network interface to be used in order to join the specified destination address


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em interface} & A pointer to a valid network interface may be provided as a hint. The function returns a pointer identifying the interface to be used \\
\hline
\mbox{\tt in}  & {\em dest\+Addr} & Destination I\+Pv4 address \\
\hline
\mbox{\tt out}  & {\em src\+Addr} & Local I\+Pv4 address to be used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 163 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
165 \{
166    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
167    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
168    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
169    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *currentInterface;
170    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *bestInterface;
171    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *currentAddr;
172    \hyperlink{structIpv4AddrEntry}{Ipv4AddrEntry} *bestAddr;
173 
174    \textcolor{comment}{//Initialize variables}
175    bestInterface = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
176    bestAddr = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
177 
178    \textcolor{comment}{//Loop through network interfaces}
179    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{net_8h_a116f850ebcb023ffa3e6b8de10c5cb35}{NET\_INTERFACE\_COUNT}; i++)
180    \{
181       \textcolor{comment}{//Point to the current interface}
182       currentInterface = &\hyperlink{net_8c_a7ecafab0039ec54d1d7a1e9e7402379b}{netInterface}[i];
183 
184       \textcolor{comment}{//A network interface may be provided as a hint}
185       \textcolor{keywordflow}{if}(*interface != currentInterface && *interface != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
186       \{
187          \textcolor{comment}{//Select the next interface in the list}
188          \textcolor{keywordflow}{continue};
189       \}
190 
191       \textcolor{comment}{//A sort of the candidate source addresses is being performed}
192       \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{ipv4_8h_a360065ed2949f3d5f9f7e6ac4e9ad7e1}{IPV4\_ADDR\_LIST\_SIZE}; j++)
193       \{
194          \textcolor{comment}{//Point to the current entry}
195          currentAddr = &currentInterface->ipv4Context.addrList[j];
196 
197          \textcolor{comment}{//Check the state of the address}
198          \textcolor{keywordflow}{if}(currentAddr->\hyperlink{structIpv4AddrEntry_a36c6c6703cbac5cd8fd16ffd1abd7622}{state} == \hyperlink{ipv4_8h_a7bc59b5d625b1217a91f1db3917e8358a10bd90ad767ea6ae259e9016e6186477}{IPV4\_ADDR\_STATE\_VALID})
199          \{
200             \textcolor{comment}{//Select the first address as default}
201             \textcolor{keywordflow}{if}(bestAddr == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
202             \{
203                \textcolor{comment}{//Give the current source address the higher precedence}
204                bestInterface = currentInterface;
205                bestAddr = currentAddr;
206 
207                \textcolor{comment}{//Select the next address in the list}
208                \textcolor{keywordflow}{continue};
209             \}
210 
211             \textcolor{comment}{//Prefer same address}
212             \textcolor{keywordflow}{if}(bestAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr} == \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr})
213             \{
214                \textcolor{comment}{//Select the next address in the list}
215                \textcolor{keywordflow}{continue};
216             \}
217             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(currentAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr} == \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr})
218             \{
219                \textcolor{comment}{//Give the current source address the higher precedence}
220                bestInterface = currentInterface;
221                bestAddr = currentAddr;
222 
223                \textcolor{comment}{//Select the next address in the list}
224                \textcolor{keywordflow}{continue};
225             \}
226 
227             \textcolor{comment}{//Check whether the destination address matches the default gateway}
228             \textcolor{keywordflow}{if}(bestAddr->\hyperlink{structIpv4AddrEntry_a6412d2664b448d636ce53d4edc71366c}{defaultGateway} == \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr})
229             \{
230                \textcolor{comment}{//Select the next address in the list}
231                \textcolor{keywordflow}{continue};
232             \}
233             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(currentAddr->\hyperlink{structIpv4AddrEntry_a6412d2664b448d636ce53d4edc71366c}{defaultGateway} == \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr})
234             \{
235                \textcolor{comment}{//Give the current source address the higher precedence}
236                bestInterface = currentInterface;
237                bestAddr = currentAddr;
238 
239                \textcolor{comment}{//Select the next address in the list}
240                \textcolor{keywordflow}{continue};
241             \}
242 
243             \textcolor{comment}{//Prefer appropriate scope}
244             \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(currentAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr}) < 
      \hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(bestAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr}))
245             \{
246                \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(currentAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr}) >= 
      \hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(\hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
247                \{
248                   \textcolor{comment}{//Give the current source address the higher precedence}
249                   bestInterface = currentInterface;
250                   bestAddr = currentAddr;
251                \}
252 
253                \textcolor{comment}{//Select the next address in the list}
254                \textcolor{keywordflow}{continue};
255             \}
256             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(bestAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr}) < 
      \hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(currentAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr}))
257             \{
258                \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(bestAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr}) < 
      \hyperlink{ipv4__misc_8c_af424f1caddfb08db21a557ec5810b918}{ipv4GetAddrScope}(\hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
259                \{
260                   \textcolor{comment}{//Give the current source address the higher precedence}
261                   bestInterface = currentInterface;
262                   bestAddr = currentAddr;
263                \}
264 
265                \textcolor{comment}{//Select the next address in the list}
266                \textcolor{keywordflow}{continue};
267             \}
268 
269             \textcolor{comment}{//If the destination address lies on one of the subnets to which}
270             \textcolor{comment}{//the host is directly connected, the corresponding source address}
271             \textcolor{comment}{//may be chosen (refer to RFC 1122, section 3.3.4.3)}
272             \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_a88d43e9ebd77bf6daf904145afe77fa4}{ipv4IsOnSubnet}(bestAddr, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
273             \{
274                \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_a88d43e9ebd77bf6daf904145afe77fa4}{ipv4IsOnSubnet}(currentAddr, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
275                \{
276                   \textcolor{comment}{//Use longest subnet mask}
277                   \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_a9989b2425b80b92995bb2f00784f4ca3}{ipv4GetPrefixLength}(currentAddr->
      \hyperlink{structIpv4AddrEntry_abf3ce17e6967f88d615be5ace1b12da7}{subnetMask}) >
278                      \hyperlink{ipv4__misc_8c_a9989b2425b80b92995bb2f00784f4ca3}{ipv4GetPrefixLength}(bestAddr->\hyperlink{structIpv4AddrEntry_abf3ce17e6967f88d615be5ace1b12da7}{subnetMask}))
279                   \{
280                      \textcolor{comment}{//Give the current source address the higher precedence}
281                      bestInterface = currentInterface;
282                      bestAddr = currentAddr;
283                   \}
284                \}
285 
286                \textcolor{comment}{//Select the next address in the list}
287                \textcolor{keywordflow}{continue};
288             \}
289             \textcolor{keywordflow}{else}
290             \{
291                \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_a88d43e9ebd77bf6daf904145afe77fa4}{ipv4IsOnSubnet}(currentAddr, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
292                \{
293                   \textcolor{comment}{//Give the current source address the higher precedence}
294                   bestInterface = currentInterface;
295                   bestAddr = currentAddr;
296 
297                   \textcolor{comment}{//Select the next address in the list}
298                   \textcolor{keywordflow}{continue};
299                \}
300             \}
301 
302             \textcolor{comment}{//The default gateways may be consulted. If these gateways are}
303             \textcolor{comment}{//assigned to different interfaces, the interface corresponding}
304             \textcolor{comment}{//to the gateway with the highest preference may be chosen}
305             \textcolor{keywordflow}{if}(bestAddr->\hyperlink{structIpv4AddrEntry_a6412d2664b448d636ce53d4edc71366c}{defaultGateway} != \hyperlink{ipv4_8h_aa9d277a6ff68d361eaf48d6af73e78e8}{IPV4\_UNSPECIFIED\_ADDR})
306             \{
307                \textcolor{comment}{//Select the next address in the list}
308                \textcolor{keywordflow}{continue};
309             \}
310             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(currentAddr->\hyperlink{structIpv4AddrEntry_a6412d2664b448d636ce53d4edc71366c}{defaultGateway} != 
      \hyperlink{ipv4_8h_aa9d277a6ff68d361eaf48d6af73e78e8}{IPV4\_UNSPECIFIED\_ADDR})
311             \{
312                \textcolor{comment}{//Give the current source address the higher precedence}
313                bestInterface = currentInterface;
314                bestAddr = currentAddr;
315 
316                \textcolor{comment}{//Select the next address in the list}
317                \textcolor{keywordflow}{continue};
318             \}
319          \}
320       \}
321    \}
322 
323    \textcolor{comment}{//Valid source address?}
324    \textcolor{keywordflow}{if}(bestAddr != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
325    \{
326       \textcolor{comment}{//Return the out-going interface and the source address to be used}
327       *\textcolor{keyword}{interface }= bestInterface;
328       *\hyperlink{ethernet_8h_a522a68dc3582289088de6b36018e9ea0}{srcAddr} = bestAddr->\hyperlink{structIpv4AddrEntry_a63f7b289c827b77a86f2824468b74fbf}{addr};
329 
330       \textcolor{comment}{//Successful source address selection}
331       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
332    \}
333    \textcolor{keywordflow}{else}
334    \{
335       \textcolor{comment}{//Report an error}
336       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab341b466f058a1fcda38ae5afe2d23c2}{ERROR\_NO\_ADDRESS};
337    \}
338 
339    \textcolor{comment}{//Return status code}
340    \textcolor{keywordflow}{return} error;
341 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a97921408616501cdc0795a3c4047646c}\label{ipv4__misc_8c_a97921408616501cdc0795a3c4047646c}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Update\+Error\+Stats@{ipv4\+Update\+Error\+Stats}}
\index{ipv4\+Update\+Error\+Stats@{ipv4\+Update\+Error\+Stats}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Update\+Error\+Stats()}{ipv4UpdateErrorStats()}}
{\footnotesize\ttfamily void ipv4\+Update\+Error\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t}}]{error }\end{DoxyParamCaption})}



Update Ethernet error statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em error} & Status code describing the error \\
\hline
\end{DoxyParams}


Definition at line 755 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
756 \{
757    \textcolor{comment}{//Check error code}
758    \textcolor{keywordflow}{switch}(error)
759    \{
760    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca9c63715d51ce91f67e4962b3f4da8435}{ERROR\_INVALID\_HEADER}:
761       \textcolor{comment}{//Number of input datagrams discarded due to errors in their IP headers}
762       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ipGroup.ipInHdrErrors, 1);
763       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInHdrErrors, 1);
764       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInHdrErrors, 1);
765       \textcolor{keywordflow}{break};
766    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS}:
767       \textcolor{comment}{//Number of input datagrams discarded because the destination IP address}
768       \textcolor{comment}{//was not a valid address}
769       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ipGroup.ipInAddrErrors, 1);
770       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInAddrErrors, 1);
771       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInAddrErrors, 1)
      ;
772       \textcolor{keywordflow}{break};
773    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cad80456d511d340377794c81eb5137d10}{ERROR\_PROTOCOL\_UNREACHABLE}:
774       \textcolor{comment}{//Number of locally-addressed datagrams received successfully but discarded}
775       \textcolor{comment}{//because of an unknown or unsupported protocol}
776       \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(ipGroup.ipInUnknownProtos, 1);
777       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInUnknownProtos, 1);
778       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInUnknownProtos,
       1);
779       \textcolor{keywordflow}{break};
780    \textcolor{keywordflow}{case} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH}:
781       \textcolor{comment}{//Number of input IP datagrams discarded because the datagram frame}
782       \textcolor{comment}{//didn't carry enough data}
783       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInTruncatedPkts, 1);
784       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInTruncatedPkts,
       1);
785       \textcolor{keywordflow}{break};
786    \textcolor{keywordflow}{default}:
787       \textcolor{comment}{//Just for sanity}
788       \textcolor{keywordflow}{break};
789    \}
790 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_ae54af470bc1e5dbcd8e80719e0b24e59}\label{ipv4__misc_8c_ae54af470bc1e5dbcd8e80719e0b24e59}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Update\+In\+Stats@{ipv4\+Update\+In\+Stats}}
\index{ipv4\+Update\+In\+Stats@{ipv4\+Update\+In\+Stats}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Update\+In\+Stats()}{ipv4UpdateInStats()}}
{\footnotesize\ttfamily void ipv4\+Update\+In\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{dest\+Ip\+Addr,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update I\+Pv4 input statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Ip\+Addr} & Destination IP address \\
\hline
\mbox{\tt in}  & {\em length} & Length of the incoming IP packet \\
\hline
\end{DoxyParams}


Definition at line 670 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
672 \{
673    \textcolor{comment}{//Check whether the destination address is a unicast, broadcast or multicast address}
674    \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}{ipv4IsBroadcastAddr}(interface, \hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr}))
675    \{
676       \textcolor{comment}{//Number of IP broadcast datagrams transmitted}
677       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInBcastPkts, 1);
678       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCInBcastPkts, 1);
679       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInBcastPkts, 1);
680       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCInBcastPkts, 1
      );
681    \}
682    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_aada5b622e70acf16bd1cd5a9c08ea107}{ipv4IsMulticastAddr}(\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr}))
683    \{
684       \textcolor{comment}{//Number of IP multicast datagrams transmitted}
685       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInMcastPkts, 1);
686       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCInMcastPkts, 1);
687       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInMcastPkts, 1);
688       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCInMcastPkts, 1
      );
689 
690       \textcolor{comment}{//Total number of octets transmitted in IP multicast datagrams}
691       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsInMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
692       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCInMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
693       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsInMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
694       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCInMcastOctets,
       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
695    \}
696 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv4__misc_8c_a6dcb6ccf3fb5fe97289b11941d36c695}\label{ipv4__misc_8c_a6dcb6ccf3fb5fe97289b11941d36c695}} 
\index{ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}!ipv4\+Update\+Out\+Stats@{ipv4\+Update\+Out\+Stats}}
\index{ipv4\+Update\+Out\+Stats@{ipv4\+Update\+Out\+Stats}!ipv4\+\_\+misc.\+c@{ipv4\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv4\+Update\+Out\+Stats()}{ipv4UpdateOutStats()}}
{\footnotesize\ttfamily void ipv4\+Update\+Out\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4\+Addr}}]{dest\+Ip\+Addr,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update I\+Pv4 output statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Ip\+Addr} & Destination IP address \\
\hline
\mbox{\tt in}  & {\em length} & Length of the outgoing IP packet \\
\hline
\end{DoxyParams}


Definition at line 706 of file ipv4\+\_\+misc.\+c.


\begin{DoxyCode}
708 \{
709    \textcolor{comment}{//Check whether the destination address is a unicast, broadcast or multicast address}
710    \textcolor{keywordflow}{if}(\hyperlink{ipv4__misc_8c_a73422a205c437d811cf29972c3464e1c}{ipv4IsBroadcastAddr}(interface, \hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr}))
711    \{
712       \textcolor{comment}{//Number of IP broadcast datagrams transmitted}
713       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsOutBcastPkts, 1);
714       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCOutBcastPkts, 1);
715       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsOutBcastPkts, 1)
      ;
716       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCOutBcastPkts, 
      1);
717    \}
718    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv4_8h_aada5b622e70acf16bd1cd5a9c08ea107}{ipv4IsMulticastAddr}(\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr}))
719    \{
720       \textcolor{comment}{//Number of IP multicast datagrams transmitted}
721       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsOutMcastPkts, 1);
722       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCOutMcastPkts, 1);
723       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsOutMcastPkts, 1)
      ;
724       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCOutMcastPkts, 
      1);
725 
726       \textcolor{comment}{//Total number of octets transmitted in IP multicast datagrams}
727       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsOutMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
728       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCOutMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
729       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsOutMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
730       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCOutMcastOctets
      , \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
731    \}
732 
733    \textcolor{comment}{//Total number of IP datagrams that this entity supplied to the lower}
734    \textcolor{comment}{//layers for transmission}
735    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsOutTransmits, 1);
736    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCOutTransmits, 1);
737    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsOutTransmits, 1);
738    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCOutTransmits, 1);
739 
740    \textcolor{comment}{//Total number of octets in IP datagrams delivered to the lower layers}
741    \textcolor{comment}{//for transmission}
742    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4SystemStats.ipSystemStatsOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
743    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4SystemStats.ipSystemStatsHCOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
744    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv4IfStatsTable[interface->index].ipIfStatsOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
745    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv4IfStatsTable[interface->index].ipIfStatsHCOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
746 \}
\end{DoxyCode}
