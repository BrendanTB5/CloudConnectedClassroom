\hypertarget{curve25519_8c}{}\section{cyclone\+\_\+crypto/ecc/curve25519.c File Reference}
\label{curve25519_8c}\index{cyclone\+\_\+crypto/ecc/curve25519.\+c@{cyclone\+\_\+crypto/ecc/curve25519.\+c}}


Curve25519 elliptic curve (constant-\/time implementation)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/ec\+\_\+curves.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/curve25519.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{curve25519_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{curve25519_8c_a1268b345c76c3639d20de5820b7ac8bc}{curve25519\+Set\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Set integer value. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_ac15009ba3514a9b25db173b34cecc698}{curve25519\+Add} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular addition. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_adafac414eff32ef866995031f230064d}{curve25519\+Add\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular addition. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a4bfda30d50e23c13e552eb320c674717}{curve25519\+Sub} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular subtraction. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a59f533cbfa5e3b0a1e1c33c1b52bc169}{curve25519\+Sub\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular subtraction. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519\+Mul} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular multiplication. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_ad927d5742d2010c43f1deaf15a45e5fc}{curve25519\+Mul\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular multiplication. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519\+Sqr} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Modular squaring. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519\+Pwr2} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
\begin{DoxyCompactList}\small\item\em Raise an integer to power 2$^\wedge$n. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519\+Red} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Modular reduction. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a5d96b1827091c69f5e83e5b48de05fac}{curve25519\+Inv} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Modular multiplicative inverse. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{curve25519_8c_a2e292cdeb29acc6fa52a36cc670ca2aa}{curve25519\+Sqrt} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compute the square root of (A / B) modulo p. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a5d900754494ae680c2b93fd27c1bed6e}{curve25519\+Copy} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Copy an integer. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a974793b59ff5bef6423620c0630bcd7f}{curve25519\+Swap} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\begin{DoxyCompactList}\small\item\em Conditional swap. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a4a0df0e0a6f77fcf5e44df5d38552b6d}{curve25519\+Select} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\begin{DoxyCompactList}\small\item\em Select an integer. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{curve25519_8c_a18d5fa5f2a5940e7afc08dd127f3ed45}{curve25519\+Comp} (const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compare integers. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a8e9b8576e591489652c867883c18e514}{curve25519\+Import} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data})
\begin{DoxyCompactList}\small\item\em Import an octet string. \end{DoxyCompactList}\item 
void \hyperlink{curve25519_8c_a4e9aeb2b5f23ec868997444e65a0f262}{curve25519\+Export} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data})
\begin{DoxyCompactList}\small\item\em Export an octet string. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{curve25519_8c_a4fcb0e029442065235ff4a6f7617f04c}{C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1} \mbox{[}8\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Curve25519 elliptic curve (constant-\/time implementation) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{curve25519_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{curve25519_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{curve25519.\+c@{curve25519.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file curve25519.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{curve25519_8c_ac15009ba3514a9b25db173b34cecc698}\label{curve25519_8c_ac15009ba3514a9b25db173b34cecc698}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Add@{curve25519\+Add}}
\index{curve25519\+Add@{curve25519\+Add}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Add()}{curve25519Add()}}
{\footnotesize\ttfamily void curve25519\+Add (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Modular addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A + B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ p \\
\hline
\end{DoxyParams}


Definition at line 79 of file curve25519.\+c.


\begin{DoxyCode}
80 \{
81    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
82    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
83 
84    \textcolor{comment}{//Compute R = A + B}
85    \textcolor{keywordflow}{for}(temp = 0, i = 0; i < 8; i++)
86    \{
87       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
88       temp += \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
89       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
90       temp >>= 32;
91    \}
92 
93    \textcolor{comment}{//Perform modular reduction}
94    \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r});
95 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_adafac414eff32ef866995031f230064d}\label{curve25519_8c_adafac414eff32ef866995031f230064d}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Add\+Int@{curve25519\+Add\+Int}}
\index{curve25519\+Add\+Int@{curve25519\+Add\+Int}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Add\+Int()}{curve25519AddInt()}}
{\footnotesize\ttfamily void curve25519\+Add\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Modular addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A + B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ (2$^\wedge$32 -\/ 1) \\
\hline
\end{DoxyParams}


Definition at line 105 of file curve25519.\+c.


\begin{DoxyCode}
106 \{
107    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
108    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
109 
110    \textcolor{comment}{//Compute R = A + B}
111    \textcolor{keywordflow}{for}(temp = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}, i = 0; i < 8; i++)
112    \{
113       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
114       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
115       temp >>= 32;
116    \}
117 
118    \textcolor{comment}{//Perform modular reduction}
119    \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r});
120 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a18d5fa5f2a5940e7afc08dd127f3ed45}\label{curve25519_8c_a18d5fa5f2a5940e7afc08dd127f3ed45}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Comp@{curve25519\+Comp}}
\index{curve25519\+Comp@{curve25519\+Comp}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Comp()}{curve25519Comp()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} curve25519\+Comp (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Compare integers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to the first integer \\
\hline
\mbox{\tt in}  & {\em b} & Pointer to the second integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 0 if the A = B, else 1 
\end{DoxyReturn}


Definition at line 587 of file curve25519.\+c.


\begin{DoxyCode}
588 \{
589    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
590    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
591 
592    \textcolor{comment}{//Initialize mask}
593    mask = 0;
594 
595    \textcolor{comment}{//Compare A and B}
596    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
597    \{
598       \textcolor{comment}{//Constant time implementation}
599       mask |= \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] ^ \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
600    \}
601 
602    \textcolor{comment}{//Return 0 if A = B, else 1}
603    \textcolor{keywordflow}{return} ((\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) (mask | (~mask + 1))) >> 31;
604 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a5d900754494ae680c2b93fd27c1bed6e}\label{curve25519_8c_a5d900754494ae680c2b93fd27c1bed6e}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Copy@{curve25519\+Copy}}
\index{curve25519\+Copy@{curve25519\+Copy}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Copy()}{curve25519Copy()}}
{\footnotesize\ttfamily void curve25519\+Copy (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Copy an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em a} & Pointer to the destination integer \\
\hline
\mbox{\tt in}  & {\em b} & Pointer to the source integer \\
\hline
\end{DoxyParams}


Definition at line 515 of file curve25519.\+c.


\begin{DoxyCode}
516 \{
517    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
518 
519    \textcolor{comment}{//Copy the value of the integer}
520    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
521    \{
522       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
523    \}
524 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a4e9aeb2b5f23ec868997444e65a0f262}\label{curve25519_8c_a4e9aeb2b5f23ec868997444e65a0f262}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Export@{curve25519\+Export}}
\index{curve25519\+Export@{curve25519\+Export}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Export()}{curve25519Export()}}
{\footnotesize\ttfamily void curve25519\+Export (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data }\end{DoxyParamCaption})}



Export an octet string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to the integer to be exported \\
\hline
\mbox{\tt out}  & {\em data} & Octet string resulting from the conversion \\
\hline
\end{DoxyParams}


Definition at line 634 of file curve25519.\+c.


\begin{DoxyCode}
635 \{
636    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
637 
638    \textcolor{comment}{//Convert from host byte order to little-endian byte order}
639    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
640    \{
641       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = \hyperlink{cpu__endian_8h_a336f132f175f47bfab3fa57f6a00276d}{htole32}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i]);
642    \}
643 
644    \textcolor{comment}{//Export the octet string}
645    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, 32);
646 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a8e9b8576e591489652c867883c18e514}\label{curve25519_8c_a8e9b8576e591489652c867883c18e514}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Import@{curve25519\+Import}}
\index{curve25519\+Import@{curve25519\+Import}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Import()}{curve25519Import()}}
{\footnotesize\ttfamily void curve25519\+Import (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data }\end{DoxyParamCaption})}



Import an octet string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em a} & Pointer to resulting integer \\
\hline
\mbox{\tt in}  & {\em data} & Octet string to be converted \\
\hline
\end{DoxyParams}


Definition at line 613 of file curve25519.\+c.


\begin{DoxyCode}
614 \{
615    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
616 
617    \textcolor{comment}{//Import the octet string}
618    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 32);
619 
620    \textcolor{comment}{//Convert from little-endian byte order to host byte order}
621    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
622    \{
623       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = \hyperlink{cpu__endian_8h_a637984da0e96437b4bff8b68108256c6}{letoh32}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i]);
624    \}
625 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a5d96b1827091c69f5e83e5b48de05fac}\label{curve25519_8c_a5d96b1827091c69f5e83e5b48de05fac}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Inv@{curve25519\+Inv}}
\index{curve25519\+Inv@{curve25519\+Inv}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Inv()}{curve25519Inv()}}
{\footnotesize\ttfamily void curve25519\+Inv (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a }\end{DoxyParamCaption})}



Modular multiplicative inverse. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A$^\wedge$-\/1 mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\end{DoxyParams}


Definition at line 380 of file curve25519.\+c.


\begin{DoxyCode}
381 \{
382    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[8];
383    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} v[8];
384 
385    \textcolor{comment}{//Since GF(p) is a prime field, the Fermat's little theorem can be}
386    \textcolor{comment}{//used to find the multiplicative inverse of A modulo p}
387    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
388    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^2 - 1)}
389    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
390    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^3 - 1)}
391    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 3);
392    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//A^(2^6 - 1)}
393    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
394    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^7 - 1)}
395    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 7);
396    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//A^(2^14 - 1)}
397    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
398    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^15 - 1)}
399    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 15);
400    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//A^(2^30 - 1)}
401    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
402    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^31 - 1)}
403    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 31);
404    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, v); \textcolor{comment}{//A^(2^62 - 1)}
405    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 62);
406    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//A^(2^124 - 1)}
407    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
408    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^125 - 1)}
409    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 125);
410    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//A^(2^250 - 1)}
411    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
412    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
413    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
414    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
415    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
416    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
417    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
418    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^255 - 21)}
419 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}\label{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Mul@{curve25519\+Mul}}
\index{curve25519\+Mul@{curve25519\+Mul}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Mul()}{curve25519Mul()}}
{\footnotesize\ttfamily void curve25519\+Mul (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Modular multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $\ast$ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ p \\
\hline
\end{DoxyParams}


Definition at line 191 of file curve25519.\+c.


\begin{DoxyCode}
192 \{
193    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
194    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
195    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
196    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
197    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[16];
198 
199    \textcolor{comment}{//Initialize variables}
200    temp = 0;
201    c = 0;
202 
203    \textcolor{comment}{//Comba's method is used to perform multiplication}
204    \textcolor{keywordflow}{for}(i = 0; i < 16; i++)
205    \{
206       \textcolor{comment}{//The algorithm computes the products, column by column}
207       \textcolor{keywordflow}{if}(i < 8)
208       \{
209          \textcolor{comment}{//Inner loop}
210          \textcolor{keywordflow}{for}(j = 0; j <= i; j++)
211          \{
212             temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[j] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i - j];
213             c += temp >> 32;
214             temp &= 0xFFFFFFFF;
215          \}
216       \}
217       \textcolor{keywordflow}{else}
218       \{
219          \textcolor{comment}{//Inner loop}
220          \textcolor{keywordflow}{for}(j = i - 7; j < 8; j++)
221          \{
222             temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[j] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i - j];
223             c += temp >> 32;
224             temp &= 0xFFFFFFFF;
225          \}
226       \}
227 
228       \textcolor{comment}{//At the bottom of each column, the final result is written to memory}
229       u[i] = temp & 0xFFFFFFFF;
230 
231       \textcolor{comment}{//Propagate the carry upwards}
232       temp = c & 0xFFFFFFFF;
233       c >>= 32;
234    \}
235 
236    \textcolor{comment}{//Reduce bit 255 (2^255 = 19 mod p)}
237    temp = (u[7] >> 31) * 19;
238    \textcolor{comment}{//Mask the most significant bit}
239    u[7] &= 0x7FFFFFFF;
240 
241    \textcolor{comment}{//Perform fast modular reduction (first pass)}
242    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
243    \{
244       temp += u[i];
245       temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) u[i + 8] * 38;
246       u[i] = temp & 0xFFFFFFFF;
247       temp >>= 32;
248    \}
249 
250    \textcolor{comment}{//Reduce bit 256 (2^256 = 38 mod p)}
251    temp *= 38;
252    \textcolor{comment}{//Reduce bit 255 (2^255 = 19 mod p)}
253    temp += (u[7] >> 31) * 19;
254    \textcolor{comment}{//Mask the most significant bit}
255    u[7] &= 0x7FFFFFFF;
256 
257    \textcolor{comment}{//Perform fast modular reduction (second pass)}
258    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
259    \{
260       temp += u[i];
261       u[i] = temp & 0xFFFFFFFF;
262       temp >>= 32;
263    \}
264 
265    \textcolor{comment}{//Reduce non-canonical values}
266    \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u);
267 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_ad927d5742d2010c43f1deaf15a45e5fc}\label{curve25519_8c_ad927d5742d2010c43f1deaf15a45e5fc}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Mul\+Int@{curve25519\+Mul\+Int}}
\index{curve25519\+Mul\+Int@{curve25519\+Mul\+Int}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Mul\+Int()}{curve25519MulInt()}}
{\footnotesize\ttfamily void curve25519\+Mul\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Modular multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $\ast$ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ (2$^\wedge$32 -\/ 1) \\
\hline
\end{DoxyParams}


Definition at line 277 of file curve25519.\+c.


\begin{DoxyCode}
278 \{
279    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
280    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
281    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[8];
282 
283    \textcolor{comment}{//Compute R = A * B}
284    \textcolor{keywordflow}{for}(temp = 0, i = 0; i < 8; i++)
285    \{
286       temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
287       u[i] = temp & 0xFFFFFFFF;
288       temp >>= 32;
289    \}
290 
291    \textcolor{comment}{//Reduce bit 256 (2^256 = 38 mod p)}
292    temp *= 38;
293    \textcolor{comment}{//Reduce bit 255 (2^255 = 19 mod p)}
294    temp += (u[7] >> 31) * 19;
295    \textcolor{comment}{//Mask the most significant bit}
296    u[7] &= 0x7FFFFFFF;
297 
298    \textcolor{comment}{//Perform fast modular reduction}
299    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
300    \{
301       temp += u[i];
302       u[i] = temp & 0xFFFFFFFF;
303       temp >>= 32;
304    \}
305 
306    \textcolor{comment}{//Reduce non-canonical values}
307    \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u);
308 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}\label{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Pwr2@{curve25519\+Pwr2}}
\index{curve25519\+Pwr2@{curve25519\+Pwr2}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Pwr2()}{curve25519Pwr2()}}
{\footnotesize\ttfamily void curve25519\+Pwr2 (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{n }\end{DoxyParamCaption})}



Raise an integer to power 2$^\wedge$n. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $^\wedge$ (2$^\wedge$n)) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em n} & An integer such as n $>$= 1 \\
\hline
\end{DoxyParams}


Definition at line 331 of file curve25519.\+c.


\begin{DoxyCode}
332 \{
333    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
334 
335    \textcolor{comment}{//Pre-compute (A ^ 2) mod p}
336    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
337 
338    \textcolor{comment}{//Compute R = (A ^ (2^n)) mod p}
339    \textcolor{keywordflow}{for}(i = 1; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
340    \{
341       \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r});
342    \}
343 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}\label{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Red@{curve25519\+Red}}
\index{curve25519\+Red@{curve25519\+Red}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Red()}{curve25519Red()}}
{\footnotesize\ttfamily void curve25519\+Red (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a }\end{DoxyParamCaption})}



Modular reduction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ (2 $\ast$ p) \\
\hline
\end{DoxyParams}


Definition at line 352 of file curve25519.\+c.


\begin{DoxyCode}
353 \{
354    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
355    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
356    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[8];
357 
358    \textcolor{comment}{//Compute B = A + 19}
359    \textcolor{keywordflow}{for}(temp = 19, i = 0; i < 8; i++)
360    \{
361       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
362       b[i] = temp & 0xFFFFFFFF;
363       temp >>= 32;
364    \}
365 
366    \textcolor{comment}{//Compute B = A - (2^255 - 19)}
367    b[7] -= 0x80000000;
368 
369    \textcolor{comment}{//If B < (2^255 - 19) then R = B, else R = A}
370    \hyperlink{curve25519_8c_a4a0df0e0a6f77fcf5e44df5d38552b6d}{curve25519Select}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, b, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, (b[7] & 0x80000000) >> 31);
371 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a4a0df0e0a6f77fcf5e44df5d38552b6d}\label{curve25519_8c_a4a0df0e0a6f77fcf5e44df5d38552b6d}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Select@{curve25519\+Select}}
\index{curve25519\+Select@{curve25519\+Select}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Select()}{curve25519Select()}}
{\footnotesize\ttfamily void curve25519\+Select (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{c }\end{DoxyParamCaption})}



Select an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Pointer to the destination integer \\
\hline
\mbox{\tt in}  & {\em a} & Pointer to the first source integer \\
\hline
\mbox{\tt in}  & {\em b} & Pointer to the second source integer \\
\hline
\mbox{\tt in}  & {\em c} & Condition variable \\
\hline
\end{DoxyParams}


Definition at line 562 of file curve25519.\+c.


\begin{DoxyCode}
564 \{
565    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
566    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
567 
568    \textcolor{comment}{//The mask is the all-1 or all-0 word}
569    mask = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} - 1;
570 
571    \textcolor{comment}{//Select between A and B}
572    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
573    \{
574       \textcolor{comment}{//Constant time implementation}
575       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = (\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] & \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}) | (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i] & ~mask);
576    \}
577 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a1268b345c76c3639d20de5820b7ac8bc}\label{curve25519_8c_a1268b345c76c3639d20de5820b7ac8bc}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Set\+Int@{curve25519\+Set\+Int}}
\index{curve25519\+Set\+Int@{curve25519\+Set\+Int}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Set\+Int()}{curve25519SetInt()}}
{\footnotesize\ttfamily void curve25519\+Set\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Set integer value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em a} & Pointer to the integer to be initialized \\
\hline
\mbox{\tt in}  & {\em b} & Initial value \\
\hline
\end{DoxyParams}


Definition at line 57 of file curve25519.\+c.


\begin{DoxyCode}
58 \{
59    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
60 
61    \textcolor{comment}{//Set the value of the least significant word}
62    \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[0] = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
63 
64    \textcolor{comment}{//Initialize the rest of the integer}
65    \textcolor{keywordflow}{for}(i = 1; i < 8; i++)
66    \{
67       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = 0;
68    \}
69 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}\label{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Sqr@{curve25519\+Sqr}}
\index{curve25519\+Sqr@{curve25519\+Sqr}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Sqr()}{curve25519Sqr()}}
{\footnotesize\ttfamily void curve25519\+Sqr (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a }\end{DoxyParamCaption})}



Modular squaring. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $^\wedge$ 2) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\end{DoxyParams}


Definition at line 317 of file curve25519.\+c.


\begin{DoxyCode}
318 \{
319    \textcolor{comment}{//Compute R = (A ^ 2) mod p}
320    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
321 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a2e292cdeb29acc6fa52a36cc670ca2aa}\label{curve25519_8c_a2e292cdeb29acc6fa52a36cc670ca2aa}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Sqrt@{curve25519\+Sqrt}}
\index{curve25519\+Sqrt@{curve25519\+Sqrt}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Sqrt()}{curve25519Sqrt()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} curve25519\+Sqrt (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Compute the square root of (A / B) modulo p. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A / B)$^\wedge$(1 / 2) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$ B $<$ p \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 0 if the square root exists, else 1 
\end{DoxyReturn}


Definition at line 430 of file curve25519.\+c.


\begin{DoxyCode}
431 \{
432    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} res1;
433    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} res2;
434    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}[8];
435    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[8];
436    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} v[8];
437 
438    \textcolor{comment}{//Compute the candidate root (A / B)^((p + 3) / 8). This can be done}
439    \textcolor{comment}{//with the following trick, using a single modular powering for both the}
440    \textcolor{comment}{//inversion of B and the square root: A * B^3 * (A * B^7)^((p - 5) / 8)}
441    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
442    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
443    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(v, v);
444    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
445 
446    \textcolor{comment}{//Compute C = A * B^7}
447    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(c, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, v);
448 
449    \textcolor{comment}{//Compute U = C^((p - 5) / 8)}
450    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, c);
451    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, c); \textcolor{comment}{//C^(2^2 - 1)}
452    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
453    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, c); \textcolor{comment}{//C^(2^3 - 1)}
454    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 3);
455    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//C^(2^6 - 1)}
456    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
457    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, c); \textcolor{comment}{//C^(2^7 - 1)}
458    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 7);
459    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//C^(2^14 - 1)}
460    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
461    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, c); \textcolor{comment}{//C^(2^15 - 1)}
462    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 15);
463    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//C^(2^30 - 1)}
464    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
465    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, c); \textcolor{comment}{//C^(2^31 - 1)}
466    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 31);
467    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, v); \textcolor{comment}{//C^(2^62 - 1)}
468    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 62);
469    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//C^(2^124 - 1)}
470    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
471    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, c); \textcolor{comment}{//C^(2^125 - 1)}
472    \hyperlink{curve25519_8c_ac89f9465636f86f38c6fd1d106b17ef5}{curve25519Pwr2}(u, v, 125);
473    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v); \textcolor{comment}{//C^(2^250 - 1)}
474    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
475    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(u, u);
476    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, c); \textcolor{comment}{//C^(2^252 - 3)}
477 
478    \textcolor{comment}{//The first candidate root is U = A * B^3 * (A * B^7)^((p - 5) / 8)}
479    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
480    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
481    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
482    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(u, u, v);
483 
484    \textcolor{comment}{//The second candidate root is V = U * sqrt(-1)}
485    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(v, u, \hyperlink{curve25519_8c_a4fcb0e029442065235ff4a6f7617f04c}{CURVE25519\_SQRT\_MINUS\_1});
486 
487    \textcolor{comment}{//Calculate C = B * U^2}
488    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(c, u);
489    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(c, c, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
490 
491    \textcolor{comment}{//Check whether B * U^2 = A}
492    res1 = \hyperlink{curve25519_8c_a18d5fa5f2a5940e7afc08dd127f3ed45}{curve25519Comp}(c, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
493 
494    \textcolor{comment}{//Calculate C = B * V^2}
495    \hyperlink{curve25519_8c_a1db25b2546a42bf79a9c1d701c30d047}{curve25519Sqr}(c, v);
496    \hyperlink{curve25519_8c_ab54a7954076d8cd159d561ef39e94fdc}{curve25519Mul}(c, c, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
497 
498    \textcolor{comment}{//Check whether B * V^2 = A}
499    res2 = \hyperlink{curve25519_8c_a18d5fa5f2a5940e7afc08dd127f3ed45}{curve25519Comp}(c, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
500 
501    \textcolor{comment}{//Select the first or the second candidate root}
502    \hyperlink{curve25519_8c_a4a0df0e0a6f77fcf5e44df5d38552b6d}{curve25519Select}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u, v, res1);
503 
504    \textcolor{comment}{//Return 0 if the square root exists}
505    \textcolor{keywordflow}{return} res1 & res2;
506 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a4bfda30d50e23c13e552eb320c674717}\label{curve25519_8c_a4bfda30d50e23c13e552eb320c674717}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Sub@{curve25519\+Sub}}
\index{curve25519\+Sub@{curve25519\+Sub}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Sub()}{curve25519Sub()}}
{\footnotesize\ttfamily void curve25519\+Sub (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Modular subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A -\/ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ p \\
\hline
\end{DoxyParams}


Definition at line 130 of file curve25519.\+c.


\begin{DoxyCode}
131 \{
132    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
133    \hyperlink{stdint_8h_a414156feea104f8f75b4ed9e3121b2f6}{int64\_t} temp;
134 
135    \textcolor{comment}{//Compute R = A - 19 - B}
136    \textcolor{keywordflow}{for}(temp = -19, i = 0; i < 8; i++)
137    \{
138       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
139       temp -= \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
140       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
141       temp >>= 32;
142    \}
143 
144    \textcolor{comment}{//Compute R = A + (2^255 - 19) - B}
145    \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[7] += 0x80000000;
146 
147    \textcolor{comment}{//Perform modular reduction}
148    \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r});
149 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a59f533cbfa5e3b0a1e1c33c1b52bc169}\label{curve25519_8c_a59f533cbfa5e3b0a1e1c33c1b52bc169}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Sub\+Int@{curve25519\+Sub\+Int}}
\index{curve25519\+Sub\+Int@{curve25519\+Sub\+Int}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Sub\+Int()}{curve25519SubInt()}}
{\footnotesize\ttfamily void curve25519\+Sub\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Modular subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A -\/ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ (2$^\wedge$32 -\/ 1) \\
\hline
\end{DoxyParams}


Definition at line 159 of file curve25519.\+c.


\begin{DoxyCode}
160 \{
161    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
162    \hyperlink{stdint_8h_a414156feea104f8f75b4ed9e3121b2f6}{int64\_t} temp;
163 
164    \textcolor{comment}{//Set initial value}
165    temp = -19;
166    temp -= \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
167 
168    \textcolor{comment}{//Compute R = A - 19 - B}
169    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
170    \{
171       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
172       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
173       temp >>= 32;
174    \}
175 
176    \textcolor{comment}{//Compute R = A + (2^255 - 19) - B}
177    \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[7] += 0x80000000;
178 
179    \textcolor{comment}{//Perform modular reduction}
180    \hyperlink{curve25519_8c_a5e34b19474bd1027cee1a3e8e60ed4a6}{curve25519Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r});
181 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve25519_8c_a974793b59ff5bef6423620c0630bcd7f}\label{curve25519_8c_a974793b59ff5bef6423620c0630bcd7f}} 
\index{curve25519.\+c@{curve25519.\+c}!curve25519\+Swap@{curve25519\+Swap}}
\index{curve25519\+Swap@{curve25519\+Swap}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{curve25519\+Swap()}{curve25519Swap()}}
{\footnotesize\ttfamily void curve25519\+Swap (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{c }\end{DoxyParamCaption})}



Conditional swap. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em a} & Pointer to the first integer \\
\hline
\mbox{\tt in,out}  & {\em b} & Pointer to the second integer \\
\hline
\mbox{\tt in}  & {\em c} & Condition variable \\
\hline
\end{DoxyParams}


Definition at line 534 of file curve25519.\+c.


\begin{DoxyCode}
535 \{
536    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
537    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
538    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} dummy;
539 
540    \textcolor{comment}{//The mask is the all-1 or all-0 word}
541    mask = ~\hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 1;
542 
543    \textcolor{comment}{//Conditional swap}
544    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
545    \{
546       \textcolor{comment}{//Constant time implementation}
547       dummy = mask & (\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] ^ \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i]);
548       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] ^= dummy;
549       \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i] ^= dummy;
550    \}
551 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{curve25519_8c_a4fcb0e029442065235ff4a6f7617f04c}\label{curve25519_8c_a4fcb0e029442065235ff4a6f7617f04c}} 
\index{curve25519.\+c@{curve25519.\+c}!C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1@{C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1}}
\index{C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1@{C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1}!curve25519.\+c@{curve25519.\+c}}
\subsubsection{\texorpdfstring{C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1}{CURVE25519\_SQRT\_MINUS\_1}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} C\+U\+R\+V\+E25519\+\_\+\+S\+Q\+R\+T\+\_\+\+M\+I\+N\+U\+S\+\_\+1\mbox{[}8\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   0x4A0EA0B0, 0xC4EE1B27, 0xAD2FE478, 0x2F431806,
   0x3DFBD7A7, 0x2B4D0099, 0x4FC1DF0B, 0x2B832480
\}
\end{DoxyCode}


Definition at line 44 of file curve25519.\+c.

