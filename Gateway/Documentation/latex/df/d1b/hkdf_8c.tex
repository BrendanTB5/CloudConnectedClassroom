\hypertarget{hkdf_8c}{}\section{cyclone\+\_\+crypto/kdf/hkdf.c File Reference}
\label{hkdf_8c}\index{cyclone\+\_\+crypto/kdf/hkdf.\+c@{cyclone\+\_\+crypto/kdf/hkdf.\+c}}


H\+K\+DF (H\+M\+A\+C-\/based Key Derivation Function)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}kdf/hkdf.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mac/hmac.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{hkdf_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{hkdf_8c_a14af29cd3b1404aa0cdf72e3e32eec8b}{hkdf} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ikm, size\+\_\+t ikm\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$salt, size\+\_\+t salt\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$info, size\+\_\+t info\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$okm, size\+\_\+t okm\+Len)
\begin{DoxyCompactList}\small\item\em H\+K\+DF key derivation function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{hkdf_8c_a653db0ef6134dd93dcf234b6b19d0fa6}{hkdf\+Extract} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ikm, size\+\_\+t ikm\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$salt, size\+\_\+t salt\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$prk)
\begin{DoxyCompactList}\small\item\em H\+K\+DF extract step. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{hkdf_8c_ae55f682ac83b20665786c4cc40b560c1}{hkdf\+Expand} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$\hyperlink{tls_8h_a17d89840e7296c323504b31fc6359606}{hash}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$prk, size\+\_\+t prk\+Len, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$info, size\+\_\+t info\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$okm, size\+\_\+t okm\+Len)
\begin{DoxyCompactList}\small\item\em H\+K\+DF expand step. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
H\+K\+DF (H\+M\+A\+C-\/based Key Derivation Function) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
H\+K\+DF is a simple H\+M\+A\+C-\/based key derivation function which can be used as a building block in various protocols and applications. Refer to R\+FC 5869 for more details

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{hkdf_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{hkdf_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{hkdf.\+c@{hkdf.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!hkdf.\+c@{hkdf.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 38 of file hkdf.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{hkdf_8c_a14af29cd3b1404aa0cdf72e3e32eec8b}\label{hkdf_8c_a14af29cd3b1404aa0cdf72e3e32eec8b}} 
\index{hkdf.\+c@{hkdf.\+c}!hkdf@{hkdf}}
\index{hkdf@{hkdf}!hkdf.\+c@{hkdf.\+c}}
\subsubsection{\texorpdfstring{hkdf()}{hkdf()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} hkdf (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ikm,  }\item[{size\+\_\+t}]{ikm\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{salt,  }\item[{size\+\_\+t}]{salt\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{info,  }\item[{size\+\_\+t}]{info\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{okm,  }\item[{size\+\_\+t}]{okm\+Len }\end{DoxyParamCaption})}



H\+K\+DF key derivation function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em ikm} & input keying material \\
\hline
\mbox{\tt in}  & {\em ikm\+Len} & Length in the input keying material \\
\hline
\mbox{\tt in}  & {\em salt} & Optional salt value (a non-\/secret random value) \\
\hline
\mbox{\tt in}  & {\em salt\+Len} & Length of the salt \\
\hline
\mbox{\tt in}  & {\em info} & Optional application specific information \\
\hline
\mbox{\tt in}  & {\em info\+Len} & Length of the application specific information \\
\hline
\mbox{\tt out}  & {\em okm} & output keying material \\
\hline
\mbox{\tt in}  & {\em okm\+Len} & Length of the output keying material \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 63 of file hkdf.\+c.


\begin{DoxyCode}
66 \{
67    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
68    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} prk[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
69 
70    \textcolor{comment}{//Perform HKDF extract step}
71    error = \hyperlink{hkdf_8c_a653db0ef6134dd93dcf234b6b19d0fa6}{hkdfExtract}(hash, ikm, ikmLen, salt, saltLen, prk);
72 
73    \textcolor{comment}{//Check status code}
74    \textcolor{keywordflow}{if}(!error)
75    \{
76       \textcolor{comment}{//Perform HKDF expand step}
77       error = \hyperlink{hkdf_8c_ae55f682ac83b20665786c4cc40b560c1}{hkdfExpand}(hash, prk, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}, info, infoLen,
78          okm, okmLen);
79    \}
80 
81    \textcolor{comment}{//Return status code}
82    \textcolor{keywordflow}{return} error;
83 \}
\end{DoxyCode}
\mbox{\Hypertarget{hkdf_8c_ae55f682ac83b20665786c4cc40b560c1}\label{hkdf_8c_ae55f682ac83b20665786c4cc40b560c1}} 
\index{hkdf.\+c@{hkdf.\+c}!hkdf\+Expand@{hkdf\+Expand}}
\index{hkdf\+Expand@{hkdf\+Expand}!hkdf.\+c@{hkdf.\+c}}
\subsubsection{\texorpdfstring{hkdf\+Expand()}{hkdfExpand()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} hkdf\+Expand (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{prk,  }\item[{size\+\_\+t}]{prk\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{info,  }\item[{size\+\_\+t}]{info\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{okm,  }\item[{size\+\_\+t}]{okm\+Len }\end{DoxyParamCaption})}



H\+K\+DF expand step. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em prk} & Pseudorandom key \\
\hline
\mbox{\tt in}  & {\em prk\+Len} & Length of the pseudorandom key \\
\hline
\mbox{\tt in}  & {\em info} & Optional application specific information \\
\hline
\mbox{\tt in}  & {\em info\+Len} & Length of the application specific information \\
\hline
\mbox{\tt out}  & {\em okm} & output keying material \\
\hline
\mbox{\tt in}  & {\em okm\+Len} & Length of the output keying material \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 150 of file hkdf.\+c.


\begin{DoxyCode}
152 \{
153    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} i;
154    \textcolor{keywordtype}{size\_t} tLen;
155    \hyperlink{structHmacContext}{HmacContext} *hmacContext;
156    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t}[\hyperlink{cyclone__crypto_2core_2crypto_8h_ac6e85336237dcdf8efb9280b84e4ffd6}{MAX\_HASH\_DIGEST\_SIZE}];
157 
158    \textcolor{comment}{//Check parameters}
159    \textcolor{keywordflow}{if}(hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || prk == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || okm == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
160       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
161 
162    \textcolor{comment}{//The application specific information parameter is optional}
163    \textcolor{keywordflow}{if}(info == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && infoLen != 0)
164       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
165 
166    \textcolor{comment}{//PRK must be at least HashLen octets}
167    \textcolor{keywordflow}{if}(prkLen < hash->digestSize)
168       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
169 
170    \textcolor{comment}{//Check the length of the output keying material}
171    \textcolor{keywordflow}{if}(okmLen > (255 * hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}))
172       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
173 
174    \textcolor{comment}{//Allocate a memory buffer to hold the HMAC context}
175    hmacContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(\textcolor{keyword}{sizeof}(\hyperlink{structHmacContext}{HmacContext}));
176    \textcolor{comment}{//Failed to allocate memory?}
177    \textcolor{keywordflow}{if}(hmacContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
178       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
179 
180    \textcolor{comment}{//T(0) is an empty string (zero length)}
181    tLen = 0;
182 
183    \textcolor{comment}{//Iterate as many times as required}
184    \textcolor{keywordflow}{for}(i = 1; okmLen > 0; i++)
185    \{
186       \textcolor{comment}{//Compute T(i) = HMAC-Hash(PRK, T(i-1) | info | i)}
187       \hyperlink{hmac_8c_ac4ecc520cae02c1b9bbb3651758a703e}{hmacInit}(hmacContext, hash, prk, prkLen);
188       \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hmacContext, t, tLen);
189       \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hmacContext, info, infoLen);
190       \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hmacContext, &i, \textcolor{keyword}{sizeof}(i));
191       \hyperlink{hmac_8c_a387906ffc55755df380361c43ce0bd6a}{hmacFinal}(hmacContext, t);
192 
193       \textcolor{comment}{//Number of octets in the current block}
194       tLen = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(okmLen, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
195       \textcolor{comment}{//Save the resulting block}
196       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(okm, t, tLen);
197 
198       \textcolor{comment}{//Point to the next block}
199       okm += tLen;
200       okmLen -= tLen;
201    \}
202 
203    \textcolor{comment}{//Free previously allocated memory}
204    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hmacContext);
205 
206    \textcolor{comment}{//Successful processing}
207    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
208 \}
\end{DoxyCode}
\mbox{\Hypertarget{hkdf_8c_a653db0ef6134dd93dcf234b6b19d0fa6}\label{hkdf_8c_a653db0ef6134dd93dcf234b6b19d0fa6}} 
\index{hkdf.\+c@{hkdf.\+c}!hkdf\+Extract@{hkdf\+Extract}}
\index{hkdf\+Extract@{hkdf\+Extract}!hkdf.\+c@{hkdf.\+c}}
\subsubsection{\texorpdfstring{hkdf\+Extract()}{hkdfExtract()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} hkdf\+Extract (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ikm,  }\item[{size\+\_\+t}]{ikm\+Len,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{salt,  }\item[{size\+\_\+t}]{salt\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{prk }\end{DoxyParamCaption})}



H\+K\+DF extract step. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash} & Underlying hash function \\
\hline
\mbox{\tt in}  & {\em ikm} & input keying material \\
\hline
\mbox{\tt in}  & {\em ikm\+Len} & Length in the input keying material \\
\hline
\mbox{\tt in}  & {\em salt} & Optional salt value (a non-\/secret random value) \\
\hline
\mbox{\tt in}  & {\em salt\+Len} & Length of the salt \\
\hline
\mbox{\tt out}  & {\em prk} & Pseudorandom key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 97 of file hkdf.\+c.


\begin{DoxyCode}
99 \{
100    \hyperlink{structHmacContext}{HmacContext} *hmacContext;
101 
102    \textcolor{comment}{//Check parameters}
103    \textcolor{keywordflow}{if}(hash == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || ikm == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || prk == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
104       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
105 
106    \textcolor{comment}{//The salt parameter is optional}
107    \textcolor{keywordflow}{if}(salt == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && saltLen != 0)
108       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
109 
110    \textcolor{comment}{//Allocate a memory buffer to hold the HMAC context}
111    hmacContext = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(\textcolor{keyword}{sizeof}(\hyperlink{structHmacContext}{HmacContext}));
112    \textcolor{comment}{//Failed to allocate memory?}
113    \textcolor{keywordflow}{if}(hmacContext == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
114       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
115 
116    \textcolor{comment}{//The salt parameter is optional}
117    \textcolor{keywordflow}{if}(salt == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
118    \{
119       \textcolor{comment}{//If the salt is not provided, it is set to a string of HashLen zeros}
120       \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(hmacContext->\hyperlink{structHmacContext_a8d7c8cb8814b1cfe2dee045d26077c72}{digest}, 0, hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
121       salt = hmacContext->\hyperlink{structHmacContext_a8d7c8cb8814b1cfe2dee045d26077c72}{digest};
122       saltLen = hash->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize};
123    \}
124 
125    \textcolor{comment}{//Compute PRK = HMAC-Hash(salt, IKM)}
126    \hyperlink{hmac_8c_ac4ecc520cae02c1b9bbb3651758a703e}{hmacInit}(hmacContext, hash, salt, saltLen);
127    \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(hmacContext, ikm, ikmLen);
128    \hyperlink{hmac_8c_a387906ffc55755df380361c43ce0bd6a}{hmacFinal}(hmacContext, prk);
129 
130    \textcolor{comment}{//Free previously allocated memory}
131    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(hmacContext);
132 
133    \textcolor{comment}{//Successful processing}
134    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
135 \}
\end{DoxyCode}
