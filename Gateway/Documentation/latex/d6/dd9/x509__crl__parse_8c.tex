\hypertarget{x509__crl__parse_8c}{}\section{cyclone\+\_\+crypto/pkix/x509\+\_\+crl\+\_\+parse.c File Reference}
\label{x509__crl__parse_8c}\index{cyclone\+\_\+crypto/pkix/x509\+\_\+crl\+\_\+parse.\+c@{cyclone\+\_\+crypto/pkix/x509\+\_\+crl\+\_\+parse.\+c}}


C\+RL (Certificate Revocation List)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+cert\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+crl\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{x509__crl__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_ad69a5f70f34299352517304ced2761cc}{x509\+Parse\+Crl} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CrlInfo}{X509\+Crl\+Info} $\ast$crl\+Info)
\begin{DoxyCompactList}\small\item\em Parse a C\+RL (Certificate Revocation List) \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a4e083dbf0acb9e0618c963f28d5b73ef}{x509\+Parse\+Tbs\+Cert\+List} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509TbsCertList}{X509\+Tbs\+Cert\+List} $\ast$tbs\+Cert\+List)
\begin{DoxyCompactList}\small\item\em Parse T\+B\+S\+Cert\+List structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a2cceef6a39e5792d53c26b0b11ca26cf}{x509\+Parse\+Crl\+Version} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$\hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Parse Version field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a6987ccf9854c9995c04fafd2bff49420}{x509\+Parse\+Revoked\+Certificates} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509TbsCertList}{X509\+Tbs\+Cert\+List} $\ast$tbs\+Cert\+List)
\begin{DoxyCompactList}\small\item\em Parse Revoked\+Certificates field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_aac3f846bba37fe0707d6e5286739fa2e}{x509\+Parse\+Revoked\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509RevokedCertificate}{X509\+Revoked\+Certificate} $\ast$revoked\+Certificate)
\begin{DoxyCompactList}\small\item\em Parse Revoked\+Certificate field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a09557e6879e43cc9fbce1332155702c9}{x509\+Parse\+Crl\+Extensions} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509CrlExtensions}{X509\+Crl\+Extensions} $\ast$crl\+Extensions)
\begin{DoxyCompactList}\small\item\em Parse C\+RL extensions. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a22cd918dccf7ea3d2a49b57b43065945}{x509\+Parse\+Crl\+Number} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CrlNumber}{X509\+Crl\+Number} $\ast$crl\+Number)
\begin{DoxyCompactList}\small\item\em Parse C\+R\+L\+Number extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a05734d5ce4aa29ca5dccd300c1145dc2}{x509\+Parse\+Delta\+Crl\+Indicator} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509DeltaCrlIndicator}{X509\+Delta\+Crl\+Indicator} $\ast$delta\+Crl\+Indicator)
\begin{DoxyCompactList}\small\item\em Parse Delta\+C\+R\+L\+Indicator extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a39db7bea83ea4bf8802cea50d1a70d24}{x509\+Parse\+Issuing\+Distr\+Point} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509IssuingDistrPoint}{X509\+Issuing\+Distr\+Point} $\ast$issuing\+Distr\+Point)
\begin{DoxyCompactList}\small\item\em Parse Issuing\+Distribution\+Point extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a3841b64c5b193d86bbc246576cd04557}{x509\+Parse\+Crl\+Entry\+Extensions} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509CrlEntryExtensions}{X509\+Crl\+Entry\+Extensions} $\ast$crl\+Entry\+Extensions)
\begin{DoxyCompactList}\small\item\em Parse C\+RL entry extensions. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_ac4797f2d3f9d166a43975e1c2477e8b5}{x509\+Parse\+Reason\+Code} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CrlReason}{X509\+Crl\+Reason} $\ast$reason\+Code)
\begin{DoxyCompactList}\small\item\em Parse Reason\+Code entry extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_ad1b99f1397237a141354e2d804f08cde}{x509\+Parse\+Invalidity\+Date} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509InvalidityDate}{X509\+Invalidity\+Date} $\ast$invalidity\+Date)
\begin{DoxyCompactList}\small\item\em Parse Invalidity\+Date entry extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{x509__crl__parse_8c_a9db7e6619764ae3d1e082c32d8b3664b}{x509\+Parse\+Certificate\+Issuer} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CertificateIssuer}{X509\+Certificate\+Issuer} $\ast$certificate\+Issuer)
\begin{DoxyCompactList}\small\item\em Parse Certificate\+Issuer entry extension. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
C\+RL (Certificate Revocation List) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{x509__crl__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{x509__crl__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file x509\+\_\+crl\+\_\+parse.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{x509__crl__parse_8c_a9db7e6619764ae3d1e082c32d8b3664b}\label{x509__crl__parse_8c_a9db7e6619764ae3d1e082c32d8b3664b}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Certificate\+Issuer@{x509\+Parse\+Certificate\+Issuer}}
\index{x509\+Parse\+Certificate\+Issuer@{x509\+Parse\+Certificate\+Issuer}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Certificate\+Issuer()}{x509ParseCertificateIssuer()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Certificate\+Issuer (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CertificateIssuer}{X509\+Certificate\+Issuer} $\ast$}]{certificate\+Issuer }\end{DoxyParamCaption})}



Parse Certificate\+Issuer entry extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em certificate\+Issuer} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 947 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
949 \{
950    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
951    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
952    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
953    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
954    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
955 
956    \textcolor{comment}{//Debug message}
957    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing CertificateIssuer...\(\backslash\)r\(\backslash\)n"});
958 
959    \textcolor{comment}{//An CRL entry extension can be marked as critical}
960    certificateIssuer->\hyperlink{structX509CertificateIssuer_a69bdaad1cfc7c722a01daf1fea1b59c6}{critical} = critical;
961 
962    \textcolor{comment}{//The CertificateIssuer structure shall contain a valid sequence}
963    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
964    \textcolor{comment}{//Failed to decode ASN.1 tag?}
965    \textcolor{keywordflow}{if}(error)
966       \textcolor{keywordflow}{return} error;
967 
968    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
969    certificateIssuer->\hyperlink{structX509CertificateIssuer_aca740e49878dfee5262e84711add3685}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
970    certificateIssuer->\hyperlink{structX509CertificateIssuer_a7de1a5e5319cc043ecf8caee5e144a58}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
971 
972    \textcolor{comment}{//Point to the first item of the sequence}
973    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
974    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
975 
976    \textcolor{comment}{//This CRL entry extension identifies the certificate issuer associated}
977    \textcolor{comment}{//with an entry in an indirect CRL, that is, a CRL that has the indirectCRL}
978    \textcolor{comment}{//indicator set in its issuing distribution point extension}
979    \textcolor{keywordflow}{for}(i = 0; \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0; i++)
980    \{
981       \textcolor{comment}{//Parse GeneralName field}
982       error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
983       \textcolor{comment}{//Any error to report?}
984       \textcolor{keywordflow}{if}(error)
985          \textcolor{keywordflow}{return} error;
986 
987       \textcolor{comment}{//Sanity check}
988       \textcolor{keywordflow}{if}(i < \hyperlink{pkix_2x509__common_8h_a09e385209ce2093edad815e2a702f2c4}{X509\_MAX\_CERT\_ISSUER\_NAMES})
989       \{
990          \textcolor{comment}{//Save issuer alternative name}
991          certificateIssuer->\hyperlink{structX509CertificateIssuer_a5d622673ff3debbb98c1ab08a79951e8}{generalNames}[i] = generalName;
992       \}
993 
994       \textcolor{comment}{//Next item}
995       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
996       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
997    \}
998 
999    \textcolor{comment}{//When present, the certificate issuer CRL entry extension includes one or}
1000    \textcolor{comment}{//more names (refer to RFC 5280, section 5.3.3)}
1001    \textcolor{keywordflow}{if}(i == 0)
1002       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1003 
1004    \textcolor{comment}{//Save the number of issuer alternative names}
1005    certificateIssuer->\hyperlink{structX509CertificateIssuer_aaa36ed84755aba7fc15aed1d88d6660c}{numGeneralNames} = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(i, 
      \hyperlink{pkix_2x509__common_8h_a09e385209ce2093edad815e2a702f2c4}{X509\_MAX\_CERT\_ISSUER\_NAMES});
1006 
1007    \textcolor{comment}{//Successful processing}
1008    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1009 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_ad69a5f70f34299352517304ced2761cc}\label{x509__crl__parse_8c_ad69a5f70f34299352517304ced2761cc}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Crl@{x509\+Parse\+Crl}}
\index{x509\+Parse\+Crl@{x509\+Parse\+Crl}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Crl()}{x509ParseCrl()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Crl (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CrlInfo}{X509\+Crl\+Info} $\ast$}]{crl\+Info }\end{DoxyParamCaption})}



Parse a C\+RL (Certificate Revocation List) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the C\+RL to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the C\+RL \\
\hline
\mbox{\tt out}  & {\em crl\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 54 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
56 \{
57    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
58    \textcolor{keywordtype}{size\_t} totalLength;
59    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
60 
61    \textcolor{comment}{//Debug message}
62    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Parsing X.509 CRL...\(\backslash\)r\(\backslash\)n"});
63 
64    \textcolor{comment}{//Check parameters}
65    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || crlInfo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
66       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
67 
68    \textcolor{comment}{//Clear the CRL information structure}
69    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(crlInfo, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509CrlInfo}{X509CrlInfo}));
70 
71    \textcolor{comment}{//The CRL is encapsulated within a sequence}
72    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
73    \textcolor{comment}{//Failed to decode ASN.1 tag?}
74    \textcolor{keywordflow}{if}(error)
75       \textcolor{keywordflow}{return} error;
76 
77    \textcolor{comment}{//Point to the very first field}
78    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
79    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
80 
81    \textcolor{comment}{//Parse TBSCertList structure}
82    error = \hyperlink{x509__crl__parse_8c_a4e083dbf0acb9e0618c963f28d5b73ef}{x509ParseTbsCertList}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
83       &crlInfo->\hyperlink{structX509CrlInfo_ae6ee6de5021634d8d20c25f7c44b768b}{tbsCertList});
84    \textcolor{comment}{//Any error to report?}
85    \textcolor{keywordflow}{if}(error)
86       \textcolor{keywordflow}{return} error;
87 
88    \textcolor{comment}{//Point to the next field}
89    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
90    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
91 
92    \textcolor{comment}{//Parse SignatureAlgorithm structure}
93    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
94       &crlInfo->\hyperlink{structX509CrlInfo_a5e984222c3974ab1bae8062c6096efe1}{signatureAlgo});
95    \textcolor{comment}{//Any error to report?}
96    \textcolor{keywordflow}{if}(error)
97       \textcolor{keywordflow}{return} error;
98 
99    \textcolor{comment}{//This field must contain the same algorithm identifier as the signature}
100    \textcolor{comment}{//field in the TBSCertList sequence (refer to RFC 5280, section 5.1.1.2)}
101    \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(crlInfo->\hyperlink{structX509CrlInfo_a5e984222c3974ab1bae8062c6096efe1}{signatureAlgo}.\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid}, crlInfo->
      \hyperlink{structX509CrlInfo_a5e984222c3974ab1bae8062c6096efe1}{signatureAlgo}.\hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen},
102       crlInfo->\hyperlink{structX509CrlInfo_ae6ee6de5021634d8d20c25f7c44b768b}{tbsCertList}.signatureAlgo.oid, crlInfo->\hyperlink{structX509CrlInfo_ae6ee6de5021634d8d20c25f7c44b768b}{tbsCertList}.signatureAlgo.
      oidLen))
103    \{
104       \textcolor{comment}{//Report an error}
105       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
106    \}
107 
108    \textcolor{comment}{//Point to the next field}
109    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
110    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
111 
112    \textcolor{comment}{//Parse SignatureValue structure}
113    error = \hyperlink{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509ParseSignatureValue}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
114       &crlInfo->\hyperlink{structX509CrlInfo_ae2badd150ecfe41d7f5004d271a107be}{signatureValue});
115    \textcolor{comment}{//Any error to report?}
116    \textcolor{keywordflow}{if}(error)
117       \textcolor{keywordflow}{return} error;
118 
119    \textcolor{comment}{//CRL successfully parsed}
120    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
121 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a3841b64c5b193d86bbc246576cd04557}\label{x509__crl__parse_8c_a3841b64c5b193d86bbc246576cd04557}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Crl\+Entry\+Extensions@{x509\+Parse\+Crl\+Entry\+Extensions}}
\index{x509\+Parse\+Crl\+Entry\+Extensions@{x509\+Parse\+Crl\+Entry\+Extensions}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Crl\+Entry\+Extensions()}{x509ParseCrlEntryExtensions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Crl\+Entry\+Extensions (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509CrlEntryExtensions}{X509\+Crl\+Entry\+Extensions} $\ast$}]{crl\+Entry\+Extensions }\end{DoxyParamCaption})}



Parse C\+RL entry extensions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em crl\+Entry\+Extensions} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 766 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
768 \{
769    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
770    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
771    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
772    \hyperlink{structX509Extension}{X509Extension} extension;
773 
774    \textcolor{comment}{//No more data to process?}
775    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
776    \{
777       \textcolor{comment}{//The CrlEntryExtensions field is optional}
778       *totalLength = 0;
779       \textcolor{comment}{//Exit immediately}
780       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
781    \}
782 
783    \textcolor{comment}{//Debug message}
784    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing CrlEntryExtensions...\(\backslash\)r\(\backslash\)n"});
785 
786    \textcolor{comment}{//This field is a sequence of one or more CRL entry extensions}
787    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
788    \textcolor{comment}{//Failed to decode ASN.1 tag?}
789    \textcolor{keywordflow}{if}(error)
790       \textcolor{keywordflow}{return} error;
791 
792    \textcolor{comment}{//Save the total length of the CrlEntryExtensions field}
793    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
794 
795    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
796    crlEntryExtensions->\hyperlink{structX509CrlEntryExtensions_aac3e654a7a82417ec2b4d467b920b331}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
797    crlEntryExtensions->\hyperlink{structX509CrlEntryExtensions_ae9e2a3a5ed2c1dd2aac65ec95b66cebe}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
798 
799    \textcolor{comment}{//Point to the first item of the sequence}
800    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
801    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
802 
803    \textcolor{comment}{//Loop through the extensions}
804    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
805    \{
806       \textcolor{comment}{//Each extension includes an OID and a value}
807       error = \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509ParseExtension}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &extension);
808       \textcolor{comment}{//Any error to report?}
809       \textcolor{keywordflow}{if}(error)
810          \textcolor{keywordflow}{return} error;
811 
812       \textcolor{comment}{//ReasonCode extension found?}
813       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
814          \hyperlink{pkix_2x509__common_8c_ae5cf21b6ec2e752fa4ce07ec7ae45be4}{X509\_REASON\_CODE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{pkix_2x509__common_8c_ae5cf21b6ec2e752fa4ce07ec7ae45be4}{X509\_REASON\_CODE\_OID})))
815       \{
816          \textcolor{comment}{//Parse ReasonCode extension}
817          error = \hyperlink{x509__crl__parse_8c_ac4797f2d3f9d166a43975e1c2477e8b5}{x509ParseReasonCode}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
818             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlEntryExtensions->\hyperlink{structX509CrlEntryExtensions_abf5c1417352a318774053023e5ba2349}{reasonCode});
819       \}
820       \textcolor{comment}{//InvalidityDate extension found?}
821       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
822          \hyperlink{pkix_2x509__common_8c_a9379bde469ec28e174ea1962eb7694ff}{X509\_INVALIDITY\_DATE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{pkix_2x509__common_8c_a9379bde469ec28e174ea1962eb7694ff}{X509\_INVALIDITY\_DATE\_OID})))
823       \{
824          \textcolor{comment}{//Parse InvalidityDate extension}
825          error = \hyperlink{x509__crl__parse_8c_ad1b99f1397237a141354e2d804f08cde}{x509ParseInvalidityDate}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
826             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlEntryExtensions->\hyperlink{structX509CrlEntryExtensions_a9e9e24f3ceaa94ea5fd687eb9cfc9bee}{invalidityDate});
827       \}
828       \textcolor{comment}{//CertificateIssuer extension found?}
829       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
830          \hyperlink{pkix_2x509__common_8c_a0b7ad5edef8732d7cab1fb367dadc303}{X509\_CERTIFICATE\_ISSUER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{pkix_2x509__common_8c_a0b7ad5edef8732d7cab1fb367dadc303}{X509\_CERTIFICATE\_ISSUER\_OID})))
831       \{
832          \textcolor{comment}{//Parse CertificateIssuer extension}
833          error = \hyperlink{x509__crl__parse_8c_a9db7e6619764ae3d1e082c32d8b3664b}{x509ParseCertificateIssuer}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
834             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlEntryExtensions->\hyperlink{structX509CrlEntryExtensions_aa459ff4f84348b019b3d79e595cabcc1}{certIssuer});
835       \}
836       \textcolor{comment}{//Unknown extension?}
837       \textcolor{keywordflow}{else}
838       \{
839          \textcolor{comment}{//Check if the extension is marked as critical}
840          \textcolor{keywordflow}{if}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical})
841          \{
842             \textcolor{comment}{//If a CRL contains a critical CRL entry extension that the}
843             \textcolor{comment}{//application cannot process, then the application must not use}
844             \textcolor{comment}{//that CRL to determine the status of any certificates}
845             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
846          \}
847       \}
848 
849       \textcolor{comment}{//Any parsing error?}
850       \textcolor{keywordflow}{if}(error)
851          \textcolor{keywordflow}{return} error;
852 
853       \textcolor{comment}{//Next extension}
854       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
855       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
856    \}
857 
858    \textcolor{comment}{//Successful processing}
859    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
860 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a09557e6879e43cc9fbce1332155702c9}\label{x509__crl__parse_8c_a09557e6879e43cc9fbce1332155702c9}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Crl\+Extensions@{x509\+Parse\+Crl\+Extensions}}
\index{x509\+Parse\+Crl\+Extensions@{x509\+Parse\+Crl\+Extensions}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Crl\+Extensions()}{x509ParseCrlExtensions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Crl\+Extensions (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509CrlExtensions}{X509\+Crl\+Extensions} $\ast$}]{crl\+Extensions }\end{DoxyParamCaption})}



Parse C\+RL extensions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em crl\+Extensions} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 443 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
445 \{
446    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
447    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
448    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
449    \hyperlink{structX509Extension}{X509Extension} extension;
450 
451    \textcolor{comment}{//No more data to process?}
452    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
453    \{
454       \textcolor{comment}{//The CrlExtensions field is optional}
455       *totalLength = 0;
456       \textcolor{comment}{//Exit immediately}
457       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
458    \}
459 
460    \textcolor{comment}{//Explicit tagging is used to encode the CrlExtensions field}
461    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
462    \textcolor{comment}{//Failed to decode ASN.1 tag?}
463    \textcolor{keywordflow}{if}(error)
464       \textcolor{keywordflow}{return} error;
465 
466    \textcolor{comment}{//Enforce encoding, class and type}
467    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       0);
468    \textcolor{comment}{//Invalid tag?}
469    \textcolor{keywordflow}{if}(error)
470    \{
471       \textcolor{comment}{//The CrlExtensions field is optional}
472       *totalLength = 0;
473       \textcolor{comment}{//Exit immediately}
474       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
475    \}
476 
477    \textcolor{comment}{//Save the total length of the field}
478    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
479 
480    \textcolor{comment}{//Debug message}
481    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing CrlExtensions...\(\backslash\)r\(\backslash\)n"});
482 
483    \textcolor{comment}{//This field is a sequence of one or more CRL extensions}
484    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
485    \textcolor{comment}{//Failed to decode ASN.1 tag?}
486    \textcolor{keywordflow}{if}(error)
487       \textcolor{keywordflow}{return} error;
488 
489    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
490    crlExtensions->\hyperlink{structX509CrlExtensions_a521e89220625fa3e60676d3e47e562fd}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
491    crlExtensions->\hyperlink{structX509CrlExtensions_ae998f5bcf83a5ef274ff191bbefd20c8}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
492 
493    \textcolor{comment}{//Point to the first item of the sequence}
494    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
495    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
496 
497    \textcolor{comment}{//Loop through the extensions}
498    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
499    \{
500       \textcolor{comment}{//Each extension includes an OID and a value}
501       error = \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509ParseExtension}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &extension);
502       \textcolor{comment}{//Any error to report?}
503       \textcolor{keywordflow}{if}(error)
504          \textcolor{keywordflow}{return} error;
505 
506       \textcolor{comment}{//CRLNumber extension found?}
507       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
508          \hyperlink{pkix_2x509__common_8c_abec622365205a70695b6887e3b3ce3d9}{X509\_CRL\_NUMBER\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{pkix_2x509__common_8c_abec622365205a70695b6887e3b3ce3d9}{X509\_CRL\_NUMBER\_OID})))
509       \{
510          \textcolor{comment}{//Parse CRLNumber extension}
511          error = \hyperlink{x509__crl__parse_8c_a22cd918dccf7ea3d2a49b57b43065945}{x509ParseCrlNumber}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
512             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlExtensions->\hyperlink{structX509CrlExtensions_a1c4443888eafec771d558ee4485ffcb7}{crlNumber});
513       \}
514       \textcolor{comment}{//DeltaCRLIndicator extension found?}
515       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
516          \hyperlink{pkix_2x509__common_8c_a778b4afb94a992855908321f9cf1d22d}{X509\_DELTA\_CRL\_INDICATOR\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{pkix_2x509__common_8c_a778b4afb94a992855908321f9cf1d22d}{X509\_DELTA\_CRL\_INDICATOR\_OID})))
517       \{
518          \textcolor{comment}{//Parse DeltaCRLIndicator extension}
519          error = \hyperlink{x509__crl__parse_8c_a05734d5ce4aa29ca5dccd300c1145dc2}{x509ParseDeltaCrlIndicator}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
520             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlExtensions->\hyperlink{structX509CrlExtensions_adfaf2ba762fb10d96abd445936f6fb58}{deltaCrlIndicator});
521       \}
522       \textcolor{comment}{//IssuingDistributionPoint extension found?}
523       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
524          \hyperlink{pkix_2x509__common_8c_aa47bf6850826db00ff247215b2fdabcb}{X509\_ISSUING\_DISTR\_POINT\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{pkix_2x509__common_8c_aa47bf6850826db00ff247215b2fdabcb}{X509\_ISSUING\_DISTR\_POINT\_OID})))
525       \{
526          \textcolor{comment}{//Parse IssuingDistributionPoint extension}
527          error = \hyperlink{x509__crl__parse_8c_a39db7bea83ea4bf8802cea50d1a70d24}{x509ParseIssuingDistrPoint}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
528             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlExtensions->\hyperlink{structX509CrlExtensions_a7257319dbcfa75fe2671c04d6af33b20}{issuingDistrPoint});
529       \}
530       \textcolor{comment}{//AuthorityKeyIdentifier extension found?}
531       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
532          \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID})))
533       \{
534          \textcolor{comment}{//Parse AuthorityKeyIdentifier extension}
535          error = \hyperlink{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}{x509ParseAuthorityKeyId}(extension.
      \hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical}, extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value},
536             extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen}, &crlExtensions->\hyperlink{structX509CrlExtensions_a73c935fb8c6d58c20de34b1dfb8cbfcd}{authKeyId});
537       \}
538       \textcolor{comment}{//Unknown extension?}
539       \textcolor{keywordflow}{else}
540       \{
541          \textcolor{comment}{//Check if the extension is marked as critical}
542          \textcolor{keywordflow}{if}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical})
543          \{
544             \textcolor{comment}{//If a CRL contains a critical extension that the application cannot}
545             \textcolor{comment}{//process, then the application must not use that CRL to determine}
546             \textcolor{comment}{//the status of certificates (refer to RFC 5280, section 5.2)}
547             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
548          \}
549       \}
550 
551       \textcolor{comment}{//Any parsing error?}
552       \textcolor{keywordflow}{if}(error)
553          \textcolor{keywordflow}{return} error;
554 
555       \textcolor{comment}{//Next extension}
556       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
557       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
558    \}
559 
560    \textcolor{comment}{//Successful processing}
561    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
562 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a22cd918dccf7ea3d2a49b57b43065945}\label{x509__crl__parse_8c_a22cd918dccf7ea3d2a49b57b43065945}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Crl\+Number@{x509\+Parse\+Crl\+Number}}
\index{x509\+Parse\+Crl\+Number@{x509\+Parse\+Crl\+Number}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Crl\+Number()}{x509ParseCrlNumber()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Crl\+Number (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CrlNumber}{X509\+Crl\+Number} $\ast$}]{crl\+Number }\end{DoxyParamCaption})}



Parse C\+R\+L\+Number extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em crl\+Number} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 574 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
576 \{
577    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
578    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
579 
580    \textcolor{comment}{//Debug message}
581    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing CRLNumber...\(\backslash\)r\(\backslash\)n"});
582 
583    \textcolor{comment}{//An CRL extension can be marked as critical}
584    crlNumber->\hyperlink{structX509CrlNumber_a27040e3f05b9880dd292216df79db133}{critical} = critical;
585 
586    \textcolor{comment}{//Read CRLNumber structure}
587    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
588    \textcolor{comment}{//Failed to decode ASN.1 tag?}
589    \textcolor{keywordflow}{if}(error)
590       \textcolor{keywordflow}{return} error;
591 
592    \textcolor{comment}{//Enforce encoding, class and type}
593    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
594    \textcolor{comment}{//Invalid tag?}
595    \textcolor{keywordflow}{if}(error)
596       \textcolor{keywordflow}{return} error;
597 
598    \textcolor{comment}{//Save the CRL number}
599    crlNumber->\hyperlink{structX509CrlNumber_a2bdf0fce19a08b65b89b12adb43e4d96}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
600    crlNumber->\hyperlink{structX509CrlNumber_a356c19fbf1a7212c3981b771f1288214}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
601 
602    \textcolor{comment}{//Successful processing}
603    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
604 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a2cceef6a39e5792d53c26b0b11ca26cf}\label{x509__crl__parse_8c_a2cceef6a39e5792d53c26b0b11ca26cf}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Crl\+Version@{x509\+Parse\+Crl\+Version}}
\index{x509\+Parse\+Crl\+Version@{x509\+Parse\+Crl\+Version}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Crl\+Version()}{x509ParseCrlVersion()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Crl\+Version (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$}]{version }\end{DoxyParamCaption})}



Parse Version field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em version} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 250 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
252 \{
253    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
254    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
255    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
256 
257    \textcolor{comment}{//Debug message}
258    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Version...\(\backslash\)r\(\backslash\)n"});
259 
260    \textcolor{comment}{//The Version field is optional}
261    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
262    \textcolor{comment}{//Failed to decode ASN.1 tag?}
263    \textcolor{keywordflow}{if}(error)
264       \textcolor{keywordflow}{return} error;
265 
266    \textcolor{comment}{//Check encoding, class and type}
267    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
268 
269    \textcolor{comment}{//The tag does not match the criteria?}
270    \textcolor{keywordflow}{if}(error)
271    \{
272       \textcolor{comment}{//Assume X.509 version 1 format}
273       *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26a146bf525f16981660f60fd6c0bdeeee7}{X509\_VERSION\_1};
274       \textcolor{comment}{//Skip the current field}
275       *totalLength = 0;
276 
277       \textcolor{comment}{//Exit immediately}
278       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
279    \}
280 
281    \textcolor{comment}{//Parse Version field}
282    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &value);
283    \textcolor{comment}{//Failed to decode ASN.1 tag?}
284    \textcolor{keywordflow}{if}(error)
285       \textcolor{keywordflow}{return} error;
286 
287    \textcolor{comment}{//Save the version}
288    *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = (\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509Version}) value;
289    \textcolor{comment}{//Save the total length of the field}
290    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
291 
292    \textcolor{comment}{//Successful processing}
293    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
294 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a05734d5ce4aa29ca5dccd300c1145dc2}\label{x509__crl__parse_8c_a05734d5ce4aa29ca5dccd300c1145dc2}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Delta\+Crl\+Indicator@{x509\+Parse\+Delta\+Crl\+Indicator}}
\index{x509\+Parse\+Delta\+Crl\+Indicator@{x509\+Parse\+Delta\+Crl\+Indicator}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Delta\+Crl\+Indicator()}{x509ParseDeltaCrlIndicator()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Delta\+Crl\+Indicator (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509DeltaCrlIndicator}{X509\+Delta\+Crl\+Indicator} $\ast$}]{delta\+Crl\+Indicator }\end{DoxyParamCaption})}



Parse Delta\+C\+R\+L\+Indicator extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em delta\+Crl\+Indicator} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 616 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
618 \{
619    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
620    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
621 
622    \textcolor{comment}{//Debug message}
623    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing DeltaCRLIndicator...\(\backslash\)r\(\backslash\)n"});
624 
625    \textcolor{comment}{//An CRL extension can be marked as critical}
626    deltaCrlIndicator->\hyperlink{structX509DeltaCrlIndicator_a019a2a9523e49ff3fb04a3eafa033a8e}{critical} = critical;
627 
628    \textcolor{comment}{//Read BaseCRLNumber structure}
629    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
630    \textcolor{comment}{//Failed to decode ASN.1 tag?}
631    \textcolor{keywordflow}{if}(error)
632       \textcolor{keywordflow}{return} error;
633 
634    \textcolor{comment}{//Enforce encoding, class and type}
635    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
636    \textcolor{comment}{//Invalid tag?}
637    \textcolor{keywordflow}{if}(error)
638       \textcolor{keywordflow}{return} error;
639 
640    \textcolor{comment}{//Save the CRL number}
641    deltaCrlIndicator->\hyperlink{structX509DeltaCrlIndicator_a46db19e937cde0b512f7bb8c023381cc}{baseCrlNumber} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
642    deltaCrlIndicator->\hyperlink{structX509DeltaCrlIndicator_a0480df76b12e9bc47214eed6d60fed66}{baseCrlNumberLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
643 
644    \textcolor{comment}{//Successful processing}
645    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
646 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_ad1b99f1397237a141354e2d804f08cde}\label{x509__crl__parse_8c_ad1b99f1397237a141354e2d804f08cde}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Invalidity\+Date@{x509\+Parse\+Invalidity\+Date}}
\index{x509\+Parse\+Invalidity\+Date@{x509\+Parse\+Invalidity\+Date}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Invalidity\+Date()}{x509ParseInvalidityDate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Invalidity\+Date (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509InvalidityDate}{X509\+Invalidity\+Date} $\ast$}]{invalidity\+Date }\end{DoxyParamCaption})}



Parse Invalidity\+Date entry extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em invalidity\+Date} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 918 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
920 \{
921    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
922    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
923 
924    \textcolor{comment}{//Debug message}
925    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing InvalidityDate...\(\backslash\)r\(\backslash\)n"});
926 
927    \textcolor{comment}{//An CRL entry extension can be marked as critical}
928    invalidityDate->\hyperlink{structX509InvalidityDate_a657d7508949fd6cacc4e13afb15d3b29}{critical} = critical;
929 
930    \textcolor{comment}{//Read InvalidityDate field}
931    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &invalidityDate->
      \hyperlink{structX509InvalidityDate_a45d8ce42e99a17e69ae7cb5fca80383d}{value});
932 
933    \textcolor{comment}{//Return status code}
934    \textcolor{keywordflow}{return} error;
935 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a39db7bea83ea4bf8802cea50d1a70d24}\label{x509__crl__parse_8c_a39db7bea83ea4bf8802cea50d1a70d24}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Issuing\+Distr\+Point@{x509\+Parse\+Issuing\+Distr\+Point}}
\index{x509\+Parse\+Issuing\+Distr\+Point@{x509\+Parse\+Issuing\+Distr\+Point}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Issuing\+Distr\+Point()}{x509ParseIssuingDistrPoint()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Issuing\+Distr\+Point (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509IssuingDistrPoint}{X509\+Issuing\+Distr\+Point} $\ast$}]{issuing\+Distr\+Point }\end{DoxyParamCaption})}



Parse Issuing\+Distribution\+Point extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em issuing\+Distr\+Point} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 658 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
660 \{
661    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
662    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
663 
664    \textcolor{comment}{//Debug message}
665    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing IssuingDistributionPoint...\(\backslash\)r\(\backslash\)n"});
666 
667    \textcolor{comment}{//An CRL extension can be marked as critical}
668    issuingDistrPoint->\hyperlink{structX509IssuingDistrPoint_a8a4ba72628597652b8722195d3b0e4c5}{critical} = critical;
669 
670    \textcolor{comment}{//The IssuingDistributionPoint extension is encapsulated within a sequence}
671    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
672    \textcolor{comment}{//Failed to decode ASN.1 tag?}
673    \textcolor{keywordflow}{if}(error)
674       \textcolor{keywordflow}{return} error;
675 
676    \textcolor{comment}{//Point to the first subfield of the sequence}
677    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
678    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
679 
680    \textcolor{comment}{//The issuing distribution point is a critical CRL extension that identifies}
681    \textcolor{comment}{//the CRL distribution point and scope for a particular CRL, and it indicates}
682    \textcolor{comment}{//whether the CRL covers revocation for end entity certificates only, CA}
683    \textcolor{comment}{//certificates only, attribute certificates only, or a limited set of reason}
684    \textcolor{comment}{//codes}
685    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
686    \{
687       \textcolor{comment}{//Read current subfield}
688       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
689       \textcolor{comment}{//Failed to decode ASN.1 tag?}
690       \textcolor{keywordflow}{if}(error)
691          \textcolor{keywordflow}{return} error;
692 
693       \textcolor{comment}{//Explicit tagging shall be used to encode each subfield}
694       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
695          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
696 
697       \textcolor{comment}{//Check subfield type}
698       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
699       \{
700          \textcolor{comment}{//Parse distributionPoint subfield}
701       \}
702       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 1)
703       \{
704          \textcolor{comment}{//Make sure the length of the boolean is valid}
705          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
706             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
707 
708          \textcolor{comment}{//Save the value of the onlyContainsUserCerts subfield}
709          issuingDistrPoint->\hyperlink{structX509IssuingDistrPoint_a3dde449bdf1ed32a2f768d9f65190b8c}{onlyContainsUserCerts} = tag.
      \hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
710       \}
711       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 2)
712       \{
713          \textcolor{comment}{//Make sure the length of the boolean is valid}
714          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
715             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
716 
717          \textcolor{comment}{//Save the value of the onlyContainsCACerts subfield}
718          issuingDistrPoint->\hyperlink{structX509IssuingDistrPoint_a26dda81d883f442a0efc63043b12f386}{onlyContainsCaCerts} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
719       \}
720       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 3)
721       \{
722          \textcolor{comment}{//Parse onlySomeReasons subfield}
723       \}
724       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 4)
725       \{
726          \textcolor{comment}{//Make sure the length of the boolean is valid}
727          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
728             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
729 
730          \textcolor{comment}{//Save the value of the indirectCRL subfield}
731          issuingDistrPoint->\hyperlink{structX509IssuingDistrPoint_a9caa38c5038747f071f9b03970a1e9e6}{indirectCrl} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
732       \}
733       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 5)
734       \{
735          \textcolor{comment}{//Make sure the length of the boolean is valid}
736          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
737             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
738 
739          \textcolor{comment}{//Save the value of the onlyContainsAttributeCerts subfield}
740          issuingDistrPoint->\hyperlink{structX509IssuingDistrPoint_a99dd1689d124d9acbe6892d709cfec6a}{onlyContainsAttributeCerts} = tag.
      \hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
741       \}
742       \textcolor{keywordflow}{else}
743       \{
744          \textcolor{comment}{//Discard unknown subfields}
745       \}
746 
747       \textcolor{comment}{//Next subfield}
748       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
749       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
750    \}
751 
752    \textcolor{comment}{//Successful processing}
753    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
754 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_ac4797f2d3f9d166a43975e1c2477e8b5}\label{x509__crl__parse_8c_ac4797f2d3f9d166a43975e1c2477e8b5}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Reason\+Code@{x509\+Parse\+Reason\+Code}}
\index{x509\+Parse\+Reason\+Code@{x509\+Parse\+Reason\+Code}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Reason\+Code()}{x509ParseReasonCode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Reason\+Code (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CrlReason}{X509\+Crl\+Reason} $\ast$}]{reason\+Code }\end{DoxyParamCaption})}



Parse Reason\+Code entry extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em reason\+Code} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 872 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
874 \{
875    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
876    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
877 
878    \textcolor{comment}{//Debug message}
879    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ReasonCode...\(\backslash\)r\(\backslash\)n"});
880 
881    \textcolor{comment}{//An CRL entry extension can be marked as critical}
882    reasonCode->\hyperlink{structX509CrlReason_a1b546d87163e9e5e93ac3ccabb3da44e}{critical} = critical;
883 
884    \textcolor{comment}{//Read ReasonCode field}
885    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
886    \textcolor{comment}{//Failed to decode ASN.1 tag?}
887    \textcolor{keywordflow}{if}(error)
888       \textcolor{keywordflow}{return} error;
889 
890    \textcolor{comment}{//Enforce encoding, class and type}
891    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa1cf8068b09604b00dcd131d1efaf891d}{ASN1\_TYPE\_ENUMERATED});
892    \textcolor{comment}{//Invalid tag?}
893    \textcolor{keywordflow}{if}(error)
894       \textcolor{keywordflow}{return} error;
895 
896    \textcolor{comment}{//Check the length of the field}
897    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
898       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
899 
900    \textcolor{comment}{//The ReasonCode is a non-critical CRL entry extension that identifies}
901    \textcolor{comment}{//the reason for the certificate revocation}
902    reasonCode->\hyperlink{structX509CrlReason_aeb0b8a221c1871f8faab552f92f66cd7}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0];
903 
904    \textcolor{comment}{//Successful processing}
905    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
906 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_aac3f846bba37fe0707d6e5286739fa2e}\label{x509__crl__parse_8c_aac3f846bba37fe0707d6e5286739fa2e}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Revoked\+Certificate@{x509\+Parse\+Revoked\+Certificate}}
\index{x509\+Parse\+Revoked\+Certificate@{x509\+Parse\+Revoked\+Certificate}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Revoked\+Certificate()}{x509ParseRevokedCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Revoked\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509RevokedCertificate}{X509\+Revoked\+Certificate} $\ast$}]{revoked\+Certificate }\end{DoxyParamCaption})}



Parse Revoked\+Certificate field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em revoked\+Certificate} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 374 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
376 \{
377    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
378    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
379    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
380 
381    \textcolor{comment}{//Debug message}
382    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing RevokedCertificate...\(\backslash\)r\(\backslash\)n"});
383 
384    \textcolor{comment}{//Clear the RevokedCertificate structure}
385    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(revokedCertificate, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509RevokedCertificate}{X509RevokedCertificate}));
386 
387    \textcolor{comment}{//The RevokedCertificate structure shall contain a valid sequence}
388    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
389    \textcolor{comment}{//Failed to decode ASN.1 tag?}
390    \textcolor{keywordflow}{if}(error)
391       \textcolor{keywordflow}{return} error;
392 
393    \textcolor{comment}{//Save the total length of the field}
394    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
395 
396    \textcolor{comment}{//Point to the first item of the sequence}
397    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
398    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
399 
400    \textcolor{comment}{//Parse UserCertificate field}
401    error = \hyperlink{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}{x509ParseSerialNumber}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
402       &revokedCertificate->\hyperlink{structX509RevokedCertificate_a7adb683965165dfb94b8569e67ffa138}{userCert});
403    \textcolor{comment}{//Any error to report?}
404    \textcolor{keywordflow}{if}(error)
405       \textcolor{keywordflow}{return} error;
406 
407    \textcolor{comment}{//Point to the next field}
408    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
409    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
410 
411    \textcolor{comment}{//Parse RevocationDate field}
412    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
413       &revokedCertificate->\hyperlink{structX509RevokedCertificate_aaf3268ad43d85578b8c888c85d5a9bc1}{revocationDate});
414    \textcolor{comment}{//Any error to report?}
415    \textcolor{keywordflow}{if}(error)
416       \textcolor{keywordflow}{return} error;
417 
418    \textcolor{comment}{//Point to the next field}
419    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
420    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
421 
422    \textcolor{comment}{//Parse CrlEntryExtensions field}
423    error = \hyperlink{x509__crl__parse_8c_a3841b64c5b193d86bbc246576cd04557}{x509ParseCrlEntryExtensions}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
424       &revokedCertificate->\hyperlink{structX509RevokedCertificate_ab4cb7aadd371dd2f55d6d89970f0210e}{crlEntryExtensions});
425    \textcolor{comment}{//Any parsing error?}
426    \textcolor{keywordflow}{if}(error)
427       \textcolor{keywordflow}{return} error;
428 
429    \textcolor{comment}{//Successful processing}
430    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
431 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a6987ccf9854c9995c04fafd2bff49420}\label{x509__crl__parse_8c_a6987ccf9854c9995c04fafd2bff49420}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Revoked\+Certificates@{x509\+Parse\+Revoked\+Certificates}}
\index{x509\+Parse\+Revoked\+Certificates@{x509\+Parse\+Revoked\+Certificates}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Revoked\+Certificates()}{x509ParseRevokedCertificates()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Revoked\+Certificates (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509TbsCertList}{X509\+Tbs\+Cert\+List} $\ast$}]{tbs\+Cert\+List }\end{DoxyParamCaption})}



Parse Revoked\+Certificates field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em tbs\+Cert\+List} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 306 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
308 \{
309    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
310    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
311    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
312    \hyperlink{structX509RevokedCertificate}{X509RevokedCertificate} revokedCertificate;
313 
314    \textcolor{comment}{//Debug message}
315    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing RevokedCertificates...\(\backslash\)r\(\backslash\)n"});
316 
317    \textcolor{comment}{//The RevokedCertificates is optional}
318    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
319    \textcolor{comment}{//Failed to decode ASN.1 tag?}
320    \textcolor{keywordflow}{if}(error)
321       \textcolor{keywordflow}{return} error;
322 
323    \textcolor{comment}{//Check encoding, class and type}
324    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea}{ASN1\_TYPE\_SEQUENCE});
325 
326    \textcolor{comment}{//The tag does not match the criteria?}
327    \textcolor{keywordflow}{if}(error)
328    \{
329       \textcolor{comment}{//Skip the current field}
330       *totalLength = 0;
331       \textcolor{comment}{//Exit immediately}
332       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
333    \}
334 
335    \textcolor{comment}{//Save the total length of the field}
336    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
337 
338    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
339    tbsCertList->\hyperlink{structX509TbsCertList_a196e7acd7a1e03020bdb9d798dc527fb}{revokedCerts} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
340    tbsCertList->\hyperlink{structX509TbsCertList_a074f15ba5a4ccc717f658730392f5de8}{revokedCertsLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
341 
342    \textcolor{comment}{//Point to the first item of the sequence}
343    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
344    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
345 
346    \textcolor{comment}{//Loop through the list of revoked certificates}
347    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
348    \{
349       \textcolor{comment}{//Parse current item}
350       error = \hyperlink{x509__crl__parse_8c_aac3f846bba37fe0707d6e5286739fa2e}{x509ParseRevokedCertificate}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &revokedCertificate);
351       \textcolor{comment}{//Any error to report?}
352       \textcolor{keywordflow}{if}(error)
353          \textcolor{keywordflow}{return} error;
354 
355       \textcolor{comment}{//Next item}
356       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
357       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
358    \}
359 
360    \textcolor{comment}{//Successful processing}
361    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
362 \}
\end{DoxyCode}
\mbox{\Hypertarget{x509__crl__parse_8c_a4e083dbf0acb9e0618c963f28d5b73ef}\label{x509__crl__parse_8c_a4e083dbf0acb9e0618c963f28d5b73ef}} 
\index{x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}!x509\+Parse\+Tbs\+Cert\+List@{x509\+Parse\+Tbs\+Cert\+List}}
\index{x509\+Parse\+Tbs\+Cert\+List@{x509\+Parse\+Tbs\+Cert\+List}!x509\+\_\+crl\+\_\+parse.\+c@{x509\+\_\+crl\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Tbs\+Cert\+List()}{x509ParseTbsCertList()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Tbs\+Cert\+List (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509TbsCertList}{X509\+Tbs\+Cert\+List} $\ast$}]{tbs\+Cert\+List }\end{DoxyParamCaption})}



Parse T\+B\+S\+Cert\+List structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em tbs\+Cert\+List} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 133 of file x509\+\_\+crl\+\_\+parse.\+c.


\begin{DoxyCode}
135 \{
136    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
137    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
138    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
139 
140    \textcolor{comment}{//Debug message}
141    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing TBSCertList...\(\backslash\)r\(\backslash\)n"});
142 
143    \textcolor{comment}{//Read the contents of the TBSCertList structure}
144    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
145    \textcolor{comment}{//Failed to decode ASN.1 tag?}
146    \textcolor{keywordflow}{if}(error)
147       \textcolor{keywordflow}{return} error;
148 
149    \textcolor{comment}{//Save the total length of the field}
150    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
151 
152    \textcolor{comment}{//The ASN.1 DER-encoded TBSCertList is used as the input to the}
153    \textcolor{comment}{//signature function}
154    tbsCertList->\hyperlink{structX509TbsCertList_a8d919d7ecf86468c7fff027d4c981041}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
155    tbsCertList->\hyperlink{structX509TbsCertList_aec6e5364f510fc217462bf130c861a3f}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
156 
157    \textcolor{comment}{//Point to the very first field of the TBSCertList}
158    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
159    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
160 
161    \textcolor{comment}{//Parse Version field}
162    error = \hyperlink{x509__crl__parse_8c_a2cceef6a39e5792d53c26b0b11ca26cf}{x509ParseCrlVersion}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCertList->
      \hyperlink{structX509TbsCertList_aec546d0e6c62aee6789d27f84f5b2174}{version});
163    \textcolor{comment}{//Any parsing error?}
164    \textcolor{keywordflow}{if}(error)
165       \textcolor{keywordflow}{return} error;
166 
167    \textcolor{comment}{//Point to the next field}
168    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
169    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
170 
171    \textcolor{comment}{//Parse Signature field}
172    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
173       &tbsCertList->\hyperlink{structX509TbsCertList_a9ddc6a9135a428e613a32a70efdd7d90}{signatureAlgo});
174    \textcolor{comment}{//Any parsing error?}
175    \textcolor{keywordflow}{if}(error)
176       \textcolor{keywordflow}{return} error;
177 
178    \textcolor{comment}{//Point to the next field}
179    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
180    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
181 
182    \textcolor{comment}{//Parse Issuer field}
183    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCertList->
      \hyperlink{structX509TbsCertList_adbb517b77f6ccf54375d3453ca3966c1}{issuer});
184    \textcolor{comment}{//Any parsing error?}
185    \textcolor{keywordflow}{if}(error)
186       \textcolor{keywordflow}{return} error;
187 
188    \textcolor{comment}{//Point to the next field}
189    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
190    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
191 
192    \textcolor{comment}{//Parse ThisUpdate field}
193    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCertList->
      \hyperlink{structX509TbsCertList_aa762248fe58816b5353994f18d906b11}{thisUpdate});
194    \textcolor{comment}{//Any parsing error?}
195    \textcolor{keywordflow}{if}(error)
196       \textcolor{keywordflow}{return} error;
197 
198    \textcolor{comment}{//Point to the next field}
199    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
200    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
201 
202    \textcolor{comment}{//Parse NextUpdate field}
203    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCertList->
      \hyperlink{structX509TbsCertList_aa3573e4d72e2170ad201f25be63c0276}{nextUpdate});
204    \textcolor{comment}{//Any parsing error?}
205    \textcolor{keywordflow}{if}(error)
206       \textcolor{keywordflow}{return} error;
207 
208    \textcolor{comment}{//Point to the next field}
209    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
210    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
211 
212    \textcolor{comment}{//Parse RevokedCertificates field}
213    error = \hyperlink{x509__crl__parse_8c_a6987ccf9854c9995c04fafd2bff49420}{x509ParseRevokedCertificates}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, tbsCertList);
214    \textcolor{comment}{//Any parsing error?}
215    \textcolor{keywordflow}{if}(error)
216       \textcolor{keywordflow}{return} error;
217 
218    \textcolor{comment}{//Point to the next field}
219    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
220    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
221 
222    \textcolor{comment}{//Parse CrlExtensions field}
223    error = \hyperlink{x509__crl__parse_8c_a09557e6879e43cc9fbce1332155702c9}{x509ParseCrlExtensions}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCertList->
      \hyperlink{structX509TbsCertList_a084e1f8c74fb44d6a347df943a0dc728}{crlExtensions});
224    \textcolor{comment}{//Any parsing error?}
225    \textcolor{keywordflow}{if}(error)
226       \textcolor{keywordflow}{return} error;
227 
228    \textcolor{comment}{//The CrlExtensions field is optional}
229    \textcolor{keywordflow}{if}(n > 0)
230    \{
231       \textcolor{comment}{//This field must only appear if the version is 2}
232       \textcolor{keywordflow}{if}(tbsCertList->\hyperlink{structX509TbsCertList_aec546d0e6c62aee6789d27f84f5b2174}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
233          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
234    \}
235 
236    \textcolor{comment}{//No error to report}
237    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
238 \}
\end{DoxyCode}
