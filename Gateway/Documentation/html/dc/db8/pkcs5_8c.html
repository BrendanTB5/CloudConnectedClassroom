<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Senior Design Gateway: cyclone_crypto/kdf/pkcs5.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Senior Design Gateway
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A HTTP To MQTT Converted for AWS IoT Core.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/db8/pkcs5_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pkcs5.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>PKCS #5 (Password-Based Cryptography Standard)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html">core/crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/df2/pkcs5_8h_source.html">kdf/pkcs5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/dc6/hmac_8h_source.html">mac/hmac.h</a>&quot;</code><br />
</div>
<p><a href="../../dc/db8/pkcs5_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afcdf5e66fd927a7f4cc64295acd20407"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/pkcs5_8c.html#afcdf5e66fd927a7f4cc64295acd20407">TRACE_LEVEL</a>&#160;&#160;&#160;<a class="el" href="../../d7/d2f/crypto__config_8h.html#a6afae3a9b63f9b55d979e667ee0e881d">CRYPTO_TRACE_LEVEL</a></td></tr>
<tr class="separator:afcdf5e66fd927a7f4cc64295acd20407"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3327b0b0aa8771dcaf799035a77c9014"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/pkcs5_8c.html#a3327b0b0aa8771dcaf799035a77c9014">pbkdf1</a> (const <a class="el" href="../../d4/ddf/structHashAlgo.html">HashAlgo</a> *<a class="el" href="../../df/d79/tls_8h.html#a17d89840e7296c323504b31fc6359606">hash</a>, const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a>, size_t pLen, const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="../../d3/d8d/ndp_8h.html#a2dee666f0c1fe072c549ff86b1d0a8ab">s</a>, size_t sLen, <a class="el" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> <a class="el" href="../../de/df4/llmnr__common_8h.html#a2e5a04327b5658199f0f7bda2acceee1">c</a>, <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *dk, size_t dkLen)</td></tr>
<tr class="memdesc:a3327b0b0aa8771dcaf799035a77c9014"><td class="mdescLeft">&#160;</td><td class="mdescRight">PBKDF1 key derivation function.  <a href="#a3327b0b0aa8771dcaf799035a77c9014">More...</a><br /></td></tr>
<tr class="separator:a3327b0b0aa8771dcaf799035a77c9014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d96e01765a8a1815fb7f3ad7f8d8f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/pkcs5_8c.html#a30d96e01765a8a1815fb7f3ad7f8d8f9">pbkdf2</a> (const <a class="el" href="../../d4/ddf/structHashAlgo.html">HashAlgo</a> *<a class="el" href="../../df/d79/tls_8h.html#a17d89840e7296c323504b31fc6359606">hash</a>, const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a>, size_t pLen, const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="el" href="../../d3/d8d/ndp_8h.html#a2dee666f0c1fe072c549ff86b1d0a8ab">s</a>, size_t sLen, <a class="el" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> <a class="el" href="../../de/df4/llmnr__common_8h.html#a2e5a04327b5658199f0f7bda2acceee1">c</a>, <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *dk, size_t dkLen)</td></tr>
<tr class="memdesc:a30d96e01765a8a1815fb7f3ad7f8d8f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">PBKDF2 key derivation function.  <a href="#a30d96e01765a8a1815fb7f3ad7f8d8f9">More...</a><br /></td></tr>
<tr class="separator:a30d96e01765a8a1815fb7f3ad7f8d8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5cb9816f71280dbbb305fa509f6a4200"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/pkcs5_8c.html#a5cb9816f71280dbbb305fa509f6a4200">PKCS5_OID</a> [8] = {0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x05}</td></tr>
<tr class="separator:a5cb9816f71280dbbb305fa509f6a4200"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af185dcc905d5699c4907ed56d4764b53"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/pkcs5_8c.html#af185dcc905d5699c4907ed56d4764b53">PBKDF2_OID</a> [9] = {0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x05, 0x0C}</td></tr>
<tr class="separator:af185dcc905d5699c4907ed56d4764b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>PKCS #5 (Password-Based Cryptography Standard) </p>
<h1><a class="anchor" id="License"></a>
License</h1>
<p>SPDX-License-Identifier: GPL-2.0-or-later</p>
<p>Copyright (C) 2010-2019 Oryx Embedded SARL. All rights reserved.</p>
<p>This file is part of CycloneCrypto Open.</p>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</p>
<dl class="section author"><dt>Author</dt><dd>Oryx Embedded SARL (www.oryx-embedded.com) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.9.6 </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../dc/db8/pkcs5_8c_source.html">pkcs5.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afcdf5e66fd927a7f4cc64295acd20407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcdf5e66fd927a7f4cc64295acd20407">&#9670;&nbsp;</a></span>TRACE_LEVEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRACE_LEVEL&#160;&#160;&#160;<a class="el" href="../../d7/d2f/crypto__config_8h.html#a6afae3a9b63f9b55d979e667ee0e881d">CRYPTO_TRACE_LEVEL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db8/pkcs5_8c_source.html#l00032">32</a> of file <a class="el" href="../../dc/db8/pkcs5_8c_source.html">pkcs5.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3327b0b0aa8771dcaf799035a77c9014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3327b0b0aa8771dcaf799035a77c9014">&#9670;&nbsp;</a></span>pbkdf1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> pbkdf1 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/ddf/structHashAlgo.html">HashAlgo</a> *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a>&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>dk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dkLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PBKDF1 key derivation function. </p>
<p>PBKDF1 applies a hash function, which shall be MD2, MD5 or SHA-1, to derive keys. The length of the derived key is bounded by the length of the hash function output, which is 16 octets for MD2 and MD5 and 20 octets for SHA-1</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hash</td><td>Underlying hash function (MD2, MD5 or SHA-1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Password, an octet string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pLen</td><td>Length in octets of password </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Salt, an octet string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sLen</td><td>Length in octets of salt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Iteration count </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dk</td><td>Derived key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dkLen</td><td>Intended length in octets of the derived key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/db8/pkcs5_8c_source.html#l00066">66</a> of file <a class="el" href="../../dc/db8/pkcs5_8c_source.html">pkcs5.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> i;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <a class="code" href="../../d5/dcc/structHashContext.html">HashContext</a> *hashContext;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../de/df4/llmnr__common_8h.html#a2d03918f4f9edabaf3c9f43abcc2d85b">t</a>[<a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac6e85336237dcdf8efb9280b84e4ffd6">MAX_HASH_DIGEST_SIZE</a>];</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="comment">//Check parameters</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="keywordflow">if</span>(hash == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a> == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../dc/dd8/md2_8c.html#adf356ff381033f761b7de5f76e763a45">s</a> == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || dk == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="comment">//The iteration count must be a positive integer</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../d6/d8e/aria_8c.html#a5dadc28804036d1b82e1dc027e95c9a6">c</a> &lt; 1)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="comment">//Check the intended length of the derived key</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordflow">if</span>(dkLen &gt; hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">digestSize</a>)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28">ERROR_INVALID_LENGTH</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="comment">//Allocate a memory buffer to hold the hash context</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   hashContext = <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a48b53d16f66d31e5dcf82db3c1b882ba">cryptoAllocMem</a>(hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#ad087845190aa4163d8339cacd07fec3e">contextSize</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="comment">//Failed to allocate memory?</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keywordflow">if</span>(hashContext == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69">ERROR_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="comment">//Apply the hash function to the concatenation of P and S</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a77dcebcb5fd49cd6672ad6c97b55fdee">init</a>(hashContext);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a83df6297595f1b9de65143df15fafda4">update</a>(hashContext, <a class="code" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a>, pLen);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a83df6297595f1b9de65143df15fafda4">update</a>(hashContext, <a class="code" href="../../dc/dd8/md2_8c.html#adf356ff381033f761b7de5f76e763a45">s</a>, sLen);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a8a1972d608540bbf31e1932f5403f51d">final</a>(hashContext, t);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="comment">//Iterate as many times as required</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="keywordflow">for</span>(i = 1; i &lt; <a class="code" href="../../d6/d8e/aria_8c.html#a5dadc28804036d1b82e1dc027e95c9a6">c</a>; i++)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="comment">//Apply the hash function to T(i - 1)</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a77dcebcb5fd49cd6672ad6c97b55fdee">init</a>(hashContext);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a83df6297595f1b9de65143df15fafda4">update</a>(hashContext, t, hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">digestSize</a>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a8a1972d608540bbf31e1932f5403f51d">final</a>(hashContext, t);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="comment">//Output the derived key DK</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a6724616c4014bb7e21f2660bd7b88be8">cryptoMemcpy</a>(dk, t, dkLen);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="comment">//Free previously allocated memory</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac8a223b176683db4e9eed4162774f870">cryptoFreeMem</a>(hashContext);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="comment">//Successful processing</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div><div class="ttc" id="structHashAlgo_html_a8a1972d608540bbf31e1932f5403f51d"><div class="ttname"><a href="../../d4/ddf/structHashAlgo.html#a8a1972d608540bbf31e1932f5403f51d">HashAlgo::final</a></div><div class="ttdeci">HashAlgoFinal final</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01141">crypto.h:1141</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_ac6e85336237dcdf8efb9280b84e4ffd6"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac6e85336237dcdf8efb9280b84e4ffd6">MAX_HASH_DIGEST_SIZE</a></div><div class="ttdeci">#define MAX_HASH_DIGEST_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00811">crypto.h:811</a></div></div>
<div class="ttc" id="md2_8c_html_adf356ff381033f761b7de5f76e763a45"><div class="ttname"><a href="../../dc/dd8/md2_8c.html#adf356ff381033f761b7de5f76e763a45">s</a></div><div class="ttdeci">static const uint8_t s[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd8/md2_8c_source.html#l00047">md2.c:47</a></div></div>
<div class="ttc" id="ndp_8h_html_a6519522ad9a6f45e7a8d25d31392a977"><div class="ttname"><a href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a></div><div class="ttdeci">uint8_t p</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8d/ndp_8h_source.html#l00298">ndp.h:298</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_ac8a223b176683db4e9eed4162774f870"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac8a223b176683db4e9eed4162774f870">cryptoFreeMem</a></div><div class="ttdeci">#define cryptoFreeMem(p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00630">crypto.h:630</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a></div><div class="ttdoc">Invalid parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00047">error.h:47</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_a6724616c4014bb7e21f2660bd7b88be8"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a6724616c4014bb7e21f2660bd7b88be8">cryptoMemcpy</a></div><div class="ttdeci">#define cryptoMemcpy(dest, src, length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00642">crypto.h:642</a></div></div>
<div class="ttc" id="llmnr__common_8h_html_a2d03918f4f9edabaf3c9f43abcc2d85b"><div class="ttname"><a href="../../de/df4/llmnr__common_8h.html#a2d03918f4f9edabaf3c9f43abcc2d85b">t</a></div><div class="ttdeci">uint8_t t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df4/llmnr__common_8h_source.html#l00081">llmnr_common.h:81</a></div></div>
<div class="ttc" id="group__BSPDefine_html_ga070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6b/nm__bsp_8h_source.html#l00070">nm_bsp.h:70</a></div></div>
<div class="ttc" id="stdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/stdint_8h_source.html#l00078">stdint.h:78</a></div></div>
<div class="ttc" id="structHashAlgo_html_a83df6297595f1b9de65143df15fafda4"><div class="ttname"><a href="../../d4/ddf/structHashAlgo.html#a83df6297595f1b9de65143df15fafda4">HashAlgo::update</a></div><div class="ttdeci">HashAlgoUpdate update</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01140">crypto.h:1140</a></div></div>
<div class="ttc" id="structHashAlgo_html_a0c8ccdb22ea395ccdd8decd06401d22e"><div class="ttname"><a href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">HashAlgo::digestSize</a></div><div class="ttdeci">size_t digestSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01135">crypto.h:1135</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a></div><div class="ttdoc">Success. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00044">error.h:44</a></div></div>
<div class="ttc" id="compiler__port_8h_html_a12a1e9b3ce141648783a82445d02b58d"><div class="ttname"><a href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a></div><div class="ttdeci">unsigned int uint_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfa/compiler__port_8h_source.html#l00045">compiler_port.h:45</a></div></div>
<div class="ttc" id="structHashAlgo_html_a77dcebcb5fd49cd6672ad6c97b55fdee"><div class="ttname"><a href="../../d4/ddf/structHashAlgo.html#a77dcebcb5fd49cd6672ad6c97b55fdee">HashAlgo::init</a></div><div class="ttdeci">HashAlgoInit init</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01139">crypto.h:1139</a></div></div>
<div class="ttc" id="structHashAlgo_html_ad087845190aa4163d8339cacd07fec3e"><div class="ttname"><a href="../../d4/ddf/structHashAlgo.html#ad087845190aa4163d8339cacd07fec3e">HashAlgo::contextSize</a></div><div class="ttdeci">size_t contextSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01133">crypto.h:1133</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28">ERROR_INVALID_LENGTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00109">error.h:109</a></div></div>
<div class="ttc" id="structHashContext_html"><div class="ttname"><a href="../../d5/dcc/structHashContext.html">HashContext</a></div><div class="ttdoc">Generic hash algorithm context. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01118">crypto.h:1118</a></div></div>
<div class="ttc" id="aria_8c_html_a5dadc28804036d1b82e1dc027e95c9a6"><div class="ttname"><a href="../../d6/d8e/aria_8c.html#a5dadc28804036d1b82e1dc027e95c9a6">c</a></div><div class="ttdeci">static const uint32_t c[12]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/aria_8c_source.html#l00229">aria.c:229</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69">ERROR_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00063">error.h:63</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_a48b53d16f66d31e5dcf82db3c1b882ba"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a48b53d16f66d31e5dcf82db3c1b882ba">cryptoAllocMem</a></div><div class="ttdeci">#define cryptoAllocMem(size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00625">crypto.h:625</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30d96e01765a8a1815fb7f3ad7f8d8f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30d96e01765a8a1815fb7f3ad7f8d8f9">&#9670;&nbsp;</a></span>pbkdf2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> pbkdf2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/ddf/structHashAlgo.html">HashAlgo</a> *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a>&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>dk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dkLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PBKDF2 key derivation function. </p>
<p>PBKDF2 applies a pseudorandom function to derive keys. The length of the derived key is essentially unbounded</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hash</td><td>Hash algorithm used by the underlying PRF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Password, an octet string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pLen</td><td>Length in octets of password </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Salt, an octet string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sLen</td><td>Length in octets of salt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Iteration count </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dk</td><td>Derived key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dkLen</td><td>Intended length in octets of the derived key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/db8/pkcs5_8c_source.html#l00134">134</a> of file <a class="el" href="../../dc/db8/pkcs5_8c_source.html">pkcs5.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> i;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> j;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> <a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <a class="code" href="../../df/d74/structHmacContext.html">HmacContext</a> *hashContext;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../d3/d8d/ndp_8h.html#af4007aacd75b22aee32dba9ea96082c0">a</a>[4];</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../de/df4/llmnr__common_8h.html#a2d03918f4f9edabaf3c9f43abcc2d85b">t</a>[<a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac6e85336237dcdf8efb9280b84e4ffd6">MAX_HASH_DIGEST_SIZE</a>];</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> u[<a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac6e85336237dcdf8efb9280b84e4ffd6">MAX_HASH_DIGEST_SIZE</a>];</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="comment">//Check parameters</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="keywordflow">if</span>(hash == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a> == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../dc/dd8/md2_8c.html#adf356ff381033f761b7de5f76e763a45">s</a> == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || dk == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="comment">//The iteration count must be a positive integer</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../d6/d8e/aria_8c.html#a5dadc28804036d1b82e1dc027e95c9a6">c</a> &lt; 1)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="comment">//Allocate a memory buffer to hold the HMAC context</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   hashContext = <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a48b53d16f66d31e5dcf82db3c1b882ba">cryptoAllocMem</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../df/d74/structHmacContext.html">HmacContext</a>));</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">//Failed to allocate memory?</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordflow">if</span>(hashContext == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69">ERROR_OUT_OF_MEMORY</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="comment">//For each block of the derived key apply the function F</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordflow">for</span>(i = 1; dkLen &gt; 0; i++)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="comment">//Calculate the 4-octet encoding of the integer i (MSB first)</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="../../df/de9/cpu__endian_8h.html#a8663906e08e818efa91dd6f65a7e636d">STORE32BE</a>(i, a);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">//Compute U1 = PRF(P, S || INT(i))</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="../../d4/d13/hmac_8c.html#ac4ecc520cae02c1b9bbb3651758a703e">hmacInit</a>(hashContext, hash, <a class="code" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a>, pLen);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="../../d4/d13/hmac_8c.html#a4c34324b10bcf1b4372f272369773501">hmacUpdate</a>(hashContext, <a class="code" href="../../dc/dd8/md2_8c.html#adf356ff381033f761b7de5f76e763a45">s</a>, sLen);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="../../d4/d13/hmac_8c.html#a4c34324b10bcf1b4372f272369773501">hmacUpdate</a>(hashContext, a, 4);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="../../d4/d13/hmac_8c.html#a387906ffc55755df380361c43ce0bd6a">hmacFinal</a>(hashContext, u);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">//Save the resulting HMAC value</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a6724616c4014bb7e21f2660bd7b88be8">cryptoMemcpy</a>(t, u, hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">digestSize</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">//Iterate as many times as required</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">for</span>(j = 1; j &lt; <a class="code" href="../../d6/d8e/aria_8c.html#a5dadc28804036d1b82e1dc027e95c9a6">c</a>; j++)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         <span class="comment">//Compute U(j) = PRF(P, U(j-1))</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;         <a class="code" href="../../d4/d13/hmac_8c.html#ac4ecc520cae02c1b9bbb3651758a703e">hmacInit</a>(hashContext, hash, <a class="code" href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a>, pLen);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         <a class="code" href="../../d4/d13/hmac_8c.html#a4c34324b10bcf1b4372f272369773501">hmacUpdate</a>(hashContext, u, hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">digestSize</a>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         <a class="code" href="../../d4/d13/hmac_8c.html#a387906ffc55755df380361c43ce0bd6a">hmacFinal</a>(hashContext, u);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;         <span class="comment">//Compute T = U(1) xor U(2) xor ... xor U(c)</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         <span class="keywordflow">for</span>(k = 0; k &lt; hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">digestSize</a>; k++)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;         {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            t[<a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>] ^= u[<a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>];</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;         }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">//Number of octets in the current block</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      k = <a class="code" href="../../da/d42/os__port_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(dkLen, hash-&gt;<a class="code" href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">digestSize</a>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">//Save the resulting block</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a6724616c4014bb7e21f2660bd7b88be8">cryptoMemcpy</a>(dk, t, k);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">//Point to the next block</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      dk += <a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      dkLen -= <a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="comment">//Free previously allocated memory</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac8a223b176683db4e9eed4162774f870">cryptoFreeMem</a>(hashContext);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="comment">//Successful processing</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_ac6e85336237dcdf8efb9280b84e4ffd6"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac6e85336237dcdf8efb9280b84e4ffd6">MAX_HASH_DIGEST_SIZE</a></div><div class="ttdeci">#define MAX_HASH_DIGEST_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00811">crypto.h:811</a></div></div>
<div class="ttc" id="md2_8c_html_adf356ff381033f761b7de5f76e763a45"><div class="ttname"><a href="../../dc/dd8/md2_8c.html#adf356ff381033f761b7de5f76e763a45">s</a></div><div class="ttdeci">static const uint8_t s[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd8/md2_8c_source.html#l00047">md2.c:47</a></div></div>
<div class="ttc" id="ndp_8h_html_a6519522ad9a6f45e7a8d25d31392a977"><div class="ttname"><a href="../../d3/d8d/ndp_8h.html#a6519522ad9a6f45e7a8d25d31392a977">p</a></div><div class="ttdeci">uint8_t p</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8d/ndp_8h_source.html#l00298">ndp.h:298</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_ac8a223b176683db4e9eed4162774f870"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#ac8a223b176683db4e9eed4162774f870">cryptoFreeMem</a></div><div class="ttdeci">#define cryptoFreeMem(p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00630">crypto.h:630</a></div></div>
<div class="ttc" id="hmac_8c_html_a387906ffc55755df380361c43ce0bd6a"><div class="ttname"><a href="../../d4/d13/hmac_8c.html#a387906ffc55755df380361c43ce0bd6a">hmacFinal</a></div><div class="ttdeci">void hmacFinal(HmacContext *context, uint8_t *digest)</div><div class="ttdoc">Finish the HMAC calculation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d13/hmac_8c_source.html#l00185">hmac.c:185</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a></div><div class="ttdoc">Invalid parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00047">error.h:47</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_a6724616c4014bb7e21f2660bd7b88be8"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a6724616c4014bb7e21f2660bd7b88be8">cryptoMemcpy</a></div><div class="ttdeci">#define cryptoMemcpy(dest, src, length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00642">crypto.h:642</a></div></div>
<div class="ttc" id="llmnr__common_8h_html_a2d03918f4f9edabaf3c9f43abcc2d85b"><div class="ttname"><a href="../../de/df4/llmnr__common_8h.html#a2d03918f4f9edabaf3c9f43abcc2d85b">t</a></div><div class="ttdeci">uint8_t t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df4/llmnr__common_8h_source.html#l00081">llmnr_common.h:81</a></div></div>
<div class="ttc" id="group__BSPDefine_html_ga070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6b/nm__bsp_8h_source.html#l00070">nm_bsp.h:70</a></div></div>
<div class="ttc" id="stdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/stdint_8h_source.html#l00078">stdint.h:78</a></div></div>
<div class="ttc" id="ndp_8h_html_af4007aacd75b22aee32dba9ea96082c0"><div class="ttname"><a href="../../d3/d8d/ndp_8h.html#af4007aacd75b22aee32dba9ea96082c0">a</a></div><div class="ttdeci">uint8_t a</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8d/ndp_8h_source.html#l00410">ndp.h:410</a></div></div>
<div class="ttc" id="cpu__endian_8h_html_a8663906e08e818efa91dd6f65a7e636d"><div class="ttname"><a href="../../df/de9/cpu__endian_8h.html#a8663906e08e818efa91dd6f65a7e636d">STORE32BE</a></div><div class="ttdeci">#define STORE32BE(a, p)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/de9/cpu__endian_8h_source.html#l00270">cpu_endian.h:270</a></div></div>
<div class="ttc" id="os__port_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="../../da/d42/os__port_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d42/os__port_8h_source.html#l00062">os_port.h:62</a></div></div>
<div class="ttc" id="structHashAlgo_html_a0c8ccdb22ea395ccdd8decd06401d22e"><div class="ttname"><a href="../../d4/ddf/structHashAlgo.html#a0c8ccdb22ea395ccdd8decd06401d22e">HashAlgo::digestSize</a></div><div class="ttdeci">size_t digestSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01135">crypto.h:1135</a></div></div>
<div class="ttc" id="md5_8c_html_af11ea3cdbca7345eb6a4a8ac5ce0434d"><div class="ttname"><a href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a></div><div class="ttdeci">static const uint32_t k[64]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6c/md5_8c_source.html#l00067">md5.c:67</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a></div><div class="ttdoc">Success. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00044">error.h:44</a></div></div>
<div class="ttc" id="structHmacContext_html"><div class="ttname"><a href="../../df/d74/structHmacContext.html">HmacContext</a></div><div class="ttdoc">HMAC algorithm context. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc6/hmac_8h_source.html#l00182">hmac.h:182</a></div></div>
<div class="ttc" id="compiler__port_8h_html_a12a1e9b3ce141648783a82445d02b58d"><div class="ttname"><a href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a></div><div class="ttdeci">unsigned int uint_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfa/compiler__port_8h_source.html#l00045">compiler_port.h:45</a></div></div>
<div class="ttc" id="hmac_8c_html_ac4ecc520cae02c1b9bbb3651758a703e"><div class="ttname"><a href="../../d4/d13/hmac_8c.html#ac4ecc520cae02c1b9bbb3651758a703e">hmacInit</a></div><div class="ttdeci">void hmacInit(HmacContext *context, const HashAlgo *hash, const void *key, size_t keyLen)</div><div class="ttdoc">Initialize HMAC calculation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d13/hmac_8c_source.html#l00118">hmac.c:118</a></div></div>
<div class="ttc" id="hmac_8c_html_a4c34324b10bcf1b4372f272369773501"><div class="ttname"><a href="../../d4/d13/hmac_8c.html#a4c34324b10bcf1b4372f272369773501">hmacUpdate</a></div><div class="ttdeci">void hmacUpdate(HmacContext *context, const void *data, size_t length)</div><div class="ttdoc">Update the HMAC context with a portion of the message being hashed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d13/hmac_8c_source.html#l00168">hmac.c:168</a></div></div>
<div class="ttc" id="aria_8c_html_a5dadc28804036d1b82e1dc027e95c9a6"><div class="ttname"><a href="../../d6/d8e/aria_8c.html#a5dadc28804036d1b82e1dc027e95c9a6">c</a></div><div class="ttdeci">static const uint32_t c[12]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d8e/aria_8c_source.html#l00229">aria.c:229</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69">ERROR_OUT_OF_MEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00063">error.h:63</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html_a48b53d16f66d31e5dcf82db3c1b882ba"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html#a48b53d16f66d31e5dcf82db3c1b882ba">cryptoAllocMem</a></div><div class="ttdeci">#define cryptoAllocMem(size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l00625">crypto.h:625</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af185dcc905d5699c4907ed56d4764b53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af185dcc905d5699c4907ed56d4764b53">&#9670;&nbsp;</a></span>PBKDF2_OID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> PBKDF2_OID[9] = {0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x05, 0x0C}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db8/pkcs5_8c_source.html#l00045">45</a> of file <a class="el" href="../../dc/db8/pkcs5_8c_source.html">pkcs5.c</a>.</p>

</div>
</div>
<a id="a5cb9816f71280dbbb305fa509f6a4200"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cb9816f71280dbbb305fa509f6a4200">&#9670;&nbsp;</a></span>PKCS5_OID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> PKCS5_OID[8] = {0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x05}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db8/pkcs5_8c_source.html#l00043">43</a> of file <a class="el" href="../../dc/db8/pkcs5_8c_source.html">pkcs5.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_1702080616e5f4ed1265447cf141dd85.html">cyclone_crypto</a></li><li class="navelem"><a class="el" href="../../dir_781aa2493f27fefaa0387c07f55fc0a1.html">kdf</a></li><li class="navelem"><a class="el" href="../../dc/db8/pkcs5_8c.html">pkcs5.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
