\hypertarget{ipv6__misc_8c}{}\section{cyclone\+\_\+tcp/ipv6/ipv6\+\_\+misc.c File Reference}
\label{ipv6__misc_8c}\index{cyclone\+\_\+tcp/ipv6/ipv6\+\_\+misc.\+c@{cyclone\+\_\+tcp/ipv6/ipv6\+\_\+misc.\+c}}


Helper functions for I\+Pv6.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ipv6/ipv6.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ipv6/ipv6\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ipv6/ndp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ipv6/ndp\+\_\+cache.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mdns/mdns\+\_\+responder.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/ip\+\_\+mib\+\_\+module.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ipv6__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_abdf5ff5f080602055c37443bec1fe78c}{I\+P\+V6\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518d}{Ipv6\+Addr\+State} \hyperlink{ipv6__misc_8c_ac635994871aa4238959d1c9488c5c486}{ipv6\+Get\+Addr\+State} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr})
\begin{DoxyCompactList}\small\item\em Get the state of the specified I\+Pv6 address. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}{ipv6\+Set\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} index, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518d}{Ipv6\+Addr\+State} state, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} \hyperlink{ndp_8h_a5a204ed3be422255e9aa086573667e11}{valid\+Lifetime}, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} \hyperlink{ndp_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferred\+Lifetime}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} permanent)
\begin{DoxyCompactList}\small\item\em Set I\+Pv6 address and address state. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a09293900ef392400821733fd3ef1a66b}{ipv6\+Add\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ndp_8h_a5a204ed3be422255e9aa086573667e11}{valid\+Lifetime}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ndp_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferred\+Lifetime})
\begin{DoxyCompactList}\small\item\em Add a new entry to the list of I\+Pv6 addresses. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_aa72b374b0dba9090d90f799776797452}{ipv6\+Remove\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr})
\begin{DoxyCompactList}\small\item\em Remove an entry from the list of I\+Pv6 addresses. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a884d417b4bfee285e631132b9d8dffb9}{ipv6\+Add\+Prefix} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{mqtt__sn__common_8h_acf4a7a7457f3d922d7118075fc1a300b}{prefix}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} on\+Link\+Flag, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} autonomous\+Flag, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ndp_8h_a5a204ed3be422255e9aa086573667e11}{valid\+Lifetime}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ndp_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferred\+Lifetime})
\begin{DoxyCompactList}\small\item\em Add a new entry to the Prefix List. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_abfcbbca4428fa3b858e1e4e8f5bb8b1c}{ipv6\+Remove\+Prefix} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{mqtt__sn__common_8h_acf4a7a7457f3d922d7118075fc1a300b}{prefix}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Remove an entry from the Prefix List. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a527a66aa974432cc0f42726426408c49}{ipv6\+Add\+Default\+Router} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{ndp_8h_a569e06e92ec3d06c5ebf7f40d7f9a84e}{lifetime}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} preference)
\begin{DoxyCompactList}\small\item\em Add a new entry to the Default Router List. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_ad2b66051e8b53dffa4aba62f2241e2d1}{ipv6\+Remove\+Default\+Router} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr})
\begin{DoxyCompactList}\small\item\em Remove an entry from the Default Router List. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_afb37c6c9de9b5604c5da82ed368456a8}{ipv6\+Flush\+Addr\+List} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Flush the list of I\+Pv6 addresses. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a054753911977d85a35deee34c2c2c46c}{ipv6\+Flush\+Prefix\+List} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Flush the Prefix List. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a0e00adcd144c72507340a06a6d70ffcc}{ipv6\+Flush\+Default\+Router\+List} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Flush the Default Router List. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a4b3ce94edd9cad3fb3269e805a104b97}{ipv6\+Flush\+Dns\+Server\+List} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Flush the list of D\+NS servers. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv6__misc_8c_aa3642cbe1517b756af1861400e4b19c0}{ipv6\+Check\+Source\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Source I\+Pv6 address filtering. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv6__misc_8c_acf063c0c23ac317d11b9973f3e05e1ac}{ipv6\+Check\+Dest\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Destination I\+Pv6 address filtering. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv6__misc_8c_a1d69e11a455ee8895ec67061f554a174}{ipv6\+Select\+Source\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$$\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ndp_8h_ab217f0ee2104c7c5529a4ece1f77e02c}{dest\+Addr}, \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ethernet_8h_a522a68dc3582289088de6b36018e9ea0}{src\+Addr})
\begin{DoxyCompactList}\small\item\em I\+Pv6 source address selection. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv6__misc_8c_ab10ec233f3239c6238bb4f5995543a79}{ipv6\+Is\+On\+Link} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether an I\+Pv6 address is on-\/link. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv6__misc_8c_a7448bedb5edff0df8029ca8b5c6d994d}{ipv6\+Is\+Anycast\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether an I\+Pv6 address is an anycast address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv6__misc_8c_af26691bb490df211ba351340016cd53c}{ipv6\+Is\+Tentative\+Addr} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether an I\+Pv6 address is a tentative address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv6__misc_8c_ab7beff545842b6a10b9b4d9ca16ad6d7}{ipv6\+Is\+Local\+Host\+Addr} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Check whether the specified I\+Pv6 is assigned to the host. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{ipv6__misc_8c_a6cf8eae90cab177c8b32b1bf1709952b}{ipv6\+Comp\+Prefix} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$ip\+Addr1, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$ip\+Addr2, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Compare I\+Pv6 address prefixes. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6\+Get\+Addr\+Scope} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Retrieve the scope of an I\+Pv6 address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ipv6__misc_8c_ac726619e6500adea75087eb67d9fcdd9}{ipv6\+Get\+Multicast\+Addr\+Scope} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Retrieve the scope of an I\+Pv6 multicast address. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ipv6__misc_8c_a2e1598bb456416398fd8d4f5754dc746}{ipv6\+Get\+Common\+Prefix\+Length} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$ip\+Addr1, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$ip\+Addr2)
\begin{DoxyCompactList}\small\item\em Compute the length of the longest common prefix. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv6__misc_8c_a6ae7a7bdd0009e5dcb63267ed1cf9c88}{ipv6\+Compute\+Solicited\+Node\+Addr} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr}, \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$solicited\+Node\+Addr)
\begin{DoxyCompactList}\small\item\em Form a solicited-\/node address from an I\+Pv6 address. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ipv6__misc_8c_a453cf0d6b405a92b209956fdc99e035f}{ipv6\+Map\+Multicast\+Addr\+To\+Mac} (const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr}, \hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$mac\+Addr)
\begin{DoxyCompactList}\small\item\em Map an I\+Pv6 multicast address to a M\+A\+C-\/layer multicast address. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a528bfb892811943ea3910ca0e13b0ed1}{ipv6\+Generate\+Link\+Local\+Addr} (const \hyperlink{ethernet_8h_acbcae3afd042b3ce97e42f54013c8137}{Eui64} $\ast$\hyperlink{ipv6cp_8h_a897753848b1e78a33fa45fad7b58ddbb}{interface\+Id}, \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a11542dd5a4de5976a89188df3d53b42d}{ip\+Addr})
\begin{DoxyCompactList}\small\item\em Generate a I\+Pv6 link-\/local address from an interface identifier. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a53daa831ff5d6b2691442ace4fc832cd}{ipv6\+Update\+In\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{dest\+Ip\+Addr}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update I\+Pv6 input statistics. \end{DoxyCompactList}\item 
void \hyperlink{ipv6__misc_8c_a85a88896558084d85128a3e998df8936}{ipv6\+Update\+Out\+Stats} (\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface, const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{dest\+Ip\+Addr}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update I\+Pv6 output statistics. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Helper functions for I\+Pv6. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{ipv6__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{ipv6__misc_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_abdf5ff5f080602055c37443bec1fe78c}{I\+P\+V6\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file ipv6\+\_\+misc.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{ipv6__misc_8c_a09293900ef392400821733fd3ef1a66b}\label{ipv6__misc_8c_a09293900ef392400821733fd3ef1a66b}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Add\+Addr@{ipv6\+Add\+Addr}}
\index{ipv6\+Add\+Addr@{ipv6\+Add\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Add\+Addr()}{ipv6AddAddr()}}
{\footnotesize\ttfamily void ipv6\+Add\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{addr,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{valid\+Lifetime,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{preferred\+Lifetime }\end{DoxyParamCaption})}



Add a new entry to the list of I\+Pv6 addresses. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em addr} & I\+Pv6 address \\
\hline
\mbox{\tt in}  & {\em valid\+Lifetime} & Valid lifetime, in seconds \\
\hline
\mbox{\tt in}  & {\em preferred\+Lifetime} & Preferred lifetime, in seconds \\
\hline
\end{DoxyParams}


Definition at line 224 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
226 \{
227    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
228    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
229 
230    \textcolor{comment}{//Check the valid lifetime}
231    \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} != \hyperlink{ndp_8h_a96fa12d04b522371a81350239b9e2d11}{NDP\_INFINITE\_LIFETIME})
232    \{
233       \textcolor{comment}{//The length of time in seconds that the address is valid}
234       \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} < (\hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY} / 1000))
235          \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} *= 1000;
236       \textcolor{keywordflow}{else}
237          \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} = \hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY};
238    \}
239    \textcolor{keywordflow}{else}
240    \{
241       \textcolor{comment}{//A value of all one bits (0xffffffff) represents infinity}
242       \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} = \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
243    \}
244 
245    \textcolor{comment}{//Check the preferred lifetime}
246    \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} != \hyperlink{ndp_8h_a96fa12d04b522371a81350239b9e2d11}{NDP\_INFINITE\_LIFETIME})
247    \{
248       \textcolor{comment}{//The length of time in seconds that the address remains preferred}
249       \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} < (\hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY} / 1000))
250          \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} *= 1000;
251       \textcolor{keywordflow}{else}
252          \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} = \hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY};
253    \}
254    \textcolor{keywordflow}{else}
255    \{
256       \textcolor{comment}{//A value of all one bits (0xffffffff) represents infinity}
257       \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} = \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
258    \}
259 
260    \textcolor{comment}{//Loop through the list of IPv6 addresses assigned to the interface}
261    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
262    \{
263       \textcolor{comment}{//Point to the current entry}
264       entry = &interface->ipv6Context.addrList[i];
265 
266       \textcolor{comment}{//Check the state of the IPv6 address}
267       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED} ||
268          entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518da4cd161ce2c979312f91a8f3e946acec6}{IPV6\_ADDR\_STATE\_DEPRECATED})
269       \{
270          \textcolor{comment}{//Check whether the current entry matches the specified address}
271          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}))
272          \{
273             \textcolor{comment}{//The IPv6 address should be preserved if it has been manually assigned}
274             \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6AddrEntry_a196db6647dd1196a1c3a06c8a4083a48}{permanent})
275             \{
276                \textcolor{comment}{//Update the lifetimes of the entry}
277                entry->\hyperlink{structIpv6AddrEntry_ab56a11d9de06327ab5af04e8ae18164d}{validLifetime} = \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime};
278                entry->\hyperlink{structIpv6AddrEntry_a4d368a125e163baf554e7622edff555f}{preferredLifetime} = \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime};
279 
280                \textcolor{comment}{//Save current time}
281                entry->\hyperlink{structIpv6AddrEntry_a9080e69e7dc724704176843cdadfb29b}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
282                \textcolor{comment}{//Update the state of the IPv6 address}
283                entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} = \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED};
284             \}
285 
286             \textcolor{comment}{//Exit immediately}
287             \textcolor{keywordflow}{return};
288          \}
289       \}
290    \}
291 
292    \textcolor{comment}{//If no matching entry was found, then try to create a new entry}
293    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
294    \{
295       \textcolor{comment}{//Point to the current entry}
296       entry = &interface->ipv6Context.addrList[i];
297 
298       \textcolor{comment}{//Check the state of the IPv6 address}
299       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID})
300       \{
301          \textcolor{comment}{//The IPv6 address should be preserved if it has been manually assigned}
302          \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6AddrEntry_a196db6647dd1196a1c3a06c8a4083a48}{permanent})
303          \{
304 \textcolor{preprocessor}{#if (NDP\_SUPPORT == ENABLED)}
305             \textcolor{comment}{//Check whether Duplicate Address Detection should be performed}
306             \textcolor{keywordflow}{if}(interface->ndpContext.dupAddrDetectTransmits > 0)
307             \{
308                \textcolor{comment}{//Use the IPv6 address as a tentative address}
309                \hyperlink{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}{ipv6SetAddr}(interface, i, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, 
      \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dacb3152ea8c90d13a425042070b987fe6}{IPV6\_ADDR\_STATE\_TENTATIVE},
310                   \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime}, \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
311             \}
312             \textcolor{keywordflow}{else}
313 \textcolor{preprocessor}{#endif}
314             \{
315                \textcolor{comment}{//The use of the IPv6 address is now unrestricted}
316                \hyperlink{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}{ipv6SetAddr}(interface, i, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, 
      \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED},
317                   \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime}, \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime}, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
318             \}
319 
320             \textcolor{comment}{//Exit immediately}
321             \textcolor{keywordflow}{return};
322          \}
323       \}
324    \}
325 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a527a66aa974432cc0f42726426408c49}\label{ipv6__misc_8c_a527a66aa974432cc0f42726426408c49}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Add\+Default\+Router@{ipv6\+Add\+Default\+Router}}
\index{ipv6\+Add\+Default\+Router@{ipv6\+Add\+Default\+Router}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Add\+Default\+Router()}{ipv6AddDefaultRouter()}}
{\footnotesize\ttfamily void ipv6\+Add\+Default\+Router (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{addr,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{lifetime,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t}}]{preference }\end{DoxyParamCaption})}



Add a new entry to the Default Router List. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em addr} & I\+Pv6 address of the router \\
\hline
\mbox{\tt in}  & {\em lifetime} & Router lifetime, in seconds \\
\hline
\mbox{\tt in}  & {\em preference} & Preference value \\
\hline
\end{DoxyParams}


Definition at line 525 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
527 \{
528    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
529    \hyperlink{structIpv6RouterEntry}{Ipv6RouterEntry} *entry;
530    \hyperlink{structIpv6RouterEntry}{Ipv6RouterEntry} *firstFreeEntry;
531 
532    \textcolor{comment}{//Initialize variables}
533    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
534    firstFreeEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
535 
536    \textcolor{comment}{//Loop through the Default Router List}
537    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_af61cd2a89ea067f9ecd5a7f7d9649bba}{IPV6\_ROUTER\_LIST\_SIZE}; i++)
538    \{
539       \textcolor{comment}{//Point to the current entry}
540       entry = &interface->ipv6Context.routerList[i];
541 
542       \textcolor{comment}{//Check the lifetime associated with the default router}
543       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6RouterEntry_aed560238a63f534a2cecaf1c5eea614c}{lifetime})
544       \{
545          \textcolor{comment}{//Check whether the current entry matches the specified router address}
546          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6RouterEntry_ae229e171486421953e178c27b8527789}{addr}, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}))
547             \textcolor{keywordflow}{break};
548       \}
549       \textcolor{keywordflow}{else}
550       \{
551          \textcolor{comment}{//The router address should be preserved if it has been manually assigned}
552          \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6RouterEntry_a9b423514103cfe737922334c5f0d9ff2}{permanent})
553          \{
554             \textcolor{comment}{//Keep track of the first free entry}
555             \textcolor{keywordflow}{if}(firstFreeEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
556                firstFreeEntry = entry;
557          \}
558       \}
559    \}
560 
561    \textcolor{comment}{//No matching entry found?}
562    \textcolor{keywordflow}{if}(i >= IPV6\_ROUTER\_LIST\_SIZE)
563       entry = firstFreeEntry;
564 
565    \textcolor{comment}{//Update the entry if necessary}
566    \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
567    \{
568       \textcolor{comment}{//The router address should be preserved if it has been manually assigned}
569       \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6RouterEntry_a9b423514103cfe737922334c5f0d9ff2}{permanent})
570       \{
571          \textcolor{comment}{//Save the IPv6 address of the router}
572          entry->\hyperlink{structIpv6RouterEntry_ae229e171486421953e178c27b8527789}{addr} = *\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr};
573          \textcolor{comment}{//The lifetime associated with the default router}
574          entry->\hyperlink{structIpv6RouterEntry_aed560238a63f534a2cecaf1c5eea614c}{lifetime} = \hyperlink{ndp_8h_a569e06e92ec3d06c5ebf7f40d7f9a84e}{lifetime} * 1000;
575          \textcolor{comment}{//Save preference value}
576          entry->\hyperlink{structIpv6RouterEntry_ac637f0417fbe667ddb09990a366c8ad8}{preference} = preference;
577          \textcolor{comment}{//Save current time}
578          entry->\hyperlink{structIpv6RouterEntry_a913df3ea3054f2f7c605e103196d9f65}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
579       \}
580    \}
581 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a884d417b4bfee285e631132b9d8dffb9}\label{ipv6__misc_8c_a884d417b4bfee285e631132b9d8dffb9}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Add\+Prefix@{ipv6\+Add\+Prefix}}
\index{ipv6\+Add\+Prefix@{ipv6\+Add\+Prefix}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Add\+Prefix()}{ipv6AddPrefix()}}
{\footnotesize\ttfamily void ipv6\+Add\+Prefix (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{prefix,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{length,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{on\+Link\+Flag,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{autonomous\+Flag,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{valid\+Lifetime,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{preferred\+Lifetime }\end{DoxyParamCaption})}



Add a new entry to the Prefix List. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em prefix} & I\+Pv6 prefix \\
\hline
\mbox{\tt in}  & {\em length} & The number of leading bits in the prefix that are valid \\
\hline
\mbox{\tt in}  & {\em on\+Link\+Flag} & On-\/link flag \\
\hline
\mbox{\tt in}  & {\em autonomous\+Flag} & Autonomous flag \\
\hline
\mbox{\tt in}  & {\em valid\+Lifetime} & Valid lifetime, in seconds \\
\hline
\mbox{\tt in}  & {\em preferred\+Lifetime} & Preferred lifetime, in seconds \\
\hline
\end{DoxyParams}


Definition at line 375 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
378 \{
379    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
380    \hyperlink{structIpv6PrefixEntry}{Ipv6PrefixEntry} *entry;
381    \hyperlink{structIpv6PrefixEntry}{Ipv6PrefixEntry} *firstFreeEntry;
382 
383    \textcolor{comment}{//Initialize variables}
384    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
385    firstFreeEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
386 
387    \textcolor{comment}{//Loop through the Prefix List}
388    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_a928a90013c8822cded35706806f00171}{IPV6\_PREFIX\_LIST\_SIZE}; i++)
389    \{
390       \textcolor{comment}{//Point to the current entry}
391       entry = &interface->ipv6Context.prefixList[i];
392 
393       \textcolor{comment}{//Valid prefix?}
394       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime})
395       \{
396          \textcolor{comment}{//Compare prefix length against the specified value}
397          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6PrefixEntry_a42ac450d305210faf002c0b59e0c9bc8}{prefixLen} == \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
398          \{
399             \textcolor{comment}{//Check whether the current entry matches the specified prefix}
400             \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_a6cf8eae90cab177c8b32b1bf1709952b}{ipv6CompPrefix}(&entry->\hyperlink{structIpv6PrefixEntry_ac8fdea2f9884d84f35af314249e47aa4}{prefix}, \hyperlink{dhcpv6__common_8h_a82020d9f611b297873f5caeecb4e93c1}{prefix}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}))
401                \textcolor{keywordflow}{break};
402          \}
403       \}
404       \textcolor{keywordflow}{else}
405       \{
406          \textcolor{comment}{//The IPv6 prefix should be preserved if it has been manually assigned}
407          \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6PrefixEntry_a9f6301283cb4b3a6d2e3ffeed9e68f90}{permanent})
408          \{
409             \textcolor{comment}{//Keep track of the first free entry}
410             \textcolor{keywordflow}{if}(firstFreeEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
411                firstFreeEntry = entry;
412          \}
413       \}
414    \}
415 
416    \textcolor{comment}{//No matching entry found?}
417    \textcolor{keywordflow}{if}(i >= IPV6\_PREFIX\_LIST\_SIZE)
418       entry = firstFreeEntry;
419 
420    \textcolor{comment}{//Update the entry if necessary}
421    \textcolor{keywordflow}{if}(entry != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
422    \{
423       \textcolor{comment}{//The IPv6 prefix should be preserved if it has been manually assigned}
424       \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6PrefixEntry_a9f6301283cb4b3a6d2e3ffeed9e68f90}{permanent})
425       \{
426          \textcolor{comment}{//Save the IPv6 prefix}
427          entry->\hyperlink{structIpv6PrefixEntry_ac8fdea2f9884d84f35af314249e47aa4}{prefix} = *\hyperlink{dhcpv6__common_8h_a82020d9f611b297873f5caeecb4e93c1}{prefix};
428          entry->\hyperlink{structIpv6PrefixEntry_a42ac450d305210faf002c0b59e0c9bc8}{prefixLen} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
429 
430          \textcolor{comment}{//Save On-link and Autonomous flags}
431          entry->\hyperlink{structIpv6PrefixEntry_a235114a9f36acb687819948f0b8cd581}{onLinkFlag} = onLinkFlag;
432          entry->\hyperlink{structIpv6PrefixEntry_a072d6a4bd262b000583605778f913595}{autonomousFlag} = autonomousFlag;
433 
434          \textcolor{comment}{//Check the valid lifetime}
435          \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} != \hyperlink{ndp_8h_a96fa12d04b522371a81350239b9e2d11}{NDP\_INFINITE\_LIFETIME})
436          \{
437             \textcolor{comment}{//The length of time in seconds that the prefix is valid}
438             \textcolor{comment}{//for the purpose of on-link determination}
439             \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} < (\hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY} / 1000))
440                entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} = \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime} * 1000;
441             \textcolor{keywordflow}{else}
442                entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} = \hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY};
443          \}
444          \textcolor{keywordflow}{else}
445          \{
446             \textcolor{comment}{//A value of all one bits (0xffffffff) represents infinity}
447             entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} = \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
448          \}
449 
450          \textcolor{comment}{//Check the preferred lifetime}
451          \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} != \hyperlink{ndp_8h_a96fa12d04b522371a81350239b9e2d11}{NDP\_INFINITE\_LIFETIME})
452          \{
453             \textcolor{comment}{//The length of time in seconds that addresses generated from the}
454             \textcolor{comment}{//prefix via stateless address autoconfiguration remain preferred}
455             \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} < (\hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY} / 1000))
456                entry->\hyperlink{structIpv6PrefixEntry_affc16d60fc2bd38a653b214a41968b0e}{preferredLifetime} = \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime} * 1000;
457             \textcolor{keywordflow}{else}
458                entry->\hyperlink{structIpv6PrefixEntry_affc16d60fc2bd38a653b214a41968b0e}{preferredLifetime} = \hyperlink{os__port_8h_a16027d8acc5301e440cefa086eb9db2a}{MAX\_DELAY};
459          \}
460          \textcolor{keywordflow}{else}
461          \{
462             \textcolor{comment}{//A value of all one bits (0xffffffff) represents infinity}
463             entry->\hyperlink{structIpv6PrefixEntry_affc16d60fc2bd38a653b214a41968b0e}{preferredLifetime} = \hyperlink{os__port_8h_ab893de6f8a0ec8b0e6dd8097ff398019}{INFINITE\_DELAY};
464          \}
465 
466          \textcolor{comment}{//Save current time}
467          entry->\hyperlink{structIpv6PrefixEntry_a3c685a8be455dd84c5b4886b082fe943}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
468       \}
469    \}
470 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_acf063c0c23ac317d11b9973f3e05e1ac}\label{ipv6__misc_8c_acf063c0c23ac317d11b9973f3e05e1ac}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Check\+Dest\+Addr@{ipv6\+Check\+Dest\+Addr}}
\index{ipv6\+Check\+Dest\+Addr@{ipv6\+Check\+Dest\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Check\+Dest\+Addr()}{ipv6CheckDestAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6\+Check\+Dest\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Destination I\+Pv6 address filtering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & Destination I\+Pv6 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 777 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
778 \{
779    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
780    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
781    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
782 
783    \textcolor{comment}{//Filter out any invalid addresses}
784    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
785 
786    \textcolor{comment}{//Multicast address?}
787    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
788    \{
789       \textcolor{comment}{//Go through the multicast filter table}
790       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_a76328e1ef9ee7a408d4fb6bcfa62b910}{IPV6\_MULTICAST\_FILTER\_SIZE}; i++)
791       \{
792          \hyperlink{structIpv6FilterEntry}{Ipv6FilterEntry} *entry;
793 
794          \textcolor{comment}{//Point to the current entry}
795          entry = &interface->ipv6Context.multicastFilter[i];
796 
797          \textcolor{comment}{//Valid entry?}
798          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6FilterEntry_a1d01842023f238350bc3f6dfa99999c6}{refCount} > 0)
799          \{
800             \textcolor{comment}{//Check whether the destination IPv6 address matches}
801             \textcolor{comment}{//a relevant multicast address}
802             \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6FilterEntry_ab3f4b20455a0f3d0912b2dfad354ef86}{addr}, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
803             \{
804                \textcolor{comment}{//The multicast address is acceptable}
805                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
806                \textcolor{comment}{//Stop immediately}
807                \textcolor{keywordflow}{break};
808             \}
809          \}
810       \}
811    \}
812    \textcolor{comment}{//Unicast address?}
813    \textcolor{keywordflow}{else}
814    \{
815       \textcolor{comment}{//Loop through the list of IPv6 unicast addresses}
816       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
817       \{
818          \textcolor{comment}{//Point to the current entry}
819          entry = &interface->ipv6Context.addrList[i];
820 
821          \textcolor{comment}{//Valid entry?}
822          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6FilterEntry_a1b5076e55c13c43bdf6eb2b501a483df}{state} != \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID})
823          \{
824             \textcolor{comment}{//Check whether the destination address matches a valid unicast}
825             \textcolor{comment}{//address assigned to the interface}
826             \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6FilterEntry_ab3f4b20455a0f3d0912b2dfad354ef86}{addr}, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
827             \{
828                \textcolor{comment}{//The destination address is acceptable}
829                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
830                \textcolor{comment}{//We are done}
831                \textcolor{keywordflow}{break};
832             \}
833          \}
834       \}
835 
836       \textcolor{comment}{//Check whether the specified is a valid unicast address}
837       \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS})
838       \{
839          \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr} *anycastAddrList;
840 
841          \textcolor{comment}{//Point to the list of anycast addresses assigned to the interface}
842          anycastAddrList = interface->ipv6Context.anycastAddrList;
843 
844          \textcolor{comment}{//Loop through the list of IPv6 anycast addresses}
845          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_ab01594dcab02d6075c20e22954c2d872}{IPV6\_ANYCAST\_ADDR\_LIST\_SIZE}; i++)
846          \{
847             \textcolor{comment}{//Valid entry?}
848             \textcolor{keywordflow}{if}(!\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&anycastAddrList[i], &
      \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR}))
849             \{
850                \textcolor{comment}{//Check whether the destination address matches a valid anycast}
851                \textcolor{comment}{//address assigned to the interface}
852                \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&anycastAddrList[i], \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
853                \{
854                   \textcolor{comment}{//The destination address is acceptable}
855                   error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
856                   \textcolor{comment}{//We are done}
857                   \textcolor{keywordflow}{break};
858                \}
859             \}
860          \}
861       \}
862    \}
863 
864    \textcolor{comment}{//Return status code}
865    \textcolor{keywordflow}{return} error;
866 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_aa3642cbe1517b756af1861400e4b19c0}\label{ipv6__misc_8c_aa3642cbe1517b756af1861400e4b19c0}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Check\+Source\+Addr@{ipv6\+Check\+Source\+Addr}}
\index{ipv6\+Check\+Source\+Addr@{ipv6\+Check\+Source\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Check\+Source\+Addr()}{ipv6CheckSourceAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6\+Check\+Source\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Source I\+Pv6 address filtering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & Source I\+Pv6 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 754 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
755 \{
756    \textcolor{comment}{//Multicast addresses cannot be used as source address}
757    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
758    \{
759       \textcolor{comment}{//Debug message}
760       \hyperlink{debug_8h_a72b9761add7486364dba449091cd2579}{TRACE\_WARNING}(\textcolor{stringliteral}{"Wrong source IPv6 address!\(\backslash\)r\(\backslash\)n"});
761       \textcolor{comment}{//The source address not is acceptable}
762       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
763    \}
764 
765    \textcolor{comment}{//The source address is acceptable}
766    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
767 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a6cf8eae90cab177c8b32b1bf1709952b}\label{ipv6__misc_8c_a6cf8eae90cab177c8b32b1bf1709952b}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Comp\+Prefix@{ipv6\+Comp\+Prefix}}
\index{ipv6\+Comp\+Prefix@{ipv6\+Comp\+Prefix}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Comp\+Prefix()}{ipv6CompPrefix()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv6\+Comp\+Prefix (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr1,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr2,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Compare I\+Pv6 address prefixes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr1} & Pointer to the first I\+Pv6 address \\
\hline
\mbox{\tt in}  & {\em ip\+Addr2} & Pointer to the second I\+Pv6 address \\
\hline
\mbox{\tt in}  & {\em length} & Prefix length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the prefixes match each other, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 1208 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1210 \{
1211    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1212    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
1213    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
1214 
1215    \textcolor{comment}{//Ensure the prefix length is valid}
1216    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 128)
1217       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1218 
1219    \textcolor{comment}{//Number of complete bytes}
1220    n = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} / 8;
1221    \textcolor{comment}{//Number of bits in the last byte, if any}
1222    m = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} % 8;
1223 
1224    \textcolor{comment}{//Compare the first part}
1225    \textcolor{keywordflow}{if}(n > 0)
1226    \{
1227       \textcolor{keywordflow}{if}(memcmp(ipAddr1, ipAddr2, n))
1228          \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1229    \}
1230 
1231    \textcolor{comment}{//Compare the remaining bits, if any}
1232    \textcolor{keywordflow}{if}(m > 0)
1233    \{
1234       \textcolor{comment}{//Calculate the mask to be applied}
1235       mask = ((1 << \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m}) - 1) << (8 - \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m});
1236 
1237       \textcolor{comment}{//Check remaining bits}
1238       \textcolor{keywordflow}{if}((ipAddr1->b[n] & mask) != (ipAddr2->b[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] & \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}))
1239          \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1240    \}
1241 
1242    \textcolor{comment}{//The prefixes match each other}
1243    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1244 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a6ae7a7bdd0009e5dcb63267ed1cf9c88}\label{ipv6__misc_8c_a6ae7a7bdd0009e5dcb63267ed1cf9c88}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Compute\+Solicited\+Node\+Addr@{ipv6\+Compute\+Solicited\+Node\+Addr}}
\index{ipv6\+Compute\+Solicited\+Node\+Addr@{ipv6\+Compute\+Solicited\+Node\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Compute\+Solicited\+Node\+Addr()}{ipv6ComputeSolicitedNodeAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6\+Compute\+Solicited\+Node\+Addr (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr,  }\item[{\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{solicited\+Node\+Addr }\end{DoxyParamCaption})}



Form a solicited-\/node address from an I\+Pv6 address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & Unicast or anycast address \\
\hline
\mbox{\tt out}  & {\em solicited\+Node\+Addr} & Corresponding solicited-\/node address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1377 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1379 \{
1380    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1381 
1382    \textcolor{comment}{//Ensure the specified address is a valid unicast or anycast address}
1383    \textcolor{keywordflow}{if}(!\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1384    \{
1385       \textcolor{comment}{//Copy the 104-bit prefix}
1386       \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(solicitedNodeAddr, &
      \hyperlink{ipv6_8c_a0c6949a7a4e181d0c2b32546bb48acf0}{IPV6\_SOLICITED\_NODE\_ADDR\_PREFIX});
1387 
1388       \textcolor{comment}{//Take the low-order 24 bits of the address (unicast or anycast) and}
1389       \textcolor{comment}{//append those bits to the prefix}
1390       solicitedNodeAddr->b[13] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[13];
1391       solicitedNodeAddr->b[14] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[14];
1392       solicitedNodeAddr->b[15] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[15];
1393 
1394       \textcolor{comment}{//Sucessful processing}
1395       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1396    \}
1397    \textcolor{keywordflow}{else}
1398    \{
1399       \textcolor{comment}{//Report an error}
1400       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
1401    \}
1402 
1403    \textcolor{comment}{//Return status code}
1404    \textcolor{keywordflow}{return} error;
1405 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_afb37c6c9de9b5604c5da82ed368456a8}\label{ipv6__misc_8c_afb37c6c9de9b5604c5da82ed368456a8}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Flush\+Addr\+List@{ipv6\+Flush\+Addr\+List}}
\index{ipv6\+Flush\+Addr\+List@{ipv6\+Flush\+Addr\+List}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Flush\+Addr\+List()}{ipv6FlushAddrList()}}
{\footnotesize\ttfamily void ipv6\+Flush\+Addr\+List (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Flush the list of I\+Pv6 addresses. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 644 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
645 \{
646    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
647    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
648 
649    \textcolor{comment}{//Go through the list of IPv6 addresses}
650    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
651    \{
652       \textcolor{comment}{//Point to the current entry}
653       entry = &interface->ipv6Context.addrList[i];
654 
655       \textcolor{comment}{//Valid IPv6 address?}
656       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ab56a11d9de06327ab5af04e8ae18164d}{validLifetime} > 0)
657       \{
658          \textcolor{comment}{//The IPv6 address should be preserved if it has been manually assigned}
659          \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6AddrEntry_a196db6647dd1196a1c3a06c8a4083a48}{permanent})
660          \{
661             \textcolor{comment}{//The IPv6 address is not longer valid}
662             \hyperlink{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}{ipv6SetAddr}(interface, i, &\hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR},
663                \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID}, 0, 0, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
664          \}
665       \}
666    \}
667 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a0e00adcd144c72507340a06a6d70ffcc}\label{ipv6__misc_8c_a0e00adcd144c72507340a06a6d70ffcc}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Flush\+Default\+Router\+List@{ipv6\+Flush\+Default\+Router\+List}}
\index{ipv6\+Flush\+Default\+Router\+List@{ipv6\+Flush\+Default\+Router\+List}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Flush\+Default\+Router\+List()}{ipv6FlushDefaultRouterList()}}
{\footnotesize\ttfamily void ipv6\+Flush\+Default\+Router\+List (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Flush the Default Router List. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 707 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
708 \{
709    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
710    \hyperlink{structIpv6RouterEntry}{Ipv6RouterEntry} *entry;
711 
712    \textcolor{comment}{//Go through the Default Router List}
713    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_af61cd2a89ea067f9ecd5a7f7d9649bba}{IPV6\_ROUTER\_LIST\_SIZE}; i++)
714    \{
715       \textcolor{comment}{//Point to the current entry}
716       entry = &interface->ipv6Context.routerList[i];
717 
718       \textcolor{comment}{//Valid entry?}
719       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6RouterEntry_aed560238a63f534a2cecaf1c5eea614c}{lifetime} > 0)
720       \{
721          \textcolor{comment}{//The router address should be preserved if it has been manually assigned}
722          \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6RouterEntry_a9b423514103cfe737922334c5f0d9ff2}{permanent})
723          \{
724             \textcolor{comment}{//Clear the current entry}
725             entry->\hyperlink{structIpv6RouterEntry_ae229e171486421953e178c27b8527789}{addr} = \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR};
726             \textcolor{comment}{//Remove the entry from the Default Router List}
727             entry->\hyperlink{structIpv6RouterEntry_aed560238a63f534a2cecaf1c5eea614c}{lifetime} = 0;
728          \}
729       \}
730    \}
731 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a4b3ce94edd9cad3fb3269e805a104b97}\label{ipv6__misc_8c_a4b3ce94edd9cad3fb3269e805a104b97}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Flush\+Dns\+Server\+List@{ipv6\+Flush\+Dns\+Server\+List}}
\index{ipv6\+Flush\+Dns\+Server\+List@{ipv6\+Flush\+Dns\+Server\+List}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Flush\+Dns\+Server\+List()}{ipv6FlushDnsServerList()}}
{\footnotesize\ttfamily void ipv6\+Flush\+Dns\+Server\+List (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Flush the list of D\+NS servers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 739 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
740 \{
741    \textcolor{comment}{//Clear the list of DNS servers}
742    memset(interface->ipv6Context.dnsServerList, 0,
743       \textcolor{keyword}{sizeof}(interface->ipv6Context.dnsServerList));
744 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a054753911977d85a35deee34c2c2c46c}\label{ipv6__misc_8c_a054753911977d85a35deee34c2c2c46c}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Flush\+Prefix\+List@{ipv6\+Flush\+Prefix\+List}}
\index{ipv6\+Flush\+Prefix\+List@{ipv6\+Flush\+Prefix\+List}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Flush\+Prefix\+List()}{ipv6FlushPrefixList()}}
{\footnotesize\ttfamily void ipv6\+Flush\+Prefix\+List (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Flush the Prefix List. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\end{DoxyParams}


Definition at line 675 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
676 \{
677    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
678    \hyperlink{structIpv6PrefixEntry}{Ipv6PrefixEntry} *entry;
679 
680    \textcolor{comment}{//Go through the Prefix List}
681    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_a928a90013c8822cded35706806f00171}{IPV6\_PREFIX\_LIST\_SIZE}; i++)
682    \{
683       \textcolor{comment}{//Point to the current entry}
684       entry = &interface->ipv6Context.prefixList[i];
685 
686       \textcolor{comment}{//Valid IPv6 prefix?}
687       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} > 0)
688       \{
689          \textcolor{comment}{//The IPv6 prefix should be preserved if it has been manually assigned}
690          \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6PrefixEntry_a9f6301283cb4b3a6d2e3ffeed9e68f90}{permanent})
691          \{
692             \textcolor{comment}{//Remove the entry from the Prefix List}
693             entry->\hyperlink{structIpv6PrefixEntry_ac8fdea2f9884d84f35af314249e47aa4}{prefix} = \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR};
694             entry->\hyperlink{structIpv6PrefixEntry_a42ac450d305210faf002c0b59e0c9bc8}{prefixLen} = 0;
695             entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} = 0;
696          \}
697       \}
698    \}
699 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a528bfb892811943ea3910ca0e13b0ed1}\label{ipv6__misc_8c_a528bfb892811943ea3910ca0e13b0ed1}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Generate\+Link\+Local\+Addr@{ipv6\+Generate\+Link\+Local\+Addr}}
\index{ipv6\+Generate\+Link\+Local\+Addr@{ipv6\+Generate\+Link\+Local\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Generate\+Link\+Local\+Addr()}{ipv6GenerateLinkLocalAddr()}}
{\footnotesize\ttfamily void ipv6\+Generate\+Link\+Local\+Addr (\begin{DoxyParamCaption}\item[{const \hyperlink{ethernet_8h_acbcae3afd042b3ce97e42f54013c8137}{Eui64} $\ast$}]{interface\+Id,  }\item[{\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Generate a I\+Pv6 link-\/local address from an interface identifier. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface\+Id} & Interface identifier \\
\hline
\mbox{\tt out}  & {\em ip\+Addr} & Corresponding I\+Pv6 link-\/local address \\
\hline
\end{DoxyParams}


Definition at line 1455 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1456 \{
1457    \textcolor{comment}{//A link-local address is formed by combining the well-known link-local}
1458    \textcolor{comment}{//prefix fe80::/10 with the interface identifier}
1459    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[0] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(0xFE80);
1460    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[1] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(0x0000);
1461    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[2] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(0x0000);
1462    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[3] = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(0x0000);
1463    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[4] = \hyperlink{ipv6cp_8h_a897753848b1e78a33fa45fad7b58ddbb}{interfaceId}->w[0];
1464    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[5] = \hyperlink{ipv6cp_8h_a897753848b1e78a33fa45fad7b58ddbb}{interfaceId}->w[1];
1465    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[6] = \hyperlink{ipv6cp_8h_a897753848b1e78a33fa45fad7b58ddbb}{interfaceId}->w[2];
1466    \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->w[7] = \hyperlink{ipv6cp_8h_a897753848b1e78a33fa45fad7b58ddbb}{interfaceId}->w[3];
1467 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}\label{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Get\+Addr\+Scope@{ipv6\+Get\+Addr\+Scope}}
\index{ipv6\+Get\+Addr\+Scope@{ipv6\+Get\+Addr\+Scope}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Get\+Addr\+Scope()}{ipv6GetAddrScope()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} ipv6\+Get\+Addr\+Scope (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Retrieve the scope of an I\+Pv6 address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & Pointer to an I\+Pv6 address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
I\+Pv6 address scope 
\end{DoxyReturn}


Definition at line 1253 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1254 \{
1255    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} scope;
1256 
1257    \textcolor{comment}{//Multicast address?}
1258    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1259    \{
1260       \textcolor{comment}{//Retrieve the scope of the multicast address}
1261       scope = \hyperlink{ipv6__misc_8c_ac726619e6500adea75087eb67d9fcdd9}{ipv6GetMulticastAddrScope}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr});
1262    \}
1263    \textcolor{comment}{//Loopback address?}
1264    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}, &\hyperlink{ipv6_8c_ace4700d46a3a068b34f83bda5b2b7a31}{IPV6\_LOOPBACK\_ADDR}))
1265    \{
1266       \textcolor{comment}{//The loopback address may be used by a node to send an IPv6 packet}
1267       \textcolor{comment}{//to itself}
1268       scope = \hyperlink{ipv6_8h_a8a981d88c56053285156864e82bc36f4a30cc70fe4b8e786478ff56886dcd9ca2}{IPV6\_ADDR\_SCOPE\_INTERFACE\_LOCAL};
1269    \}
1270    \textcolor{comment}{//Link-local unicast address?}
1271    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a6f8d54c7cac75d512f6311e6f34e04ee}{ipv6IsLinkLocalUnicastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1272    \{
1273       \textcolor{comment}{//A link-local address is for use on a single link}
1274       scope = \hyperlink{ipv6_8h_a8a981d88c56053285156864e82bc36f4a0ecf14ec55906535123469c7a58aa622}{IPV6\_ADDR\_SCOPE\_LINK\_LOCAL};
1275    \}
1276    \textcolor{comment}{//Site-local unicast address?}
1277    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a705f1e390df3cd9de73b9f06f1fb6d5a}{ipv6IsSiteLocalUnicastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1278    \{
1279       \textcolor{comment}{//A site-local address is for use in a single site}
1280       scope = \hyperlink{ipv6_8h_a8a981d88c56053285156864e82bc36f4a80cbe77d6f1ca8f00bd6ba604312c315}{IPV6\_ADDR\_SCOPE\_SITE\_LOCAL};
1281    \}
1282    \textcolor{comment}{//Global address?}
1283    \textcolor{keywordflow}{else}
1284    \{
1285       \textcolor{comment}{//Global scope}
1286       scope = \hyperlink{ipv6_8h_a8a981d88c56053285156864e82bc36f4adf31317f0d84def0efa43117089960a0}{IPV6\_ADDR\_SCOPE\_GLOBAL};
1287    \}
1288 
1289    \textcolor{comment}{//Return the scope of the specified IPv6 address}
1290    \textcolor{keywordflow}{return} scope;
1291 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_ac635994871aa4238959d1c9488c5c486}\label{ipv6__misc_8c_ac635994871aa4238959d1c9488c5c486}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Get\+Addr\+State@{ipv6\+Get\+Addr\+State}}
\index{ipv6\+Get\+Addr\+State@{ipv6\+Get\+Addr\+State}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Get\+Addr\+State()}{ipv6GetAddrState()}}
{\footnotesize\ttfamily \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518d}{Ipv6\+Addr\+State} ipv6\+Get\+Addr\+State (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{addr }\end{DoxyParamCaption})}



Get the state of the specified I\+Pv6 address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em addr} & I\+Pv6 address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Address state 
\end{DoxyReturn}


Definition at line 55 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
56 \{
57    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
58    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
59 
60    \textcolor{comment}{//Loop through the list of IPv6 addresses assigned to the interface}
61    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
62    \{
63       \textcolor{comment}{//Point to the current entry}
64       entry = &interface->ipv6Context.addrList[i];
65 
66       \textcolor{comment}{//Valid IPv6 address}
67       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} != \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID})
68       \{
69          \textcolor{comment}{//Check whether the current entry matches the specified address}
70          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}))
71          \{
72             \textcolor{comment}{//Return the state of the IPv6 address}
73             \textcolor{keywordflow}{return} entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state};
74          \}
75       \}
76    \}
77 
78    \textcolor{comment}{//The specified IPv6 address is not valid}
79    \textcolor{keywordflow}{return} \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID};
80 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a2e1598bb456416398fd8d4f5754dc746}\label{ipv6__misc_8c_a2e1598bb456416398fd8d4f5754dc746}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Get\+Common\+Prefix\+Length@{ipv6\+Get\+Common\+Prefix\+Length}}
\index{ipv6\+Get\+Common\+Prefix\+Length@{ipv6\+Get\+Common\+Prefix\+Length}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Get\+Common\+Prefix\+Length()}{ipv6GetCommonPrefixLength()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} ipv6\+Get\+Common\+Prefix\+Length (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr1,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr2 }\end{DoxyParamCaption})}



Compute the length of the longest common prefix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr1} & Pointer to the first I\+Pv6 address \\
\hline
\mbox{\tt in}  & {\em ip\+Addr2} & Pointer to the second I\+Pv6 address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The length of the longest common prefix, in bits 
\end{DoxyReturn}


Definition at line 1327 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1329 \{
1330    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1331    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
1332    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
1333 
1334    \textcolor{comment}{//Clear bit counter}
1335    j = 0;
1336 
1337    \textcolor{comment}{//Perform a byte-for-byte comparison}
1338    \textcolor{keywordflow}{for}(i = 0; i < \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}); i++)
1339    \{
1340       \textcolor{comment}{//Loop as long as prefixes match}
1341       \textcolor{keywordflow}{if}(ipAddr1->b[i] != ipAddr2->b[i])
1342       \{
1343          \textcolor{keywordflow}{break};
1344       \}
1345    \}
1346 
1347    \textcolor{comment}{//Any mismatch?}
1348    \textcolor{keywordflow}{if}(i < \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}))
1349    \{
1350       \textcolor{comment}{//Perform a bit-for-bit comparison}
1351       \textcolor{keywordflow}{for}(j = 0; j < 8; j++)
1352       \{
1353          \textcolor{comment}{//Calculate the mask to be applied}
1354          mask = 1 << (7 - j);
1355 
1356          \textcolor{comment}{//Loop as long as prefixes match}
1357          \textcolor{keywordflow}{if}((ipAddr1->b[i] & mask) != (ipAddr2->b[i] & \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}))
1358          \{
1359             \textcolor{keywordflow}{break};
1360          \}
1361       \}
1362    \}
1363 
1364    \textcolor{comment}{//Return the length of the longest prefix that the two addresses}
1365    \textcolor{comment}{//have in common}
1366    \textcolor{keywordflow}{return} i * 8 + j;
1367 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_ac726619e6500adea75087eb67d9fcdd9}\label{ipv6__misc_8c_ac726619e6500adea75087eb67d9fcdd9}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Get\+Multicast\+Addr\+Scope@{ipv6\+Get\+Multicast\+Addr\+Scope}}
\index{ipv6\+Get\+Multicast\+Addr\+Scope@{ipv6\+Get\+Multicast\+Addr\+Scope}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Get\+Multicast\+Addr\+Scope()}{ipv6GetMulticastAddrScope()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} ipv6\+Get\+Multicast\+Addr\+Scope (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Retrieve the scope of an I\+Pv6 multicast address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & Pointer to an I\+Pv6 multicast address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
I\+Pv6 address scope 
\end{DoxyReturn}


Definition at line 1300 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1301 \{
1302    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} scope;
1303 
1304    \textcolor{comment}{//The scope field is a 4-bit value}
1305    scope = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[1] & 0x0F;
1306 
1307    \textcolor{comment}{//If the scope field contains the reserved value F, an IPv6 packet}
1308    \textcolor{comment}{//must be treated the same as packets destined to a global multicast}
1309    \textcolor{comment}{//address (refer to RFC 3513 section 2.7)}
1310    \textcolor{keywordflow}{if}(scope == 0x0F)
1311    \{
1312       scope = \hyperlink{ipv6_8h_a8a981d88c56053285156864e82bc36f4adf31317f0d84def0efa43117089960a0}{IPV6\_ADDR\_SCOPE\_GLOBAL};
1313    \}
1314 
1315    \textcolor{comment}{//Return the scope of the specified IPv6 multicast address}
1316    \textcolor{keywordflow}{return} scope;
1317 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a7448bedb5edff0df8029ca8b5c6d994d}\label{ipv6__misc_8c_a7448bedb5edff0df8029ca8b5c6d994d}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Is\+Anycast\+Addr@{ipv6\+Is\+Anycast\+Addr}}
\index{ipv6\+Is\+Anycast\+Addr@{ipv6\+Is\+Anycast\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Is\+Anycast\+Addr()}{ipv6IsAnycastAddr()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv6\+Is\+Anycast\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether an I\+Pv6 address is an anycast address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv6 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv6 address is an anycast address, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 1076 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1077 \{
1078    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1079    \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr} *anycastAddrList;
1080 
1081    \textcolor{comment}{//Point to the list of anycast addresses assigned to the interface}
1082    anycastAddrList = interface->ipv6Context.anycastAddrList;
1083 
1084    \textcolor{comment}{//Loop through the list of IPv6 anycast addresses}
1085    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_ab01594dcab02d6075c20e22954c2d872}{IPV6\_ANYCAST\_ADDR\_LIST\_SIZE}; i++)
1086    \{
1087       \textcolor{comment}{//Valid entry?}
1088       \textcolor{keywordflow}{if}(!\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&anycastAddrList[i], &\hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR}))
1089       \{
1090          \textcolor{comment}{//Check whether the specified address matches a valid anycast}
1091          \textcolor{comment}{//address assigned to the interface}
1092          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&anycastAddrList[i], \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1093          \{
1094             \textcolor{comment}{//The specified IPv6 address is an anycast address}
1095             \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1096          \}
1097       \}
1098    \}
1099 
1100    \textcolor{comment}{//The specified IPv6 address is not an anycast address}
1101    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1102 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_ab7beff545842b6a10b9b4d9ca16ad6d7}\label{ipv6__misc_8c_ab7beff545842b6a10b9b4d9ca16ad6d7}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Is\+Local\+Host\+Addr@{ipv6\+Is\+Local\+Host\+Addr}}
\index{ipv6\+Is\+Local\+Host\+Addr@{ipv6\+Is\+Local\+Host\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Is\+Local\+Host\+Addr()}{ipv6IsLocalHostAddr()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv6\+Is\+Local\+Host\+Addr (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether the specified I\+Pv6 is assigned to the host. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv6 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv6 address matches any address assigned to the host, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 1148 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1149 \{
1150    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1151    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
1152    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} flag;
1153    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *interface;
1154    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
1155 
1156    \textcolor{comment}{//Initialize flag}
1157    flag = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1158 
1159    \textcolor{comment}{//Loopback address?}
1160    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}, &\hyperlink{ipv6_8c_ace4700d46a3a068b34f83bda5b2b7a31}{IPV6\_LOOPBACK\_ADDR}))
1161    \{
1162       \textcolor{comment}{//If an application in a host sends packets to this address, the IPv6}
1163       \textcolor{comment}{//stack will loop these packets back on the same virtual interface}
1164       flag = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1165    \}
1166    \textcolor{keywordflow}{else}
1167    \{
1168       \textcolor{comment}{//Loop through network interfaces}
1169       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{net_8h_a116f850ebcb023ffa3e6b8de10c5cb35}{NET\_INTERFACE\_COUNT} && !flag; i++)
1170       \{
1171          \textcolor{comment}{//Point to the current interface}
1172          \textcolor{keyword}{interface }= &\hyperlink{net_8c_a7ecafab0039ec54d1d7a1e9e7402379b}{netInterface}[i];
1173 
1174          \textcolor{comment}{//Iterate through the list of addresses assigned to the interface}
1175          \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE} && !flag; j++)
1176          \{
1177             \textcolor{comment}{//Point to the current entry}
1178             entry = &interface->ipv6Context.addrList[j];
1179 
1180             \textcolor{comment}{//Valid entry?}
1181             \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED} ||
1182                entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518da4cd161ce2c979312f91a8f3e946acec6}{IPV6\_ADDR\_STATE\_DEPRECATED})
1183             \{
1184                \textcolor{comment}{//Check whether the specified IPv6 address matches any address}
1185                \textcolor{comment}{//assigned to the host}
1186                \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1187                \{
1188                   flag = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1189                \}
1190             \}
1191          \}
1192       \}
1193    \}
1194 
1195    \textcolor{comment}{//Return TRUE if the specified address matches any address assigned to the host}
1196    \textcolor{keywordflow}{return} flag;
1197 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_ab10ec233f3239c6238bb4f5995543a79}\label{ipv6__misc_8c_ab10ec233f3239c6238bb4f5995543a79}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Is\+On\+Link@{ipv6\+Is\+On\+Link}}
\index{ipv6\+Is\+On\+Link@{ipv6\+Is\+On\+Link}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Is\+On\+Link()}{ipv6IsOnLink()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv6\+Is\+On\+Link (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether an I\+Pv6 address is on-\/link. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv6 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv6 address is on-\/link, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 1032 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1033 \{
1034    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1035    \hyperlink{structIpv6PrefixEntry}{Ipv6PrefixEntry} *entry;
1036 
1037    \textcolor{comment}{//Link-local prefix?}
1038    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a6f8d54c7cac75d512f6311e6f34e04ee}{ipv6IsLinkLocalUnicastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1039    \{
1040       \textcolor{comment}{//The link-local prefix is considered to be on the prefix list with}
1041       \textcolor{comment}{//an infinite invalidation timer regardless of whether routers are}
1042       \textcolor{comment}{//advertising a prefix for it}
1043       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1044    \}
1045 
1046    \textcolor{comment}{//Loop through the Prefix List}
1047    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_a928a90013c8822cded35706806f00171}{IPV6\_PREFIX\_LIST\_SIZE}; i++)
1048    \{
1049       \textcolor{comment}{//Point to the current entry}
1050       entry = &interface->ipv6Context.prefixList[i];
1051 
1052       \textcolor{comment}{//Valid prefix?}
1053       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} > 0)
1054       \{
1055          \textcolor{comment}{//Check the specified address against the prefix}
1056          \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_a6cf8eae90cab177c8b32b1bf1709952b}{ipv6CompPrefix}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}, &entry->\hyperlink{structIpv6PrefixEntry_ac8fdea2f9884d84f35af314249e47aa4}{prefix}, entry->
      \hyperlink{structIpv6PrefixEntry_a42ac450d305210faf002c0b59e0c9bc8}{prefixLen}))
1057          \{
1058             \textcolor{comment}{//The specified IPv6 address is on-link}
1059             \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1060          \}
1061       \}
1062    \}
1063 
1064    \textcolor{comment}{//The specified IPv6 address is off-link}
1065    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1066 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_af26691bb490df211ba351340016cd53c}\label{ipv6__misc_8c_af26691bb490df211ba351340016cd53c}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Is\+Tentative\+Addr@{ipv6\+Is\+Tentative\+Addr}}
\index{ipv6\+Is\+Tentative\+Addr@{ipv6\+Is\+Tentative\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Is\+Tentative\+Addr()}{ipv6IsTentativeAddr()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} ipv6\+Is\+Tentative\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr }\end{DoxyParamCaption})}



Check whether an I\+Pv6 address is a tentative address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv6 address to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if the I\+Pv6 address is a tentative address, else F\+A\+L\+SE 
\end{DoxyReturn}


Definition at line 1112 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1113 \{
1114    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1115    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
1116 
1117    \textcolor{comment}{//Loop through the list of IPv6 unicast addresses}
1118    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
1119    \{
1120       \textcolor{comment}{//Point to the current entry}
1121       entry = &interface->ipv6Context.addrList[i];
1122 
1123       \textcolor{comment}{//Tentative address?}
1124       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dacb3152ea8c90d13a425042070b987fe6}{IPV6\_ADDR\_STATE\_TENTATIVE})
1125       \{
1126          \textcolor{comment}{//Check whether the specified address matches a valid unicast}
1127          \textcolor{comment}{//address assigned to the interface}
1128          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1129          \{
1130             \textcolor{comment}{//The specified IPv6 address is a tentative address}
1131             \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1132          \}
1133       \}
1134    \}
1135 
1136    \textcolor{comment}{//The specified IPv6 address is not a tentative address}
1137    \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1138 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a453cf0d6b405a92b209956fdc99e035f}\label{ipv6__misc_8c_a453cf0d6b405a92b209956fdc99e035f}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Map\+Multicast\+Addr\+To\+Mac@{ipv6\+Map\+Multicast\+Addr\+To\+Mac}}
\index{ipv6\+Map\+Multicast\+Addr\+To\+Mac@{ipv6\+Map\+Multicast\+Addr\+To\+Mac}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Map\+Multicast\+Addr\+To\+Mac()}{ipv6MapMulticastAddrToMac()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6\+Map\+Multicast\+Addr\+To\+Mac (\begin{DoxyParamCaption}\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{ip\+Addr,  }\item[{\hyperlink{ethernet_8h_a1e00ed3977e8a770e8b4ae4cb306d1c0}{Mac\+Addr} $\ast$}]{mac\+Addr }\end{DoxyParamCaption})}



Map an I\+Pv6 multicast address to a M\+A\+C-\/layer multicast address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ip\+Addr} & I\+Pv6 multicast address \\
\hline
\mbox{\tt out}  & {\em mac\+Addr} & Corresponding M\+A\+C-\/layer multicast address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1415 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1416 \{
1417    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1418 
1419    \textcolor{comment}{//Ensure the specified IPv6 address is a multicast address}
1420    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}))
1421    \{
1422       \textcolor{comment}{//To support IPv6 multicasting, MAC address range of 33-33-00-00-00-00}
1423       \textcolor{comment}{//to 33-33-FF-FF-FF-FF is reserved (refer to RFC 2464)}
1424       macAddr->b[0] = 0x33;
1425       macAddr->b[1] = 0x33;
1426 
1427       \textcolor{comment}{//The low-order 32 bits of the IPv6 multicast address are mapped directly}
1428       \textcolor{comment}{//to the low-order 32 bits in the MAC-layer multicast address}
1429       macAddr->b[2] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[12];
1430       macAddr->b[3] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[13];
1431       macAddr->b[4] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[14];
1432       macAddr->b[5] = \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr}->b[15];
1433 
1434       \textcolor{comment}{//The specified IPv6 multicast address was successfully mapped to a}
1435       \textcolor{comment}{//MAC-layer address}
1436       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1437    \}
1438    \textcolor{keywordflow}{else}
1439    \{
1440       \textcolor{comment}{//Report an error}
1441       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
1442    \}
1443 
1444    \textcolor{comment}{//Return status code}
1445    \textcolor{keywordflow}{return} error;
1446 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_aa72b374b0dba9090d90f799776797452}\label{ipv6__misc_8c_aa72b374b0dba9090d90f799776797452}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Remove\+Addr@{ipv6\+Remove\+Addr}}
\index{ipv6\+Remove\+Addr@{ipv6\+Remove\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Remove\+Addr()}{ipv6RemoveAddr()}}
{\footnotesize\ttfamily void ipv6\+Remove\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{addr }\end{DoxyParamCaption})}



Remove an entry from the list of I\+Pv6 addresses. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em addr} & I\+Pv6 address \\
\hline
\end{DoxyParams}


Definition at line 334 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
335 \{
336    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
337    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
338 
339    \textcolor{comment}{//Loop through the list of IPv6 addresses assigned to the interface}
340    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; i++)
341    \{
342       \textcolor{comment}{//Point to the current entry}
343       entry = &interface->ipv6Context.addrList[i];
344 
345       \textcolor{comment}{//Valid IPv6 address?}
346       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ab56a11d9de06327ab5af04e8ae18164d}{validLifetime})
347       \{
348          \textcolor{comment}{//Check whether the current entry matches the specified address}
349          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}))
350          \{
351             \textcolor{comment}{//The IPv6 address should be preserved if it has been manually assigned}
352             \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6AddrEntry_a196db6647dd1196a1c3a06c8a4083a48}{permanent})
353             \{
354                \textcolor{comment}{//Remove the IPv6 address from the list}
355                \hyperlink{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}{ipv6SetAddr}(interface, i, &\hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR},
356                   \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID}, 0, 0, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
357             \}
358          \}
359       \}
360    \}
361 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_ad2b66051e8b53dffa4aba62f2241e2d1}\label{ipv6__misc_8c_ad2b66051e8b53dffa4aba62f2241e2d1}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Remove\+Default\+Router@{ipv6\+Remove\+Default\+Router}}
\index{ipv6\+Remove\+Default\+Router@{ipv6\+Remove\+Default\+Router}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Remove\+Default\+Router()}{ipv6RemoveDefaultRouter()}}
{\footnotesize\ttfamily void ipv6\+Remove\+Default\+Router (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{addr }\end{DoxyParamCaption})}



Remove an entry from the Default Router List. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em addr} & I\+Pv6 address of the router to be removed from the list \\
\hline
\end{DoxyParams}


Definition at line 590 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
591 \{
592    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
593    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} flag;
594    \hyperlink{structIpv6RouterEntry}{Ipv6RouterEntry} *entry;
595 
596    \textcolor{comment}{//This flag will be set if any entry has been removed from}
597    \textcolor{comment}{//the Default Router List}
598    flag = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
599 
600    \textcolor{comment}{//Loop through the Default Router List}
601    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_af61cd2a89ea067f9ecd5a7f7d9649bba}{IPV6\_ROUTER\_LIST\_SIZE}; i++)
602    \{
603       \textcolor{comment}{//Point to the current entry}
604       entry = &interface->ipv6Context.routerList[i];
605 
606       \textcolor{comment}{//Check the lifetime associated with the default router}
607       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6RouterEntry_aed560238a63f534a2cecaf1c5eea614c}{lifetime})
608       \{
609          \textcolor{comment}{//Check whether the current entry matches the specified router address}
610          \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6RouterEntry_ae229e171486421953e178c27b8527789}{addr}, \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}))
611          \{
612             \textcolor{comment}{//The router address should be preserved if it has been manually assigned}
613             \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6RouterEntry_a9b423514103cfe737922334c5f0d9ff2}{permanent})
614             \{
615                \textcolor{comment}{//Immediately time-out the entry}
616                entry->\hyperlink{structIpv6RouterEntry_ae229e171486421953e178c27b8527789}{addr} = \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR};
617                entry->\hyperlink{structIpv6RouterEntry_aed560238a63f534a2cecaf1c5eea614c}{lifetime} = 0;
618 
619                \textcolor{comment}{//Set flag}
620                flag = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
621             \}
622          \}
623       \}
624    \}
625 
626    \textcolor{comment}{//Check whether an entry has been removed from the list}
627    \textcolor{keywordflow}{if}(flag)
628    \{
629 \textcolor{preprocessor}{#if (NDP\_SUPPORT == ENABLED)}
630       \textcolor{comment}{//When removing a router from the Default Router list, the node must}
631       \textcolor{comment}{//update the Destination Cache in such a way that all entries using}
632       \textcolor{comment}{//the router perform next-hop determination again}
633       \hyperlink{ndp__cache_8c_a37506956e2aa6b664eef6acf9137e9ef}{ndpFlushDestCache}(interface);
634 \textcolor{preprocessor}{#endif}
635    \}
636 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_abfcbbca4428fa3b858e1e4e8f5bb8b1c}\label{ipv6__misc_8c_abfcbbca4428fa3b858e1e4e8f5bb8b1c}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Remove\+Prefix@{ipv6\+Remove\+Prefix}}
\index{ipv6\+Remove\+Prefix@{ipv6\+Remove\+Prefix}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Remove\+Prefix()}{ipv6RemovePrefix()}}
{\footnotesize\ttfamily void ipv6\+Remove\+Prefix (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{prefix,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{length }\end{DoxyParamCaption})}



Remove an entry from the Prefix List. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em prefix} & I\+Pv6 prefix \\
\hline
\mbox{\tt in}  & {\em length} & The number of leading bits in the prefix that are valid \\
\hline
\end{DoxyParams}


Definition at line 480 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
482 \{
483    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
484    \hyperlink{structIpv6PrefixEntry}{Ipv6PrefixEntry} *entry;
485 
486    \textcolor{comment}{//Loop through the Prefix List}
487    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{ipv6_8h_a928a90013c8822cded35706806f00171}{IPV6\_PREFIX\_LIST\_SIZE}; i++)
488    \{
489       \textcolor{comment}{//Point to the current entry}
490       entry = &interface->ipv6Context.prefixList[i];
491 
492       \textcolor{comment}{//Valid prefix?}
493       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime})
494       \{
495          \textcolor{comment}{//Compare prefix length against the specified value}
496          \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6PrefixEntry_a42ac450d305210faf002c0b59e0c9bc8}{prefixLen} == \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
497          \{
498             \textcolor{comment}{//Check whether the current entry matches the specified prefix}
499             \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_a6cf8eae90cab177c8b32b1bf1709952b}{ipv6CompPrefix}(&entry->\hyperlink{structIpv6PrefixEntry_ac8fdea2f9884d84f35af314249e47aa4}{prefix}, \hyperlink{dhcpv6__common_8h_a82020d9f611b297873f5caeecb4e93c1}{prefix}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}))
500             \{
501                \textcolor{comment}{//The IPv6 prefix should be preserved if it has been manually assigned}
502                \textcolor{keywordflow}{if}(!entry->\hyperlink{structIpv6PrefixEntry_a9f6301283cb4b3a6d2e3ffeed9e68f90}{permanent})
503                \{
504                   \textcolor{comment}{//When removing an entry from the Prefix List, there is no need}
505                   \textcolor{comment}{//to purge any entries from the Destination or Neighbor Caches}
506                   entry->\hyperlink{structIpv6PrefixEntry_ac8fdea2f9884d84f35af314249e47aa4}{prefix} = \hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR};
507                   entry->\hyperlink{structIpv6PrefixEntry_a42ac450d305210faf002c0b59e0c9bc8}{prefixLen} = 0;
508                   entry->\hyperlink{structIpv6PrefixEntry_aa60a2863be803fd4a40d40443ecb96f8}{validLifetime} = 0;
509                \}
510             \}
511          \}
512       \}
513    \}
514 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a1d69e11a455ee8895ec67061f554a174}\label{ipv6__misc_8c_a1d69e11a455ee8895ec67061f554a174}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Select\+Source\+Addr@{ipv6\+Select\+Source\+Addr}}
\index{ipv6\+Select\+Source\+Addr@{ipv6\+Select\+Source\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Select\+Source\+Addr()}{ipv6SelectSourceAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6\+Select\+Source\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$$\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{dest\+Addr,  }\item[{\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{src\+Addr }\end{DoxyParamCaption})}



I\+Pv6 source address selection. 

This function selects the source address and the relevant network interface to be used in order to join the specified destination address


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em interface} & A pointer to a valid network interface may be provided as a hint. The function returns a pointer identifying the interface to be used \\
\hline
\mbox{\tt in}  & {\em dest\+Addr} & Destination I\+Pv6 address \\
\hline
\mbox{\tt out}  & {\em src\+Addr} & Local I\+Pv6 address to be used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 882 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
884 \{
885    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
886    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
887    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
888    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *currentInterface;
889    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *bestInterface;
890    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *currentAddr;
891    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *bestAddr;
892 
893    \textcolor{comment}{//Initialize variables}
894    bestInterface = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
895    bestAddr = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
896 
897    \textcolor{comment}{//Loop through network interfaces}
898    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{net_8h_a116f850ebcb023ffa3e6b8de10c5cb35}{NET\_INTERFACE\_COUNT}; i++)
899    \{
900       \textcolor{comment}{//Point to the current interface}
901       currentInterface = &\hyperlink{net_8c_a7ecafab0039ec54d1d7a1e9e7402379b}{netInterface}[i];
902 
903       \textcolor{comment}{//A network interface may be provided as a hint}
904       \textcolor{keywordflow}{if}(*interface != currentInterface && *interface != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
905       \{
906          \textcolor{comment}{//Select the next interface in the list}
907          \textcolor{keywordflow}{continue};
908       \}
909 
910       \textcolor{comment}{//A sort of the candidate source addresses is being performed, where a}
911       \textcolor{comment}{//set of rules define the ordering among addresses (refer to RFC 6724)}
912       \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE}; j++)
913       \{
914          \textcolor{comment}{//Point to the current entry}
915          currentAddr = &currentInterface->ipv6Context.addrList[j];
916 
917          \textcolor{comment}{//Check the state of the address}
918          \textcolor{keywordflow}{if}(currentAddr->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED} ||
919             currentAddr->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518da4cd161ce2c979312f91a8f3e946acec6}{IPV6\_ADDR\_STATE\_DEPRECATED})
920          \{
921             \textcolor{comment}{//Select the first address as default}
922             \textcolor{keywordflow}{if}(bestAddr == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
923             \{
924                \textcolor{comment}{//Give the current source address the higher precedence}
925                bestInterface = currentInterface;
926                bestAddr = currentAddr;
927 
928                \textcolor{comment}{//Select the next address in the list}
929                \textcolor{keywordflow}{continue};
930             \}
931 
932             \textcolor{comment}{//Rule 1: Prefer same address}
933             \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&bestAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
934             \{
935                \textcolor{comment}{//Select the next address in the list}
936                \textcolor{keywordflow}{continue};
937             \}
938             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&currentAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
939             \{
940                \textcolor{comment}{//Give the current source address the higher precedence}
941                bestInterface = currentInterface;
942                bestAddr = currentAddr;
943 
944                \textcolor{comment}{//Select the next address in the list}
945                \textcolor{keywordflow}{continue};
946             \}
947 
948             \textcolor{comment}{//Rule 2: Prefer appropriate scope}
949             \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(&currentAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}) < 
      \hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(&bestAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}))
950             \{
951                \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(&currentAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}) >= 
      \hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(\hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
952                \{
953                   \textcolor{comment}{//Give the current source address the higher precedence}
954                   bestInterface = currentInterface;
955                   bestAddr = currentAddr;
956                \}
957 
958                \textcolor{comment}{//Select the next address in the list}
959                \textcolor{keywordflow}{continue};
960             \}
961             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(&bestAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}) < 
      \hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(&currentAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}))
962             \{
963                \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(&bestAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}) < 
      \hyperlink{ipv6__misc_8c_ae8e5c6bac9c8898bc4b3486777f24bd2}{ipv6GetAddrScope}(\hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
964                \{
965                   \textcolor{comment}{//Give the current source address the higher precedence}
966                   bestInterface = currentInterface;
967                   bestAddr = currentAddr;
968                \}
969 
970                \textcolor{comment}{//Select the next address in the list}
971                \textcolor{keywordflow}{continue};
972             \}
973 
974             \textcolor{comment}{//Rule 3: Avoid deprecated addresses}
975             \textcolor{keywordflow}{if}(bestAddr->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED} &&
976                currentAddr->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518da4cd161ce2c979312f91a8f3e946acec6}{IPV6\_ADDR\_STATE\_DEPRECATED})
977             \{
978                \textcolor{comment}{//Select the next address in the list}
979                \textcolor{keywordflow}{continue};
980             \}
981             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(currentAddr->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518daaa3a0ce422a678d8eb14a36f4c642d16}{IPV6\_ADDR\_STATE\_PREFERRED} &&
982                bestAddr->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} == \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518da4cd161ce2c979312f91a8f3e946acec6}{IPV6\_ADDR\_STATE\_DEPRECATED})
983             \{
984                \textcolor{comment}{//Give the current source address the higher precedence}
985                bestInterface = currentInterface;
986                bestAddr = currentAddr;
987 
988                \textcolor{comment}{//Select the next address in the list}
989                \textcolor{keywordflow}{continue};
990             \}
991 
992             \textcolor{comment}{//Rule 8: Use longest matching prefix}
993             \textcolor{keywordflow}{if}(\hyperlink{ipv6__misc_8c_a2e1598bb456416398fd8d4f5754dc746}{ipv6GetCommonPrefixLength}(&currentAddr->
      \hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}) >
994                \hyperlink{ipv6__misc_8c_a2e1598bb456416398fd8d4f5754dc746}{ipv6GetCommonPrefixLength}(&bestAddr->
      \hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, \hyperlink{ethernet_8h_a00f00b33d6300737183211cc435fa7e2}{destAddr}))
995             \{
996                \textcolor{comment}{//Give the current source address the higher precedence}
997                bestInterface = currentInterface;
998                bestAddr = currentAddr;
999             \}
1000          \}
1001       \}
1002    \}
1003 
1004    \textcolor{comment}{//Valid source address?}
1005    \textcolor{keywordflow}{if}(bestAddr != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1006    \{
1007       \textcolor{comment}{//Return the out-going interface and the source address to be used}
1008       *\textcolor{keyword}{interface }= bestInterface;
1009       *\hyperlink{ethernet_8h_a522a68dc3582289088de6b36018e9ea0}{srcAddr} = bestAddr->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr};
1010 
1011       \textcolor{comment}{//Successful source address selection}
1012       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1013    \}
1014    \textcolor{keywordflow}{else}
1015    \{
1016       \textcolor{comment}{//Report an error}
1017       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab341b466f058a1fcda38ae5afe2d23c2}{ERROR\_NO\_ADDRESS};
1018    \}
1019 
1020    \textcolor{comment}{//Return status code}
1021    \textcolor{keywordflow}{return} error;
1022 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}\label{ipv6__misc_8c_a260c329b0f6deb7be88e6ee7a1003063}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Set\+Addr@{ipv6\+Set\+Addr}}
\index{ipv6\+Set\+Addr@{ipv6\+Set\+Addr}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Set\+Addr()}{ipv6SetAddr()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6\+Set\+Addr (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{index,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{addr,  }\item[{\hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518d}{Ipv6\+Addr\+State}}]{state,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{valid\+Lifetime,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{preferred\+Lifetime,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{permanent }\end{DoxyParamCaption})}



Set I\+Pv6 address and address state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Pointer to the desired network interface \\
\hline
\mbox{\tt in}  & {\em index} & Zero-\/based index \\
\hline
\mbox{\tt in}  & {\em addr} & I\+Pv6 address \\
\hline
\mbox{\tt in}  & {\em state} & State of the I\+Pv6 address \\
\hline
\mbox{\tt in}  & {\em valid\+Lifetime} & Valid lifetime \\
\hline
\mbox{\tt in}  & {\em preferred\+Lifetime} & Preferred lifetime \\
\hline
\mbox{\tt in}  & {\em permanent} & Permanently assigned address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 95 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
98 \{
99    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
100    \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{NetInterface} *physicalInterface;
101    \hyperlink{structIpv6AddrEntry}{Ipv6AddrEntry} *entry;
102    \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr} solicitedNodeAddr;
103 
104    \textcolor{comment}{//Check parameters}
105    \textcolor{keywordflow}{if}(interface == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
106       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
107 
108    \textcolor{comment}{//Make sure that the index is valid}
109    \textcolor{keywordflow}{if}(index >= \hyperlink{ipv6_8h_aa9064306086cc3bba39cf75db3ec2881}{IPV6\_ADDR\_LIST\_SIZE})
110       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca796107c17e41c601d633f670e5e29800}{ERROR\_OUT\_OF\_RANGE};
111 
112    \textcolor{comment}{//The IPv6 address must be a valid unicast address}
113    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}))
114       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca21cbabf2c791471c05a9bc2710638aec}{ERROR\_INVALID\_ADDRESS};
115 
116    \textcolor{comment}{//Initialize status code}
117    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
118 
119    \textcolor{comment}{//Point to the physical interface}
120    physicalInterface = \hyperlink{nic_8c_aa8f48265895dab1633056c2dcd796355}{nicGetPhysicalInterface}(interface);
121 
122    \textcolor{comment}{//Point to the corresponding entry}
123    entry = &interface->ipv6Context.addrList[index];
124 
125    \textcolor{comment}{//Check whether an IPv6 address is already assigned}
126    \textcolor{keywordflow}{if}(!\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(&entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, &\hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR}))
127    \{
128       \textcolor{comment}{//Check the state of the IPv6 address}
129       \textcolor{keywordflow}{if}(entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} != \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID})
130       \{
131          \textcolor{comment}{//Ethernet interface?}
132          \textcolor{keywordflow}{if}(physicalInterface->nicDriver != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
133             physicalInterface->nicDriver->type == \hyperlink{nic_8h_ac1ce8659a9797513ecd9cc1afedce40ba84802cab6ee937691c3d76122ffaffcd}{NIC\_TYPE\_ETHERNET})
134          \{
135             \textcolor{comment}{//Form the Solicited-Node address}
136             \hyperlink{ipv6__misc_8c_a6ae7a7bdd0009e5dcb63267ed1cf9c88}{ipv6ComputeSolicitedNodeAddr}(&entry->
      \hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr}, &solicitedNodeAddr);
137             \textcolor{comment}{//Leave the Solicited-Node multicast group}
138             \hyperlink{ipv6_8c_a803fc8d3c2db73c8fa1f6bb4ee7abde4}{ipv6LeaveMulticastGroup}(interface, &solicitedNodeAddr);
139          \}
140       \}
141    \}
142 
143    \textcolor{comment}{//The current IPv6 address is no more valid}
144    entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} = \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID};
145    entry->\hyperlink{structIpv6AddrEntry_ab56a11d9de06327ab5af04e8ae18164d}{validLifetime} = 0;
146    entry->\hyperlink{structIpv6AddrEntry_a4d368a125e163baf554e7622edff555f}{preferredLifetime} = 0;
147    entry->\hyperlink{structIpv6AddrEntry_a196db6647dd1196a1c3a06c8a4083a48}{permanent} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
148 
149    \textcolor{comment}{//Assign the new IPv6 address}
150    entry->\hyperlink{structIpv6AddrEntry_a55b2d1238731a3b4ffca6928ebb52fe0}{addr} = *\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr};
151 
152    \textcolor{comment}{//Check whether the new IPv6 address is valid}
153    \textcolor{keywordflow}{if}(!\hyperlink{ipv6_8h_ab1e93bd2152bc3f3b5642fd0216384d7}{ipv6CompAddr}(\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, &\hyperlink{ipv6_8c_aa4baeec4f7b8b166d2457787fb9eddf9}{IPV6\_UNSPECIFIED\_ADDR}))
154    \{
155       \textcolor{comment}{//Check the state of the IPv6 address}
156       \textcolor{keywordflow}{if}(state != \hyperlink{ipv6_8h_acb54c5e2b7ee1652f5bf055e14cc518dabdf9e5bbd4cc04a803d6e63cc9992ebb}{IPV6\_ADDR\_STATE\_INVALID})
157       \{
158          \textcolor{comment}{//Ethernet interface?}
159          \textcolor{keywordflow}{if}(physicalInterface->nicDriver != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
160             physicalInterface->nicDriver->type == \hyperlink{nic_8h_ac1ce8659a9797513ecd9cc1afedce40ba84802cab6ee937691c3d76122ffaffcd}{NIC\_TYPE\_ETHERNET})
161          \{
162             \textcolor{comment}{//Form the Solicited-Node address for the link-local address}
163             \hyperlink{ipv6__misc_8c_a6ae7a7bdd0009e5dcb63267ed1cf9c88}{ipv6ComputeSolicitedNodeAddr}(\hyperlink{nbns__common_8h_ac597eaa9711dfbc34f49d506132e85cd}{addr}, &solicitedNodeAddr);
164             \textcolor{comment}{//Join the Solicited-Node multicast group for each assigned address}
165             error = \hyperlink{ipv6_8c_abbf3683ee76a53fdf931e58fabe6db6f}{ipv6JoinMulticastGroup}(interface, &solicitedNodeAddr);
166          \}
167          \textcolor{comment}{//6LoWPAN interface?}
168          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(interface->nicDriver != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
169             interface->nicDriver->type == \hyperlink{nic_8h_ac1ce8659a9797513ecd9cc1afedce40ba5b85ff07103ab20b9b081b4b263619ea}{NIC\_TYPE\_6LOWPAN})
170          \{
171             \textcolor{comment}{//There is no need to join the solicited-node multicast address,}
172             \textcolor{comment}{//since nobody multicasts Neighbor Solicitations in this type of}
173             \textcolor{comment}{//network (refer to RFC 6775 section 5.2)}
174          \}
175       \}
176 
177       \textcolor{comment}{//Check status code}
178       \textcolor{keywordflow}{if}(!error)
179       \{
180          \textcolor{comment}{//Set the state of the IPv6 address}
181          entry->\hyperlink{structIpv6AddrEntry_ae4ce939ceef8a1d15ac7d11542215a0f}{state} = state;
182 
183          \textcolor{comment}{//Clear duplicate flag}
184          entry->\hyperlink{structIpv6AddrEntry_aebcce0d3eff51b7c413e43ec5bf86282}{duplicate} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
185 
186          \textcolor{comment}{//Save preferred and valid lifetimes}
187          entry->\hyperlink{structIpv6AddrEntry_a4d368a125e163baf554e7622edff555f}{preferredLifetime} = \hyperlink{dhcpv6__common_8h_a40bac1e80f1005d8d5045ec837d1429b}{preferredLifetime};
188          entry->\hyperlink{structIpv6AddrEntry_ab56a11d9de06327ab5af04e8ae18164d}{validLifetime} = \hyperlink{dhcpv6__common_8h_a6bcd95080db3b3f2265498723b93d7b2}{validLifetime};
189 
190          \textcolor{comment}{//Set time stamp}
191          entry->\hyperlink{structIpv6AddrEntry_a9080e69e7dc724704176843cdadfb29b}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
192 
193          \textcolor{comment}{//Initialize DAD related variables}
194          entry->\hyperlink{structIpv6AddrEntry_ae1f2402bd716fae570c797064da15807}{dadTimeout} = 0;
195          entry->\hyperlink{structIpv6AddrEntry_ade9430db97130475d7b1ea5f9b1880e0}{dadRetransmitCount} = 0;
196       \}
197 
198       \textcolor{comment}{//This flag tells whether the IPv6 address should be permanently assigned}
199       entry->\hyperlink{structIpv6AddrEntry_a196db6647dd1196a1c3a06c8a4083a48}{permanent} = permanent;
200    \}
201 
202 \textcolor{preprocessor}{#if (MDNS\_RESPONDER\_SUPPORT == ENABLED)}
203    \textcolor{comment}{//Link-local address?}
204    \textcolor{keywordflow}{if}(index == 0)
205    \{
206       \textcolor{comment}{//Restart mDNS probing process}
207       \hyperlink{mdns__responder_8c_ad0aa26e45ce7db6737cb978d4fedea0a}{mdnsResponderStartProbing}(interface->mdnsResponderContext);
208    \}
209 \textcolor{preprocessor}{#endif}
210 
211    \textcolor{comment}{//Return status code}
212    \textcolor{keywordflow}{return} error;
213 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a53daa831ff5d6b2691442ace4fc832cd}\label{ipv6__misc_8c_a53daa831ff5d6b2691442ace4fc832cd}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Update\+In\+Stats@{ipv6\+Update\+In\+Stats}}
\index{ipv6\+Update\+In\+Stats@{ipv6\+Update\+In\+Stats}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Update\+In\+Stats()}{ipv6UpdateInStats()}}
{\footnotesize\ttfamily void ipv6\+Update\+In\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{dest\+Ip\+Addr,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update I\+Pv6 input statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Ip\+Addr} & Destination IP address \\
\hline
\mbox{\tt in}  & {\em length} & Length of the incoming IP packet \\
\hline
\end{DoxyParams}


Definition at line 1477 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1479 \{
1480    \textcolor{comment}{//Check whether the destination address is a unicast or multicast address}
1481    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr}))
1482    \{
1483       \textcolor{comment}{//Number of IP multicast datagrams transmitted}
1484       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6SystemStats.ipSystemStatsInMcastPkts, 1);
1485       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6SystemStats.ipSystemStatsHCInMcastPkts, 1);
1486       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6IfStatsTable[interface->index].ipIfStatsInMcastPkts, 1);
1487       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6IfStatsTable[interface->index].ipIfStatsHCInMcastPkts, 1
      );
1488 
1489       \textcolor{comment}{//Total number of octets transmitted in IP multicast datagrams}
1490       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6SystemStats.ipSystemStatsInMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1491       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6SystemStats.ipSystemStatsHCInMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1492       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6IfStatsTable[interface->index].ipIfStatsInMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1493       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6IfStatsTable[interface->index].ipIfStatsHCInMcastOctets,
       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1494    \}
1495 \}
\end{DoxyCode}
\mbox{\Hypertarget{ipv6__misc_8c_a85a88896558084d85128a3e998df8936}\label{ipv6__misc_8c_a85a88896558084d85128a3e998df8936}} 
\index{ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}!ipv6\+Update\+Out\+Stats@{ipv6\+Update\+Out\+Stats}}
\index{ipv6\+Update\+Out\+Stats@{ipv6\+Update\+Out\+Stats}!ipv6\+\_\+misc.\+c@{ipv6\+\_\+misc.\+c}}
\subsubsection{\texorpdfstring{ipv6\+Update\+Out\+Stats()}{ipv6UpdateOutStats()}}
{\footnotesize\ttfamily void ipv6\+Update\+Out\+Stats (\begin{DoxyParamCaption}\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface,  }\item[{const \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6\+Addr} $\ast$}]{dest\+Ip\+Addr,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update I\+Pv6 output statistics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em interface} & Underlying network interface \\
\hline
\mbox{\tt in}  & {\em dest\+Ip\+Addr} & Destination IP address \\
\hline
\mbox{\tt in}  & {\em length} & Length of the outgoing IP packet \\
\hline
\end{DoxyParams}


Definition at line 1505 of file ipv6\+\_\+misc.\+c.


\begin{DoxyCode}
1507 \{
1508    \textcolor{comment}{//Check whether the destination address is a unicast or multicast address}
1509    \textcolor{keywordflow}{if}(\hyperlink{ipv6_8h_a68fbc1145d242384c90a670196a38495}{ipv6IsMulticastAddr}(\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{destIpAddr}))
1510    \{
1511       \textcolor{comment}{//Number of IP multicast datagrams transmitted}
1512       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6SystemStats.ipSystemStatsOutMcastPkts, 1);
1513       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6SystemStats.ipSystemStatsHCOutMcastPkts, 1);
1514       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6IfStatsTable[interface->index].ipIfStatsOutMcastPkts, 1)
      ;
1515       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6IfStatsTable[interface->index].ipIfStatsHCOutMcastPkts, 
      1);
1516 
1517       \textcolor{comment}{//Total number of octets transmitted in IP multicast datagrams}
1518       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6SystemStats.ipSystemStatsOutMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1519       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6SystemStats.ipSystemStatsHCOutMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1520       \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6IfStatsTable[interface->index].ipIfStatsOutMcastOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1521       \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6IfStatsTable[interface->index].ipIfStatsHCOutMcastOctets
      , \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1522    \}
1523 
1524    \textcolor{comment}{//Total number of IP datagrams that this entity supplied to the lower}
1525    \textcolor{comment}{//layers for transmission}
1526    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6SystemStats.ipSystemStatsOutTransmits, 1);
1527    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6SystemStats.ipSystemStatsHCOutTransmits, 1);
1528    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6IfStatsTable[interface->index].ipIfStatsOutTransmits, 1);
1529    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6IfStatsTable[interface->index].ipIfStatsHCOutTransmits, 1);
1530 
1531    \textcolor{comment}{//Total number of octets in IP datagrams delivered to the lower layers}
1532    \textcolor{comment}{//for transmission}
1533    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6SystemStats.ipSystemStatsOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1534    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6SystemStats.ipSystemStatsHCOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1535    \hyperlink{ip__mib__module_8h_abbb1f41624dcbd4f21b44932e338a479}{IP\_MIB\_INC\_COUNTER32}(ipv6IfStatsTable[interface->index].ipIfStatsOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1536    \hyperlink{ip__mib__module_8h_a008063c082eeb6234658e6b81ed69e4f}{IP\_MIB\_INC\_COUNTER64}(ipv6IfStatsTable[interface->index].ipIfStatsHCOutOctets, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1537 \}
\end{DoxyCode}
