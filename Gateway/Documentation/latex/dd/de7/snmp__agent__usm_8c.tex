\hypertarget{snmp__agent__usm_8c}{}\section{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+usm.c File Reference}
\label{snmp__agent__usm_8c}\index{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+usm.\+c@{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+usm.\+c}}


User-\/based Security Model (U\+SM) for S\+N\+M\+Pv3.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent\+\_\+usm.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mac/hmac.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{snmp__agent__usm_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$ \hyperlink{snmp__agent__usm_8c_aa834b11d54972a9deb6af7253f99a541}{snmp\+Create\+User\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Create a new user entry. \end{DoxyCompactList}\item 
\hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$ \hyperlink{snmp__agent__usm_8c_adb4ad71f3b5167a13a2551f075c25110}{snmp\+Find\+User\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Search the user table for a given user name. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_a3e019f63dd6f8a7287e5e0125526b755}{snmp\+Generate\+Key} (\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol} auth\+Protocol, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$password, \hyperlink{structSnmpKey}{Snmp\+Key} $\ast$key)
\begin{DoxyCompactList}\small\item\em Password to key algorithm. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_a169a3d5db383131661599d6b19d81ee5}{snmp\+Localize\+Key} (\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol} auth\+Protocol, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$engine\+Id, size\+\_\+t engine\+Id\+Len, \hyperlink{structSnmpKey}{Snmp\+Key} $\ast$key, \hyperlink{structSnmpKey}{Snmp\+Key} $\ast$localized\+Key)
\begin{DoxyCompactList}\small\item\em Key localization algorithm. \end{DoxyCompactList}\item 
void \hyperlink{snmp__agent__usm_8c_a1555f6ee258f6dfef2f9d11f95560a39}{snmp\+Change\+Key} (const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$hash\+Algo, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tls13__misc_8h_a6120afe912430104573286fe328768c9}{random}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{coap__common_8h_ab90adf2873f721fb4a969230dbcd7a59}{delta}, \hyperlink{structSnmpKey}{Snmp\+Key} $\ast$key)
\begin{DoxyCompactList}\small\item\em Change secret key. \end{DoxyCompactList}\item 
void \hyperlink{snmp__agent__usm_8c_a7a2163b21b2086dba7259a5aaea7c3fd}{snmp\+Clone\+Security\+Parameters} (\hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$user, const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$clone\+From\+User)
\begin{DoxyCompactList}\small\item\em Clone security parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_aaa271cb3fa3eb1fd53dbb92b5bd2d7b3}{snmp\+Check\+Security\+Parameters} (const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$user, \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$engine\+Id, size\+\_\+t engine\+Id\+Len)
\begin{DoxyCompactList}\small\item\em Check security parameters. \end{DoxyCompactList}\item 
void \hyperlink{snmp__agent__usm_8c_a68a80c798e29b1410db2a383af9e8876}{snmp\+Refresh\+Engine\+Time} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Refresh S\+N\+MP engine time. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_a4b77fa76e0bb98081df95572a83b4a4f}{snmp\+Check\+Engine\+Time} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Replay protection. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_ac995a1d7cfdf5f25efd29f7e5c1f7c0d}{snmp\+Auth\+Outgoing\+Message} (const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$user, \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Authenticate outgoing S\+N\+MP message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_a9b21dc4a7bbfee3d20fd1ef593d3b720}{snmp\+Auth\+Incoming\+Message} (const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$user, \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Authenticate incoming S\+N\+MP message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_a3cb6959af6963c5f5d593a28e7f72ee7}{snmp\+Encrypt\+Data} (const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$user, \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} $\ast$salt)
\begin{DoxyCompactList}\small\item\em Data encryption. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__usm_8c_a65bdcc2539a5a0b1d30fb1f33405fc5f}{snmp\+Decrypt\+Data} (const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$user, \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message})
\begin{DoxyCompactList}\small\item\em Data decryption. \end{DoxyCompactList}\item 
const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$ \hyperlink{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}{snmp\+Get\+Hash\+Algo} (\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol} auth\+Protocol)
\begin{DoxyCompactList}\small\item\em Get the hash algorithm to be used for a given authentication protocol. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{snmp__agent__usm_8c_a4cfaee41833a90ca96cd8c6d2f945a50}{snmp\+Get\+Mac\+Length} (\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol} auth\+Protocol)
\begin{DoxyCompactList}\small\item\em Get the length of the truncated M\+AC for a given authentication protocol. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{snmp__agent__usm_8c_a5d76db11e21399c72fd61262f5e6e612}{usm\+Stats\+Unsupported\+Sec\+Levels\+Object} \mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 1, 0\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{snmp__agent__usm_8c_a6478c64a4ad158f78f425c05bdb04de2}{usm\+Stats\+Not\+In\+Time\+Windows\+Object} \mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 2, 0\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{snmp__agent__usm_8c_a28a41d2c18565ef5cf40dbaa5e722f9e}{usm\+Stats\+Unknown\+User\+Names\+Object} \mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 3, 0\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{snmp__agent__usm_8c_a951a44e648083d6ca8c598b66d2c9e95}{usm\+Stats\+Unknown\+Engine\+Ids\+Object} \mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 4, 0\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{snmp__agent__usm_8c_ae5a8d4dd03f5da308589c11989af6b71}{usm\+Stats\+Wrong\+Digests\+Object} \mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 5, 0\}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{snmp__agent__usm_8c_ab7cb3fcbc10139e322fd5764fc476b83}{usm\+Stats\+Decryption\+Errors\+Object} \mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 6, 0\}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
User-\/based Security Model (U\+SM) for S\+N\+M\+Pv3. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
This module implements the User-\/based Security Model (U\+SM) for Simple Network Management Protocol (S\+N\+MP) version 3. Refer to the following R\+F\+Cs for complete details\+:
\begin{DoxyItemize}
\item R\+FC 3414\+: User-\/based Security Model (U\+SM) for S\+N\+M\+Pv3
\item R\+FC 3826\+: A\+ES Cipher Algorithm in the S\+N\+MP User-\/based Security Model
\item R\+FC 7860\+: H\+M\+A\+C-\/\+S\+H\+A-\/2 Authentication Protocols in the User-\/based Security Model
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{snmp__agent__usm_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{snmp__agent__usm_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 41 of file snmp\+\_\+agent\+\_\+usm.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{snmp__agent__usm_8c_a9b21dc4a7bbfee3d20fd1ef593d3b720}\label{snmp__agent__usm_8c_a9b21dc4a7bbfee3d20fd1ef593d3b720}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Auth\+Incoming\+Message@{snmp\+Auth\+Incoming\+Message}}
\index{snmp\+Auth\+Incoming\+Message@{snmp\+Auth\+Incoming\+Message}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Auth\+Incoming\+Message()}{snmpAuthIncomingMessage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Auth\+Incoming\+Message (\begin{DoxyParamCaption}\item[{const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{user,  }\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Authenticate incoming S\+N\+MP message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em user} & Security profile of the user \\
\hline
\mbox{\tt in}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 509 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
510 \{
511    \textcolor{keyword}{const} \hyperlink{structHashAlgo}{HashAlgo} *hashAlgo;
512    \textcolor{keywordtype}{size\_t} macLen;
513    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} mac[\hyperlink{snmp__agent__usm_8h_a8207ee3afd609015a78305cf676a5d50}{SNMP\_MAX\_TRUNCATED\_MAC\_SIZE}];
514    \hyperlink{structHmacContext}{HmacContext} hmacContext;
515 
516    \textcolor{comment}{//Get the hash algorithm to be used for HMAC computation}
517    hashAlgo = \hyperlink{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}{snmpGetHashAlgo}(user->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol});
518 
519    \textcolor{comment}{//Invalid authentication protocol?}
520    \textcolor{keywordflow}{if}(hashAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
521       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca87e6ef81b46229cb03ed0a27e7f45c6e}{ERROR\_AUTHENTICATION\_FAILED};
522 
523    \textcolor{comment}{//Retrieve the length of the truncated MAC}
524    macLen = \hyperlink{snmp__agent__usm_8c_a4cfaee41833a90ca96cd8c6d2f945a50}{snmpGetMacLength}(user->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol});
525 
526    \textcolor{comment}{//Check the length of the msgAuthenticationParameters field}
527    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} != macLen)
528       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca87e6ef81b46229cb03ed0a27e7f45c6e}{ERROR\_AUTHENTICATION\_FAILED};
529 
530    \textcolor{comment}{//The MAC received in the msgAuthenticationParameters field is saved}
531    memcpy(mac, message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters}, macLen);
532 
533    \textcolor{comment}{//The digest in the msgAuthenticationParameters field is replaced by}
534    \textcolor{comment}{//a null octet string}
535    memset(message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters}, 0, macLen);
536 
537    \textcolor{comment}{//The MAC is calculated over the whole message}
538    \hyperlink{hmac_8c_ac4ecc520cae02c1b9bbb3651758a703e}{hmacInit}(&hmacContext, hashAlgo, user->\hyperlink{structSnmpUserEntry_abe989af09e827849ce740a3813edcbc7}{localizedAuthKey}.
      \hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}, hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
539    \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(&hmacContext, message->\hyperlink{structSnmpMessage_a60405510f10de109ac78bf7ae8427f24}{buffer}, message->\hyperlink{structSnmpMessage_a02cd31ab221cd718f39cf8621f98c0b6}{bufferLen});
540    \hyperlink{hmac_8c_a387906ffc55755df380361c43ce0bd6a}{hmacFinal}(&hmacContext, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
541 
542    \textcolor{comment}{//Restore the value of the msgAuthenticationParameters field}
543    memcpy(message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters}, mac, macLen);
544 
545    \textcolor{comment}{//The newly calculated MAC is compared with the MAC value that was}
546    \textcolor{comment}{//saved in the first step}
547    \textcolor{keywordflow}{if}(memcmp(hmacContext.\hyperlink{structHmacContext_a8d7c8cb8814b1cfe2dee045d26077c72}{digest}, mac, macLen))
548       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca87e6ef81b46229cb03ed0a27e7f45c6e}{ERROR\_AUTHENTICATION\_FAILED};
549 
550    \textcolor{comment}{//Successful message authentication}
551    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
552 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_ac995a1d7cfdf5f25efd29f7e5c1f7c0d}\label{snmp__agent__usm_8c_ac995a1d7cfdf5f25efd29f7e5c1f7c0d}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Auth\+Outgoing\+Message@{snmp\+Auth\+Outgoing\+Message}}
\index{snmp\+Auth\+Outgoing\+Message@{snmp\+Auth\+Outgoing\+Message}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Auth\+Outgoing\+Message()}{snmpAuthOutgoingMessage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Auth\+Outgoing\+Message (\begin{DoxyParamCaption}\item[{const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{user,  }\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Authenticate outgoing S\+N\+MP message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em user} & Security profile of the user \\
\hline
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 469 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
470 \{
471    \textcolor{keyword}{const} \hyperlink{structHashAlgo}{HashAlgo} *hashAlgo;
472    \textcolor{keywordtype}{size\_t} macLen;
473    \hyperlink{structHmacContext}{HmacContext} hmacContext;
474 
475    \textcolor{comment}{//Get the hash algorithm to be used for HMAC computation}
476    hashAlgo = \hyperlink{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}{snmpGetHashAlgo}(user->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol});
477 
478    \textcolor{comment}{//Invalid authentication protocol?}
479    \textcolor{keywordflow}{if}(hashAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
480       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
481 
482    \textcolor{comment}{//Retrieve the length of the truncated MAC}
483    macLen = \hyperlink{snmp__agent__usm_8c_a4cfaee41833a90ca96cd8c6d2f945a50}{snmpGetMacLength}(user->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol});
484 
485    \textcolor{comment}{//Check the length of the msgAuthenticationParameters field}
486    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} != macLen)
487       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
488 
489    \textcolor{comment}{//The MAC is calculated over the whole message}
490    \hyperlink{hmac_8c_ac4ecc520cae02c1b9bbb3651758a703e}{hmacInit}(&hmacContext, hashAlgo, user->\hyperlink{structSnmpUserEntry_abe989af09e827849ce740a3813edcbc7}{localizedAuthKey}.
      \hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}, hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
491    \hyperlink{hmac_8c_a4c34324b10bcf1b4372f272369773501}{hmacUpdate}(&hmacContext, message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
492    \hyperlink{hmac_8c_a387906ffc55755df380361c43ce0bd6a}{hmacFinal}(&hmacContext, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
493 
494    \textcolor{comment}{//Replace the msgAuthenticationParameters field with the calculated MAC}
495    memcpy(message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters}, hmacContext.\hyperlink{structHmacContext_a8d7c8cb8814b1cfe2dee045d26077c72}{digest}, macLen);
496 
497    \textcolor{comment}{//Successful message authentication}
498    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
499 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a1555f6ee258f6dfef2f9d11f95560a39}\label{snmp__agent__usm_8c_a1555f6ee258f6dfef2f9d11f95560a39}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Change\+Key@{snmp\+Change\+Key}}
\index{snmp\+Change\+Key@{snmp\+Change\+Key}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Change\+Key()}{snmpChangeKey()}}
{\footnotesize\ttfamily void snmp\+Change\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structHashAlgo}{Hash\+Algo} $\ast$}]{hash\+Algo,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{random,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{delta,  }\item[{\hyperlink{structSnmpKey}{Snmp\+Key} $\ast$}]{key }\end{DoxyParamCaption})}



Change secret key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em hash\+Algo} & Hash algorithm to be used \\
\hline
\mbox{\tt in}  & {\em random} & Pointer to the random component \\
\hline
\mbox{\tt in}  & {\em delta} & Pointer to the delta component \\
\hline
\mbox{\tt in,out}  & {\em key} & Pointer to the secret key K \\
\hline
\end{DoxyParams}


Definition at line 277 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
279 \{
280    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
281    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} hashContext[\hyperlink{cyclone__crypto_2core_2crypto_8h_a17bccd72e42ecb723e28314749fb1638}{MAX\_HASH\_CONTEXT\_SIZE}];
282    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} digest[\hyperlink{snmp__agent__usm_8h_a197fe5f83e459aaf54057f2a4fdb496d}{SNMP\_MAX\_KEY\_SIZE}];
283 
284    \textcolor{comment}{//The random component is appended to the existing value of the K, and the}
285    \textcolor{comment}{//result is input to the hash algorithm H to produce a digest value}
286    hashAlgo->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
287    hashAlgo->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, key, hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
288    hashAlgo->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, \hyperlink{tls_8h_a6120afe912430104573286fe328768c9}{random}, hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
289    hashAlgo->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, digest);
290 
291    \textcolor{comment}{//This digest value is XOR-ed with the unused portion of the delta component}
292    \textcolor{comment}{//to produce the new value of K}
293    \textcolor{keywordflow}{for}(i = 0; i < hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize}; i++)
294    \{
295       key->\hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}[i] = digest[i] ^ \hyperlink{coap__common_8h_ab90adf2873f721fb4a969230dbcd7a59}{delta}[i];
296    \}
297 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a4b77fa76e0bb98081df95572a83b4a4f}\label{snmp__agent__usm_8c_a4b77fa76e0bb98081df95572a83b4a4f}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Check\+Engine\+Time@{snmp\+Check\+Engine\+Time}}
\index{snmp\+Check\+Engine\+Time@{snmp\+Check\+Engine\+Time}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Check\+Engine\+Time()}{snmpCheckEngineTime()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Check\+Engine\+Time (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Replay protection. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 411 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
412 \{
413    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
414 
415 \textcolor{preprocessor}{#if (SNMP\_AGENT\_INFORM\_SUPPORT == ENABLED)}
416    \textcolor{comment}{//Check whether the discovery process is complete}
417    \textcolor{keywordflow}{if}(context->informContextEngineLen > 0)
418    \{
419       \textcolor{comment}{//Compare engine IDs}
420       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} == context->informContextEngineLen)
421       \{
422          \textcolor{keywordflow}{if}(!memcmp(message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId}, context->informContextEngine,
423             context->informContextEngineLen))
424          \{
425             \textcolor{comment}{//We are done}
426             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
427          \}
428       \}
429    \}
430 \textcolor{preprocessor}{#endif}
431 
432    \textcolor{comment}{//Initialize status code}
433    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
434 
435    \textcolor{comment}{//If any of the following conditions is true, then the message is}
436    \textcolor{comment}{//considered to be outside of the time window}
437    \textcolor{keywordflow}{if}(context->engineBoots == \hyperlink{stdint_8h_a181807730d4a375f848ba139813ce04f}{INT32\_MAX})
438    \{
439       \textcolor{comment}{//The local value of snmpEngineBoots is 2147483647}
440       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca5a869df5965a4b8665581bb828471f02}{ERROR\_NOT\_IN\_TIME\_WINDOW};
441    \}
442    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->engineBoots != message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots})
443    \{
444       \textcolor{comment}{//The value of the msgAuthoritativeEngineBoots field differs from}
445       \textcolor{comment}{//the local value of snmpEngineBoots}
446       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca5a869df5965a4b8665581bb828471f02}{ERROR\_NOT\_IN\_TIME\_WINDOW};
447    \}
448    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((context->engineTime - message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime}) > 
      \hyperlink{snmp__agent__usm_8h_ac9fa458293e3873a9a4b90cb06614b37}{SNMP\_TIME\_WINDOW} ||
449       (message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime} - context->engineTime) > 
      \hyperlink{snmp__agent__usm_8h_ac9fa458293e3873a9a4b90cb06614b37}{SNMP\_TIME\_WINDOW})
450    \{
451       \textcolor{comment}{//The value of the msgAuthoritativeEngineTime field differs from the}
452       \textcolor{comment}{//local notion of snmpEngineTime by more than +/- 150 seconds}
453       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca5a869df5965a4b8665581bb828471f02}{ERROR\_NOT\_IN\_TIME\_WINDOW};
454    \}
455 
456    \textcolor{comment}{//If the message is considered to be outside of the time window then an}
457    \textcolor{comment}{//error indication (notInTimeWindow) is returned to the calling module}
458    \textcolor{keywordflow}{return} error;
459 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_aaa271cb3fa3eb1fd53dbb92b5bd2d7b3}\label{snmp__agent__usm_8c_aaa271cb3fa3eb1fd53dbb92b5bd2d7b3}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Check\+Security\+Parameters@{snmp\+Check\+Security\+Parameters}}
\index{snmp\+Check\+Security\+Parameters@{snmp\+Check\+Security\+Parameters}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Check\+Security\+Parameters()}{snmpCheckSecurityParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Check\+Security\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{user,  }\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{engine\+Id,  }\item[{size\+\_\+t}]{engine\+Id\+Len }\end{DoxyParamCaption})}



Check security parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em user} & Security profile of the user \\
\hline
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\mbox{\tt in}  & {\em engine\+Id} & Pointer to the authoritative engine ID \\
\hline
\mbox{\tt in}  & {\em engine\+Id\+Len} & Length of the authoritative engine ID \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 329 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
331 \{
332    \textcolor{comment}{//Check the length of the authoritative engine ID}
333    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} != engineIdLen)
334       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca308d5e2919a0cf0081bfc0e024a1bc4a}{ERROR\_UNKNOWN\_ENGINE\_ID};
335 
336    \textcolor{comment}{//If the value of the msgAuthoritativeEngineID field is unknown, then an}
337    \textcolor{comment}{//error indication (unknownEngineID) is returned to the calling module}
338    \textcolor{keywordflow}{if}(memcmp(message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId}, engineId, engineIdLen))
339       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca308d5e2919a0cf0081bfc0e024a1bc4a}{ERROR\_UNKNOWN\_ENGINE\_ID};
340 
341    \textcolor{comment}{//If no information is available for the user, then an error indication}
342    \textcolor{comment}{//(unknownSecurityName) is returned to the calling module}
343    \textcolor{keywordflow}{if}(user == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || user->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE})
344       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cadd2abf704c42af2698ebeccb4dd2bf85}{ERROR\_UNKNOWN\_USER\_NAME};
345 
346    \textcolor{comment}{//Check whether the securityLevel specifies that the message should}
347    \textcolor{comment}{//be authenticated}
348    \textcolor{keywordflow}{if}(user->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol} != \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a2c9ec503096d5f8c9f31352c4ad6488b}{SNMP\_AUTH\_PROTOCOL\_NONE})
349    \{
350       \textcolor{comment}{//Make sure the authFlag is set}
351       \textcolor{keywordflow}{if}(!(message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a8b9b4731d377864f4e13821af7cd3329}{SNMP\_MSG\_FLAG\_AUTH}))
352          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6c9048c086c34674d0a711081c88c96a}{ERROR\_UNSUPPORTED\_SECURITY\_LEVEL};
353    \}
354 
355    \textcolor{comment}{//Check whether the securityLevel specifies that the message should}
356    \textcolor{comment}{//be encrypted}
357    \textcolor{keywordflow}{if}(user->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol} != \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a29bcb0f6410e21559159915d4c08dac8}{SNMP\_PRIV\_PROTOCOL\_NONE})
358    \{
359       \textcolor{comment}{//Make sure the privFlag is set}
360       \textcolor{keywordflow}{if}(!(message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a09a0d3b1da3227488bf9ccc2cc8a48e2}{SNMP\_MSG\_FLAG\_PRIV}))
361          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca6c9048c086c34674d0a711081c88c96a}{ERROR\_UNSUPPORTED\_SECURITY\_LEVEL};
362    \}
363 
364    \textcolor{comment}{//Security parameters are valid}
365    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
366 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a7a2163b21b2086dba7259a5aaea7c3fd}\label{snmp__agent__usm_8c_a7a2163b21b2086dba7259a5aaea7c3fd}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Clone\+Security\+Parameters@{snmp\+Clone\+Security\+Parameters}}
\index{snmp\+Clone\+Security\+Parameters@{snmp\+Clone\+Security\+Parameters}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Clone\+Security\+Parameters()}{snmpCloneSecurityParameters()}}
{\footnotesize\ttfamily void snmp\+Clone\+Security\+Parameters (\begin{DoxyParamCaption}\item[{\hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{user,  }\item[{const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{clone\+From\+User }\end{DoxyParamCaption})}



Clone security parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em user} & Security profile of the user \\
\hline
\mbox{\tt in}  & {\em clone\+From\+User} & Security profile of the clone-\/from user \\
\hline
\end{DoxyParams}


Definition at line 306 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
308 \{
309    \textcolor{comment}{//Clone security parameters}
310    user->\hyperlink{structSnmpUserEntry_af0824f5ebfa463d31b6d9983def956eb}{mode} = cloneFromUser->\hyperlink{structSnmpUserEntry_af0824f5ebfa463d31b6d9983def956eb}{mode};
311    user->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol} = cloneFromUser->\hyperlink{structSnmpUserEntry_a5131eefca59001108b44e59b284397db}{authProtocol};
312    user->\hyperlink{structSnmpUserEntry_a32003a1f649e6244a8453157d6502f92}{rawAuthKey} = cloneFromUser->\hyperlink{structSnmpUserEntry_a32003a1f649e6244a8453157d6502f92}{rawAuthKey};
313    user->\hyperlink{structSnmpUserEntry_abe989af09e827849ce740a3813edcbc7}{localizedAuthKey} = cloneFromUser->\hyperlink{structSnmpUserEntry_abe989af09e827849ce740a3813edcbc7}{localizedAuthKey};
314    user->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol} = cloneFromUser->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol};
315    user->\hyperlink{structSnmpUserEntry_ac4445ac274e1da56ffb5c037c9f9cb46}{rawPrivKey} = cloneFromUser->\hyperlink{structSnmpUserEntry_ac4445ac274e1da56ffb5c037c9f9cb46}{rawPrivKey};
316    user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey} = cloneFromUser->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey};
317 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_aa834b11d54972a9deb6af7253f99a541}\label{snmp__agent__usm_8c_aa834b11d54972a9deb6af7253f99a541}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Create\+User\+Entry@{snmp\+Create\+User\+Entry}}
\index{snmp\+Create\+User\+Entry@{snmp\+Create\+User\+Entry}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Create\+User\+Entry()}{snmpCreateUserEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry}$\ast$ snmp\+Create\+User\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Create a new user entry. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the newly created entry 
\end{DoxyReturn}


Definition at line 75 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
76 \{
77    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
78    \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *entry;
79 
80    \textcolor{comment}{//Initialize pointer}
81    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
82 
83    \textcolor{comment}{//Sanity check}
84    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
85    \{
86       \textcolor{comment}{//Loop through the list of users}
87       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a87620bd88babef997647226c78f35ecb}{SNMP\_AGENT\_MAX\_USERS}; i++)
88       \{
89          \textcolor{comment}{//Check current status}
90          \textcolor{keywordflow}{if}(context->userTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
91          \{
92             \textcolor{comment}{//An unused entry has been found}
93             entry = &context->userTable[i];
94             \textcolor{comment}{//We are done}
95             \textcolor{keywordflow}{break};
96          \}
97       \}
98 
99       \textcolor{comment}{//Check whether the user table runs out of space}
100       \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
101       \{
102          \textcolor{comment}{//Loop through the list of users}
103          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a87620bd88babef997647226c78f35ecb}{SNMP\_AGENT\_MAX\_USERS}; i++)
104          \{
105             \textcolor{comment}{//Check current status}
106             \textcolor{keywordflow}{if}(context->userTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097ab6c550e32b731ff9573ce8db2f299a2b}{MIB\_ROW\_STATUS\_NOT\_READY})
107             \{
108                \textcolor{comment}{//Reuse the current entry}
109                entry = &context->userTable[i];
110                \textcolor{comment}{//We are done}
111                \textcolor{keywordflow}{break};
112             \}
113          \}
114       \}
115    \}
116 
117    \textcolor{comment}{//Return a pointer to the newly created entry}
118    \textcolor{keywordflow}{return} entry;
119 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a65bdcc2539a5a0b1d30fb1f33405fc5f}\label{snmp__agent__usm_8c_a65bdcc2539a5a0b1d30fb1f33405fc5f}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Decrypt\+Data@{snmp\+Decrypt\+Data}}
\index{snmp\+Decrypt\+Data@{snmp\+Decrypt\+Data}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Decrypt\+Data()}{snmpDecryptData()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Decrypt\+Data (\begin{DoxyParamCaption}\item[{const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{user,  }\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message }\end{DoxyParamCaption})}



Data decryption. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em user} & Security profile of the user \\
\hline
\mbox{\tt in,out}  & {\em message} & Pointer to the incoming S\+N\+MP message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 705 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
706 \{
707    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
708    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
709    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
710 
711    \textcolor{comment}{//The encryptedPDU is encapsulated within an octet string}
712    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, &tag);
713    \textcolor{comment}{//Failed to decode ASN.1 tag?}
714    \textcolor{keywordflow}{if}(error)
715       \textcolor{keywordflow}{return} error;
716 
717    \textcolor{comment}{//Enforce encoding, class and type}
718    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING});
719    \textcolor{comment}{//The tag does not match the criteria?}
720    \textcolor{keywordflow}{if}(error)
721       \textcolor{keywordflow}{return} error;
722 
723    \textcolor{comment}{//Point to the encryptedPDU}
724    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
725    \textcolor{comment}{//Length of the encryptedPDU}
726    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
727 
728 #if (\hyperlink{snmp__agent__usm_8h_a6c431f5ce3bb63647ce3018cd2d1447b}{SNMP\_DES\_SUPPORT} == \hyperlink{os__port_8h_a73c228f87e038e8295ee8ea8eceaa5ac}{ENABLED})
729    \textcolor{comment}{//DES-CBC privacy protocol?}
730    \textcolor{keywordflow}{if}(user->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol} == \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a286d2219f3f41326458583ac8f7ca4af}{SNMP\_PRIV\_PROTOCOL\_DES})
731    \{
732       \hyperlink{structDesContext}{DesContext} desContext;
733       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{blake2b_8c_a7776c99735c5a9d93817d8f7bd33d8e6}{iv}[\hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE}];
734 
735       \textcolor{comment}{//Before decryption, the encrypted data length is verified. The length}
736       \textcolor{comment}{//of the encrypted data must be a multiple of 8 octets}
737       \textcolor{keywordflow}{if}((message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} % 8) != 0)
738          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca42ac4eb97a02112d45b5f0405c0393c1}{ERROR\_DECRYPTION\_FAILED};
739 
740       \textcolor{comment}{//Check the length of the msgPrivacyParameters field}
741       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} != 8)
742          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca42ac4eb97a02112d45b5f0405c0393c1}{ERROR\_DECRYPTION\_FAILED};
743 
744       \textcolor{comment}{//Initialize DES context}
745       error = \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&desContext, user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey}.
      \hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}, 8);
746       \textcolor{comment}{//Initialization failed?}
747       \textcolor{keywordflow}{if}(error)
748          \textcolor{keywordflow}{return} error;
749 
750       \textcolor{comment}{//The last 8 octets of the 16-octet secret (private privacy key) are}
751       \textcolor{comment}{//used as pre-IV}
752       memcpy(iv, user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey}.\hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b} + \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE}, 
      \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE});
753 
754       \textcolor{comment}{//The msgPrivacyParameters field is XOR-ed with the pre-IV to obtain the IV}
755       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE}; i++)
756       \{
757          iv[i] ^= message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters}[i];
758       \}
759 
760       \textcolor{comment}{//Perform CBC decryption}
761       error = \hyperlink{cbc_8c_a840b0b9b34ed3e5d7a3ccb85487896de}{cbcDecrypt}(\hyperlink{des_8h_acf6025bcfd46cd3a05477583828f32f7}{DES\_CIPHER\_ALGO}, &desContext, iv, message->
      \hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos},
762          message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
763       \textcolor{comment}{//Any error to report?}
764       \textcolor{keywordflow}{if}(error)
765          \textcolor{keywordflow}{return} error;
766    \}
767    \textcolor{keywordflow}{else}
768 \textcolor{preprocessor}{#endif}
769 \textcolor{preprocessor}{#if (SNMP\_AES\_SUPPORT == ENABLED)}
770    \textcolor{comment}{//AES-128-CFB privacy protocol?}
771    \textcolor{keywordflow}{if}(user->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol} == \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a9afc3ebc5fd421e94a7a5eca75f2520b}{SNMP\_PRIV\_PROTOCOL\_AES})
772    \{
773       \hyperlink{structAesContext}{AesContext} aesContext;
774       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} iv[\hyperlink{aes_8h_af19ab913a847ad1e91c5291215116de1}{AES\_BLOCK\_SIZE}];
775 
776       \textcolor{comment}{//Check the length of the msgPrivacyParameters field}
777       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} != 8)
778          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca42ac4eb97a02112d45b5f0405c0393c1}{ERROR\_DECRYPTION\_FAILED};
779 
780       \textcolor{comment}{//The 32-bit snmpEngineBoots is converted to the first 4 octets of the IV}
781       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots}, iv);
782       \textcolor{comment}{//The 32-bit snmpEngineTime is converted to the subsequent 4 octets}
783       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime}, iv + 4);
784       \textcolor{comment}{//The 64-bit integer is then converted to the last 8 octets}
785       memcpy(iv + 8, message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters}, 8);
786 
787       \textcolor{comment}{//Initialize AES context}
788       error = \hyperlink{aes_8c_a1786debf48f536d5dd454e4a8f7ecd0f}{aesInit}(&aesContext, user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey}.
      \hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}, 16);
789       \textcolor{comment}{//Initialization failed?}
790       \textcolor{keywordflow}{if}(error)
791          \textcolor{keywordflow}{return} error;
792 
793       \textcolor{comment}{//Perform CFB-128 encryption}
794       error = \hyperlink{cfb_8c_aa18ea906d68b4644012bae0a90b70624}{cfbDecrypt}(\hyperlink{aes_8h_ae075f5718fa6cdcfd6227f301c2ea202}{AES\_CIPHER\_ALGO}, &aesContext, 128, iv, message->
      \hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos},
795          message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
796       \textcolor{comment}{//Any error to report?}
797       \textcolor{keywordflow}{if}(error)
798          \textcolor{keywordflow}{return} error;
799    \}
800    \textcolor{keywordflow}{else}
801 \textcolor{preprocessor}{#endif}
802    \textcolor{comment}{//Invalid privacy protocol?}
803    \{
804       \textcolor{comment}{//Report an error}
805       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca42ac4eb97a02112d45b5f0405c0393c1}{ERROR\_DECRYPTION\_FAILED};
806    \}
807 
808    \textcolor{comment}{//Debug message}
809    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Scoped PDU (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes):\(\backslash\)r\(\backslash\)n"}, message->
      \hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
810    \textcolor{comment}{//Display the contents of the scopedPDU}
811    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"  "}, message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
812    \textcolor{comment}{//Display ASN.1 structure}
813    \hyperlink{asn1_8c_adfebd6c0e21cc4d23414ff98aa9e9a69}{asn1DumpObject}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, 0);
814 
815    \textcolor{comment}{//Successful decryption}
816    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
817 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a3cb6959af6963c5f5d593a28e7f72ee7}\label{snmp__agent__usm_8c_a3cb6959af6963c5f5d593a28e7f72ee7}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Encrypt\+Data@{snmp\+Encrypt\+Data}}
\index{snmp\+Encrypt\+Data@{snmp\+Encrypt\+Data}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Encrypt\+Data()}{snmpEncryptData()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Encrypt\+Data (\begin{DoxyParamCaption}\item[{const \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry} $\ast$}]{user,  }\item[{\hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message,  }\item[{\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} $\ast$}]{salt }\end{DoxyParamCaption})}



Data encryption. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em user} & Security profile of the user \\
\hline
\mbox{\tt in,out}  & {\em message} & Pointer to the outgoing S\+N\+MP message \\
\hline
\mbox{\tt in,out}  & {\em salt} & Pointer to the salt integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 563 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
565 \{
566    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
567    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
568    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
569    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
570 
571    \textcolor{comment}{//Debug message}
572    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Scoped PDU (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes):\(\backslash\)r\(\backslash\)n"}, message->
      \hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
573    \textcolor{comment}{//Display the contents of the scopedPDU}
574    \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"  "}, message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
575    \textcolor{comment}{//Display ASN.1 structure}
576    \hyperlink{asn1_8c_adfebd6c0e21cc4d23414ff98aa9e9a69}{asn1DumpObject}(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, 0);
577 
578 \textcolor{preprocessor}{#if (SNMP\_DES\_SUPPORT == ENABLED)}
579    \textcolor{comment}{//DES-CBC privacy protocol?}
580    \textcolor{keywordflow}{if}(user->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol} == \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a286d2219f3f41326458583ac8f7ca4af}{SNMP\_PRIV\_PROTOCOL\_DES})
581    \{
582       \hyperlink{structDesContext}{DesContext} desContext;
583       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{blake2b_8c_a7776c99735c5a9d93817d8f7bd33d8e6}{iv}[\hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE}];
584 
585       \textcolor{comment}{//The data to be encrypted is treated as sequence of octets. Its length}
586       \textcolor{comment}{//should be an integral multiple of 8}
587       \textcolor{keywordflow}{if}((message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} % 8) != 0)
588       \{
589          \textcolor{comment}{//If it is not, the data is padded at the end as necessary}
590          n = 8 - (message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} % 8);
591          \textcolor{comment}{//The actual pad value is irrelevant}
592          memset(message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} + message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length}, n, n);
593          \textcolor{comment}{//Update the length of the data}
594          message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
595       \}
596 
597       \textcolor{comment}{//The 32-bit snmpEngineBoots is converted to the first 4 octets of our salt}
598       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots}, message->
      \hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters});
599       \textcolor{comment}{//The 32-bit integer is then converted to the last 4 octet of our salt}
600       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(*salt, message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters} + 4);
601 
602       \textcolor{comment}{//The resulting salt is then put into the msgPrivacyParameters field}
603       message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = 8;
604 
605       \textcolor{comment}{//Initialize DES context}
606       error = \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&desContext, user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey}.
      \hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}, 8);
607       \textcolor{comment}{//Initialization failed?}
608       \textcolor{keywordflow}{if}(error)
609          \textcolor{keywordflow}{return} error;
610 
611       \textcolor{comment}{//The last 8 octets of the 16-octet secret (private privacy key) are}
612       \textcolor{comment}{//used as pre-IV}
613       memcpy(iv, user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey}.\hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b} + \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE}, 
      \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE});
614 
615       \textcolor{comment}{//The msgPrivacyParameters field is XOR-ed with the pre-IV to obtain the IV}
616       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{des_8h_a8a583bbd17418046705ca55b6dbbe652}{DES\_BLOCK\_SIZE}; i++)
617       \{
618          iv[i] ^= message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters}[i];
619       \}
620 
621       \textcolor{comment}{//Perform CBC encryption}
622       error = \hyperlink{cbc_8c_a51d0daca289df7143bfb16726b27e281}{cbcEncrypt}(\hyperlink{des_8h_acf6025bcfd46cd3a05477583828f32f7}{DES\_CIPHER\_ALGO}, &desContext, iv, message->
      \hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos},
623          message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
624       \textcolor{comment}{//Any error to report?}
625       \textcolor{keywordflow}{if}(error)
626          \textcolor{keywordflow}{return} error;
627    \}
628    \textcolor{keywordflow}{else}
629 \textcolor{preprocessor}{#endif}
630 \textcolor{preprocessor}{#if (SNMP\_AES\_SUPPORT == ENABLED)}
631    \textcolor{comment}{//AES-128-CFB privacy protocol?}
632    \textcolor{keywordflow}{if}(user->\hyperlink{structSnmpUserEntry_a59bfb353ffa70a6791f0a6d5608ec0eb}{privProtocol} == \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a9afc3ebc5fd421e94a7a5eca75f2520b}{SNMP\_PRIV\_PROTOCOL\_AES})
633    \{
634       \hyperlink{structAesContext}{AesContext} aesContext;
635       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} iv[\hyperlink{aes_8h_af19ab913a847ad1e91c5291215116de1}{AES\_BLOCK\_SIZE}];
636 
637       \textcolor{comment}{//The 32-bit snmpEngineBoots is converted to the first 4 octets of the IV}
638       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots}, iv);
639       \textcolor{comment}{//The 32-bit snmpEngineTime is converted to the subsequent 4 octets}
640       \hyperlink{cpu__endian_8h_a8663906e08e818efa91dd6f65a7e636d}{STORE32BE}(message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime}, iv + 4);
641       \textcolor{comment}{//The 64-bit integer is then converted to the last 8 octets}
642       \hyperlink{cpu__endian_8h_abd64119985555609ad9c94eed4c96e0f}{STORE64BE}(*salt, iv + 8);
643 
644       \textcolor{comment}{//The 64-bit integer must be placed in the msgPrivacyParameters field to}
645       \textcolor{comment}{//enable the receiving entity to compute the correct IV and to decrypt}
646       \textcolor{comment}{//the message}
647       \hyperlink{cpu__endian_8h_abd64119985555609ad9c94eed4c96e0f}{STORE64BE}(*salt, message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters});
648       message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = 8;
649 
650       \textcolor{comment}{//Initialize AES context}
651       error = \hyperlink{aes_8c_a1786debf48f536d5dd454e4a8f7ecd0f}{aesInit}(&aesContext, user->\hyperlink{structSnmpUserEntry_aee3ff1ac4b61b242440a14543c06bef2}{localizedPrivKey}.
      \hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b}, 16);
652       \textcolor{comment}{//Initialization failed?}
653       \textcolor{keywordflow}{if}(error)
654          \textcolor{keywordflow}{return} error;
655 
656       \textcolor{comment}{//Perform CFB-128 encryption}
657       error = \hyperlink{cfb_8c_ad433d09d7a3b81f60702e30d289c091c}{cfbEncrypt}(\hyperlink{aes_8h_ae075f5718fa6cdcfd6227f301c2ea202}{AES\_CIPHER\_ALGO}, &aesContext, 128, iv, message->
      \hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos},
658          message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length});
659       \textcolor{comment}{//Any error to report?}
660       \textcolor{keywordflow}{if}(error)
661          \textcolor{keywordflow}{return} error;
662    \}
663    \textcolor{keywordflow}{else}
664 \textcolor{preprocessor}{#endif}
665    \textcolor{comment}{//Invalid privacy protocol?}
666    \{
667       \textcolor{comment}{//Report an error}
668       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
669    \}
670 
671    \textcolor{comment}{//The encryptedPDU is encapsulated within an octet string}
672    tag.\hyperlink{structAsn1Tag_a93c64e611d57dfb59e6ebafe938f28c1}{constructed} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
673    tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} = \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL};
674    tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} = \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfacdfe5b0b233bce2f5388d3693bf7b602}{ASN1\_TYPE\_OCTET\_STRING};
675    tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} = message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length};
676    tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
677 
678    \textcolor{comment}{//Write the corresponding ASN.1 tag}
679    error = \hyperlink{asn1_8c_a246f5e4192e8f064bd28d519a89d0207}{asn1WriteTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos}, &n);
680    \textcolor{comment}{//Any error to report?}
681    \textcolor{keywordflow}{if}(error)
682       \textcolor{keywordflow}{return} error;
683 
684    \textcolor{comment}{//Move backward}
685    message->\hyperlink{structSnmpMessage_a37d25fb4329d91746ae12b8f1ddb612b}{pos} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
686    \textcolor{comment}{//Total length of the encryptedPDU}
687    message->\hyperlink{structSnmpMessage_a93c0a098352c158e9dba13bbd023e0fd}{length} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
688 
689    \textcolor{comment}{//The salt integer is then modified. It is incremented by one and wrap}
690    \textcolor{comment}{//when it reaches its maximum value}
691    *salt += 1;
692 
693    \textcolor{comment}{//Successful encryption}
694    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
695 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_adb4ad71f3b5167a13a2551f075c25110}\label{snmp__agent__usm_8c_adb4ad71f3b5167a13a2551f075c25110}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Find\+User\+Entry@{snmp\+Find\+User\+Entry}}
\index{snmp\+Find\+User\+Entry@{snmp\+Find\+User\+Entry}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Find\+User\+Entry()}{snmpFindUserEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpUserEntry}{Snmp\+User\+Entry}$\ast$ snmp\+Find\+User\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{name,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Search the user table for a given user name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em name} & Pointer to the user name \\
\hline
\mbox{\tt in}  & {\em length} & Length of the user name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the matching entry 
\end{DoxyReturn}


Definition at line 130 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
132 \{
133    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
134    \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *entry;
135 
136    \textcolor{comment}{//Initialize pointer}
137    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
138 
139    \textcolor{comment}{//Sanity check}
140    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
141    \{
142       \textcolor{comment}{//Loop through the list of users}
143       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a87620bd88babef997647226c78f35ecb}{SNMP\_AGENT\_MAX\_USERS}; i++)
144       \{
145          \textcolor{comment}{//Check current status}
146          \textcolor{keywordflow}{if}(context->userTable[i].status != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
147          \{
148             \textcolor{comment}{//Check the length of the user name}
149             \textcolor{keywordflow}{if}(strlen(context->userTable[i].name) == \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
150             \{
151                \textcolor{comment}{//Compare user names}
152                \textcolor{keywordflow}{if}(!strncmp(context->userTable[i].name, \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}))
153                \{
154                   \textcolor{comment}{//A matching entry has been found}
155                   entry = &context->userTable[i];
156                   \textcolor{comment}{//We are done}
157                   \textcolor{keywordflow}{break};
158                \}
159             \}
160          \}
161       \}
162    \}
163 
164    \textcolor{comment}{//Return a pointer to the matching entry}
165    \textcolor{keywordflow}{return} entry;
166 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a3e019f63dd6f8a7287e5e0125526b755}\label{snmp__agent__usm_8c_a3e019f63dd6f8a7287e5e0125526b755}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Generate\+Key@{snmp\+Generate\+Key}}
\index{snmp\+Generate\+Key@{snmp\+Generate\+Key}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Generate\+Key()}{snmpGenerateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Generate\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol}}]{auth\+Protocol,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{password,  }\item[{\hyperlink{structSnmpKey}{Snmp\+Key} $\ast$}]{key }\end{DoxyParamCaption})}



Password to key algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em auth\+Protocol} & Authentication protocol (M\+D5, S\+H\+A-\/1, S\+H\+A-\/224, S\+H\+A-\/256, S\+H\+A384 or S\+H\+A512) \\
\hline
\mbox{\tt in}  & {\em password} & N\+U\+L\+L-\/terminated string that contains the password \\
\hline
\mbox{\tt out}  & {\em key} & Pointer to the resulting key (Ku) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 178 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
180 \{
181    \textcolor{keywordtype}{size\_t} i;
182    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
183    \textcolor{keywordtype}{size\_t} passwordLen;
184    \textcolor{keyword}{const} \hyperlink{structHashAlgo}{HashAlgo} *hashAlgo;
185    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} hashContext[\hyperlink{cyclone__crypto_2core_2crypto_8h_a17bccd72e42ecb723e28314749fb1638}{MAX\_HASH\_CONTEXT\_SIZE}];
186 
187    \textcolor{comment}{//Check parameters}
188    \textcolor{keywordflow}{if}(password == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
189       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
190 
191    \textcolor{comment}{//Clear SNMP key}
192    memset(key, 0, \textcolor{keyword}{sizeof}(\hyperlink{structSnmpKey}{SnmpKey}));
193 
194    \textcolor{comment}{//Get the hash algorithm to be used to generate the key}
195    hashAlgo = \hyperlink{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}{snmpGetHashAlgo}(authProtocol);
196 
197    \textcolor{comment}{//Invalid authentication protocol?}
198    \textcolor{keywordflow}{if}(hashAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
199       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
200 
201    \textcolor{comment}{//Retrieve the length of the password}
202    passwordLen = strlen(password);
203 
204    \textcolor{comment}{//SNMP implementations must ensure that passwords are at least 8 characters}
205    \textcolor{comment}{//in length (see RFC 3414 11.2)}
206    \textcolor{keywordflow}{if}(passwordLen < 8)
207       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
208 
209    \textcolor{comment}{//Initialize hash context}
210    hashAlgo->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
211 
212    \textcolor{comment}{//Loop until we have done 1 megabyte}
213    \textcolor{keywordflow}{for}(i = 0; i < 1048576; i += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
214    \{
215       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(passwordLen, 1048576 - i);
216       hashAlgo->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, password, n);
217    \}
218 
219    \textcolor{comment}{//Finalize hash computation}
220    hashAlgo->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, key->\hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b});
221 
222    \textcolor{comment}{//Successful processing}
223    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
224 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}\label{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Get\+Hash\+Algo@{snmp\+Get\+Hash\+Algo}}
\index{snmp\+Get\+Hash\+Algo@{snmp\+Get\+Hash\+Algo}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Get\+Hash\+Algo()}{snmpGetHashAlgo()}}
{\footnotesize\ttfamily const \hyperlink{structHashAlgo}{Hash\+Algo}$\ast$ snmp\+Get\+Hash\+Algo (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol}}]{auth\+Protocol }\end{DoxyParamCaption})}



Get the hash algorithm to be used for a given authentication protocol. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em auth\+Protocol} & Authentication protocol (M\+D5, S\+H\+A-\/1, S\+H\+A-\/224, S\+H\+A-\/256, S\+H\+A384 or S\+H\+A512) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the corresponding hash algorithm 
\end{DoxyReturn}


Definition at line 827 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
828 \{
829    \textcolor{keyword}{const} \hyperlink{structHashAlgo}{HashAlgo} *hashAlgo;
830 
831 \textcolor{preprocessor}{#if (SNMP\_MD5\_SUPPORT == ENABLED)}
832    \textcolor{comment}{//HMAC-MD5-96 authentication protocol?}
833    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a64f336076b554983b5ff0ac9bc93b7cd}{SNMP\_AUTH\_PROTOCOL\_MD5})
834    \{
835       \textcolor{comment}{//Use MD5 hash algorithm}
836       hashAlgo = \hyperlink{md5_8h_adcb5ecbd7a360856b056f053b0d8343d}{MD5\_HASH\_ALGO};
837    \}
838    \textcolor{keywordflow}{else}
839 \textcolor{preprocessor}{#endif}
840 \textcolor{preprocessor}{#if (SNMP\_SHA1\_SUPPORT == ENABLED)}
841    \textcolor{comment}{//HMAC-SHA-1-96 authentication protocol?}
842    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a7c85bbbb7ea3bdf550096ed626557f4f}{SNMP\_AUTH\_PROTOCOL\_SHA1})
843    \{
844       \textcolor{comment}{//Use SHA-1 hash algorithm}
845       hashAlgo = \hyperlink{sha1_8h_a2529d805a2d0a0ca32114c810cc6cb1b}{SHA1\_HASH\_ALGO};
846    \}
847    \textcolor{keywordflow}{else}
848 \textcolor{preprocessor}{#endif}
849 \textcolor{preprocessor}{#if (SNMP\_SHA224\_SUPPORT == ENABLED)}
850    \textcolor{comment}{//HMAC-SHA-224-128 authentication protocol?}
851    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a378de262fb541cdfe1c014b8245e4f21}{SNMP\_AUTH\_PROTOCOL\_SHA224})
852    \{
853       \textcolor{comment}{//Use SHA-224 hash algorithm}
854       hashAlgo = \hyperlink{sha224_8h_a2a0e1f6abfdc1d572f55478719815b94}{SHA224\_HASH\_ALGO};
855    \}
856    \textcolor{keywordflow}{else}
857 \textcolor{preprocessor}{#endif}
858 \textcolor{preprocessor}{#if (SNMP\_SHA256\_SUPPORT == ENABLED)}
859    \textcolor{comment}{//HMAC-SHA-256-192 authentication protocol?}
860    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a7d555935f861e6d8533decd5b84f72b0}{SNMP\_AUTH\_PROTOCOL\_SHA256})
861    \{
862       \textcolor{comment}{//Use SHA-256 hash algorithm}
863       hashAlgo = \hyperlink{sha256_8h_ac65e86d6ed85707af5486ff4d9f87c71}{SHA256\_HASH\_ALGO};
864    \}
865    \textcolor{keywordflow}{else}
866 \textcolor{preprocessor}{#endif}
867 \textcolor{preprocessor}{#if (SNMP\_SHA384\_SUPPORT == ENABLED)}
868    \textcolor{comment}{//HMAC-SHA-384-256 authentication protocol?}
869    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a79c2b9959e9da55e6a4191bd61c9223c}{SNMP\_AUTH\_PROTOCOL\_SHA384})
870    \{
871       \textcolor{comment}{//Use SHA-384 hash algorithm}
872       hashAlgo = \hyperlink{sha384_8h_a3dd6226e61249284db3162706a53ea39}{SHA384\_HASH\_ALGO};
873    \}
874    \textcolor{keywordflow}{else}
875 \textcolor{preprocessor}{#endif}
876 \textcolor{preprocessor}{#if (SNMP\_SHA512\_SUPPORT == ENABLED)}
877    \textcolor{comment}{//HMAC-SHA-512-384 authentication protocol?}
878    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a0ba8a62eeb03f3f1a0f522833255eadc}{SNMP\_AUTH\_PROTOCOL\_SHA512})
879    \{
880       \textcolor{comment}{//Use SHA-512 hash algorithm}
881       hashAlgo = \hyperlink{sha512_8h_a0dcb3e237be5f42423ad3a3868ad2b26}{SHA512\_HASH\_ALGO};
882    \}
883    \textcolor{keywordflow}{else}
884 \textcolor{preprocessor}{#endif}
885    \textcolor{comment}{//Invalid authentication protocol?}
886    \{
887       \textcolor{comment}{//The authentication protocol is not supported}
888       hashAlgo = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
889    \}
890 
891    \textcolor{comment}{//Return the hash algorithm to be used}
892    \textcolor{keywordflow}{return} hashAlgo;
893 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a4cfaee41833a90ca96cd8c6d2f945a50}\label{snmp__agent__usm_8c_a4cfaee41833a90ca96cd8c6d2f945a50}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Get\+Mac\+Length@{snmp\+Get\+Mac\+Length}}
\index{snmp\+Get\+Mac\+Length@{snmp\+Get\+Mac\+Length}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Get\+Mac\+Length()}{snmpGetMacLength()}}
{\footnotesize\ttfamily size\+\_\+t snmp\+Get\+Mac\+Length (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol}}]{auth\+Protocol }\end{DoxyParamCaption})}



Get the length of the truncated M\+AC for a given authentication protocol. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em auth\+Protocol} & Authentication protocol (M\+D5, S\+H\+A-\/1, S\+H\+A-\/224, S\+H\+A-\/256, S\+H\+A384 or S\+H\+A512) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Length of the truncated M\+AC, in bytes 
\end{DoxyReturn}


Definition at line 903 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
904 \{
905    \textcolor{keywordtype}{size\_t} macLen;
906 
907 \textcolor{preprocessor}{#if (SNMP\_MD5\_SUPPORT == ENABLED)}
908    \textcolor{comment}{//HMAC-MD5-96 authentication protocol?}
909    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a64f336076b554983b5ff0ac9bc93b7cd}{SNMP\_AUTH\_PROTOCOL\_MD5})
910    \{
911       \textcolor{comment}{//The length of the truncated MAC is 96 bits}
912       macLen = 12;
913    \}
914    \textcolor{keywordflow}{else}
915 \textcolor{preprocessor}{#endif}
916 \textcolor{preprocessor}{#if (SNMP\_SHA1\_SUPPORT == ENABLED)}
917    \textcolor{comment}{//HMAC-SHA-1-96 authentication protocol?}
918    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a7c85bbbb7ea3bdf550096ed626557f4f}{SNMP\_AUTH\_PROTOCOL\_SHA1})
919    \{
920       \textcolor{comment}{//The length of the truncated MAC is 96 bits}
921       macLen = 12;
922    \}
923    \textcolor{keywordflow}{else}
924 \textcolor{preprocessor}{#endif}
925 \textcolor{preprocessor}{#if (SNMP\_SHA224\_SUPPORT == ENABLED)}
926    \textcolor{comment}{//HMAC-SHA-224-128 authentication protocol?}
927    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a378de262fb541cdfe1c014b8245e4f21}{SNMP\_AUTH\_PROTOCOL\_SHA224})
928    \{
929       \textcolor{comment}{//The length of the truncated MAC is 128 bits}
930       macLen = 16;
931    \}
932    \textcolor{keywordflow}{else}
933 \textcolor{preprocessor}{#endif}
934 \textcolor{preprocessor}{#if (SNMP\_SHA256\_SUPPORT == ENABLED)}
935    \textcolor{comment}{//HMAC-SHA-256-192 authentication protocol?}
936    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a7d555935f861e6d8533decd5b84f72b0}{SNMP\_AUTH\_PROTOCOL\_SHA256})
937    \{
938       \textcolor{comment}{//The length of the truncated MAC is 192 bits}
939       macLen = 24;
940    \}
941    \textcolor{keywordflow}{else}
942 \textcolor{preprocessor}{#endif}
943 \textcolor{preprocessor}{#if (SNMP\_SHA384\_SUPPORT == ENABLED)}
944    \textcolor{comment}{//HMAC-SHA-384-256 authentication protocol?}
945    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a79c2b9959e9da55e6a4191bd61c9223c}{SNMP\_AUTH\_PROTOCOL\_SHA384})
946    \{
947       \textcolor{comment}{//The length of the truncated MAC is 256 bits}
948       macLen = 32;
949    \}
950    \textcolor{keywordflow}{else}
951 \textcolor{preprocessor}{#endif}
952 \textcolor{preprocessor}{#if (SNMP\_SHA512\_SUPPORT == ENABLED)}
953    \textcolor{comment}{//HMAC-SHA-512-384 authentication protocol?}
954    \textcolor{keywordflow}{if}(authProtocol == \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a0ba8a62eeb03f3f1a0f522833255eadc}{SNMP\_AUTH\_PROTOCOL\_SHA512})
955    \{
956       \textcolor{comment}{//The length of the truncated MAC is 384 bits}
957       macLen = 48;
958    \}
959    \textcolor{keywordflow}{else}
960 \textcolor{preprocessor}{#endif}
961    \textcolor{comment}{//Invalid authentication protocol?}
962    \{
963       \textcolor{comment}{//The authentication protocol is not supported}
964       macLen = 0;
965    \}
966 
967    \textcolor{comment}{//Return the length of the truncated MAC}
968    \textcolor{keywordflow}{return} macLen;
969 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a169a3d5db383131661599d6b19d81ee5}\label{snmp__agent__usm_8c_a169a3d5db383131661599d6b19d81ee5}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Localize\+Key@{snmp\+Localize\+Key}}
\index{snmp\+Localize\+Key@{snmp\+Localize\+Key}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Localize\+Key()}{snmpLocalizeKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Localize\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3}{Snmp\+Auth\+Protocol}}]{auth\+Protocol,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{engine\+Id,  }\item[{size\+\_\+t}]{engine\+Id\+Len,  }\item[{\hyperlink{structSnmpKey}{Snmp\+Key} $\ast$}]{key,  }\item[{\hyperlink{structSnmpKey}{Snmp\+Key} $\ast$}]{localized\+Key }\end{DoxyParamCaption})}



Key localization algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em auth\+Protocol} & Authentication protocol (M\+D5, S\+H\+A-\/1, S\+H\+A-\/224, S\+H\+A-\/256, S\+H\+A384 or S\+H\+A512) \\
\hline
\mbox{\tt in}  & {\em engine\+Id} & Pointer to the engine ID \\
\hline
\mbox{\tt in}  & {\em engine\+Id\+Len} & Length of the engine ID \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key to be localized (Ku) \\
\hline
\mbox{\tt out}  & {\em localized\+Key} & Pointer to the resulting key (Kul) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 238 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
240 \{
241    \textcolor{keyword}{const} \hyperlink{structHashAlgo}{HashAlgo} *hashAlgo;
242    \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} hashContext[\hyperlink{cyclone__crypto_2core_2crypto_8h_a17bccd72e42ecb723e28314749fb1638}{MAX\_HASH\_CONTEXT\_SIZE}];
243 
244    \textcolor{comment}{//Check parameters}
245    \textcolor{keywordflow}{if}(engineId == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && engineIdLen > 0)
246       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
247    \textcolor{keywordflow}{if}(key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || localizedKey == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
248       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
249 
250    \textcolor{comment}{//Get the hash algorithm to be used to generate the key}
251    hashAlgo = \hyperlink{snmp__agent__usm_8c_ac2516fd2164cc67ce314e5f736c43d29}{snmpGetHashAlgo}(authProtocol);
252 
253    \textcolor{comment}{//Invalid authentication protocol?}
254    \textcolor{keywordflow}{if}(hashAlgo == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
255       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
256 
257    \textcolor{comment}{//Localize the key with the engine ID}
258    hashAlgo->\hyperlink{structHashAlgo_a77dcebcb5fd49cd6672ad6c97b55fdee}{init}(hashContext);
259    hashAlgo->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, key, hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
260    hashAlgo->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, engineId, engineIdLen);
261    hashAlgo->\hyperlink{structHashAlgo_a83df6297595f1b9de65143df15fafda4}{update}(hashContext, key, hashAlgo->\hyperlink{structHashAlgo_a0c8ccdb22ea395ccdd8decd06401d22e}{digestSize});
262    hashAlgo->\hyperlink{structHashAlgo_a8a1972d608540bbf31e1932f5403f51d}{final}(hashContext, localizedKey->\hyperlink{structSnmpKey_a5c25e9b803c40ded2a7ee670557954a0}{b});
263 
264    \textcolor{comment}{//Successful processing}
265    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
266 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__usm_8c_a68a80c798e29b1410db2a383af9e8876}\label{snmp__agent__usm_8c_a68a80c798e29b1410db2a383af9e8876}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!snmp\+Refresh\+Engine\+Time@{snmp\+Refresh\+Engine\+Time}}
\index{snmp\+Refresh\+Engine\+Time@{snmp\+Refresh\+Engine\+Time}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Refresh\+Engine\+Time()}{snmpRefreshEngineTime()}}
{\footnotesize\ttfamily void snmp\+Refresh\+Engine\+Time (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Refresh S\+N\+MP engine time. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}


Definition at line 374 of file snmp\+\_\+agent\+\_\+usm.\+c.


\begin{DoxyCode}
375 \{
376    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{coap__common_8h_ab90adf2873f721fb4a969230dbcd7a59}{delta};
377    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} newEngineTime;
378 
379    \textcolor{comment}{//Number of seconds elapsed since the last call}
380    delta = (\hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}() - context->systemTime) / 1000;
381    \textcolor{comment}{//Increment SNMP engine time}
382    newEngineTime = context->engineTime + \hyperlink{coap__common_8h_ab90adf2873f721fb4a969230dbcd7a59}{delta};
383 
384    \textcolor{comment}{//Check whether the SNMP engine time has rolled over}
385    \textcolor{keywordflow}{if}(newEngineTime < context->engineTime)
386    \{
387       \textcolor{comment}{//If snmpEngineTime ever reaches its maximum value (2147483647), then}
388       \textcolor{comment}{//snmpEngineBoots is incremented as if the SNMP engine has re-booted}
389       \textcolor{comment}{//and snmpEngineTime is reset to zero and starts incrementing again}
390       context->engineBoots++;
391       context->engineTime = 0;
392    \}
393    \textcolor{keywordflow}{else}
394    \{
395       \textcolor{comment}{//Update SNMP engine time}
396       context->engineTime = newEngineTime;
397    \}
398 
399    \textcolor{comment}{//Save timestamp}
400    context->systemTime += delta * 1000;
401 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{snmp__agent__usm_8c_ab7cb3fcbc10139e322fd5764fc476b83}\label{snmp__agent__usm_8c_ab7cb3fcbc10139e322fd5764fc476b83}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!usm\+Stats\+Decryption\+Errors\+Object@{usm\+Stats\+Decryption\+Errors\+Object}}
\index{usm\+Stats\+Decryption\+Errors\+Object@{usm\+Stats\+Decryption\+Errors\+Object}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{usm\+Stats\+Decryption\+Errors\+Object}{usmStatsDecryptionErrorsObject}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} usm\+Stats\+Decryption\+Errors\+Object\mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 6, 0\}}



Definition at line 66 of file snmp\+\_\+agent\+\_\+usm.\+c.

\mbox{\Hypertarget{snmp__agent__usm_8c_a6478c64a4ad158f78f425c05bdb04de2}\label{snmp__agent__usm_8c_a6478c64a4ad158f78f425c05bdb04de2}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!usm\+Stats\+Not\+In\+Time\+Windows\+Object@{usm\+Stats\+Not\+In\+Time\+Windows\+Object}}
\index{usm\+Stats\+Not\+In\+Time\+Windows\+Object@{usm\+Stats\+Not\+In\+Time\+Windows\+Object}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{usm\+Stats\+Not\+In\+Time\+Windows\+Object}{usmStatsNotInTimeWindowsObject}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} usm\+Stats\+Not\+In\+Time\+Windows\+Object\mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 2, 0\}}



Definition at line 58 of file snmp\+\_\+agent\+\_\+usm.\+c.

\mbox{\Hypertarget{snmp__agent__usm_8c_a951a44e648083d6ca8c598b66d2c9e95}\label{snmp__agent__usm_8c_a951a44e648083d6ca8c598b66d2c9e95}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!usm\+Stats\+Unknown\+Engine\+Ids\+Object@{usm\+Stats\+Unknown\+Engine\+Ids\+Object}}
\index{usm\+Stats\+Unknown\+Engine\+Ids\+Object@{usm\+Stats\+Unknown\+Engine\+Ids\+Object}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{usm\+Stats\+Unknown\+Engine\+Ids\+Object}{usmStatsUnknownEngineIdsObject}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} usm\+Stats\+Unknown\+Engine\+Ids\+Object\mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 4, 0\}}



Definition at line 62 of file snmp\+\_\+agent\+\_\+usm.\+c.

\mbox{\Hypertarget{snmp__agent__usm_8c_a28a41d2c18565ef5cf40dbaa5e722f9e}\label{snmp__agent__usm_8c_a28a41d2c18565ef5cf40dbaa5e722f9e}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!usm\+Stats\+Unknown\+User\+Names\+Object@{usm\+Stats\+Unknown\+User\+Names\+Object}}
\index{usm\+Stats\+Unknown\+User\+Names\+Object@{usm\+Stats\+Unknown\+User\+Names\+Object}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{usm\+Stats\+Unknown\+User\+Names\+Object}{usmStatsUnknownUserNamesObject}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} usm\+Stats\+Unknown\+User\+Names\+Object\mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 3, 0\}}



Definition at line 60 of file snmp\+\_\+agent\+\_\+usm.\+c.

\mbox{\Hypertarget{snmp__agent__usm_8c_a5d76db11e21399c72fd61262f5e6e612}\label{snmp__agent__usm_8c_a5d76db11e21399c72fd61262f5e6e612}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!usm\+Stats\+Unsupported\+Sec\+Levels\+Object@{usm\+Stats\+Unsupported\+Sec\+Levels\+Object}}
\index{usm\+Stats\+Unsupported\+Sec\+Levels\+Object@{usm\+Stats\+Unsupported\+Sec\+Levels\+Object}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{usm\+Stats\+Unsupported\+Sec\+Levels\+Object}{usmStatsUnsupportedSecLevelsObject}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} usm\+Stats\+Unsupported\+Sec\+Levels\+Object\mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 1, 0\}}



Definition at line 56 of file snmp\+\_\+agent\+\_\+usm.\+c.

\mbox{\Hypertarget{snmp__agent__usm_8c_ae5a8d4dd03f5da308589c11989af6b71}\label{snmp__agent__usm_8c_ae5a8d4dd03f5da308589c11989af6b71}} 
\index{snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}!usm\+Stats\+Wrong\+Digests\+Object@{usm\+Stats\+Wrong\+Digests\+Object}}
\index{usm\+Stats\+Wrong\+Digests\+Object@{usm\+Stats\+Wrong\+Digests\+Object}!snmp\+\_\+agent\+\_\+usm.\+c@{snmp\+\_\+agent\+\_\+usm.\+c}}
\subsubsection{\texorpdfstring{usm\+Stats\+Wrong\+Digests\+Object}{usmStatsWrongDigestsObject}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} usm\+Stats\+Wrong\+Digests\+Object\mbox{[}10\mbox{]} = \{43, 6, 1, 6, 3, 15, 1, 1, 5, 0\}}



Definition at line 64 of file snmp\+\_\+agent\+\_\+usm.\+c.

