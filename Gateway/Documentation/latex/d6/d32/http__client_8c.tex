\hypertarget{http__client_8c}{}\section{cyclone\+\_\+tcp/http/http\+\_\+client.c File Reference}
\label{http__client_8c}\index{cyclone\+\_\+tcp/http/http\+\_\+client.\+c@{cyclone\+\_\+tcp/http/http\+\_\+client.\+c}}


H\+T\+TP client (Hyper\+Text Transfer Protocol)  


{\ttfamily \#include $<$limits.\+h$>$}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http/http\+\_\+client.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http/http\+\_\+client\+\_\+auth.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http/http\+\_\+client\+\_\+transport.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}http/http\+\_\+client\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}str.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{http__client_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_ace1dd0cc4628f20c72a1d8dc9612d2f1}{H\+T\+T\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a04767b6b9be98adebcac93c6bf00b6a6}{http\+Client\+Init} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Initialize H\+T\+TP client context. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ac28f4a8765b350ffdb1a58a24ce44e43}{http\+Client\+Register\+Tls\+Init\+Callback} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, \hyperlink{http__client_8h_a7627ce7ef31eba950fa770eceb5a4cf2}{Http\+Client\+Tls\+Init\+Callback} callback)
\begin{DoxyCompactList}\small\item\em Register T\+LS initialization callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_aa85a485d80c0c7d5a7130188cd1d14bd}{http\+Client\+Register\+Rand\+Callback} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, \hyperlink{http__client_8h_a034d564bf21de50a08d13ea832881ec0}{Http\+Client\+Rand\+Callback} callback)
\begin{DoxyCompactList}\small\item\em Register random data generation callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_aa0a9b170cae6b61a3fa46201cb12d4ad}{http\+Client\+Set\+Version} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, \hyperlink{http__common_8h_ac870fd261da652aee69937751c6f7e7f}{Http\+Version} \hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Set the H\+T\+TP protocol version to be used. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a6e4fa56d0dcca88643793fe1d5e3b1cd}{http\+Client\+Set\+Timeout} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} timeout)
\begin{DoxyCompactList}\small\item\em Set communication timeout. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ab560846ee44725c51fb88576996aaf26}{http\+Client\+Set\+Auth\+Info} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$username, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$password)
\begin{DoxyCompactList}\small\item\em Set authentication information. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ad30e92d0638617623fb44658f9124acf}{http\+Client\+Bind\+To\+Interface} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Bind the H\+T\+TP client to a particular network interface. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ac032a0e53828bd754c5c6762eba948f7}{http\+Client\+Connect} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$server\+Ip\+Addr, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} server\+Port)
\begin{DoxyCompactList}\small\item\em Establish a connection with the specified H\+T\+TP server. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ab2598921fb86c358b8d61c05dd5c296f}{http\+Client\+Create\+Request} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Create a new H\+T\+TP request. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_abc2579039e117a48e20a029780e402a7}{http\+Client\+Set\+Method} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$method)
\begin{DoxyCompactList}\small\item\em Set H\+T\+TP request method. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ac3e8485707a87f2a326b909dc54072a2}{http\+Client\+Set\+Uri} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$uri)
\begin{DoxyCompactList}\small\item\em Set request U\+RI. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ab4b6d53971e735b341511a3ecf8df229}{http\+Client\+Set\+Host} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$host, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port})
\begin{DoxyCompactList}\small\item\em Set the hostname and port number of the resource being requested. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ae55d5813a216383f203bd49bff99bba1}{http\+Client\+Set\+Query\+String} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$query\+String)
\begin{DoxyCompactList}\small\item\em Set query string. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_abd0677ea2b617a73076ca4af257ca70f}{http\+Client\+Add\+Query\+Param} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Add a key/value pair to the query string. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ad725672fa7ec139fcf69542feb9cb9d1}{http\+Client\+Add\+Header\+Field} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Add a header field to the H\+T\+TP request. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a40cb7f252ac0a41ede333f5d8d61392b}{http\+Client\+Format\+Header\+Field} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Format an H\+T\+TP header field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a4d73bfbaeb6fd224dc2bd836f3143354}{http\+Client\+Set\+Content\+Length} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Set the length of the H\+T\+TP request body. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ad5d0fa0d0956d2acae73a732b0145532}{http\+Client\+Write\+Header} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Write H\+T\+TP request header. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ad8fc7e7ab6e112f6152c173e58f35ef7}{http\+Client\+Write\+Body} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$written, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags})
\begin{DoxyCompactList}\small\item\em Write H\+T\+TP request body. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a231bbf939dd131f242a639f9e73853a9}{http\+Client\+Write\+Trailer} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Write H\+T\+TP trailer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ac04a874a7b838d86e1ed0941dffd5437}{http\+Client\+Read\+Header} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Read H\+T\+TP response header. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{http__client_8c_abc9e4d34400af007f2040495d035b281}{http\+Client\+Get\+Status} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Retrieve the H\+T\+TP status code of the response. \end{DoxyCompactList}\item 
const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$ \hyperlink{http__client_8c_a9f3c2c67754c9a5bcfb8ad962811c2de}{http\+Client\+Get\+Header\+Field} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name})
\begin{DoxyCompactList}\small\item\em Retrieve the value of the specified header field name. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_aefbf15c772ad6dfa969524bdf020be7a}{http\+Client\+Get\+Next\+Header\+Field} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$$\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$$\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Iterate through the H\+T\+TP response header. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a0e89f9c3c9b5535d4d188dee3c0b2f12}{http\+Client\+Read\+Body} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context, void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t size, size\+\_\+t $\ast$received, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{nbns__common_8h_a1e87af3c18a2fd36c61faf89949bdc3f}{flags})
\begin{DoxyCompactList}\small\item\em Read H\+T\+TP response body. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a2d916637804f8dccb8cd967670263de7}{http\+Client\+Read\+Trailer} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Read H\+T\+TP trailer. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_ad7211fd71ba5bb08049009e375356033}{http\+Client\+Close\+Body} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Close H\+T\+TP request or response body. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a72f5dd692819021e1fac5a0a2d3503d6}{http\+Client\+Disconnect} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Gracefully disconnect from the H\+T\+TP server. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{http__client_8c_a0f4b83bc7866b8ee5459cc58290f42c9}{http\+Client\+Close} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Close the connection with the H\+T\+TP server. \end{DoxyCompactList}\item 
void \hyperlink{http__client_8c_ade3fe132593cd5dd7dc4eb05cb4b9c1f}{http\+Client\+Deinit} (\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Release H\+T\+TP client context. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
H\+T\+TP client (Hyper\+Text Transfer Protocol) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
The Hypertext Transfer Protocol (H\+T\+TP) is an application-\/level protocol for distributed, collaborative, hypermedia information systems. Refer to the following R\+F\+Cs for complete details\+:
\begin{DoxyItemize}
\item R\+FC 1945\+: Hypertext Transfer Protocol -\/ H\+T\+T\+P/1.\+0
\item R\+FC 2616\+: Hypertext Transfer Protocol -\/ H\+T\+T\+P/1.\+1
\item R\+FC 2818\+: H\+T\+TP Over T\+LS
\item R\+FC 7230\+: Hypertext Transfer Protocol (H\+T\+T\+P/1.\+1)\+: Message Syntax and Routing
\item R\+FC 7231\+: Hypertext Transfer Protocol (H\+T\+T\+P/1.\+1)\+: Semantics and Content
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{http__client_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{http__client_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_ace1dd0cc4628f20c72a1d8dc9612d2f1}{H\+T\+T\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 43 of file http\+\_\+client.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{http__client_8c_ad725672fa7ec139fcf69542feb9cb9d1}\label{http__client_8c_ad725672fa7ec139fcf69542feb9cb9d1}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Add\+Header\+Field@{http\+Client\+Add\+Header\+Field}}
\index{http\+Client\+Add\+Header\+Field@{http\+Client\+Add\+Header\+Field}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Add\+Header\+Field()}{httpClientAddHeaderField()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Add\+Header\+Field (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{name,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Add a header field to the H\+T\+TP request. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em name} & N\+U\+L\+L-\/terminated string that holds the header field name \\
\hline
\mbox{\tt in}  & {\em value} & N\+U\+L\+L-\/terminated string that holds the header field value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 809 of file http\+\_\+client.\+c.


\begin{DoxyCode}
811 \{
812    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
813    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
814    \textcolor{keywordtype}{size\_t} nameLen;
815    \textcolor{keywordtype}{size\_t} valueLen;
816 
817    \textcolor{comment}{//Check parameters}
818    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
819       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
820 
821    \textcolor{comment}{//The field name must not be empty}
822    \textcolor{keywordflow}{if}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}[0] == \textcolor{charliteral}{'\(\backslash\)0'})
823       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
824 
825    \textcolor{comment}{//Check HTTP request state}
826    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER} &&
827       context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a59a40d0faad7f72e050bfc3e638ab188}{HTTP\_REQ\_STATE\_FORMAT\_TRAILER})
828    \{
829       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
830    \}
831 
832    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
833    \textcolor{keywordflow}{if}(context->bufferLen < 2 || context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
834       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
835 
836    \textcolor{comment}{//Retrieve the length of the field name and value}
837    nameLen = strlen(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name});
838    valueLen = strlen(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
839 
840    \textcolor{comment}{//Determine the length of the new header field}
841    n = nameLen + valueLen + 4;
842 
843    \textcolor{comment}{//Make sure the buffer is large enough to hold the new header field}
844    \textcolor{keywordflow}{if}((context->bufferLen + n) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
845       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
846 
847    \textcolor{comment}{//Each header field consists of a case-insensitive field name followed}
848    \textcolor{comment}{//by a colon, optional leading whitespace and the field value}
849    sprintf(context->buffer + context->bufferLen - 2, \textcolor{stringliteral}{"%s: %s\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"},
850       \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
851 
852    \textcolor{comment}{//Check header field name}
853    \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \textcolor{stringliteral}{"Connection"}))
854    \{
855       \textcolor{comment}{//Parse Connection header field}
856       error = \hyperlink{http__client__misc_8c_a8b9e472b34f513a22786c41294e9bed2}{httpClientParseConnectionField}(context, 
      \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
857    \}
858    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \textcolor{stringliteral}{"Transfer-Encoding"}))
859    \{
860       \textcolor{comment}{//Parse Transfer-Encoding header field}
861       error = \hyperlink{http__client__misc_8c_adc1038f243e8d48570fe633f7098c4f8}{httpClientParseTransferEncodingField}(context, 
      \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
862    \}
863    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \textcolor{stringliteral}{"Content-Length"}))
864    \{
865       \textcolor{comment}{//Parse Content-Length header field}
866       error = \hyperlink{http__client__misc_8c_a3fafda6f1465f5e64086966e3dd20a65}{httpClientParseContentLengthField}(context, 
      \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
867    \}
868    \textcolor{keywordflow}{else}
869    \{
870       \textcolor{comment}{//Discard unknown header fields}
871       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
872    \}
873 
874    \textcolor{comment}{//Adjust the length of the request header}
875    context->bufferLen += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
876 
877    \textcolor{comment}{//Return status code}
878    \textcolor{keywordflow}{return} error;
879 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_abd0677ea2b617a73076ca4af257ca70f}\label{http__client_8c_abd0677ea2b617a73076ca4af257ca70f}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Add\+Query\+Param@{http\+Client\+Add\+Query\+Param}}
\index{http\+Client\+Add\+Query\+Param@{http\+Client\+Add\+Query\+Param}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Add\+Query\+Param()}{httpClientAddQueryParam()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Add\+Query\+Param (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{name,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Add a key/value pair to the query string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em name} & N\+U\+L\+L-\/terminated string that holds the parameter name \\
\hline
\mbox{\tt in}  & {\em value} & N\+U\+L\+L-\/terminated string that holds the parameter value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 692 of file http\+\_\+client.\+c.


\begin{DoxyCode}
694 \{
695    \textcolor{keywordtype}{size\_t} nameLen;
696    \textcolor{keywordtype}{size\_t} valueLen;
697    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} separator;
698    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
699 
700    \textcolor{comment}{//Check parameters}
701    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
702       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
703 
704    \textcolor{comment}{//The parameter name must not be empty}
705    \textcolor{keywordflow}{if}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}[0] == \textcolor{charliteral}{'\(\backslash\)0'})
706       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
707 
708    \textcolor{comment}{//Check HTTP request state}
709    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER})
710       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
711 
712    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
713    \textcolor{keywordflow}{if}(context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
714       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
715 
716    \textcolor{comment}{//Properly terminate the string with a NULL character}
717    context->buffer[context->bufferLen] = \textcolor{charliteral}{'\(\backslash\)0'};
718 
719    \textcolor{comment}{//The Request-Line begins with a method token}
720    p = strchr(context->buffer, \textcolor{charliteral}{' '});
721    \textcolor{comment}{//Any parsing error?}
722    \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
723       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
724 
725    \textcolor{comment}{//The method token is followed by the Request-URI}
726    p = strpbrk(p + 1, \textcolor{stringliteral}{" ?"});
727    \textcolor{comment}{//Any parsing error?}
728    \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
729       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
730 
731    \textcolor{comment}{//The question mark is used as a separator}
732    \textcolor{keywordflow}{if}(*p == \textcolor{charliteral}{'?'})
733    \{
734       \textcolor{comment}{//Point to the end of the query string}
735       p = strchr(p + 1, \textcolor{charliteral}{' '});
736       \textcolor{comment}{//Any parsing error?}
737       \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
738          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
739 
740       \textcolor{comment}{//multiple query parameters are separated by an ampersand}
741       separator = \textcolor{charliteral}{'&'};
742    \}
743    \textcolor{keywordflow}{else}
744    \{
745       \textcolor{comment}{//The query string is not present}
746       separator = \textcolor{charliteral}{'?'};
747    \}
748 
749    \textcolor{comment}{//Compute the length of the parameter value}
750    nameLen = strlen(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name});
751 
752    \textcolor{comment}{//Empty parameter value?}
753    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
754    \{
755       \textcolor{comment}{//Make sure the buffer is large enough to hold the new query parameter}
756       \textcolor{keywordflow}{if}((context->bufferLen + nameLen + 1) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
757          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
758 
759       \textcolor{comment}{//Make room for the new query parameter}
760       memmove(p + nameLen + 1, p, context->buffer + context->bufferLen + 1 - p);
761 
762       \textcolor{comment}{//Multiple query parameters are separated by a delimiter}
763       p[0] = separator;
764       \textcolor{comment}{//Copy parameter name}
765       strncpy(p + 1, \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, nameLen);
766 
767       \textcolor{comment}{//Adjust the length of the request header}
768       context->bufferLen += nameLen + 1;
769    \}
770    \textcolor{keywordflow}{else}
771    \{
772       \textcolor{comment}{//Compute the length of the parameter value}
773       valueLen = strlen(\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value});
774 
775       \textcolor{comment}{//Make sure the buffer is large enough to hold the new query parameter}
776       \textcolor{keywordflow}{if}((context->bufferLen + nameLen + valueLen + 2) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
777          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
778 
779       \textcolor{comment}{//Make room for the new query parameter}
780       memmove(p + nameLen + valueLen + 2, p, context->buffer +
781          context->bufferLen + 1 - p);
782 
783       \textcolor{comment}{//Multiple query parameters are separated by a delimiter}
784       p[0] = separator;
785       \textcolor{comment}{//Copy parameter name}
786       strncpy(p + 1, \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, nameLen);
787       \textcolor{comment}{//The field name and value are separated by an equals sign}
788       p[nameLen + 1] = \textcolor{charliteral}{'='};
789       \textcolor{comment}{//Copy parameter value}
790       strncpy(p + nameLen + 2, \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}, valueLen);
791 
792       \textcolor{comment}{//Adjust the length of the request header}
793       context->bufferLen += nameLen + valueLen + 2;
794    \}
795 
796    \textcolor{comment}{//Successful processing}
797    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
798 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ad30e92d0638617623fb44658f9124acf}\label{http__client_8c_ad30e92d0638617623fb44658f9124acf}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Bind\+To\+Interface@{http\+Client\+Bind\+To\+Interface}}
\index{http\+Client\+Bind\+To\+Interface@{http\+Client\+Bind\+To\+Interface}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Bind\+To\+Interface()}{httpClientBindToInterface()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Bind\+To\+Interface (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Bind the H\+T\+TP client to a particular network interface. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em interface} & Network interface to be used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 247 of file http\+\_\+client.\+c.


\begin{DoxyCode}
249 \{
250    \textcolor{comment}{//Make sure the HTTP client context is valid}
251    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
252       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
253 
254    \textcolor{comment}{//Explicitly associate the HTTP client with the specified interface}
255    context->interface = interface;
256 
257    \textcolor{comment}{//Successful processing}
258    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
259 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a0f4b83bc7866b8ee5459cc58290f42c9}\label{http__client_8c_a0f4b83bc7866b8ee5459cc58290f42c9}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Close@{http\+Client\+Close}}
\index{http\+Client\+Close@{http\+Client\+Close}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Close()}{httpClientClose()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Close (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Close the connection with the H\+T\+TP server. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2222 of file http\+\_\+client.\+c.


\begin{DoxyCode}
2223 \{
2224    \textcolor{comment}{//Make sure the HTTP client context is valid}
2225    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
2226       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
2227 
2228    \textcolor{comment}{//Close connection}
2229    \hyperlink{http__client__transport_8c_a351f8d2c24b90aac02e95f8bed07efdb}{httpClientCloseConnection}(context);
2230    \textcolor{comment}{//Update HTTP connection state}
2231    \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED});
2232 
2233    \textcolor{comment}{//Successful processing}
2234    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2235 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ad7211fd71ba5bb08049009e375356033}\label{http__client_8c_ad7211fd71ba5bb08049009e375356033}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Close\+Body@{http\+Client\+Close\+Body}}
\index{http\+Client\+Close\+Body@{http\+Client\+Close\+Body}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Close\+Body()}{httpClientCloseBody()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Close\+Body (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Close H\+T\+TP request or response body. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2010 of file http\+\_\+client.\+c.


\begin{DoxyCode}
2011 \{
2012    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2013    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2014 
2015    \textcolor{comment}{//Make sure the HTTP client context is valid}
2016    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
2017       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
2018 
2019    \textcolor{comment}{//Initialize status code}
2020    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2021 
2022    \textcolor{comment}{//Close HTTP request or response body}
2023    \textcolor{keywordflow}{while}(!error)
2024    \{
2025       \textcolor{comment}{//Check HTTP connection state}
2026       \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
2027       \{
2028          \textcolor{comment}{//Check HTTP request state}
2029          \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a4b7be0c1456c3de2bfa2eb8f6f9be7f4}{HTTP\_REQ\_STATE\_SEND\_BODY})
2030          \{
2031             \textcolor{comment}{//Chunked transfer encoding?}
2032             \textcolor{keywordflow}{if}(context->chunkedEncoding)
2033             \{
2034                \textcolor{comment}{//The chunked encoding is ended by any chunk whose size is zero}
2035                error = \hyperlink{http__client__misc_8c_a6f213287a2c06305dbc6fb54a0499717}{httpClientFormatChunkSize}(context, 0);
2036             \}
2037             \textcolor{keywordflow}{else}
2038             \{
2039                \textcolor{comment}{//Ensure the HTTP request body is complete}
2040                \textcolor{keywordflow}{if}(context->bodyPos == context->bodyLen)
2041                \{
2042                   \textcolor{comment}{//Flush receive buffer}
2043                   context->bufferLen = 0;
2044                   context->bufferPos = 0;
2045 
2046                   \textcolor{comment}{//Receive the HTTP response header}
2047                   \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context,
2048                      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE});
2049                \}
2050                \textcolor{keywordflow}{else}
2051                \{
2052                   \textcolor{comment}{//Incomplete request body}
2053                   error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
2054                \}
2055             \}
2056          \}
2057          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac9eaf361a36f169f32dcbcc4e6fceaa6}{HTTP\_REQ\_STATE\_SEND\_CHUNK\_DATA})
2058          \{
2059             \textcolor{comment}{//Ensure the chunk data is complete}
2060             \textcolor{keywordflow}{if}(context->bodyPos == context->bodyLen)
2061             \{
2062                \textcolor{comment}{//The chunked encoding is ended by any chunk whose size is zero}
2063                error = \hyperlink{http__client__misc_8c_a6f213287a2c06305dbc6fb54a0499717}{httpClientFormatChunkSize}(context, 0);
2064             \}
2065             \textcolor{keywordflow}{else}
2066             \{
2067                \textcolor{comment}{//Incomplete chunk data}
2068                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
2069             \}
2070          \}
2071          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a59a40d0faad7f72e050bfc3e638ab188}{HTTP\_REQ\_STATE\_FORMAT\_TRAILER} ||
2072             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE})
2073          \{
2074             \textcolor{comment}{//The HTTP request body is closed}
2075             \textcolor{keywordflow}{break};
2076          \}
2077          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671afea85d0ad1ddb4758b18bc6b41e46ef4}{HTTP\_REQ\_STATE\_PARSE\_HEADER} ||
2078             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671aaec3a90d3ca46a7b85990ecc31eac3ee}{HTTP\_REQ\_STATE\_RECEIVE\_BODY} ||
2079             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a9fa6359ea11fcf53b68776ca53ab0002}{HTTP\_REQ\_STATE\_RECEIVE\_CHUNK\_SIZE} ||
2080             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac5f01fe75ddc6a2ddc4ec9e79e5a4cdd}{HTTP\_REQ\_STATE\_RECEIVE\_CHUNK\_DATA})
2081          \{
2082             \textcolor{comment}{//Consume HTTP response body}
2083             error = \hyperlink{http__client_8c_a0e89f9c3c9b5535d4d188dee3c0b2f12}{httpClientReadBody}(context, context->buffer,
2084                \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE}, &n, 0);
2085 
2086             \textcolor{comment}{//Check whether the end of the response body has been reached}
2087             \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM})
2088             \{
2089                \textcolor{comment}{//Continue reading the optional trailer}
2090                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2091             \}
2092          \}
2093          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671abe0376963cfae76ec97eb7d9548db2a8}{HTTP\_REQ\_STATE\_RECEIVE\_TRAILER})
2094          \{
2095             \textcolor{comment}{//Consume HTTP trailer}
2096             error = \hyperlink{http__client_8c_a2d916637804f8dccb8cd967670263de7}{httpClientReadTrailer}(context);
2097          \}
2098          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7ccac80d24cd15b29279173b1c7ba855}{HTTP\_REQ\_STATE\_PARSE\_TRAILER} ||
2099             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23282be8248114e118085936752d789}{HTTP\_REQ\_STATE\_COMPLETE})
2100          \{
2101             \textcolor{comment}{//The HTTP response body is closed}
2102             \textcolor{keywordflow}{break};
2103          \}
2104          \textcolor{keywordflow}{else}
2105          \{
2106             \textcolor{comment}{//Invalid HTTP request state}
2107             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
2108          \}
2109       \}
2110       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a41c0ddfb8cd18ecb0bcbc50815f8af34}{HTTP\_CLIENT\_STATE\_DISCONNECTING})
2111       \{
2112          \textcolor{comment}{//Shutdown connection}
2113          error = \hyperlink{http__client_8c_a72f5dd692819021e1fac5a0a2d3503d6}{httpClientDisconnect}(context);
2114       \}
2115       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED})
2116       \{
2117          \textcolor{comment}{//Rewind to the beginning of the buffer}
2118          context->bufferPos = 0;
2119          \textcolor{comment}{//We are done}
2120          \textcolor{keywordflow}{break};
2121       \}
2122       \textcolor{keywordflow}{else}
2123       \{
2124          \textcolor{comment}{//Invalid HTTP connection state}
2125          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
2126       \}
2127    \}
2128 
2129    \textcolor{comment}{//Check status code}
2130    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
2131    \{
2132       \textcolor{comment}{//Check whether the timeout has elapsed}
2133       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
2134    \}
2135 
2136    \textcolor{comment}{//Return status code}
2137    \textcolor{keywordflow}{return} error;
2138 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ac032a0e53828bd754c5c6762eba948f7}\label{http__client_8c_ac032a0e53828bd754c5c6762eba948f7}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Connect@{http\+Client\+Connect}}
\index{http\+Client\+Connect@{http\+Client\+Connect}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Connect()}{httpClientConnect()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Connect (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$}]{server\+Ip\+Addr,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{server\+Port }\end{DoxyParamCaption})}



Establish a connection with the specified H\+T\+TP server. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em server\+Ip\+Addr} & IP address of the H\+T\+TP server to connect to \\
\hline
\mbox{\tt in}  & {\em server\+Port} & Port number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 270 of file http\+\_\+client.\+c.


\begin{DoxyCode}
272 \{
273    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
274 
275    \textcolor{comment}{//Make sure the HTTP client context is valid}
276    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
277       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
278 
279    \textcolor{comment}{//Initialize status code}
280    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
281 
282    \textcolor{comment}{//Establish connection with the HTTP server}
283    \textcolor{keywordflow}{while}(!error)
284    \{
285       \textcolor{comment}{//Check HTTP connection state}
286       \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED})
287       \{
288          \textcolor{comment}{//First connection attempt?}
289          \textcolor{keywordflow}{if}(serverIpAddr != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
290          \{
291             \textcolor{comment}{//Save the IP address of the HTTP server}
292             context->serverIpAddr = *serverIpAddr;
293             \textcolor{comment}{//Save the TCP port number to be used}
294             context->serverPort = serverPort;
295 
296 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_AUTH\_SUPPORT == ENABLED)}
297             \textcolor{comment}{//HTTP authentication is not used for the first connection attempt}
298             \hyperlink{http__client__auth_8c_a5a35610019417b47ed7a8f39ed3e5a16}{httpClientInitAuthParams}(&context->authParams);
299 \textcolor{preprocessor}{#endif}
300          \}
301 
302          \textcolor{comment}{//Open network connection}
303          error = \hyperlink{http__client__transport_8c_a868d37acdbd55771f6fe0342461edc08}{httpClientOpenConnection}(context);
304 
305          \textcolor{comment}{//Check status code}
306          \textcolor{keywordflow}{if}(!error)
307          \{
308             \textcolor{comment}{//Establish network connection}
309             \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5ab580e6f09d3f17c40782dd66290aa4bc}{HTTP\_CLIENT\_STATE\_CONNECTING});
310          \}
311       \}
312       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5ab580e6f09d3f17c40782dd66290aa4bc}{HTTP\_CLIENT\_STATE\_CONNECTING})
313       \{
314          \textcolor{comment}{//Establish network connection}
315          error = \hyperlink{http__client__transport_8c_a7471a82fe3c72c2acf2243e1904c48f4}{httpClientEstablishConnection}(context, &context->serverIpAddr
      ,
316             context->serverPort);
317 
318          \textcolor{comment}{//Check status code}
319          \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
320          \{
321             \textcolor{comment}{//The client is connected to the HTTP server}
322             \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED});
323          \}
324          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
325          \{
326             \textcolor{comment}{//Check whether the timeout has elapsed}
327             error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
328          \}
329          \textcolor{keywordflow}{else}
330          \{
331             \textcolor{comment}{//A communication error has occured}
332          \}
333       \}
334       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
335       \{
336          \textcolor{comment}{//The HTTP client is connected}
337          \textcolor{keywordflow}{break};
338       \}
339       \textcolor{keywordflow}{else}
340       \{
341          \textcolor{comment}{//Invalid state}
342          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
343       \}
344    \}
345 
346    \textcolor{comment}{//Failed to establish connection with the HTTP server?}
347    \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} && error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK})
348    \{
349       \textcolor{comment}{//Clean up side effects}
350       \hyperlink{http__client__transport_8c_a351f8d2c24b90aac02e95f8bed07efdb}{httpClientCloseConnection}(context);
351       \textcolor{comment}{//Update HTTP connection state}
352       \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED});
353    \}
354 
355    \textcolor{comment}{//Return status code}
356    \textcolor{keywordflow}{return} error;
357 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ab2598921fb86c358b8d61c05dd5c296f}\label{http__client_8c_ab2598921fb86c358b8d61c05dd5c296f}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Create\+Request@{http\+Client\+Create\+Request}}
\index{http\+Client\+Create\+Request@{http\+Client\+Create\+Request}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Create\+Request()}{httpClientCreateRequest()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Create\+Request (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Create a new H\+T\+TP request. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 366 of file http\+\_\+client.\+c.


\begin{DoxyCode}
367 \{
368    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
369 
370    \textcolor{comment}{//Make sure the HTTP client context is valid}
371    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
372       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
373 
374    \textcolor{comment}{//Format default HTTP request header}
375    error = \hyperlink{http__client__misc_8c_a4f91ec49f3492fdd4a25d60fbdd8ca7e}{httpClientFormatRequestHeader}(context);
376 
377    \textcolor{comment}{//Check status code}
378    \textcolor{keywordflow}{if}(!error)
379    \{
380       \textcolor{comment}{//The HTTP request body is empty}
381       context->bodyLen = 0;
382       context->bodyPos = 0;
383 
384       \textcolor{comment}{//Reset status code}
385       context->statusCode = 0;
386 
387       \textcolor{comment}{//Update HTTP request state}
388       \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER});
389    \}
390 
391    \textcolor{comment}{//Return status code}
392    \textcolor{keywordflow}{return} error;
393 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ade3fe132593cd5dd7dc4eb05cb4b9c1f}\label{http__client_8c_ade3fe132593cd5dd7dc4eb05cb4b9c1f}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Deinit@{http\+Client\+Deinit}}
\index{http\+Client\+Deinit@{http\+Client\+Deinit}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Deinit()}{httpClientDeinit()}}
{\footnotesize\ttfamily void http\+Client\+Deinit (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Release H\+T\+TP client context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}


Definition at line 2243 of file http\+\_\+client.\+c.


\begin{DoxyCode}
2244 \{
2245    \textcolor{comment}{//Make sure the HTTP client context is valid}
2246    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
2247    \{
2248       \textcolor{comment}{//Close connection}
2249       \hyperlink{http__client__transport_8c_a351f8d2c24b90aac02e95f8bed07efdb}{httpClientCloseConnection}(context);
2250 
2251 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_TLS\_SUPPORT == ENABLED)}
2252       \textcolor{comment}{//Release TLS session state}
2253       \hyperlink{tls_8c_a6e78d966a9bcd9eb6210c996389f6551}{tlsFreeSessionState}(&context->tlsSession);
2254 \textcolor{preprocessor}{#endif}
2255 
2256       \textcolor{comment}{//Clear HTTP client context}
2257       memset(context, 0, \textcolor{keyword}{sizeof}(\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{HttpClientContext}));
2258    \}
2259 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a72f5dd692819021e1fac5a0a2d3503d6}\label{http__client_8c_a72f5dd692819021e1fac5a0a2d3503d6}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Disconnect@{http\+Client\+Disconnect}}
\index{http\+Client\+Disconnect@{http\+Client\+Disconnect}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Disconnect()}{httpClientDisconnect()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Disconnect (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Gracefully disconnect from the H\+T\+TP server. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2147 of file http\+\_\+client.\+c.


\begin{DoxyCode}
2148 \{
2149    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2150 
2151    \textcolor{comment}{//Make sure the HTTP client context is valid}
2152    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
2153       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
2154 
2155    \textcolor{comment}{//Initialize status code}
2156    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2157 
2158    \textcolor{comment}{//Execute HTTP command sequence}
2159    \textcolor{keywordflow}{while}(!error)
2160    \{
2161       \textcolor{comment}{//Check HTTP connection state}
2162       \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
2163       \{
2164          \textcolor{comment}{//Gracefully disconnect from the HTTP server}
2165          \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a41c0ddfb8cd18ecb0bcbc50815f8af34}{HTTP\_CLIENT\_STATE\_DISCONNECTING});
2166       \}
2167       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a41c0ddfb8cd18ecb0bcbc50815f8af34}{HTTP\_CLIENT\_STATE\_DISCONNECTING})
2168       \{
2169          \textcolor{comment}{//Shutdown connection}
2170          error = \hyperlink{http__client__transport_8c_a021c7cf572ec60c8630027eb7cb64143}{httpClientShutdownConnection}(context);
2171 
2172          \textcolor{comment}{//Check status code}
2173          \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
2174          \{
2175             \textcolor{comment}{//Close connection}
2176             \hyperlink{http__client__transport_8c_a351f8d2c24b90aac02e95f8bed07efdb}{httpClientCloseConnection}(context);
2177             \textcolor{comment}{//Update HTTP connection state}
2178             \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED});
2179          \}
2180          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
2181          \{
2182             \textcolor{comment}{//Check whether the timeout has elapsed}
2183             error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
2184          \}
2185          \textcolor{keywordflow}{else}
2186          \{
2187             \textcolor{comment}{//A communication error has occured}
2188          \}
2189       \}
2190       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED})
2191       \{
2192          \textcolor{comment}{//We are done}
2193          \textcolor{keywordflow}{break};
2194       \}
2195       \textcolor{keywordflow}{else}
2196       \{
2197          \textcolor{comment}{//Invalid state}
2198          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
2199       \}
2200    \}
2201 
2202    \textcolor{comment}{//Failed to gracefully disconnect from the HTTP server?}
2203    \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} && error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK})
2204    \{
2205       \textcolor{comment}{//Close connection}
2206       \hyperlink{http__client__transport_8c_a351f8d2c24b90aac02e95f8bed07efdb}{httpClientCloseConnection}(context);
2207       \textcolor{comment}{//Update HTTP connection state}
2208       \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED});
2209    \}
2210 
2211    \textcolor{comment}{//Return status code}
2212    \textcolor{keywordflow}{return} error;
2213 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a40cb7f252ac0a41ede333f5d8d61392b}\label{http__client_8c_a40cb7f252ac0a41ede333f5d8d61392b}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Format\+Header\+Field@{http\+Client\+Format\+Header\+Field}}
\index{http\+Client\+Format\+Header\+Field@{http\+Client\+Format\+Header\+Field}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Format\+Header\+Field()}{httpClientFormatHeaderField()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Format\+Header\+Field (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{name,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})}



Format an H\+T\+TP header field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em name} & N\+U\+L\+L-\/terminated string that holds the header field name \\
\hline
\mbox{\tt in}  & {\em format} & N\+U\+L\+L-\/terminated string that that contains a format string \\
\hline
\mbox{\tt in}  & {\em ...} & Optional arguments \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 891 of file http\+\_\+client.\+c.


\begin{DoxyCode}
893 \{
894    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
895    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
896    \textcolor{keywordtype}{size\_t} size;
897    \textcolor{keywordtype}{size\_t} nameLen;
898    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
899    va\_list args;
900 
901    \textcolor{comment}{//Check parameters}
902    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || format == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
903       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
904 
905    \textcolor{comment}{//The field name must not be empty}
906    \textcolor{keywordflow}{if}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}[0] == \textcolor{charliteral}{'\(\backslash\)0'})
907       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
908 
909    \textcolor{comment}{//Check HTTP request state}
910    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER} &&
911       context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a59a40d0faad7f72e050bfc3e638ab188}{HTTP\_REQ\_STATE\_FORMAT\_TRAILER})
912    \{
913       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
914    \}
915 
916    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
917    \textcolor{keywordflow}{if}(context->bufferLen < 2 || context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
918       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
919 
920    \textcolor{comment}{//Retrieve the length of the field name}
921    nameLen = strlen(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name});
922 
923    \textcolor{comment}{//Make sure the buffer is large enough to hold the new header field}
924    \textcolor{keywordflow}{if}((context->bufferLen + nameLen + 4) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
925       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
926 
927    \textcolor{comment}{//Point to the buffer where to format the field value}
928    value = context->buffer + context->bufferLen + nameLen;
929    \textcolor{comment}{//Calculate the maximum size of the formatted string}
930    size = \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE} - context->bufferLen - nameLen - 4;
931 
932    \textcolor{comment}{//Initialize processing of a varying-length argument list}
933    va\_start(args, format);
934    \textcolor{comment}{//Format field value}
935    n = vsnprintf(value, size, format, args);
936    \textcolor{comment}{//End varying-length argument list processing}
937    va\_end(args);
938 
939    \textcolor{comment}{//A return value of size or more means that the output was truncated}
940    \textcolor{keywordflow}{if}(n >= size)
941       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
942 
943    \textcolor{comment}{//Each header field consists of a case-insensitive field name followed}
944    \textcolor{comment}{//by a colon, optional leading whitespace and the field value}
945    strncpy(context->buffer + context->bufferLen - 2, \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, nameLen);
946    strncpy(context->buffer + context->bufferLen + nameLen - 2, \textcolor{stringliteral}{": "}, 2);
947 
948    \textcolor{comment}{//Check header field name}
949    \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \textcolor{stringliteral}{"Connection"}))
950    \{
951       \textcolor{comment}{//Parse Connection header field}
952       error = \hyperlink{http__client__misc_8c_a8b9e472b34f513a22786c41294e9bed2}{httpClientParseConnectionField}(context, value);
953    \}
954    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \textcolor{stringliteral}{"Transfer-Encoding"}))
955    \{
956       \textcolor{comment}{//Parse Transfer-Encoding header field}
957       error = \hyperlink{http__client__misc_8c_adc1038f243e8d48570fe633f7098c4f8}{httpClientParseTransferEncodingField}(context, value);
958    \}
959    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}, \textcolor{stringliteral}{"Content-Length"}))
960    \{
961       \textcolor{comment}{//Parse Content-Length header field}
962       error = \hyperlink{http__client__misc_8c_a3fafda6f1465f5e64086966e3dd20a65}{httpClientParseContentLengthField}(context, value);
963    \}
964    \textcolor{keywordflow}{else}
965    \{
966       \textcolor{comment}{//Discard unknown header fields}
967       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
968    \}
969 
970    \textcolor{comment}{//Terminate the header field with a CRLF sequence}
971    strcpy(context->buffer + context->bufferLen + nameLen + n, \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"});
972 
973    \textcolor{comment}{//Adjust the length of the request header}
974    context->bufferLen += nameLen + n + 4;
975 
976    \textcolor{comment}{//Return status code}
977    \textcolor{keywordflow}{return} error;
978 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a9f3c2c67754c9a5bcfb8ad962811c2de}\label{http__client_8c_a9f3c2c67754c9a5bcfb8ad962811c2de}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Get\+Header\+Field@{http\+Client\+Get\+Header\+Field}}
\index{http\+Client\+Get\+Header\+Field@{http\+Client\+Get\+Header\+Field}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Get\+Header\+Field()}{httpClientGetHeaderField()}}
{\footnotesize\ttfamily const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t}$\ast$ http\+Client\+Get\+Header\+Field (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{name }\end{DoxyParamCaption})}



Retrieve the value of the specified header field name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em name} & N\+U\+L\+L-\/terminated string that specifies the header field name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Value of the header field 
\end{DoxyReturn}


Definition at line 1537 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1539 \{
1540    \textcolor{keywordtype}{size\_t} i;
1541    \textcolor{keywordtype}{size\_t} nameLen;
1542    \textcolor{keywordtype}{size\_t} valueLen;
1543    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1544 
1545    \textcolor{comment}{//Initialize field value}
1546    value = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
1547 
1548    \textcolor{comment}{//Check parameters}
1549    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1550    \{
1551       \textcolor{comment}{//Check HTTP request state}
1552       \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671afea85d0ad1ddb4758b18bc6b41e46ef4}{HTTP\_REQ\_STATE\_PARSE\_HEADER} ||
1553          context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7ccac80d24cd15b29279173b1c7ba855}{HTTP\_REQ\_STATE\_PARSE\_TRAILER})
1554       \{
1555          \textcolor{comment}{//Point to the first header field of the response}
1556          i = 0;
1557 
1558          \textcolor{comment}{//Parse HTTP response header}
1559          \textcolor{keywordflow}{while}(i < context->bufferLen)
1560          \{
1561             \textcolor{comment}{//Calculate the length of the field name}
1562             nameLen = strlen(context->buffer + i);
1563             \textcolor{comment}{//Calculate the length of the field value}
1564             valueLen = strlen(context->buffer + i + nameLen + 1);
1565 
1566             \textcolor{comment}{//Check whether the current header field matches the specified name}
1567             \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(context->buffer + i, \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name}))
1568             \{
1569                \textcolor{comment}{//Retrieve the value of the header field}
1570                value = context->buffer + i + nameLen + 1;
1571                \textcolor{comment}{//Exit immediately}
1572                \textcolor{keywordflow}{break};
1573             \}
1574 
1575             \textcolor{comment}{//Point to next header field}
1576             i += nameLen + valueLen + 2;
1577          \}
1578       \}
1579    \}
1580 
1581    \textcolor{comment}{//Return the value of the header field}
1582    \textcolor{keywordflow}{return} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1583 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_aefbf15c772ad6dfa969524bdf020be7a}\label{http__client_8c_aefbf15c772ad6dfa969524bdf020be7a}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Get\+Next\+Header\+Field@{http\+Client\+Get\+Next\+Header\+Field}}
\index{http\+Client\+Get\+Next\+Header\+Field@{http\+Client\+Get\+Next\+Header\+Field}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Get\+Next\+Header\+Field()}{httpClientGetNextHeaderField()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Get\+Next\+Header\+Field (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$$\ast$}]{name,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$$\ast$}]{value }\end{DoxyParamCaption})}



Iterate through the H\+T\+TP response header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt out}  & {\em name} & N\+U\+L\+L-\/terminated string that contains the name of the next header field \\
\hline
\mbox{\tt out}  & {\em value} & N\+U\+L\+L-\/terminated string that contains the value of the next header field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1596 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1598 \{
1599    \textcolor{keywordtype}{size\_t} nameLen;
1600    \textcolor{keywordtype}{size\_t} valueLen;
1601 
1602    \textcolor{comment}{//Check parameters}
1603    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1604       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1605 
1606    \textcolor{comment}{//Check HTTP request state}
1607    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671afea85d0ad1ddb4758b18bc6b41e46ef4}{HTTP\_REQ\_STATE\_PARSE\_HEADER} &&
1608       context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7ccac80d24cd15b29279173b1c7ba855}{HTTP\_REQ\_STATE\_PARSE\_TRAILER})
1609    \{
1610       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1611    \}
1612 
1613    \textcolor{comment}{//Check whether the end of the HTTP response header has been reached}
1614    \textcolor{keywordflow}{if}(context->bufferPos >= context->bufferLen)
1615       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM};
1616 
1617    \textcolor{comment}{//Calculate the length of the field name}
1618    nameLen = strlen(context->buffer + context->bufferPos);
1619    \textcolor{comment}{//Calculate the length of the field value}
1620    valueLen = strlen(context->buffer + context->bufferPos + nameLen + 1);
1621 
1622    \textcolor{comment}{//Return the name and the value of the header field}
1623    *\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name} = context->buffer + context->bufferPos;
1624    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = context->buffer + context->bufferPos + nameLen + 1;
1625 
1626    \textcolor{comment}{//Point to the next header field}
1627    context->bufferPos += nameLen + valueLen + 2;
1628 
1629    \textcolor{comment}{//Successful processing}
1630    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1631 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_abc9e4d34400af007f2040495d035b281}\label{http__client_8c_abc9e4d34400af007f2040495d035b281}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Get\+Status@{http\+Client\+Get\+Status}}
\index{http\+Client\+Get\+Status@{http\+Client\+Get\+Status}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Get\+Status()}{httpClientGetStatus()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} http\+Client\+Get\+Status (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Retrieve the H\+T\+TP status code of the response. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
H\+T\+TP status code 
\end{DoxyReturn}


Definition at line 1510 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1511 \{
1512    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} status;
1513 
1514    \textcolor{comment}{//Initialize status code}
1515    status = 0;
1516 
1517    \textcolor{comment}{//Make sure the HTTP client context is valid}
1518    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1519    \{
1520       \textcolor{comment}{//The status code is a three-digit integer code giving the result}
1521       \textcolor{comment}{//of the attempt to understand and satisfy the request}
1522       status = context->statusCode;
1523    \}
1524 
1525    \textcolor{comment}{//Return HTTP status code}
1526    \textcolor{keywordflow}{return} status;
1527 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a04767b6b9be98adebcac93c6bf00b6a6}\label{http__client_8c_a04767b6b9be98adebcac93c6bf00b6a6}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Init@{http\+Client\+Init}}
\index{http\+Client\+Init@{http\+Client\+Init}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Init()}{httpClientInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Initialize H\+T\+TP client context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 66 of file http\+\_\+client.\+c.


\begin{DoxyCode}
67 \{
68 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_TLS\_SUPPORT == ENABLED)}
69    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
70 \textcolor{preprocessor}{#endif}
71 
72    \textcolor{comment}{//Make sure the HTTP client context is valid}
73    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
74       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
75 
76    \textcolor{comment}{//Clear HTTP client context}
77    memset(context, 0, \textcolor{keyword}{sizeof}(\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{HttpClientContext}));
78 
79 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_TLS\_SUPPORT == ENABLED)}
80    \textcolor{comment}{//Initialize TLS session state}
81    error = \hyperlink{tls_8c_aea7b98b4b876fe45322df04583f7c1b4}{tlsInitSessionState}(&context->tlsSession);
82    \textcolor{comment}{//Any error to report?}
83    \textcolor{keywordflow}{if}(error)
84       \textcolor{keywordflow}{return} error;
85 \textcolor{preprocessor}{#endif}
86 
87    \textcolor{comment}{//Initialize HTTP connection state}
88    context->state = \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED};
89    \textcolor{comment}{//Initialize HTTP request state}
90    context->requestState = \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a257030a48a32ceeef498642911ba9af4}{HTTP\_REQ\_STATE\_INIT};
91 
92    \textcolor{comment}{//Default protocol version}
93    context->version = \hyperlink{http__common_8h_ac870fd261da652aee69937751c6f7e7faf1a34119b438038bc609a273f9bc08c6}{HTTP\_VERSION\_1\_1};
94    \textcolor{comment}{//Default timeout}
95    context->timeout = \hyperlink{http__client_8h_a8573701d03e57121bf83496b908a1de2}{HTTP\_CLIENT\_DEFAULT\_TIMEOUT};
96 
97    \textcolor{comment}{//Successful initialization}
98    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
99 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a0e89f9c3c9b5535d4d188dee3c0b2f12}\label{http__client_8c_a0e89f9c3c9b5535d4d188dee3c0b2f12}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Read\+Body@{http\+Client\+Read\+Body}}
\index{http\+Client\+Read\+Body@{http\+Client\+Read\+Body}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Read\+Body()}{httpClientReadBody()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Read\+Body (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{size,  }\item[{size\+\_\+t $\ast$}]{received,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{flags }\end{DoxyParamCaption})}



Read H\+T\+TP response body. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt out}  & {\em data} & Buffer where to store the incoming data \\
\hline
\mbox{\tt in}  & {\em size} & Maximum number of bytes that can be received \\
\hline
\mbox{\tt out}  & {\em received} & Number of bytes that have been received \\
\hline
\mbox{\tt in}  & {\em flags} & Set of flags that influences the behavior of this function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1644 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1646 \{
1647    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1648    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1649    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
1650 
1651    \textcolor{comment}{//Check parameters}
1652    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || received == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1653       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1654 
1655    \textcolor{comment}{//Check HTTP connection state}
1656    \textcolor{keywordflow}{if}(context->state != \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
1657       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1658 
1659    \textcolor{comment}{//Initialize status code}
1660    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1661 
1662    \textcolor{comment}{//Point to the output buffer}
1663    p = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
1664    \textcolor{comment}{//No data has been read yet}
1665    *received = 0;
1666 
1667    \textcolor{comment}{//Read as much data as possible}
1668    \textcolor{keywordflow}{while}(*received < size && !error)
1669    \{
1670       \textcolor{comment}{//Check HTTP request state}
1671       \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671afea85d0ad1ddb4758b18bc6b41e46ef4}{HTTP\_REQ\_STATE\_PARSE\_HEADER})
1672       \{
1673          \textcolor{comment}{//Flush receive buffer}
1674          context->bufferLen = 0;
1675          context->bufferPos = 0;
1676 
1677          \textcolor{comment}{//Any response to a HEAD request and any response with a 1xx, 204 or}
1678          \textcolor{comment}{//304 status code is always terminated by the first empty line after}
1679          \textcolor{comment}{//the header fields, regardless of the header fields present in the}
1680          \textcolor{comment}{//message, and thus cannot contain a message body}
1681          \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(context->method, \textcolor{stringliteral}{"HEAD"}) ||
1682             \hyperlink{http__common_8h_af9df6b177b583264a909da76dc8729fb}{HTTP\_STATUS\_CODE\_1YZ}(context->statusCode) ||
1683             context->statusCode == 204 ||
1684             context->statusCode == 304)
1685          \{
1686             \textcolor{comment}{//The HTTP response does not contain a body}
1687             \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23282be8248114e118085936752d789}{HTTP\_REQ\_STATE\_COMPLETE});
1688          \}
1689          \textcolor{keywordflow}{else}
1690          \{
1691             \textcolor{comment}{//The HTTP response contains a body}
1692             \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671aaec3a90d3ca46a7b85990ecc31eac3ee}{HTTP\_REQ\_STATE\_RECEIVE\_BODY});
1693          \}
1694       \}
1695       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671aaec3a90d3ca46a7b85990ecc31eac3ee}{HTTP\_REQ\_STATE\_RECEIVE\_BODY})
1696       \{
1697          \textcolor{comment}{//Chunked transfer encoding?}
1698          \textcolor{keywordflow}{if}(context->chunkedEncoding)
1699          \{
1700             \textcolor{comment}{//The chunked encoding modifies the body in order to transfer it}
1701             \textcolor{comment}{//as a series of chunks, each with its own size indicator}
1702             \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a9fa6359ea11fcf53b68776ca53ab0002}{HTTP\_REQ\_STATE\_RECEIVE\_CHUNK\_SIZE});
1703          \}
1704          \textcolor{keywordflow}{else}
1705          \{
1706             \textcolor{comment}{//The length of the body is determined by the Content-Length field}
1707             \textcolor{keywordflow}{if}(context->bodyPos < context->bodyLen)
1708             \{
1709                \textcolor{comment}{//Limit the number of bytes to read}
1710                n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(size - *received, context->bodyLen - context->bodyPos);
1711 
1712                \textcolor{comment}{//Read response body}
1713                error = \hyperlink{http__client__transport_8c_a843ea6f0de7bea762593df6387e04621}{httpClientReceiveData}(context, p, n, &n, 
      \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags});
1714 
1715                \textcolor{comment}{//Check status code}
1716                \textcolor{keywordflow}{if}(!error)
1717                \{
1718                   \textcolor{comment}{//Advance data pointer}
1719                   p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1720                   *received += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1721                   context->bodyPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1722 
1723                   \textcolor{comment}{//Save current time}
1724                   context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1725 
1726                   \textcolor{comment}{//We are done}
1727                   \textcolor{keywordflow}{break};
1728                \}
1729                \textcolor{keywordflow}{else}
1730                \{
1731                   \textcolor{comment}{//In practice, many widely deployed HTTPS servers close connections}
1732                   \textcolor{comment}{//abruptly, without any prior notice, and in particular without}
1733                   \textcolor{comment}{//sending the close\_notify alert}
1734                   \textcolor{keywordflow}{if}(!context->keepAlive && context->bodyLen == UINT\_MAX)
1735                   \{
1736                      \textcolor{comment}{//The HTTP transaction is complete}
1737                      \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23282be8248114e118085936752d789}{HTTP\_REQ\_STATE\_COMPLETE});
1738                      \textcolor{comment}{//Close the HTTP connection}
1739                      \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a41c0ddfb8cd18ecb0bcbc50815f8af34}{HTTP\_CLIENT\_STATE\_DISCONNECTING});
1740                      \textcolor{comment}{//The end of the response body has been reached}
1741                      error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM};
1742                   \}
1743                \}
1744             \}
1745             \textcolor{keywordflow}{else}
1746             \{
1747                \textcolor{comment}{//The HTTP transaction is complete}
1748                \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23282be8248114e118085936752d789}{HTTP\_REQ\_STATE\_COMPLETE});
1749                \textcolor{comment}{//The end of the response body has been reached}
1750                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM};
1751             \}
1752          \}
1753       \}
1754       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a9fa6359ea11fcf53b68776ca53ab0002}{HTTP\_REQ\_STATE\_RECEIVE\_CHUNK\_SIZE})
1755       \{
1756          \textcolor{comment}{//The chunked encoding modifies the body in order to transfer it as}
1757          \textcolor{comment}{//a series of chunks, each with its own size indicator}
1758          \textcolor{keywordflow}{if}(context->bufferLen >= 3 &&
1759             context->buffer[context->bufferLen - 2] == \textcolor{charliteral}{'\(\backslash\)r'} &&
1760             context->buffer[context->bufferLen - 1] == \textcolor{charliteral}{'\(\backslash\)n'})
1761          \{
1762             \textcolor{comment}{//Parse chunk-size field}
1763             error = \hyperlink{http__client__misc_8c_ac12d2dfafc67c9cb2251ce8d376730d3}{httpClientParseChunkSize}(context, context->buffer,
1764                context->bufferLen);
1765          \}
1766          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->bufferLen < \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
1767          \{
1768             \textcolor{comment}{//Receive more data}
1769             error = \hyperlink{http__client__transport_8c_a843ea6f0de7bea762593df6387e04621}{httpClientReceiveData}(context, context->buffer +
1770                context->bufferLen, \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE} - context->bufferLen,
1771                &n, \hyperlink{http__common_8h_a8d138d340435fa37e2a654238ed6deaba90a7e897d1bb172106224358b0de807d}{HTTP\_FLAG\_BREAK\_CRLF});
1772 
1773             \textcolor{comment}{//Check status code}
1774             \textcolor{keywordflow}{if}(!error)
1775             \{
1776                \textcolor{comment}{//Adjust the length of the buffer}
1777                context->bufferLen += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1778                \textcolor{comment}{//Save current time}
1779                context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1780             \}
1781          \}
1782          \textcolor{keywordflow}{else}
1783          \{
1784             \textcolor{comment}{//The client implementation limits the length of the chunk-size field}
1785             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1786          \}
1787       \}
1788       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac5f01fe75ddc6a2ddc4ec9e79e5a4cdd}{HTTP\_REQ\_STATE\_RECEIVE\_CHUNK\_DATA})
1789       \{
1790          \textcolor{comment}{//The data stream is divided into a series of chunks}
1791          \textcolor{keywordflow}{if}(context->bodyPos < context->bodyLen)
1792          \{
1793             \textcolor{comment}{//The length of the data chunk is determined by the chunk-size field}
1794             n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(size - *received, context->bodyLen - context->bodyPos);
1795 
1796             \textcolor{comment}{//Read chunk data}
1797             error = \hyperlink{http__client__transport_8c_a843ea6f0de7bea762593df6387e04621}{httpClientReceiveData}(context, p, n, &n, 
      \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags});
1798 
1799             \textcolor{comment}{//Check status code}
1800             \textcolor{keywordflow}{if}(!error)
1801             \{
1802                \textcolor{comment}{//Total number of data that have been read}
1803                *received += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1804                \textcolor{comment}{//Number of bytes left to process in the current chunk}
1805                context->bodyPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1806 
1807                \textcolor{comment}{//Save current time}
1808                context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1809 
1810                \textcolor{comment}{//Check flags}
1811                \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags} & \hyperlink{http__common_8h_a8d138d340435fa37e2a654238ed6deaba90a7e897d1bb172106224358b0de807d}{HTTP\_FLAG\_BREAK\_CRLF})
1812                \{
1813                   \textcolor{comment}{//The HTTP\_FLAG\_BREAK\_CHAR flag causes the function to stop}
1814                   \textcolor{comment}{//reading data as soon as the specified break character is}
1815                   \textcolor{comment}{//encountered}
1816                   \textcolor{keywordflow}{if}(p[n - 1] == \hyperlink{os__port_8h_a34a3aa6cbadec6a80ab1eae8efd0083d}{LSB}(\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags}))
1817                      \textcolor{keywordflow}{break};
1818                \}
1819                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!(\hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags} & \hyperlink{http__common_8h_a8d138d340435fa37e2a654238ed6deaba635b3d39aef6a064f5e10ca0440b5745}{HTTP\_FLAG\_WAIT\_ALL}))
1820                \{
1821                   \textcolor{comment}{//The HTTP\_FLAG\_WAIT\_ALL flag causes the function to return}
1822                   \textcolor{comment}{//only when the requested number of bytes have been read}
1823                   \textcolor{keywordflow}{break};
1824                \}
1825                \textcolor{keywordflow}{else}
1826                \{
1827                   \textcolor{comment}{//Just for sanity}
1828                \}
1829 
1830                \textcolor{comment}{//Advance data pointer}
1831                p += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1832             \}
1833          \}
1834          \textcolor{keywordflow}{else}
1835          \{
1836             \textcolor{comment}{//The chunked encoding modifies the body in order to transfer it}
1837             \textcolor{comment}{//as a series of chunks, each with its own size indicator}
1838             \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a9fa6359ea11fcf53b68776ca53ab0002}{HTTP\_REQ\_STATE\_RECEIVE\_CHUNK\_SIZE});
1839          \}
1840       \}
1841       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671abe0376963cfae76ec97eb7d9548db2a8}{HTTP\_REQ\_STATE\_RECEIVE\_TRAILER} ||
1842          context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7ccac80d24cd15b29279173b1c7ba855}{HTTP\_REQ\_STATE\_PARSE\_TRAILER} ||
1843          context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23282be8248114e118085936752d789}{HTTP\_REQ\_STATE\_COMPLETE})
1844       \{
1845          \textcolor{comment}{//The user must be satisfied with data already on hand}
1846          \textcolor{keywordflow}{if}(*received > 0)
1847          \{
1848             \textcolor{comment}{//Some data are pending in the receive buffer}
1849             \textcolor{keywordflow}{break};
1850          \}
1851          \textcolor{keywordflow}{else}
1852          \{
1853             \textcolor{comment}{//The end of the response body has been reached}
1854             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM};
1855          \}
1856       \}
1857       \textcolor{keywordflow}{else}
1858       \{
1859          \textcolor{comment}{//Invalid state}
1860          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1861       \}
1862    \}
1863 
1864    \textcolor{comment}{//Check status code}
1865    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1866    \{
1867       \textcolor{comment}{//Check whether the timeout has elapsed}
1868       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
1869    \}
1870 
1871    \textcolor{comment}{//Return status code}
1872    \textcolor{keywordflow}{return} error;
1873 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ac04a874a7b838d86e1ed0941dffd5437}\label{http__client_8c_ac04a874a7b838d86e1ed0941dffd5437}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Read\+Header@{http\+Client\+Read\+Header}}
\index{http\+Client\+Read\+Header@{http\+Client\+Read\+Header}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Read\+Header()}{httpClientReadHeader()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Read\+Header (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Read H\+T\+TP response header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1373 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1374 \{
1375    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1376    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1377 
1378    \textcolor{comment}{//Make sure the HTTP client context is valid}
1379    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1380       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1381 
1382    \textcolor{comment}{//Check HTTP connection state}
1383    \textcolor{keywordflow}{if}(context->state != \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
1384       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1385 
1386    \textcolor{comment}{//Initialize status code}
1387    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1388 
1389    \textcolor{comment}{//Send HTTP request header}
1390    \textcolor{keywordflow}{while}(!error)
1391    \{
1392       \textcolor{comment}{//Check HTTP request state}
1393       \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a4b7be0c1456c3de2bfa2eb8f6f9be7f4}{HTTP\_REQ\_STATE\_SEND\_BODY} ||
1394          context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac9eaf361a36f169f32dcbcc4e6fceaa6}{HTTP\_REQ\_STATE\_SEND\_CHUNK\_DATA})
1395       \{
1396          \textcolor{comment}{//Close HTTP request body}
1397          error = \hyperlink{http__client_8c_ad7211fd71ba5bb08049009e375356033}{httpClientCloseBody}(context);
1398       \}
1399       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a59a40d0faad7f72e050bfc3e638ab188}{HTTP\_REQ\_STATE\_FORMAT\_TRAILER} ||
1400          context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac39d0dd0d2c1ec13b2377006ace81fbd}{HTTP\_REQ\_STATE\_SEND\_TRAILER})
1401       \{
1402          \textcolor{comment}{//The last chunk is followed by an optional trailer}
1403          error = \hyperlink{http__client_8c_a231bbf939dd131f242a639f9e73853a9}{httpClientWriteTrailer}(context);
1404       \}
1405       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE}
       ||
1406          context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a408e2466b108b4fbebcc4c6742befb40}{HTTP\_REQ\_STATE\_RECEIVE\_HEADER})
1407       \{
1408          \textcolor{comment}{//The CRLF sequence is always used to terminate a line}
1409          \textcolor{keywordflow}{if}(context->bufferLen >= (context->bufferPos + 2) &&
1410             context->buffer[context->bufferLen - 2] == \textcolor{charliteral}{'\(\backslash\)r'} &&
1411             context->buffer[context->bufferLen - 1] == \textcolor{charliteral}{'\(\backslash\)n'})
1412          \{
1413             \textcolor{comment}{//Strip the CRLF at the end of the line}
1414             context->bufferLen -= 2;
1415 
1416             \textcolor{comment}{//The first line of a response message is the Status-Line}
1417             \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE}
      )
1418             \{
1419                \textcolor{comment}{//Thee Status-Line consists of the protocol version followed by}
1420                \textcolor{comment}{//a numeric status code and its associated textual phrase}
1421                error = \hyperlink{http__client__misc_8c_a94226ee3da9cacad849bf1c496f27b28}{httpClientParseStatusLine}(context, context->buffer +
1422                   context->bufferPos, context->bufferLen - context->bufferPos);
1423 
1424                \textcolor{comment}{//Valid syntax?}
1425                \textcolor{keywordflow}{if}(!error)
1426                \{
1427                   \textcolor{comment}{//Receive response header fields}
1428                   \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a408e2466b108b4fbebcc4c6742befb40}{HTTP\_REQ\_STATE\_RECEIVE\_HEADER});
1429                \}
1430             \}
1431             \textcolor{keywordflow}{else}
1432             \{
1433                \textcolor{comment}{//An empty line indicates the end of the header fields}
1434                \textcolor{keywordflow}{if}(context->bufferLen == context->bufferPos)
1435                \{
1436                   \textcolor{comment}{//Save TLS session}
1437                   error = \hyperlink{http__client__transport_8c_a1387d6fe18b3543fd5e53e139f73aa1e}{httpClientSaveSession}(context);
1438 
1439                   \textcolor{comment}{//Check status code}
1440                   \textcolor{keywordflow}{if}(!error)
1441                   \{
1442                      \textcolor{comment}{//The HTTP response header has been successfully received}
1443                      \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671afea85d0ad1ddb4758b18bc6b41e46ef4}{HTTP\_REQ\_STATE\_PARSE\_HEADER});
1444                   \}
1445                \}
1446                \textcolor{keywordflow}{else}
1447                \{
1448                   \textcolor{comment}{//The response header fields allow the server to pass additional}
1449                   \textcolor{comment}{//information about the response which cannot be placed in the}
1450                   \textcolor{comment}{//Status-Line}
1451                   error = \hyperlink{http__client__misc_8c_a210eb38eb3fc05a92e45cdce6c7e6bd8}{httpClientParseHeaderField}(context, context->buffer +
1452                      context->bufferPos, context->bufferLen - context->bufferPos);
1453                \}
1454             \}
1455          \}
1456          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->bufferLen < \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
1457          \{
1458             \textcolor{comment}{//Receive more data}
1459             error = \hyperlink{http__client__transport_8c_a843ea6f0de7bea762593df6387e04621}{httpClientReceiveData}(context, context->buffer +
1460                context->bufferLen, \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE} - context->bufferLen,
1461                &n, \hyperlink{http__common_8h_a8d138d340435fa37e2a654238ed6deaba90a7e897d1bb172106224358b0de807d}{HTTP\_FLAG\_BREAK\_CRLF});
1462 
1463             \textcolor{comment}{//Check status code}
1464             \textcolor{keywordflow}{if}(!error)
1465             \{
1466                \textcolor{comment}{//Adjust the length of the buffer}
1467                context->bufferLen += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1468                \textcolor{comment}{//Save current time}
1469                context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1470             \}
1471          \}
1472          \textcolor{keywordflow}{else}
1473          \{
1474             \textcolor{comment}{//The client implementation limits the size of headers it accepts}
1475             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1476          \}
1477       \}
1478       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671afea85d0ad1ddb4758b18bc6b41e46ef4}{HTTP\_REQ\_STATE\_PARSE\_HEADER})
1479       \{
1480          \textcolor{comment}{//Rewind to the beginning of the buffer}
1481          context->bufferPos = 0;
1482          \textcolor{comment}{//We are done}
1483          \textcolor{keywordflow}{break};
1484       \}
1485       \textcolor{keywordflow}{else}
1486       \{
1487          \textcolor{comment}{//Invalid state}
1488          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1489       \}
1490    \}
1491 
1492    \textcolor{comment}{//Check status code}
1493    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1494    \{
1495       \textcolor{comment}{//Check whether the timeout has elapsed}
1496       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
1497    \}
1498 
1499    \textcolor{comment}{//Return status code}
1500    \textcolor{keywordflow}{return} error;
1501 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a2d916637804f8dccb8cd967670263de7}\label{http__client_8c_a2d916637804f8dccb8cd967670263de7}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Read\+Trailer@{http\+Client\+Read\+Trailer}}
\index{http\+Client\+Read\+Trailer@{http\+Client\+Read\+Trailer}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Read\+Trailer()}{httpClientReadTrailer()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Read\+Trailer (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Read H\+T\+TP trailer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1882 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1883 \{
1884    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1885    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1886 
1887    \textcolor{comment}{//Make sure the HTTP client context is valid}
1888    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1889       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1890 
1891    \textcolor{comment}{//Initialize status code}
1892    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1893 
1894    \textcolor{comment}{//Send HTTP request header}
1895    \textcolor{keywordflow}{while}(!error)
1896    \{
1897       \textcolor{comment}{//Check HTTP connection state}
1898       \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
1899       \{
1900          \textcolor{comment}{//Check HTTP request state}
1901          \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671abe0376963cfae76ec97eb7d9548db2a8}{HTTP\_REQ\_STATE\_RECEIVE\_TRAILER})
1902          \{
1903             \textcolor{comment}{//The CRLF sequence is always used to terminate a line}
1904             \textcolor{keywordflow}{if}(context->bufferLen >= (context->bufferPos + 2) &&
1905                context->buffer[context->bufferLen - 2] == \textcolor{charliteral}{'\(\backslash\)r'} &&
1906                context->buffer[context->bufferLen - 1] == \textcolor{charliteral}{'\(\backslash\)n'})
1907             \{
1908                \textcolor{comment}{//Strip the CRLF at the end of the line}
1909                context->bufferLen -= 2;
1910 
1911                \textcolor{comment}{//An empty line indicates the end of the header fields}
1912                \textcolor{keywordflow}{if}(context->bufferLen == context->bufferPos)
1913                \{
1914                   \textcolor{comment}{//The HTTP transaction is complete}
1915                   \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7ccac80d24cd15b29279173b1c7ba855}{HTTP\_REQ\_STATE\_PARSE\_TRAILER});
1916                \}
1917                \textcolor{keywordflow}{else}
1918                \{
1919                   \textcolor{comment}{//The response header fields allow the server to pass additional}
1920                   \textcolor{comment}{//information about the response which cannot be placed in the}
1921                   \textcolor{comment}{//Status-Line}
1922                   error = \hyperlink{http__client__misc_8c_a210eb38eb3fc05a92e45cdce6c7e6bd8}{httpClientParseHeaderField}(context, context->buffer +
1923                      context->bufferPos, context->bufferLen - context->bufferPos);
1924                \}
1925             \}
1926             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->bufferLen < \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
1927             \{
1928                \textcolor{comment}{//Receive more data}
1929                error = \hyperlink{http__client__transport_8c_a843ea6f0de7bea762593df6387e04621}{httpClientReceiveData}(context, context->buffer +
1930                   context->bufferLen, \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE} - context->bufferLen,
1931                   &n, \hyperlink{http__common_8h_a8d138d340435fa37e2a654238ed6deaba90a7e897d1bb172106224358b0de807d}{HTTP\_FLAG\_BREAK\_CRLF});
1932 
1933                \textcolor{comment}{//Check status code}
1934                \textcolor{keywordflow}{if}(!error)
1935                \{
1936                   \textcolor{comment}{//Adjust the length of the buffer}
1937                   context->bufferLen += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1938                   \textcolor{comment}{//Save current time}
1939                   context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1940                \}
1941             \}
1942             \textcolor{keywordflow}{else}
1943             \{
1944                \textcolor{comment}{//The client implementation limits the size of headers it accepts}
1945                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
1946             \}
1947          \}
1948          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7ccac80d24cd15b29279173b1c7ba855}{HTTP\_REQ\_STATE\_PARSE\_TRAILER} ||
1949             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23282be8248114e118085936752d789}{HTTP\_REQ\_STATE\_COMPLETE})
1950          \{
1951             \textcolor{comment}{//Rewind to the beginning of the buffer}
1952             context->bufferPos = 0;
1953 
1954             \textcolor{comment}{//Persistent HTTP connection?}
1955             \textcolor{keywordflow}{if}(context->keepAlive)
1956             \{
1957                \textcolor{comment}{//Persistent connections stay open across transactions, until}
1958                \textcolor{comment}{//either the client or the server decides to close them}
1959                \textcolor{keywordflow}{break};
1960             \}
1961             \textcolor{keywordflow}{else}
1962             \{
1963                \textcolor{comment}{//The connection will be closed after completion of the response}
1964                \hyperlink{http__client__misc_8c_a8bbfa406f6709331e632d23b37acfed8}{httpClientChangeState}(context, 
      \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a41c0ddfb8cd18ecb0bcbc50815f8af34}{HTTP\_CLIENT\_STATE\_DISCONNECTING});
1965             \}
1966          \}
1967          \textcolor{keywordflow}{else}
1968          \{
1969             \textcolor{comment}{//Invalid HTTP request state}
1970             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1971          \}
1972       \}
1973       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a41c0ddfb8cd18ecb0bcbc50815f8af34}{HTTP\_CLIENT\_STATE\_DISCONNECTING})
1974       \{
1975          \textcolor{comment}{//Shutdown connection}
1976          error = \hyperlink{http__client_8c_a72f5dd692819021e1fac5a0a2d3503d6}{httpClientDisconnect}(context);
1977       \}
1978       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED})
1979       \{
1980          \textcolor{comment}{//Rewind to the beginning of the buffer}
1981          context->bufferPos = 0;
1982          \textcolor{comment}{//We are done}
1983          \textcolor{keywordflow}{break};
1984       \}
1985       \textcolor{keywordflow}{else}
1986       \{
1987          \textcolor{comment}{//Invalid HTTP connection state}
1988          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1989       \}
1990    \}
1991 
1992    \textcolor{comment}{//Check status code}
1993    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1994    \{
1995       \textcolor{comment}{//Check whether the timeout has elapsed}
1996       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
1997    \}
1998 
1999    \textcolor{comment}{//Return status code}
2000    \textcolor{keywordflow}{return} error;
2001 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_aa85a485d80c0c7d5a7130188cd1d14bd}\label{http__client_8c_aa85a485d80c0c7d5a7130188cd1d14bd}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Register\+Rand\+Callback@{http\+Client\+Register\+Rand\+Callback}}
\index{http\+Client\+Register\+Rand\+Callback@{http\+Client\+Register\+Rand\+Callback}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Register\+Rand\+Callback()}{httpClientRegisterRandCallback()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Register\+Rand\+Callback (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{http__client_8h_a034d564bf21de50a08d13ea832881ec0}{Http\+Client\+Rand\+Callback}}]{callback }\end{DoxyParamCaption})}



Register random data generation callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em callback} & Random data generation callback function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 135 of file http\+\_\+client.\+c.


\begin{DoxyCode}
137 \{
138 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_DIGEST\_AUTH\_SUPPORT == ENABLED)}
139    \textcolor{comment}{//Make sure the HTTP client context is valid}
140    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
141       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
142 
143    \textcolor{comment}{//Save callback function}
144    context->randCallback = callback;
145 
146    \textcolor{comment}{//Successful processing}
147    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
148 \textcolor{preprocessor}{#else}
149    \textcolor{comment}{//Digest authentication is not implemented}
150    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
151 \textcolor{preprocessor}{#endif}
152 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ac28f4a8765b350ffdb1a58a24ce44e43}\label{http__client_8c_ac28f4a8765b350ffdb1a58a24ce44e43}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Register\+Tls\+Init\+Callback@{http\+Client\+Register\+Tls\+Init\+Callback}}
\index{http\+Client\+Register\+Tls\+Init\+Callback@{http\+Client\+Register\+Tls\+Init\+Callback}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Register\+Tls\+Init\+Callback()}{httpClientRegisterTlsInitCallback()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Register\+Tls\+Init\+Callback (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{http__client_8h_a7627ce7ef31eba950fa770eceb5a4cf2}{Http\+Client\+Tls\+Init\+Callback}}]{callback }\end{DoxyParamCaption})}



Register T\+LS initialization callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em callback} & T\+LS initialization callback function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 111 of file http\+\_\+client.\+c.


\begin{DoxyCode}
113 \{
114    \textcolor{comment}{//Make sure the HTTP client context is valid}
115    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
116       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
117 
118    \textcolor{comment}{//Save callback function}
119    context->tlsInitCallback = callback;
120 
121    \textcolor{comment}{//Successful processing}
122    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
123 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ab560846ee44725c51fb88576996aaf26}\label{http__client_8c_ab560846ee44725c51fb88576996aaf26}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Auth\+Info@{http\+Client\+Set\+Auth\+Info}}
\index{http\+Client\+Set\+Auth\+Info@{http\+Client\+Set\+Auth\+Info}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Auth\+Info()}{httpClientSetAuthInfo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Auth\+Info (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{username,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{password }\end{DoxyParamCaption})}



Set authentication information. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em username} & N\+U\+L\+L-\/terminated string containing the user name to be used \\
\hline
\mbox{\tt in}  & {\em password} & N\+U\+L\+L-\/terminated string containing the password to be used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 209 of file http\+\_\+client.\+c.


\begin{DoxyCode}
211 \{
212 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_AUTH\_SUPPORT == ENABLED)}
213    \textcolor{comment}{//Check parameters}
214    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || username == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || password == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
215       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
216 
217    \textcolor{comment}{//Make sure the length of the user name is acceptable}
218    \textcolor{keywordflow}{if}(strlen(username) > \hyperlink{http__client_8h_a222fb28335a6fdc8279c0db1d2d71ef8}{HTTP\_CLIENT\_MAX\_USERNAME\_LEN})
219       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
220 
221    \textcolor{comment}{//Save user name}
222    strcpy(context->authParams.username, username);
223 
224    \textcolor{comment}{//Make sure the length of the password is acceptable}
225    \textcolor{keywordflow}{if}(strlen(password) > \hyperlink{http__client_8h_a33550bf839c313dae49cff95e703b974}{HTTP\_CLIENT\_MAX\_PASSWORD\_LEN})
226       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
227 
228    \textcolor{comment}{//Save password}
229    strcpy(context->authParams.password, password);
230 
231    \textcolor{comment}{//Successful processing}
232    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
233 \textcolor{preprocessor}{#else}
234    \textcolor{comment}{//HTTP authentication is not implemented}
235    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
236 \textcolor{preprocessor}{#endif}
237 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a4d73bfbaeb6fd224dc2bd836f3143354}\label{http__client_8c_a4d73bfbaeb6fd224dc2bd836f3143354}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Content\+Length@{http\+Client\+Set\+Content\+Length}}
\index{http\+Client\+Set\+Content\+Length@{http\+Client\+Set\+Content\+Length}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Content\+Length()}{httpClientSetContentLength()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Content\+Length (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Set the length of the H\+T\+TP request body. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em length} & Length of the H\+T\+TP request body, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 988 of file http\+\_\+client.\+c.


\begin{DoxyCode}
989 \{
990    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} temp[11];
991 
992    \textcolor{comment}{//Make sure the HTTP client context is valid}
993    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
994       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
995 
996    \textcolor{comment}{//Check HTTP request state}
997    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER})
998       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
999 
1000    \textcolor{comment}{//The Content-Length header field indicates the size of the body, in}
1001    \textcolor{comment}{//decimal number of octets}
1002    sprintf(temp, \textcolor{stringliteral}{"%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
1003 
1004    \textcolor{comment}{//Add the Content-Length header field}
1005    \textcolor{keywordflow}{return} \hyperlink{http__client_8c_ad725672fa7ec139fcf69542feb9cb9d1}{httpClientAddHeaderField}(context, \textcolor{stringliteral}{"Content-Length"}, temp);
1006 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ab4b6d53971e735b341511a3ecf8df229}\label{http__client_8c_ab4b6d53971e735b341511a3ecf8df229}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Host@{http\+Client\+Set\+Host}}
\index{http\+Client\+Set\+Host@{http\+Client\+Set\+Host}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Host()}{httpClientSetHost()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Host (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{host,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{port }\end{DoxyParamCaption})}



Set the hostname and port number of the resource being requested. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em host} & N\+U\+L\+L-\/terminated string containing the hostname \\
\hline
\mbox{\tt in}  & {\em port} & T\+CP port number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 534 of file http\+\_\+client.\+c.


\begin{DoxyCode}
536 \{
537    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
538    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
539    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} temp[7];
540 
541    \textcolor{comment}{//Check parameters}
542    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || host == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
543       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
544 
545    \textcolor{comment}{//Check HTTP request state}
546    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER})
547       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
548 
549    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
550    \textcolor{keywordflow}{if}(context->bufferLen < 2 || context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
551       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
552 
553    \textcolor{comment}{//Default port number?}
554    \textcolor{keywordflow}{if}(\hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port} == \hyperlink{http__common_8h_a0906dae4a42c1fef9ec0cd0a5212ed4a}{HTTP\_PORT})
555    \{
556       \textcolor{comment}{//A host without any trailing port information implies the default port}
557       \textcolor{comment}{//for the service requested}
558       strcpy(temp, \textcolor{stringliteral}{""});
559    \}
560    \textcolor{keywordflow}{else}
561    \{
562       \textcolor{comment}{//Format port number information}
563       sprintf(temp, \textcolor{stringliteral}{":%"} PRIu16, \hyperlink{dns__common_8h_a8e0798404bf2cf5dabb84c5ba9a4f236}{port});
564    \}
565 
566    \textcolor{comment}{//Compute the length of the hostname}
567    n = strlen(host);
568    \textcolor{comment}{//Compute the length of the trailing port information}
569    m = strlen(temp);
570 
571    \textcolor{comment}{//Make sure the buffer is large enough to hold the new header field}
572    \textcolor{keywordflow}{if}((context->bufferLen + n + m + 8) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
573       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
574 
575    \textcolor{comment}{//The Host request-header field specifies the Internet host and port number}
576    \textcolor{comment}{//of the resource being requested}
577    sprintf(context->buffer + context->bufferLen - 2, \textcolor{stringliteral}{"Host: %s%s\(\backslash\)r\(\backslash\)n\(\backslash\)r\(\backslash\)n"},
578       host, temp);
579 
580    \textcolor{comment}{//Adjust the length of the request header}
581    context->bufferLen += n + m + 8;
582 
583    \textcolor{comment}{//Successful processing}
584    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
585 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_abc2579039e117a48e20a029780e402a7}\label{http__client_8c_abc2579039e117a48e20a029780e402a7}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Method@{http\+Client\+Set\+Method}}
\index{http\+Client\+Set\+Method@{http\+Client\+Set\+Method}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Method()}{httpClientSetMethod()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Method (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{method }\end{DoxyParamCaption})}



Set H\+T\+TP request method. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em method} & N\+U\+L\+L-\/terminating string containing the H\+T\+TP method \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 403 of file http\+\_\+client.\+c.


\begin{DoxyCode}
404 \{
405    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
406    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
407    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
408 
409    \textcolor{comment}{//Check parameters}
410    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || method == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
411       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
412 
413    \textcolor{comment}{//Compute the length of the HTTP method}
414    n = strlen(method);
415 
416    \textcolor{comment}{//Make sure the length of the user name is acceptable}
417    \textcolor{keywordflow}{if}(n == 0 || n > \hyperlink{http__client_8h_a2d6a6200e93ddfc7b7e32cfe0099dd3d}{HTTP\_CLIENT\_MAX\_METHOD\_LEN})
418       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
419 
420    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
421    \textcolor{keywordflow}{if}(context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
422       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
423 
424    \textcolor{comment}{//Properly terminate the string with a NULL character}
425    context->buffer[context->bufferLen] = \textcolor{charliteral}{'\(\backslash\)0'};
426 
427    \textcolor{comment}{//The Request-Line begins with a method token}
428    p = strchr(context->buffer, \textcolor{charliteral}{' '});
429    \textcolor{comment}{//Any parsing error?}
430    \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
431       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
432 
433    \textcolor{comment}{//Compute the length of the current method token}
434    m = p - context->buffer;
435 
436    \textcolor{comment}{//Make sure the buffer is large enough to hold the new HTTP request method}
437    \textcolor{keywordflow}{if}((context->bufferLen + n - m) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
438       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
439 
440    \textcolor{comment}{//Make room for the new method token}
441    memmove(context->buffer + n, p, context->bufferLen + 1 - m);
442    \textcolor{comment}{//Copy the new method token}
443    strncpy(context->buffer, method, n);
444 
445    \textcolor{comment}{//Adjust the length of the request header}
446    context->bufferLen = context->bufferLen + n - \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
447 
448    \textcolor{comment}{//Save HTTP request method}
449    strcpy(context->method, method);
450 
451    \textcolor{comment}{//Successful processing}
452    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
453 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ae55d5813a216383f203bd49bff99bba1}\label{http__client_8c_ae55d5813a216383f203bd49bff99bba1}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Query\+String@{http\+Client\+Set\+Query\+String}}
\index{http\+Client\+Set\+Query\+String@{http\+Client\+Set\+Query\+String}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Query\+String()}{httpClientSetQueryString()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Query\+String (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{query\+String }\end{DoxyParamCaption})}



Set query string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em query\+String} & N\+U\+L\+L-\/terminated string that contains the query string \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 595 of file http\+\_\+client.\+c.


\begin{DoxyCode}
597 \{
598    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
599    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
600    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
601    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *q;
602 
603    \textcolor{comment}{//Check parameters}
604    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || queryString == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
605       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
606 
607    \textcolor{comment}{//Check HTTP request state}
608    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER})
609       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
610 
611    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
612    \textcolor{keywordflow}{if}(context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
613       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
614 
615    \textcolor{comment}{//Properly terminate the string with a NULL character}
616    context->buffer[context->bufferLen] = \textcolor{charliteral}{'\(\backslash\)0'};
617 
618    \textcolor{comment}{//The Request-Line begins with a method token}
619    p = strchr(context->buffer, \textcolor{charliteral}{' '});
620    \textcolor{comment}{//Any parsing error?}
621    \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
622       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
623 
624    \textcolor{comment}{//The method token is followed by the Request-URI}
625    p = strpbrk(p + 1, \textcolor{stringliteral}{" ?"});
626    \textcolor{comment}{//Any parsing error?}
627    \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
628       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
629 
630    \textcolor{comment}{//The question mark is used as a separator}
631    \textcolor{keywordflow}{if}(*p == \textcolor{charliteral}{'?'})
632    \{
633       \textcolor{comment}{//Point to the end of the query string}
634       q = strchr(p + 1, \textcolor{charliteral}{' '});
635       \textcolor{comment}{//Any parsing error?}
636       \textcolor{keywordflow}{if}(q == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
637          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
638 
639       \textcolor{comment}{//Compute the length of the actual query string}
640       m = q - \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
641    \}
642    \textcolor{keywordflow}{else}
643    \{
644       \textcolor{comment}{//The query string is not present}
645       q = \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
646       m = 0;
647    \}
648 
649    \textcolor{comment}{//Compute the length of the new query string}
650    n = strlen(queryString);
651 
652    \textcolor{comment}{//Empty query string?}
653    \textcolor{keywordflow}{if}(n == 0)
654    \{
655       \textcolor{comment}{//Remove the query string}
656       memmove(p, p + m, context->buffer + context->bufferLen + 1 - q);
657    \}
658    \textcolor{keywordflow}{else}
659    \{
660       \textcolor{comment}{//The question mark is not part of the query string}
661       n++;
662 
663       \textcolor{comment}{//Make sure the buffer is large enough to hold the new query string}
664       \textcolor{keywordflow}{if}((context->bufferLen + n - m) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
665          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
666 
667       \textcolor{comment}{//Make room for the new query string}
668       memmove(p + n, q, context->buffer + context->bufferLen + 1 - q);
669 
670       \textcolor{comment}{//The question mark is used as a separator}
671       p[0] = \textcolor{charliteral}{'?'};
672       \textcolor{comment}{//Copy the new query string}
673       strncpy(p + 1, queryString, n - 1);
674    \}
675 
676    \textcolor{comment}{//Adjust the length of the request header}
677    context->bufferLen = context->bufferLen + n - \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
678 
679    \textcolor{comment}{//Successful processing}
680    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
681 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a6e4fa56d0dcca88643793fe1d5e3b1cd}\label{http__client_8c_a6e4fa56d0dcca88643793fe1d5e3b1cd}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Timeout@{http\+Client\+Set\+Timeout}}
\index{http\+Client\+Set\+Timeout@{http\+Client\+Set\+Timeout}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Timeout()}{httpClientSetTimeout()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Timeout (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{timeout }\end{DoxyParamCaption})}



Set communication timeout. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em timeout} & Timeout value, in milliseconds \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 187 of file http\+\_\+client.\+c.


\begin{DoxyCode}
188 \{
189    \textcolor{comment}{//Make sure the HTTP client context is valid}
190    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
191       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
192 
193    \textcolor{comment}{//Save timeout value}
194    context->timeout = timeout;
195 
196    \textcolor{comment}{//Successful processing}
197    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
198 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ac3e8485707a87f2a326b909dc54072a2}\label{http__client_8c_ac3e8485707a87f2a326b909dc54072a2}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Uri@{http\+Client\+Set\+Uri}}
\index{http\+Client\+Set\+Uri@{http\+Client\+Set\+Uri}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Uri()}{httpClientSetUri()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Uri (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{uri }\end{DoxyParamCaption})}



Set request U\+RI. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em uri} & N\+U\+L\+L-\/terminated string that contains the resource name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 463 of file http\+\_\+client.\+c.


\begin{DoxyCode}
464 \{
465    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
466    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
467    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
468    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *q;
469 
470    \textcolor{comment}{//Check parameters}
471    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || uri == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
472       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
473 
474    \textcolor{comment}{//The resource name must not be empty}
475    \textcolor{keywordflow}{if}(uri[0] == \textcolor{charliteral}{'\(\backslash\)0'})
476       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
477 
478    \textcolor{comment}{//Check HTTP request state}
479    \textcolor{keywordflow}{if}(context->requestState != \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER})
480       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
481 
482    \textcolor{comment}{//Make sure the buffer contains a valid HTTP request}
483    \textcolor{keywordflow}{if}(context->bufferLen > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
484       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
485 
486    \textcolor{comment}{//Properly terminate the string with a NULL character}
487    context->buffer[context->bufferLen] = \textcolor{charliteral}{'\(\backslash\)0'};
488 
489    \textcolor{comment}{//The Request-Line begins with a method token}
490    p = strchr(context->buffer, \textcolor{charliteral}{' '});
491    \textcolor{comment}{//Any parsing error?}
492    \textcolor{keywordflow}{if}(p == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
493       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
494 
495    \textcolor{comment}{//The method token is followed by the Request-URI}
496    p++;
497 
498    \textcolor{comment}{//Point to the end of the Request-URI}
499    q = strpbrk(p, \textcolor{stringliteral}{" ?"});
500    \textcolor{comment}{//Any parsing error?}
501    \textcolor{keywordflow}{if}(q == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
502       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
503 
504    \textcolor{comment}{//Compute the length of the current URI}
505    m = q - \hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
506    \textcolor{comment}{//Compute the length of the new URI}
507    n = strlen(uri);
508 
509    \textcolor{comment}{//Make sure the buffer is large enough to hold the new resource name}
510    \textcolor{keywordflow}{if}((context->bufferLen + n - m) > \hyperlink{http__client_8h_ae5dc9a5f9f9c310897f83e8f6d1c5ab3}{HTTP\_CLIENT\_BUFFER\_SIZE})
511       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
512 
513    \textcolor{comment}{//Make room for the new resource name}
514    memmove(p + n, q, context->buffer + context->bufferLen + 1 - q);
515    \textcolor{comment}{//Copy the new resource name}
516    strncpy(p, uri, n);
517 
518    \textcolor{comment}{//Adjust the length of the request header}
519    context->bufferLen = context->bufferLen + n - \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
520 
521    \textcolor{comment}{//Successful processing}
522    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
523 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_aa0a9b170cae6b61a3fa46201cb12d4ad}\label{http__client_8c_aa0a9b170cae6b61a3fa46201cb12d4ad}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Set\+Version@{http\+Client\+Set\+Version}}
\index{http\+Client\+Set\+Version@{http\+Client\+Set\+Version}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Set\+Version()}{httpClientSetVersion()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Set\+Version (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{http__common_8h_ac870fd261da652aee69937751c6f7e7f}{Http\+Version}}]{version }\end{DoxyParamCaption})}



Set the H\+T\+TP protocol version to be used. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em version} & H\+T\+TP protocol version (1.\+0 or 1.\+1) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 162 of file http\+\_\+client.\+c.


\begin{DoxyCode}
163 \{
164    \textcolor{comment}{//Make sure the HTTP client context is valid}
165    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
166       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
167 
168    \textcolor{comment}{//Check HTTP version}
169    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} != \hyperlink{http__common_8h_ac870fd261da652aee69937751c6f7e7fa3932308db22120ce049dd60f3430b814}{HTTP\_VERSION\_1\_0} && \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} != 
      \hyperlink{http__common_8h_ac870fd261da652aee69937751c6f7e7faf1a34119b438038bc609a273f9bc08c6}{HTTP\_VERSION\_1\_1})
170       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
171 
172    \textcolor{comment}{//Save the protocol version to be used}
173    context->version = \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version};
174 
175    \textcolor{comment}{//Successful processing}
176    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
177 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ad8fc7e7ab6e112f6152c173e58f35ef7}\label{http__client_8c_ad8fc7e7ab6e112f6152c173e58f35ef7}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Write\+Body@{http\+Client\+Write\+Body}}
\index{http\+Client\+Write\+Body@{http\+Client\+Write\+Body}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Write\+Body()}{httpClientWriteBody()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Write\+Body (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{written,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{flags }\end{DoxyParamCaption})}



Write H\+T\+TP request body. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the buffer containing the data to be transmitted \\
\hline
\mbox{\tt in}  & {\em length} & Number of data bytes to send \\
\hline
\mbox{\tt out}  & {\em written} & Actual number of bytes written (optional parameter) \\
\hline
\mbox{\tt in}  & {\em flags} & Set of flags that influences the behavior of this function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1138 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1140 \{
1141    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1142    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1143    \textcolor{keywordtype}{size\_t} totalLength;
1144 
1145    \textcolor{comment}{//Make sure the HTTP client context is valid}
1146    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1147       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1148 
1149    \textcolor{comment}{//Check HTTP connection state}
1150    \textcolor{keywordflow}{if}(context->state != \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
1151       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1152 
1153    \textcolor{comment}{//Initialize status code}
1154    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1155 
1156    \textcolor{comment}{//Actual number of bytes written}
1157    totalLength = 0;
1158 
1159    \textcolor{comment}{//Send as much data as possible}
1160    \textcolor{keywordflow}{while}(totalLength < \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} && !error)
1161    \{
1162       \textcolor{comment}{//Check HTTP request state}
1163       \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a4b7be0c1456c3de2bfa2eb8f6f9be7f4}{HTTP\_REQ\_STATE\_SEND\_BODY})
1164       \{
1165          \textcolor{comment}{//Chunked transfer encoding?}
1166          \textcolor{keywordflow}{if}(context->chunkedEncoding)
1167          \{
1168             \textcolor{comment}{//The chunked encoding modifies the body in order to transfer it}
1169             \textcolor{comment}{//as a series of chunks, each with its own size indicator}
1170             error = \hyperlink{http__client__misc_8c_a6f213287a2c06305dbc6fb54a0499717}{httpClientFormatChunkSize}(context, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - totalLength);
1171          \}
1172          \textcolor{keywordflow}{else}
1173          \{
1174             \textcolor{comment}{//Number of bytes left to send}
1175             n = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - totalLength;
1176 
1177             \textcolor{comment}{//The length of the body shall not exceed the value specified in}
1178             \textcolor{comment}{//the Content-Length field}
1179             \textcolor{keywordflow}{if}(n <= (context->bodyLen - context->bodyPos))
1180             \{
1181                \textcolor{comment}{//Send request body}
1182                error = \hyperlink{http__client__transport_8c_acf7c4497178419c3b964c1430881c20a}{httpClientSendData}(context, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, n, &n, 
      \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags});
1183 
1184                \textcolor{comment}{//Check status code}
1185                \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1186                \{
1187                   \textcolor{comment}{//Any data transmitted?}
1188                   \textcolor{keywordflow}{if}(n > 0)
1189                   \{
1190                      \textcolor{comment}{//Advance data pointer}
1191                      \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + n;
1192                      totalLength += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1193                      context->bodyPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1194 
1195                      \textcolor{comment}{//Save current time}
1196                      context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1197                   \}
1198                \}
1199             \}
1200             \textcolor{keywordflow}{else}
1201             \{
1202                \textcolor{comment}{//Report an error}
1203                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1204             \}
1205          \}
1206       \}
1207       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a1658572c4a34a7fe051e89d9fb6498ca}{HTTP\_REQ\_STATE\_SEND\_CHUNK\_SIZE})
1208       \{
1209          \textcolor{comment}{//Send the chunk-size field}
1210          \textcolor{keywordflow}{if}(context->bufferPos < context->bufferLen)
1211          \{
1212             \textcolor{comment}{//Send more data}
1213             error = \hyperlink{http__client__transport_8c_acf7c4497178419c3b964c1430881c20a}{httpClientSendData}(context,
1214                context->buffer + context->bufferPos,
1215                context->bufferLen - context->bufferPos, &n, 0);
1216 
1217             \textcolor{comment}{//Check status code}
1218             \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1219             \{
1220                \textcolor{comment}{//Advance data pointer}
1221                context->bufferPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1222             \}
1223          \}
1224          \textcolor{keywordflow}{else}
1225          \{
1226             \textcolor{comment}{//Send chunk data}
1227             \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac9eaf361a36f169f32dcbcc4e6fceaa6}{HTTP\_REQ\_STATE\_SEND\_CHUNK\_DATA});
1228          \}
1229       \}
1230       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac9eaf361a36f169f32dcbcc4e6fceaa6}{HTTP\_REQ\_STATE\_SEND\_CHUNK\_DATA})
1231       \{
1232          \textcolor{comment}{//The data stream is divided into a series of chunks}
1233          \textcolor{keywordflow}{if}(context->bodyPos < context->bodyLen)
1234          \{
1235             \textcolor{comment}{//The length of the chunk shall not exceed the value specified in}
1236             \textcolor{comment}{//the chunk-size field}
1237             n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - totalLength, context->bodyLen - context->bodyPos);
1238 
1239             \textcolor{comment}{//Send chunk data}
1240             error = \hyperlink{http__client__transport_8c_acf7c4497178419c3b964c1430881c20a}{httpClientSendData}(context, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, n, &n, 
      \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags});
1241 
1242             \textcolor{comment}{//Check status code}
1243             \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1244             \{
1245                \textcolor{comment}{//Any data transmitted?}
1246                \textcolor{keywordflow}{if}(n > 0)
1247                \{
1248                   \textcolor{comment}{//Advance data pointer}
1249                   \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + n;
1250                   totalLength += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1251                   context->bodyPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1252 
1253                   \textcolor{comment}{//Save current time}
1254                   context->timestamp = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1255                \}
1256             \}
1257          \}
1258          \textcolor{keywordflow}{else}
1259          \{
1260             \textcolor{comment}{//The chunked encoding modifies the body in order to transfer it}
1261             \textcolor{comment}{//as a series of chunks, each with its own size indicator}
1262             error = \hyperlink{http__client__misc_8c_a6f213287a2c06305dbc6fb54a0499717}{httpClientFormatChunkSize}(context, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - totalLength);
1263          \}
1264       \}
1265       \textcolor{keywordflow}{else}
1266       \{
1267          \textcolor{comment}{//Invalid state}
1268          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1269       \}
1270    \}
1271 
1272    \textcolor{comment}{//Check status code}
1273    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1274    \{
1275       \textcolor{comment}{//Check whether the timeout has elapsed}
1276       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
1277    \}
1278 
1279    \textcolor{comment}{//Total number of data that have been written}
1280    \textcolor{keywordflow}{if}(written != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1281       *written = totalLength;
1282 
1283    \textcolor{comment}{//Return status code}
1284    \textcolor{keywordflow}{return} error;
1285 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_ad5d0fa0d0956d2acae73a732b0145532}\label{http__client_8c_ad5d0fa0d0956d2acae73a732b0145532}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Write\+Header@{http\+Client\+Write\+Header}}
\index{http\+Client\+Write\+Header@{http\+Client\+Write\+Header}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Write\+Header()}{httpClientWriteHeader()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Write\+Header (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Write H\+T\+TP request header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1015 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1016 \{
1017    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1018    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1019 
1020    \textcolor{comment}{//Make sure the HTTP client context is valid}
1021    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1022       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1023 
1024    \textcolor{comment}{//Initialize status code}
1025    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1026 
1027    \textcolor{comment}{//Send HTTP request header}
1028    \textcolor{keywordflow}{while}(!error)
1029    \{
1030       \textcolor{comment}{//Check HTTP connection state}
1031       \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5a9461c64cb97e15adc59d1d03da487f35}{HTTP\_CLIENT\_STATE\_DISCONNECTED} ||
1032          context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5ab580e6f09d3f17c40782dd66290aa4bc}{HTTP\_CLIENT\_STATE\_CONNECTING})
1033       \{
1034          \textcolor{comment}{//If the HTTP connection is not persistent, then a new connection}
1035          \textcolor{comment}{//must be established}
1036          error = \hyperlink{http__client_8c_ac032a0e53828bd754c5c6762eba948f7}{httpClientConnect}(context, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
1037       \}
1038       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
1039       \{
1040          \textcolor{comment}{//Check HTTP request state}
1041          \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a2db1c4a85881214f94b34ba8c9a69901}{HTTP\_REQ\_STATE\_FORMAT\_HEADER})
1042          \{
1043 \textcolor{preprocessor}{#if (HTTP\_CLIENT\_AUTH\_SUPPORT == ENABLED)}
1044             \textcolor{comment}{//HTTP authentication requested by the server?}
1045             \textcolor{keywordflow}{if}(context->authParams.mode != \hyperlink{http__common_8h_ad435f9e57a3351beaec6fc809eff4f31a9136cfe14d0dc1985d1e4d93acbc44d7}{HTTP\_AUTH\_MODE\_NONE} &&
1046                context->authParams.username[0] != \textcolor{charliteral}{'\(\backslash\)0'})
1047             \{
1048                \textcolor{comment}{//Format Authorization header field}
1049                error = \hyperlink{http__client__auth_8c_aa681300ec1fc69a129a64e24c7fd4f5a}{httpClientFormatAuthorizationField}(context);
1050             \}
1051 \textcolor{preprocessor}{#endif}
1052             \textcolor{comment}{//Check status code}
1053             \textcolor{keywordflow}{if}(!error)
1054             \{
1055                \textcolor{comment}{//Dump HTTP request header}
1056                \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"HTTP request header:\(\backslash\)r\(\backslash\)n%s"}, context->buffer);
1057 
1058                \textcolor{comment}{//Initiate the sending process}
1059                \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7b3485eafd1b2cc0dfa1482acbfc20ee}{HTTP\_REQ\_STATE\_SEND\_HEADER});
1060             \}
1061          \}
1062          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a7b3485eafd1b2cc0dfa1482acbfc20ee}{HTTP\_REQ\_STATE\_SEND\_HEADER})
1063          \{
1064             \textcolor{comment}{//Any remaining data to be sent?}
1065             \textcolor{keywordflow}{if}(context->bufferPos < context->bufferLen)
1066             \{
1067                \textcolor{comment}{//Send more data}
1068                error = \hyperlink{http__client__transport_8c_acf7c4497178419c3b964c1430881c20a}{httpClientSendData}(context,
1069                   context->buffer + context->bufferPos,
1070                   context->bufferLen - context->bufferPos, &n, 0);
1071 
1072                \textcolor{comment}{//Check status code}
1073                \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1074                \{
1075                   \textcolor{comment}{//Advance data pointer}
1076                   context->bufferPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1077                \}
1078             \}
1079             \textcolor{keywordflow}{else}
1080             \{
1081                \textcolor{comment}{//The request header has been successfully transmitted}
1082                \textcolor{keywordflow}{if}(!\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(context->method, \textcolor{stringliteral}{"POST"}) ||
1083                   !\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(context->method, \textcolor{stringliteral}{"PUT"}) ||
1084                   !\hyperlink{os__port__windows_8h_ac99ec3f1036620727a68aa8c25a8963c}{strcasecmp}(context->method, \textcolor{stringliteral}{"PATCH"}))
1085                \{
1086                   \textcolor{comment}{//POST, PUT and PATCH requests have a body}
1087                   \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a4b7be0c1456c3de2bfa2eb8f6f9be7f4}{HTTP\_REQ\_STATE\_SEND\_BODY});
1088                \}
1089                \textcolor{keywordflow}{else}
1090                \{
1091                   \textcolor{comment}{//GET, HEAD and DELETE requests do not have a body}
1092                   \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context,
1093                      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE});
1094                \}
1095             \}
1096          \}
1097          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a4b7be0c1456c3de2bfa2eb8f6f9be7f4}{HTTP\_REQ\_STATE\_SEND\_BODY} ||
1098             context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE})
1099          \{
1100             \textcolor{comment}{//We are done}
1101             \textcolor{keywordflow}{break};
1102          \}
1103          \textcolor{keywordflow}{else}
1104          \{
1105             \textcolor{comment}{//Invalid HTTP request state}
1106             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1107          \}
1108       \}
1109       \textcolor{keywordflow}{else}
1110       \{
1111          \textcolor{comment}{//Invalid HTTP connection state}
1112          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1113       \}
1114    \}
1115 
1116    \textcolor{comment}{//Check status code}
1117    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1118    \{
1119       \textcolor{comment}{//Check whether the timeout has elapsed}
1120       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
1121    \}
1122 
1123    \textcolor{comment}{//Return status code}
1124    \textcolor{keywordflow}{return} error;
1125 \}
\end{DoxyCode}
\mbox{\Hypertarget{http__client_8c_a231bbf939dd131f242a639f9e73853a9}\label{http__client_8c_a231bbf939dd131f242a639f9e73853a9}} 
\index{http\+\_\+client.\+c@{http\+\_\+client.\+c}!http\+Client\+Write\+Trailer@{http\+Client\+Write\+Trailer}}
\index{http\+Client\+Write\+Trailer@{http\+Client\+Write\+Trailer}!http\+\_\+client.\+c@{http\+\_\+client.\+c}}
\subsubsection{\texorpdfstring{http\+Client\+Write\+Trailer()}{httpClientWriteTrailer()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} http\+Client\+Write\+Trailer (\begin{DoxyParamCaption}\item[{\hyperlink{http__client_8h_a23a71e0fb25f8ecfe6a649b1375dd7ea}{Http\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Write H\+T\+TP trailer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the H\+T\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1294 of file http\+\_\+client.\+c.


\begin{DoxyCode}
1295 \{
1296    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1297    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1298 
1299    \textcolor{comment}{//Make sure the HTTP client context is valid}
1300    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1301       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1302 
1303    \textcolor{comment}{//Check HTTP connection state}
1304    \textcolor{keywordflow}{if}(context->state != \hyperlink{http__client_8h_a467beb99e0cff97a16b2ef23a0aaf8c5aa55ac92b647d441987b9b35a14f51664}{HTTP\_CLIENT\_STATE\_CONNECTED})
1305       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1306 
1307    \textcolor{comment}{//Initialize status code}
1308    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1309 
1310    \textcolor{comment}{//Send HTTP request header}
1311    \textcolor{keywordflow}{while}(!error)
1312    \{
1313       \textcolor{comment}{//Check HTTP request state}
1314       \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671a59a40d0faad7f72e050bfc3e638ab188}{HTTP\_REQ\_STATE\_FORMAT\_TRAILER})
1315       \{
1316          \textcolor{comment}{//Initiate the sending process}
1317          \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context, 
      \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac39d0dd0d2c1ec13b2377006ace81fbd}{HTTP\_REQ\_STATE\_SEND\_TRAILER});
1318       \}
1319       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ac39d0dd0d2c1ec13b2377006ace81fbd}{HTTP\_REQ\_STATE\_SEND\_TRAILER})
1320       \{
1321          \textcolor{comment}{//Any remaining data to be sent?}
1322          \textcolor{keywordflow}{if}(context->bufferPos < context->bufferLen)
1323          \{
1324             \textcolor{comment}{//Send more data}
1325             error = \hyperlink{http__client__transport_8c_acf7c4497178419c3b964c1430881c20a}{httpClientSendData}(context,
1326                context->buffer + context->bufferPos,
1327                context->bufferLen - context->bufferPos, &n, 0);
1328 
1329             \textcolor{comment}{//Check status code}
1330             \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1331             \{
1332                \textcolor{comment}{//Advance data pointer}
1333                context->bufferPos += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1334             \}
1335          \}
1336          \textcolor{keywordflow}{else}
1337          \{
1338             \textcolor{comment}{//The request trailer has been successfully transmitted}
1339             \hyperlink{http__client__misc_8c_ab939b547ad8d46c74d994acc2d0eae67}{httpClientChangeRequestState}(context,
1340                \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE});
1341          \}
1342       \}
1343       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->requestState == \hyperlink{http__common_8h_a4fe74ac4ac2fba01b65f71b093977671ae23a0bbacbfc4e9cbcb3996a27ca5cfa}{HTTP\_REQ\_STATE\_RECEIVE\_STATUS\_LINE}
      )
1344       \{
1345          \textcolor{comment}{//We are done}
1346          \textcolor{keywordflow}{break};
1347       \}
1348       \textcolor{keywordflow}{else}
1349       \{
1350          \textcolor{comment}{//Invalid state}
1351          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1352       \}
1353    \}
1354 
1355    \textcolor{comment}{//Check status code}
1356    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
1357    \{
1358       \textcolor{comment}{//Check whether the timeout has elapsed}
1359       error = \hyperlink{http__client__misc_8c_aea8887260715dbe6c37a90576776fdfc}{httpClientCheckTimeout}(context);
1360    \}
1361 
1362    \textcolor{comment}{//Return status code}
1363    \textcolor{keywordflow}{return} error;
1364 \}
\end{DoxyCode}
