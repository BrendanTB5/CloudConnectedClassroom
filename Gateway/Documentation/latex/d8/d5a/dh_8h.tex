\hypertarget{dh_8h}{}\section{cyclone\+\_\+crypto/pkc/dh.h File Reference}
\label{dh_8h}\index{cyclone\+\_\+crypto/pkc/dh.\+h@{cyclone\+\_\+crypto/pkc/dh.\+h}}


Diffie-\/\+Hellman key exchange.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mpi/mpi.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structDhParameters}{Dh\+Parameters}
\begin{DoxyCompactList}\small\item\em Diffie-\/\+Hellman parameters. \end{DoxyCompactList}\item 
struct \hyperlink{structDhContext}{Dh\+Context}
\begin{DoxyCompactList}\small\item\em Diffie-\/\+Hellman context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{dh_8h_a526697a93bd78c2fe11d1f3963f17f3d}{dh\+Init} (\hyperlink{structDhContext}{Dh\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Initialize Diffie-\/\+Hellman context. \end{DoxyCompactList}\item 
void \hyperlink{dh_8h_adc8a5f548564e8dd2add9f7592d8df6b}{dh\+Free} (\hyperlink{structDhContext}{Dh\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Release Diffie-\/\+Hellman context. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{dh_8h_a42364e9c726b1223c227ed4722d02395}{dh\+Generate\+Key\+Pair} (\hyperlink{structDhContext}{Dh\+Context} $\ast$context, const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$prng\+Algo, void $\ast$prng\+Context)
\begin{DoxyCompactList}\small\item\em Diffie-\/\+Hellman key pair generation. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{dh_8h_a988fa4ff931f4ee47c2d46f0db080136}{dh\+Check\+Public\+Key} (\hyperlink{structDhParameters}{Dh\+Parameters} $\ast$params, const \hyperlink{structMpi}{Mpi} $\ast$public\+Key)
\begin{DoxyCompactList}\small\item\em Check Diffie-\/\+Hellman public value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{dh_8h_a79c2a9c97b46c822ed219314a1ef3231}{dh\+Compute\+Shared\+Secret} (\hyperlink{structDhContext}{Dh\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output, size\+\_\+t output\+Size, size\+\_\+t $\ast$output\+Len)
\begin{DoxyCompactList}\small\item\em Compute Diffie-\/\+Hellman shared secret. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Diffie-\/\+Hellman key exchange. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{dh_8h_a988fa4ff931f4ee47c2d46f0db080136}\label{dh_8h_a988fa4ff931f4ee47c2d46f0db080136}} 
\index{dh.\+h@{dh.\+h}!dh\+Check\+Public\+Key@{dh\+Check\+Public\+Key}}
\index{dh\+Check\+Public\+Key@{dh\+Check\+Public\+Key}!dh.\+h@{dh.\+h}}
\subsubsection{\texorpdfstring{dh\+Check\+Public\+Key()}{dhCheckPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} dh\+Check\+Public\+Key (\begin{DoxyParamCaption}\item[{\hyperlink{structDhParameters}{Dh\+Parameters} $\ast$}]{params,  }\item[{const \hyperlink{structMpi}{Mpi} $\ast$}]{public\+Key }\end{DoxyParamCaption})}



Check Diffie-\/\+Hellman public value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em params} & Pointer to the Diffie-\/\+Hellman parameters \\
\hline
\mbox{\tt in}  & {\em public\+Key} & Public value to be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 154 of file dh.\+c.


\begin{DoxyCode}
155 \{
156    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
157    \hyperlink{structMpi}{Mpi} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
158 
159    \textcolor{comment}{//Initialize multiple precision integer}
160    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&a);
161    \textcolor{comment}{//Precompute p - 1}
162    error = \hyperlink{mpi_8c_a77f0e675dfb77c89650dee4c39561891}{mpiSubInt}(&a, &params->\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p}, 1);
163 
164    \textcolor{comment}{//Check status}
165    \textcolor{keywordflow}{if}(!error)
166    \{
167       \textcolor{comment}{//Reject weak public values 1 and p - 1}
168       \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a46c2ff9f6fd5aa944ad4d41833ebef50}{mpiCompInt}(publicKey, 1) <= 0)
169          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
170       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(publicKey, &a) >= 0)
171          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca152b24f57c941cb736772696416eb7c2}{ERROR\_ILLEGAL\_PARAMETER};
172    \}
173 
174    \textcolor{comment}{//Free previously allocated resources}
175    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&a);
176    \textcolor{comment}{//Return status code}
177    \textcolor{keywordflow}{return} error;
178 \}
\end{DoxyCode}
\mbox{\Hypertarget{dh_8h_a79c2a9c97b46c822ed219314a1ef3231}\label{dh_8h_a79c2a9c97b46c822ed219314a1ef3231}} 
\index{dh.\+h@{dh.\+h}!dh\+Compute\+Shared\+Secret@{dh\+Compute\+Shared\+Secret}}
\index{dh\+Compute\+Shared\+Secret@{dh\+Compute\+Shared\+Secret}!dh.\+h@{dh.\+h}}
\subsubsection{\texorpdfstring{dh\+Compute\+Shared\+Secret()}{dhComputeSharedSecret()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} dh\+Compute\+Shared\+Secret (\begin{DoxyParamCaption}\item[{\hyperlink{structDhContext}{Dh\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output,  }\item[{size\+\_\+t}]{output\+Size,  }\item[{size\+\_\+t $\ast$}]{output\+Len }\end{DoxyParamCaption})}



Compute Diffie-\/\+Hellman shared secret. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Diffie-\/\+Hellman context \\
\hline
\mbox{\tt out}  & {\em output} & Buffer where to store the shared secret \\
\hline
\mbox{\tt in}  & {\em output\+Size} & Size of the buffer in bytes \\
\hline
\mbox{\tt out}  & {\em output\+Len} & Length of the resulting shared secret \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 190 of file dh.\+c.


\begin{DoxyCode}
192 \{
193    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
194    \textcolor{keywordtype}{size\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
195    \hyperlink{structMpi}{Mpi} \hyperlink{dns__common_8h_ab3539ae3820541b70d17c66cfc5a0e3f}{z};
196 
197    \textcolor{comment}{//Debug message}
198    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Computing Diffie-Hellman shared secret...\(\backslash\)r\(\backslash\)n"});
199 
200    \textcolor{comment}{//Get the length in octets of the prime modulus}
201    k = \hyperlink{mpi_8c_a8599cb7537c854ae3b2442144c7f853b}{mpiGetByteLength}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p});
202 
203    \textcolor{comment}{//Make sure that the output buffer is large enough}
204    \textcolor{keywordflow}{if}(outputSize < k)
205       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
206 
207    \textcolor{comment}{//The multiple precision integer must be initialized before it can be used}
208    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&z);
209 
210    \textcolor{comment}{//Start of exception handling block}
211    \textcolor{keywordflow}{do}
212    \{
213       \textcolor{comment}{//Calculate the shared secret key (k = yb ^ xa mod p)}
214       error = \hyperlink{samd51__crypto__pukcc_8c_ae18482447f7293c8bb44899ce236b72e}{mpiExpMod}(&z, &context->\hyperlink{structDhContext_a4b1597110a34d09fea578a71a564ac3e}{yb}, &context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa}, &context->
      \hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p});
215       \textcolor{comment}{//Any error to report?}
216       \textcolor{keywordflow}{if}(error)
217          \textcolor{keywordflow}{break};
218 
219       \textcolor{comment}{//Convert the resulting integer to an octet string}
220       error = \hyperlink{crypto__legacy_8h_ae5151562c07814ce486b94bf0035ad12}{mpiWriteRaw}(&z, output, k);
221       \textcolor{comment}{//Conversion failed?}
222       \textcolor{keywordflow}{if}(error)
223          \textcolor{keywordflow}{break};
224 
225       \textcolor{comment}{//Length of the resulting shared secret}
226       *outputLen = \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
227 
228       \textcolor{comment}{//Debug message}
229       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Shared secret (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes):\(\backslash\)r\(\backslash\)n"}, *outputLen);
230       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, output, *outputLen);
231 
232       \textcolor{comment}{//End of exception handling block}
233    \} \textcolor{keywordflow}{while}(0);
234 
235    \textcolor{comment}{//Release previously allocated resources}
236    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&z);
237    \textcolor{comment}{//Return status code}
238    \textcolor{keywordflow}{return} error;
239 \}
\end{DoxyCode}
\mbox{\Hypertarget{dh_8h_adc8a5f548564e8dd2add9f7592d8df6b}\label{dh_8h_adc8a5f548564e8dd2add9f7592d8df6b}} 
\index{dh.\+h@{dh.\+h}!dh\+Free@{dh\+Free}}
\index{dh\+Free@{dh\+Free}!dh.\+h@{dh.\+h}}
\subsubsection{\texorpdfstring{dh\+Free()}{dhFree()}}
{\footnotesize\ttfamily void dh\+Free (\begin{DoxyParamCaption}\item[{\hyperlink{structDhContext}{Dh\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Release Diffie-\/\+Hellman context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Diffie-\/\+Hellman context \\
\hline
\end{DoxyParams}


Definition at line 71 of file dh.\+c.


\begin{DoxyCode}
72 \{
73    \textcolor{comment}{//Release Diffie-Hellman parameters}
74    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p});
75    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_abc22697d6ee37e502b54f988a1c4393d}{g});
76    \textcolor{comment}{//Release private and public values}
77    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa});
78    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&context->\hyperlink{structDhContext_a50340bb658bc72754cd25ccfcc53c619}{ya});
79    \hyperlink{mpi_8c_a9dc5be2f62d37d3854fa61beab3a61ad}{mpiFree}(&context->\hyperlink{structDhContext_a4b1597110a34d09fea578a71a564ac3e}{yb});
80 \}
\end{DoxyCode}
\mbox{\Hypertarget{dh_8h_a42364e9c726b1223c227ed4722d02395}\label{dh_8h_a42364e9c726b1223c227ed4722d02395}} 
\index{dh.\+h@{dh.\+h}!dh\+Generate\+Key\+Pair@{dh\+Generate\+Key\+Pair}}
\index{dh\+Generate\+Key\+Pair@{dh\+Generate\+Key\+Pair}!dh.\+h@{dh.\+h}}
\subsubsection{\texorpdfstring{dh\+Generate\+Key\+Pair()}{dhGenerateKeyPair()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} dh\+Generate\+Key\+Pair (\begin{DoxyParamCaption}\item[{\hyperlink{structDhContext}{Dh\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structPrngAlgo}{Prng\+Algo} $\ast$}]{prng\+Algo,  }\item[{void $\ast$}]{prng\+Context }\end{DoxyParamCaption})}



Diffie-\/\+Hellman key pair generation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Diffie-\/\+Hellman context \\
\hline
\mbox{\tt in}  & {\em prng\+Algo} & P\+R\+NG algorithm \\
\hline
\mbox{\tt in}  & {\em prng\+Context} & Pointer to the P\+R\+NG context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 91 of file dh.\+c.


\begin{DoxyCode}
93 \{
94    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
95    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k};
96 
97    \textcolor{comment}{//Debug message}
98    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Generating Diffie-Hellman key pair...\(\backslash\)r\(\backslash\)n"});
99 
100    \textcolor{comment}{//Get the length in bits of the prime p}
101    k = \hyperlink{mpi_8c_a2e540eb4b5d15ea9755fb3e138990c1c}{mpiGetBitLength}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p});
102    \textcolor{comment}{//Ensure the length is valid}
103    \textcolor{keywordflow}{if}(k == 0)
104       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
105 
106    \textcolor{comment}{//The private value shall be randomly generated}
107    error = \hyperlink{mpi_8c_a9753c7bf919b7c41e48512ba572c3bbb}{mpiRand}(&context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa}, k, prngAlgo, prngContext);
108    \textcolor{comment}{//Any error to report?}
109    \textcolor{keywordflow}{if}(error)
110       \textcolor{keywordflow}{return} error;
111 
112    \textcolor{comment}{//The private value shall be less than p}
113    \textcolor{keywordflow}{if}(\hyperlink{mpi_8c_a54cf7aedd99e130971849eb21eb578c9}{mpiComp}(&context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa}, &context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p}) >= 0)
114    \{
115       \textcolor{comment}{//Shift value to the right}
116       error = \hyperlink{mpi_8c_a550a7330971d895957015b810b25c805}{mpiShiftRight}(&context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa}, 1);
117       \textcolor{comment}{//Any error to report?}
118       \textcolor{keywordflow}{if}(error)
119          \textcolor{keywordflow}{return} error;
120    \}
121 
122    \textcolor{comment}{//Debug message}
123    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private value:\(\backslash\)r\(\backslash\)n"});
124    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa});
125 
126    \textcolor{comment}{//Calculate the corresponding public value (ya = g ^ xa mod p)}
127    error = \hyperlink{samd51__crypto__pukcc_8c_ae18482447f7293c8bb44899ce236b72e}{mpiExpMod}(&context->\hyperlink{structDhContext_a50340bb658bc72754cd25ccfcc53c619}{ya}, &context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_abc22697d6ee37e502b54f988a1c4393d}{g}, &context->
      \hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa}, &context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p});
128    \textcolor{comment}{//Any error to report?}
129    \textcolor{keywordflow}{if}(error)
130       \textcolor{keywordflow}{return} error;
131 
132    \textcolor{comment}{//Debug message}
133    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public value:\(\backslash\)r\(\backslash\)n"});
134    \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &context->\hyperlink{structDhContext_a50340bb658bc72754cd25ccfcc53c619}{ya});
135 
136    \textcolor{comment}{//Check public value}
137    error = \hyperlink{dh_8c_a988fa4ff931f4ee47c2d46f0db080136}{dhCheckPublicKey}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}, &context->\hyperlink{structDhContext_a50340bb658bc72754cd25ccfcc53c619}{ya});
138    \textcolor{comment}{//Weak public value?}
139    \textcolor{keywordflow}{if}(error)
140       \textcolor{keywordflow}{return} error;
141 
142    \textcolor{comment}{//Public value successfully generated}
143    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
144 \}
\end{DoxyCode}
\mbox{\Hypertarget{dh_8h_a526697a93bd78c2fe11d1f3963f17f3d}\label{dh_8h_a526697a93bd78c2fe11d1f3963f17f3d}} 
\index{dh.\+h@{dh.\+h}!dh\+Init@{dh\+Init}}
\index{dh\+Init@{dh\+Init}!dh.\+h@{dh.\+h}}
\subsubsection{\texorpdfstring{dh\+Init()}{dhInit()}}
{\footnotesize\ttfamily void dh\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structDhContext}{Dh\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Initialize Diffie-\/\+Hellman context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Diffie-\/\+Hellman context \\
\hline
\end{DoxyParams}


Definition at line 54 of file dh.\+c.


\begin{DoxyCode}
55 \{
56    \textcolor{comment}{//Initialize Diffie-Hellman parameters}
57    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p});
58    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&context->\hyperlink{structDhContext_a1e218bee95f1683ea9d872258e573ebd}{params}.\hyperlink{structDhParameters_abc22697d6ee37e502b54f988a1c4393d}{g});
59    \textcolor{comment}{//Initialize private and public values}
60    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&context->\hyperlink{structDhContext_a3ceed075dd7b13ffe3fac2c5cbe7bde2}{xa});
61    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&context->\hyperlink{structDhContext_a50340bb658bc72754cd25ccfcc53c619}{ya});
62    \hyperlink{mpi_8c_a6f30959dcaabfb16e96cc47ef90515a6}{mpiInit}(&context->\hyperlink{structDhContext_a4b1597110a34d09fea578a71a564ac3e}{yb});
63 \}
\end{DoxyCode}
