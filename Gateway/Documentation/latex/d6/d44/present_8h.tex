\hypertarget{present_8h}{}\section{cyclone\+\_\+crypto/cipher/present.h File Reference}
\label{present_8h}\index{cyclone\+\_\+crypto/cipher/present.\+h@{cyclone\+\_\+crypto/cipher/present.\+h}}


P\+R\+E\+S\+E\+NT encryption algorithm.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structPresentContext}{Present\+Context}
\begin{DoxyCompactList}\small\item\em P\+R\+E\+S\+E\+NT algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{present_8h_a98a8e4b88fd067f4bdc59a93d1062214}{P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~8
\item 
\#define \hyperlink{present_8h_ad2d090b4213dd691b684f0b8bc8649ec}{P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{present_8h_ac287ff4a0a107d617c553f4a09bffc0a}{present\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{present_8h_a53a27ba7eeba01422cd6f36e54e879bf}{present\+Init} (\hyperlink{structPresentContext}{Present\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Key expansion. \end{DoxyCompactList}\item 
void \hyperlink{present_8h_ab71c2ec7e1ccc2b46b6cdca899ea1bc7}{present\+Encrypt\+Block} (\hyperlink{structPresentContext}{Present\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 8-\/byte block using P\+R\+E\+S\+E\+NT algorithm. \end{DoxyCompactList}\item 
void \hyperlink{present_8h_aa220867126e044c73aca238cee9bc31b}{present\+Decrypt\+Block} (\hyperlink{structPresentContext}{Present\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 8-\/byte block using P\+R\+E\+S\+E\+NT algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{present_8h_ac287ff4a0a107d617c553f4a09bffc0a}{present\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
P\+R\+E\+S\+E\+NT encryption algorithm. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{present_8h_a98a8e4b88fd067f4bdc59a93d1062214}\label{present_8h_a98a8e4b88fd067f4bdc59a93d1062214}} 
\index{present.\+h@{present.\+h}!P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!present.\+h@{present.\+h}}
\subsubsection{\texorpdfstring{P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{PRESENT\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define P\+R\+E\+S\+E\+N\+T\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~8}



Definition at line 38 of file present.\+h.

\mbox{\Hypertarget{present_8h_ad2d090b4213dd691b684f0b8bc8649ec}\label{present_8h_ad2d090b4213dd691b684f0b8bc8649ec}} 
\index{present.\+h@{present.\+h}!P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!present.\+h@{present.\+h}}
\subsubsection{\texorpdfstring{P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{PRESENT\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define P\+R\+E\+S\+E\+N\+T\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{present_8h_ac287ff4a0a107d617c553f4a09bffc0a}{present\+Cipher\+Algo})}



Definition at line 40 of file present.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{present_8h_aa220867126e044c73aca238cee9bc31b}\label{present_8h_aa220867126e044c73aca238cee9bc31b}} 
\index{present.\+h@{present.\+h}!present\+Decrypt\+Block@{present\+Decrypt\+Block}}
\index{present\+Decrypt\+Block@{present\+Decrypt\+Block}!present.\+h@{present.\+h}}
\subsubsection{\texorpdfstring{present\+Decrypt\+Block()}{presentDecryptBlock()}}
{\footnotesize\ttfamily void present\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structPresentContext}{Present\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 8-\/byte block using P\+R\+E\+S\+E\+NT algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the P\+R\+E\+S\+E\+NT context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 338 of file present.\+c.


\begin{DoxyCode}
339 \{
340    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
341    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
342    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
343    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} state;
344 
345    \textcolor{comment}{//Copy the ciphertext to the 64-bit state}
346    state = \hyperlink{cpu__endian_8h_a7a0cbf37cd7f47dbcad3244a5983b033}{LOAD64BE}(input);
347 
348    \textcolor{comment}{//The decryption consists of 31 rounds}
349    \textcolor{keywordflow}{for}(i = 31; i > 0; i--)
350    \{
351       \textcolor{comment}{//Add round key}
352       state ^= context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[i];
353 
354       \textcolor{comment}{//Apply inverse bit permutation}
355       s = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[state & 0xFF];
356       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 8) & 0xFF];
357       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 32);
358       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 16) & 0xFF];
359       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 1);
360       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 24) & 0xFF];
361       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 33);
362       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 32) & 0xFF];
363       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 2);
364       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 40) & 0xFF];
365       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 34);
366       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 48) & 0xFF];
367       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 3);
368       t = \hyperlink{present_8c_aa854b62585a6195a35dfe106c4a9fc47}{ipbox}[(state >> 56) & 0xFF];
369       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 35);
370 
371       \textcolor{comment}{//Apply inverse S-box}
372       state = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[s & 0xFF];
373       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 8) & 0xFF];
374       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 8);
375       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 16) & 0xFF];
376       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 16);
377       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 24) & 0xFF];
378       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 24);
379       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 32) & 0xFF];
380       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 32);
381       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 40) & 0xFF];
382       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 40);
383       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 48) & 0xFF];
384       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 48);
385       t = \hyperlink{present_8c_a7937f1040dcd7aea8595768cc6d95e8e}{isbox}[(s >> 56) & 0xFF];
386       state |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 56);
387    \}
388 
389    \textcolor{comment}{//Final round key addition}
390    state ^= context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[0];
391 
392    \textcolor{comment}{//The final state is then copied to the output}
393    \hyperlink{cpu__endian_8h_abd64119985555609ad9c94eed4c96e0f}{STORE64BE}(state, output);
394 \}
\end{DoxyCode}
\mbox{\Hypertarget{present_8h_ab71c2ec7e1ccc2b46b6cdca899ea1bc7}\label{present_8h_ab71c2ec7e1ccc2b46b6cdca899ea1bc7}} 
\index{present.\+h@{present.\+h}!present\+Encrypt\+Block@{present\+Encrypt\+Block}}
\index{present\+Encrypt\+Block@{present\+Encrypt\+Block}!present.\+h@{present.\+h}}
\subsubsection{\texorpdfstring{present\+Encrypt\+Block()}{presentEncryptBlock()}}
{\footnotesize\ttfamily void present\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structPresentContext}{Present\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 8-\/byte block using P\+R\+E\+S\+E\+NT algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the P\+R\+E\+S\+E\+NT context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 289 of file present.\+c.


\begin{DoxyCode}
290 \{
291    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
292    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
293    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
294    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} state;
295 
296    \textcolor{comment}{//Copy the plaintext to the 64-bit state}
297    state = \hyperlink{cpu__endian_8h_a7a0cbf37cd7f47dbcad3244a5983b033}{LOAD64BE}(input);
298 
299    \textcolor{comment}{//Initial round key addition}
300    state ^= context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[0];
301 
302    \textcolor{comment}{//The encryption consists of 31 rounds}
303    \textcolor{keywordflow}{for}(i = 1; i <= 31; i++)
304    \{
305       \textcolor{comment}{//Apply S-box and bit permutation}
306       s = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[state & 0xFF];
307       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 8) & 0xFF];
308       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 2);
309       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 16) & 0xFF];
310       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 4);
311       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 24) & 0xFF];
312       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 6);
313       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 32) & 0xFF];
314       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 8);
315       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 40) & 0xFF];
316       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 10);
317       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 48) & 0xFF];
318       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 12);
319       t = \hyperlink{present_8c_a0db8dc1199ca0b26de7fd7980588f6a1}{spbox}[(state >> 56) & 0xFF];
320       s |= \hyperlink{cyclone__crypto_2core_2crypto_8h_aa80c49fe62eb3d421b2abca5b4c597ff}{ROL64}(t, 14);
321 
322       \textcolor{comment}{//Add round key}
323       state = s ^ context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[i];
324    \}
325 
326    \textcolor{comment}{//The final state is then copied to the output}
327    \hyperlink{cpu__endian_8h_abd64119985555609ad9c94eed4c96e0f}{STORE64BE}(state, output);
328 \}
\end{DoxyCode}
\mbox{\Hypertarget{present_8h_a53a27ba7eeba01422cd6f36e54e879bf}\label{present_8h_a53a27ba7eeba01422cd6f36e54e879bf}} 
\index{present.\+h@{present.\+h}!present\+Init@{present\+Init}}
\index{present\+Init@{present\+Init}!present.\+h@{present.\+h}}
\subsubsection{\texorpdfstring{present\+Init()}{presentInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} present\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structPresentContext}{Present\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Key expansion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the P\+R\+E\+S\+E\+NT context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 201 of file present.\+c.


\begin{DoxyCode}
202 \{
203    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
204    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
205    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} kl;
206    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} kh;
207 
208    \textcolor{comment}{//Check parameters}
209    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
210       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
211 
212    \textcolor{comment}{//Check key length}
213    \textcolor{keywordflow}{if}(keyLen != 10 && keyLen != 16)
214       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
215 
216    \textcolor{comment}{//PRESENT can take keys of either 80 or 128 bits}
217    \textcolor{keywordflow}{if}(keyLen == 10)
218    \{
219       \textcolor{comment}{//Copy the 80-bit key}
220       kh = \hyperlink{cpu__endian_8h_ae21854587c05993c850b537156470088}{LOAD16BE}(key);
221       kl = \hyperlink{cpu__endian_8h_a7a0cbf37cd7f47dbcad3244a5983b033}{LOAD64BE}(key + 2);
222 
223       \textcolor{comment}{//Save the 64 leftmost bits of K}
224       context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[0] = (kh << 48) | (kl >> 16);
225 
226       \textcolor{comment}{//Generate round keys}
227       \textcolor{keywordflow}{for}(i = 1; i <= 31; i++)
228       \{
229          \textcolor{comment}{//The key register is rotated by 61 bit positions to the left}
230          t = kh & 0xFFFF;
231          kh = (kl >> 3) & 0xFFFF;
232          kl = (kl << 61) | (t << 45) | (kl >> 19);
233 
234          \textcolor{comment}{//The left-most four bits are passed through the S-box}
235          t = \hyperlink{present_8c_a09382ccb7826d007307c650d5f706000}{sbox}[(kh >> 12) & 0x0F];
236          kh = (kh & 0x0FFF) | (t << 12);
237 
238          \textcolor{comment}{//The round counter value i is XOR-ed with bits 19, 18, 17, 16, 15 of K}
239          kl ^= (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) i << 15;
240 
241          \textcolor{comment}{//Save the 64 leftmost bits of K}
242          context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[i] = (kh << 48) | (kl >> 16);
243       \}
244    \}
245    \textcolor{keywordflow}{else}
246    \{
247       \textcolor{comment}{//Copy the 128-bit key}
248       kh = \hyperlink{cpu__endian_8h_a7a0cbf37cd7f47dbcad3244a5983b033}{LOAD64BE}(key);
249       kl = \hyperlink{cpu__endian_8h_a7a0cbf37cd7f47dbcad3244a5983b033}{LOAD64BE}(key + 8);
250 
251       \textcolor{comment}{//Save the 64 leftmost bits of K}
252       context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[0] = kh;
253 
254       \textcolor{comment}{//Generate round keys}
255       \textcolor{keywordflow}{for}(i = 1; i <= 31; i++)
256       \{
257          \textcolor{comment}{//The key register is rotated by 61 bit positions to the left}
258          t = kh;
259          kh = (t << 61) | (kl >> 3);
260          kl = (kl << 61) | (t >> 3);
261 
262          \textcolor{comment}{//The left-most eight bits are passed through two S-boxes}
263          t = \hyperlink{present_8c_a09382ccb7826d007307c650d5f706000}{sbox}[(kh >> 56) & 0x0F];
264          kh = (kh & 0xF0FFFFFFFFFFFFFF) | (t << 56);
265          t = \hyperlink{present_8c_a09382ccb7826d007307c650d5f706000}{sbox}[(kh >> 60) & 0x0F];
266          kh = (kh & 0x0FFFFFFFFFFFFFFF) | (t << 60);
267 
268          \textcolor{comment}{//The round counter value i is XOR-ed with bits 66, 65, 64, 63, 62 of K}
269          kh ^= (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) i >> 2;
270          kl ^= (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) i << 62;
271 
272          \textcolor{comment}{//Save the 64 leftmost bits of K}
273          context->\hyperlink{structPresentContext_acc45bfe5b10140d7b89d0d9d94e771e6}{ks}[i] = kh;
274       \}
275    \}
276 
277    \textcolor{comment}{//No error to report}
278    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
279 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{present_8h_ac287ff4a0a107d617c553f4a09bffc0a}\label{present_8h_ac287ff4a0a107d617c553f4a09bffc0a}} 
\index{present.\+h@{present.\+h}!present\+Cipher\+Algo@{present\+Cipher\+Algo}}
\index{present\+Cipher\+Algo@{present\+Cipher\+Algo}!present.\+h@{present.\+h}}
\subsubsection{\texorpdfstring{present\+Cipher\+Algo}{presentCipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} present\+Cipher\+Algo}



Definition at line 179 of file present.\+c.

