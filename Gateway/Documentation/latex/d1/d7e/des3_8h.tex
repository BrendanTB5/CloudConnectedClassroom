\hypertarget{des3_8h}{}\section{cyclone\+\_\+crypto/cipher/des3.h File Reference}
\label{des3_8h}\index{cyclone\+\_\+crypto/cipher/des3.\+h@{cyclone\+\_\+crypto/cipher/des3.\+h}}


Triple D\+ES (Triple Data Encryption Algorithm)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cipher/des.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structDes3Context}{Des3\+Context}
\begin{DoxyCompactList}\small\item\em Triple D\+ES algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{des3_8h_a605706bc141516b9b0ab2e080ae1fd12}{D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~8
\item 
\#define \hyperlink{des3_8h_a0c5ae12dbd0184714207af403328e9dc}{D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{des3_8h_a7ba3ac988b1508c0fd9ab0fe20e4295f}{des3\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{des3_8h_a677f97a9c31391f097bf90e61c3c577b}{des3\+Init} (\hyperlink{structDes3Context}{Des3\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a Triple D\+ES context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{des3_8h_a825374d62963835a8b4ced98c0bfe540}{des3\+Encrypt\+Block} (\hyperlink{structDes3Context}{Des3\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 8-\/byte block using Triple D\+ES algorithm. \end{DoxyCompactList}\item 
void \hyperlink{des3_8h_a13e624a5463a512a3eb3d1a3aab45e2a}{des3\+Decrypt\+Block} (\hyperlink{structDes3Context}{Des3\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 8-\/byte block using Triple D\+ES algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{des3_8h_a7ba3ac988b1508c0fd9ab0fe20e4295f}{des3\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Triple D\+ES (Triple Data Encryption Algorithm) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{des3_8h_a605706bc141516b9b0ab2e080ae1fd12}\label{des3_8h_a605706bc141516b9b0ab2e080ae1fd12}} 
\index{des3.\+h@{des3.\+h}!D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!des3.\+h@{des3.\+h}}
\subsubsection{\texorpdfstring{D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{DES3\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~8}



Definition at line 39 of file des3.\+h.

\mbox{\Hypertarget{des3_8h_a0c5ae12dbd0184714207af403328e9dc}\label{des3_8h_a0c5ae12dbd0184714207af403328e9dc}} 
\index{des3.\+h@{des3.\+h}!D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!des3.\+h@{des3.\+h}}
\subsubsection{\texorpdfstring{D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{DES3\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define D\+E\+S3\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{des3_8h_a7ba3ac988b1508c0fd9ab0fe20e4295f}{des3\+Cipher\+Algo})}



Definition at line 41 of file des3.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{des3_8h_a13e624a5463a512a3eb3d1a3aab45e2a}\label{des3_8h_a13e624a5463a512a3eb3d1a3aab45e2a}} 
\index{des3.\+h@{des3.\+h}!des3\+Decrypt\+Block@{des3\+Decrypt\+Block}}
\index{des3\+Decrypt\+Block@{des3\+Decrypt\+Block}!des3.\+h@{des3.\+h}}
\subsubsection{\texorpdfstring{des3\+Decrypt\+Block()}{des3DecryptBlock()}}
{\footnotesize\ttfamily void des3\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structDes3Context}{Des3\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 8-\/byte block using Triple D\+ES algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Triple D\+ES context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 138 of file des3.\+c.


\begin{DoxyCode}
139 \{
140    \textcolor{comment}{//The first pass is a DES decryption}
141    \hyperlink{des_8c_a3211e55b31b1e6c04f84e385494bd31c}{desDecryptBlock}(&context->\hyperlink{structDes3Context_ab68be5d202fbef6ce3d5e3bb10b29a8f}{k3}, input, output);
142    \textcolor{comment}{//The second pass is a DES encryption of the first pass result}
143    \hyperlink{des_8c_aa775fbbff698bd0168c4d0fc84869a8f}{desEncryptBlock}(&context->\hyperlink{structDes3Context_a68cb8fdee2e8cbd2af7cdac16201766e}{k2}, output, output);
144    \textcolor{comment}{//The third pass is a DES decryption of the second ciphertext result}
145    \hyperlink{des_8c_a3211e55b31b1e6c04f84e385494bd31c}{desDecryptBlock}(&context->\hyperlink{structDes3Context_a1ab518552a02d4488c4fb72f961c09b9}{k1}, output, output);
146 \}
\end{DoxyCode}
\mbox{\Hypertarget{des3_8h_a825374d62963835a8b4ced98c0bfe540}\label{des3_8h_a825374d62963835a8b4ced98c0bfe540}} 
\index{des3.\+h@{des3.\+h}!des3\+Encrypt\+Block@{des3\+Encrypt\+Block}}
\index{des3\+Encrypt\+Block@{des3\+Encrypt\+Block}!des3.\+h@{des3.\+h}}
\subsubsection{\texorpdfstring{des3\+Encrypt\+Block()}{des3EncryptBlock()}}
{\footnotesize\ttfamily void des3\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structDes3Context}{Des3\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 8-\/byte block using Triple D\+ES algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Triple D\+ES context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 120 of file des3.\+c.


\begin{DoxyCode}
121 \{
122    \textcolor{comment}{//The first pass is a DES encryption}
123    \hyperlink{des_8c_aa775fbbff698bd0168c4d0fc84869a8f}{desEncryptBlock}(&context->\hyperlink{structDes3Context_a1ab518552a02d4488c4fb72f961c09b9}{k1}, input, output);
124    \textcolor{comment}{//The second pass is a DES decryption of the first ciphertext result}
125    \hyperlink{des_8c_a3211e55b31b1e6c04f84e385494bd31c}{desDecryptBlock}(&context->\hyperlink{structDes3Context_a68cb8fdee2e8cbd2af7cdac16201766e}{k2}, output, output);
126    \textcolor{comment}{//The third pass is a DES encryption of the second pass result}
127    \hyperlink{des_8c_aa775fbbff698bd0168c4d0fc84869a8f}{desEncryptBlock}(&context->\hyperlink{structDes3Context_ab68be5d202fbef6ce3d5e3bb10b29a8f}{k3}, output, output);
128 \}
\end{DoxyCode}
\mbox{\Hypertarget{des3_8h_a677f97a9c31391f097bf90e61c3c577b}\label{des3_8h_a677f97a9c31391f097bf90e61c3c577b}} 
\index{des3.\+h@{des3.\+h}!des3\+Init@{des3\+Init}}
\index{des3\+Init@{des3\+Init}!des3.\+h@{des3.\+h}}
\subsubsection{\texorpdfstring{des3\+Init()}{des3Init()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} des3\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structDes3Context}{Des3\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Initialize a Triple D\+ES context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Triple D\+ES context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 70 of file des3.\+c.


\begin{DoxyCode}
71 \{
72    \textcolor{comment}{//Check parameters}
73    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
74       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
75 
76    \textcolor{comment}{//Check key length}
77    \textcolor{keywordflow}{if}(keyLen == 8)
78    \{
79       \textcolor{comment}{//This option provides backward compatibility with DES, because the}
80       \textcolor{comment}{//first and second DES operations cancel out}
81       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_a1ab518552a02d4488c4fb72f961c09b9}{k1}, key, 8);
82       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_a68cb8fdee2e8cbd2af7cdac16201766e}{k2}, key, 8);
83       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_ab68be5d202fbef6ce3d5e3bb10b29a8f}{k3}, key, 8);
84    \}
85    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(keyLen == 16)
86    \{
87       \textcolor{comment}{//If the key length is 128 bits including parity, the first 8 bytes of the}
88       \textcolor{comment}{//encoding represent the key used for the two outer DES operations, and}
89       \textcolor{comment}{//the second 8 bytes represent the key used for the inner DES operation}
90       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_a1ab518552a02d4488c4fb72f961c09b9}{k1}, key, 8);
91       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_a68cb8fdee2e8cbd2af7cdac16201766e}{k2}, key + 8, 8);
92       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_ab68be5d202fbef6ce3d5e3bb10b29a8f}{k3}, key, 8);
93    \}
94    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(keyLen == 24)
95    \{
96       \textcolor{comment}{//If the key length is 192 bits including parity, then three independent DES}
97       \textcolor{comment}{//keys are represented, in the order in which they are used for encryption}
98       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_a1ab518552a02d4488c4fb72f961c09b9}{k1}, key, 8);
99       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_a68cb8fdee2e8cbd2af7cdac16201766e}{k2}, key + 8, 8);
100       \hyperlink{des_8c_afadda7acbe44a36384a5d463e9356cb2}{desInit}(&context->\hyperlink{structDes3Context_ab68be5d202fbef6ce3d5e3bb10b29a8f}{k3}, key + 16, 8);
101    \}
102    \textcolor{keywordflow}{else}
103    \{
104       \textcolor{comment}{//Invalid key length...}
105       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
106    \}
107 
108    \textcolor{comment}{//No error to report}
109    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
110 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{des3_8h_a7ba3ac988b1508c0fd9ab0fe20e4295f}\label{des3_8h_a7ba3ac988b1508c0fd9ab0fe20e4295f}} 
\index{des3.\+h@{des3.\+h}!des3\+Cipher\+Algo@{des3\+Cipher\+Algo}}
\index{des3\+Cipher\+Algo@{des3\+Cipher\+Algo}!des3.\+h@{des3.\+h}}
\subsubsection{\texorpdfstring{des3\+Cipher\+Algo}{des3CipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} des3\+Cipher\+Algo}



Definition at line 48 of file des3.\+c.

