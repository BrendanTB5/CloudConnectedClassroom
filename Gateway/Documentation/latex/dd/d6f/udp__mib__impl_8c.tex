\hypertarget{udp__mib__impl_8c}{}\section{cyclone\+\_\+tcp/mibs/udp\+\_\+mib\+\_\+impl.c File Reference}
\label{udp__mib__impl_8c}\index{cyclone\+\_\+tcp/mibs/udp\+\_\+mib\+\_\+impl.\+c@{cyclone\+\_\+tcp/mibs/udp\+\_\+mib\+\_\+impl.\+c}}


U\+DP M\+IB module implementation.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/mib\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/udp\+\_\+mib\+\_\+module.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/udp\+\_\+mib\+\_\+impl.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{udp__mib__impl_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{udp__mib__impl_8c_afa021a2efa08689b243b0856d48edc79}{udp\+Mib\+Init} (void)
\begin{DoxyCompactList}\small\item\em U\+DP M\+IB module initialization. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{udp__mib__impl_8c_ad512f260a7feec968ef998f29febca40}{udp\+Mib\+Get\+Udp\+Endpoint\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value}, size\+\_\+t $\ast$value\+Len)
\begin{DoxyCompactList}\small\item\em Get udp\+Endpoint\+Entry object value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{udp__mib__impl_8c_a8e8fcb503885e1796de105748da3798f}{udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry} (const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$object, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$next\+Oid, size\+\_\+t $\ast$next\+Oid\+Len)
\begin{DoxyCompactList}\small\item\em Get next udp\+Endpoint\+Entry object. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
U\+DP M\+IB module implementation. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{udp__mib__impl_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{udp__mib__impl_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file udp\+\_\+mib\+\_\+impl.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{udp__mib__impl_8c_a8e8fcb503885e1796de105748da3798f}\label{udp__mib__impl_8c_a8e8fcb503885e1796de105748da3798f}} 
\index{udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}!udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry@{udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry}}
\index{udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry@{udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry}!udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry()}{udpMibGetNextUdpEndpointEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} udp\+Mib\+Get\+Next\+Udp\+Endpoint\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{next\+Oid,  }\item[{size\+\_\+t $\ast$}]{next\+Oid\+Len }\end{DoxyParamCaption})}



Get next udp\+Endpoint\+Entry object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em next\+Oid} & O\+ID of the next object in the M\+IB \\
\hline
\mbox{\tt out}  & {\em next\+Oid\+Len} & Length of the next object identifier, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 205 of file udp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
207 \{
208    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
209    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
210    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
211    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
212    \hyperlink{structIpAddr}{IpAddr} localIpAddr;
213    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} localPort;
214    \hyperlink{structIpAddr}{IpAddr} remoteIpAddr;
215    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} remotePort;
216    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} instance;
217 
218    \textcolor{comment}{//Initialize variables}
219    localIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
220    localPort = 0;
221    remoteIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
222    remotePort = 0;
223    instance = 1;
224 
225    \textcolor{comment}{//Make sure the buffer is large enough to hold the OID prefix}
226    \textcolor{keywordflow}{if}(*nextOidLen < object->oidLen)
227       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf3f6e48b0cfaea7cac34f4223cd8a57}{ERROR\_BUFFER\_OVERFLOW};
228 
229    \textcolor{comment}{//Copy OID prefix}
230    memcpy(nextOid, object->oid, object->oidLen);
231 
232    \textcolor{comment}{//Loop through socket descriptors}
233    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
234    \{
235       \textcolor{comment}{//Point to current socket}
236       \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket} = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
237 
238       \textcolor{comment}{//UDP socket?}
239       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a26963b01dac3a99a930779035d3796a7}{SOCKET\_TYPE\_DGRAM})
240       \{
241          \textcolor{comment}{//Append the instance identifier to the OID prefix}
242          n = \textcolor{keywordtype}{object}->oidLen;
243 
244          \textcolor{comment}{//udpEndpointLocalAddressType and udpEndpointLocalAddress are used}
245          \textcolor{comment}{//as 1st and 2nd instance identifiers}
246          error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &socket->localIpAddr);
247          \textcolor{comment}{//Any error to report?}
248          \textcolor{keywordflow}{if}(error)
249             \textcolor{keywordflow}{return} error;
250 
251          \textcolor{comment}{//udpEndpointLocalPort is used as 3rd instance identifier}
252          error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, socket->localPort);
253          \textcolor{comment}{//Any error to report?}
254          \textcolor{keywordflow}{if}(error)
255             \textcolor{keywordflow}{return} error;
256 
257          \textcolor{comment}{//udpEndpointRemoteAddressType and udpEndpointRemoteAddress are used}
258          \textcolor{comment}{//as 4th and 5th instance identifiers}
259          error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &socket->remoteIpAddr);
260          \textcolor{comment}{//Any error to report?}
261          \textcolor{keywordflow}{if}(error)
262             \textcolor{keywordflow}{return} error;
263 
264          \textcolor{comment}{//udpEndpointRemotePort is used as 6th instance identifier}
265          error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, socket->remotePort);
266          \textcolor{comment}{//Any error to report?}
267          \textcolor{keywordflow}{if}(error)
268             \textcolor{keywordflow}{return} error;
269 
270          \textcolor{comment}{//udpEndpointInstance is used as 7th instance identifier}
271          error = \hyperlink{mib__common_8c_ae2d800fa448d563aad087c18128c69b5}{mibEncodeUnsigned32}(nextOid, *nextOidLen, &n, instance);
272          \textcolor{comment}{//Any error to report?}
273          \textcolor{keywordflow}{if}(error)
274             \textcolor{keywordflow}{return} error;
275 
276          \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
277          \textcolor{comment}{//follows the specified OID}
278          \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
279          \{
280             \textcolor{comment}{//Perform lexicographic comparison}
281             \textcolor{keywordflow}{if}(localPort == 0 && remotePort == 0)
282                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
283             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->localIpAddr, &localIpAddr) < 0)
284                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
285             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->localIpAddr, &localIpAddr) > 0)
286                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
287             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->localPort < localPort)
288                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
289             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->localPort > localPort)
290                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
291             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->remoteIpAddr, &remoteIpAddr) < 0)
292                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
293             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&socket->remoteIpAddr, &remoteIpAddr) > 0)
294                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
295             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(socket->remotePort < remotePort)
296                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
297             \textcolor{keywordflow}{else}
298                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
299 
300             \textcolor{comment}{//Save the closest object identifier that follows the specified}
301             \textcolor{comment}{//OID in lexicographic order}
302             \textcolor{keywordflow}{if}(acceptable)
303             \{
304                localIpAddr = socket->localIpAddr;
305                localPort = socket->localPort;
306                remoteIpAddr = socket->remoteIpAddr;
307                remotePort = socket->remotePort;
308             \}
309          \}
310       \}
311    \}
312 
313    \textcolor{comment}{//Loop through the UDP callback table}
314    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{udp_8h_ac8ac25da0395f880ccb2af76bf8bf88e}{UDP\_CALLBACK\_TABLE\_SIZE}; i++)
315    \{
316       \textcolor{comment}{//Point to the current entry}
317       \hyperlink{structUdpRxCallbackDesc}{UdpRxCallbackDesc} *entry = &\hyperlink{udp_8c_abb1f00a80979f87b4f05fc69b3a439a8}{udpCallbackTable}[i];
318 
319       \textcolor{comment}{//Check whether the entry is currently in used}
320       \textcolor{keywordflow}{if}(entry->\hyperlink{structUdpRxCallbackDesc_ad50e5f2634cd97ee825310fa484ed345}{callback} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
321       \{
322          \textcolor{comment}{//Append the instance identifier to the OID prefix}
323          n = \textcolor{keywordtype}{object}->oidLen;
324 
325          \textcolor{comment}{//udpEndpointLocalAddressType and udpEndpointLocalAddress are used}
326          \textcolor{comment}{//as 1st and 2nd instance identifiers}
327          error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &
      \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY});
328          \textcolor{comment}{//Any error to report?}
329          \textcolor{keywordflow}{if}(error)
330             \textcolor{keywordflow}{return} error;
331 
332          \textcolor{comment}{//udpEndpointLocalPort is used as 3rd instance identifier}
333          error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, entry->
      \hyperlink{structUdpRxCallbackDesc_a4c9f42715adbf7832647d1950846e61d}{port});
334          \textcolor{comment}{//Any error to report?}
335          \textcolor{keywordflow}{if}(error)
336             \textcolor{keywordflow}{return} error;
337 
338          \textcolor{comment}{//udpEndpointRemoteAddressType and udpEndpointRemoteAddress are used}
339          \textcolor{comment}{//as 4th and 5th instance identifiers}
340          error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &
      \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY});
341          \textcolor{comment}{//Any error to report?}
342          \textcolor{keywordflow}{if}(error)
343             \textcolor{keywordflow}{return} error;
344 
345          \textcolor{comment}{//udpEndpointRemotePort is used as 6th instance identifier}
346          error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, 0);
347          \textcolor{comment}{//Any error to report?}
348          \textcolor{keywordflow}{if}(error)
349             \textcolor{keywordflow}{return} error;
350 
351          \textcolor{comment}{//udpEndpointInstance is used as 7th instance identifier}
352          error = \hyperlink{mib__common_8c_ae2d800fa448d563aad087c18128c69b5}{mibEncodeUnsigned32}(nextOid, *nextOidLen, &n, instance);
353          \textcolor{comment}{//Any error to report?}
354          \textcolor{keywordflow}{if}(error)
355             \textcolor{keywordflow}{return} error;
356 
357          \textcolor{comment}{//Check whether the resulting object identifier lexicographically}
358          \textcolor{comment}{//follows the specified OID}
359          \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nextOid, n, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen) > 0)
360          \{
361             \textcolor{comment}{//Perform lexicographic comparison}
362             \textcolor{keywordflow}{if}(localPort == 0 && remotePort == 0)
363                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
364             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&\hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY}, &localIpAddr) < 0)
365                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
366             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&\hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY}, &localIpAddr) > 0)
367                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
368             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structUdpRxCallbackDesc_a4c9f42715adbf7832647d1950846e61d}{port} < localPort)
369                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
370             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structUdpRxCallbackDesc_a4c9f42715adbf7832647d1950846e61d}{port} > localPort)
371                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
372             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&\hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY}, &remoteIpAddr) < 0)
373                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
374             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{mib__common_8c_a47d2cb950e34afd0f415ebc2e71eb3a5}{mibCompIpAddr}(&\hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY}, &remoteIpAddr) > 0)
375                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
376             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(0 < remotePort)
377                acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
378             \textcolor{keywordflow}{else}
379                acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
380 
381             \textcolor{comment}{//Save the closest object identifier that follows the specified}
382             \textcolor{comment}{//OID in lexicographic order}
383             \textcolor{keywordflow}{if}(acceptable)
384             \{
385                localIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
386                localPort = entry->\hyperlink{structUdpRxCallbackDesc_a4c9f42715adbf7832647d1950846e61d}{port};
387                remoteIpAddr = \hyperlink{ip_8c_a132481a9d89ddf554ea8bbbe342e5d5a}{IP\_ADDR\_ANY};
388                remotePort = 0;
389             \}
390          \}
391       \}
392    \}
393 
394    \textcolor{comment}{//The specified OID does not lexicographically precede the name}
395    \textcolor{comment}{//of some object?}
396    \textcolor{keywordflow}{if}(localPort == 0 && remotePort == 0)
397       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
398 
399    \textcolor{comment}{//Append the instance identifier to the OID prefix}
400    n = \textcolor{keywordtype}{object}->oidLen;
401 
402    \textcolor{comment}{//udpEndpointLocalAddressType and udpEndpointLocalAddress are used}
403    \textcolor{comment}{//as 1st and 2nd instance identifiers}
404    error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &localIpAddr);
405    \textcolor{comment}{//Any error to report?}
406    \textcolor{keywordflow}{if}(error)
407       \textcolor{keywordflow}{return} error;
408 
409    \textcolor{comment}{//udpEndpointLocalPort is used as 3rd instance identifier}
410    error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, localPort);
411    \textcolor{comment}{//Any error to report?}
412    \textcolor{keywordflow}{if}(error)
413       \textcolor{keywordflow}{return} error;
414 
415    \textcolor{comment}{//udpEndpointRemoteAddressType and udpEndpointRemoteAddress are used}
416    \textcolor{comment}{//as 4th and 5th instance identifiers}
417    error = \hyperlink{mib__common_8c_ace4c82102d73c1582f19e45d2fec9fa6}{mibEncodeIpAddr}(nextOid, *nextOidLen, &n, &remoteIpAddr);
418    \textcolor{comment}{//Any error to report?}
419    \textcolor{keywordflow}{if}(error)
420       \textcolor{keywordflow}{return} error;
421 
422    \textcolor{comment}{//udpEndpointRemotePort is used as 6th instance identifier}
423    error = \hyperlink{mib__common_8c_a2616aecf7cadea826dd261257332811c}{mibEncodePort}(nextOid, *nextOidLen, &n, remotePort);
424    \textcolor{comment}{//Any error to report?}
425    \textcolor{keywordflow}{if}(error)
426       \textcolor{keywordflow}{return} error;
427 
428    \textcolor{comment}{//udpEndpointInstance is used as 7th instance identifier}
429    error = \hyperlink{mib__common_8c_ae2d800fa448d563aad087c18128c69b5}{mibEncodeUnsigned32}(nextOid, *nextOidLen, &n, instance);
430    \textcolor{comment}{//Any error to report?}
431    \textcolor{keywordflow}{if}(error)
432       \textcolor{keywordflow}{return} error;
433 
434    \textcolor{comment}{//Save the length of the resulting object identifier}
435    *nextOidLen = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
436    \textcolor{comment}{//Next object found}
437    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
438 \}
\end{DoxyCode}
\mbox{\Hypertarget{udp__mib__impl_8c_ad512f260a7feec968ef998f29febca40}\label{udp__mib__impl_8c_ad512f260a7feec968ef998f29febca40}} 
\index{udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}!udp\+Mib\+Get\+Udp\+Endpoint\+Entry@{udp\+Mib\+Get\+Udp\+Endpoint\+Entry}}
\index{udp\+Mib\+Get\+Udp\+Endpoint\+Entry@{udp\+Mib\+Get\+Udp\+Endpoint\+Entry}!udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{udp\+Mib\+Get\+Udp\+Endpoint\+Entry()}{udpMibGetUdpEndpointEntry()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} udp\+Mib\+Get\+Udp\+Endpoint\+Entry (\begin{DoxyParamCaption}\item[{const \hyperlink{mib__common_8h_a2bc33cee6dd90a0ee8eeb92976a1c479}{Mib\+Object} $\ast$}]{object,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len,  }\item[{\hyperlink{mib__common_8h_a515b369f80863becb3a17870e6bb7a80}{Mib\+Variant} $\ast$}]{value,  }\item[{size\+\_\+t $\ast$}]{value\+Len }\end{DoxyParamCaption})}



Get udp\+Endpoint\+Entry object value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object} & Pointer to the M\+IB object descriptor \\
\hline
\mbox{\tt in}  & {\em oid} & Object identifier (object name and instance identifier) \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\mbox{\tt out}  & {\em value} & Object value \\
\hline
\mbox{\tt in,out}  & {\em value\+Len} & Length of the object value, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 76 of file udp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
78 \{
79    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
80    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
81    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
82    \hyperlink{structIpAddr}{IpAddr} localIpAddr;
83    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} localPort;
84    \hyperlink{structIpAddr}{IpAddr} remoteIpAddr;
85    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} remotePort;
86    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} instance;
87 
88    \textcolor{comment}{//Point to the instance identifier}
89    n = \textcolor{keywordtype}{object}->oidLen;
90 
91    \textcolor{comment}{//udpEndpointLocalAddressType and udpEndpointLocalAddress are used}
92    \textcolor{comment}{//as 1st and 2nd instance identifiers}
93    error = \hyperlink{mib__common_8c_a080b4155dd7c955d9b87aeb7869e45e3}{mibDecodeIpAddr}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &localIpAddr);
94    \textcolor{comment}{//Invalid instance identifier?}
95    \textcolor{keywordflow}{if}(error)
96       \textcolor{keywordflow}{return} error;
97 
98    \textcolor{comment}{//udpEndpointLocalPort is used as 3rd instance identifier}
99    error = \hyperlink{mib__common_8c_a9f6dc51e0c874e2395e852a4235a02a4}{mibDecodePort}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &localPort);
100    \textcolor{comment}{//Invalid instance identifier?}
101    \textcolor{keywordflow}{if}(error)
102       \textcolor{keywordflow}{return} error;
103 
104    \textcolor{comment}{//udpEndpointRemoteAddressType and udpEndpointRemoteAddress are used}
105    \textcolor{comment}{//as 4th and 5th instance identifiers}
106    error = \hyperlink{mib__common_8c_a080b4155dd7c955d9b87aeb7869e45e3}{mibDecodeIpAddr}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &remoteIpAddr);
107    \textcolor{comment}{//Invalid instance identifier?}
108    \textcolor{keywordflow}{if}(error)
109       \textcolor{keywordflow}{return} error;
110 
111    \textcolor{comment}{//udpEndpointRemotePort is used as 6th instance identifier}
112    error = \hyperlink{mib__common_8c_a9f6dc51e0c874e2395e852a4235a02a4}{mibDecodePort}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &remotePort);
113    \textcolor{comment}{//Invalid instance identifier?}
114    \textcolor{keywordflow}{if}(error)
115       \textcolor{keywordflow}{return} error;
116 
117    \textcolor{comment}{//udpEndpointInstance is used as 7th instance identifier}
118    error = \hyperlink{mib__common_8c_aa221a1888445b57838ff75e611638732}{mibDecodeUnsigned32}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, &n, &instance);
119    \textcolor{comment}{//Invalid instance identifier?}
120    \textcolor{keywordflow}{if}(error)
121       \textcolor{keywordflow}{return} error;
122 
123    \textcolor{comment}{//Sanity check}
124    \textcolor{keywordflow}{if}(n != oidLen)
125       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
126 
127    \textcolor{comment}{//Loop through socket descriptors}
128    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{socket_8h_ab793a8c76592a00fa3ea0510cd2ffe3a}{SOCKET\_MAX\_COUNT}; i++)
129    \{
130       \textcolor{comment}{//Point to current socket}
131       \hyperlink{socket_8h_aa85acfb0fa336ef495e6ba87fb88fc48}{Socket} *\hyperlink{bsd__socket_8c_a3f8f3a2707fbc87fc30aa70f31f53218}{socket} = &\hyperlink{socket_8c_acdd76d8e01b4715c774c404b10f958da}{socketTable}[i];
132 
133       \textcolor{comment}{//UDP socket?}
134       \textcolor{keywordflow}{if}(socket->type == \hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a26963b01dac3a99a930779035d3796a7}{SOCKET\_TYPE\_DGRAM})
135       \{
136          \textcolor{comment}{//Check local IP address}
137          \textcolor{keywordflow}{if}(!\hyperlink{ip_8c_ae42b27fb0c6c86b8e29c86f39f0aa449}{ipCompAddr}(&socket->localIpAddr, &localIpAddr))
138             \textcolor{keywordflow}{continue};
139          \textcolor{comment}{//Check local port number}
140          \textcolor{keywordflow}{if}(socket->localPort != localPort)
141             \textcolor{keywordflow}{continue};
142          \textcolor{comment}{//Check remote IP address}
143          \textcolor{keywordflow}{if}(!\hyperlink{ip_8c_ae42b27fb0c6c86b8e29c86f39f0aa449}{ipCompAddr}(&socket->remoteIpAddr, &remoteIpAddr))
144             \textcolor{keywordflow}{continue};
145          \textcolor{comment}{//Check local port number}
146          \textcolor{keywordflow}{if}(socket->remotePort != remotePort)
147             \textcolor{keywordflow}{continue};
148 
149          \textcolor{comment}{//A matching socket has been found}
150          \textcolor{keywordflow}{break};
151       \}
152    \}
153 
154    \textcolor{comment}{//No matching connection found in socket table?}
155    \textcolor{keywordflow}{if}(i >= SOCKET\_MAX\_COUNT)
156    \{
157       \textcolor{comment}{//Loop through the UDP callback table}
158       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{udp_8h_ac8ac25da0395f880ccb2af76bf8bf88e}{UDP\_CALLBACK\_TABLE\_SIZE}; i++)
159       \{
160          \textcolor{comment}{//Point to the current entry}
161          \hyperlink{structUdpRxCallbackDesc}{UdpRxCallbackDesc} *entry = &\hyperlink{udp_8c_abb1f00a80979f87b4f05fc69b3a439a8}{udpCallbackTable}[i];
162 
163          \textcolor{comment}{//Check whether the entry is currently in used}
164          \textcolor{keywordflow}{if}(entry->\hyperlink{structUdpRxCallbackDesc_ad50e5f2634cd97ee825310fa484ed345}{callback} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
165          \{
166             \textcolor{comment}{//Check local port number}
167             \textcolor{keywordflow}{if}(entry->\hyperlink{structUdpRxCallbackDesc_a4c9f42715adbf7832647d1950846e61d}{port} == localPort)
168                \textcolor{keywordflow}{break};
169          \}
170       \}
171 
172       \textcolor{comment}{//No matching connection found in UDP callback table?}
173       \textcolor{keywordflow}{if}(i >= UDP\_CALLBACK\_TABLE\_SIZE)
174          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca805a80fe68633921ca43149789f4c3eb}{ERROR\_INSTANCE\_NOT\_FOUND};
175    \}
176 
177    \textcolor{comment}{//udpEndpointProcess object?}
178    \textcolor{keywordflow}{if}(!strcmp(object->name, \textcolor{stringliteral}{"udpEndpointProcess"}))
179    \{
180       \textcolor{comment}{//ID of the process associated with this endpoint}
181       \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value}->unsigned32 = 0;
182    \}
183    \textcolor{comment}{//Unknown object?}
184    \textcolor{keywordflow}{else}
185    \{
186       \textcolor{comment}{//The specified object does not exist}
187       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca7c3779a9c0fe7d65f66367f176dee6d7}{ERROR\_OBJECT\_NOT\_FOUND};
188    \}
189 
190    \textcolor{comment}{//Return status code}
191    \textcolor{keywordflow}{return} error;
192 \}
\end{DoxyCode}
\mbox{\Hypertarget{udp__mib__impl_8c_afa021a2efa08689b243b0856d48edc79}\label{udp__mib__impl_8c_afa021a2efa08689b243b0856d48edc79}} 
\index{udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}!udp\+Mib\+Init@{udp\+Mib\+Init}}
\index{udp\+Mib\+Init@{udp\+Mib\+Init}!udp\+\_\+mib\+\_\+impl.\+c@{udp\+\_\+mib\+\_\+impl.\+c}}
\subsubsection{\texorpdfstring{udp\+Mib\+Init()}{udpMibInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} udp\+Mib\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



U\+DP M\+IB module initialization. 

\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 53 of file udp\+\_\+mib\+\_\+impl.\+c.


\begin{DoxyCode}
54 \{
55    \textcolor{comment}{//Debug message}
56    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Initializing UDP-MIB base...\(\backslash\)r\(\backslash\)n"});
57 
58    \textcolor{comment}{//Clear UDP MIB base}
59    memset(&\hyperlink{udp__mib__module_8c_aba0b930801a9e8f5c17e828de311cf54}{udpMibBase}, 0, \textcolor{keyword}{sizeof}(\hyperlink{udp__mib__module_8c_aba0b930801a9e8f5c17e828de311cf54}{udpMibBase}));
60 
61    \textcolor{comment}{//Successful processing}
62    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
63 \}
\end{DoxyCode}
