\hypertarget{tftp__client__misc_8h}{}\section{cyclone\+\_\+tcp/tftp/tftp\+\_\+client\+\_\+misc.h File Reference}
\label{tftp__client__misc_8h}\index{cyclone\+\_\+tcp/tftp/tftp\+\_\+client\+\_\+misc.\+h@{cyclone\+\_\+tcp/tftp/tftp\+\_\+client\+\_\+misc.\+h}}


Helper functions for T\+F\+TP client.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tftp/tftp\+\_\+client.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_a6fac7d316788383548c3235f970ad9a1}{tftp\+Client\+Open\+Connection} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Open connection with the T\+F\+TP server. \end{DoxyCompactList}\item 
void \hyperlink{tftp__client__misc_8h_a31ed2140dbd936f36d4299df5bb4e24e}{tftp\+Client\+Close\+Connection} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Close connection with the T\+F\+TP server. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_ac34a8f159fc0bd86e8a3b960dfdebe86}{tftp\+Client\+Process\+Events} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Process T\+F\+TP client events. \end{DoxyCompactList}\item 
void \hyperlink{tftp__client__misc_8h_a32c9188d859dcb5ff6f74bea658edc48}{tftp\+Client\+Process\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$\hyperlink{ipcp_8h_a8ddffb4d02fcd8ad856313d3e208c34f}{src\+Ip\+Addr}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{udp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{src\+Port})
\begin{DoxyCompactList}\small\item\em Process incoming packet. \end{DoxyCompactList}\item 
void \hyperlink{tftp__client__misc_8h_a53eff7eef863f8b1930db091105106e9}{tftp\+Client\+Process\+Data\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{udp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{src\+Port}, const \hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{Tftp\+Data\+Packet} $\ast$data\+Packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Process incoming D\+A\+TA packet. \end{DoxyCompactList}\item 
void \hyperlink{tftp__client__misc_8h_afcec1bf1256fca94146ef844f35babda}{tftp\+Client\+Process\+Ack\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{udp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{src\+Port}, const \hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{Tftp\+Ack\+Packet} $\ast$ack\+Packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Process incoming A\+CK packet. \end{DoxyCompactList}\item 
void \hyperlink{tftp__client__misc_8h_a1ac2b7ac466e6b40a9450dea33d3d5af}{tftp\+Client\+Process\+Error\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{udp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{src\+Port}, const \hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{Tftp\+Error\+Packet} $\ast$error\+Packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Process incoming E\+R\+R\+OR packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_adc5e022de95191ad8447a7643773fb8a}{tftp\+Client\+Send\+Rrq\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a054704ecfbf9f8eea80cd1d120b8cf62}{filename}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode})
\begin{DoxyCompactList}\small\item\em Send R\+RQ packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_a03b13f6c2498ea2c106ec5ec1ead798d}{tftp\+Client\+Send\+Wrq\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a054704ecfbf9f8eea80cd1d120b8cf62}{filename}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode})
\begin{DoxyCompactList}\small\item\em Send W\+RQ packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_a1cac81f6fea8ca4c996eea9b798ab906}{tftp\+Client\+Send\+Data\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Send D\+A\+TA packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_abf35e4f9e4eb845b30f43be092080ef3}{tftp\+Client\+Send\+Ack\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Send A\+CK packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_a23d974bfa4433c7ed71e872684b7ac5d}{tftp\+Client\+Send\+Error\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{tftp__common_8h_a78abca92c8fa2790c1d32470831537e8}{error\+Code}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a949a7e29724e2db6f2bd70df72c74960}{error\+Msg})
\begin{DoxyCompactList}\small\item\em Send E\+R\+R\+OR packet. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tftp__client__misc_8h_a088830a7dc32592e1859153487c50348}{tftp\+Client\+Retransmit\+Packet} (\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Retransmit the last packet. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Helper functions for T\+F\+TP client. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{tftp__client__misc_8h_a31ed2140dbd936f36d4299df5bb4e24e}\label{tftp__client__misc_8h_a31ed2140dbd936f36d4299df5bb4e24e}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Close\+Connection@{tftp\+Client\+Close\+Connection}}
\index{tftp\+Client\+Close\+Connection@{tftp\+Client\+Close\+Connection}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Close\+Connection()}{tftpClientCloseConnection()}}
{\footnotesize\ttfamily void tftp\+Client\+Close\+Connection (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Close connection with the T\+F\+TP server. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\end{DoxyParams}


Definition at line 95 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
96 \{
97    \textcolor{comment}{//Sanity check}
98    \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
99    \{
100       \textcolor{comment}{//Close UDP socket}
101       \hyperlink{socket_8c_ac5012e9f71c97e2ea0410f2c5baccb0e}{socketClose}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket});
102       context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
103    \}
104 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a6fac7d316788383548c3235f970ad9a1}\label{tftp__client__misc_8h_a6fac7d316788383548c3235f970ad9a1}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Open\+Connection@{tftp\+Client\+Open\+Connection}}
\index{tftp\+Client\+Open\+Connection@{tftp\+Client\+Open\+Connection}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Open\+Connection()}{tftpClientOpenConnection()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Open\+Connection (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Open connection with the T\+F\+TP server. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 49 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
50 \{
51    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
52 
53    \textcolor{comment}{//Properly close existing connection}
54    \hyperlink{tftp__client__misc_8c_a31ed2140dbd936f36d4299df5bb4e24e}{tftpClientCloseConnection}(context);
55 
56    \textcolor{comment}{//Open a UDP socket}
57    context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket} = \hyperlink{socket_8c_aa139bbf42b326b52eb08cf52771ac337}{socketOpen}(\hyperlink{socket_8h_aa78c7398fa81f7f62aa233159d4d8d97a26963b01dac3a99a930779035d3796a7}{SOCKET\_TYPE\_DGRAM}, 
      \hyperlink{socket_8h_a56eb0e60bda5d1d8a2e702228405d969a53c45ffdb9dee4a8f885b816386a99b8}{SOCKET\_IP\_PROTO\_UDP});
58 
59    \textcolor{comment}{//Valid socket?}
60    \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
61    \{
62       \textcolor{comment}{//Associate the socket with the relevant interface}
63       error = \hyperlink{net__legacy_8h_a80bc49fa99e5654d8c345cd5c70d36d3}{socketBindToInterface}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, context->
      \hyperlink{structTftpClientContext_ad17a07e8c1bfd4a9abaf2dbc46c3049a}{interface});
64 
65       \textcolor{comment}{//Check status code}
66       \textcolor{keywordflow}{if}(!error)
67       \{
68          \textcolor{comment}{//Set timeout}
69          error = \hyperlink{socket_8c_abdd29ac0ba4a644c726f5b1280680099}{socketSetTimeout}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, 
      \hyperlink{tftp__client_8h_a6b08edd45b311819a474c23f16a6d770}{TFTP\_CLIENT\_TICK\_INTERVAL});
70       \}
71 
72       \textcolor{comment}{//Any error to report?}
73       \textcolor{keywordflow}{if}(error)
74       \{
75          \textcolor{comment}{//Clean up side effects}
76          \hyperlink{tftp__client__misc_8c_a31ed2140dbd936f36d4299df5bb4e24e}{tftpClientCloseConnection}(context);
77       \}
78    \}
79    \textcolor{keywordflow}{else}
80    \{
81       \textcolor{comment}{//Report an error}
82       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab721230e985e398cc0977dd729a12c61}{ERROR\_OPEN\_FAILED};
83    \}
84 
85    \textcolor{comment}{//Return status code}
86    \textcolor{keywordflow}{return} error;
87 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_afcec1bf1256fca94146ef844f35babda}\label{tftp__client__misc_8h_afcec1bf1256fca94146ef844f35babda}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Process\+Ack\+Packet@{tftp\+Client\+Process\+Ack\+Packet}}
\index{tftp\+Client\+Process\+Ack\+Packet@{tftp\+Client\+Process\+Ack\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Process\+Ack\+Packet()}{tftpClientProcessAckPacket()}}
{\footnotesize\ttfamily void tftp\+Client\+Process\+Ack\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{src\+Port,  }\item[{const \hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{Tftp\+Ack\+Packet} $\ast$}]{ack\+Packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Process incoming A\+CK packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em src\+Port} & Source port number \\
\hline
\mbox{\tt in}  & {\em ack\+Packet} & Pointer to the A\+CK packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}


Definition at line 309 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
311 \{
312    \textcolor{comment}{//Debug message}
313    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: ACK packet received (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"},
314       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
315 
316    \textcolor{comment}{//Make sure the length of the ACK packet is acceptable}
317    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{TftpAckPacket}))
318       \textcolor{keywordflow}{return};
319 
320    \textcolor{comment}{//Debug message}
321    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->opcode));
322    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Block = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->block));
323 
324    \textcolor{comment}{//Check current state}
325    \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174ac43016381082a997b4ebd34b0813372f}{TFTP\_CLIENT\_STATE\_WRQ})
326    \{
327       \textcolor{comment}{//Check block number}
328       \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->block) == context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block})
329       \{
330          \textcolor{comment}{//Save the TID chosen by the server}
331          context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid} = \hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort};
332 
333          \textcolor{comment}{//A valid ACK packet has been received}
334          context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} = \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a97a847cea55dd8d3fab8a04739c1a433}{TFTP\_CLIENT\_STATE\_ACK};
335 
336          \textcolor{comment}{//Flush the output data buffer}
337          context->\hyperlink{structTftpClientContext_a60ec196ee362181351a438d39116b572}{outDataLen} = 0;
338       \}
339    \}
340    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a23af61a007f039e6f75290017d202432}{TFTP\_CLIENT\_STATE\_DATA})
341    \{
342       \textcolor{comment}{//The host should make sure that the source TID matches the value}
343       \textcolor{comment}{//that was agreed}
344       \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort} == context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid})
345       \{
346          \textcolor{comment}{//Make sure the ACK is not a duplicate}
347          \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->block) == context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block})
348          \{
349             \textcolor{comment}{//A valid ACK packet has been received}
350             context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} = \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a97a847cea55dd8d3fab8a04739c1a433}{TFTP\_CLIENT\_STATE\_ACK};
351 
352             \textcolor{comment}{//Flush the output data buffer}
353             context->\hyperlink{structTftpClientContext_a60ec196ee362181351a438d39116b572}{outDataLen} = 0;
354          \}
355          \textcolor{keywordflow}{else}
356          \{
357             \textcolor{comment}{//Implementations must never resend the current DATA packet on}
358             \textcolor{comment}{//receipt of a duplicate ACK (refer to RFC 1123, section 4.2.3.1)}
359          \}
360       \}
361    \}
362    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a8effc0277fd10027ca691919b5fbfae5}{TFTP\_CLIENT\_STATE\_LAST\_DATA})
363    \{
364       \textcolor{comment}{//The host should make sure that the source TID matches the value}
365       \textcolor{comment}{//that was agreed}
366       \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort} == context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid})
367       \{
368          \textcolor{comment}{//Make sure the ACK is not a duplicate}
369          \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->block) == context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block})
370          \{
371             \textcolor{comment}{//Normal termination of the transfer}
372             context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} = \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a0a3c7ba0d3e19e5bca9c208ed282c88c}{TFTP\_CLIENT\_STATE\_COMPLETE};
373 
374             \textcolor{comment}{//Flush the output data buffer}
375             context->\hyperlink{structTftpClientContext_a60ec196ee362181351a438d39116b572}{outDataLen} = 0;
376          \}
377          \textcolor{keywordflow}{else}
378          \{
379             \textcolor{comment}{//Implementations must never resend the current DATA packet on}
380             \textcolor{comment}{//receipt of a duplicate ACK (refer to RFC 1123, section 4.2.3.1)}
381          \}
382       \}
383    \}
384 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a53eff7eef863f8b1930db091105106e9}\label{tftp__client__misc_8h_a53eff7eef863f8b1930db091105106e9}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Process\+Data\+Packet@{tftp\+Client\+Process\+Data\+Packet}}
\index{tftp\+Client\+Process\+Data\+Packet@{tftp\+Client\+Process\+Data\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Process\+Data\+Packet()}{tftpClientProcessDataPacket()}}
{\footnotesize\ttfamily void tftp\+Client\+Process\+Data\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{src\+Port,  }\item[{const \hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{Tftp\+Data\+Packet} $\ast$}]{data\+Packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Process incoming D\+A\+TA packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em src\+Port} & Source port number \\
\hline
\mbox{\tt in}  & {\em data\+Packet} & Pointer to the D\+A\+TA packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}


Definition at line 240 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
242 \{
243    \textcolor{comment}{//Debug message}
244    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: DATA packet received (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"},
245       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
246 
247    \textcolor{comment}{//Make sure the length of the DATA packet is acceptable}
248    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{TftpDataPacket}))
249       \textcolor{keywordflow}{return};
250 
251    \textcolor{comment}{//Calculate the length of the data}
252    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{TftpDataPacket});
253 
254    \textcolor{comment}{//Debug message}
255    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(dataPacket->opcode));
256    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Block = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(dataPacket->block));
257 
258    \textcolor{comment}{//Check current state}
259    \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a820100425cc81308389844e42a6634d4}{TFTP\_CLIENT\_STATE\_RRQ})
260    \{
261       \textcolor{comment}{//Check block number}
262       \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(dataPacket->block) == context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block})
263       \{
264          \textcolor{comment}{//Save the TID chosen by the server}
265          context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid} = \hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort};
266 
267          \textcolor{comment}{//A valid DATA packet has been received}
268          context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} = \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a23af61a007f039e6f75290017d202432}{TFTP\_CLIENT\_STATE\_DATA};
269 
270          \textcolor{comment}{//Save the length of the DATA packet}
271          context->\hyperlink{structTftpClientContext_a8d192f64cb73d6fa578e23c8171fee91}{inDataLen} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
272          context->\hyperlink{structTftpClientContext_aad31a283211290004f2c304b4e33814c}{inDataPos} = 0;
273       \}
274    \}
275    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a97a847cea55dd8d3fab8a04739c1a433}{TFTP\_CLIENT\_STATE\_ACK})
276    \{
277       \textcolor{comment}{//The host should make sure that the source TID matches the value}
278       \textcolor{comment}{//that was agreed}
279       \textcolor{keywordflow}{if}(\hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort} == context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid})
280       \{
281          \textcolor{comment}{//Check block number}
282          \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(dataPacket->block) == context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block})
283          \{
284             \textcolor{comment}{//A valid DATA packet has been received}
285             context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} = \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a23af61a007f039e6f75290017d202432}{TFTP\_CLIENT\_STATE\_DATA};
286 
287             \textcolor{comment}{//Save the length of the DATA packet}
288             context->\hyperlink{structTftpClientContext_a8d192f64cb73d6fa578e23c8171fee91}{inDataLen} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
289             context->\hyperlink{structTftpClientContext_aad31a283211290004f2c304b4e33814c}{inDataPos} = 0;
290          \}
291          \textcolor{keywordflow}{else}
292          \{
293             \textcolor{comment}{//Retransmit ACK packet}
294             \hyperlink{tftp__client__misc_8c_a088830a7dc32592e1859153487c50348}{tftpClientRetransmitPacket}(context);
295          \}
296       \}
297    \}
298 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a1ac2b7ac466e6b40a9450dea33d3d5af}\label{tftp__client__misc_8h_a1ac2b7ac466e6b40a9450dea33d3d5af}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Process\+Error\+Packet@{tftp\+Client\+Process\+Error\+Packet}}
\index{tftp\+Client\+Process\+Error\+Packet@{tftp\+Client\+Process\+Error\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Process\+Error\+Packet()}{tftpClientProcessErrorPacket()}}
{\footnotesize\ttfamily void tftp\+Client\+Process\+Error\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{src\+Port,  }\item[{const \hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{Tftp\+Error\+Packet} $\ast$}]{error\+Packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Process incoming E\+R\+R\+OR packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em src\+Port} & Source port number \\
\hline
\mbox{\tt in}  & {\em error\+Packet} & Pointer to the E\+R\+R\+OR packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}


Definition at line 395 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
397 \{
398    \textcolor{comment}{//Debug message}
399    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: ERROR packet received (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"},
400       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
401 
402    \textcolor{comment}{//Make sure the length of the ERROR packet is acceptable}
403    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{TftpErrorPacket}))
404       \textcolor{keywordflow}{return};
405 
406    \textcolor{comment}{//Debug message}
407    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(errorPacket->opcode));
408    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Error Code = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(errorPacket->errorCode));
409 
410    \textcolor{comment}{//Compute the length of the error message}
411    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{TftpErrorPacket});
412 
413    \textcolor{comment}{//Make sure the error message is terminated with a zero byte}
414    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 1 && errorPacket->errorMsg[\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} - 1] == \textcolor{charliteral}{'\(\backslash\)0'})
415    \{
416       \textcolor{comment}{//Debug message}
417       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Error Msg = %s\(\backslash\)r\(\backslash\)n"}, errorPacket->errorMsg);
418    \}
419 
420    \textcolor{comment}{//Report an error}
421    context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} = \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a0334d37aa372fabe6d7d627c9b791369}{TFTP\_CLIENT\_STATE\_ERROR};
422 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_ac34a8f159fc0bd86e8a3b960dfdebe86}\label{tftp__client__misc_8h_ac34a8f159fc0bd86e8a3b960dfdebe86}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Process\+Events@{tftp\+Client\+Process\+Events}}
\index{tftp\+Client\+Process\+Events@{tftp\+Client\+Process\+Events}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Process\+Events()}{tftpClientProcessEvents()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Process\+Events (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Process T\+F\+TP client events. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 113 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
114 \{
115    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
116    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
117    \hyperlink{structIpAddr}{IpAddr} \hyperlink{ipcp_8h_a8ddffb4d02fcd8ad856313d3e208c34f}{srcIpAddr};
118    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort};
119 
120    \textcolor{comment}{//Wait for an incoming packet}
121    error = \hyperlink{socket_8c_a26af4b642b71708e1408fc94483f90bb}{socketReceiveFrom}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &srcIpAddr, &srcPort,
122       context->\hyperlink{structTftpClientContext_a0eaff236dc4e0bd3455850e76f39a05d}{inPacket}, \hyperlink{tftp__client_8h_a2afd441851cee2c32c2a02ea2e24c9e0}{TFTP\_CLIENT\_MAX\_PACKET\_SIZE}, &context->
      \hyperlink{structTftpClientContext_aa62bd41626a19d4eaea1fb61be425304}{inPacketLen}, 0);
123 
124    \textcolor{comment}{//Check status code}
125    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
126    \{
127       \textcolor{comment}{//Process incoming packet}
128       \hyperlink{tftp__client__misc_8c_a32c9188d859dcb5ff6f74bea658edc48}{tftpClientProcessPacket}(context, &srcIpAddr, srcPort);
129    \}
130    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
131    \{
132 \textcolor{preprocessor}{#if (NET\_RTOS\_SUPPORT == ENABLED)}
133       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
134 \textcolor{preprocessor}{#else}
135       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK};
136 \textcolor{preprocessor}{#endif}
137    \}
138 
139    \textcolor{comment}{//Check status code}
140    \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} || error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK})
141    \{
142       \textcolor{comment}{//Check current state}
143       \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a820100425cc81308389844e42a6634d4}{TFTP\_CLIENT\_STATE\_RRQ} ||
144          context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174ac43016381082a997b4ebd34b0813372f}{TFTP\_CLIENT\_STATE\_WRQ} ||
145          context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a23af61a007f039e6f75290017d202432}{TFTP\_CLIENT\_STATE\_DATA} ||
146          context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a97a847cea55dd8d3fab8a04739c1a433}{TFTP\_CLIENT\_STATE\_ACK} ||
147          context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a8effc0277fd10027ca691919b5fbfae5}{TFTP\_CLIENT\_STATE\_LAST\_DATA})
148       \{
149          \textcolor{comment}{//Get current time}
150          time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
151 
152          \textcolor{comment}{//Check current time}
153          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} + 
      \hyperlink{tftp__client_8h_ae047941cddd12ec4b459ad8b0fe4b75c}{TFTP\_CLIENT\_TIMEOUT}) >= 0)
154          \{
155             \textcolor{comment}{//Handle retransmissions}
156             \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount} < \hyperlink{tftp__client_8h_a595a3c7f086fbd5cbd57c8d2b9a8ae6b}{TFTP\_CLIENT\_MAX\_RETRIES})
157             \{
158                \textcolor{comment}{//Retransmit last packet}
159                \hyperlink{tftp__client__misc_8c_a088830a7dc32592e1859153487c50348}{tftpClientRetransmitPacket}(context);
160 
161                \textcolor{comment}{//Save the time at which the packet was sent}
162                context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
163                \textcolor{comment}{//Increment retransmission counter}
164                context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount}++;
165             \}
166             \textcolor{keywordflow}{else}
167             \{
168                \textcolor{comment}{//Report a timeout error}
169                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
170             \}
171          \}
172       \}
173    \}
174 
175    \textcolor{comment}{//Return status code}
176    \textcolor{keywordflow}{return} error;
177 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a32c9188d859dcb5ff6f74bea658edc48}\label{tftp__client__misc_8h_a32c9188d859dcb5ff6f74bea658edc48}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Process\+Packet@{tftp\+Client\+Process\+Packet}}
\index{tftp\+Client\+Process\+Packet@{tftp\+Client\+Process\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Process\+Packet()}{tftpClientProcessPacket()}}
{\footnotesize\ttfamily void tftp\+Client\+Process\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$}]{src\+Ip\+Addr,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{src\+Port }\end{DoxyParamCaption})}



Process incoming packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em src\+Ip\+Addr} & Source IP address \\
\hline
\mbox{\tt in}  & {\em src\+Port} & Source port number \\
\hline
\end{DoxyParams}


Definition at line 187 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
189 \{
190    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{dns__common_8h_a5c1b56e6bccc2a95dbddf1a08e56e87d}{opcode};
191 
192    \textcolor{comment}{//Check the source IP address of the incoming packet}
193    \textcolor{keywordflow}{if}(!\hyperlink{ip_8c_ae42b27fb0c6c86b8e29c86f39f0aa449}{ipCompAddr}(srcIpAddr, &context->\hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr}))
194       \textcolor{keywordflow}{return};
195 
196    \textcolor{comment}{//Malformed packet?}
197    \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_aa62bd41626a19d4eaea1fb61be425304}{inPacketLen} < \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t}))
198       \textcolor{keywordflow}{return};
199 
200    \textcolor{comment}{//Retrieve TFTP packet type}
201    opcode = \hyperlink{cpu__endian_8h_ae21854587c05993c850b537156470088}{LOAD16BE}(context->\hyperlink{structTftpClientContext_a0eaff236dc4e0bd3455850e76f39a05d}{inPacket});
202 
203    \textcolor{comment}{//Data packet received?}
204    \textcolor{keywordflow}{if}(opcode == \hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92eacc8676e38f10ee4663ec5068328784c1}{TFTP\_OPCODE\_DATA})
205    \{
206       \textcolor{comment}{//Process DATA packet}
207       \hyperlink{tftp__client__misc_8c_a53eff7eef863f8b1930db091105106e9}{tftpClientProcessDataPacket}(context, \hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort},
208          (\hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{TftpDataPacket} *) context->\hyperlink{structTftpClientContext_a0eaff236dc4e0bd3455850e76f39a05d}{inPacket}, context->
      \hyperlink{structTftpClientContext_aa62bd41626a19d4eaea1fb61be425304}{inPacketLen});
209    \}
210    \textcolor{comment}{//Acknowledgment packet received?}
211    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(opcode == \hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92eaa0ce42ae7c3db3296276f484a9ea084a}{TFTP\_OPCODE\_ACK})
212    \{
213       \textcolor{comment}{//Process ACK packet}
214       \hyperlink{tftp__client__misc_8c_afcec1bf1256fca94146ef844f35babda}{tftpClientProcessAckPacket}(context, \hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort},
215          (\hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{TftpAckPacket} *) context->\hyperlink{structTftpClientContext_a0eaff236dc4e0bd3455850e76f39a05d}{inPacket}, context->
      \hyperlink{structTftpClientContext_aa62bd41626a19d4eaea1fb61be425304}{inPacketLen});
216    \}
217    \textcolor{comment}{//Error packet received?}
218    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(opcode == \hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92ead285a1bbae4f74fafc9e2595dc291d45}{TFTP\_OPCODE\_ERROR})
219    \{
220       \textcolor{comment}{//Process ERROR packet}
221       \hyperlink{tftp__client__misc_8c_a1ac2b7ac466e6b40a9450dea33d3d5af}{tftpClientProcessErrorPacket}(context, \hyperlink{tcp_8h_a26ebbf4f65c3f6fd9959d9cecef5c9d8}{srcPort},
222          (\hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{TftpErrorPacket} *) context->\hyperlink{structTftpClientContext_a0eaff236dc4e0bd3455850e76f39a05d}{inPacket}, context->
      \hyperlink{structTftpClientContext_aa62bd41626a19d4eaea1fb61be425304}{inPacketLen});
223    \}
224    \textcolor{comment}{//Invalid packet received?}
225    \textcolor{keywordflow}{else}
226    \{
227       \textcolor{comment}{//Discard incoming packet}
228    \}
229 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a088830a7dc32592e1859153487c50348}\label{tftp__client__misc_8h_a088830a7dc32592e1859153487c50348}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Retransmit\+Packet@{tftp\+Client\+Retransmit\+Packet}}
\index{tftp\+Client\+Retransmit\+Packet@{tftp\+Client\+Retransmit\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Retransmit\+Packet()}{tftpClientRetransmitPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Retransmit\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Retransmit the last packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 674 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
675 \{
676    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
677    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} \hyperlink{tcp_8h_af15d713ad2bc92686abfa6ab012b5039}{destPort};
678 
679    \textcolor{comment}{//Select the relevant destination port}
680    \textcolor{keywordflow}{if}(context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174a820100425cc81308389844e42a6634d4}{TFTP\_CLIENT\_STATE\_RRQ} ||
681       context->\hyperlink{structTftpClientContext_a5458f1f0af1bf1962312b07d364c9d09}{state} == \hyperlink{tftp__client_8h_a309912fa47abe84e19aafb1f1a9e8174ac43016381082a997b4ebd34b0813372f}{TFTP\_CLIENT\_STATE\_WRQ})
682    \{
683       \textcolor{comment}{//The client sends its initial request to the known TID 69}
684       destPort = context->\hyperlink{structTftpClientContext_a4fbd05c69003e22ea5703eabd89ab1c8}{serverPort};
685    \}
686    \textcolor{keywordflow}{else}
687    \{
688       \textcolor{comment}{//Under normal operation, the client uses the TID chosen by the server}
689       destPort = context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid};
690    \}
691 
692    \textcolor{comment}{//Debug message}
693    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: Retransmitting packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"},
694       context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen});
695 
696    \textcolor{comment}{//Retransmit the last packet}
697    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &context->
      \hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr},
698       destPort, context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket}, context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen}, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
699 
700    \textcolor{comment}{//Return status code}
701    \textcolor{keywordflow}{return} error;
702 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_abf35e4f9e4eb845b30f43be092080ef3}\label{tftp__client__misc_8h_abf35e4f9e4eb845b30f43be092080ef3}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Send\+Ack\+Packet@{tftp\+Client\+Send\+Ack\+Packet}}
\index{tftp\+Client\+Send\+Ack\+Packet@{tftp\+Client\+Send\+Ack\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Send\+Ack\+Packet()}{tftpClientSendAckPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Send\+Ack\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Send A\+CK packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 583 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
584 \{
585    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
586    \hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{TftpAckPacket} *ackPacket;
587 
588    \textcolor{comment}{//Point to the buffer where to format the packet}
589    ackPacket = (\hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{TftpAckPacket} *) context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket};
590 
591    \textcolor{comment}{//Format ACK packet}
592    ackPacket->opcode = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92eaa0ce42ae7c3db3296276f484a9ea084a}{TFTP\_OPCODE\_ACK});
593    ackPacket->block = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block});
594 
595    \textcolor{comment}{//Length of the ACK packet}
596    context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen} = \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a8b1a2e8ac454913655b3c5dc0bf08c56}{TftpAckPacket});
597 
598    \textcolor{comment}{//Debug message}
599    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: Sending ACK packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen});
600    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->opcode));
601    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Block = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(ackPacket->block));
602 
603    \textcolor{comment}{//Send ACK packet}
604    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &context->
      \hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr},
605       context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid}, context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen}, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
606 
607    \textcolor{comment}{//Save the time at which the packet was sent}
608    context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
609    \textcolor{comment}{//Reset retransmission counter}
610    context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount} = 0;
611 
612    \textcolor{comment}{//Return status code}
613    \textcolor{keywordflow}{return} error;
614 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a1cac81f6fea8ca4c996eea9b798ab906}\label{tftp__client__misc_8h_a1cac81f6fea8ca4c996eea9b798ab906}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Send\+Data\+Packet@{tftp\+Client\+Send\+Data\+Packet}}
\index{tftp\+Client\+Send\+Data\+Packet@{tftp\+Client\+Send\+Data\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Send\+Data\+Packet()}{tftpClientSendDataPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Send\+Data\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Send D\+A\+TA packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 543 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
544 \{
545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
546    \hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{TftpDataPacket} *dataPacket;
547 
548    \textcolor{comment}{//Point to the buffer where to format the packet}
549    dataPacket = (\hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{TftpDataPacket} *) context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket};
550 
551    \textcolor{comment}{//Format DATA packet}
552    dataPacket->opcode = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92eacc8676e38f10ee4663ec5068328784c1}{TFTP\_OPCODE\_DATA});
553    dataPacket->block = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(context->\hyperlink{structTftpClientContext_aa037821215c331f9c226c9c076951d3a}{block});
554 
555    \textcolor{comment}{//Compute the length of the DATA packet}
556    context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen} = \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a72db11cb5bc2afb6305fb3cb0f409eb5}{TftpDataPacket}) + context->
      \hyperlink{structTftpClientContext_a60ec196ee362181351a438d39116b572}{outDataLen};
557 
558    \textcolor{comment}{//Debug message}
559    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: Sending DATA packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, context
      ->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen});
560    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(dataPacket->opcode));
561    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Block = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(dataPacket->block));
562 
563    \textcolor{comment}{//Send DATA packet}
564    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &context->
      \hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr},
565       context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid}, context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen}, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
566 
567    \textcolor{comment}{//Save the time at which the packet was sent}
568    context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
569    \textcolor{comment}{//Reset retransmission counter}
570    context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount} = 0;
571 
572    \textcolor{comment}{//Return status code}
573    \textcolor{keywordflow}{return} error;
574 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a23d974bfa4433c7ed71e872684b7ac5d}\label{tftp__client__misc_8h_a23d974bfa4433c7ed71e872684b7ac5d}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Send\+Error\+Packet@{tftp\+Client\+Send\+Error\+Packet}}
\index{tftp\+Client\+Send\+Error\+Packet@{tftp\+Client\+Send\+Error\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Send\+Error\+Packet()}{tftpClientSendErrorPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Send\+Error\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{error\+Code,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{error\+Msg }\end{DoxyParamCaption})}



Send E\+R\+R\+OR packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em error\+Code} & Integer indicating the nature of the error \\
\hline
\mbox{\tt in}  & {\em error\+Msg} & Error message intended for human consumption \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 625 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
627 \{
628    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
629    \hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{TftpErrorPacket} *errorPacket;
630 
631    \textcolor{comment}{//Check the length of the error message}
632    \textcolor{keywordflow}{if}(strlen(\hyperlink{tftp__common_8h_a949a7e29724e2db6f2bd70df72c74960}{errorMsg}) >= \hyperlink{tftp__client_8h_afee8b7e4ec17ab2b7db46911b721f700}{TFTP\_CLIENT\_BLOCK\_SIZE})
633       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
634 
635    \textcolor{comment}{//Point to the buffer where to format the packet}
636    errorPacket = (\hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{TftpErrorPacket} *) context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket};
637 
638    \textcolor{comment}{//Format ERROR packet}
639    errorPacket->opcode = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92ead285a1bbae4f74fafc9e2595dc291d45}{TFTP\_OPCODE\_ERROR});
640    errorPacket->errorCode = \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(\hyperlink{tftp__common_8h_a78abca92c8fa2790c1d32470831537e8}{errorCode});
641 
642    \textcolor{comment}{//Copy error message}
643    strcpy(errorPacket->errorMsg, \hyperlink{tftp__common_8h_a949a7e29724e2db6f2bd70df72c74960}{errorMsg});
644 
645    \textcolor{comment}{//Compute the length of the ERROR packet}
646    context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen} = \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a8e737a9f3fbc1bf6983de7c443de0d83}{TftpErrorPacket}) + strlen(
      \hyperlink{tftp__common_8h_a949a7e29724e2db6f2bd70df72c74960}{errorMsg}) + 1;
647 
648    \textcolor{comment}{//Debug message}
649    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: Sending ERROR packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, context
      ->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen});
650    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(errorPacket->opcode));
651    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Error Code = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(errorPacket->errorCode));
652    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Error Msg = %s\(\backslash\)r\(\backslash\)n"}, errorPacket->errorMsg);
653 
654    \textcolor{comment}{//Send ERROR packet}
655    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &context->
      \hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr},
656       context->\hyperlink{structTftpClientContext_afe82816195c30970687a1b3816e8543d}{serverTid}, context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen}, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
657 
658    \textcolor{comment}{//Save the time at which the packet was sent}
659    context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
660    \textcolor{comment}{//Reset retransmission counter}
661    context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount} = 0;
662 
663    \textcolor{comment}{//Return status code}
664    \textcolor{keywordflow}{return} error;
665 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_adc5e022de95191ad8447a7643773fb8a}\label{tftp__client__misc_8h_adc5e022de95191ad8447a7643773fb8a}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Send\+Rrq\+Packet@{tftp\+Client\+Send\+Rrq\+Packet}}
\index{tftp\+Client\+Send\+Rrq\+Packet@{tftp\+Client\+Send\+Rrq\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Send\+Rrq\+Packet()}{tftpClientSendRrqPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Send\+Rrq\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{filename,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{mode }\end{DoxyParamCaption})}



Send R\+RQ packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em filename} & N\+U\+L\+L-\/terminated string specifying the filename \\
\hline
\mbox{\tt in}  & {\em mode} & N\+U\+L\+L-\/terminated string specifying the transfer mode \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 433 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
435 \{
436    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
437    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
438    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
439    \hyperlink{tftp__common_8h_a4b1e4ca412d8e3cd22c695e2d201a69a}{TftpRrqPacket} *rrqPacket;
440 
441    \textcolor{comment}{//Retrieve the length of the filename}
442    m = strlen(\hyperlink{tftp__common_8h_a054704ecfbf9f8eea80cd1d120b8cf62}{filename});
443    \textcolor{comment}{//Retrieve the length of the transfer mode}
444    n = strlen(\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode});
445 
446    \textcolor{comment}{//Check the length of the filename}
447    \textcolor{keywordflow}{if}((m + n) > \hyperlink{tftp__client_8h_afee8b7e4ec17ab2b7db46911b721f700}{TFTP\_CLIENT\_BLOCK\_SIZE})
448       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
449 
450    \textcolor{comment}{//Point to the buffer where to format the packet}
451    rrqPacket = (\hyperlink{tftp__common_8h_a4b1e4ca412d8e3cd22c695e2d201a69a}{TftpRrqPacket} *) context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket};
452 
453    \textcolor{comment}{//Format RRQ packet}
454    rrqPacket->opcode = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92ea384b091233466a21aed4b36a93bf1d50}{TFTP\_OPCODE\_RRQ});
455    strcpy(rrqPacket->filename, \hyperlink{tftp__common_8h_a054704ecfbf9f8eea80cd1d120b8cf62}{filename});
456    strcpy(rrqPacket->filename + m + 1, \hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode});
457 
458    \textcolor{comment}{//Compute the length of the RRQ packet}
459    context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen} = \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a4b1e4ca412d8e3cd22c695e2d201a69a}{TftpRrqPacket}) + n + m + 2;
460 
461    \textcolor{comment}{//Debug message}
462    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: Sending RRQ packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen});
463    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %u\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(rrqPacket->opcode));
464    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Filename = %s\(\backslash\)r\(\backslash\)n"}, rrqPacket->filename);
465    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Mode = %s\(\backslash\)r\(\backslash\)n"}, \hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode});
466 
467    \textcolor{comment}{//Send RRQ packet}
468    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &context->
      \hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr},
469       context->\hyperlink{structTftpClientContext_a4fbd05c69003e22ea5703eabd89ab1c8}{serverPort}, context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen}, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
470 
471    \textcolor{comment}{//Save the time at which the packet was sent}
472    context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
473    \textcolor{comment}{//Reset retransmission counter}
474    context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount} = 0;
475 
476    \textcolor{comment}{//Return status code}
477    \textcolor{keywordflow}{return} error;
478 \}
\end{DoxyCode}
\mbox{\Hypertarget{tftp__client__misc_8h_a03b13f6c2498ea2c106ec5ec1ead798d}\label{tftp__client__misc_8h_a03b13f6c2498ea2c106ec5ec1ead798d}} 
\index{tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}!tftp\+Client\+Send\+Wrq\+Packet@{tftp\+Client\+Send\+Wrq\+Packet}}
\index{tftp\+Client\+Send\+Wrq\+Packet@{tftp\+Client\+Send\+Wrq\+Packet}!tftp\+\_\+client\+\_\+misc.\+h@{tftp\+\_\+client\+\_\+misc.\+h}}
\subsubsection{\texorpdfstring{tftp\+Client\+Send\+Wrq\+Packet()}{tftpClientSendWrqPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tftp\+Client\+Send\+Wrq\+Packet (\begin{DoxyParamCaption}\item[{\hyperlink{structTftpClientContext}{Tftp\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{filename,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{mode }\end{DoxyParamCaption})}



Send W\+RQ packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+F\+TP client context \\
\hline
\mbox{\tt in}  & {\em filename} & N\+U\+L\+L-\/terminated string specifying the filename \\
\hline
\mbox{\tt in}  & {\em mode} & N\+U\+L\+L-\/terminated string specifying the transfer mode \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 489 of file tftp\+\_\+client\+\_\+misc.\+c.


\begin{DoxyCode}
491 \{
492    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
493    \textcolor{keywordtype}{size\_t} \hyperlink{ndp_8h_a6b3284d8492267a77ca46948daf5545e}{m};
494    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
495    \hyperlink{tftp__common_8h_aa49f0fa1700f5991479cb7e3b1afcf52}{TftpWrqPacket} *wrqPacket;
496 
497    \textcolor{comment}{//Retrieve the length of the filename}
498    m = strlen(\hyperlink{tftp__common_8h_a054704ecfbf9f8eea80cd1d120b8cf62}{filename});
499    \textcolor{comment}{//Retrieve the length of the transfer mode}
500    n = strlen(\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode});
501 
502    \textcolor{comment}{//Check the length of the filename}
503    \textcolor{keywordflow}{if}((m + n) > \hyperlink{tftp__client_8h_afee8b7e4ec17ab2b7db46911b721f700}{TFTP\_CLIENT\_BLOCK\_SIZE})
504       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
505 
506    \textcolor{comment}{//Point to the buffer where to format the packet}
507    wrqPacket = (\hyperlink{tftp__common_8h_aa49f0fa1700f5991479cb7e3b1afcf52}{TftpWrqPacket} *) context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket};
508 
509    \textcolor{comment}{//Format WRQ packet}
510    wrqPacket->opcode = \hyperlink{cpu__endian_8h_a15540dbaeee98b6df80805f92e2f6759}{HTONS}(\hyperlink{tftp__common_8h_a833ab123c017ad4062778a372d0dc92ea615e060a29a1a318043e718cb3f65564}{TFTP\_OPCODE\_WRQ});
511    strcpy(wrqPacket->filename, \hyperlink{tftp__common_8h_a054704ecfbf9f8eea80cd1d120b8cf62}{filename});
512    strcpy(wrqPacket->filename + m + 1, \hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode});
513 
514    \textcolor{comment}{//Compute the length of the WRQ packet}
515    context->\hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen} = \textcolor{keyword}{sizeof}(\hyperlink{tftp__common_8h_a4b1e4ca412d8e3cd22c695e2d201a69a}{TftpRrqPacket}) + n + m + 2;
516 
517    \textcolor{comment}{//Debug message}
518    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"TFTP Client: Sending WRQ packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)...\(\backslash\)r\(\backslash\)n"}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen});
519    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode = %u\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(wrqPacket->opcode));
520    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Filename = %s\(\backslash\)r\(\backslash\)n"}, wrqPacket->filename);
521    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Mode = %s\(\backslash\)r\(\backslash\)n"}, \hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode});
522 
523    \textcolor{comment}{//Send WRQ packet}
524    error = \hyperlink{socket_8c_a5985321fef9f287f84c4004aaa78920e}{socketSendTo}(context->\hyperlink{structTftpClientContext_a59b908f8e63aace324a7b8d8a0af72a5}{socket}, &context->
      \hyperlink{structTftpClientContext_a961c1849ca6750986224145f8b298001}{serverIpAddr},
525       context->\hyperlink{structTftpClientContext_a4fbd05c69003e22ea5703eabd89ab1c8}{serverPort}, context->\hyperlink{structTftpClientContext_ad79208d8abaf2c5e951c01f072b5c6e6}{outPacket}, context->
      \hyperlink{structTftpClientContext_a007702b449446fd7e376c1a420bd518d}{outPacketLen}, \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 0);
526 
527    \textcolor{comment}{//Save the time at which the packet was sent}
528    context->\hyperlink{structTftpClientContext_a3f3e170f2e6bbde98ca73a0526fee76c}{timestamp} = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
529    \textcolor{comment}{//Reset retransmission counter}
530    context->\hyperlink{structTftpClientContext_a553a66049549f947eb23fbe419dea373}{retransmitCount} = 0;
531 
532    \textcolor{comment}{//Return status code}
533    \textcolor{keywordflow}{return} error;
534 \}
\end{DoxyCode}
