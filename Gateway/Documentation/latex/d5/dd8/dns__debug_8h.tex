\hypertarget{dns__debug_8h}{}\section{cyclone\+\_\+tcp/dns/dns\+\_\+debug.h File Reference}
\label{dns__debug_8h}\index{cyclone\+\_\+tcp/dns/dns\+\_\+debug.\+h@{cyclone\+\_\+tcp/dns/dns\+\_\+debug.\+h}}


Data logging functions for debugging purpose (D\+NS)  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}dns/dns\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{dns__debug_8h_aa6a38c4e74d8b059c64c30456d5c26ad}{dns\+Dump\+Message} (const \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{Dns\+Header} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump D\+NS message for debugging purpose. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{dns__debug_8h_aea4b6cec57139dcdcbf3c1fdf29a19a4}{dns\+Dump\+Question} (const \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{Dns\+Header} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t pos, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Dump D\+NS question for debugging purpose. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{dns__debug_8h_af061e6d7bca313dd56d4121b3eeea6dd}{dns\+Dump\+Resource\+Record} (const \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{Dns\+Header} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t pos, \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Dump D\+NS resource record for debugging purpose. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Data logging functions for debugging purpose (D\+NS) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{dns__debug_8h_aa6a38c4e74d8b059c64c30456d5c26ad}\label{dns__debug_8h_aa6a38c4e74d8b059c64c30456d5c26ad}} 
\index{dns\+\_\+debug.\+h@{dns\+\_\+debug.\+h}!dns\+Dump\+Message@{dns\+Dump\+Message}}
\index{dns\+Dump\+Message@{dns\+Dump\+Message}!dns\+\_\+debug.\+h@{dns\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{dns\+Dump\+Message()}{dnsDumpMessage()}}
{\footnotesize\ttfamily void dns\+Dump\+Message (\begin{DoxyParamCaption}\item[{const \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{Dns\+Header} $\ast$}]{message,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump D\+NS message for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the D\+NS message \\
\hline
\mbox{\tt in}  & {\em length} & Length of the D\+NS message \\
\hline
\end{DoxyParams}


Definition at line 52 of file dns\+\_\+debug.\+c.


\begin{DoxyCode}
53 \{
54    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
55    \textcolor{keywordtype}{size\_t} pos;
56    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *buffer;
57 
58    \textcolor{comment}{//Make sure the DNS message is valid}
59    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} >= \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{DnsHeader}))
60    \{
61       \textcolor{comment}{//Dump DNS message header}
62       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Identifier (ID) = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->id));
63       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Query Response (QR) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->qr);
64       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Opcode (OPCODE) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->opcode);
65       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Authoritative Answer (AA) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->aa);
66       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  TrunCation (TC) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->tc);
67       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Recursion Desired (RD) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->rd);
68       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Recursion Available (RA) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->ra);
69       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Reserved (Z) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->z);
70       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Response Code (RCODE) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->rcode);
71       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Question Count (QDCOUNT) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->qdcount));
72       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Answer Count (ANCOUNT) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->ancount));
73       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Name Server Count (NSCOUNT) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->nscount));
74       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Additional Record Count (ARCOUNT) = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->arcount));
75 
76       \textcolor{comment}{//Allocate a memory buffer to holds domain names}
77       buffer = \hyperlink{net__mem_8c_abe64a91cd872768817509cc08eed6689}{memPoolAlloc}(\hyperlink{dns__common_8h_a42b93dc2abd0c47cf4f5d74ef60ef320}{DNS\_NAME\_MAX\_SIZE});
78       \textcolor{comment}{//Failed to allocate memory}
79       \textcolor{keywordflow}{if}(buffer == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
80          \textcolor{keywordflow}{return};
81 
82       \textcolor{comment}{//Point to the first question}
83       pos = \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{DnsHeader});
84 
85       \textcolor{comment}{//Start of exception handling block}
86       \textcolor{keywordflow}{do}
87       \{
88          \textcolor{comment}{//Debug message}
89          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Questions\(\backslash\)r\(\backslash\)n"});
90 
91          \textcolor{comment}{//Parse questions}
92          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->qdcount); i++)
93          \{
94             \textcolor{comment}{//Dump current question}
95             pos = \hyperlink{dns__debug_8c_aea4b6cec57139dcdcbf3c1fdf29a19a4}{dnsDumpQuestion}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer);
96             \textcolor{comment}{//Any error to report?}
97             \textcolor{keywordflow}{if}(!pos)
98                \textcolor{keywordflow}{break};
99          \}
100 
101          \textcolor{comment}{//Parsing error?}
102          \textcolor{keywordflow}{if}(!pos)
103             \textcolor{keywordflow}{break};
104 
105          \textcolor{comment}{//Debug message}
106          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Answer RRs\(\backslash\)r\(\backslash\)n"});
107 
108          \textcolor{comment}{//Parse answer resource records}
109          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->ancount); i++)
110          \{
111             \textcolor{comment}{//Dump current resource record}
112             pos = \hyperlink{dns__debug_8c_af061e6d7bca313dd56d4121b3eeea6dd}{dnsDumpResourceRecord}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer);
113             \textcolor{comment}{//Any error to report?}
114             \textcolor{keywordflow}{if}(!pos)
115                \textcolor{keywordflow}{break};
116          \}
117 
118          \textcolor{comment}{//Parsing error?}
119          \textcolor{keywordflow}{if}(!pos)
120             \textcolor{keywordflow}{break};
121 
122          \textcolor{comment}{//Debug message}
123          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Authority RRs\(\backslash\)r\(\backslash\)n"});
124 
125          \textcolor{comment}{//Parse authority resource records}
126          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->nscount); i++)
127          \{
128             \textcolor{comment}{//Dump current resource record}
129             pos = \hyperlink{dns__debug_8c_af061e6d7bca313dd56d4121b3eeea6dd}{dnsDumpResourceRecord}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer);
130             \textcolor{comment}{//Any error to report?}
131             \textcolor{keywordflow}{if}(!pos)
132                \textcolor{keywordflow}{break};
133          \}
134 
135          \textcolor{comment}{//Parsing error?}
136          \textcolor{keywordflow}{if}(!pos)
137             \textcolor{keywordflow}{break};
138 
139          \textcolor{comment}{//Debug message}
140          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Additional RRs\(\backslash\)r\(\backslash\)n"});
141 
142          \textcolor{comment}{//Parse additional resource records}
143          \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}->arcount); i++)
144          \{
145             \textcolor{comment}{//Dump current resource record}
146             pos = \hyperlink{dns__debug_8c_af061e6d7bca313dd56d4121b3eeea6dd}{dnsDumpResourceRecord}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer);
147             \textcolor{comment}{//Any error to report?}
148             \textcolor{keywordflow}{if}(!pos)
149                \textcolor{keywordflow}{break};
150          \}
151 
152          \textcolor{comment}{//End of exception handling block}
153       \} \textcolor{keywordflow}{while}(0);
154 
155       \textcolor{comment}{//Free previously allocated memory}
156       \hyperlink{net__mem_8c_a5e8a514f3dfcb35008de9beb39bcdcde}{memPoolFree}(buffer);
157    \}
158 \}
\end{DoxyCode}
\mbox{\Hypertarget{dns__debug_8h_aea4b6cec57139dcdcbf3c1fdf29a19a4}\label{dns__debug_8h_aea4b6cec57139dcdcbf3c1fdf29a19a4}} 
\index{dns\+\_\+debug.\+h@{dns\+\_\+debug.\+h}!dns\+Dump\+Question@{dns\+Dump\+Question}}
\index{dns\+Dump\+Question@{dns\+Dump\+Question}!dns\+\_\+debug.\+h@{dns\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{dns\+Dump\+Question()}{dnsDumpQuestion()}}
{\footnotesize\ttfamily size\+\_\+t dns\+Dump\+Question (\begin{DoxyParamCaption}\item[{const \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{Dns\+Header} $\ast$}]{message,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t}]{pos,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{buffer }\end{DoxyParamCaption})}



Dump D\+NS question for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the D\+NS message \\
\hline
\mbox{\tt in}  & {\em length} & Length of the D\+NS message \\
\hline
\mbox{\tt in}  & {\em pos} & Offset of the question to decode \\
\hline
\mbox{\tt in}  & {\em buffer} & Memory buffer to holds domain names \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Offset to the next question 
\end{DoxyReturn}


Definition at line 170 of file dns\+\_\+debug.\+c.


\begin{DoxyCode}
171 \{
172    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
173    \hyperlink{dns__common_8h_ac1ef063cc8bc932118463092c282f188}{DnsQuestion} *question;
174 
175    \textcolor{comment}{//Parse domain name}
176    n = \hyperlink{dns__common_8c_a6a5df1aead8f61467e9bf5e739ea5de0}{dnsParseName}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer, 0);
177    \textcolor{comment}{//Invalid name?}
178    \textcolor{keywordflow}{if}(!n)
179       \textcolor{keywordflow}{return} 0;
180 
181    \textcolor{comment}{//Make sure the DNS question is valid}
182    \textcolor{keywordflow}{if}((n + \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_ac1ef063cc8bc932118463092c282f188}{DnsQuestion})) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
183       \textcolor{keywordflow}{return} 0;
184 
185    \textcolor{comment}{//Point to the corresponding entry}
186    question = \hyperlink{dns__common_8h_a66ca704f3f850dcbb2f3ceefe90afcc5}{DNS\_GET\_QUESTION}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, n);
187 
188    \textcolor{comment}{//NB question found?}
189    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(question->qtype) == \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a2c6f8e31b0a836590f0173f34e3d082c}{DNS\_RR\_TYPE\_NB})
190    \{
191 \textcolor{preprocessor}{#if (NBNS\_CLIENT\_SUPPORT == ENABLED || NBNS\_RESPONDER\_SUPPORT == ENABLED)}
192 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
193       \textcolor{comment}{//Decode NetBIOS name}
194       pos = \hyperlink{nbns__common_8c_a883186d42b150c72047c02e9ee490770}{nbnsParseName}((\hyperlink{nbns__common_8h_a31dec1106c9cf3a1e242d985ac447238}{NbnsHeader} *) \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer);
195       \textcolor{comment}{//Invalid NetBIOS name?}
196       \textcolor{keywordflow}{if}(!pos)
197          \textcolor{keywordflow}{return} 0;
198 \textcolor{preprocessor}{#endif}
199 \textcolor{preprocessor}{#endif}
200    \}
201 
202    \textcolor{comment}{//Dump DNS question}
203    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Name (QNAME) = %s\(\backslash\)r\(\backslash\)n"}, buffer);
204    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Query Type (QTYPE) = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(question->qtype));
205    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Query Class (QCLASS) = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(question->qclass));
206 
207    \textcolor{comment}{//Point to the next question}
208    n += \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_ac1ef063cc8bc932118463092c282f188}{DnsQuestion});
209    \textcolor{comment}{//Return the current position}
210    \textcolor{keywordflow}{return} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
211 \}
\end{DoxyCode}
\mbox{\Hypertarget{dns__debug_8h_af061e6d7bca313dd56d4121b3eeea6dd}\label{dns__debug_8h_af061e6d7bca313dd56d4121b3eeea6dd}} 
\index{dns\+\_\+debug.\+h@{dns\+\_\+debug.\+h}!dns\+Dump\+Resource\+Record@{dns\+Dump\+Resource\+Record}}
\index{dns\+Dump\+Resource\+Record@{dns\+Dump\+Resource\+Record}!dns\+\_\+debug.\+h@{dns\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{dns\+Dump\+Resource\+Record()}{dnsDumpResourceRecord()}}
{\footnotesize\ttfamily size\+\_\+t dns\+Dump\+Resource\+Record (\begin{DoxyParamCaption}\item[{const \hyperlink{dns__common_8h_a5caa7816ce531b3920054e974a0679f3}{Dns\+Header} $\ast$}]{message,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t}]{pos,  }\item[{\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{buffer }\end{DoxyParamCaption})}



Dump D\+NS resource record for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em message} & Pointer to the D\+NS message \\
\hline
\mbox{\tt in}  & {\em length} & Length of the D\+NS message \\
\hline
\mbox{\tt in}  & {\em pos} & Offset of the question to decode \\
\hline
\mbox{\tt in}  & {\em buffer} & Memory buffer to holds domain names \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Offset to the next question 
\end{DoxyReturn}


Definition at line 223 of file dns\+\_\+debug.\+c.


\begin{DoxyCode}
224 \{
225    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
226    \hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord} *record;
227    \hyperlink{dns__common_8h_a6275a745cd58902d1cf42966a3c077c8}{DnsSrvResourceRecord} *srvRecord;
228 
229    \textcolor{comment}{//Parse domain name}
230    n = \hyperlink{dns__common_8c_a6a5df1aead8f61467e9bf5e739ea5de0}{dnsParseName}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer, 0);
231    \textcolor{comment}{//Invalid name?}
232    \textcolor{keywordflow}{if}(!n)
233       \textcolor{keywordflow}{return} 0;
234 
235    \textcolor{comment}{//Point to the corresponding entry}
236    record = \hyperlink{dns__common_8h_a4f1a2722ba292be26060ec5693e1f280}{DNS\_GET\_RESOURCE\_RECORD}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, n);
237 
238    \textcolor{comment}{//Make sure the resource record is valid}
239    \textcolor{keywordflow}{if}((n + \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord})) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
240       \textcolor{keywordflow}{return} 0;
241    \textcolor{keywordflow}{if}((n + \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord}) + \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rdlength)) > 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
242       \textcolor{keywordflow}{return} 0;
243 
244    \textcolor{comment}{//NB resource record found?}
245    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rtype) == \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a2c6f8e31b0a836590f0173f34e3d082c}{DNS\_RR\_TYPE\_NB})
246    \{
247 \textcolor{preprocessor}{#if (NBNS\_CLIENT\_SUPPORT == ENABLED || NBNS\_RESPONDER\_SUPPORT == ENABLED)}
248 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
249       \textcolor{comment}{//Decode NetBIOS name}
250       pos = \hyperlink{nbns__common_8c_a883186d42b150c72047c02e9ee490770}{nbnsParseName}((\hyperlink{nbns__common_8h_a31dec1106c9cf3a1e242d985ac447238}{NbnsHeader} *) \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, pos, buffer);
251       \textcolor{comment}{//Invalid NetBIOS name?}
252       \textcolor{keywordflow}{if}(!pos)
253          \textcolor{keywordflow}{return} 0;
254 \textcolor{preprocessor}{#endif}
255 \textcolor{preprocessor}{#endif}
256    \}
257 
258    \textcolor{comment}{//Dump DNS resource record}
259    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Name (NAME) = %s\(\backslash\)r\(\backslash\)n"}, buffer);
260    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Query Type (TYPE) = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rtype));
261    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Query Class (CLASS) = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rclass));
262    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Time-To-Live (TTL) = %"} PRIu32 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a22f92ea3318059b7d88dfbd98d0cbc3e}{ntohl}(record->ttl));
263    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Data Length (RDLENGTH) = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rdlength));
264 
265    \textcolor{comment}{//Dump resource data}
266 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
267    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rtype) == \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a420fd47ef427589e0f1961e35b46756b}{DNS\_RR\_TYPE\_A} &&
268       \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rdlength) == \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr}))
269    \{
270       \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
271 
272       \textcolor{comment}{//Copy IPv4 address}
273       \hyperlink{ipv4_8h_a36a3af47ec7eec9b1781964eb0494b6f}{ipv4CopyAddr}(&ipAddr, record->rdata);
274       \textcolor{comment}{//Dump IPv4 address}
275       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Data (RDATA) = %s\(\backslash\)r\(\backslash\)n"}, \hyperlink{ipv4_8c_a6d826409fb54a5cc0ce23c5f88f5c7c1}{ipv4AddrToString}(ipAddr, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}));
276    \}
277    \textcolor{keywordflow}{else}
278 \textcolor{preprocessor}{#endif}
279 \textcolor{preprocessor}{#if (IPV6\_SUPPORT == ENABLED)}
280    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rtype) == \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a4d0fc3b547030a6a0f32b3ca455927fe}{DNS\_RR\_TYPE\_AAAA} &&
281       \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rdlength) == \textcolor{keyword}{sizeof}(\hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr}))
282    \{
283       \hyperlink{ipv6_8h_aed0cbc40c61ed5b4fb681ebc55237e89}{Ipv6Addr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
284 
285       \textcolor{comment}{//Copy IPv6 address}
286       \hyperlink{ipv6_8h_ac22b1fcd381d1c288e269cb8d164bfec}{ipv6CopyAddr}(&ipAddr, record->rdata);
287       \textcolor{comment}{//Dump IPv6 address}
288       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Data (RDATA) = %s\(\backslash\)r\(\backslash\)n"}, \hyperlink{ipv6_8c_a96e27d88ffdf1b2ca6fca448dc6b4e7e}{ipv6AddrToString}(&ipAddr, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}));
289    \}
290    \textcolor{keywordflow}{else}
291 \textcolor{preprocessor}{#endif}
292    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rtype) == \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a23a2ea11b5bb8ab8d6d088de58be553b}{DNS\_RR\_TYPE\_PTR})
293    \{
294       \textcolor{comment}{//Decode domain name}
295       pos = \hyperlink{dns__common_8c_a6a5df1aead8f61467e9bf5e739ea5de0}{dnsParseName}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, n + \textcolor{keyword}{sizeof}(
      \hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord}), buffer, 0);
296       \textcolor{comment}{//Invalid domain name?}
297       \textcolor{keywordflow}{if}(!pos)
298          \textcolor{keywordflow}{return} 0;
299 
300       \textcolor{comment}{//Dump name}
301       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Domain Name (PTRDNAME) = %s\(\backslash\)r\(\backslash\)n"}, buffer);
302    \}
303    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rtype) == \hyperlink{dns__common_8h_aa24a9fb31b6fb3858a24a8d8682e23d1a2fe0a9e93403ff6c34c4a4ce79e0c13c}{DNS\_RR\_TYPE\_SRV})
304    \{
305       \textcolor{comment}{//Cast resource record}
306       srvRecord = (\hyperlink{dns__common_8h_a6275a745cd58902d1cf42966a3c077c8}{DnsSrvResourceRecord} *) record;
307 
308       \textcolor{comment}{//Dump SRV resource record}
309       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Priority = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(srvRecord->priority));
310       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Weight = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(srvRecord->weight));
311       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Port = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(srvRecord->port));
312 
313       \textcolor{comment}{//Decode target name}
314       pos = \hyperlink{dns__common_8c_a6a5df1aead8f61467e9bf5e739ea5de0}{dnsParseName}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, n + \textcolor{keyword}{sizeof}(
      \hyperlink{dns__common_8h_a6275a745cd58902d1cf42966a3c077c8}{DnsSrvResourceRecord}), buffer, 0);
315       \textcolor{comment}{//Invalid domain name?}
316       \textcolor{keywordflow}{if}(!pos)
317          \textcolor{keywordflow}{return} 0;
318 
319       \textcolor{comment}{//Dump name}
320       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Target = %s\(\backslash\)r\(\backslash\)n"}, buffer);
321    \}
322    \textcolor{keywordflow}{else}
323    \{
324       \textcolor{comment}{//Dump resource data}
325       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Data (RDATA)\(\backslash\)r\(\backslash\)n"});
326       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"        "}, record->rdata, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rdlength));
327    \}
328 
329    \textcolor{comment}{//Point to the next resource record}
330    n += \textcolor{keyword}{sizeof}(\hyperlink{dns__common_8h_a801d4a933cd802d56c5450013b4c0969}{DnsResourceRecord}) + \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(record->rdlength);
331    \textcolor{comment}{//Return the current position}
332    \textcolor{keywordflow}{return} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
333 \}
\end{DoxyCode}
