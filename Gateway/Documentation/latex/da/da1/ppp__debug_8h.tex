\hypertarget{ppp__debug_8h}{}\section{cyclone\+\_\+tcp/ppp/ppp\+\_\+debug.h File Reference}
\label{ppp__debug_8h}\index{cyclone\+\_\+tcp/ppp/ppp\+\_\+debug.\+h@{cyclone\+\_\+tcp/ppp/ppp\+\_\+debug.\+h}}


Data logging functions for debugging purpose (P\+PP)  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ppp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/lcp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ppp/ipcp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_aebeb2591b3799b0ede290881fdd67e78}{ppp\+Dump\+Packet} (const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2}{Ppp\+Protocol} \hyperlink{lcp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol})
\begin{DoxyCompactList}\small\item\em Dump L\+C\+P/\+N\+CP packet for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_a804c7ea1b46f753e6d9b35bc7f5bf3e0}{lcp\+Dump\+Packet} (const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump L\+CP packet for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_aa75a8008eec881e84a285169be02de71}{ncp\+Dump\+Packet} (const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2}{Ppp\+Protocol} \hyperlink{lcp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol})
\begin{DoxyCompactList}\small\item\em Dump N\+CP packet for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_afcad114edcc4fd1b512ba5d076ef819c}{pap\+Dump\+Packet} (const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump P\+AP packet for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_af818170c9e413f88dde94dac2bb3e191}{chap\+Dump\+Packet} (const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$packet, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump C\+H\+AP packet for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_a7e1b805d915374bf762ad35e1d9b7e59}{lcp\+Dump\+Options} (const \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$option, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump L\+CP options for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_a5a0b25c11dabbf8412cab8657ee1904a}{ipcp\+Dump\+Options} (const \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$option, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump I\+P\+CP options for debugging purpose. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{ppp__debug_8h_aa5335294a743cbcf3cbcb7ae03b08c3b}{ipv6cp\+Dump\+Options} (const \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$option, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Dump I\+P\+V6\+CP options for debugging purpose. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Data logging functions for debugging purpose (P\+PP) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{ppp__debug_8h_af818170c9e413f88dde94dac2bb3e191}\label{ppp__debug_8h_af818170c9e413f88dde94dac2bb3e191}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!chap\+Dump\+Packet@{chap\+Dump\+Packet}}
\index{chap\+Dump\+Packet@{chap\+Dump\+Packet}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{chap\+Dump\+Packet()}{chapDumpPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} chap\+Dump\+Packet (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump C\+H\+AP packet for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em packet} & Pointer to the P\+AP packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 593 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
594 \{
595    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *label;
596 
597    \textcolor{comment}{//Make sure the CHAP packet is valid}
598    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
599       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
600 
601    \textcolor{comment}{//Check the length field}
602    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
603       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
604    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
605       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
606 
607    \textcolor{comment}{//Save the length of the CHAP packet}
608    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length);
609 
610    \textcolor{comment}{//Retrieve the name of the CHAP packet}
611    \textcolor{keywordflow}{if}(packet->code < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_aa96b6c6e6ba6dd2a306cbf8700618d34}{chapCodeLabel}))
612       label = \hyperlink{ppp__debug_8c_aa96b6c6e6ba6dd2a306cbf8700618d34}{chapCodeLabel}[packet->code];
613    \textcolor{keywordflow}{else}
614       label = \textcolor{stringliteral}{"Unknown"};
615 
616    \textcolor{comment}{//Dump CHAP packet header}
617    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Code = %"} PRIu8 \textcolor{stringliteral}{" (%s)\(\backslash\)r\(\backslash\)n"}, packet->code, label);
618    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Identifier = %"} PRIu8  \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, packet->identifier);
619    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Length = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length));
620 
621    \textcolor{comment}{//Challenge or Response packet?}
622    \textcolor{keywordflow}{if}(packet->code == \hyperlink{chap_8h_a51665c1b5c9136f608c8f923c1873107a8b903cb9c2e5aae66498864fd1326510}{CHAP\_CODE\_CHALLENGE} ||
623       packet->code == \hyperlink{chap_8h_a51665c1b5c9136f608c8f923c1873107a102ce6c3681b89662a252610b26572f9}{CHAP\_CODE\_RESPONSE})
624    \{
625       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *q;
626       \hyperlink{chap_8h_ab683cbc9f8f1c8ac9727d16ae39db9e3}{ChapChallengePacket} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
627 
628       \textcolor{comment}{//Cast CHAP packet}
629       p = (\hyperlink{chap_8h_ab683cbc9f8f1c8ac9727d16ae39db9e3}{ChapChallengePacket} *) packet;
630 
631       \textcolor{comment}{//Valid packet length?}
632       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{chap_8h_ab683cbc9f8f1c8ac9727d16ae39db9e3}{ChapChallengePacket}))
633          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
634 
635       \textcolor{comment}{//Value-Size field}
636       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Value-Size = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, p->valueSize);
637 
638       \textcolor{comment}{//Check the length of the Value field}
639       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < (\textcolor{keyword}{sizeof}(\hyperlink{chap_8h_ab683cbc9f8f1c8ac9727d16ae39db9e3}{ChapChallengePacket}) + p->valueSize))
640          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
641 
642       \textcolor{comment}{//Value field}
643       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Value\(\backslash\)r\(\backslash\)n"});
644       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->value, p->valueSize);
645 
646       \textcolor{comment}{//Point to the Name field}
647       q = p->value + p->valueSize;
648       \textcolor{comment}{//Retrieve the length of the Name field}
649       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{chap_8h_ab683cbc9f8f1c8ac9727d16ae39db9e3}{ChapChallengePacket}) + p->valueSize;
650 
651       \textcolor{comment}{//Name field}
652       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Name (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
653       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, q, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
654    \}
655    \textcolor{comment}{//Success or Failure packet?}
656    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{chap_8h_a51665c1b5c9136f608c8f923c1873107a7ba149c3d7d9f5a7fb6218e901d7715f}{CHAP\_CODE\_SUCCESS} ||
657       packet->code == \hyperlink{chap_8h_a51665c1b5c9136f608c8f923c1873107ae578898fce8e45cc89ef365aa7688ada}{CHAP\_CODE\_FAILURE})
658    \{
659       \hyperlink{chap_8h_aa1e3b3e258753a4cd9bc27814db133fe}{ChapSuccessPacket} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
660 
661       \textcolor{comment}{//Cast CHAP packet}
662       p = (\hyperlink{chap_8h_aa1e3b3e258753a4cd9bc27814db133fe}{ChapSuccessPacket} *) packet;
663 
664       \textcolor{comment}{//Valid packet length?}
665       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{chap_8h_aa1e3b3e258753a4cd9bc27814db133fe}{ChapSuccessPacket}))
666          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
667 
668       \textcolor{comment}{//Retrieve the length of Message field}
669       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{chap_8h_aa1e3b3e258753a4cd9bc27814db133fe}{ChapSuccessPacket});
670 
671       \textcolor{comment}{//Message field}
672       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
673       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->message, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
674    \}
675    \textcolor{comment}{//Unknown packet?}
676    \textcolor{keywordflow}{else}
677    \{
678       \textcolor{comment}{//Retrieve the length of data}
679       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket});
680 
681       \textcolor{comment}{//Any data?}
682       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
683       \{
684          \textcolor{comment}{//Dump data}
685          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
686          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, packet->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
687       \}
688    \}
689 
690    \textcolor{comment}{//No error to report}
691    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
692 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_a5a0b25c11dabbf8412cab8657ee1904a}\label{ppp__debug_8h_a5a0b25c11dabbf8412cab8657ee1904a}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!ipcp\+Dump\+Options@{ipcp\+Dump\+Options}}
\index{ipcp\+Dump\+Options@{ipcp\+Dump\+Options}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{ipcp\+Dump\+Options()}{ipcpDumpOptions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipcp\+Dump\+Options (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$}]{option,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump I\+P\+CP options for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em option} & Pointer to the option list \\
\hline
\mbox{\tt in}  & {\em length} & Length of the option list, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 775 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
776 \{
777 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
778    \hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr} \hyperlink{mib__common_8h_a3860e959b1b7dd73686a6e11424805e2}{ipAddr};
779 \textcolor{preprocessor}{#endif}
780 
781    \textcolor{comment}{//Parse options}
782    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
783    \{
784       \textcolor{comment}{//Malformed IPCP packet?}
785       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
786          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
787 
788       \textcolor{comment}{//Check option length}
789       \textcolor{keywordflow}{if}(option->length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
790          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
791       \textcolor{keywordflow}{if}(option->length > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
792          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
793 
794       \textcolor{comment}{//Display the name of the current option}
795       \textcolor{keywordflow}{if}(option->type < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_aecf21851992cd06232b174c3c723dfe8}{ipcpOptionLabel}))
796          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  %s option (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{ppp__debug_8c_aecf21851992cd06232b174c3c723dfe8}{ipcpOptionLabel}[option->type], option->length);
797       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(option->type >= 128 && option->type < (128 + \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(
      \hyperlink{ppp__debug_8c_a2fe9b0a9a07c55d90f21c9871f4b7a80}{ipcpOptionLabel2})))
798          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  %s option (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{ppp__debug_8c_a2fe9b0a9a07c55d90f21c9871f4b7a80}{ipcpOptionLabel2}[option->type - 128], option->length);
799       \textcolor{keywordflow}{else}
800          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Option %"} PRIu8 \textcolor{stringliteral}{" (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, option->type, option->length)
      ;
801 
802       \textcolor{comment}{//Check option code}
803       \textcolor{keywordflow}{switch}(option->type)
804       \{
805 \textcolor{preprocessor}{#if (IPV4\_SUPPORT == ENABLED)}
806       \textcolor{comment}{//IP address?}
807       \textcolor{keywordflow}{case} \hyperlink{ipcp_8h_a82079ac6099e93506f2b406bc75bbd45a124bafb002549c2de4cb293f5e158fd9}{IPCP\_OPTION\_IP\_ADDRESS}:
808       \textcolor{keywordflow}{case} \hyperlink{ipcp_8h_a82079ac6099e93506f2b406bc75bbd45ad0bf3add16c3e3c90346b3ffdc692a55}{IPCP\_OPTION\_PRIMARY\_DNS}:
809       \textcolor{keywordflow}{case} \hyperlink{ipcp_8h_a82079ac6099e93506f2b406bc75bbd45a28b257ea13ab66ecf12cfcd69fd70eed}{IPCP\_OPTION\_PRIMARY\_NBNS}:
810       \textcolor{keywordflow}{case} \hyperlink{ipcp_8h_a82079ac6099e93506f2b406bc75bbd45abd3891dd42a37b50a69db93d70e55980}{IPCP\_OPTION\_SECONDARY\_DNS}:
811       \textcolor{keywordflow}{case} \hyperlink{ipcp_8h_a82079ac6099e93506f2b406bc75bbd45abd1846100f70cd99b6a174786afd5bcd}{IPCP\_OPTION\_SECONDARY\_NBNS}:
812          \textcolor{comment}{//Check length field}
813          \textcolor{keywordflow}{if}(option->length != (\textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}) + \textcolor{keyword}{sizeof}(\hyperlink{ipv4_8h_a411debb3d770caa0c06d3f73367da37f}{Ipv4Addr})))
814             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca29b2389396deec9c8dbd640bfffe457c}{ERROR\_INVALID\_OPTION};
815          \textcolor{comment}{//Retrieve IPv4 address}
816          \hyperlink{ipv4_8h_a36a3af47ec7eec9b1781964eb0494b6f}{ipv4CopyAddr}(&ipAddr, option->data);
817          \textcolor{comment}{//Dump option contents}
818          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    %s\(\backslash\)r\(\backslash\)n"}, \hyperlink{ipv4_8c_a6d826409fb54a5cc0ce23c5f88f5c7c1}{ipv4AddrToString}(ipAddr, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}));
819          \textcolor{keywordflow}{break};
820 \textcolor{preprocessor}{#endif}
821       \textcolor{comment}{//Raw data?}
822       \textcolor{keywordflow}{default}:
823          \textcolor{comment}{//Dump option contents}
824          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, option->data, option->length - \textcolor{keyword}{sizeof}(
      \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
825          \textcolor{keywordflow}{break};
826       \}
827 
828       \textcolor{comment}{//Remaining bytes to process}
829       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= option->length;
830       \textcolor{comment}{//Jump to the next option}
831       option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) option + option->length);
832    \}
833 
834    \textcolor{comment}{//No error to report}
835    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
836 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_aa5335294a743cbcf3cbcb7ae03b08c3b}\label{ppp__debug_8h_aa5335294a743cbcf3cbcb7ae03b08c3b}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!ipv6cp\+Dump\+Options@{ipv6cp\+Dump\+Options}}
\index{ipv6cp\+Dump\+Options@{ipv6cp\+Dump\+Options}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{ipv6cp\+Dump\+Options()}{ipv6cpDumpOptions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ipv6cp\+Dump\+Options (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$}]{option,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump I\+P\+V6\+CP options for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em option} & Pointer to the option list \\
\hline
\mbox{\tt in}  & {\em length} & Length of the option list, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 846 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
847 \{
848    \textcolor{comment}{//Parse options}
849    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
850    \{
851       \textcolor{comment}{//Malformed IPV6CP packet?}
852       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
853          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
854 
855       \textcolor{comment}{//Check option length}
856       \textcolor{keywordflow}{if}(option->length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
857          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
858       \textcolor{keywordflow}{if}(option->length > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
859          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
860 
861       \textcolor{comment}{//Display the name of the current option}
862       \textcolor{keywordflow}{if}(option->type < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_a57ae71dda80a765c83a619c259dd1357}{ipv6cpOptionLabel}))
863          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  %s option (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{ppp__debug_8c_a57ae71dda80a765c83a619c259dd1357}{ipv6cpOptionLabel}[option->type], option->length);
864       \textcolor{keywordflow}{else}
865          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Option %"} PRIu8 \textcolor{stringliteral}{" (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, option->type, option->length)
      ;
866 
867       \textcolor{comment}{//Check option code}
868       \textcolor{keywordflow}{switch}(option->type)
869       \{
870       \textcolor{comment}{//Raw data?}
871       \textcolor{keywordflow}{default}:
872          \textcolor{comment}{//Dump option contents}
873          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, option->data, option->length - \textcolor{keyword}{sizeof}(
      \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
874          \textcolor{keywordflow}{break};
875       \}
876 
877       \textcolor{comment}{//Remaining bytes to process}
878       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= option->length;
879       \textcolor{comment}{//Jump to the next option}
880       option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) option + option->length);
881    \}
882 
883    \textcolor{comment}{//No error to report}
884    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
885 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_a7e1b805d915374bf762ad35e1d9b7e59}\label{ppp__debug_8h_a7e1b805d915374bf762ad35e1d9b7e59}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!lcp\+Dump\+Options@{lcp\+Dump\+Options}}
\index{lcp\+Dump\+Options@{lcp\+Dump\+Options}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{lcp\+Dump\+Options()}{lcpDumpOptions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Dump\+Options (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{Ppp\+Option} $\ast$}]{option,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump L\+CP options for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em option} & Pointer to the option list \\
\hline
\mbox{\tt in}  & {\em length} & Length of the option list, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 702 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
703 \{
704    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
705 
706    \textcolor{comment}{//Parse options}
707    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
708    \{
709       \textcolor{comment}{//Malformed LCP packet?}
710       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
711          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
712 
713       \textcolor{comment}{//Check option length}
714       \textcolor{keywordflow}{if}(option->length < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}))
715          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
716       \textcolor{keywordflow}{if}(option->length > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
717          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
718 
719       \textcolor{comment}{//Display the name of the current option}
720       \textcolor{keywordflow}{if}(option->type < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_a0b8704015835f51005a980ba6ddb8a4b}{lcpOptionLabel}))
721          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  %s option (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{ppp__debug_8c_a0b8704015835f51005a980ba6ddb8a4b}{lcpOptionLabel}[option->type], option->length);
722       \textcolor{keywordflow}{else}
723          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Option %"} PRIu8 \textcolor{stringliteral}{" (%"} PRIu8 \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, option->type, option->length)
      ;
724 
725       \textcolor{comment}{//Check option code}
726       \textcolor{keywordflow}{switch}(option->type)
727       \{
728       \textcolor{comment}{//16-bit unsigned value?}
729       \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0eabedb2479b9edd3fcefe7a84d2deb41fe}{LCP\_OPTION\_MRU}:
730          \textcolor{comment}{//Check length field}
731          \textcolor{keywordflow}{if}(option->length != (\textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}) + \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t})))
732             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca29b2389396deec9c8dbd640bfffe457c}{ERROR\_INVALID\_OPTION};
733          \textcolor{comment}{//Retrieve 16-bit value}
734          value = \hyperlink{cpu__endian_8h_ae21854587c05993c850b537156470088}{LOAD16BE}(option->data);
735          \textcolor{comment}{//Dump option contents}
736          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    %"} PRIu32 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, value);
737          \textcolor{keywordflow}{break};
738 
739       \textcolor{comment}{//32-bit unsigned value?}
740       \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea9473d9348d1568965142a387ab8b6a49}{LCP\_OPTION\_ACCM}:
741       \textcolor{keywordflow}{case} \hyperlink{lcp_8h_a304f5c9f269f78be4c559f4210dd0d0ea59c791ebec909b03a42659d08be2bcf8}{LCP\_OPTION\_MAGIC\_NUMBER}:
742          \textcolor{comment}{//Check length field}
743          \textcolor{keywordflow}{if}(option->length != (\textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}) + \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t})))
744             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca29b2389396deec9c8dbd640bfffe457c}{ERROR\_INVALID\_OPTION};
745          \textcolor{comment}{//Retrieve 32-bit value}
746          value = \hyperlink{cpu__endian_8h_a1be529d679835eda85cf5541e7926ca7}{LOAD32BE}(option->data);
747          \textcolor{comment}{//Dump option contents}
748          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    0x%08"} PRIX32 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, value);
749          \textcolor{keywordflow}{break};
750 
751       \textcolor{comment}{//Raw data?}
752       \textcolor{keywordflow}{default}:
753          \textcolor{comment}{//Dump option contents}
754          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, option->data, option->length - \textcolor{keyword}{sizeof}(
      \hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption}));
755          \textcolor{keywordflow}{break};
756       \}
757 
758       \textcolor{comment}{//Remaining bytes to process}
759       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= option->length;
760       \textcolor{comment}{//Jump to the next option}
761       option = (\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) ((\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) option + option->length);
762    \}
763 
764    \textcolor{comment}{//No error to report}
765    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
766 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_a804c7ea1b46f753e6d9b35bc7f5bf3e0}\label{ppp__debug_8h_a804c7ea1b46f753e6d9b35bc7f5bf3e0}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!lcp\+Dump\+Packet@{lcp\+Dump\+Packet}}
\index{lcp\+Dump\+Packet@{lcp\+Dump\+Packet}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{lcp\+Dump\+Packet()}{lcpDumpPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} lcp\+Dump\+Packet (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump L\+CP packet for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em packet} & Pointer to the L\+CP packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 185 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
186 \{
187    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
188    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *label;
189 
190    \textcolor{comment}{//Make sure the LCP packet is valid}
191    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
192       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
193 
194    \textcolor{comment}{//Check the length field}
195    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
196       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
197    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
198       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
199 
200    \textcolor{comment}{//Save the length of the LCP packet}
201    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length);
202 
203    \textcolor{comment}{//Retrieve the name of the LCP packet}
204    \textcolor{keywordflow}{if}(packet->code < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_aab6bfefcb406c888a94dee1f8b26465d}{lcpCodeLabel}))
205       label = \hyperlink{ppp__debug_8c_aab6bfefcb406c888a94dee1f8b26465d}{lcpCodeLabel}[packet->code];
206    \textcolor{keywordflow}{else}
207       label = \textcolor{stringliteral}{"Unknown"};
208 
209    \textcolor{comment}{//Dump LCP packet header}
210    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Code = %"} PRIu8 \textcolor{stringliteral}{" (%s)\(\backslash\)r\(\backslash\)n"}, packet->code, label);
211    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Identifier = %"} PRIu8  \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, packet->identifier);
212    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Length = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length));
213 
214    \textcolor{comment}{//Configure-Request, Configure-Ack, Configure-Nak or Configure-Reject packet?}
215    \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4e4279fdfcf8d81d216d58801f58d84d}{PPP\_CODE\_CONFIGURE\_REQ} ||
216       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK} ||
217       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK} ||
218       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ})
219    \{
220       \textcolor{comment}{//Cast LCP packet}
221       \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} = (\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *) packet;
222 
223       \textcolor{comment}{//Valid packet length?}
224       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket}))
225          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
226 
227       \textcolor{comment}{//Retrieve the length of the option list}
228       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket});
229 
230       \textcolor{comment}{//Dump options}
231       error = \hyperlink{ppp__debug_8c_a7e1b805d915374bf762ad35e1d9b7e59}{lcpDumpOptions}((\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) p->options, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
232       \textcolor{comment}{//Any error to report?}
233       \textcolor{keywordflow}{if}(error)
234          \textcolor{keywordflow}{return} error;
235    \}
236    \textcolor{comment}{//Terminate-Request or Terminate-Ack packet?}
237    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a7471c8252f420930c98ee6a789724a2d}{PPP\_CODE\_TERMINATE\_REQ} ||
238       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a6e7e46a330cfb72374afc3d09f275860}{PPP\_CODE\_TERMINATE\_ACK})
239    \{
240       \textcolor{comment}{//Cast LCP packet}
241       \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket} *p = (\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket} *) packet;
242 
243       \textcolor{comment}{//Valid packet length?}
244       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket}))
245          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
246 
247       \textcolor{comment}{//Retrieve the length of data}
248       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket});
249 
250       \textcolor{comment}{//Any data?}
251       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
252       \{
253          \textcolor{comment}{//Dump data}
254          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
255          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
256       \}
257    \}
258    \textcolor{comment}{//Code-Reject packet?}
259    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a7635f2c8a624bbf7fcb8eea300082a7d}{PPP\_CODE\_CODE\_REJ})
260    \{
261       \textcolor{comment}{//Cast LCP packet}
262       \hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket} *p = (\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket} *) packet;
263 
264       \textcolor{comment}{//Valid packet length?}
265       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket}))
266          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
267 
268       \textcolor{comment}{//Retrieve the length of Rejected-Packet field}
269       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket});
270 
271       \textcolor{comment}{//Rejected-Packet}
272       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Rejected-Packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
273       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->rejectedPacket, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
274    \}
275    \textcolor{comment}{//Protocol-Reject packet?}
276    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5ebc2227db3d6ca6bd25832e59fc9c04}{PPP\_CODE\_PROTOCOL\_REJ})
277    \{
278       \textcolor{comment}{//Cast LCP packet}
279       \hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{PppProtocolRejPacket} *p = (\hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{PppProtocolRejPacket} *) packet;
280 
281       \textcolor{comment}{//Valid packet length?}
282       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{PppProtocolRejPacket}))
283          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
284 
285       \textcolor{comment}{//Retrieve the length of Rejected-Information field}
286       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a39a8996b5c30c18325c8602468e095ca}{PppProtocolRejPacket});
287 
288       \textcolor{comment}{//Rejected-Protocol}
289       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Rejected-Protocol = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a800cdbf435a85a9b3ad4f0edc518472a}{htons}(p->rejectedProtocol));
290       \textcolor{comment}{//Rejected-Information}
291       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Rejected-Information (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
292       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->rejectedInfo, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
293    \}
294    \textcolor{comment}{//Echo-Request, Echo-Reply or Discard-Request packet?}
295    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188ae005fbe003b806f08c309d6d55531b6a}{PPP\_CODE\_ECHO\_REQ} ||
296       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4302d5cd359bf94f9af9e413db9bf929}{PPP\_CODE\_ECHO\_REP} ||
297       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a811138680a40b6a7f8eae50b2b623012}{PPP\_CODE\_DISCARD\_REQ})
298    \{
299       \textcolor{comment}{//Cast LCP packet}
300       \hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{PppEchoPacket} *p = (\hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{PppEchoPacket} *) packet;
301 
302       \textcolor{comment}{//Valid packet length?}
303       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{PppEchoPacket}))
304          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
305 
306       \textcolor{comment}{//Retrieve the length of data}
307       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a32588dc42d7123562908b651a0e6bf13}{PppEchoPacket});
308 
309       \textcolor{comment}{//Magic-Number}
310       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Magic-Number = %"} PRIu32 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a63baf217625b15caa7246af75b027380}{htonl}(p->magicNumber));
311       \textcolor{comment}{//Data}
312       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
313       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
314    \}
315    \textcolor{comment}{//Unknown packet?}
316    \textcolor{keywordflow}{else}
317    \{
318       \textcolor{comment}{//Retrieve the length of data}
319       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket});
320 
321       \textcolor{comment}{//Any data?}
322       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
323       \{
324          \textcolor{comment}{//Dump data}
325          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
326          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, packet->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
327       \}
328    \}
329 
330    \textcolor{comment}{//No error to report}
331    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
332 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_aa75a8008eec881e84a285169be02de71}\label{ppp__debug_8h_aa75a8008eec881e84a285169be02de71}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!ncp\+Dump\+Packet@{ncp\+Dump\+Packet}}
\index{ncp\+Dump\+Packet@{ncp\+Dump\+Packet}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{ncp\+Dump\+Packet()}{ncpDumpPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ncp\+Dump\+Packet (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2}{Ppp\+Protocol}}]{protocol }\end{DoxyParamCaption})}



Dump N\+CP packet for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em packet} & Pointer to the N\+CP packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\mbox{\tt in}  & {\em protocol} & Protocol field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 343 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
344 \{
345    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
346    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *label;
347 
348    \textcolor{comment}{//Make sure the NDP packet is valid}
349    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
350       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
351 
352    \textcolor{comment}{//Check the length field}
353    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
354       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
355    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
356       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
357 
358    \textcolor{comment}{//Save the length of the NDP packet}
359    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length);
360 
361    \textcolor{comment}{//Retrieve the name of the NDP packet}
362    \textcolor{keywordflow}{if}(packet->code < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_a1cc9269eba00897bcbd78b3bd7ac6802}{ncpCodeLabel}))
363       label = \hyperlink{ppp__debug_8c_a1cc9269eba00897bcbd78b3bd7ac6802}{ncpCodeLabel}[packet->code];
364    \textcolor{keywordflow}{else}
365       label = \textcolor{stringliteral}{"Unknown"};
366 
367    \textcolor{comment}{//Dump NDP packet header}
368    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Code = %"} PRIu8 \textcolor{stringliteral}{" (%s)\(\backslash\)r\(\backslash\)n"}, packet->code, label);
369    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Identifier = %"} PRIu8  \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, packet->identifier);
370    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Length = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length));
371 
372    \textcolor{comment}{//Configure-Request, Configure-Ack, Configure-Nak or Configure-Reject packet?}
373    \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a4e4279fdfcf8d81d216d58801f58d84d}{PPP\_CODE\_CONFIGURE\_REQ} ||
374       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a915e8fc9f7c9bacb22b54dbccd684591}{PPP\_CODE\_CONFIGURE\_ACK} ||
375       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188aed576599db22b88142cb2cd4e71986be}{PPP\_CODE\_CONFIGURE\_NAK} ||
376       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a5bd41f9dd646b4a1dd42c2f98f22cedd}{PPP\_CODE\_CONFIGURE\_REJ})
377    \{
378       \textcolor{comment}{//Cast NDP packet}
379       \hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p} = (\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket} *) packet;
380 
381       \textcolor{comment}{//Valid packet length?}
382       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket}))
383          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
384 
385       \textcolor{comment}{//Retrieve the length of the option list}
386       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a5f9516e80961edda7e2c0b9b964bdd66}{PppConfigurePacket});
387 
388       \textcolor{comment}{//IPCP protocol?}
389       \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol} == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2a1dbae0b4db670646438954a53f57254a}{PPP\_PROTOCOL\_IPCP})
390       \{
391          \textcolor{comment}{//Dump options}
392          error = \hyperlink{ppp__debug_8c_a5a0b25c11dabbf8412cab8657ee1904a}{ipcpDumpOptions}((\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) p->options, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
393          \textcolor{comment}{//Any error to report?}
394          \textcolor{keywordflow}{if}(error)
395             \textcolor{keywordflow}{return} error;
396       \}
397       \textcolor{comment}{//IPV6CP protocol?}
398       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol} == \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2abc85aaca4959631f37902c4c8f34146a}{PPP\_PROTOCOL\_IPV6CP})
399       \{
400          \textcolor{comment}{//Dump options}
401          error = \hyperlink{ppp__debug_8c_aa5335294a743cbcf3cbcb7ae03b08c3b}{ipv6cpDumpOptions}((\hyperlink{ppp_8h_a531e616dc92a1bc09e2b7596eae470c8}{PppOption} *) p->options, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
402          \textcolor{comment}{//Any error to report?}
403          \textcolor{keywordflow}{if}(error)
404             \textcolor{keywordflow}{return} error;
405       \}
406    \}
407    \textcolor{comment}{//Terminate-Request or Terminate-Ack packet?}
408    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a7471c8252f420930c98ee6a789724a2d}{PPP\_CODE\_TERMINATE\_REQ} ||
409       packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a6e7e46a330cfb72374afc3d09f275860}{PPP\_CODE\_TERMINATE\_ACK})
410    \{
411       \textcolor{comment}{//Cast NDP packet}
412       \hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket} *p = (\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket} *) packet;
413 
414       \textcolor{comment}{//Valid packet length?}
415       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket}))
416          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
417 
418       \textcolor{comment}{//Retrieve the length of data}
419       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_a224d9bad9d75f66f3d0284450ddf6fb4}{PppTerminatePacket});
420 
421       \textcolor{comment}{//Any data?}
422       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
423       \{
424          \textcolor{comment}{//Dump data}
425          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
426          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
427       \}
428    \}
429    \textcolor{comment}{//Code-Reject packet?}
430    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{ppp_8h_a961984e634b12a11d381115a46f14188a7635f2c8a624bbf7fcb8eea300082a7d}{PPP\_CODE\_CODE\_REJ})
431    \{
432       \textcolor{comment}{//Cast NDP packet}
433       \hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket} *p = (\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket} *) packet;
434 
435       \textcolor{comment}{//Valid packet length?}
436       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket}))
437          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
438 
439       \textcolor{comment}{//Retrieve the length of Rejected-Packet field}
440       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_ad05fe14ee4cca32c7b40f2cdf9c48a8d}{PppCodeRejPacket});
441 
442       \textcolor{comment}{//Rejected-Packet}
443       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Rejected-Packet (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
444       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->rejectedPacket, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
445    \}
446    \textcolor{comment}{//Unknown packet?}
447    \textcolor{keywordflow}{else}
448    \{
449       \textcolor{comment}{//Retrieve the length of data}
450       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket});
451 
452       \textcolor{comment}{//Any data?}
453       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
454       \{
455          \textcolor{comment}{//Dump data}
456          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
457          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, packet->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
458       \}
459    \}
460 
461    \textcolor{comment}{//No error to report}
462    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
463 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_afcad114edcc4fd1b512ba5d076ef819c}\label{ppp__debug_8h_afcad114edcc4fd1b512ba5d076ef819c}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!pap\+Dump\+Packet@{pap\+Dump\+Packet}}
\index{pap\+Dump\+Packet@{pap\+Dump\+Packet}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{pap\+Dump\+Packet()}{papDumpPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pap\+Dump\+Packet (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Dump P\+AP packet for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em packet} & Pointer to the P\+AP packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 473 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
474 \{
475    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *label;
476 
477    \textcolor{comment}{//Make sure the PAP packet is valid}
478    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
479       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
480 
481    \textcolor{comment}{//Check the length field}
482    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) > \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
483       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
484    \textcolor{keywordflow}{if}(\hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length) < \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket}))
485       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
486 
487    \textcolor{comment}{//Save the length of the PAP packet}
488    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length);
489 
490    \textcolor{comment}{//Retrieve the name of the PAP packet}
491    \textcolor{keywordflow}{if}(packet->code < \hyperlink{os__port_8h_aa1394a41d43c0f3fd30febe41c7bb340}{arraysize}(\hyperlink{ppp__debug_8c_a3623fd8b57617f4cb9918a804dc5e9d4}{papCodeLabel}))
492       label = \hyperlink{ppp__debug_8c_a3623fd8b57617f4cb9918a804dc5e9d4}{papCodeLabel}[packet->code];
493    \textcolor{keywordflow}{else}
494       label = \textcolor{stringliteral}{"Unknown"};
495 
496    \textcolor{comment}{//Dump PAP packet header}
497    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Code = %"} PRIu8 \textcolor{stringliteral}{" (%s)\(\backslash\)r\(\backslash\)n"}, packet->code, label);
498    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Identifier = %"} PRIu8  \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, packet->identifier);
499    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Length = %"} PRIu16 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(packet->length));
500 
501    \textcolor{comment}{//Authenticate-Request packet?}
502    \textcolor{keywordflow}{if}(packet->code == \hyperlink{pap_8h_a7266980582144d9130f5fb2217969023a31538f56c0b2888a031c38577ed69198}{PAP\_CODE\_AUTH\_REQ})
503    \{
504       \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *q;
505       \hyperlink{pap_8h_a2d534564c63bb9810129941217e5b9e8}{PapAuthReqPacket} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
506 
507       \textcolor{comment}{//Cast PAP packet}
508       p = (\hyperlink{pap_8h_a2d534564c63bb9810129941217e5b9e8}{PapAuthReqPacket} *) packet;
509 
510       \textcolor{comment}{//Valid packet length?}
511       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{pap_8h_a2d534564c63bb9810129941217e5b9e8}{PapAuthReqPacket}))
512          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
513 
514       \textcolor{comment}{//Peer-ID-Length field}
515       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Peer-ID-Length = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, p->peerIdLength);
516 
517       \textcolor{comment}{//Check the length of the Peer-ID field}
518       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < (\textcolor{keyword}{sizeof}(\hyperlink{pap_8h_a57e6f740c13c59f3ce639b0a3af6e19b}{PapAuthAckPacket}) + 1 + p->peerIdLength))
519          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
520 
521       \textcolor{comment}{//Peer-ID field}
522       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Peer-ID\(\backslash\)r\(\backslash\)n"});
523       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->peerId, p->peerIdLength);
524 
525       \textcolor{comment}{//Point to the Passwd-Length field}
526       q = p->peerId + p->peerIdLength;
527 
528       \textcolor{comment}{//Passwd-Length field}
529       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Passwd-Length = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, q[0]);
530 
531       \textcolor{comment}{//Check the length of the Password field}
532       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < (\textcolor{keyword}{sizeof}(\hyperlink{pap_8h_a57e6f740c13c59f3ce639b0a3af6e19b}{PapAuthAckPacket}) + 1 + p->peerIdLength + q[0]))
533          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
534 
535       \textcolor{comment}{//Password field}
536       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Password\(\backslash\)r\(\backslash\)n"});
537       \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, q + 1, q[0]);
538    \}
539    \textcolor{comment}{//Authenticate-Ack or Authenticate-Nak packet?}
540    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(packet->code == \hyperlink{pap_8h_a7266980582144d9130f5fb2217969023ac10bc7a277930e04c324a238ee12c52a}{PAP\_CODE\_AUTH\_ACK} ||
541       packet->code == \hyperlink{pap_8h_a7266980582144d9130f5fb2217969023a86f72394d123bf3ed7c87443a4970ffd}{PAP\_CODE\_AUTH\_NAK})
542    \{
543       \hyperlink{pap_8h_a57e6f740c13c59f3ce639b0a3af6e19b}{PapAuthAckPacket} *\hyperlink{ndp_8h_a6519522ad9a6f45e7a8d25d31392a977}{p};
544 
545       \textcolor{comment}{//Cast PAP packet}
546       p = (\hyperlink{pap_8h_a57e6f740c13c59f3ce639b0a3af6e19b}{PapAuthAckPacket} *) packet;
547 
548       \textcolor{comment}{//Valid packet length?}
549       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < \textcolor{keyword}{sizeof}(\hyperlink{pap_8h_a57e6f740c13c59f3ce639b0a3af6e19b}{PapAuthAckPacket}))
550          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
551 
552       \textcolor{comment}{//Msg-Length field}
553       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Msg-Length = %"} PRIu8 \textcolor{stringliteral}{"\(\backslash\)r\(\backslash\)n"}, p->msgLength);
554 
555       \textcolor{comment}{//Check the length of the Message field}
556       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} < (\textcolor{keyword}{sizeof}(\hyperlink{pap_8h_a57e6f740c13c59f3ce639b0a3af6e19b}{PapAuthAckPacket}) + p->msgLength))
557          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
558 
559       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
560       \{
561          \textcolor{comment}{//Message field}
562          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Message\(\backslash\)r\(\backslash\)n"});
563          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, p->message, p->msgLength);
564       \}
565    \}
566    \textcolor{comment}{//Unknown packet?}
567    \textcolor{keywordflow}{else}
568    \{
569       \textcolor{comment}{//Retrieve the length of data}
570       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \textcolor{keyword}{sizeof}(\hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{PppPacket});
571 
572       \textcolor{comment}{//Any data?}
573       \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
574       \{
575          \textcolor{comment}{//Dump data}
576          \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Data (%"} \hyperlink{compiler__port_8h_a2b7b0557dc6cd786df02dafbb51f5292}{PRIuSIZE} \textcolor{stringliteral}{" bytes)\(\backslash\)r\(\backslash\)n"}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
577          \hyperlink{debug_8h_a1f71019169d85407d8827300ed43bdf0}{TRACE\_DEBUG\_ARRAY}(\textcolor{stringliteral}{"    "}, packet->data, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
578       \}
579    \}
580 
581    \textcolor{comment}{//No error to report}
582    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
583 \}
\end{DoxyCode}
\mbox{\Hypertarget{ppp__debug_8h_aebeb2591b3799b0ede290881fdd67e78}\label{ppp__debug_8h_aebeb2591b3799b0ede290881fdd67e78}} 
\index{ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}!ppp\+Dump\+Packet@{ppp\+Dump\+Packet}}
\index{ppp\+Dump\+Packet@{ppp\+Dump\+Packet}!ppp\+\_\+debug.\+h@{ppp\+\_\+debug.\+h}}
\subsubsection{\texorpdfstring{ppp\+Dump\+Packet()}{pppDumpPacket()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} ppp\+Dump\+Packet (\begin{DoxyParamCaption}\item[{const \hyperlink{ppp_8h_aa975a68f06316e1db0de962a31e30c2e}{Ppp\+Packet} $\ast$}]{packet,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2}{Ppp\+Protocol}}]{protocol }\end{DoxyParamCaption})}



Dump L\+C\+P/\+N\+CP packet for debugging purpose. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em packet} & Pointer to the L\+CP packet \\
\hline
\mbox{\tt in}  & {\em length} & Length of the packet, in bytes \\
\hline
\mbox{\tt in}  & {\em protocol} & Protocol field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 143 of file ppp\+\_\+debug.\+c.


\begin{DoxyCode}
144 \{
145    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
146 
147    \textcolor{comment}{//Check protocol field}
148    \textcolor{keywordflow}{switch}(\hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol})
149    \{
150    \textcolor{comment}{//LCP packet?}
151    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2aa16ec94a0acadd78f8c120d8bdd45dc5}{PPP\_PROTOCOL\_LCP}:
152       error = \hyperlink{ppp__debug_8c_a804c7ea1b46f753e6d9b35bc7f5bf3e0}{lcpDumpPacket}(packet, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
153       \textcolor{keywordflow}{break};
154    \textcolor{comment}{//NCP packet?}
155    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2a1dbae0b4db670646438954a53f57254a}{PPP\_PROTOCOL\_IPCP}:
156    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2abc85aaca4959631f37902c4c8f34146a}{PPP\_PROTOCOL\_IPV6CP}:
157       error = \hyperlink{ppp__debug_8c_aa75a8008eec881e84a285169be02de71}{ncpDumpPacket}(packet, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, \hyperlink{dhcpv6__common_8h_ad124d3d2e02c729afa303c775295278e}{protocol});
158       \textcolor{keywordflow}{break};
159    \textcolor{comment}{//PAP packet?}
160    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2acf222ed31e41d910b4b75d9eb58db3a2}{PPP\_PROTOCOL\_PAP}:
161       error = \hyperlink{ppp__debug_8c_afcad114edcc4fd1b512ba5d076ef819c}{papDumpPacket}(packet, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
162       \textcolor{keywordflow}{break};
163    \textcolor{comment}{//CHAP packet?}
164    \textcolor{keywordflow}{case} \hyperlink{ppp_8h_a5d2e3565b503cd5cb131aaff4e0ba9c2ac0897e91a9ab8cedc751087ef1b65a1d}{PPP\_PROTOCOL\_CHAP}:
165       error = \hyperlink{ppp__debug_8c_af818170c9e413f88dde94dac2bb3e191}{chapDumpPacket}(packet, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
166       \textcolor{keywordflow}{break};
167    \textcolor{comment}{//Unknown protocol?}
168    \textcolor{keywordflow}{default}:
169       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
170       \textcolor{keywordflow}{break};
171    \}
172 
173    \textcolor{comment}{//Return status code}
174    \textcolor{keywordflow}{return} error;
175 \}
\end{DoxyCode}
