\hypertarget{rc6_8h}{}\section{cyclone\+\_\+crypto/cipher/rc6.h File Reference}
\label{rc6_8h}\index{cyclone\+\_\+crypto/cipher/rc6.\+h@{cyclone\+\_\+crypto/cipher/rc6.\+h}}


R\+C6-\/32/20 block cipher.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structRc6Context}{Rc6\+Context}
\begin{DoxyCompactList}\small\item\em R\+C6 algorithm context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{rc6_8h_a5f38e7629753e609535847bd617c95ed}{R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~16
\item 
\#define \hyperlink{rc6_8h_ae6868b69ce9bb58bb05dfc9f03567402}{R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}~32
\item 
\#define \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS}~20
\item 
\#define \hyperlink{rc6_8h_a06e8cb27cd3a292fa4ff47c0c10686a6}{R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}~(\&\hyperlink{rc6_8h_a08c03023fda88d58bc401769ac507489}{rc6\+Cipher\+Algo})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{rc6_8h_a59631d8848eda172ce33336d381e833f}{rc6\+Init} (\hyperlink{structRc6Context}{Rc6\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$key, size\+\_\+t key\+Len)
\begin{DoxyCompactList}\small\item\em Initialize a R\+C6 context using the supplied key. \end{DoxyCompactList}\item 
void \hyperlink{rc6_8h_ade23b95e25df07524ba9a283432b4f36}{rc6\+Encrypt\+Block} (\hyperlink{structRc6Context}{Rc6\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypt a 16-\/byte block using R\+C6 algorithm. \end{DoxyCompactList}\item 
void \hyperlink{rc6_8h_ac7cdec6dc6892e7938991304a7c4f66a}{rc6\+Decrypt\+Block} (\hyperlink{structRc6Context}{Rc6\+Context} $\ast$context, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$input, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypt a 16-\/byte block using R\+C6 algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structCipherAlgo}{Cipher\+Algo} \hyperlink{rc6_8h_a08c03023fda88d58bc401769ac507489}{rc6\+Cipher\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+C6-\/32/20 block cipher. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{rc6_8h_a5f38e7629753e609535847bd617c95ed}\label{rc6_8h_a5f38e7629753e609535847bd617c95ed}} 
\index{rc6.\+h@{rc6.\+h}!R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}}
\index{R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE@{R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}{RC6\_BLOCK\_SIZE}}
{\footnotesize\ttfamily \#define R\+C6\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE~16}



Definition at line 38 of file rc6.\+h.

\mbox{\Hypertarget{rc6_8h_a06e8cb27cd3a292fa4ff47c0c10686a6}\label{rc6_8h_a06e8cb27cd3a292fa4ff47c0c10686a6}} 
\index{rc6.\+h@{rc6.\+h}!R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}}
\index{R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO@{R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO}{RC6\_CIPHER\_ALGO}}
{\footnotesize\ttfamily \#define R\+C6\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+L\+GO~(\&\hyperlink{rc6_8h_a08c03023fda88d58bc401769ac507489}{rc6\+Cipher\+Algo})}



Definition at line 45 of file rc6.\+h.

\mbox{\Hypertarget{rc6_8h_ae6868b69ce9bb58bb05dfc9f03567402}\label{rc6_8h_ae6868b69ce9bb58bb05dfc9f03567402}} 
\index{rc6.\+h@{rc6.\+h}!R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE@{R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}}
\index{R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE@{R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}{RC6\_MAX\_KEY\_SIZE}}
{\footnotesize\ttfamily \#define R\+C6\+\_\+\+M\+A\+X\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE~32}



Definition at line 40 of file rc6.\+h.

\mbox{\Hypertarget{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}\label{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}} 
\index{rc6.\+h@{rc6.\+h}!R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS@{R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS}}
\index{R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS@{R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS}{RC6\_NB\_ROUNDS}}
{\footnotesize\ttfamily \#define R\+C6\+\_\+\+N\+B\+\_\+\+R\+O\+U\+N\+DS~20}



Definition at line 42 of file rc6.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{rc6_8h_ac7cdec6dc6892e7938991304a7c4f66a}\label{rc6_8h_ac7cdec6dc6892e7938991304a7c4f66a}} 
\index{rc6.\+h@{rc6.\+h}!rc6\+Decrypt\+Block@{rc6\+Decrypt\+Block}}
\index{rc6\+Decrypt\+Block@{rc6\+Decrypt\+Block}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{rc6\+Decrypt\+Block()}{rc6DecryptBlock()}}
{\footnotesize\ttfamily void rc6\+Decrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structRc6Context}{Rc6\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Decrypt a 16-\/byte block using R\+C6 algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C6 context \\
\hline
\mbox{\tt in}  & {\em input} & Ciphertext block to decrypt \\
\hline
\mbox{\tt out}  & {\em output} & Plaintext block resulting from decryption \\
\hline
\end{DoxyParams}


Definition at line 201 of file rc6.\+c.


\begin{DoxyCode}
202 \{
203    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
204    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
205    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u;
206 
207    \textcolor{comment}{//Load the 4 working registers with the ciphertext}
208    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 0);
209    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 4);
210    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 8);
211    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} d = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 12);
212 
213    \textcolor{comment}{//First, update C and A}
214    c -= context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 3];
215    a -= context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 2];
216 
217    \textcolor{comment}{//Apply 20 rounds}
218    \textcolor{keywordflow}{for}(i = \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS}; i > 0; i--)
219    \{
220       t = d;
221       d = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
222       c = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
223       b = \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
224       a = \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
225 
226       u = (d * (2 * d + 1));
227       u = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(u, 5);
228 
229       t = (b * (2 * b + 1));
230       t = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(t, 5);
231 
232       c -= context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * i + 1];
233       c = \hyperlink{cyclone__crypto_2core_2crypto_8h_a1e84182b178c5f242e4ba717e6dcd0e5}{ROR32}(c, t % 32) ^ u;
234 
235       a -= context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * i];
236       a = \hyperlink{cyclone__crypto_2core_2crypto_8h_a1e84182b178c5f242e4ba717e6dcd0e5}{ROR32}(a, u % 32) ^ \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
237    \}
238 
239    \textcolor{comment}{//Update D and B}
240    d -= context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[1];
241    b -= context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[0];
242 
243    \textcolor{comment}{//The resulting value is the plaintext}
244    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(a, output + 0);
245    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(b, output + 4);
246    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(c, output + 8);
247    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(d, output + 12);
248 \}
\end{DoxyCode}
\mbox{\Hypertarget{rc6_8h_ade23b95e25df07524ba9a283432b4f36}\label{rc6_8h_ade23b95e25df07524ba9a283432b4f36}} 
\index{rc6.\+h@{rc6.\+h}!rc6\+Encrypt\+Block@{rc6\+Encrypt\+Block}}
\index{rc6\+Encrypt\+Block@{rc6\+Encrypt\+Block}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{rc6\+Encrypt\+Block()}{rc6EncryptBlock()}}
{\footnotesize\ttfamily void rc6\+Encrypt\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structRc6Context}{Rc6\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{input,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{output }\end{DoxyParamCaption})}



Encrypt a 16-\/byte block using R\+C6 algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C6 context \\
\hline
\mbox{\tt in}  & {\em input} & Plaintext block to encrypt \\
\hline
\mbox{\tt out}  & {\em output} & Ciphertext block resulting from encryption \\
\hline
\end{DoxyParams}


Definition at line 144 of file rc6.\+c.


\begin{DoxyCode}
145 \{
146    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
147    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
148    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u;
149 
150    \textcolor{comment}{//Load the 4 working registers with the plaintext}
151    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a} = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 0);
152    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b} = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 4);
153    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 8);
154    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} d = \hyperlink{cpu__endian_8h_a7a6ecaee0bc600cae5a7dead20594920}{LOAD32LE}(input + 12);
155 
156    \textcolor{comment}{//First, update B and D}
157    b += context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[0];
158    d += context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[1];
159 
160    \textcolor{comment}{//Apply 20 rounds}
161    \textcolor{keywordflow}{for}(i = 1; i <= \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS}; i++)
162    \{
163       t = (b * (2 * b + 1));
164       t = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(t, 5);
165 
166       u = (d * (2 * d + 1));
167       u = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(u, 5);
168 
169       a ^= \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
170       a = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(a, u % 32) + context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * i];
171 
172       c ^= u;
173       c = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(c, t % 32) + context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * i + 1];
174 
175       t = \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
176       a = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
177       b = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
178       c = d;
179       d = \hyperlink{llmnr__common_8h_a2d03918f4f9edabaf3c9f43abcc2d85b}{t};
180    \}
181 
182    \textcolor{comment}{//Update A and C}
183    a += context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 2];
184    c += context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 3];
185 
186    \textcolor{comment}{//The resulting value is the ciphertext}
187    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(a, output + 0);
188    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(b, output + 4);
189    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(c, output + 8);
190    \hyperlink{cpu__endian_8h_a9dc2aacccbeaa4c76dc3870ef4486a88}{STORE32LE}(d, output + 12);
191 \}
\end{DoxyCode}
\mbox{\Hypertarget{rc6_8h_a59631d8848eda172ce33336d381e833f}\label{rc6_8h_a59631d8848eda172ce33336d381e833f}} 
\index{rc6.\+h@{rc6.\+h}!rc6\+Init@{rc6\+Init}}
\index{rc6\+Init@{rc6\+Init}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{rc6\+Init()}{rc6Init()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} rc6\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structRc6Context}{Rc6\+Context} $\ast$}]{context,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+Len }\end{DoxyParamCaption})}



Initialize a R\+C6 context using the supplied key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the R\+C6 context to initialize \\
\hline
\mbox{\tt in}  & {\em key} & Pointer to the key \\
\hline
\mbox{\tt in}  & {\em key\+Len} & Length of the key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 72 of file rc6.\+c.


\begin{DoxyCode}
73 \{
74    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
75    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
76    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
77    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{md2_8c_adf356ff381033f761b7de5f76e763a45}{s};
78    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} v;
79    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a};
80    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
81 
82    \textcolor{comment}{//Check parameters}
83    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || key == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
84       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
85 
86    \textcolor{comment}{//Invalid key length?}
87    \textcolor{keywordflow}{if}(keyLen > \hyperlink{rc6_8h_ae6868b69ce9bb58bb05dfc9f03567402}{RC6\_MAX\_KEY\_SIZE})
88       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca3764b2929469f1eb1bf7af50b40df62f}{ERROR\_INVALID\_KEY\_LENGTH};
89 
90    \textcolor{comment}{//Convert the secret key from bytes to words}
91    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(context->\hyperlink{structRc6Context_a57e222dc7a0b7dfe4c0df8f128199545}{l}, 0, \hyperlink{rc6_8h_ae6868b69ce9bb58bb05dfc9f03567402}{RC6\_MAX\_KEY\_SIZE});
92    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structRc6Context_a57e222dc7a0b7dfe4c0df8f128199545}{l}, key, keyLen);
93 
94    \textcolor{comment}{//Calculate the length of the key in words}
95    c = (keyLen > 0) ? (keyLen + 3) / 4 : 1;
96 
97    \textcolor{comment}{//Initialize the first element of S}
98    context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[0] = \hyperlink{rc6_8c_a8ae5e079e0dffa935e988d0658ac4a0a}{P32};
99 
100    \textcolor{comment}{//Initialize array S to a particular fixed pseudo random bit pattern}
101    \textcolor{keywordflow}{for}(i = 1; i < (2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 4); i++)
102    \{
103       context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[i] = context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[i - 1] + \hyperlink{rc6_8c_ae9461232471930a4942ec8ce9778ee24}{Q32};
104    \}
105 
106    \textcolor{comment}{//Initialize variables}
107    i = 0;
108    j = 0;
109    a = 0;
110    b = 0;
111 
112    \textcolor{comment}{//Number of iterations}
113    v = 3 * \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(c, 2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 4);
114 
115    \textcolor{comment}{//Key expansion}
116    \textcolor{keywordflow}{for}(s = 0; s < v; s++)
117    \{
118       context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[i] += a + \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
119       context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[i] = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[i], 3);
120       a = context->\hyperlink{structRc6Context_a984b8519b232e9041568d2ccaef2f451}{s}[i];
121 
122       context->\hyperlink{structRc6Context_a57e222dc7a0b7dfe4c0df8f128199545}{l}[j] += a + \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
123       context->\hyperlink{structRc6Context_a57e222dc7a0b7dfe4c0df8f128199545}{l}[j] = \hyperlink{cyclone__crypto_2core_2crypto_8h_ad5e52b5ea688101f11d0bf34dc3a8b4b}{ROL32}(context->\hyperlink{structRc6Context_a57e222dc7a0b7dfe4c0df8f128199545}{l}[j], (a + b) % 32);
124       b = context->\hyperlink{structRc6Context_a57e222dc7a0b7dfe4c0df8f128199545}{l}[j];
125 
126       \textcolor{keywordflow}{if}(++i >= (2 * \hyperlink{rc6_8h_a36bcca60e56650daa3b834e6d37b73bc}{RC6\_NB\_ROUNDS} + 4))
127          i = 0;
128       \textcolor{keywordflow}{if}(++j >= c)
129          j = 0;
130    \}
131 
132    \textcolor{comment}{//No error to report}
133    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
134 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{rc6_8h_a08c03023fda88d58bc401769ac507489}\label{rc6_8h_a08c03023fda88d58bc401769ac507489}} 
\index{rc6.\+h@{rc6.\+h}!rc6\+Cipher\+Algo@{rc6\+Cipher\+Algo}}
\index{rc6\+Cipher\+Algo@{rc6\+Cipher\+Algo}!rc6.\+h@{rc6.\+h}}
\subsubsection{\texorpdfstring{rc6\+Cipher\+Algo}{rc6CipherAlgo}}
{\footnotesize\ttfamily const \hyperlink{structCipherAlgo}{Cipher\+Algo} rc6\+Cipher\+Algo}



Definition at line 50 of file rc6.\+c.

