\hypertarget{snmp__agent__vacm_8c}{}\section{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+vacm.c File Reference}
\label{snmp__agent__vacm_8c}\index{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+vacm.\+c@{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+vacm.\+c}}


View-\/based Access Control Model (V\+A\+CM) for S\+N\+MP.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent\+\_\+vacm.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{snmp__agent__vacm_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__vacm_8c_a7fd7c986d68a6e1253878108397c78e8}{snmp\+Is\+Access\+Allowed} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, const \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len)
\begin{DoxyCompactList}\small\item\em Access control verification. \end{DoxyCompactList}\item 
\hyperlink{structSnmpGroupEntry}{Snmp\+Group\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_a2f852a60dcafbf0b311726bc8e0a255c}{snmp\+Create\+Group\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Create a new group entry. \end{DoxyCompactList}\item 
\hyperlink{structSnmpGroupEntry}{Snmp\+Group\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_ae62d86e2a0e05b31d66602f6b884e842}{snmp\+Find\+Group\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} security\+Model, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$security\+Name, size\+\_\+t security\+Name\+Len)
\begin{DoxyCompactList}\small\item\em Search the group table. \end{DoxyCompactList}\item 
\hyperlink{structSnmpAccessEntry}{Snmp\+Access\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_a61ba0b95e342f8b5416fa8bbb3507d3c}{snmp\+Create\+Access\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Create a new access entry. \end{DoxyCompactList}\item 
\hyperlink{structSnmpAccessEntry}{Snmp\+Access\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_a16bfa3443eca536bcb326f47e117dd41}{snmp\+Find\+Access\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$group\+Name, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{ndp_8h_adf7f706b22c25e9ed77265df8517f6fc}{context\+Prefix}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} security\+Model, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} security\+Level)
\begin{DoxyCompactList}\small\item\em Search the access table for a given entry. \end{DoxyCompactList}\item 
\hyperlink{structSnmpAccessEntry}{Snmp\+Access\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_ab2d76d86075956d21a7539533df6c3a5}{snmp\+Select\+Access\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$group\+Name, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$context\+Name, size\+\_\+t context\+Name\+Len, \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{Snmp\+Security\+Model} security\+Model, \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612}{Snmp\+Security\+Level} security\+Level)
\begin{DoxyCompactList}\small\item\em Find an access entry that matches the selection criteria. \end{DoxyCompactList}\item 
\hyperlink{structSnmpViewEntry}{Snmp\+View\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_a0c0146554c1b728d85beebe146735091}{snmp\+Create\+View\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Create a new view entry. \end{DoxyCompactList}\item 
\hyperlink{structSnmpViewEntry}{Snmp\+View\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_afd75c739785a988749fc503fcd64d325}{snmp\+Find\+View\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$view\+Name, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$subtree, size\+\_\+t subtree\+Len)
\begin{DoxyCompactList}\small\item\em Search the view table for a given entry. \end{DoxyCompactList}\item 
\hyperlink{structSnmpViewEntry}{Snmp\+View\+Entry} $\ast$ \hyperlink{snmp__agent__vacm_8c_a9cb91040e4cec40e84fca2e6b23aa682}{snmp\+Select\+View\+Entry} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$view\+Name, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, size\+\_\+t oid\+Len)
\begin{DoxyCompactList}\small\item\em Find a view entry that matches the selection criteria. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
View-\/based Access Control Model (V\+A\+CM) for S\+N\+MP. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
This module implements the View-\/based Access Control Model (V\+A\+CM) for Simple Network Management Protocol (S\+N\+MP). Refer to R\+FC 3415 for complete details

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{snmp__agent__vacm_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{snmp__agent__vacm_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 37 of file snmp\+\_\+agent\+\_\+vacm.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{snmp__agent__vacm_8c_a61ba0b95e342f8b5416fa8bbb3507d3c}\label{snmp__agent__vacm_8c_a61ba0b95e342f8b5416fa8bbb3507d3c}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Create\+Access\+Entry@{snmp\+Create\+Access\+Entry}}
\index{snmp\+Create\+Access\+Entry@{snmp\+Create\+Access\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Create\+Access\+Entry()}{snmpCreateAccessEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpAccessEntry}{Snmp\+Access\+Entry}$\ast$ snmp\+Create\+Access\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Create a new access entry. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the newly created entry 
\end{DoxyReturn}


Definition at line 317 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
318 \{
319    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
320    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *entry;
321 
322    \textcolor{comment}{//Initialize pointer}
323    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
324 
325    \textcolor{comment}{//Loop through the list of access rights}
326    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a8fbe14dcee7eac378b325a34dd7ea056}{SNMP\_AGENT\_ACCESS\_TABLE\_SIZE}; i++)
327    \{
328       \textcolor{comment}{//Check current status}
329       \textcolor{keywordflow}{if}(context->accessTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
330       \{
331          \textcolor{comment}{//An unused entry has been found}
332          entry = &context->accessTable[i];
333          \textcolor{comment}{//We are done}
334          \textcolor{keywordflow}{break};
335       \}
336    \}
337 
338    \textcolor{comment}{//Check whether the group table runs out of space}
339    \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
340    \{
341       \textcolor{comment}{//Loop through the list of access rights}
342       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a8fbe14dcee7eac378b325a34dd7ea056}{SNMP\_AGENT\_ACCESS\_TABLE\_SIZE}; i++)
343       \{
344          \textcolor{comment}{//Check current status}
345          \textcolor{keywordflow}{if}(context->accessTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097ab6c550e32b731ff9573ce8db2f299a2b}{MIB\_ROW\_STATUS\_NOT\_READY})
346          \{
347             \textcolor{comment}{//Reuse the current entry}
348             entry = &context->accessTable[i];
349             \textcolor{comment}{//We are done}
350             \textcolor{keywordflow}{break};
351          \}
352       \}
353    \}
354 
355    \textcolor{comment}{//Return a pointer to the newly created entry}
356    \textcolor{keywordflow}{return} entry;
357 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_a2f852a60dcafbf0b311726bc8e0a255c}\label{snmp__agent__vacm_8c_a2f852a60dcafbf0b311726bc8e0a255c}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Create\+Group\+Entry@{snmp\+Create\+Group\+Entry}}
\index{snmp\+Create\+Group\+Entry@{snmp\+Create\+Group\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Create\+Group\+Entry()}{snmpCreateGroupEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpGroupEntry}{Snmp\+Group\+Entry}$\ast$ snmp\+Create\+Group\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Create a new group entry. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the newly created entry 
\end{DoxyReturn}


Definition at line 219 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
220 \{
221    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
222    \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *entry;
223 
224    \textcolor{comment}{//Initialize pointer}
225    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
226 
227    \textcolor{comment}{//Loop through the list of groups}
228    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a51c46973cabcfc46d84b0dbeb9365752}{SNMP\_AGENT\_GROUP\_TABLE\_SIZE}; i++)
229    \{
230       \textcolor{comment}{//Check current status}
231       \textcolor{keywordflow}{if}(context->groupTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
232       \{
233          \textcolor{comment}{//An unused entry has been found}
234          entry = &context->groupTable[i];
235          \textcolor{comment}{//We are done}
236          \textcolor{keywordflow}{break};
237       \}
238    \}
239 
240    \textcolor{comment}{//Check whether the group table runs out of space}
241    \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
242    \{
243       \textcolor{comment}{//Loop through the list of groups}
244       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a51c46973cabcfc46d84b0dbeb9365752}{SNMP\_AGENT\_GROUP\_TABLE\_SIZE}; i++)
245       \{
246          \textcolor{comment}{//Check current status}
247          \textcolor{keywordflow}{if}(context->groupTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097ab6c550e32b731ff9573ce8db2f299a2b}{MIB\_ROW\_STATUS\_NOT\_READY})
248          \{
249             \textcolor{comment}{//Reuse the current entry}
250             entry = &context->groupTable[i];
251             \textcolor{comment}{//We are done}
252             \textcolor{keywordflow}{break};
253          \}
254       \}
255    \}
256 
257    \textcolor{comment}{//Return a pointer to the newly created entry}
258    \textcolor{keywordflow}{return} entry;
259 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_a0c0146554c1b728d85beebe146735091}\label{snmp__agent__vacm_8c_a0c0146554c1b728d85beebe146735091}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Create\+View\+Entry@{snmp\+Create\+View\+Entry}}
\index{snmp\+Create\+View\+Entry@{snmp\+Create\+View\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Create\+View\+Entry()}{snmpCreateViewEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpViewEntry}{Snmp\+View\+Entry}$\ast$ snmp\+Create\+View\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Create a new view entry. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the newly created entry 
\end{DoxyReturn}


Definition at line 518 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
519 \{
520    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
521    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *entry;
522 
523    \textcolor{comment}{//Initialize pointer}
524    entry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
525 
526    \textcolor{comment}{//Loop through the list of MIB views}
527    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a3bd40db59e400b8c4000a718a6da88e1}{SNMP\_AGENT\_VIEW\_TABLE\_SIZE}; i++)
528    \{
529       \textcolor{comment}{//Check current status}
530       \textcolor{keywordflow}{if}(context->viewTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
531       \{
532          \textcolor{comment}{//An unused entry has been found}
533          entry = &context->viewTable[i];
534          \textcolor{comment}{//We are done}
535          \textcolor{keywordflow}{break};
536       \}
537    \}
538 
539    \textcolor{comment}{//Check whether the group table runs out of space}
540    \textcolor{keywordflow}{if}(entry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
541    \{
542       \textcolor{comment}{//Loop through the list of MIB views}
543       \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a3bd40db59e400b8c4000a718a6da88e1}{SNMP\_AGENT\_VIEW\_TABLE\_SIZE}; i++)
544       \{
545          \textcolor{comment}{//Check current status}
546          \textcolor{keywordflow}{if}(context->viewTable[i].status == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097ab6c550e32b731ff9573ce8db2f299a2b}{MIB\_ROW\_STATUS\_NOT\_READY})
547          \{
548             \textcolor{comment}{//Reuse the current entry}
549             entry = &context->viewTable[i];
550             \textcolor{comment}{//We are done}
551             \textcolor{keywordflow}{break};
552          \}
553       \}
554    \}
555 
556    \textcolor{comment}{//Return a pointer to the newly created entry}
557    \textcolor{keywordflow}{return} entry;
558 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_a16bfa3443eca536bcb326f47e117dd41}\label{snmp__agent__vacm_8c_a16bfa3443eca536bcb326f47e117dd41}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Find\+Access\+Entry@{snmp\+Find\+Access\+Entry}}
\index{snmp\+Find\+Access\+Entry@{snmp\+Find\+Access\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Find\+Access\+Entry()}{snmpFindAccessEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpAccessEntry}{Snmp\+Access\+Entry}$\ast$ snmp\+Find\+Access\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{group\+Name,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{context\+Prefix,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{security\+Model,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{security\+Level }\end{DoxyParamCaption})}



Search the access table for a given entry. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em group\+Name} & Group name \\
\hline
\mbox{\tt in}  & {\em context\+Prefix} & Context name prefix \\
\hline
\mbox{\tt in}  & {\em security\+Model} & Security model \\
\hline
\mbox{\tt in}  & {\em security\+Level} & Security level \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the matching entry 
\end{DoxyReturn}


Definition at line 370 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
373 \{
374    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
375    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *entry;
376 
377    \textcolor{comment}{//Loop through the list of access rights}
378    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a8fbe14dcee7eac378b325a34dd7ea056}{SNMP\_AGENT\_ACCESS\_TABLE\_SIZE}; i++)
379    \{
380       \textcolor{comment}{//Point to the current entry}
381       entry = &context->accessTable[i];
382 
383       \textcolor{comment}{//Check current status}
384       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
385       \{
386          \textcolor{comment}{//Compare group name}
387          \textcolor{keywordflow}{if}(!strcmp(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, groupName))
388          \{
389             \textcolor{comment}{//Compare context name prefix}
390             \textcolor{keywordflow}{if}(!strcmp(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, \hyperlink{ndp_8h_adf7f706b22c25e9ed77265df8517f6fc}{contextPrefix}))
391             \{
392                \textcolor{comment}{//Compare security model and security level}
393                \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} == securityModel &&
394                   entry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel} == securityLevel)
395                \{
396                   \textcolor{comment}{//A matching entry has been found}
397                   \textcolor{keywordflow}{break};
398                \}
399             \}
400          \}
401       \}
402    \}
403 
404    \textcolor{comment}{//Return a pointer to the matching entry}
405    \textcolor{keywordflow}{if}(i < SNMP\_AGENT\_ACCESS\_TABLE\_SIZE)
406       \textcolor{keywordflow}{return} entry;
407    \textcolor{keywordflow}{else}
408       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
409 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_ae62d86e2a0e05b31d66602f6b884e842}\label{snmp__agent__vacm_8c_ae62d86e2a0e05b31d66602f6b884e842}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Find\+Group\+Entry@{snmp\+Find\+Group\+Entry}}
\index{snmp\+Find\+Group\+Entry@{snmp\+Find\+Group\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Find\+Group\+Entry()}{snmpFindGroupEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpGroupEntry}{Snmp\+Group\+Entry}$\ast$ snmp\+Find\+Group\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{security\+Model,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{security\+Name,  }\item[{size\+\_\+t}]{security\+Name\+Len }\end{DoxyParamCaption})}



Search the group table. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em security\+Model} & Security model \\
\hline
\mbox{\tt in}  & {\em security\+Name} & Pointer to the security name \\
\hline
\mbox{\tt in}  & {\em security\+Name\+Len} & Length of the security name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the matching entry 
\end{DoxyReturn}


Definition at line 271 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
273 \{
274    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
275    \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *entry;
276 
277    \textcolor{comment}{//Loop through the list of groups}
278    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a51c46973cabcfc46d84b0dbeb9365752}{SNMP\_AGENT\_GROUP\_TABLE\_SIZE}; i++)
279    \{
280       \textcolor{comment}{//Point to the current entry}
281       entry = &context->groupTable[i];
282 
283       \textcolor{comment}{//Check current status}
284       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpGroupEntry_a4ef2232ee93ed76fc09656ca669db373}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
285       \{
286          \textcolor{comment}{//Compare security model}
287          \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpGroupEntry_a49d7c30c44a6ee54b7febef1e0fe2e2f}{securityModel} == securityModel)
288          \{
289             \textcolor{comment}{//Check the length of the security name}
290             \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}) == securityNameLen)
291             \{
292                \textcolor{comment}{//Compare security name}
293                \textcolor{keywordflow}{if}(!strncmp(entry->\hyperlink{structSnmpGroupEntry_a5e747f5e2226fd1e218689b5bac75344}{securityName}, securityName, securityNameLen))
294                \{
295                   \textcolor{comment}{//A matching entry has been found}
296                   \textcolor{keywordflow}{break};
297                \}
298             \}
299          \}
300       \}
301    \}
302 
303    \textcolor{comment}{//Any matching entry found?}
304    \textcolor{keywordflow}{if}(i < SNMP\_AGENT\_GROUP\_TABLE\_SIZE)
305       \textcolor{keywordflow}{return} entry;
306    \textcolor{keywordflow}{else}
307       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
308 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_afd75c739785a988749fc503fcd64d325}\label{snmp__agent__vacm_8c_afd75c739785a988749fc503fcd64d325}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Find\+View\+Entry@{snmp\+Find\+View\+Entry}}
\index{snmp\+Find\+View\+Entry@{snmp\+Find\+View\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Find\+View\+Entry()}{snmpFindViewEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpViewEntry}{Snmp\+View\+Entry}$\ast$ snmp\+Find\+View\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{view\+Name,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{subtree,  }\item[{size\+\_\+t}]{subtree\+Len }\end{DoxyParamCaption})}



Search the view table for a given entry. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em view\+Name} & View name \\
\hline
\mbox{\tt in}  & {\em subtree} & Pointer to the M\+IB subtree \\
\hline
\mbox{\tt in}  & {\em subtree\+Len} & Length of the M\+IB subtree \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the matching entry 
\end{DoxyReturn}


Definition at line 570 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
572 \{
573    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
574    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *entry;
575 
576    \textcolor{comment}{//Loop through the list of MIB views}
577    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a3bd40db59e400b8c4000a718a6da88e1}{SNMP\_AGENT\_VIEW\_TABLE\_SIZE}; i++)
578    \{
579       \textcolor{comment}{//Point to the current entry}
580       entry = &context->viewTable[i];
581 
582       \textcolor{comment}{//Check current status}
583       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
584       \{
585          \textcolor{comment}{//Compare view name}
586          \textcolor{keywordflow}{if}(!strcmp(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, viewName))
587          \{
588             \textcolor{comment}{//Check the length of the subtree}
589             \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen} == subtreeLen)
590             \{
591                \textcolor{comment}{//Compare subtree}
592                \textcolor{keywordflow}{if}(!memcmp(entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, subtree, subtreeLen))
593                \{
594                   \textcolor{comment}{//A matching entry has been found}
595                   \textcolor{keywordflow}{break};
596                \}
597             \}
598          \}
599       \}
600    \}
601 
602    \textcolor{comment}{//Return a pointer to the matching entry}
603    \textcolor{keywordflow}{if}(i < SNMP\_AGENT\_VIEW\_TABLE\_SIZE)
604       \textcolor{keywordflow}{return} entry;
605    \textcolor{keywordflow}{else}
606       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
607 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_a7fd7c986d68a6e1253878108397c78e8}\label{snmp__agent__vacm_8c_a7fd7c986d68a6e1253878108397c78e8}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Is\+Access\+Allowed@{snmp\+Is\+Access\+Allowed}}
\index{snmp\+Is\+Access\+Allowed@{snmp\+Is\+Access\+Allowed}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Is\+Access\+Allowed()}{snmpIsAccessAllowed()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Is\+Access\+Allowed (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structSnmpMessage}{Snmp\+Message} $\ast$}]{message,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len }\end{DoxyParamCaption})}



Access control verification. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em message} & Pointer to the received S\+N\+MP message \\
\hline
\mbox{\tt in}  & {\em oid} & O\+ID for the managed object \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 61 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
63 \{
64    \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{SnmpSecurityModel} securityModel;
65    \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612}{SnmpSecurityLevel} securityLevel;
66    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *securityName;
67    \textcolor{keywordtype}{size\_t} securityNameLen;
68    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *contextName;
69    \textcolor{keywordtype}{size\_t} contextNameLen;
70    \textcolor{keyword}{const} \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *viewName;
71    \textcolor{keyword}{const} \hyperlink{structSnmpGroupEntry}{SnmpGroupEntry} *groupEntry;
72    \textcolor{keyword}{const} \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *accessEntry;
73    \textcolor{keyword}{const} \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *viewEntry;
74 
75 \textcolor{preprocessor}{#if (SNMP\_V1\_SUPPORT == ENABLED)}
76    \textcolor{comment}{//SNMPv1 version?}
77    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa3dfaf92130ae745ea9945787a64458a7}{SNMP\_VERSION\_1})
78    \{
79       \textcolor{comment}{//Set security parameters}
80       securityModel = \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695ae3de1e0065ac71136736dfc32a7d6704}{SNMP\_SECURITY\_MODEL\_V1};
81       securityLevel = \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612ae263055fd5ff66ac93f6d5a1b9885116}{SNMP\_SECURITY\_LEVEL\_NO\_AUTH\_NO\_PRIV};
82       securityName = message->\hyperlink{structSnmpMessage_ac9976028507798166e3f542d5806c811}{community};
83       securityNameLen = message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen};
84       contextName = context->contextName;
85       contextNameLen = strlen(context->contextName);
86    \}
87    \textcolor{keywordflow}{else}
88 \textcolor{preprocessor}{#endif}
89 \textcolor{preprocessor}{#if (SNMP\_V2C\_SUPPORT == ENABLED)}
90    \textcolor{comment}{//SNMPv2c version?}
91    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfaa35575472195d72a958b8482d425c2b5}{SNMP\_VERSION\_2C})
92    \{
93       \textcolor{comment}{//Set security parameters}
94       securityModel = \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695ae2bc999bcb1df0c455037f8184589959}{SNMP\_SECURITY\_MODEL\_V2C};
95       securityLevel = \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612ae263055fd5ff66ac93f6d5a1b9885116}{SNMP\_SECURITY\_LEVEL\_NO\_AUTH\_NO\_PRIV};
96       securityName = message->\hyperlink{structSnmpMessage_ac9976028507798166e3f542d5806c811}{community};
97       securityNameLen = message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen};
98       contextName = context->contextName;
99       contextNameLen = strlen(context->contextName);
100    \}
101    \textcolor{keywordflow}{else}
102 \textcolor{preprocessor}{#endif}
103 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
104    \textcolor{comment}{//SNMPv3 version?}
105    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
106    \{
107       \textcolor{comment}{//Set security parameters}
108       securityModel = (\hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{SnmpSecurityModel}) message->
      \hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel};
109       securityLevel = \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612ae263055fd5ff66ac93f6d5a1b9885116}{SNMP\_SECURITY\_LEVEL\_NO\_AUTH\_NO\_PRIV};
110       securityName = message->\hyperlink{structSnmpMessage_a83e0d7035f301d07352eb2d3b6b1679a}{msgUserName};
111       securityNameLen = message->\hyperlink{structSnmpMessage_ac9a168d33bda6c99336def2b01440b3b}{msgUserNameLen};
112       contextName = message->\hyperlink{structSnmpMessage_ab7b3dc54e8e1538249e1e0e08123f0f9}{contextName};
113       contextNameLen = message->\hyperlink{structSnmpMessage_a64d47bc4ef9cdfaae0494c8b224b26cb}{contextNameLen};
114 
115       \textcolor{comment}{//Check whether the authFlag is set}
116       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a8b9b4731d377864f4e13821af7cd3329}{SNMP\_MSG\_FLAG\_AUTH})
117       \{
118          \textcolor{comment}{//Check whether the privFlag is set}
119          \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a09a0d3b1da3227488bf9ccc2cc8a48e2}{SNMP\_MSG\_FLAG\_PRIV})
120             securityLevel = \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612ab2d046c82ee883f1d60d66c71b282127}{SNMP\_SECURITY\_LEVEL\_AUTH\_PRIV};
121          \textcolor{keywordflow}{else}
122             securityLevel = \hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612adde91d744f2e65bb9eac4f26b7cff9e0}{SNMP\_SECURITY\_LEVEL\_AUTH\_NO\_PRIV};
123       \}
124    \}
125    \textcolor{keywordflow}{else}
126 \textcolor{preprocessor}{#endif}
127    \textcolor{comment}{//Invalid SNMP version?}
128    \{
129       \textcolor{comment}{//Report an error}
130       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
131    \}
132 
133    \textcolor{comment}{//The vacmContextTable is consulted for information about the SNMP}
134    \textcolor{comment}{//context identified by the contextName. If information about this}
135    \textcolor{comment}{//SNMP context is absent from the table, then an errorIndication}
136    \textcolor{comment}{//(noSuchContext) is returned to the calling module}
137    \textcolor{keywordflow}{if}(contextNameLen != strlen(context->contextName))
138       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca487819dd3b521f88c597e47c4d6c1255}{ERROR\_UNKNOWN\_CONTEXT};
139 
140    \textcolor{comment}{//Check context name}
141    \textcolor{keywordflow}{if}(strncmp(contextName, context->contextName, contextNameLen))
142       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca487819dd3b521f88c597e47c4d6c1255}{ERROR\_UNKNOWN\_CONTEXT};
143 
144    \textcolor{comment}{//The vacmSecurityToGroupTable is consulted for mapping the securityModel}
145    \textcolor{comment}{//and securityName to a groupName}
146    groupEntry = \hyperlink{snmp__agent__vacm_8c_ae62d86e2a0e05b31d66602f6b884e842}{snmpFindGroupEntry}(context, securityModel,
147       securityName, securityNameLen);
148 
149    \textcolor{comment}{//If the information about this combination is absent from the table, then}
150    \textcolor{comment}{//an errorIndication (noGroupName) is returned to the calling module}
151    \textcolor{keywordflow}{if}(groupEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
152       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caad7c52cd713fd33a26b64f01377927cf}{ERROR\_AUTHORIZATION\_FAILED};
153 
154    \textcolor{comment}{//The vacmAccessTable is consulted for information about the groupName,}
155    \textcolor{comment}{//contextName, securityModel and securityLevel}
156    accessEntry = \hyperlink{snmp__agent__vacm_8c_ab2d76d86075956d21a7539533df6c3a5}{snmpSelectAccessEntry}(context, groupEntry->
      \hyperlink{structSnmpGroupEntry_af3ec2a0fe036650f877493147eed85b6}{groupName},
157       contextName, contextNameLen, securityModel, securityLevel);
158 
159    \textcolor{comment}{//If information about this combination is absent from the table, then}
160    \textcolor{comment}{//an errorIndication (noAccessEntry) is returned to the calling module}
161    \textcolor{keywordflow}{if}(accessEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
162       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caad7c52cd713fd33a26b64f01377927cf}{ERROR\_AUTHORIZATION\_FAILED};
163 
164    \textcolor{comment}{//Select the proper MIB view}
165    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa2c6d80868e156130b005e1d303f1672a}{SNMP\_PDU\_GET\_REQUEST} ||
166       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa7328c19405381fe928ea69ef52ddb5c7}{SNMP\_PDU\_GET\_NEXT\_REQUEST} ||
167       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aae1b25cf12cf1954685f1f7e8d36670ed}{SNMP\_PDU\_GET\_BULK\_REQUEST})
168    \{
169       \textcolor{comment}{//The read view is used for checking access rights}
170       viewName = accessEntry->\hyperlink{structSnmpAccessEntry_aa5691126835f643e16eca03938fd7bb5}{readViewName};
171    \}
172    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aae8884442d7acf5f3b17ae435af6879a8}{SNMP\_PDU\_SET\_REQUEST})
173    \{
174       \textcolor{comment}{//The write view is used for checking access rights}
175       viewName = accessEntry->\hyperlink{structSnmpAccessEntry_a44bdb9c26c3158808b9c65daa418b8ce}{writeViewName};
176    \}
177    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa51084b3eb61f91ceedeb5e426c15ffe0}{SNMP\_PDU\_TRAP} ||
178       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa194e27ffa1ad6456408b07aff153d6ff}{SNMP\_PDU\_TRAP\_V2} ||
179       message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} == \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa4060cecdb63948db5da6be30b623244b}{SNMP\_PDU\_INFORM\_REQUEST})
180    \{
181       \textcolor{comment}{//The notify view is used for checking access rights}
182       viewName = accessEntry->\hyperlink{structSnmpAccessEntry_a55d2f13d5f46593a17b29a88293b29e2}{notifyViewName};
183    \}
184    \textcolor{keywordflow}{else}
185    \{
186       \textcolor{comment}{//Report an error}
187       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caad7c52cd713fd33a26b64f01377927cf}{ERROR\_AUTHORIZATION\_FAILED};
188    \}
189 
190    \textcolor{comment}{//If the view to be used is the empty view (zero length viewName) then}
191    \textcolor{comment}{//an errorIndication (noSuchView) is returned to the calling module}
192    \textcolor{keywordflow}{if}(viewName[0] == \textcolor{charliteral}{'\(\backslash\)0'})
193       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caad7c52cd713fd33a26b64f01377927cf}{ERROR\_AUTHORIZATION\_FAILED};
194 
195    \textcolor{comment}{//Check whether the specified variableName is in the MIB view}
196    viewEntry = \hyperlink{snmp__agent__vacm_8c_a9cb91040e4cec40e84fca2e6b23aa682}{snmpSelectViewEntry}(context, viewName, \hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen);
197 
198    \textcolor{comment}{//If there is no view configured for the specified viewType, then an}
199    \textcolor{comment}{//errorIndication (noSuchView) is returned to the calling module}
200    \textcolor{keywordflow}{if}(viewEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
201       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caad7c52cd713fd33a26b64f01377927cf}{ERROR\_AUTHORIZATION\_FAILED};
202 
203    \textcolor{comment}{//If the specified variableName (object instance) is not in the MIB view,}
204    \textcolor{comment}{//then an errorIndication (notInView) is returned to the calling module}
205    \textcolor{keywordflow}{if}(viewEntry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} != \hyperlink{snmp__agent__vacm_8h_af9211ac922f85ec38c917879483643aaa95645902fe19983f42883dd4bf51b15c}{SNMP\_VIEW\_TYPE\_INCLUDED})
206       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caad7c52cd713fd33a26b64f01377927cf}{ERROR\_AUTHORIZATION\_FAILED};
207 
208    \textcolor{comment}{//Otherwise, the specified variableName is in the MIB view}
209    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
210 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_ab2d76d86075956d21a7539533df6c3a5}\label{snmp__agent__vacm_8c_ab2d76d86075956d21a7539533df6c3a5}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Select\+Access\+Entry@{snmp\+Select\+Access\+Entry}}
\index{snmp\+Select\+Access\+Entry@{snmp\+Select\+Access\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Select\+Access\+Entry()}{snmpSelectAccessEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpAccessEntry}{Snmp\+Access\+Entry}$\ast$ snmp\+Select\+Access\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{group\+Name,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{context\+Name,  }\item[{size\+\_\+t}]{context\+Name\+Len,  }\item[{\hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695}{Snmp\+Security\+Model}}]{security\+Model,  }\item[{\hyperlink{snmp__agent__usm_8h_a51b89f597dc71c414d602a9195864612}{Snmp\+Security\+Level}}]{security\+Level }\end{DoxyParamCaption})}



Find an access entry that matches the selection criteria. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em group\+Name} & N\+U\+L\+L-\/terminated string that contains the group name \\
\hline
\mbox{\tt in}  & {\em context\+Name} & Pointer to the context name \\
\hline
\mbox{\tt in}  & {\em context\+Name\+Len} & Length of the context name \\
\hline
\mbox{\tt in}  & {\em security\+Model} & Security model \\
\hline
\mbox{\tt in}  & {\em security\+Level} & Security level \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the matching entry 
\end{DoxyReturn}


Definition at line 423 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
426 \{
427    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
428    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
429    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
430    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *entry;
431    \hyperlink{structSnmpAccessEntry}{SnmpAccessEntry} *selectedEntry;
432 
433    \textcolor{comment}{//Initialize pointer}
434    selectedEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
435 
436    \textcolor{comment}{//Loop through the list of access rights}
437    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a8fbe14dcee7eac378b325a34dd7ea056}{SNMP\_AGENT\_ACCESS\_TABLE\_SIZE}; i++)
438    \{
439       \textcolor{comment}{//Point to the current entry}
440       entry = &context->accessTable[i];
441 
442       \textcolor{comment}{//Check current status}
443       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a8abdd58d85a24efce6aba1b1948f1616}{status} == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
444          \textcolor{keywordflow}{continue};
445 
446       \textcolor{comment}{//Compare group name}
447       \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpAccessEntry_a00aa9f193a226e0d2b3753225fbab667}{groupName}, groupName))
448          \textcolor{keywordflow}{continue};
449 
450       \textcolor{comment}{//Compare security model}
451       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} != \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a9f02fa28fe8ccae6ee20c874584e5de8}{SNMP\_SECURITY\_MODEL\_ANY})
452       \{
453          \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} != securityModel)
454             \textcolor{keywordflow}{continue};
455       \}
456 
457       \textcolor{comment}{//Compare security level}
458       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel} > securityLevel)
459          \textcolor{keywordflow}{continue};
460 
461       \textcolor{comment}{//Retrieve the length of the context name prefix}
462       n = strlen(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix});
463 
464       \textcolor{comment}{//Check the length of the context name prefix}
465       \textcolor{keywordflow}{if}(n > contextNameLen)
466          \textcolor{keywordflow}{continue};
467 
468       \textcolor{comment}{//Compare context name prefix}
469       \textcolor{keywordflow}{if}(strncmp(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}, contextName, n))
470          \textcolor{keywordflow}{continue};
471 
472       \textcolor{comment}{//Exact match?}
473       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a01114d52380d6cf6d57407e9af503bf0}{contextMatch} == \hyperlink{snmp__agent__vacm_8h_a8cef40e8881cb290d68171da147f6f20a4bc95716a2bab835d5d91ff473f286f9}{SNMP\_CONTEXT\_MATCH\_EXACT})
474       \{
475          \textcolor{comment}{//The contextName must match exactly}
476          \textcolor{keywordflow}{if}(n != contextNameLen)
477             \textcolor{keywordflow}{continue};
478       \}
479 
480       \textcolor{comment}{//If this set has only one member, we're done otherwise, it comes down}
481       \textcolor{comment}{//to deciding how to weight the preferences between ContextPrefixes,}
482       \textcolor{comment}{//SecurityModels, and SecurityLevels (refer to RFC 3415, section 4)}
483       \textcolor{keywordflow}{if}(selectedEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
484          acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
485       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} == \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a9f02fa28fe8ccae6ee20c874584e5de8}{SNMP\_SECURITY\_MODEL\_ANY})
486          acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
487       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(selectedEntry->\hyperlink{structSnmpAccessEntry_a226703910f64e584c35dece895584f8f}{securityModel} == 
      \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a9f02fa28fe8ccae6ee20c874584e5de8}{SNMP\_SECURITY\_MODEL\_ANY})
488          acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
489       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(selectedEntry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) == contextNameLen)
490          acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
491       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) == contextNameLen)
492          acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
493       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(selectedEntry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) > strlen(entry->
      \hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}))
494          acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
495       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(strlen(entry->\hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}) > strlen(selectedEntry->
      \hyperlink{structSnmpAccessEntry_aed0f5f189ab50350b9e50d28a65faa39}{contextPrefix}))
496          acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
497       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(selectedEntry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel} >= entry->\hyperlink{structSnmpAccessEntry_a46ecf3e9fa2ef86d3661de5ceb279f2a}{securityLevel})
498          acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
499       \textcolor{keywordflow}{else}
500          acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
501 
502       \textcolor{comment}{//Select the proper entry}
503       \textcolor{keywordflow}{if}(acceptable)
504          selectedEntry = entry;
505    \}
506 
507    \textcolor{comment}{//Return a pointer to the matching entry}
508    \textcolor{keywordflow}{return} selectedEntry;
509 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__vacm_8c_a9cb91040e4cec40e84fca2e6b23aa682}\label{snmp__agent__vacm_8c_a9cb91040e4cec40e84fca2e6b23aa682}} 
\index{snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}!snmp\+Select\+View\+Entry@{snmp\+Select\+View\+Entry}}
\index{snmp\+Select\+View\+Entry@{snmp\+Select\+View\+Entry}!snmp\+\_\+agent\+\_\+vacm.\+c@{snmp\+\_\+agent\+\_\+vacm.\+c}}
\subsubsection{\texorpdfstring{snmp\+Select\+View\+Entry()}{snmpSelectViewEntry()}}
{\footnotesize\ttfamily \hyperlink{structSnmpViewEntry}{Snmp\+View\+Entry}$\ast$ snmp\+Select\+View\+Entry (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{view\+Name,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+Len }\end{DoxyParamCaption})}



Find a view entry that matches the selection criteria. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em view\+Name} & N\+U\+L\+L-\/terminated string that contains the view name \\
\hline
\mbox{\tt in}  & {\em oid} & O\+ID for the managed object \\
\hline
\mbox{\tt in}  & {\em oid\+Len} & Length of the O\+ID, in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the matching entry 
\end{DoxyReturn}


Definition at line 619 of file snmp\+\_\+agent\+\_\+vacm.\+c.


\begin{DoxyCode}
621 \{
622    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
623    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} subtreeLen;
624    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} selectedSubtreeLen;
625    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} acceptable;
626    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *entry;
627    \hyperlink{structSnmpViewEntry}{SnmpViewEntry} *selectedEntry;
628 
629    \textcolor{comment}{//Initialize pointer}
630    selectedEntry = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
631 
632    \textcolor{comment}{//Loop through the list of MIB views}
633    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{snmp__agent_8h_a3bd40db59e400b8c4000a718a6da88e1}{SNMP\_AGENT\_VIEW\_TABLE\_SIZE}; i++)
634    \{
635       \textcolor{comment}{//Point to the current entry}
636       entry = &context->viewTable[i];
637 
638       \textcolor{comment}{//Check current status}
639       \textcolor{keywordflow}{if}(entry->\hyperlink{structSnmpViewEntry_a6eae2c4516db476272ac128113d0748b}{status} == \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a23a541b8e284769017711c3c13b9bc87}{MIB\_ROW\_STATUS\_UNUSED})
640          \textcolor{keywordflow}{continue};
641 
642       \textcolor{comment}{//Compare view name}
643       \textcolor{keywordflow}{if}(strcmp(entry->\hyperlink{structSnmpViewEntry_a6ce36343aeaa16e8b824211598a769c5}{viewName}, viewName))
644          \textcolor{keywordflow}{continue};
645 
646       \textcolor{comment}{//Check whether the OID matches the subtree (the mask allows for a}
647       \textcolor{comment}{//simple form of wildcarding)}
648       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_aa87eb17a914fd929c4ea3b683bc211a8}{oidMatch}(\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid}, oidLen, entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, entry->
      \hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen},
649          entry->\hyperlink{structSnmpViewEntry_a692738ca6f958b97c6c1b9b58e2f5e91}{mask}, entry->\hyperlink{structSnmpViewEntry_a6f23a9a82dcf611acc03489e9e812fbe}{maskLen}))
650       \{
651          \textcolor{keywordflow}{continue};
652       \}
653 
654       \textcolor{comment}{//First matching entry?}
655       \textcolor{keywordflow}{if}(selectedEntry == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
656       \{
657          acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
658       \}
659       \textcolor{keywordflow}{else}
660       \{
661          \textcolor{comment}{//Calculate the number of sub-identifiers of the subtree}
662          subtreeLen = \hyperlink{oid_8c_a01b05d4053e1aff70f4fa3429d889e17}{oidCountSubIdentifiers}(entry->
      \hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree},
663             entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen});
664 
665          \textcolor{comment}{//Calculate the number of sub-identifiers of the currently selected}
666          \textcolor{comment}{//subtree}
667          selectedSubtreeLen = \hyperlink{oid_8c_a01b05d4053e1aff70f4fa3429d889e17}{oidCountSubIdentifiers}(selectedEntry->
      \hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree},
668             selectedEntry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen});
669 
670          \textcolor{comment}{//If multiple entries match, then select the entry whose value of}
671          \textcolor{comment}{//vacmViewTreeFamilySubtree has the most sub-identifiers. If multiple}
672          \textcolor{comment}{//entries match and have the same number of sub-identifiers, then the}
673          \textcolor{comment}{//lexicographically greatest instance of vacmViewTreeFamilyType is}
674          \textcolor{comment}{//selected}
675          \textcolor{keywordflow}{if}(selectedSubtreeLen > subtreeLen)
676          \{
677             acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
678          \}
679          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(subtreeLen > selectedSubtreeLen)
680          \{
681             acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
682          \}
683          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(selectedEntry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, selectedEntry->
      \hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen},
684             entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen}) > 0)
685          \{
686             acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
687          \}
688          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(entry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, entry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen},
689             selectedEntry->\hyperlink{structSnmpViewEntry_a640a3c23d13bbf9de16ebf23097abc12}{subtree}, selectedEntry->\hyperlink{structSnmpViewEntry_a0b1d281049f1ea869ecb6a7af5a01cb1}{subtreeLen}) > 0)
690          \{
691             acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
692          \}
693          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(selectedEntry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type} >= entry->\hyperlink{structSnmpViewEntry_a32a9315f088375a8cd408ded58a20021}{type})
694          \{
695             acceptable = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
696          \}
697          \textcolor{keywordflow}{else}
698          \{
699             acceptable = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
700          \}
701       \}
702 
703       \textcolor{comment}{//Select the proper entry}
704       \textcolor{keywordflow}{if}(acceptable)
705          selectedEntry = entry;
706    \}
707 
708    \textcolor{comment}{//Return a pointer to the matching entry}
709    \textcolor{keywordflow}{return} selectedEntry;
710 \}
\end{DoxyCode}
