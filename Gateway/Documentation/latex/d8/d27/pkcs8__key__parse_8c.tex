\hypertarget{pkcs8__key__parse_8c}{}\section{cyclone\+\_\+crypto/pkix/pkcs8\+\_\+key\+\_\+parse.c File Reference}
\label{pkcs8__key__parse_8c}\index{cyclone\+\_\+crypto/pkix/pkcs8\+\_\+key\+\_\+parse.\+c@{cyclone\+\_\+crypto/pkix/pkcs8\+\_\+key\+\_\+parse.\+c}}


P\+K\+CS \#8 key parsing.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/pkcs8\+\_\+key\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+key\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/ed25519.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/ed448.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pkcs8__key__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_af62e7988b51a0bb9b5ad79db6da97c54}{pkcs8\+Parse\+Private\+Key\+Info} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$private\+Key\+Info)
\begin{DoxyCompactList}\small\item\em Parse Private\+Key\+Info structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a28a2d609aa920064a7c9264afc6eb0f8}{pkcs8\+Parse\+Private\+Key\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$private\+Key\+Info)
\begin{DoxyCompactList}\small\item\em Parse Private\+Key\+Algorithm structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a331e97be9c59e5c93bd628ff7c57b99a}{pkcs8\+Parse\+Rsa\+Private\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structPkcs8RsaPrivateKey}{Pkcs8\+Rsa\+Private\+Key} $\ast$rsa\+Private\+Key)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+Private\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a40f662465ee7609eb06793f75780caee}{pkcs8\+Parse\+Dsa\+Private\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509DsaParameters}{X509\+Dsa\+Parameters} $\ast$dsa\+Params, \hyperlink{structPkcs8DsaPrivateKey}{Pkcs8\+Dsa\+Private\+Key} $\ast$dsa\+Private\+Key)
\begin{DoxyCompactList}\small\item\em Parse D\+S\+A\+Private\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a4876889b45a4452389bd2e0b44c74ab1}{pkcs8\+Parse\+Ec\+Private\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$ec\+Params, \hyperlink{structPkcs8EcPrivateKey}{Pkcs8\+Ec\+Private\+Key} $\ast$ec\+Private\+Key)
\begin{DoxyCompactList}\small\item\em Parse E\+C\+Private\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a194df8a37067959530eab09ae2ca92d3}{pkcs8\+Parse\+Eddsa\+Private\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structPkcs8EddsaPrivateKey}{Pkcs8\+Eddsa\+Private\+Key} $\ast$eddsa\+Private\+Key)
\begin{DoxyCompactList}\small\item\em Parse Curve\+Private\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a1af528d707f166576fc2ae239f620ce1}{pkcs8\+Import\+Rsa\+Private\+Key} (const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$private\+Key\+Info, \hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$private\+Key)
\begin{DoxyCompactList}\small\item\em Import an R\+SA private key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_afb0457779147ef577936d6b4fce3bf34}{pkcs8\+Import\+Dsa\+Private\+Key} (const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$private\+Key\+Info, \hyperlink{structDsaPrivateKey}{Dsa\+Private\+Key} $\ast$private\+Key)
\begin{DoxyCompactList}\small\item\em Import an D\+SA private key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a5402c2cf605d684dafbb86eb260502f0}{pkcs8\+Import\+Ec\+Private\+Key} (const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$private\+Key\+Info, \hyperlink{structMpi}{Mpi} $\ast$private\+Key)
\begin{DoxyCompactList}\small\item\em Import an EC private key. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkcs8__key__parse_8c_a710b52559726007407f201c7d5bd3b05}{pkcs8\+Import\+Eddsa\+Private\+Key} (const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$private\+Key\+Info, \hyperlink{structEddsaPrivateKey}{Eddsa\+Private\+Key} $\ast$private\+Key)
\begin{DoxyCompactList}\small\item\em Import an Ed\+D\+SA private key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
P\+K\+CS \#8 key parsing. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{pkcs8__key__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{pkcs8__key__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file pkcs8\+\_\+key\+\_\+parse.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{pkcs8__key__parse_8c_afb0457779147ef577936d6b4fce3bf34}\label{pkcs8__key__parse_8c_afb0457779147ef577936d6b4fce3bf34}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Import\+Dsa\+Private\+Key@{pkcs8\+Import\+Dsa\+Private\+Key}}
\index{pkcs8\+Import\+Dsa\+Private\+Key@{pkcs8\+Import\+Dsa\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Import\+Dsa\+Private\+Key()}{pkcs8ImportDsaPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Import\+Dsa\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$}]{private\+Key\+Info,  }\item[{\hyperlink{structDsaPrivateKey}{Dsa\+Private\+Key} $\ast$}]{private\+Key }\end{DoxyParamCaption})}



Import an D\+SA private key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em private\+Key\+Info} & Private key information \\
\hline
\mbox{\tt out}  & {\em private\+Key} & D\+SA private key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 878 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
880 \{
881    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
882 
883 \textcolor{preprocessor}{#if (DSA\_SUPPORT == ENABLED)}
884    \textcolor{comment}{//DSA algorithm identifier?}
885    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid}, privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen}, 
      \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID},
886       \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
887    \{
888       \textcolor{comment}{//Sanity check}
889       \textcolor{keywordflow}{if}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
890          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
891          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
892          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a652af88cbae3bcea5818155c8ca9d2db}{dsaPrivateKey}.\hyperlink{structPkcs8DsaPrivateKey_a35b665fbe2d994f619b5f5411c9862df}{x} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
893       \{
894          \textcolor{comment}{//Read parameter p}
895          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structDsaPrivateKey_a8f8fd999b327a6bbff828cb04e31772e}{p}, privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.
      \hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p},
896             privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_a492453aa50210c40372c6d76ff955c7f}{pLen}, \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
897 
898          \textcolor{comment}{//Check status code}
899          \textcolor{keywordflow}{if}(!error)
900          \{
901             \textcolor{comment}{//Read parameter q}
902             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structDsaPrivateKey_a57748f022f498aaf35d7b30f562af7ca}{q}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q},
903                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_a2cb0e6cf41cb0b07dfccedc79bce007e}{qLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
904          \}
905 
906          \textcolor{comment}{//Check status code}
907          \textcolor{keywordflow}{if}(!error)
908          \{
909             \textcolor{comment}{//Read parameter g}
910             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structDsaPrivateKey_a78da170adbc7f1a7eeb95e6bc52d4124}{g}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g},
911                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams}.\hyperlink{structX509DsaParameters_a84e6f3a0159da3fff5bf9315be4cf5f7}{gLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
912          \}
913 
914          \textcolor{comment}{//Check status code}
915          \textcolor{keywordflow}{if}(!error)
916          \{
917             \textcolor{comment}{//Read private value}
918             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structDsaPrivateKey_ac5b101c89f19f59b4cddd85429f1c30e}{x}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a652af88cbae3bcea5818155c8ca9d2db}{dsaPrivateKey}.\hyperlink{structPkcs8DsaPrivateKey_a35b665fbe2d994f619b5f5411c9862df}{x},
919                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a652af88cbae3bcea5818155c8ca9d2db}{dsaPrivateKey}.\hyperlink{structPkcs8DsaPrivateKey_ae432d960efd869f6cda9c91fa0e0e408}{xLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
920          \}
921 
922          \textcolor{comment}{//Check status code}
923          \textcolor{keywordflow}{if}(!error)
924          \{
925             \textcolor{comment}{//Debug message}
926             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"DSA private key:\(\backslash\)r\(\backslash\)n"});
927             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parameter p:\(\backslash\)r\(\backslash\)n"});
928             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structDsaPrivateKey_a8f8fd999b327a6bbff828cb04e31772e}{p});
929             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parameter q:\(\backslash\)r\(\backslash\)n"});
930             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structDsaPrivateKey_a57748f022f498aaf35d7b30f562af7ca}{q});
931             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parameter g:\(\backslash\)r\(\backslash\)n"});
932             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structDsaPrivateKey_a78da170adbc7f1a7eeb95e6bc52d4124}{g});
933             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private value x:\(\backslash\)r\(\backslash\)n"});
934             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structDsaPrivateKey_ac5b101c89f19f59b4cddd85429f1c30e}{x});
935          \}
936       \}
937       \textcolor{keywordflow}{else}
938       \{
939          \textcolor{comment}{//The private key is not valid}
940          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
941       \}
942    \}
943    \textcolor{keywordflow}{else}
944 \textcolor{preprocessor}{#endif}
945    \textcolor{comment}{//Invalid algorithm identifier?}
946    \{
947       \textcolor{comment}{//Report an error}
948       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
949    \}
950 
951    \textcolor{comment}{//Return status code}
952    \textcolor{keywordflow}{return} error;
953 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a5402c2cf605d684dafbb86eb260502f0}\label{pkcs8__key__parse_8c_a5402c2cf605d684dafbb86eb260502f0}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Import\+Ec\+Private\+Key@{pkcs8\+Import\+Ec\+Private\+Key}}
\index{pkcs8\+Import\+Ec\+Private\+Key@{pkcs8\+Import\+Ec\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Import\+Ec\+Private\+Key()}{pkcs8ImportEcPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Import\+Ec\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$}]{private\+Key\+Info,  }\item[{\hyperlink{structMpi}{Mpi} $\ast$}]{private\+Key }\end{DoxyParamCaption})}



Import an EC private key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em private\+Key\+Info} & Private key information \\
\hline
\mbox{\tt out}  & {\em private\+Key} & EC private key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 963 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
965 \{
966    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
967 
968 \textcolor{preprocessor}{#if (EC\_SUPPORT == ENABLED)}
969    \textcolor{comment}{//EC public key algorithm identifier?}
970    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid}, privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen}, 
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID},
971       \textcolor{keyword}{sizeof}(\hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
972    \{
973       \textcolor{comment}{//Sanity check}
974       \textcolor{keywordflow}{if}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_abb7fbb9eeceb773e8d5ff034021429f2}{ecPrivateKey}.\hyperlink{structPkcs8EcPrivateKey_a35153cab59bde53762b3063c882e5cd4}{d} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
975       \{
976          \textcolor{comment}{//Read the EC private key}
977          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(privateKey, privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_abb7fbb9eeceb773e8d5ff034021429f2}{ecPrivateKey}.
      \hyperlink{structPkcs8EcPrivateKey_a35153cab59bde53762b3063c882e5cd4}{d},
978             privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_abb7fbb9eeceb773e8d5ff034021429f2}{ecPrivateKey}.\hyperlink{structPkcs8EcPrivateKey_abd745dc89a69991f28d34ced7905bd2a}{dLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
979 
980          \textcolor{comment}{//Check status code}
981          \textcolor{keywordflow}{if}(!error)
982          \{
983             \textcolor{comment}{//Debug message}
984             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"EC private key:\(\backslash\)r\(\backslash\)n"});
985             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"  "}, privateKey);
986          \}
987       \}
988       \textcolor{keywordflow}{else}
989       \{
990          \textcolor{comment}{//The private key is not valid}
991          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
992       \}
993    \}
994    \textcolor{keywordflow}{else}
995 \textcolor{preprocessor}{#endif}
996    \textcolor{comment}{//Invalid algorithm identifier?}
997    \{
998       \textcolor{comment}{//Report an error}
999       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
1000    \}
1001 
1002    \textcolor{comment}{//Return status code}
1003    \textcolor{keywordflow}{return} error;
1004 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a710b52559726007407f201c7d5bd3b05}\label{pkcs8__key__parse_8c_a710b52559726007407f201c7d5bd3b05}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Import\+Eddsa\+Private\+Key@{pkcs8\+Import\+Eddsa\+Private\+Key}}
\index{pkcs8\+Import\+Eddsa\+Private\+Key@{pkcs8\+Import\+Eddsa\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Import\+Eddsa\+Private\+Key()}{pkcs8ImportEddsaPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Import\+Eddsa\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$}]{private\+Key\+Info,  }\item[{\hyperlink{structEddsaPrivateKey}{Eddsa\+Private\+Key} $\ast$}]{private\+Key }\end{DoxyParamCaption})}



Import an Ed\+D\+SA private key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em private\+Key\+Info} & Private key information \\
\hline
\mbox{\tt out}  & {\em private\+Key} & Ed\+D\+SA private key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1014 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
1016 \{
1017    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1018 
1019 \textcolor{preprocessor}{#if (ED25519\_SUPPORT == ENABLED)}
1020    \textcolor{comment}{//Ed25519 algorithm identifier?}
1021    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid}, privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen}, 
      \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID},
1022       \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
1023    \{
1024       \textcolor{comment}{//Check the length of the Ed25519 private key}
1025       \textcolor{keywordflow}{if}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a65e556cbe51c97815cf1b7eeb39e7683}{d} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
1026          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a5806438d23d571cf0f83c4a6e2f83f98}{dLen} == 
      \hyperlink{ed25519_8h_aed3a21b9d4421f2fc69bc1dd92af50ab}{ED25519\_PRIVATE\_KEY\_LEN})
1027       \{
1028          \textcolor{comment}{//Read the Ed25519 private key}
1029          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structEddsaPrivateKey_a58ef5164bc00df5a7ee8adc18fa2b63a}{d}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a65e556cbe51c97815cf1b7eeb39e7683}{d},
1030             privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a5806438d23d571cf0f83c4a6e2f83f98}{dLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa637c0a6e803a47db52875c6818674c60}{MPI\_FORMAT\_LITTLE\_ENDIAN});
1031       \}
1032       \textcolor{keywordflow}{else}
1033       \{
1034          \textcolor{comment}{//The private key is not valid}
1035          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
1036       \}
1037    \}
1038    \textcolor{keywordflow}{else}
1039 \textcolor{preprocessor}{#endif}
1040 \textcolor{preprocessor}{#if (ED448\_SUPPORT == ENABLED)}
1041    \textcolor{comment}{//Ed448 algorithm identifier?}
1042    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid}, privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen}, 
      \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID},
1043       \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
1044    \{
1045       \textcolor{comment}{//Check the length of the Ed448 private key}
1046       \textcolor{keywordflow}{if}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a65e556cbe51c97815cf1b7eeb39e7683}{d} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
1047          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a5806438d23d571cf0f83c4a6e2f83f98}{dLen} == 
      \hyperlink{ed448_8h_a26f2969270eebc560926f8bada35cb65}{ED448\_PRIVATE\_KEY\_LEN})
1048       \{
1049          \textcolor{comment}{//Read the Ed448 private key}
1050          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structEddsaPrivateKey_a58ef5164bc00df5a7ee8adc18fa2b63a}{d}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a65e556cbe51c97815cf1b7eeb39e7683}{d},
1051             privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey}.\hyperlink{structPkcs8EddsaPrivateKey_a5806438d23d571cf0f83c4a6e2f83f98}{dLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa637c0a6e803a47db52875c6818674c60}{MPI\_FORMAT\_LITTLE\_ENDIAN});
1052       \}
1053       \textcolor{keywordflow}{else}
1054       \{
1055          \textcolor{comment}{//The private key is not valid}
1056          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
1057       \}
1058    \}
1059    \textcolor{keywordflow}{else}
1060 \textcolor{preprocessor}{#endif}
1061    \textcolor{comment}{//Invalid algorithm identifier?}
1062    \{
1063       \textcolor{comment}{//Report an error}
1064       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
1065    \}
1066 
1067    \textcolor{comment}{//Check status code}
1068    \textcolor{keywordflow}{if}(!error)
1069    \{
1070       \textcolor{comment}{//Debug message}
1071       \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"EdDSA private key:\(\backslash\)r\(\backslash\)n"});
1072       \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"  "}, &privateKey->\hyperlink{structEddsaPrivateKey_a58ef5164bc00df5a7ee8adc18fa2b63a}{d});
1073    \}
1074 
1075    \textcolor{comment}{//Return status code}
1076    \textcolor{keywordflow}{return} error;
1077 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a1af528d707f166576fc2ae239f620ce1}\label{pkcs8__key__parse_8c_a1af528d707f166576fc2ae239f620ce1}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Import\+Rsa\+Private\+Key@{pkcs8\+Import\+Rsa\+Private\+Key}}
\index{pkcs8\+Import\+Rsa\+Private\+Key@{pkcs8\+Import\+Rsa\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Import\+Rsa\+Private\+Key()}{pkcs8ImportRsaPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Import\+Rsa\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$}]{private\+Key\+Info,  }\item[{\hyperlink{structRsaPrivateKey}{Rsa\+Private\+Key} $\ast$}]{private\+Key }\end{DoxyParamCaption})}



Import an R\+SA private key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em private\+Key\+Info} & Private key information \\
\hline
\mbox{\tt out}  & {\em private\+Key} & R\+SA private key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 742 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
744 \{
745    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
746 
747 \textcolor{preprocessor}{#if (RSA\_SUPPORT == ENABLED)}
748    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid};
749    \textcolor{keywordtype}{size\_t} oidLen;
750 
751    \textcolor{comment}{//Get the private key algorithm identifier}
752    oid = privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid};
753    oidLen = privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen};
754 
755    \textcolor{comment}{//RSA or RSA-PSS algorithm identifier?}
756    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})) ||
757       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
758    \{
759       \textcolor{comment}{//Sanity check}
760       \textcolor{keywordflow}{if}(privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_ae7d21db6f648db24b15e7903df25f46f}{n} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
761          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a2946cc6004722d2074d3b267e97daef8}{e} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
762          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a011925e3908af99efcc106424aed7498}{d} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
763          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_ae62dece22d7f28257445b4b5a3a4f200}{p} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
764          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a129f4bc46975ed98556bc42c75151782}{q} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
765          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a690dd0e589139f5326246b771a11552f}{dp} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
766          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_ab38c39fc716f64b8860d31e4ba89405f}{dq} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} &&
767          privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a573ca0ff349e3265efcfdebda8442cc4}{qinv} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
768       \{
769          \textcolor{comment}{//Read modulus}
770          error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_ae7d21db6f648db24b15e7903df25f46f}{n},
771             privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a947768dc9001e1987637b0270bbd0459}{nLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
772 
773          \textcolor{comment}{//Check status code}
774          \textcolor{keywordflow}{if}(!error)
775          \{
776             \textcolor{comment}{//Read public exponent}
777             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a2946cc6004722d2074d3b267e97daef8}{e},
778                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a899452f1ccd061c9ff81517a441b3299}{eLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
779          \}
780 
781          \textcolor{comment}{//Check status code}
782          \textcolor{keywordflow}{if}(!error)
783          \{
784             \textcolor{comment}{//Read private exponent}
785             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a011925e3908af99efcc106424aed7498}{d},
786                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a20dba37d8944eaa4f0384e092490a05a}{dLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
787          \}
788 
789          \textcolor{comment}{//Check status code}
790          \textcolor{keywordflow}{if}(!error)
791          \{
792             \textcolor{comment}{//Read first factor}
793             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_ae62dece22d7f28257445b4b5a3a4f200}{p},
794                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a90ceb269ed09aad82e4ef4b6cfd269df}{pLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
795          \}
796 
797          \textcolor{comment}{//Check status code}
798          \textcolor{keywordflow}{if}(!error)
799          \{
800             \textcolor{comment}{//Read second factor}
801             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a129f4bc46975ed98556bc42c75151782}{q},
802                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a14e1e918936b22f7663dc9d4592eddce}{qLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
803          \}
804 
805          \textcolor{comment}{//Check status code}
806          \textcolor{keywordflow}{if}(!error)
807          \{
808             \textcolor{comment}{//Read first exponent}
809             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a690dd0e589139f5326246b771a11552f}{dp},
810                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a633d0d5b421c4ed1c965bc0fa62e6ffc}{dpLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
811          \}
812 
813          \textcolor{comment}{//Check status code}
814          \textcolor{keywordflow}{if}(!error)
815          \{
816             \textcolor{comment}{//Read second exponent}
817             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_ab38c39fc716f64b8860d31e4ba89405f}{dq},
818                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a594a1b4818730a79d59b9023a00227dd}{dqLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
819          \}
820 
821          \textcolor{comment}{//Check status code}
822          \textcolor{keywordflow}{if}(!error)
823          \{
824             \textcolor{comment}{//Read coefficient}
825             error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&privateKey->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv}, privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a573ca0ff349e3265efcfdebda8442cc4}{qinv},
826                privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey}.\hyperlink{structPkcs8RsaPrivateKey_a7e17613233cfc76c147bcf432f30488c}{qinvLen}, 
      \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
827          \}
828 
829          \textcolor{comment}{//Check status code}
830          \textcolor{keywordflow}{if}(!error)
831          \{
832             \textcolor{comment}{//Debug message}
833             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"RSA private key:\(\backslash\)r\(\backslash\)n"});
834             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Modulus:\(\backslash\)r\(\backslash\)n"});
835             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_aaccaccd76db1a21201bf06eb6ecdd8ac}{n});
836             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Public exponent:\(\backslash\)r\(\backslash\)n"});
837             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a590822495b6caceae5f8880cacc51b9c}{e});
838             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Private exponent:\(\backslash\)r\(\backslash\)n"});
839             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_aea064a2875da9d2a44c7e7c02e157728}{d});
840             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 1:\(\backslash\)r\(\backslash\)n"});
841             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a1fc8b1ca097c70244db691916f33f891}{p});
842             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime 2:\(\backslash\)r\(\backslash\)n"});
843             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_aefd3ef59482ac00637165b624625fef5}{q});
844             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 1:\(\backslash\)r\(\backslash\)n"});
845             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_ab101b4e579a4799f12d3acd237e72b34}{dp});
846             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Prime exponent 2:\(\backslash\)r\(\backslash\)n"});
847             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a9e72909ef8af48ce9a813ba32ba0287d}{dq});
848             \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Coefficient:\(\backslash\)r\(\backslash\)n"});
849             \hyperlink{debug_8h_a9c9f3b28f2daf14d77b401512c189d93}{TRACE\_DEBUG\_MPI}(\textcolor{stringliteral}{"    "}, &privateKey->\hyperlink{structRsaPrivateKey_a3dac28e0d48293032c18c968faadf57c}{qinv});
850          \}
851       \}
852       \textcolor{keywordflow}{else}
853       \{
854          \textcolor{comment}{//The private key is not valid}
855          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca31846fcd73423f08cca08d9acf9b3f8e}{ERROR\_INVALID\_KEY};
856       \}
857    \}
858    \textcolor{keywordflow}{else}
859 \textcolor{preprocessor}{#endif}
860    \textcolor{comment}{//Invalid algorithm identifier?}
861    \{
862       \textcolor{comment}{//Report an error}
863       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
864    \}
865 
866    \textcolor{comment}{//Return status code}
867    \textcolor{keywordflow}{return} error;
868 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a40f662465ee7609eb06793f75780caee}\label{pkcs8__key__parse_8c_a40f662465ee7609eb06793f75780caee}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Parse\+Dsa\+Private\+Key@{pkcs8\+Parse\+Dsa\+Private\+Key}}
\index{pkcs8\+Parse\+Dsa\+Private\+Key@{pkcs8\+Parse\+Dsa\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Parse\+Dsa\+Private\+Key()}{pkcs8ParseDsaPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Parse\+Dsa\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509DsaParameters}{X509\+Dsa\+Parameters} $\ast$}]{dsa\+Params,  }\item[{\hyperlink{structPkcs8DsaPrivateKey}{Pkcs8\+Dsa\+Private\+Key} $\ast$}]{dsa\+Private\+Key }\end{DoxyParamCaption})}



Parse D\+S\+A\+Private\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em dsa\+Params} & D\+SA domain parameters \\
\hline
\mbox{\tt out}  & {\em dsa\+Private\+Key} & D\+SA private key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 492 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
494 \{
495    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
496    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version};
497    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
498 
499    \textcolor{comment}{//The DSA domain parameters can be optionally parsed}
500    \textcolor{keywordflow}{if}(dsaParams != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
501    \{
502       \textcolor{comment}{//Read DSAPrivateKey structure}
503       error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
504       \textcolor{comment}{//Failed to decode ASN.1 tag?}
505       \textcolor{keywordflow}{if}(error)
506          \textcolor{keywordflow}{return} error;
507 
508       \textcolor{comment}{//Point to the first field of the sequence}
509       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
510       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
511 
512       \textcolor{comment}{//Read version}
513       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &version);
514       \textcolor{comment}{//Failed to decode ASN.1 tag?}
515       \textcolor{keywordflow}{if}(error)
516          \textcolor{keywordflow}{return} error;
517 
518       \textcolor{comment}{//Point to the next field}
519       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
520       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
521 
522       \textcolor{comment}{//Read the parameter p}
523       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
524       \textcolor{comment}{//Failed to decode ASN.1 tag?}
525       \textcolor{keywordflow}{if}(error)
526          \textcolor{keywordflow}{return} error;
527 
528       \textcolor{comment}{//Enforce encoding, class and type}
529       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL},
530          \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
531       \textcolor{comment}{//Invalid tag?}
532       \textcolor{keywordflow}{if}(error)
533          \textcolor{keywordflow}{return} error;
534 
535       \textcolor{comment}{//Save the parameter p}
536       dsaParams->\hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
537       dsaParams->\hyperlink{structX509DsaParameters_a492453aa50210c40372c6d76ff955c7f}{pLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
538 
539       \textcolor{comment}{//Point to the next field}
540       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
541       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
542 
543       \textcolor{comment}{//Read the parameter q}
544       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
545       \textcolor{comment}{//Failed to decode ASN.1 tag?}
546       \textcolor{keywordflow}{if}(error)
547          \textcolor{keywordflow}{return} error;
548 
549       \textcolor{comment}{//Enforce encoding, class and type}
550       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL},
551          \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
552       \textcolor{comment}{//Invalid tag?}
553       \textcolor{keywordflow}{if}(error)
554          \textcolor{keywordflow}{return} error;
555 
556       \textcolor{comment}{//Save the parameter q}
557       dsaParams->\hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
558       dsaParams->\hyperlink{structX509DsaParameters_a2cb0e6cf41cb0b07dfccedc79bce007e}{qLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
559 
560       \textcolor{comment}{//Point to the next field}
561       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
562       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
563 
564       \textcolor{comment}{//Read the parameter g}
565       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
566       \textcolor{comment}{//Failed to decode ASN.1 tag?}
567       \textcolor{keywordflow}{if}(error)
568          \textcolor{keywordflow}{return} error;
569 
570       \textcolor{comment}{//Enforce encoding, class and type}
571       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL},
572          \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
573       \textcolor{comment}{//Invalid tag?}
574       \textcolor{keywordflow}{if}(error)
575          \textcolor{keywordflow}{return} error;
576 
577       \textcolor{comment}{//Save the parameter g}
578       dsaParams->\hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
579       dsaParams->\hyperlink{structX509DsaParameters_a84e6f3a0159da3fff5bf9315be4cf5f7}{gLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
580 
581       \textcolor{comment}{//Point to the next field}
582       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
583       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
584 
585       \textcolor{comment}{//Read the public value y}
586       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
587       \textcolor{comment}{//Failed to decode ASN.1 tag?}
588       \textcolor{keywordflow}{if}(error)
589          \textcolor{keywordflow}{return} error;
590 
591       \textcolor{comment}{//Enforce encoding, class and type}
592       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL},
593          \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
594       \textcolor{comment}{//Invalid tag?}
595       \textcolor{keywordflow}{if}(error)
596          \textcolor{keywordflow}{return} error;
597 
598       \textcolor{comment}{//Point to the next field}
599       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
600       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
601    \}
602 
603    \textcolor{comment}{//Read the private value x}
604    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
605    \textcolor{comment}{//Failed to decode ASN.1 tag?}
606    \textcolor{keywordflow}{if}(error)
607       \textcolor{keywordflow}{return} error;
608 
609    \textcolor{comment}{//Enforce encoding, class and type}
610    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
611    \textcolor{comment}{//Invalid tag?}
612    \textcolor{keywordflow}{if}(error)
613       \textcolor{keywordflow}{return} error;
614 
615    \textcolor{comment}{//Save the private value x}
616    dsaPrivateKey->\hyperlink{structPkcs8DsaPrivateKey_a35b665fbe2d994f619b5f5411c9862df}{x} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
617    dsaPrivateKey->\hyperlink{structPkcs8DsaPrivateKey_ae432d960efd869f6cda9c91fa0e0e408}{xLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
618 
619    \textcolor{comment}{//Successful processing}
620    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
621 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a4876889b45a4452389bd2e0b44c74ab1}\label{pkcs8__key__parse_8c_a4876889b45a4452389bd2e0b44c74ab1}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Parse\+Ec\+Private\+Key@{pkcs8\+Parse\+Ec\+Private\+Key}}
\index{pkcs8\+Parse\+Ec\+Private\+Key@{pkcs8\+Parse\+Ec\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Parse\+Ec\+Private\+Key()}{pkcs8ParseEcPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Parse\+Ec\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$}]{ec\+Params,  }\item[{\hyperlink{structPkcs8EcPrivateKey}{Pkcs8\+Ec\+Private\+Key} $\ast$}]{ec\+Private\+Key }\end{DoxyParamCaption})}



Parse E\+C\+Private\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ec\+Params} & EC domain parameters \\
\hline
\mbox{\tt out}  & {\em ec\+Private\+Key} & EC private key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 633 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
635 \{
636    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
637    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
638 
639    \textcolor{comment}{//Read ECPrivateKey structure}
640    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
641    \textcolor{comment}{//Failed to decode ASN.1 tag?}
642    \textcolor{keywordflow}{if}(error)
643       \textcolor{keywordflow}{return} error;
644 
645    \textcolor{comment}{//Point to the first field}
646    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
647    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
648 
649    \textcolor{comment}{//Read Version field}
650    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &ecPrivateKey->
      \hyperlink{structPkcs8EcPrivateKey_a4cd85ed9dc55493823c0066128624265}{version});
651    \textcolor{comment}{//Failed to decode ASN.1 tag?}
652    \textcolor{keywordflow}{if}(error)
653       \textcolor{keywordflow}{return} error;
654 
655    \textcolor{comment}{//Point to the next field}
656    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
657    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
658 
659    \textcolor{comment}{//Read PrivateKey field}
660    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
661    \textcolor{comment}{//Failed to decode ASN.1 tag?}
662    \textcolor{keywordflow}{if}(error)
663       \textcolor{keywordflow}{return} error;
664 
665    \textcolor{comment}{//Save the EC private key}
666    ecPrivateKey->\hyperlink{structPkcs8EcPrivateKey_a35153cab59bde53762b3063c882e5cd4}{d} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
667    ecPrivateKey->\hyperlink{structPkcs8EcPrivateKey_abd745dc89a69991f28d34ced7905bd2a}{dLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
668 
669    \textcolor{comment}{//Point to the next field}
670    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
671    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
672 
673    \textcolor{comment}{//Loop through optional attributes}
674    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
675    \{
676       \textcolor{comment}{//Read current attribute}
677       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
678       \textcolor{comment}{//Failed to decode ASN.1 tag?}
679       \textcolor{keywordflow}{if}(error)
680          \textcolor{keywordflow}{return} error;
681 
682       \textcolor{comment}{//Explicit tagging shall be used to encode each optional attribute}
683       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
684          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
685 
686       \textcolor{comment}{//Parameters attribute?}
687       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
688       \{
689          \textcolor{comment}{//Parse ECParameters structure}
690          error = \hyperlink{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}{x509ParseEcParameters}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, ecParams);
691          \textcolor{comment}{//Any error to report?}
692          \textcolor{keywordflow}{if}(error)
693             \textcolor{keywordflow}{return} error;
694       \}
695 
696       \textcolor{comment}{//Next attribute}
697       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
698       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
699    \}
700 
701    \textcolor{comment}{//Successful processing}
702    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
703 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a194df8a37067959530eab09ae2ca92d3}\label{pkcs8__key__parse_8c_a194df8a37067959530eab09ae2ca92d3}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Parse\+Eddsa\+Private\+Key@{pkcs8\+Parse\+Eddsa\+Private\+Key}}
\index{pkcs8\+Parse\+Eddsa\+Private\+Key@{pkcs8\+Parse\+Eddsa\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Parse\+Eddsa\+Private\+Key()}{pkcs8ParseEddsaPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Parse\+Eddsa\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structPkcs8EddsaPrivateKey}{Pkcs8\+Eddsa\+Private\+Key} $\ast$}]{eddsa\+Private\+Key }\end{DoxyParamCaption})}



Parse Curve\+Private\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em eddsa\+Private\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 714 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
716 \{
717    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
718    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
719 
720    \textcolor{comment}{//The CurvePrivateKey structure is encapsulated within an octet string}
721    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
722    \textcolor{comment}{//Failed to decode ASN.1 tag?}
723    \textcolor{keywordflow}{if}(error)
724       \textcolor{keywordflow}{return} error;
725 
726    \textcolor{comment}{//Save the EdDSA private key}
727    eddsaPrivateKey->\hyperlink{structPkcs8EddsaPrivateKey_a65e556cbe51c97815cf1b7eeb39e7683}{d} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
728    eddsaPrivateKey->\hyperlink{structPkcs8EddsaPrivateKey_a5806438d23d571cf0f83c4a6e2f83f98}{dLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
729 
730    \textcolor{comment}{//Successful processing}
731    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
732 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a28a2d609aa920064a7c9264afc6eb0f8}\label{pkcs8__key__parse_8c_a28a2d609aa920064a7c9264afc6eb0f8}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Parse\+Private\+Key\+Algo@{pkcs8\+Parse\+Private\+Key\+Algo}}
\index{pkcs8\+Parse\+Private\+Key\+Algo@{pkcs8\+Parse\+Private\+Key\+Algo}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Parse\+Private\+Key\+Algo()}{pkcs8ParsePrivateKeyAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Parse\+Private\+Key\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$}]{private\+Key\+Info }\end{DoxyParamCaption})}



Parse Private\+Key\+Algorithm structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em private\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 185 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
187 \{
188    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
189    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
190 
191    \textcolor{comment}{//Read the contents of the PrivateKeyAlgorithm structure}
192    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
193    \textcolor{comment}{//Failed to decode ASN.1 tag?}
194    \textcolor{keywordflow}{if}(error)
195       \textcolor{keywordflow}{return} error;
196 
197    \textcolor{comment}{//Save the total length of the field}
198    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
199 
200    \textcolor{comment}{//Point to the first field of the sequence}
201    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
202    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
203 
204    \textcolor{comment}{//Read the private key algorithm identifier}
205    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
206    \textcolor{comment}{//Failed to decode ASN.1 tag?}
207    \textcolor{keywordflow}{if}(error)
208       \textcolor{keywordflow}{return} error;
209 
210    \textcolor{comment}{//Save the private key algorithm identifier}
211    privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
212    privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
213 
214    \textcolor{comment}{//Point to the next field (if any)}
215    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
216    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
217 
218 \textcolor{preprocessor}{#if (RSA\_SUPPORT == ENABLED)}
219    \textcolor{comment}{//RSA algorithm identifier?}
220    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})))
221    \{
222       \textcolor{comment}{//The parameters field must have ASN.1 type NULL for this algorithm}
223       \textcolor{comment}{//identifier (refer to RFC 3279, section 2.3.1)}
224       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
225    \}
226    \textcolor{comment}{//RSA-PSS algorithm identifier?}
227    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
228    \{
229       \textcolor{comment}{//The parameters may be either absent or present when used as subject}
230       \textcolor{comment}{//public key information (refer to RFC 4055, section 3.1)}
231       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
232    \}
233    \textcolor{keywordflow}{else}
234 \textcolor{preprocessor}{#endif}
235 \textcolor{preprocessor}{#if (DSA\_SUPPORT == ENABLED)}
236    \textcolor{comment}{//DSA algorithm identifier?}
237    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
238    \{
239       \textcolor{comment}{//Read DsaParameters structure}
240       error = \hyperlink{certificate_2x509__cert__parse_8c_afa7c44bc9c776d4bdb4a03519ef894a5}{x509ParseDsaParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
241          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a39c25a14822c36dc314a432ebe8dda8c}{dsaParams});
242    \}
243    \textcolor{keywordflow}{else}
244 \textcolor{preprocessor}{#endif}
245 \textcolor{preprocessor}{#if (EC\_SUPPORT == ENABLED)}
246    \textcolor{comment}{//EC public key identifier?}
247    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
248    \{
249       \textcolor{comment}{//Read ECParameters structure}
250       error = \hyperlink{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}{x509ParseEcParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
251          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aac7a6c1cc222b5d7c40ade99d632f92f}{ecParams});
252    \}
253    \textcolor{keywordflow}{else}
254 \textcolor{preprocessor}{#endif}
255 \textcolor{preprocessor}{#if (ED25519\_SUPPORT == ENABLED)}
256    \textcolor{comment}{//X25519 or Ed25519 algorithm identifier?}
257    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID})) ||
258       !\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
259    \{
260       \textcolor{comment}{//For all of the OIDs, the parameters must be absent (refer to RFC 8410,}
261       \textcolor{comment}{//section 3)}
262       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
263    \}
264    \textcolor{keywordflow}{else}
265 \textcolor{preprocessor}{#endif}
266 \textcolor{preprocessor}{#if (ED448\_SUPPORT == ENABLED)}
267    \textcolor{comment}{//X448 or Ed448 algorithm identifier?}
268    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID})) ||
269       !\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
270    \{
271       \textcolor{comment}{//For all of the OIDs, the parameters must be absent (refer to RFC 8410,}
272       \textcolor{comment}{//section 3)}
273       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
274    \}
275    \textcolor{keywordflow}{else}
276 \textcolor{preprocessor}{#endif}
277    \textcolor{comment}{//Unknown algorithm identifier?}
278    \{
279       \textcolor{comment}{//Report an error}
280       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
281    \}
282 
283    \textcolor{comment}{//Return status code}
284    \textcolor{keywordflow}{return} error;
285 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_af62e7988b51a0bb9b5ad79db6da97c54}\label{pkcs8__key__parse_8c_af62e7988b51a0bb9b5ad79db6da97c54}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Parse\+Private\+Key\+Info@{pkcs8\+Parse\+Private\+Key\+Info}}
\index{pkcs8\+Parse\+Private\+Key\+Info@{pkcs8\+Parse\+Private\+Key\+Info}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Parse\+Private\+Key\+Info()}{pkcs8ParsePrivateKeyInfo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Parse\+Private\+Key\+Info (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8\+Private\+Key\+Info} $\ast$}]{private\+Key\+Info }\end{DoxyParamCaption})}



Parse Private\+Key\+Info structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em private\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 56 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
58 \{
59    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
60    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
61    \textcolor{keywordtype}{size\_t} oidLen;
62    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid};
63    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
64 
65    \textcolor{comment}{//Clear the PrivateKeyInfo structure}
66    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(privateKeyInfo, 0, \textcolor{keyword}{sizeof}(\hyperlink{structPkcs8PrivateKeyInfo}{Pkcs8PrivateKeyInfo}));
67 
68    \textcolor{comment}{//The private key information is encapsulated within a sequence}
69    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
70    \textcolor{comment}{//Failed to decode ASN.1 tag?}
71    \textcolor{keywordflow}{if}(error)
72       \textcolor{keywordflow}{return} error;
73 
74    \textcolor{comment}{//Point to the first field of the sequence}
75    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
76    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
77 
78    \textcolor{comment}{//Read Version field}
79    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_a4a1c74a37ee236610d867fedd0246e78}{version});
80    \textcolor{comment}{//Failed to decode ASN.1 tag?}
81    \textcolor{keywordflow}{if}(error)
82       \textcolor{keywordflow}{return} error;
83 
84    \textcolor{comment}{//Point to the next field}
85    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
86    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
87 
88    \textcolor{comment}{//Read PrivateKeyAlgorithm field}
89    error = \hyperlink{pkcs8__key__parse_8c_a28a2d609aa920064a7c9264afc6eb0f8}{pkcs8ParsePrivateKeyAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, privateKeyInfo);
90    \textcolor{comment}{//Failed to decode ASN.1 tag?}
91    \textcolor{keywordflow}{if}(error)
92       \textcolor{keywordflow}{return} error;
93 
94    \textcolor{comment}{//Point to the next field}
95    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
96    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
97 
98    \textcolor{comment}{//The PrivateKey is encapsulated within an octet string}
99    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
100    \textcolor{comment}{//Failed to decode ASN.1 tag?}
101    \textcolor{keywordflow}{if}(error)
102       \textcolor{keywordflow}{return} error;
103 
104    \textcolor{comment}{//Point to the private key}
105    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
106    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
107 
108    \textcolor{comment}{//Get the private key algorithm identifier}
109    oid = privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a233da5c7077e926f9d337e69892f4fb1}{oid};
110    oidLen = privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a77b3088c43e5ad25a5caedcddcb15a2f}{oidLen};
111 
112 \textcolor{preprocessor}{#if (RSA\_SUPPORT == ENABLED)}
113    \textcolor{comment}{//RSA or RSA-PSS algorithm identifier?}
114    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})) ||
115       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
116    \{
117       \textcolor{comment}{//Read RSAPrivateKey structure}
118       error = \hyperlink{pkcs8__key__parse_8c_a331e97be9c59e5c93bd628ff7c57b99a}{pkcs8ParseRsaPrivateKey}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
119          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a283526fe608f6a28f2f7fcbd85ef67bb}{rsaPrivateKey});
120    \}
121    \textcolor{keywordflow}{else}
122 \textcolor{preprocessor}{#endif}
123 \textcolor{preprocessor}{#if (DSA\_SUPPORT == ENABLED)}
124    \textcolor{comment}{//DSA algorithm identifier?}
125    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
126    \{
127       \textcolor{comment}{//Read DSAPrivateKey structure}
128       error = \hyperlink{pkcs8__key__parse_8c_a40f662465ee7609eb06793f75780caee}{pkcs8ParseDsaPrivateKey}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL},
129          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_a652af88cbae3bcea5818155c8ca9d2db}{dsaPrivateKey});
130    \}
131    \textcolor{keywordflow}{else}
132 \textcolor{preprocessor}{#endif}
133 \textcolor{preprocessor}{#if (EC\_SUPPORT == ENABLED)}
134    \textcolor{comment}{//EC public key identifier?}
135    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
136    \{
137       \textcolor{comment}{//Read ECPrivateKey structure}
138       error = \hyperlink{pkcs8__key__parse_8c_a4876889b45a4452389bd2e0b44c74ab1}{pkcs8ParseEcPrivateKey}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &privateKeyInfo->
      \hyperlink{structPkcs8PrivateKeyInfo_aac7a6c1cc222b5d7c40ade99d632f92f}{ecParams},
139          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_abb7fbb9eeceb773e8d5ff034021429f2}{ecPrivateKey});
140    \}
141    \textcolor{keywordflow}{else}
142 \textcolor{preprocessor}{#endif}
143 \textcolor{preprocessor}{#if (ED25519\_SUPPORT == ENABLED)}
144    \textcolor{comment}{//X25519 or Ed25519 algorithm identifier?}
145    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID})) ||
146       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
147    \{
148       \textcolor{comment}{//Read CurvePrivateKey structure}
149       error = \hyperlink{pkcs8__key__parse_8c_a194df8a37067959530eab09ae2ca92d3}{pkcs8ParseEddsaPrivateKey}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
150          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey});
151    \}
152    \textcolor{keywordflow}{else}
153 \textcolor{preprocessor}{#endif}
154 \textcolor{preprocessor}{#if (ED448\_SUPPORT == ENABLED)}
155    \textcolor{comment}{//X448 or Ed448 algorithm identifier?}
156    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID})) ||
157       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
158    \{
159       \textcolor{comment}{//Read CurvePrivateKey structure}
160       error = \hyperlink{pkcs8__key__parse_8c_a194df8a37067959530eab09ae2ca92d3}{pkcs8ParseEddsaPrivateKey}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
161          &privateKeyInfo->\hyperlink{structPkcs8PrivateKeyInfo_aa760f743bbb0c67c24074058cecbe30f}{eddsaPrivateKey});
162    \}
163    \textcolor{keywordflow}{else}
164 \textcolor{preprocessor}{#endif}
165    \textcolor{comment}{//Unknown algorithm identifier?}
166    \{
167       \textcolor{comment}{//Report an error}
168       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2bc2298123e24e3d82592b5c68c20612}{ERROR\_WRONG\_IDENTIFIER};
169    \}
170 
171    \textcolor{comment}{//Return status code}
172    \textcolor{keywordflow}{return} error;
173 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkcs8__key__parse_8c_a331e97be9c59e5c93bd628ff7c57b99a}\label{pkcs8__key__parse_8c_a331e97be9c59e5c93bd628ff7c57b99a}} 
\index{pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}!pkcs8\+Parse\+Rsa\+Private\+Key@{pkcs8\+Parse\+Rsa\+Private\+Key}}
\index{pkcs8\+Parse\+Rsa\+Private\+Key@{pkcs8\+Parse\+Rsa\+Private\+Key}!pkcs8\+\_\+key\+\_\+parse.\+c@{pkcs8\+\_\+key\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{pkcs8\+Parse\+Rsa\+Private\+Key()}{pkcs8ParseRsaPrivateKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} pkcs8\+Parse\+Rsa\+Private\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structPkcs8RsaPrivateKey}{Pkcs8\+Rsa\+Private\+Key} $\ast$}]{rsa\+Private\+Key }\end{DoxyParamCaption})}



Parse R\+S\+A\+Private\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Private\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 296 of file pkcs8\+\_\+key\+\_\+parse.\+c.


\begin{DoxyCode}
298 \{
299    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
300    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
301 
302    \textcolor{comment}{//Read RSAPrivateKey structure}
303    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
304    \textcolor{comment}{//Failed to decode ASN.1 tag?}
305    \textcolor{keywordflow}{if}(error)
306       \textcolor{keywordflow}{return} error;
307 
308    \textcolor{comment}{//Point to the first field}
309    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
310    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
311 
312    \textcolor{comment}{//Read Version field}
313    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &rsaPrivateKey->
      \hyperlink{structPkcs8RsaPrivateKey_aef9252c5a9c491f2d555bcc72cc5dd3a}{version});
314    \textcolor{comment}{//Failed to decode ASN.1 tag?}
315    \textcolor{keywordflow}{if}(error)
316       \textcolor{keywordflow}{return} error;
317 
318    \textcolor{comment}{//Point to the next field}
319    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
320    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
321 
322    \textcolor{comment}{//Read Modulus field}
323    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
324    \textcolor{comment}{//Failed to decode ASN.1 tag?}
325    \textcolor{keywordflow}{if}(error)
326       \textcolor{keywordflow}{return} error;
327 
328    \textcolor{comment}{//Enforce encoding, class and type}
329    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
330    \textcolor{comment}{//Invalid tag?}
331    \textcolor{keywordflow}{if}(error)
332       \textcolor{keywordflow}{return} error;
333 
334    \textcolor{comment}{//Save the modulus}
335    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_ae7d21db6f648db24b15e7903df25f46f}{n} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
336    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a947768dc9001e1987637b0270bbd0459}{nLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
337 
338    \textcolor{comment}{//Point to the next field}
339    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
340    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
341 
342    \textcolor{comment}{//Read PublicExponent field}
343    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
344    \textcolor{comment}{//Failed to decode ASN.1 tag?}
345    \textcolor{keywordflow}{if}(error)
346       \textcolor{keywordflow}{return} error;
347 
348    \textcolor{comment}{//Enforce encoding, class and type}
349    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
350    \textcolor{comment}{//Invalid tag?}
351    \textcolor{keywordflow}{if}(error)
352       \textcolor{keywordflow}{return} error;
353 
354    \textcolor{comment}{//Save the public exponent}
355    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a2946cc6004722d2074d3b267e97daef8}{e} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
356    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a899452f1ccd061c9ff81517a441b3299}{eLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
357 
358    \textcolor{comment}{//Point to the next field}
359    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
360    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
361 
362    \textcolor{comment}{//Read PrivateExponent field}
363    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
364    \textcolor{comment}{//Failed to decode ASN.1 tag?}
365    \textcolor{keywordflow}{if}(error)
366       \textcolor{keywordflow}{return} error;
367 
368    \textcolor{comment}{//Enforce encoding, class and type}
369    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
370    \textcolor{comment}{//Invalid tag?}
371    \textcolor{keywordflow}{if}(error)
372       \textcolor{keywordflow}{return} error;
373 
374    \textcolor{comment}{//Save the private exponent}
375    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a011925e3908af99efcc106424aed7498}{d} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
376    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a20dba37d8944eaa4f0384e092490a05a}{dLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
377 
378    \textcolor{comment}{//Point to the next field}
379    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
380    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
381 
382    \textcolor{comment}{//Read Prime1 field}
383    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
384    \textcolor{comment}{//Failed to decode ASN.1 tag?}
385    \textcolor{keywordflow}{if}(error)
386       \textcolor{keywordflow}{return} error;
387 
388    \textcolor{comment}{//Enforce encoding, class and type}
389    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
390    \textcolor{comment}{//Invalid tag?}
391    \textcolor{keywordflow}{if}(error)
392       \textcolor{keywordflow}{return} error;
393 
394    \textcolor{comment}{//Save the first factor}
395    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_ae62dece22d7f28257445b4b5a3a4f200}{p} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
396    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a90ceb269ed09aad82e4ef4b6cfd269df}{pLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
397 
398    \textcolor{comment}{//Point to the next field}
399    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
400    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
401 
402    \textcolor{comment}{//Read Prime2 field}
403    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
404    \textcolor{comment}{//Failed to decode ASN.1 tag?}
405    \textcolor{keywordflow}{if}(error)
406       \textcolor{keywordflow}{return} error;
407 
408    \textcolor{comment}{//Enforce encoding, class and type}
409    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
410    \textcolor{comment}{//Invalid tag?}
411    \textcolor{keywordflow}{if}(error)
412       \textcolor{keywordflow}{return} error;
413 
414    \textcolor{comment}{//Save the second factor}
415    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a129f4bc46975ed98556bc42c75151782}{q} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
416    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a14e1e918936b22f7663dc9d4592eddce}{qLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
417 
418    \textcolor{comment}{//Point to the next field}
419    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
420    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
421 
422    \textcolor{comment}{//Read Exponent1 field}
423    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
424    \textcolor{comment}{//Failed to decode ASN.1 tag?}
425    \textcolor{keywordflow}{if}(error)
426       \textcolor{keywordflow}{return} error;
427 
428    \textcolor{comment}{//Enforce encoding, class and type}
429    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
430    \textcolor{comment}{//Invalid tag?}
431    \textcolor{keywordflow}{if}(error)
432       \textcolor{keywordflow}{return} error;
433 
434    \textcolor{comment}{//Save the first exponent}
435    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a690dd0e589139f5326246b771a11552f}{dp} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
436    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a633d0d5b421c4ed1c965bc0fa62e6ffc}{dpLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
437 
438    \textcolor{comment}{//Point to the next field}
439    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
440    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
441 
442    \textcolor{comment}{//Read Exponent2 field}
443    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
444    \textcolor{comment}{//Failed to decode ASN.1 tag?}
445    \textcolor{keywordflow}{if}(error)
446       \textcolor{keywordflow}{return} error;
447 
448    \textcolor{comment}{//Enforce encoding, class and type}
449    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
450    \textcolor{comment}{//Invalid tag?}
451    \textcolor{keywordflow}{if}(error)
452       \textcolor{keywordflow}{return} error;
453 
454    \textcolor{comment}{//Save the second exponent}
455    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_ab38c39fc716f64b8860d31e4ba89405f}{dq} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
456    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a594a1b4818730a79d59b9023a00227dd}{dqLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
457 
458    \textcolor{comment}{//Point to the next field}
459    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
460    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
461 
462    \textcolor{comment}{//Read Coefficient field}
463    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
464    \textcolor{comment}{//Failed to decode ASN.1 tag?}
465    \textcolor{keywordflow}{if}(error)
466       \textcolor{keywordflow}{return} error;
467 
468    \textcolor{comment}{//Enforce encoding, class and type}
469    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
470    \textcolor{comment}{//Invalid tag?}
471    \textcolor{keywordflow}{if}(error)
472       \textcolor{keywordflow}{return} error;
473 
474    \textcolor{comment}{//Save the coefficient}
475    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a573ca0ff349e3265efcfdebda8442cc4}{qinv} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
476    rsaPrivateKey->\hyperlink{structPkcs8RsaPrivateKey_a7e17613233cfc76c147bcf432f30488c}{qinvLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
477 
478    \textcolor{comment}{//Successful processing}
479    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
480 \}
\end{DoxyCode}
