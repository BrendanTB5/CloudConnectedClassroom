\hypertarget{snmp__agent__inform_8c}{}\section{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+inform.c File Reference}
\label{snmp__agent__inform_8c}\index{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+inform.\+c@{cyclone\+\_\+tcp/snmp/snmp\+\_\+agent\+\_\+inform.\+c}}


S\+N\+MP inform notifications.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent\+\_\+misc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}snmp/snmp\+\_\+agent\+\_\+inform.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mibs/mib2\+\_\+module.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{snmp__agent__inform_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__inform_8c_aec9b2ad134f1fbb61e5f44605a80e470}{snmp\+Format\+Inform\+Request\+Message} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version} \hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$user\+Name, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} generic\+Trap\+Type, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} specific\+Trap\+Code, const \hyperlink{structSnmpTrapObject}{Snmp\+Trap\+Object} $\ast$object\+List, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} object\+List\+Size)
\begin{DoxyCompactList}\small\item\em Format S\+N\+MP Inform\+Request message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__inform_8c_a2b00be11ad06c49d9f2bef18774428cb}{snmp\+Format\+Inform\+Request\+Pdu} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version} \hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version}, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$user\+Name, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} generic\+Trap\+Type, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} specific\+Trap\+Code, const \hyperlink{structSnmpTrapObject}{Snmp\+Trap\+Object} $\ast$object\+List, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} object\+List\+Size)
\begin{DoxyCompactList}\small\item\em Format Inform\+Request-\/\+P\+DU. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__inform_8c_abdec1fb63c64b654b6b65ff2aafc43f4}{snmp\+Format\+Get\+Request\+Message} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version} \hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Format S\+N\+MP Get\+Request message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__inform_8c_a1a8010a71a85e0663c1189be2a44f2f4}{snmp\+Format\+Get\+Request\+Pdu} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context, \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version} \hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Format Get\+Request-\/\+P\+DU (engine ID discovery procedure) \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__inform_8c_aed61e23f69d2a95582c4bc5eef684c3a}{snmp\+Process\+Get\+Response\+Pdu} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Process Get\+Response-\/\+P\+DU. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{snmp__agent__inform_8c_aae2be915291db87bf2947f45f971cdd7}{snmp\+Process\+Report\+Pdu} (\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Process Report-\/\+P\+DU. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+N\+MP inform notifications. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{snmp__agent__inform_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{snmp__agent__inform_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{net__config_8h_af5cf34762d7114743a58dd8a05289bd9}{S\+N\+M\+P\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file snmp\+\_\+agent\+\_\+inform.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{snmp__agent__inform_8c_abdec1fb63c64b654b6b65ff2aafc43f4}\label{snmp__agent__inform_8c_abdec1fb63c64b654b6b65ff2aafc43f4}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!snmp\+Format\+Get\+Request\+Message@{snmp\+Format\+Get\+Request\+Message}}
\index{snmp\+Format\+Get\+Request\+Message@{snmp\+Format\+Get\+Request\+Message}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{snmp\+Format\+Get\+Request\+Message()}{snmpFormatGetRequestMessage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Format\+Get\+Request\+Message (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{\hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version}}]{version }\end{DoxyParamCaption})}



Format S\+N\+MP Get\+Request message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em version} & S\+N\+MP version identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 328 of file snmp\+\_\+agent\+\_\+inform.\+c.


\begin{DoxyCode}
330 \{
331    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
332 
333    \textcolor{comment}{//Clear the security profile}
334    memset(&context->user, 0, \textcolor{keyword}{sizeof}(\hyperlink{structSnmpUserEntry}{SnmpUserEntry}));
335 
336    \textcolor{comment}{//Format GetRequest-PDU}
337    error = \hyperlink{snmp__agent__inform_8c_a1a8010a71a85e0663c1189be2a44f2f4}{snmpFormatGetRequestPdu}(context, \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version});
338    \textcolor{comment}{//Any error to report?}
339    \textcolor{keywordflow}{if}(error)
340       \textcolor{keywordflow}{return} error;
341 
342    \textcolor{comment}{//Format scopedPDU}
343    error = \hyperlink{snmp__agent__message_8c_a2d4b4ddfcafc940a9d9987ce8b8e91bc}{snmpWriteScopedPdu}(&context->response);
344    \textcolor{comment}{//Any error to report?}
345    \textcolor{keywordflow}{if}(error)
346       \textcolor{keywordflow}{return} error;
347 
348    \textcolor{comment}{//Format SMNP message header}
349    error = \hyperlink{snmp__agent__message_8c_add8b6631f98a66746371b33fabf28c91}{snmpWriteMessageHeader}(&context->response);
350    \textcolor{comment}{//Any error to report?}
351    \textcolor{keywordflow}{if}(error)
352       \textcolor{keywordflow}{return} error;
353 
354    \textcolor{comment}{//Successful processing}
355    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
356 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__inform_8c_a1a8010a71a85e0663c1189be2a44f2f4}\label{snmp__agent__inform_8c_a1a8010a71a85e0663c1189be2a44f2f4}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!snmp\+Format\+Get\+Request\+Pdu@{snmp\+Format\+Get\+Request\+Pdu}}
\index{snmp\+Format\+Get\+Request\+Pdu@{snmp\+Format\+Get\+Request\+Pdu}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{snmp\+Format\+Get\+Request\+Pdu()}{snmpFormatGetRequestPdu()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Format\+Get\+Request\+Pdu (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{\hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version}}]{version }\end{DoxyParamCaption})}



Format Get\+Request-\/\+P\+DU (engine ID discovery procedure) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em version} & S\+N\+MP version identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 366 of file snmp\+\_\+agent\+\_\+inform.\+c.


\begin{DoxyCode}
367 \{
368    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
369    \hyperlink{structSnmpMessage}{SnmpMessage} *\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message};
370 
371    \textcolor{comment}{//Point to the SNMP message}
372    message = &context->response;
373    \textcolor{comment}{//Initialize SNMP message}
374    \hyperlink{snmp__agent__message_8c_a0371fc59a7828dbd4b15565d83078837}{snmpInitMessage}(message);
375 
376    \textcolor{comment}{//SNMP version identifier}
377    message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} = \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version};
378 
379 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
380    \textcolor{comment}{//SNMPv3 version?}
381    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
382    \{
383       \textcolor{comment}{//Increment message identifier}
384       message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId} = context->msgId++;
385       \textcolor{comment}{//Wrap around if necessary}
386       \textcolor{keywordflow}{if}(context->msgId < 0)
387          context->msgId = 0;
388 
389       \textcolor{comment}{//Save the value of the msgId field}
390       context->informMsgId = message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId};
391 
392       \textcolor{comment}{//Maximum message size supported by the sender}
393       message->\hyperlink{structSnmpMessage_a078984d1faa7cb4eb2e7978261c8cba6}{msgMaxSize} = \hyperlink{snmp__common_8h_af5a22cbaa4973c106e664d5d01316fae}{SNMP\_MAX\_MSG\_SIZE};
394 
395       \textcolor{comment}{//The reportable flag must always be set for request-type PDUs (refer}
396       \textcolor{comment}{//to RFC 3412, section 6.4)}
397       message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} |= \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a535d8aaf27fde907de003fadf1189cd7}{SNMP\_MSG\_FLAG\_REPORTABLE};
398 
399       \textcolor{comment}{//Security model used by the sender}
400       message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel} = \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a21c6309103699e29211c87fd78c79521}{SNMP\_SECURITY\_MODEL\_USM};
401    \}
402 \textcolor{preprocessor}{#endif}
403 
404    \textcolor{comment}{//Prepare to send an GetRequest-PDU}
405    message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} = \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa2c6d80868e156130b005e1d303f1672a}{SNMP\_PDU\_GET\_REQUEST};
406 
407    \textcolor{comment}{//Increment request identifier}
408    message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId} = context->requestId++;
409    \textcolor{comment}{//Wrap around if necessary}
410    \textcolor{keywordflow}{if}(context->requestId < 0)
411       context->requestId = 0;
412 
413    \textcolor{comment}{//Save the value of the request-id field}
414    context->informRequestId = message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId};
415 
416    \textcolor{comment}{//Make room for the message header at the beginning of the buffer}
417    error = \hyperlink{snmp__agent__message_8c_a804b9d2437d32dbc6c85f1b7769e727d}{snmpComputeMessageOverhead}(&context->response);
418    \textcolor{comment}{//Any error to report?}
419    \textcolor{keywordflow}{if}(error)
420       \textcolor{keywordflow}{return} error;
421 
422    \textcolor{comment}{//Format PDU header}
423    error = \hyperlink{snmp__agent__message_8c_a8b5e6d1e43fef67326204bf6999d9b18}{snmpWritePduHeader}(&context->response);
424    \textcolor{comment}{//Return status code}
425    \textcolor{keywordflow}{return} error;
426 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__inform_8c_aec9b2ad134f1fbb61e5f44605a80e470}\label{snmp__agent__inform_8c_aec9b2ad134f1fbb61e5f44605a80e470}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!snmp\+Format\+Inform\+Request\+Message@{snmp\+Format\+Inform\+Request\+Message}}
\index{snmp\+Format\+Inform\+Request\+Message@{snmp\+Format\+Inform\+Request\+Message}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{snmp\+Format\+Inform\+Request\+Message()}{snmpFormatInformRequestMessage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Format\+Inform\+Request\+Message (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{\hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version}}]{version,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{user\+Name,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{generic\+Trap\+Type,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{specific\+Trap\+Code,  }\item[{const \hyperlink{structSnmpTrapObject}{Snmp\+Trap\+Object} $\ast$}]{object\+List,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{object\+List\+Size }\end{DoxyParamCaption})}



Format S\+N\+MP Inform\+Request message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em version} & S\+N\+MP version identifier \\
\hline
\mbox{\tt in}  & {\em user\+Name} & User name or community name \\
\hline
\mbox{\tt in}  & {\em generic\+Trap\+Type} & Generic trap type \\
\hline
\mbox{\tt in}  & {\em specific\+Trap\+Code} & Specific code \\
\hline
\mbox{\tt in}  & {\em object\+List} & List of object names \\
\hline
\mbox{\tt in}  & {\em object\+List\+Size} & Number of entries in the list \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 58 of file snmp\+\_\+agent\+\_\+inform.\+c.


\begin{DoxyCode}
62 \{
63    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
64 
65 \textcolor{preprocessor}{#if (SNMP\_V2C\_SUPPORT == ENABLED)}
66    \textcolor{comment}{//SNMPv2c version?}
67    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfaa35575472195d72a958b8482d425c2b5}{SNMP\_VERSION\_2C})
68    \{
69       \textcolor{comment}{//Format InformRequest-PDU}
70       error = \hyperlink{snmp__agent__inform_8c_a2b00be11ad06c49d9f2bef18774428cb}{snmpFormatInformRequestPdu}(context, 
      \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version}, userName,
71          genericTrapType, specificTrapCode, objectList, objectListSize);
72       \textcolor{comment}{//Any error to report?}
73       \textcolor{keywordflow}{if}(error)
74          \textcolor{keywordflow}{return} error;
75 
76       \textcolor{comment}{//Format SMNP message header}
77       error = \hyperlink{snmp__agent__message_8c_add8b6631f98a66746371b33fabf28c91}{snmpWriteMessageHeader}(&context->response);
78       \textcolor{comment}{//Any error to report?}
79       \textcolor{keywordflow}{if}(error)
80          \textcolor{keywordflow}{return} error;
81    \}
82    \textcolor{keywordflow}{else}
83 \textcolor{preprocessor}{#endif}
84 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
85    \textcolor{comment}{//SNMPv3 version?}
86    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
87    \{
88       \hyperlink{structSnmpUserEntry}{SnmpUserEntry} *user;
89 
90       \textcolor{comment}{//Information about the user name is extracted from the local}
91       \textcolor{comment}{//configuration datastore}
92       user = \hyperlink{snmp__agent__usm_8c_adb4ad71f3b5167a13a2551f075c25110}{snmpFindUserEntry}(context, userName, strlen(userName));
93 
94       \textcolor{comment}{//Invalid user name?}
95       \textcolor{keywordflow}{if}(user == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || user->\hyperlink{structSnmpUserEntry_add2c8c54d828652fa85a0697654e0573}{status} != \hyperlink{mib__common_8h_a40ce1ea958f5c3b04f841d76f5557097a438de565ef13d128f16f420284316088}{MIB\_ROW\_STATUS\_ACTIVE})
96          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cadd2abf704c42af2698ebeccb4dd2bf85}{ERROR\_UNKNOWN\_USER\_NAME};
97 
98       \textcolor{comment}{//Save the security profile associated with the current user}
99       context->user = *user;
100 
101       \textcolor{comment}{//Localize the authentication key with the engine ID of the}
102       \textcolor{comment}{//remote SNMP device}
103       \textcolor{keywordflow}{if}(context->user.authProtocol != \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a2c9ec503096d5f8c9f31352c4ad6488b}{SNMP\_AUTH\_PROTOCOL\_NONE})
104       \{
105          \textcolor{comment}{//Key localization algorithm}
106          error = \hyperlink{snmp__agent__usm_8c_a169a3d5db383131661599d6b19d81ee5}{snmpLocalizeKey}(context->user.authProtocol,
107             context->informContextEngine, context->informContextEngineLen,
108             &context->user.rawAuthKey, &context->user.localizedAuthKey);
109          \textcolor{comment}{//Any error to report?}
110          \textcolor{keywordflow}{if}(error)
111             \textcolor{keywordflow}{return} error;
112       \}
113 
114       \textcolor{comment}{//Localize the privacy key with the engine ID of the remote}
115       \textcolor{comment}{//SNMP device}
116       \textcolor{keywordflow}{if}(context->user.privProtocol != \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a2c9ec503096d5f8c9f31352c4ad6488b}{SNMP\_AUTH\_PROTOCOL\_NONE})
117       \{
118          \textcolor{comment}{//Key localization algorithm}
119          error = \hyperlink{snmp__agent__usm_8c_a169a3d5db383131661599d6b19d81ee5}{snmpLocalizeKey}(context->user.authProtocol,
120             context->informContextEngine, context->informContextEngineLen,
121             &context->user.rawPrivKey, &context->user.localizedPrivKey);
122          \textcolor{comment}{//Any error to report?}
123          \textcolor{keywordflow}{if}(error)
124             \textcolor{keywordflow}{return} error;
125       \}
126 
127       \textcolor{comment}{//Format InformRequest-PDU}
128       error = \hyperlink{snmp__agent__inform_8c_a2b00be11ad06c49d9f2bef18774428cb}{snmpFormatInformRequestPdu}(context, 
      \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version}, userName,
129          genericTrapType, specificTrapCode, objectList, objectListSize);
130       \textcolor{comment}{//Any error to report?}
131       \textcolor{keywordflow}{if}(error)
132          \textcolor{keywordflow}{return} error;
133 
134       \textcolor{comment}{//Format scopedPDU}
135       error = \hyperlink{snmp__agent__message_8c_a2d4b4ddfcafc940a9d9987ce8b8e91bc}{snmpWriteScopedPdu}(&context->response);
136       \textcolor{comment}{//Any error to report?}
137       \textcolor{keywordflow}{if}(error)
138          \textcolor{keywordflow}{return} error;
139 
140       \textcolor{comment}{//Check whether the privFlag is set}
141       \textcolor{keywordflow}{if}(context->response.msgFlags & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a09a0d3b1da3227488bf9ccc2cc8a48e2}{SNMP\_MSG\_FLAG\_PRIV})
142       \{
143          \textcolor{comment}{//Encrypt data}
144          error = \hyperlink{snmp__agent__usm_8c_a3cb6959af6963c5f5d593a28e7f72ee7}{snmpEncryptData}(&context->user, &context->response,
145             &context->salt);
146          \textcolor{comment}{//Any error to report?}
147          \textcolor{keywordflow}{if}(error)
148             \textcolor{keywordflow}{return} error;
149       \}
150 
151       \textcolor{comment}{//Format SMNP message header}
152       error = \hyperlink{snmp__agent__message_8c_add8b6631f98a66746371b33fabf28c91}{snmpWriteMessageHeader}(&context->response);
153       \textcolor{comment}{//Any error to report?}
154       \textcolor{keywordflow}{if}(error)
155          \textcolor{keywordflow}{return} error;
156 
157       \textcolor{comment}{//Check whether the authFlag is set}
158       \textcolor{keywordflow}{if}(context->response.msgFlags & \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a8b9b4731d377864f4e13821af7cd3329}{SNMP\_MSG\_FLAG\_AUTH})
159       \{
160          \textcolor{comment}{//Authenticate outgoing SNMP message}
161          error = \hyperlink{snmp__agent__usm_8c_ac995a1d7cfdf5f25efd29f7e5c1f7c0d}{snmpAuthOutgoingMessage}(&context->user, &context->response);
162          \textcolor{comment}{//Any error to report?}
163          \textcolor{keywordflow}{if}(error)
164             \textcolor{keywordflow}{return} error;
165       \}
166    \}
167    \textcolor{keywordflow}{else}
168 \textcolor{preprocessor}{#endif}
169    \textcolor{comment}{//Invalid SNMP version?}
170    \{
171       \textcolor{comment}{//Debug message}
172       \hyperlink{debug_8h_a72b9761add7486364dba449091cd2579}{TRACE\_WARNING}(\textcolor{stringliteral}{"  Invalid SNMP version!\(\backslash\)r\(\backslash\)n"});
173       \textcolor{comment}{//Report an error}
174       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
175    \}
176 
177    \textcolor{comment}{//Successful processing}
178    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
179 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__inform_8c_a2b00be11ad06c49d9f2bef18774428cb}\label{snmp__agent__inform_8c_a2b00be11ad06c49d9f2bef18774428cb}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!snmp\+Format\+Inform\+Request\+Pdu@{snmp\+Format\+Inform\+Request\+Pdu}}
\index{snmp\+Format\+Inform\+Request\+Pdu@{snmp\+Format\+Inform\+Request\+Pdu}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{snmp\+Format\+Inform\+Request\+Pdu()}{snmpFormatInformRequestPdu()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Format\+Inform\+Request\+Pdu (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context,  }\item[{\hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95df}{Snmp\+Version}}]{version,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{user\+Name,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{generic\+Trap\+Type,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{specific\+Trap\+Code,  }\item[{const \hyperlink{structSnmpTrapObject}{Snmp\+Trap\+Object} $\ast$}]{object\+List,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{object\+List\+Size }\end{DoxyParamCaption})}



Format Inform\+Request-\/\+P\+DU. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\mbox{\tt in}  & {\em version} & S\+N\+MP version identifier \\
\hline
\mbox{\tt in}  & {\em user\+Name} & User name or community name \\
\hline
\mbox{\tt in}  & {\em generic\+Trap\+Type} & Generic trap type \\
\hline
\mbox{\tt in}  & {\em specific\+Trap\+Code} & Specific code \\
\hline
\mbox{\tt in}  & {\em object\+List} & List of object names \\
\hline
\mbox{\tt in}  & {\em object\+List\+Size} & Number of entries in the list \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 194 of file snmp\+\_\+agent\+\_\+inform.\+c.


\begin{DoxyCode}
198 \{
199    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
200    \hyperlink{structSnmpMessage}{SnmpMessage} *\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message};
201 
202    \textcolor{comment}{//Point to the SNMP message}
203    message = &context->response;
204    \textcolor{comment}{//Initialize SNMP message}
205    \hyperlink{snmp__agent__message_8c_a0371fc59a7828dbd4b15565d83078837}{snmpInitMessage}(message);
206 
207    \textcolor{comment}{//SNMP version identifier}
208    message->\hyperlink{structSnmpMessage_a38b300782f7395005708f45f26dae7c1}{version} = \hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version};
209 
210 \textcolor{preprocessor}{#if (SNMP\_V2C\_SUPPORT == ENABLED)}
211    \textcolor{comment}{//SNMPv2c version?}
212    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfaa35575472195d72a958b8482d425c2b5}{SNMP\_VERSION\_2C})
213    \{
214       \textcolor{comment}{//Community name}
215       message->\hyperlink{structSnmpMessage_ac9976028507798166e3f542d5806c811}{community} = userName;
216       message->\hyperlink{structSnmpMessage_a828b7eec855d512efcb5262ed979f8fa}{communityLen} = strlen(userName);
217    \}
218    \textcolor{keywordflow}{else}
219 \textcolor{preprocessor}{#endif}
220 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
221    \textcolor{comment}{//SNMPv3 version?}
222    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} == \hyperlink{snmp__common_8h_a80164b0cc3de6c48aad6917f79ee95dfa92886bc76b0167bf8604e3a266c6be9c}{SNMP\_VERSION\_3})
223    \{
224       \textcolor{comment}{//Increment message identifier}
225       message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId} = context->msgId++;
226       \textcolor{comment}{//Wrap around if necessary}
227       \textcolor{keywordflow}{if}(context->msgId < 0)
228          context->msgId = 0;
229 
230       \textcolor{comment}{//Save the value of the msgId field}
231       context->informMsgId = message->\hyperlink{structSnmpMessage_ab3f065667ee47978ab059eb754f17150}{msgId};
232 
233       \textcolor{comment}{//Maximum message size supported by the sender}
234       message->\hyperlink{structSnmpMessage_a078984d1faa7cb4eb2e7978261c8cba6}{msgMaxSize} = \hyperlink{snmp__common_8h_af5a22cbaa4973c106e664d5d01316fae}{SNMP\_MAX\_MSG\_SIZE};
235 
236       \textcolor{comment}{//Bit fields which control processing of the message}
237       \textcolor{keywordflow}{if}(context->user.authProtocol != \hyperlink{snmp__agent__usm_8h_a13c46b84c881bd15bad7093a7f3639e3a2c9ec503096d5f8c9f31352c4ad6488b}{SNMP\_AUTH\_PROTOCOL\_NONE})
238          message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} |= \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a8b9b4731d377864f4e13821af7cd3329}{SNMP\_MSG\_FLAG\_AUTH};
239       \textcolor{keywordflow}{if}(context->user.privProtocol != \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a29bcb0f6410e21559159915d4c08dac8}{SNMP\_PRIV\_PROTOCOL\_NONE})
240          message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} |= \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a09a0d3b1da3227488bf9ccc2cc8a48e2}{SNMP\_MSG\_FLAG\_PRIV};
241 
242       \textcolor{comment}{//The reportable flag must always be set for acknowledged}
243       \textcolor{comment}{//notification-type PDUs (refer to RFC 3412, section 6.4)}
244       message->\hyperlink{structSnmpMessage_a7cc5ff67bc58cd54bf3cf6f3d18879d4}{msgFlags} |= \hyperlink{snmp__agent__usm_8h_aee33010d6b1b02fc5ceef6aad55044b0a535d8aaf27fde907de003fadf1189cd7}{SNMP\_MSG\_FLAG\_REPORTABLE};
245 
246       \textcolor{comment}{//Security model used by the sender}
247       message->\hyperlink{structSnmpMessage_a868cf2ac7ba0bdb1f756cfaf419cac3c}{msgSecurityModel} = \hyperlink{snmp__agent__usm_8h_a59354ab45890b9da1b27d44f88193695a21c6309103699e29211c87fd78c79521}{SNMP\_SECURITY\_MODEL\_USM};
248 
249       \textcolor{comment}{//Authoritative engine identifier}
250       message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId} = context->informContextEngine;
251       message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} = context->informContextEngineLen;
252       \textcolor{comment}{//Number of times the SNMP engine has rebooted}
253       message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots} = context->informEngineBoots;
254       \textcolor{comment}{//Number of seconds since last reboot}
255       message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime} = context->informEngineTime;
256       \textcolor{comment}{//User name}
257       message->\hyperlink{structSnmpMessage_a83e0d7035f301d07352eb2d3b6b1679a}{msgUserName} = userName;
258       message->\hyperlink{structSnmpMessage_ac9a168d33bda6c99336def2b01440b3b}{msgUserNameLen} = strlen(userName);
259       \textcolor{comment}{//Authentication parameters}
260       message->\hyperlink{structSnmpMessage_ac458dda88c1471dabbd9ec5ca3f0f0fc}{msgAuthParameters} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
261       \textcolor{comment}{//Length of the authentication parameters}
262       message->\hyperlink{structSnmpMessage_a7b01dd73a305c550a38594c273feef27}{msgAuthParametersLen} = \hyperlink{snmp__agent__usm_8c_a4cfaee41833a90ca96cd8c6d2f945a50}{snmpGetMacLength}(context->user.
      authProtocol);
263       \textcolor{comment}{//Privacy parameters}
264       message->\hyperlink{structSnmpMessage_a06518359392967750bc6139130d489ef}{msgPrivParameters} = context->privParameters;
265 
266       \textcolor{comment}{//Length of the privacy parameters}
267       \textcolor{keywordflow}{if}(context->user.privProtocol == \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a286d2219f3f41326458583ac8f7ca4af}{SNMP\_PRIV\_PROTOCOL\_DES})
268          message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = 8;
269       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->user.privProtocol == \hyperlink{snmp__agent__usm_8h_acfd97e4fdb0cd081855bcb3d922dd851a9afc3ebc5fd421e94a7a5eca75f2520b}{SNMP\_PRIV\_PROTOCOL\_AES})
270          message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = 8;
271       \textcolor{keywordflow}{else}
272          message->\hyperlink{structSnmpMessage_afe1bf1cf0a488e38bc8b6017528c35e9}{msgPrivParametersLen} = 0;
273 
274       \textcolor{comment}{//Context engine identifier}
275       message->\hyperlink{structSnmpMessage_a737a67e1857fb23d90d149cfb0d21e1c}{contextEngineId} = context->contextEngine;
276       message->\hyperlink{structSnmpMessage_ad933640b1912b549e6f1a9280a5ce7b7}{contextEngineIdLen} = context->contextEngineLen;
277       \textcolor{comment}{//Context name}
278       message->\hyperlink{structSnmpMessage_ab7b3dc54e8e1538249e1e0e08123f0f9}{contextName} = context->contextName;
279       message->\hyperlink{structSnmpMessage_a64d47bc4ef9cdfaae0494c8b224b26cb}{contextNameLen} = strlen(context->contextName);
280    \}
281    \textcolor{keywordflow}{else}
282 \textcolor{preprocessor}{#endif}
283    \textcolor{comment}{//Invalid SNMP version?}
284    \{
285       \textcolor{comment}{//Report an error}
286       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
287    \}
288 
289    \textcolor{comment}{//Prepare to send an InformRequest-PDU}
290    message->\hyperlink{structSnmpMessage_a48ced2a20c11fcd5c72fa1c47d239343}{pduType} = \hyperlink{snmp__common_8h_a3c16ad3ed681ee8a30c429d490f9299aa4060cecdb63948db5da6be30b623244b}{SNMP\_PDU\_INFORM\_REQUEST};
291 
292    \textcolor{comment}{//Increment request identifier}
293    message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId} = context->requestId++;
294    \textcolor{comment}{//Wrap around if necessary}
295    \textcolor{keywordflow}{if}(context->requestId < 0)
296       context->requestId = 0;
297 
298    \textcolor{comment}{//Save the value of the request-id field}
299    context->informRequestId = message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId};
300 
301    \textcolor{comment}{//Make room for the message header at the beginning of the buffer}
302    error = \hyperlink{snmp__agent__message_8c_a804b9d2437d32dbc6c85f1b7769e727d}{snmpComputeMessageOverhead}(&context->response);
303    \textcolor{comment}{//Any error to report?}
304    \textcolor{keywordflow}{if}(error)
305       \textcolor{keywordflow}{return} error;
306 
307    \textcolor{comment}{//Format the list of variable bindings}
308    error = \hyperlink{snmp__agent__misc_8c_a8f9f560a07162c5953f105db4e276741}{snmpWriteTrapVarBindingList}(context, genericTrapType,
309       specificTrapCode, objectList, objectListSize);
310    \textcolor{comment}{//Any error to report?}
311    \textcolor{keywordflow}{if}(error)
312       \textcolor{keywordflow}{return} error;
313 
314    \textcolor{comment}{//Format PDU header}
315    error = \hyperlink{snmp__agent__message_8c_a8b5e6d1e43fef67326204bf6999d9b18}{snmpWritePduHeader}(&context->response);
316    \textcolor{comment}{//Return status code}
317    \textcolor{keywordflow}{return} error;
318 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__inform_8c_aed61e23f69d2a95582c4bc5eef684c3a}\label{snmp__agent__inform_8c_aed61e23f69d2a95582c4bc5eef684c3a}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!snmp\+Process\+Get\+Response\+Pdu@{snmp\+Process\+Get\+Response\+Pdu}}
\index{snmp\+Process\+Get\+Response\+Pdu@{snmp\+Process\+Get\+Response\+Pdu}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{snmp\+Process\+Get\+Response\+Pdu()}{snmpProcessGetResponsePdu()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Process\+Get\+Response\+Pdu (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Process Get\+Response-\/\+P\+DU. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 435 of file snmp\+\_\+agent\+\_\+inform.\+c.


\begin{DoxyCode}
436 \{
437    \hyperlink{structSnmpMessage}{SnmpMessage} *\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message};
438 
439    \textcolor{comment}{//Debug message}
440    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Parsing GetResponse-PDU...\(\backslash\)r\(\backslash\)n"});
441 
442    \textcolor{comment}{//Point to the incoming SNMP message}
443    message = &context->request;
444 
445    \textcolor{comment}{//Total number of SNMP Get-Response PDUs which have been accepted and}
446    \textcolor{comment}{//processed by the SNMP protocol entity}
447    \hyperlink{mib2__module_8h_abac73a39224e47d597f3b461620d2119}{MIB2\_INC\_COUNTER32}(snmpGroup.snmpInGetResponses, 1);
448 
449    \textcolor{comment}{//Check the error-status field}
450    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_afb6f5e5cf7da54678aff6c79dd5948ce}{errorStatus} == \hyperlink{snmp__common_8h_afec1d446e343fe7cfe268cf4b7753fd2aaf909d71634fc281c206312026fa9a20}{SNMP\_ERROR\_NONE})
451    \{
452       \textcolor{comment}{//Compare the request-id against the expected identifier}
453       \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_a53c30d2eaaf117a457bfd3211071540b}{requestId} == context->informRequestId)
454       \{
455          \textcolor{comment}{//The inform request has been acknowledged}
456          \hyperlink{os__port__chibios_8c_afc1d64fc90afbf03baecfa636bb99ff7}{osSetEvent}(&context->informEvent);
457       \}
458    \}
459 
460    \textcolor{comment}{//Successful processing}
461    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
462 \}
\end{DoxyCode}
\mbox{\Hypertarget{snmp__agent__inform_8c_aae2be915291db87bf2947f45f971cdd7}\label{snmp__agent__inform_8c_aae2be915291db87bf2947f45f971cdd7}} 
\index{snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}!snmp\+Process\+Report\+Pdu@{snmp\+Process\+Report\+Pdu}}
\index{snmp\+Process\+Report\+Pdu@{snmp\+Process\+Report\+Pdu}!snmp\+\_\+agent\+\_\+inform.\+c@{snmp\+\_\+agent\+\_\+inform.\+c}}
\subsubsection{\texorpdfstring{snmp\+Process\+Report\+Pdu()}{snmpProcessReportPdu()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} snmp\+Process\+Report\+Pdu (\begin{DoxyParamCaption}\item[{\hyperlink{snmp__agent_8h_a4c68afef83114acf80065b64191bfdac}{Snmp\+Agent\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Process Report-\/\+P\+DU. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the S\+N\+MP agent context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 471 of file snmp\+\_\+agent\+\_\+inform.\+c.


\begin{DoxyCode}
472 \{
473 \textcolor{preprocessor}{#if (SNMP\_V3\_SUPPORT == ENABLED)}
474    \hyperlink{structSnmpMessage}{SnmpMessage} *\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message};
475 
476    \textcolor{comment}{//Debug message}
477    \hyperlink{debug_8h_a7339bfd784193a5c79efcef2eeb2d6df}{TRACE\_INFO}(\textcolor{stringliteral}{"Parsing Report-PDU...\(\backslash\)r\(\backslash\)n"});
478 
479    \textcolor{comment}{//Point to the incoming SNMP message}
480    message = &context->request;
481 
482    \textcolor{comment}{//Sanity check}
483    \textcolor{keywordflow}{if}(message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen} <= 
      \hyperlink{snmp__common_8h_a182f7381f1e0c29ee196042008e380be}{SNMP\_MAX\_CONTEXT\_ENGINE\_SIZE})
484    \{
485       \textcolor{comment}{//Save the authoritative engine identifier}
486       memcpy(context->informContextEngine, message->\hyperlink{structSnmpMessage_a06ca20cfe6a8ffd06e259115fd417efb}{msgAuthEngineId},
487          message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen});
488 
489       \textcolor{comment}{//Save the length of the engine identifier}
490       context->informContextEngineLen = message->\hyperlink{structSnmpMessage_abe5c72a4c4f8a6c07667b0a8b6eae7ac}{msgAuthEngineIdLen};
491 
492       \textcolor{comment}{//Save the msgAuthoritativeEngineBoots field}
493       context->informEngineBoots = message->\hyperlink{structSnmpMessage_ac21a9a3e133f918bda8d8a9333609621}{msgAuthEngineBoots};
494       \textcolor{comment}{//Save the msgAuthoritativeEngineTime field}
495       context->informEngineTime = message->\hyperlink{structSnmpMessage_a3de807da8245c40a6de5365cf841ada7}{msgAuthEngineTime};
496 
497       \textcolor{comment}{//Check current state}
498       \textcolor{keywordflow}{if}(context->informState == \hyperlink{snmp__agent__inform_8h_aa426c1a6fdbc65cdfa26a178d64371fda85f3ab38761a7e5aa1668cfc6dd7b0a9}{SNMP\_AGENT\_STATE\_WAITING\_REPORT})
499       \{
500          \textcolor{comment}{//Valid context engine identifier?}
501          \textcolor{keywordflow}{if}(context->informContextEngineLen > 0)
502          \{
503             \textcolor{comment}{//The discovery process is complete}
504             \hyperlink{os__port__chibios_8c_afc1d64fc90afbf03baecfa636bb99ff7}{osSetEvent}(&context->informEvent);
505          \}
506       \}
507    \}
508 
509    \textcolor{comment}{//Successful processing}
510    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
511 \textcolor{preprocessor}{#else}
512    \textcolor{comment}{//SNMPv3 is not supported}
513    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
514 \textcolor{preprocessor}{#endif}
515 \}
\end{DoxyCode}
