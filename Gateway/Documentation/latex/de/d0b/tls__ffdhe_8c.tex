\hypertarget{tls__ffdhe_8c}{}\section{cyclone\+\_\+ssl/tls\+\_\+ffdhe.c File Reference}
\label{tls__ffdhe_8c}\index{cyclone\+\_\+ssl/tls\+\_\+ffdhe.\+c@{cyclone\+\_\+ssl/tls\+\_\+ffdhe.\+c}}


F\+F\+D\+HE key exchange.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}tls.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls\+\_\+ffdhe.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{tls__ffdhe_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{tls__config_8h_afee42a623033dac888291d1993985206}{T\+L\+S\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__ffdhe_8c_a393f2e57b8daae1ab1f0994311f373db}{tls\+Select\+Ffdhe\+Group} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, const \hyperlink{tls_8h_a697f1e9ded788afc0e198e055676b13c}{Tls\+Supported\+Group\+List} $\ast$group\+List)
\begin{DoxyCompactList}\small\item\em Select the named group to be used when performing F\+F\+D\+HE key exchange. \end{DoxyCompactList}\item 
const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} $\ast$ \hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tls\+Get\+Ffdhe\+Group} (\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$context, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} named\+Group)
\begin{DoxyCompactList}\small\item\em Get the F\+F\+D\+HE parameters that match the specified named group. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{tls__ffdhe_8c_af64246340bf23c196ad3573ee15ecfba}{tls\+Load\+Ffdhe\+Parameters} (\hyperlink{structDhParameters}{Dh\+Parameters} $\ast$params, const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} $\ast$ffdhe\+Group)
\begin{DoxyCompactList}\small\item\em Load F\+F\+D\+HE parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} \hyperlink{tls__ffdhe_8c_a1e5802ee7cd559e77b3cb8ec1ce30619}{ffdhe2048\+Group}
\begin{DoxyCompactList}\small\item\em ffdhe2048 group \end{DoxyCompactList}\item 
const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} \hyperlink{tls__ffdhe_8c_af008017d2c756dc4f1054c2bd43559c1}{ffdhe3072\+Group}
\begin{DoxyCompactList}\small\item\em ffdhe3072 group \end{DoxyCompactList}\item 
const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} \hyperlink{tls__ffdhe_8c_a0b20329eafa66bf0d8e6da5b8f90b49d}{ffdhe4096\+Group}
\begin{DoxyCompactList}\small\item\em ffdhe4096 group \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
F\+F\+D\+HE key exchange. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+S\+SL Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{tls__ffdhe_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{tls__ffdhe_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{tls__config_8h_afee42a623033dac888291d1993985206}{T\+L\+S\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file tls\+\_\+ffdhe.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}\label{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!tls\+Get\+Ffdhe\+Group@{tls\+Get\+Ffdhe\+Group}}
\index{tls\+Get\+Ffdhe\+Group@{tls\+Get\+Ffdhe\+Group}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{tls\+Get\+Ffdhe\+Group()}{tlsGetFfdheGroup()}}
{\footnotesize\ttfamily const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group}$\ast$ tls\+Get\+Ffdhe\+Group (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{named\+Group }\end{DoxyParamCaption})}



Get the F\+F\+D\+HE parameters that match the specified named group. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em named\+Group} & Named group \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
F\+F\+D\+HE parameters 
\end{DoxyReturn}


Definition at line 315 of file tls\+\_\+ffdhe.\+c.


\begin{DoxyCode}
316 \{
317    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
318    \textcolor{keyword}{const} \hyperlink{structTlsFfdheGroup}{TlsFfdheGroup} *ffdheGroup;
319 
320    \textcolor{comment}{//Check named group}
321    \textcolor{keywordflow}{switch}(namedGroup)
322    \{
323 \textcolor{preprocessor}{#if (TLS\_FFDHE2048\_SUPPORT == ENABLED)}
324    \textcolor{comment}{//ffdhe2048 group?}
325    \textcolor{keywordflow}{case} \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aabed2529bc03e1304047d1b71e75dbde}{TLS\_GROUP\_FFDHE2048}:
326       ffdheGroup = &\hyperlink{tls__ffdhe_8c_a1e5802ee7cd559e77b3cb8ec1ce30619}{ffdhe2048Group};
327       \textcolor{keywordflow}{break};
328 \textcolor{preprocessor}{#endif}
329 \textcolor{preprocessor}{#if (TLS\_FFDHE3072\_SUPPORT == ENABLED)}
330    \textcolor{comment}{//ffdhe3072 group?}
331    \textcolor{keywordflow}{case} \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51ab9d76d079e218baf29cf3646b91e67db}{TLS\_GROUP\_FFDHE3072}:
332       ffdheGroup = &\hyperlink{tls__ffdhe_8c_af008017d2c756dc4f1054c2bd43559c1}{ffdhe3072Group};
333       \textcolor{keywordflow}{break};
334 \textcolor{preprocessor}{#endif}
335 \textcolor{preprocessor}{#if (TLS\_FFDHE4096\_SUPPORT == ENABLED)}
336    \textcolor{comment}{//ffdhe4096 group?}
337    \textcolor{keywordflow}{case} \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51a2de8daeb241c7cba928cecd81ef8182a}{TLS\_GROUP\_FFDHE4096}:
338       ffdheGroup = &\hyperlink{tls__ffdhe_8c_a0b20329eafa66bf0d8e6da5b8f90b49d}{ffdhe4096Group};
339       \textcolor{keywordflow}{break};
340 \textcolor{preprocessor}{#endif}
341    \textcolor{comment}{//Unknown group?}
342    \textcolor{keywordflow}{default}:
343       ffdheGroup = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
344       \textcolor{keywordflow}{break};
345    \}
346 
347    \textcolor{comment}{//Restrict the use of certain FFDHE groups}
348    \textcolor{keywordflow}{if}(context->numSupportedGroups > 0)
349    \{
350       \textcolor{comment}{//Loop through the list of allowed named groups}
351       \textcolor{keywordflow}{for}(i = 0; i < context->numSupportedGroups; i++)
352       \{
353          \textcolor{comment}{//Compare named groups}
354          \textcolor{keywordflow}{if}(context->supportedGroups[i] == namedGroup)
355             \textcolor{keywordflow}{break};
356       \}
357 
358       \textcolor{comment}{//Check whether the use of the FFDHE group is restricted}
359       \textcolor{keywordflow}{if}(i >= context->numSupportedGroups)
360          ffdheGroup = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
361    \}
362 
363    \textcolor{comment}{//Return FFDHE parameters, if any}
364    \textcolor{keywordflow}{return} ffdheGroup;
365 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__ffdhe_8c_af64246340bf23c196ad3573ee15ecfba}\label{tls__ffdhe_8c_af64246340bf23c196ad3573ee15ecfba}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!tls\+Load\+Ffdhe\+Parameters@{tls\+Load\+Ffdhe\+Parameters}}
\index{tls\+Load\+Ffdhe\+Parameters@{tls\+Load\+Ffdhe\+Parameters}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{tls\+Load\+Ffdhe\+Parameters()}{tlsLoadFfdheParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Load\+Ffdhe\+Parameters (\begin{DoxyParamCaption}\item[{\hyperlink{structDhParameters}{Dh\+Parameters} $\ast$}]{params,  }\item[{const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} $\ast$}]{ffdhe\+Group }\end{DoxyParamCaption})}



Load F\+F\+D\+HE parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em params} & Pointer to the structure to be initialized \\
\hline
\mbox{\tt in}  & {\em ffdhe\+Group} & F\+F\+D\+HE parameters \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 375 of file tls\+\_\+ffdhe.\+c.


\begin{DoxyCode}
377 \{
378    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
379 
380    \textcolor{comment}{//Make sure the FFDHE group is supported}
381    \textcolor{keywordflow}{if}(ffdheGroup != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
382    \{
383       \textcolor{comment}{//Convert the prime modulus to a multiple precision integer}
384       error = \hyperlink{mpi_8c_a844d59498f4acce9d69ae55570b521f3}{mpiImport}(&params->\hyperlink{structDhParameters_ae39a6a92b952ae9c49c66c5c9c131a3b}{p}, ffdheGroup->\hyperlink{structTlsFfdheGroup_a3172f750e41a55b2d7ebce0fcb5d6702}{p}, ffdheGroup->\hyperlink{structTlsFfdheGroup_a17b7822dbce7311d3bcfc86e9e213ef2}{pLen},
385          \hyperlink{mpi_8h_a5fe4159c7c390c604067e854b41d337fa0912b5922ecee206ec51e40d5285f77e}{MPI\_FORMAT\_BIG\_ENDIAN});
386 
387       \textcolor{comment}{//Check status code}
388       \textcolor{keywordflow}{if}(!error)
389       \{
390          \textcolor{comment}{//Convert the generator to a multiple precision integer}
391          error = \hyperlink{mpi_8c_a1d8c5bea2b4bb91935654c4e9d05579f}{mpiSetValue}(&params->\hyperlink{structDhParameters_abc22697d6ee37e502b54f988a1c4393d}{g}, ffdheGroup->\hyperlink{structTlsFfdheGroup_a1363d7726f139d3ba42341876c5194cd}{g});
392       \}
393    \}
394    \textcolor{keywordflow}{else}
395    \{
396       \textcolor{comment}{//The specified FFDHE group is not supported}
397       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
398    \}
399 
400    \textcolor{comment}{//Return status code}
401    \textcolor{keywordflow}{return} error;
402 \}
\end{DoxyCode}
\mbox{\Hypertarget{tls__ffdhe_8c_a393f2e57b8daae1ab1f0994311f373db}\label{tls__ffdhe_8c_a393f2e57b8daae1ab1f0994311f373db}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!tls\+Select\+Ffdhe\+Group@{tls\+Select\+Ffdhe\+Group}}
\index{tls\+Select\+Ffdhe\+Group@{tls\+Select\+Ffdhe\+Group}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{tls\+Select\+Ffdhe\+Group()}{tlsSelectFfdheGroup()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} tls\+Select\+Ffdhe\+Group (\begin{DoxyParamCaption}\item[{\hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$}]{context,  }\item[{const \hyperlink{tls_8h_a697f1e9ded788afc0e198e055676b13c}{Tls\+Supported\+Group\+List} $\ast$}]{group\+List }\end{DoxyParamCaption})}



Select the named group to be used when performing F\+F\+D\+HE key exchange. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the T\+LS context \\
\hline
\mbox{\tt in}  & {\em group\+List} & List of named groups supported by the peer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 175 of file tls\+\_\+ffdhe.\+c.


\begin{DoxyCode}
177 \{
178    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
179    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
180    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
181    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
182    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} namedGroup;
183    \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\_t} ffdheGroupFound;
184 
185    \textcolor{comment}{//Initialize status code}
186    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca70d82df53df56c9d4a943d5539ccc4bc}{ERROR\_HANDSHAKE\_FAILED};
187 
188    \textcolor{comment}{//Initialize flag}
189    ffdheGroupFound = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
190 
191    \textcolor{comment}{//Reset the named group to its default value}
192    context->namedGroup = \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aee79345f691598413b1506c1a2f22548}{TLS\_GROUP\_NONE};
193 
194    \textcolor{comment}{//Check whether a list of named groups is offered by the client}
195    \textcolor{keywordflow}{if}(groupList != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
196    \{
197       \textcolor{comment}{//Get the number of named groups present in the list}
198       n = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(groupList->length) / \textcolor{keyword}{sizeof}(\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t});
199 
200       \textcolor{comment}{//Any preferred groups?}
201       \textcolor{keywordflow}{if}(context->numSupportedGroups > 0)
202       \{
203          \textcolor{comment}{//Loop through the list of allowed groups (most preferred first)}
204          \textcolor{keywordflow}{for}(i = 0; i < context->numSupportedGroups; i++)
205          \{
206             \textcolor{comment}{//Loop through the list of named groups the client supports}
207             \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j++)
208             \{
209                \textcolor{comment}{//Convert the named group to host byte order}
210                namedGroup = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(groupList->value[j]);
211 
212                \textcolor{comment}{//Check whether the SupportedGroups extension contains codepoints}
213                \textcolor{comment}{//between 256 and 511, inclusive}
214                \textcolor{keywordflow}{if}(namedGroup >= \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aabed2529bc03e1304047d1b71e75dbde}{TLS\_GROUP\_FFDHE2048} &&
215                   namedGroup <= \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aec9d3a6582c7af9f71151e1f1f2867f5}{TLS\_GROUP\_FFDHE\_MAX})
216                \{
217                   \textcolor{comment}{//The list contains at least one FFDHE group}
218                   ffdheGroupFound = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
219                \}
220 
221                \textcolor{comment}{//The named group to be used when performing FFDHE key exchange}
222                \textcolor{comment}{//must be one of those present in the SupportedGroups extension}
223                \textcolor{keywordflow}{if}(context->supportedGroups[i] == namedGroup)
224                \{
225                   \textcolor{comment}{//Acceptable FFDHE group found?}
226                   \textcolor{keywordflow}{if}(\hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tlsGetFfdheGroup}(context, namedGroup) != 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
227                   \{
228                      \textcolor{comment}{//Save the named group}
229                      \textcolor{keywordflow}{if}(context->namedGroup == \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aee79345f691598413b1506c1a2f22548}{TLS\_GROUP\_NONE})
230                      \{
231                         context->namedGroup = namedGroup;
232                      \}
233                   \}
234                \}
235             \}
236          \}
237       \}
238       \textcolor{keywordflow}{else}
239       \{
240          \textcolor{comment}{//The named group to be used when performing FFDHE key exchange must}
241          \textcolor{comment}{//be one of those present in the SupportedGroups extension}
242          \textcolor{keywordflow}{for}(j = 0; j < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; j++)
243          \{
244             \textcolor{comment}{//Convert the named group to host byte order}
245             namedGroup = \hyperlink{cpu__endian_8h_a9312c6eb72e64f748ae0d0e0dc3ec9b9}{ntohs}(groupList->value[j]);
246 
247             \textcolor{comment}{//Check whether the SupportedGroups extension contains codepoints}
248             \textcolor{comment}{//between 256 and 511, inclusive}
249             \textcolor{keywordflow}{if}(namedGroup >= \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aabed2529bc03e1304047d1b71e75dbde}{TLS\_GROUP\_FFDHE2048} &&
250                namedGroup <= \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aec9d3a6582c7af9f71151e1f1f2867f5}{TLS\_GROUP\_FFDHE\_MAX})
251             \{
252                \textcolor{comment}{//The list contains at least one FFDHE group}
253                ffdheGroupFound = \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
254             \}
255 
256             \textcolor{comment}{//Acceptable FFDHE group found?}
257             \textcolor{keywordflow}{if}(\hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tlsGetFfdheGroup}(context, namedGroup) != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
258             \{
259                \textcolor{comment}{//Save the named group}
260                \textcolor{keywordflow}{if}(context->namedGroup == \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aee79345f691598413b1506c1a2f22548}{TLS\_GROUP\_NONE})
261                \{
262                   context->namedGroup = namedGroup;
263                \}
264             \}
265          \}
266       \}
267    \}
268 
269    \textcolor{comment}{//If the SupportedGroups extension is either absent from the ClientHello}
270    \textcolor{comment}{//entirely or contains no FFDHE groups, then the server knows that the}
271    \textcolor{comment}{//client is not compatible with RFC 7919}
272    \textcolor{keywordflow}{if}(!ffdheGroupFound)
273    \{
274       \textcolor{comment}{//In this scenario, the server may select an FFDHE group of its choice}
275       \textcolor{keywordflow}{if}(\hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tlsGetFfdheGroup}(context, \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aabed2529bc03e1304047d1b71e75dbde}{TLS\_GROUP\_FFDHE2048}) != 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
276       \{
277          \textcolor{comment}{//Select ffdhe2048 finite field group}
278          context->namedGroup = \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aabed2529bc03e1304047d1b71e75dbde}{TLS\_GROUP\_FFDHE2048};
279       \}
280       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tlsGetFfdheGroup}(context, \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51ab9d76d079e218baf29cf3646b91e67db}{TLS\_GROUP\_FFDHE3072}) != 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
281       \{
282          \textcolor{comment}{//Select ffdhe3072 finite field group}
283          context->namedGroup = \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51ab9d76d079e218baf29cf3646b91e67db}{TLS\_GROUP\_FFDHE3072};
284       \}
285       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{tls__ffdhe_8c_a60d7cd3aa7ab8be3a85c776c161b3853}{tlsGetFfdheGroup}(context, \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51a2de8daeb241c7cba928cecd81ef8182a}{TLS\_GROUP\_FFDHE4096}) != 
      \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
286       \{
287          \textcolor{comment}{//Select ffdhe4096 finite field group}
288          context->namedGroup = \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51a2de8daeb241c7cba928cecd81ef8182a}{TLS\_GROUP\_FFDHE4096};
289       \}
290       \textcolor{keywordflow}{else}
291       \{
292          \textcolor{comment}{//Just for sanity}
293          context->namedGroup = \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aee79345f691598413b1506c1a2f22548}{TLS\_GROUP\_NONE};
294       \}
295    \}
296 
297    \textcolor{comment}{//If no acceptable choices are presented, then return an error}
298    \textcolor{keywordflow}{if}(context->namedGroup != \hyperlink{tls_8h_ae51675bb94f1945c0eed549ef93e6b51aee79345f691598413b1506c1a2f22548}{TLS\_GROUP\_NONE})
299    \{
300       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
301    \}
302 
303    \textcolor{comment}{//Return status code}
304    \textcolor{keywordflow}{return} error;
305 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{tls__ffdhe_8c_a1e5802ee7cd559e77b3cb8ec1ce30619}\label{tls__ffdhe_8c_a1e5802ee7cd559e77b3cb8ec1ce30619}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!ffdhe2048\+Group@{ffdhe2048\+Group}}
\index{ffdhe2048\+Group@{ffdhe2048\+Group}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{ffdhe2048\+Group}{ffdhe2048Group}}
{\footnotesize\ttfamily const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} ffdhe2048\+Group}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   
   \textcolor{stringliteral}{"ffdhe2048"},
   
   \{0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xAD, 0xF8, 0x54, 0x58, 0xA2, 0xBB, 0x4A, 0x9A,
    0xAF, 0xDC, 0x56, 0x20, 0x27, 0x3D, 0x3C, 0xF1, 0xD8, 0xB9, 0xC5, 0x83, 0xCE, 0x2D, 0x36, 0x95,
    0xA9, 0xE1, 0x36, 0x41, 0x14, 0x64, 0x33, 0xFB, 0xCC, 0x93, 0x9D, 0xCE, 0x24, 0x9B, 0x3E, 0xF9,
    0x7D, 0x2F, 0xE3, 0x63, 0x63, 0x0C, 0x75, 0xD8, 0xF6, 0x81, 0xB2, 0x02, 0xAE, 0xC4, 0x61, 0x7A,
    0xD3, 0xDF, 0x1E, 0xD5, 0xD5, 0xFD, 0x65, 0x61, 0x24, 0x33, 0xF5, 0x1F, 0x5F, 0x06, 0x6E, 0xD0,
    0x85, 0x63, 0x65, 0x55, 0x3D, 0xED, 0x1A, 0xF3, 0xB5, 0x57, 0x13, 0x5E, 0x7F, 0x57, 0xC9, 0x35,
    0x98, 0x4F, 0x0C, 0x70, 0xE0, 0xE6, 0x8B, 0x77, 0xE2, 0xA6, 0x89, 0xDA, 0xF3, 0xEF, 0xE8, 0x72,
    0x1D, 0xF1, 0x58, 0xA1, 0x36, 0xAD, 0xE7, 0x35, 0x30, 0xAC, 0xCA, 0x4F, 0x48, 0x3A, 0x79, 0x7A,
    0xBC, 0x0A, 0xB1, 0x82, 0xB3, 0x24, 0xFB, 0x61, 0xD1, 0x08, 0xA9, 0x4B, 0xB2, 0xC8, 0xE3, 0xFB,
    0xB9, 0x6A, 0xDA, 0xB7, 0x60, 0xD7, 0xF4, 0x68, 0x1D, 0x4F, 0x42, 0xA3, 0xDE, 0x39, 0x4D, 0xF4,
    0xAE, 0x56, 0xED, 0xE7, 0x63, 0x72, 0xBB, 0x19, 0x0B, 0x07, 0xA7, 0xC8, 0xEE, 0x0A, 0x6D, 0x70,
    0x9E, 0x02, 0xFC, 0xE1, 0xCD, 0xF7, 0xE2, 0xEC, 0xC0, 0x34, 0x04, 0xCD, 0x28, 0x34, 0x2F, 0x61,
    0x91, 0x72, 0xFE, 0x9C, 0xE9, 0x85, 0x83, 0xFF, 0x8E, 0x4F, 0x12, 0x32, 0xEE, 0xF2, 0x81, 0x83,
    0xC3, 0xFE, 0x3B, 0x1B, 0x4C, 0x6F, 0xAD, 0x73, 0x3B, 0xB5, 0xFC, 0xBC, 0x2E, 0xC2, 0x20, 0x05,
    0xC5, 0x8E, 0xF1, 0x83, 0x7D, 0x16, 0x83, 0xB2, 0xC6, 0xF3, 0x4A, 0x26, 0xC1, 0xB2, 0xEF, 0xFA,
    0x88, 0x6B, 0x42, 0x38, 0x61, 0x28, 0x5C, 0x97, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF\},
   256,
   
   2
\}
\end{DoxyCode}


ffdhe2048 group 



Definition at line 49 of file tls\+\_\+ffdhe.\+c.

\mbox{\Hypertarget{tls__ffdhe_8c_af008017d2c756dc4f1054c2bd43559c1}\label{tls__ffdhe_8c_af008017d2c756dc4f1054c2bd43559c1}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!ffdhe3072\+Group@{ffdhe3072\+Group}}
\index{ffdhe3072\+Group@{ffdhe3072\+Group}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{ffdhe3072\+Group}{ffdhe3072Group}}
{\footnotesize\ttfamily const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} ffdhe3072\+Group}



ffdhe3072 group 



Definition at line 82 of file tls\+\_\+ffdhe.\+c.

\mbox{\Hypertarget{tls__ffdhe_8c_a0b20329eafa66bf0d8e6da5b8f90b49d}\label{tls__ffdhe_8c_a0b20329eafa66bf0d8e6da5b8f90b49d}} 
\index{tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}!ffdhe4096\+Group@{ffdhe4096\+Group}}
\index{ffdhe4096\+Group@{ffdhe4096\+Group}!tls\+\_\+ffdhe.\+c@{tls\+\_\+ffdhe.\+c}}
\subsubsection{\texorpdfstring{ffdhe4096\+Group}{ffdhe4096Group}}
{\footnotesize\ttfamily const \hyperlink{structTlsFfdheGroup}{Tls\+Ffdhe\+Group} ffdhe4096\+Group}



ffdhe4096 group 



Definition at line 123 of file tls\+\_\+ffdhe.\+c.

