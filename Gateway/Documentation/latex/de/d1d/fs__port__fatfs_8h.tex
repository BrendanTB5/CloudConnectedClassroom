\hypertarget{fs__port__fatfs_8h}{}\section{common/fs\+\_\+port\+\_\+fatfs.h File Reference}
\label{fs__port__fatfs_8h}\index{common/fs\+\_\+port\+\_\+fatfs.\+h@{common/fs\+\_\+port\+\_\+fatfs.\+h}}


File system abstraction layer (Fat\+Fs)  


{\ttfamily \#include \char`\"{}os\+\_\+port.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ff.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{fs__port__fatfs_8h_a9c1974c6ee1b171bc3b6dd6a2315e303}{F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES}~8
\item 
\#define \hyperlink{fs__port__fatfs_8h_a23fcc82c10dc2d8756899bbc3622415f}{F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS}~8
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void \hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File}
\begin{DoxyCompactList}\small\item\em File descriptor. \end{DoxyCompactList}\item 
typedef void \hyperlink{fs__port__fatfs_8h_afe145361909761ec34b214cc8718c1ba}{Fs\+Dir}
\begin{DoxyCompactList}\small\item\em Directory descriptor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a2977e522a7c095073fd25be43907f80e}{fs\+Init} (void)
\begin{DoxyCompactList}\small\item\em File system initialization. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{fs__port__fatfs_8h_a0f43e535a49aaffcf54631257427f8d5}{fs\+File\+Exists} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path)
\begin{DoxyCompactList}\small\item\em Check whether a file exists. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a468b8c15424a76f8f28be14d37a1fc6f}{fs\+Get\+File\+Size} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$size)
\begin{DoxyCompactList}\small\item\em Retrieve the size of the specified file. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a6fcffd5686bb23325786719055d4e5fd}{fs\+Rename\+File} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$old\+Path, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$new\+Path)
\begin{DoxyCompactList}\small\item\em Rename the specified file. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a38d6ddafe3180ad55d036e2d0d86f230}{fs\+Delete\+File} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path)
\begin{DoxyCompactList}\small\item\em Delete a file. \end{DoxyCompactList}\item 
\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$ \hyperlink{fs__port__fatfs_8h_aba7fcc4f174dcf4652a8b84cdfff22b5}{fs\+Open\+File} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode})
\begin{DoxyCompactList}\small\item\em Open the specified file for reading or writing. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a08306362eac6d9e1bf1c7f2a0f622597}{fs\+Seek\+File} (\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file}, \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t} \hyperlink{pic32mz_2isr__support_8h_ac0542d92dfcd62c19170fd963f9e5052}{offset}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} origin)
\begin{DoxyCompactList}\small\item\em Move to specified position in file. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_aa5372052eff813ade8102cff497ad739}{fs\+Write\+File} (\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file}, void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Write data to the specified file. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_af802c67ab60bcc6273bcc65a967d99ab}{fs\+Read\+File} (\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file}, void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t size, size\+\_\+t $\ast$\hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Read data from the specified file. \end{DoxyCompactList}\item 
void \hyperlink{fs__port__fatfs_8h_a563173066eb2924f61e00e87fbf9d0bc}{fs\+Close\+File} (\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file})
\begin{DoxyCompactList}\small\item\em Close a file. \end{DoxyCompactList}\item 
\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{fs__port__fatfs_8h_a3c2f29449435d964e8526e891a256d6b}{fs\+Dir\+Exists} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path)
\begin{DoxyCompactList}\small\item\em Check whether a directory exists. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a8d60b93ce5be8adc8e376cc514c3bfe7}{fs\+Create\+Dir} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path)
\begin{DoxyCompactList}\small\item\em Create a directory. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_a2bb050753f999ec003b278fa58730e7f}{fs\+Remove\+Dir} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path)
\begin{DoxyCompactList}\small\item\em Remove a directory. \end{DoxyCompactList}\item 
\hyperlink{structFsDir}{Fs\+Dir} $\ast$ \hyperlink{fs__port__fatfs_8h_a7a412e5f03b92f85eb09448b72c46cc9}{fs\+Open\+Dir} (const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$path)
\begin{DoxyCompactList}\small\item\em Open a directory stream. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{fs__port__fatfs_8h_af9286e05d7b1032502ef39874a5b85ee}{fs\+Read\+Dir} (\hyperlink{structFsDir}{Fs\+Dir} $\ast$dir, \hyperlink{structFsDirEntry}{Fs\+Dir\+Entry} $\ast$dir\+Entry)
\begin{DoxyCompactList}\small\item\em Read an entry from the specified directory stream. \end{DoxyCompactList}\item 
void \hyperlink{fs__port__fatfs_8h_a94bfd6c1ae79880d0a5cbe3b491368f2}{fs\+Close\+Dir} (\hyperlink{structFsDir}{Fs\+Dir} $\ast$dir)
\begin{DoxyCompactList}\small\item\em Close a directory stream. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
File system abstraction layer (Fat\+Fs) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{fs__port__fatfs_8h_a23fcc82c10dc2d8756899bbc3622415f}\label{fs__port__fatfs_8h_a23fcc82c10dc2d8756899bbc3622415f}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS@{F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS}}
\index{F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS@{F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS}{FS\_MAX\_DIRS}}
{\footnotesize\ttfamily \#define F\+S\+\_\+\+M\+A\+X\+\_\+\+D\+I\+RS~8}



Definition at line 45 of file fs\+\_\+port\+\_\+fatfs.\+h.

\mbox{\Hypertarget{fs__port__fatfs_8h_a9c1974c6ee1b171bc3b6dd6a2315e303}\label{fs__port__fatfs_8h_a9c1974c6ee1b171bc3b6dd6a2315e303}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES@{F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES}}
\index{F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES@{F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES}{FS\_MAX\_FILES}}
{\footnotesize\ttfamily \#define F\+S\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+ES~8}



Definition at line 38 of file fs\+\_\+port\+\_\+fatfs.\+h.



\subsection{Typedef Documentation}
\mbox{\Hypertarget{fs__port__fatfs_8h_afe145361909761ec34b214cc8718c1ba}\label{fs__port__fatfs_8h_afe145361909761ec34b214cc8718c1ba}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!Fs\+Dir@{Fs\+Dir}}
\index{Fs\+Dir@{Fs\+Dir}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{Fs\+Dir}{FsDir}}
{\footnotesize\ttfamily typedef void \hyperlink{structFsDir}{Fs\+Dir}}



Directory descriptor. 



Definition at line 67 of file fs\+\_\+port\+\_\+fatfs.\+h.

\mbox{\Hypertarget{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}\label{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!Fs\+File@{Fs\+File}}
\index{Fs\+File@{Fs\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{Fs\+File}{FsFile}}
{\footnotesize\ttfamily typedef void \hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File}}



File descriptor. 



Definition at line 60 of file fs\+\_\+port\+\_\+fatfs.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{fs__port__fatfs_8h_a94bfd6c1ae79880d0a5cbe3b491368f2}\label{fs__port__fatfs_8h_a94bfd6c1ae79880d0a5cbe3b491368f2}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Close\+Dir@{fs\+Close\+Dir}}
\index{fs\+Close\+Dir@{fs\+Close\+Dir}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Close\+Dir()}{fsCloseDir()}}
{\footnotesize\ttfamily void fs\+Close\+Dir (\begin{DoxyParamCaption}\item[{\hyperlink{structFsDir}{Fs\+Dir} $\ast$}]{dir }\end{DoxyParamCaption})}



Close a directory stream. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dir} & Handle that identifies the directory to be closed \\
\hline
\end{DoxyParams}


Definition at line 824 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
825 \{
826    \textcolor{comment}{//Make sure the directory pointer is valid}
827    \textcolor{keywordflow}{if}(dir != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
828    \{
829       \textcolor{comment}{//Enter critical section}
830       \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
831 
832 \textcolor{preprocessor}{#if (FATFS\_REVISON >= FATFS\_R(0, 10, 0))}
833       \textcolor{comment}{//Close the specified directory}
834       f\_closedir((DIR *) dir);
835 \textcolor{preprocessor}{#endif}
836 
837       \textcolor{comment}{//Mark the corresponding entry as free}
838 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a))}
839       ((DIR *) dir)->fs = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
840 \textcolor{preprocessor}{#else}
841       ((DIR *) dir)->obj.fs = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
842 \textcolor{preprocessor}{#endif}
843 
844       \textcolor{comment}{//Leave critical section}
845       \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
846    \}
847 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a563173066eb2924f61e00e87fbf9d0bc}\label{fs__port__fatfs_8h_a563173066eb2924f61e00e87fbf9d0bc}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Close\+File@{fs\+Close\+File}}
\index{fs\+Close\+File@{fs\+Close\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Close\+File()}{fsCloseFile()}}
{\footnotesize\ttfamily void fs\+Close\+File (\begin{DoxyParamCaption}\item[{\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$}]{file }\end{DoxyParamCaption})}



Close a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file} & Handle that identifies the file to be closed \\
\hline
\end{DoxyParams}


Definition at line 528 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
529 \{
530    \textcolor{comment}{//Make sure the file pointer is valid}
531    \textcolor{keywordflow}{if}(\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
532    \{
533       \textcolor{comment}{//Enter critical section}
534       \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
535 
536       \textcolor{comment}{//Close the specified file}
537       f\_close((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file});
538 
539       \textcolor{comment}{//Mark the corresponding entry as free}
540 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a))}
541       ((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file})->fs = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
542 \textcolor{preprocessor}{#else}
543       ((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file})->obj.fs = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
544 \textcolor{preprocessor}{#endif}
545 
546       \textcolor{comment}{//Leave critical section}
547       \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
548    \}
549 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a8d60b93ce5be8adc8e376cc514c3bfe7}\label{fs__port__fatfs_8h_a8d60b93ce5be8adc8e376cc514c3bfe7}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Create\+Dir@{fs\+Create\+Dir}}
\index{fs\+Create\+Dir@{fs\+Create\+Dir}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Create\+Dir()}{fsCreateDir()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Create\+Dir (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path }\end{DoxyParamCaption})}



Create a directory. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the directory path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 609 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
610 \{
611    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
612 
613    \textcolor{comment}{//Make sure the pathname is valid}
614    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
615       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
616 
617 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
618 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
619    \textcolor{comment}{//Enter critical section}
620    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
621 \textcolor{preprocessor}{#endif}
622 
623    \textcolor{comment}{//Create a new directory}
624    res = f\_mkdir(path);
625 
626 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
627 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
628    \textcolor{comment}{//Leave critical section}
629    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
630 \textcolor{preprocessor}{#endif}
631 
632    \textcolor{comment}{//Any error to report?}
633    \textcolor{keywordflow}{if}(res != FR\_OK)
634       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
635 
636    \textcolor{comment}{//Successful processing}
637    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
638 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a38d6ddafe3180ad55d036e2d0d86f230}\label{fs__port__fatfs_8h_a38d6ddafe3180ad55d036e2d0d86f230}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Delete\+File@{fs\+Delete\+File}}
\index{fs\+Delete\+File@{fs\+Delete\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Delete\+File()}{fsDeleteFile()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Delete\+File (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path }\end{DoxyParamCaption})}



Delete a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the filename \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 281 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
282 \{
283    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
284 
285    \textcolor{comment}{//Make sure the pathname is valid}
286    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
287       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
288 
289 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
290 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
291    \textcolor{comment}{//Enter critical section}
292    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
293 \textcolor{preprocessor}{#endif}
294 
295    \textcolor{comment}{//Delete the specified file}
296    res = f\_unlink(path);
297 
298 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
299 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
300    \textcolor{comment}{//Leave critical section}
301    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
302 \textcolor{preprocessor}{#endif}
303 
304    \textcolor{comment}{//Any error to report?}
305    \textcolor{keywordflow}{if}(res != FR\_OK)
306       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
307 
308    \textcolor{comment}{//Successful processing}
309    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
310 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a3c2f29449435d964e8526e891a256d6b}\label{fs__port__fatfs_8h_a3c2f29449435d964e8526e891a256d6b}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Dir\+Exists@{fs\+Dir\+Exists}}
\index{fs\+Dir\+Exists@{fs\+Dir\+Exists}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Dir\+Exists()}{fsDirExists()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} fs\+Dir\+Exists (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path }\end{DoxyParamCaption})}



Check whether a directory exists. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the directory path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns T\+R\+UE if the directory exists. Otherwise F\+A\+L\+SE is returned 
\end{DoxyReturn}


Definition at line 558 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
559 \{
560    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
561    FILINFO fno;
562 
563 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a) && \_USE\_LFN != 0)}
564    fno.lfname = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
565    fno.lfsize = 0;
566 \textcolor{preprocessor}{#endif}
567 
568    \textcolor{comment}{//Make sure the pathname is valid}
569    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
570       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
571 
572    \textcolor{comment}{//Root directory?}
573    \textcolor{keywordflow}{if}(!strcmp(path, \textcolor{stringliteral}{"/"}))
574       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
575 
576 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
577 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
578    \textcolor{comment}{//Enter critical section}
579    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
580 \textcolor{preprocessor}{#endif}
581 
582    \textcolor{comment}{//Check whether the file exists}
583    res = f\_stat(path, &fno);
584 
585 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
586 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
587    \textcolor{comment}{//Leave critical section}
588    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
589 \textcolor{preprocessor}{#endif}
590 
591    \textcolor{comment}{//Any error to report?}
592    \textcolor{keywordflow}{if}(res != FR\_OK)
593       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
594 
595    \textcolor{comment}{//Valid directory?}
596    \textcolor{keywordflow}{if}(fno.fattrib & AM\_DIR)
597       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
598    \textcolor{keywordflow}{else}
599       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
600 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a0f43e535a49aaffcf54631257427f8d5}\label{fs__port__fatfs_8h_a0f43e535a49aaffcf54631257427f8d5}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+File\+Exists@{fs\+File\+Exists}}
\index{fs\+File\+Exists@{fs\+File\+Exists}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+File\+Exists()}{fsFileExists()}}
{\footnotesize\ttfamily \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} fs\+File\+Exists (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path }\end{DoxyParamCaption})}



Check whether a file exists. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the filename \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns T\+R\+UE if the file exists. Otherwise F\+A\+L\+SE is returned 
\end{DoxyReturn}


Definition at line 144 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
145 \{
146    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
147    FILINFO fno;
148 
149 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a) && \_USE\_LFN != 0)}
150    fno.lfname = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
151    fno.lfsize = 0;
152 \textcolor{preprocessor}{#endif}
153 
154    \textcolor{comment}{//Make sure the pathname is valid}
155    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
156       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
157 
158 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
159 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
160    \textcolor{comment}{//Enter critical section}
161    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
162 \textcolor{preprocessor}{#endif}
163 
164    \textcolor{comment}{//Check whether the file exists}
165    res = f\_stat(path, &fno);
166 
167 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
168 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
169    \textcolor{comment}{//Leave critical section}
170    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
171 \textcolor{preprocessor}{#endif}
172 
173    \textcolor{comment}{//Any error to report?}
174    \textcolor{keywordflow}{if}(res != FR\_OK)
175       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
176 
177    \textcolor{comment}{//Valid file?}
178    \textcolor{keywordflow}{if}(fno.fattrib & AM\_DIR)
179       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
180    \textcolor{keywordflow}{else}
181       \textcolor{keywordflow}{return} \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
182 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a468b8c15424a76f8f28be14d37a1fc6f}\label{fs__port__fatfs_8h_a468b8c15424a76f8f28be14d37a1fc6f}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Get\+File\+Size@{fs\+Get\+File\+Size}}
\index{fs\+Get\+File\+Size@{fs\+Get\+File\+Size}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Get\+File\+Size()}{fsGetFileSize()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Get\+File\+Size (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{size }\end{DoxyParamCaption})}



Retrieve the size of the specified file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the filename \\
\hline
\mbox{\tt out}  & {\em size} & Size of the file in bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 192 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
193 \{
194    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
195    FILINFO fno;
196 
197 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a) && \_USE\_LFN != 0)}
198    fno.lfname = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
199    fno.lfsize = 0;
200 \textcolor{preprocessor}{#endif}
201 
202    \textcolor{comment}{//Check parameters}
203    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || size == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
204       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
205 
206 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
207 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
208    \textcolor{comment}{//Enter critical section}
209    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
210 \textcolor{preprocessor}{#endif}
211 
212    \textcolor{comment}{//Retrieve information about the specified file}
213    res = f\_stat(path, &fno);
214 
215 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
216 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
217    \textcolor{comment}{//Leave critical section}
218    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
219 \textcolor{preprocessor}{#endif}
220 
221    \textcolor{comment}{//Any error to report?}
222    \textcolor{keywordflow}{if}(res != FR\_OK)
223       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
224    \textcolor{comment}{//Valid file?}
225    \textcolor{keywordflow}{if}(fno.fattrib & AM\_DIR)
226       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
227 
228    \textcolor{comment}{//Return the size of the file}
229    *size = fno.fsize;
230 
231    \textcolor{comment}{//Successful processing}
232    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
233 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a2977e522a7c095073fd25be43907f80e}\label{fs__port__fatfs_8h_a2977e522a7c095073fd25be43907f80e}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Init@{fs\+Init}}
\index{fs\+Init@{fs\+Init}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Init()}{fsInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



File system initialization. 

\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 102 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
103 \{
104    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
105 
106    \textcolor{comment}{//Clear file system objects}
107    memset(\hyperlink{fs__port__fatfs_8c_a45adcb02673c16a23bbda80336dc629e}{fileTable}, 0, \textcolor{keyword}{sizeof}(\hyperlink{fs__port__fatfs_8c_a45adcb02673c16a23bbda80336dc629e}{fileTable}));
108    memset(\hyperlink{fs__port__fatfs_8c_a07cd7a088c2bc48e2707ff163b3ba3d2}{dirTable}, 0, \textcolor{keyword}{sizeof}(\hyperlink{fs__port__fatfs_8c_a07cd7a088c2bc48e2707ff163b3ba3d2}{dirTable}));
109 
110    \textcolor{comment}{//Create a mutex to protect critical sections}
111    \textcolor{keywordflow}{if}(!\hyperlink{os__port__chibios_8c_a16627f901c807c29adf29a38fb1af16a}{osCreateMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex}))
112    \{
113       \textcolor{comment}{//Failed to create mutex}
114       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca528efe91b7a7e4bcc9a6de7d4b778c67}{ERROR\_OUT\_OF\_RESOURCES};
115    \}
116 
117    \textcolor{comment}{//Mount file system}
118 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 9, b))}
119    res = f\_mount(0, &\hyperlink{fs__port__fatfs_8c_ae5bcde72e0e0b29ec86d00ba3e5cd51f}{fs});
120 \textcolor{preprocessor}{#else}
121    res = f\_mount(&\hyperlink{fs__port__fatfs_8c_ae5bcde72e0e0b29ec86d00ba3e5cd51f}{fs}, \textcolor{stringliteral}{""}, 1);
122 \textcolor{preprocessor}{#endif}
123 
124    \textcolor{comment}{//Failed to mount file system?}
125    \textcolor{keywordflow}{if}(res != FR\_OK)
126    \{
127       \textcolor{comment}{//Clean up side effects}
128       \hyperlink{os__port__chibios_8c_a2b0ba1e39227e4a4d52ee46bbee15c11}{osDeleteMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
129       \textcolor{comment}{//Report an error}
130       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
131    \}
132 
133    \textcolor{comment}{//Successful processing}
134    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
135 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a7a412e5f03b92f85eb09448b72c46cc9}\label{fs__port__fatfs_8h_a7a412e5f03b92f85eb09448b72c46cc9}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Open\+Dir@{fs\+Open\+Dir}}
\index{fs\+Open\+Dir@{fs\+Open\+Dir}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Open\+Dir()}{fsOpenDir()}}
{\footnotesize\ttfamily \hyperlink{structFsDir}{Fs\+Dir}$\ast$ fs\+Open\+Dir (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path }\end{DoxyParamCaption})}



Open a directory stream. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the directory path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Directory handle 
\end{DoxyReturn}


Definition at line 685 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
686 \{
687    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
688    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
689 
690    \textcolor{comment}{//Directory pointer}
691    \hyperlink{structFsDir}{FsDir} *dir = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
692 
693    \textcolor{comment}{//Make sure the pathname is valid}
694    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
695       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
696 
697    \textcolor{comment}{//Enter critical section}
698    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
699 
700    \textcolor{comment}{//Loop through the directory objects}
701    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{fs__port__fatfs_8h_a23fcc82c10dc2d8756899bbc3622415f}{FS\_MAX\_DIRS}; i++)
702    \{
703       \textcolor{comment}{//Unused directory object found?}
704 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a))}
705       \textcolor{keywordflow}{if}(\hyperlink{fs__port__fatfs_8c_a07cd7a088c2bc48e2707ff163b3ba3d2}{dirTable}[i].\hyperlink{fs__port__fatfs_8c_ae5bcde72e0e0b29ec86d00ba3e5cd51f}{fs} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
706 \textcolor{preprocessor}{#else}
707       \textcolor{keywordflow}{if}(\hyperlink{fs__port__fatfs_8c_a07cd7a088c2bc48e2707ff163b3ba3d2}{dirTable}[i].obj.fs == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
708 \textcolor{preprocessor}{#endif}
709       \{
710          \textcolor{comment}{//Open the specified directory}
711          res = f\_opendir(&\hyperlink{fs__port__fatfs_8c_a07cd7a088c2bc48e2707ff163b3ba3d2}{dirTable}[i], path);
712 
713          \textcolor{comment}{//Check status code}
714          \textcolor{keywordflow}{if}(res == FR\_OK)
715             dir = &\hyperlink{fs__port__fatfs_8c_a07cd7a088c2bc48e2707ff163b3ba3d2}{dirTable}[i];
716 
717          \textcolor{comment}{//Stop immediately}
718          \textcolor{keywordflow}{break};
719       \}
720    \}
721 
722    \textcolor{comment}{//Leave critical section}
723    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
724    \textcolor{comment}{//Return a handle to the directory}
725    \textcolor{keywordflow}{return} dir;
726 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_aba7fcc4f174dcf4652a8b84cdfff22b5}\label{fs__port__fatfs_8h_aba7fcc4f174dcf4652a8b84cdfff22b5}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Open\+File@{fs\+Open\+File}}
\index{fs\+Open\+File@{fs\+Open\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Open\+File()}{fsOpenFile()}}
{\footnotesize\ttfamily \hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File}$\ast$ fs\+Open\+File (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{mode }\end{DoxyParamCaption})}



Open the specified file for reading or writing. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the filename \\
\hline
\mbox{\tt in}  & {\em mode} & Type of access permitted (F\+S\+\_\+\+F\+I\+L\+E\+\_\+\+M\+O\+D\+E\+\_\+\+R\+E\+AD, F\+S\+\_\+\+F\+I\+L\+E\+\_\+\+M\+O\+D\+E\+\_\+\+W\+R\+I\+TE or F\+S\+\_\+\+F\+I\+L\+E\+\_\+\+M\+O\+D\+E\+\_\+\+C\+R\+E\+A\+TE) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
File handle 
\end{DoxyReturn}


Definition at line 321 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
322 \{
323    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
324    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{tcp_8h_aa2585d779da0ab21273a8d92de9a0ebe}{flags};
325    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
326 
327    \textcolor{comment}{//File pointer}
328    \hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{FsFile} *\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file} = \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
329 
330    \textcolor{comment}{//Make sure the pathname is valid}
331    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
332       \textcolor{keywordflow}{return} \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
333 
334    \textcolor{comment}{//Enter critical section}
335    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
336 
337    \textcolor{comment}{//Loop through the file objects}
338    \textcolor{keywordflow}{for}(i = 0; i < \hyperlink{fs__port__fatfs_8h_a9c1974c6ee1b171bc3b6dd6a2315e303}{FS\_MAX\_FILES}; i++)
339    \{
340       \textcolor{comment}{//Unused file object found?}
341 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a))}
342       \textcolor{keywordflow}{if}(\hyperlink{fs__port__fatfs_8c_a45adcb02673c16a23bbda80336dc629e}{fileTable}[i].\hyperlink{fs__port__fatfs_8c_ae5bcde72e0e0b29ec86d00ba3e5cd51f}{fs} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
343 \textcolor{preprocessor}{#else}
344       \textcolor{keywordflow}{if}(\hyperlink{fs__port__fatfs_8c_a45adcb02673c16a23bbda80336dc629e}{fileTable}[i].obj.fs == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
345 \textcolor{preprocessor}{#endif}
346       \{
347          \textcolor{comment}{//Default access mode}
348          flags = 0;
349 
350          \textcolor{comment}{//Check access mode}
351          \textcolor{keywordflow}{if}(\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode} & \hyperlink{fs__port_8h_a086887b0800535e5a06340d3fc76c51cadf6c1e1805f97fa4f535acbdc2d943db}{FS\_FILE\_MODE\_READ})
352             flags |= FA\_READ;
353          \textcolor{keywordflow}{if}(\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode} & \hyperlink{fs__port_8h_a086887b0800535e5a06340d3fc76c51caed4c8b2994951eeb8d60d929444fb8cb}{FS\_FILE\_MODE\_WRITE})
354             flags |= FA\_WRITE;
355          \textcolor{keywordflow}{if}(\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode} & \hyperlink{fs__port_8h_a086887b0800535e5a06340d3fc76c51ca59f9749189b0706360c6c117fd3ba104}{FS\_FILE\_MODE\_CREATE})
356             flags |= FA\_OPEN\_ALWAYS;
357          \textcolor{keywordflow}{if}(\hyperlink{ntp__common_8h_a37e90f5e3bd99fac2021fb3a326607d4}{mode} & \hyperlink{fs__port_8h_a086887b0800535e5a06340d3fc76c51cae281d66b3b573b40eb7dc9bbae4bdfc3}{FS\_FILE\_MODE\_TRUNC})
358             flags |= FA\_CREATE\_ALWAYS;
359 
360          \textcolor{comment}{//Open the specified file}
361          res = f\_open(&\hyperlink{fs__port__fatfs_8c_a45adcb02673c16a23bbda80336dc629e}{fileTable}[i], path, flags);
362 
363          \textcolor{comment}{//Check status code}
364          \textcolor{keywordflow}{if}(res == FR\_OK)
365             file = &\hyperlink{fs__port__fatfs_8c_a45adcb02673c16a23bbda80336dc629e}{fileTable}[i];
366 
367          \textcolor{comment}{//Stop immediately}
368          \textcolor{keywordflow}{break};
369       \}
370    \}
371 
372    \textcolor{comment}{//Leave critical section}
373    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
374    \textcolor{comment}{//Return a handle to the file}
375    \textcolor{keywordflow}{return} \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file};
376 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_af9286e05d7b1032502ef39874a5b85ee}\label{fs__port__fatfs_8h_af9286e05d7b1032502ef39874a5b85ee}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Read\+Dir@{fs\+Read\+Dir}}
\index{fs\+Read\+Dir@{fs\+Read\+Dir}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Read\+Dir()}{fsReadDir()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Read\+Dir (\begin{DoxyParamCaption}\item[{\hyperlink{structFsDir}{Fs\+Dir} $\ast$}]{dir,  }\item[{\hyperlink{structFsDirEntry}{Fs\+Dir\+Entry} $\ast$}]{dir\+Entry }\end{DoxyParamCaption})}



Read an entry from the specified directory stream. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dir} & Handle that identifies the directory \\
\hline
\mbox{\tt out}  & {\em dir\+Entry} & Pointer to a directory entry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 736 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
737 \{
738    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
739    FILINFO fno;
740    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *fn;
741    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
742 
743 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a) && \_USE\_LFN != 0)}
744    \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} lfn[\_MAX\_LFN + 1];
745    fno.lfname = lfn;
746    fno.lfsize = \textcolor{keyword}{sizeof}(lfn);
747 \textcolor{preprocessor}{#endif}
748 
749    \textcolor{comment}{//Make sure the directory pointer is valid}
750    \textcolor{keywordflow}{if}(dir == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
751       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
752 
753 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
754 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
755    \textcolor{comment}{//Enter critical section}
756    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
757 \textcolor{preprocessor}{#endif}
758 
759    \textcolor{comment}{//Read the specified directory}
760    res = f\_readdir((DIR *) dir, &fno);
761 
762 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
763 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
764    \textcolor{comment}{//Leave critical section}
765    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
766 \textcolor{preprocessor}{#endif}
767 
768    \textcolor{comment}{//Any error to report?}
769    \textcolor{keywordflow}{if}(res != FR\_OK)
770       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
771 
772    \textcolor{comment}{//End of the directory stream?}
773    \textcolor{keywordflow}{if}(fno.fname[0] == \textcolor{charliteral}{'\(\backslash\)0'})
774       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8b7223773301a4f3dd811f1d35e13ce4}{ERROR\_END\_OF\_STREAM};
775 
776    \textcolor{comment}{//Point to the long filename}
777 \textcolor{preprocessor}{#if (FATFS\_REVISON <= FATFS\_R(0, 11, a) && \_USE\_LFN != 0)}
778    fn = (*fno.lfname != \textcolor{charliteral}{'\(\backslash\)0'}) ? fno.lfname : fno.fname;
779 #\textcolor{keywordflow}{else}
780    fn = fno.fname;
781 #endif
782 
783    \textcolor{comment}{//File attributes}
784    dirEntry->\hyperlink{structFsDirEntry_ae6bc73c8708ef8541ed7dc2c5f802e96}{attributes} = fno.fattrib;
785    \textcolor{comment}{//File size}
786    dirEntry->\hyperlink{structFsDirEntry_acface51e05962d480c731d0b0c7b1d0e}{size} = fno.fsize;
787 
788    \textcolor{comment}{//Time of last modification}
789    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 1980 + ((fno.fdate >> 9) & 0x7F);
790    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month} = (fno.fdate >> 5) & 0x0F;
791    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day} = fno.fdate & 0x1F;
792    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a4bcfa5ccbae6858247fce0ddc0fbc47c}{dayOfWeek} = 0;
793    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a46fa4e0c13c7fc19c8ae97a5642c4a15}{hours} = (fno.ftime >> 11) & 0x1F;
794    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a9e705a28fc51e333616553313107d579}{minutes} = (fno.ftime >> 5) & 0x3F;
795    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a428828f757146b36432b4669e8b27eeb}{seconds} = (fno.ftime & 0x1F) * 2;
796    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a8b3982e7347da9a62c2bfc6c273da909}{milliseconds} = 0;
797 
798    \textcolor{comment}{//Make sure the date is valid}
799    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month} = \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.
      \hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month}, 1);
800    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month} = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.
      \hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month}, 12);
801    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day} = \hyperlink{os__port_8h_afa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day}, 1);
802    dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day} = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(dirEntry->\hyperlink{structFsDirEntry_abd332197750fa0d7181d206355a86b99}{modified}.\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day}, 31);
803 
804    \textcolor{comment}{//Retrieve the length of the file name}
805    n = strlen(fn);
806    \textcolor{comment}{//Limit the number of characters to be copied}
807    n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(n, \hyperlink{fs__port_8h_a17f57e73738b6fd8b600eb2b4e0e5c71}{FS\_MAX\_NAME\_LEN});
808 
809    \textcolor{comment}{//Copy file name}
810    strncpy(dirEntry->\hyperlink{structFsDirEntry_ab2a81b6bc89dc202e25448d2afdbae5b}{name}, fn, n);
811    \textcolor{comment}{//Properly terminate the string with a NULL character}
812    dirEntry->\hyperlink{structFsDirEntry_ab2a81b6bc89dc202e25448d2afdbae5b}{name}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] = \textcolor{charliteral}{'\(\backslash\)0'};
813 
814    \textcolor{comment}{//Successful processing}
815    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
816 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_af802c67ab60bcc6273bcc65a967d99ab}\label{fs__port__fatfs_8h_af802c67ab60bcc6273bcc65a967d99ab}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Read\+File@{fs\+Read\+File}}
\index{fs\+Read\+File@{fs\+Read\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Read\+File()}{fsReadFile()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Read\+File (\begin{DoxyParamCaption}\item[{\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$}]{file,  }\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{size,  }\item[{size\+\_\+t $\ast$}]{length }\end{DoxyParamCaption})}



Read data from the specified file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file} & Handle that identifies the file to be read \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the buffer where to copy the data \\
\hline
\mbox{\tt in}  & {\em size} & Size of the buffer, in bytes \\
\hline
\mbox{\tt out}  & {\em length} & Number of data bytes that have been read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 481 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
482 \{
483    UINT \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
484    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
485 
486    \textcolor{comment}{//Check parameters}
487    \textcolor{keywordflow}{if}(\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
488       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
489 
490    \textcolor{comment}{//No data has been read yet}
491    *\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = 0;
492 
493 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
494 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
495    \textcolor{comment}{//Enter critical section}
496    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
497 \textcolor{preprocessor}{#endif}
498 
499    \textcolor{comment}{//Read data}
500    res = f\_read((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size, &n);
501 
502 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
503 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
504    \textcolor{comment}{//Leave critical section}
505    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
506 \textcolor{preprocessor}{#endif}
507 
508    \textcolor{comment}{//Any error to report?}
509    \textcolor{keywordflow}{if}(res != FR\_OK)
510       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
511 
512    \textcolor{comment}{//End of file?}
513    \textcolor{keywordflow}{if}(!n)
514       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca488b657f8cc2e6c29df47f282e8ff3ad}{ERROR\_END\_OF\_FILE};
515 
516    \textcolor{comment}{//Total number of data that have been read}
517    *\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
518    \textcolor{comment}{//Successful processing}
519    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
520 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a2bb050753f999ec003b278fa58730e7f}\label{fs__port__fatfs_8h_a2bb050753f999ec003b278fa58730e7f}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Remove\+Dir@{fs\+Remove\+Dir}}
\index{fs\+Remove\+Dir@{fs\+Remove\+Dir}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Remove\+Dir()}{fsRemoveDir()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Remove\+Dir (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{path }\end{DoxyParamCaption})}



Remove a directory. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & N\+U\+L\+L-\/terminated string specifying the directory path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 647 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
648 \{
649    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
650 
651    \textcolor{comment}{//Make sure the pathname is valid}
652    \textcolor{keywordflow}{if}(path == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
653       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
654 
655 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
656 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
657    \textcolor{comment}{//Enter critical section}
658    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
659 \textcolor{preprocessor}{#endif}
660 
661    \textcolor{comment}{//Remove the specified directory}
662    res = f\_unlink(path);
663 
664 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
665 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
666    \textcolor{comment}{//Leave critical section}
667    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
668 \textcolor{preprocessor}{#endif}
669 
670    \textcolor{comment}{//Any error to report?}
671    \textcolor{keywordflow}{if}(res != FR\_OK)
672       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
673 
674    \textcolor{comment}{//Successful processing}
675    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
676 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a6fcffd5686bb23325786719055d4e5fd}\label{fs__port__fatfs_8h_a6fcffd5686bb23325786719055d4e5fd}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Rename\+File@{fs\+Rename\+File}}
\index{fs\+Rename\+File@{fs\+Rename\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Rename\+File()}{fsRenameFile()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Rename\+File (\begin{DoxyParamCaption}\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{old\+Path,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{new\+Path }\end{DoxyParamCaption})}



Rename the specified file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em old\+Path} & N\+U\+L\+L-\/terminated string specifying the pathname of the file to be renamed \\
\hline
\mbox{\tt in}  & {\em new\+Path} & N\+U\+L\+L-\/terminated string specifying the new filename \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 243 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
244 \{
245    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
246 
247    \textcolor{comment}{//Check parameters}
248    \textcolor{keywordflow}{if}(oldPath == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || newPath == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
249       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
250 
251 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
252 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
253    \textcolor{comment}{//Enter critical section}
254    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
255 \textcolor{preprocessor}{#endif}
256 
257    \textcolor{comment}{//Rename the specified file}
258    res = f\_rename(oldPath, newPath);
259 
260 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
261 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
262    \textcolor{comment}{//Leave critical section}
263    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
264 \textcolor{preprocessor}{#endif}
265 
266    \textcolor{comment}{//Any error to report?}
267    \textcolor{keywordflow}{if}(res != FR\_OK)
268       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
269 
270    \textcolor{comment}{//Successful processing}
271    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
272 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_a08306362eac6d9e1bf1c7f2a0f622597}\label{fs__port__fatfs_8h_a08306362eac6d9e1bf1c7f2a0f622597}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Seek\+File@{fs\+Seek\+File}}
\index{fs\+Seek\+File@{fs\+Seek\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Seek\+File()}{fsSeekFile()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Seek\+File (\begin{DoxyParamCaption}\item[{\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$}]{file,  }\item[{\hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\+\_\+t}}]{offset,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{origin }\end{DoxyParamCaption})}



Move to specified position in file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file} & Handle that identifies the file \\
\hline
\mbox{\tt in}  & {\em offset} & Number of bytes to move from origin \\
\hline
\mbox{\tt in}  & {\em origin} & Position used as reference for the offset (F\+S\+\_\+\+S\+E\+E\+K\+\_\+\+S\+ET, F\+S\+\_\+\+S\+E\+E\+K\+\_\+\+C\+UR or F\+S\+\_\+\+S\+E\+E\+K\+\_\+\+E\+ND) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 388 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
389 \{
390    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
391 
392    \textcolor{comment}{//Make sure the file pointer is valid}
393    \textcolor{keywordflow}{if}(\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
394       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
395 
396 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
397 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
398    \textcolor{comment}{//Enter critical section}
399    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
400 \textcolor{preprocessor}{#endif}
401 
402    \textcolor{comment}{//Offset is relative to the current file pointer position?}
403    \textcolor{keywordflow}{if}(origin == \hyperlink{fs__port_8h_a96b63216b3c538b63de1928e54b5d013ab7f080d71bee180296706c77d2cf3383}{FS\_SEEK\_CUR})
404       \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} += f\_tell((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file});
405    \textcolor{comment}{//Offset is relative to the end of the file?}
406    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(origin == \hyperlink{fs__port_8h_a96b63216b3c538b63de1928e54b5d013a36dd416e193650f2c191423d3e3dad6d}{FS\_SEEK\_END})
407       \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset} += f\_size((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file});
408 
409    \textcolor{comment}{//Move read/write pointer}
410    res = f\_lseek((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file}, \hyperlink{pic32mz_2isr__support_8h_a12a5aed8a193ebbf9a641104a310610d}{offset});
411 
412 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
413 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
414    \textcolor{comment}{//Leave critical section}
415    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
416 \textcolor{preprocessor}{#endif}
417 
418    \textcolor{comment}{//Any error to report?}
419    \textcolor{keywordflow}{if}(res != FR\_OK)
420       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
421 
422    \textcolor{comment}{//Successful processing}
423    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
424 \}
\end{DoxyCode}
\mbox{\Hypertarget{fs__port__fatfs_8h_aa5372052eff813ade8102cff497ad739}\label{fs__port__fatfs_8h_aa5372052eff813ade8102cff497ad739}} 
\index{fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}!fs\+Write\+File@{fs\+Write\+File}}
\index{fs\+Write\+File@{fs\+Write\+File}!fs\+\_\+port\+\_\+fatfs.\+h@{fs\+\_\+port\+\_\+fatfs.\+h}}
\subsubsection{\texorpdfstring{fs\+Write\+File()}{fsWriteFile()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} fs\+Write\+File (\begin{DoxyParamCaption}\item[{\hyperlink{fs__port__fatfs_8h_a913e2a93cbf8ed241fe05fb6abc3f316}{Fs\+File} $\ast$}]{file,  }\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Write data to the specified file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file} & Handle that identifies the file to be written \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to a buffer containing the data to be written \\
\hline
\mbox{\tt in}  & {\em length} & Number of data bytes to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 435 of file fs\+\_\+port\+\_\+fatfs.\+c.


\begin{DoxyCode}
436 \{
437    UINT \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
438    FRESULT \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
439 
440    \textcolor{comment}{//Make sure the file pointer is valid}
441    \textcolor{keywordflow}{if}(\hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
442       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
443 
444 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
445 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
446    \textcolor{comment}{//Enter critical section}
447    \hyperlink{os__port__chibios_8c_a58485224df4bfa522246d55b35bbd83a}{osAcquireMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
448 \textcolor{preprocessor}{#endif}
449 
450    \textcolor{comment}{//Write data}
451    res = f\_write((FIL *) \hyperlink{dhcp__common_8h_a5c7003134e7a7486271d4f33c2e7b7de}{file}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
452 
453 \textcolor{preprocessor}{#if ((FATFS\_REVISON <= FATFS\_R(0, 12, c) && \_FS\_REENTRANT == 0) || \(\backslash\)}
454 \textcolor{preprocessor}{   (FATFS\_REVISON >= FATFS\_R(0, 13, 0) && FF\_FS\_REENTRANT == 0))}
455    \textcolor{comment}{//Leave critical section}
456    \hyperlink{os__port__chibios_8c_a8e10e5b2c6d3877b5ba60e375ac45d79}{osReleaseMutex}(&\hyperlink{fs__port__fatfs_8c_a9f7349bcc6ad47b7149d4e7f037cf000}{fsMutex});
457 \textcolor{preprocessor}{#endif}
458 
459    \textcolor{comment}{//Any error to report?}
460    \textcolor{keywordflow}{if}(res != FR\_OK)
461       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
462 
463    \textcolor{comment}{//Sanity check}
464    \textcolor{keywordflow}{if}(n != \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length})
465       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
466 
467    \textcolor{comment}{//Successful processing}
468    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
469 \}
\end{DoxyCode}
