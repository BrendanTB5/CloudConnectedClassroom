\hypertarget{mqtt__sn__client_8h}{}\section{cyclone\+\_\+tcp/mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client.h File Reference}
\label{mqtt__sn__client_8h}\index{cyclone\+\_\+tcp/mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client.\+h@{cyclone\+\_\+tcp/mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+client.\+h}}


M\+Q\+T\+T-\/\+SN client.  


{\ttfamily \#include \char`\"{}core/net.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mqtt\+\_\+sn/mqtt\+\_\+sn\+\_\+message.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls.\+h\char`\"{}}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structMqttSnClientWillMessage}{Mqtt\+Sn\+Client\+Will\+Message}
\begin{DoxyCompactList}\small\item\em Will message. \end{DoxyCompactList}\item 
struct \hyperlink{structMqttSnClientTopicEntry}{Mqtt\+Sn\+Client\+Topic\+Entry}
\begin{DoxyCompactList}\small\item\em Mapping between a topic name and a topic ID. \end{DoxyCompactList}\item 
struct \hyperlink{structMqttSnClientMsgIdEntry}{Mqtt\+Sn\+Client\+Msg\+Id\+Entry}
\begin{DoxyCompactList}\small\item\em QoS 2 message state. \end{DoxyCompactList}\item 
struct \hyperlink{struct__MqttSnClientContext}{\+\_\+\+Mqtt\+Sn\+Client\+Context}
\begin{DoxyCompactList}\small\item\em M\+Q\+T\+T-\/\+SN client context. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mqtt__sn__client_8h_ae2b7c85633e90ad7a60eaefd0ec9f2d5}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT}~\hyperlink{os__port_8h_a73c228f87e038e8295ee8ea8eceaa5ac}{E\+N\+A\+B\+L\+ED}
\item 
\#define \hyperlink{mqtt__sn__client_8h_ab5af0505d6eb46d2cfc41e4075c9dacd}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT}~\hyperlink{os__port_8h_abd5c8ab57c190a6522ccdbf0ed7577da}{D\+I\+S\+A\+B\+L\+ED}
\item 
\#define \hyperlink{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}~10
\item 
\#define \hyperlink{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}~10
\item 
\#define \hyperlink{mqtt__sn__client_8h_a8903ddd9dd0e6d56d19a16aa63381389}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN}~23
\item 
\#define \hyperlink{mqtt__sn__client_8h_a746a6fb4ce05f20c05f8a852a1e376e1}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN}~32
\item 
\#define \hyperlink{mqtt__sn__client_8h_ae418ee87e6d47c1cfdb4e7a5694a2caa}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN}~32
\item 
\#define \hyperlink{mqtt__sn__client_8h_a1059cb0e47f7c47d79ca58c5f29c6126}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN}~32
\item 
\#define \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL}~100
\item 
\#define \hyperlink{mqtt__sn__client_8h_afe0d365aa5d9cf22df9a84a9a1515b8c}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT}~30000
\item 
\#define \hyperlink{mqtt__sn__client_8h_ac658597e1991ef68bcc1a2cc5c5c5376}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE}~0
\item 
\#define \hyperlink{mqtt__sn__client_8h_a20c1e6ef1d8aa1ff620efeeaecfc03f0}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES}~5
\item 
\#define \hyperlink{mqtt__sn__client_8h_a7d9c6d732aae16efd9db028f3ecfa2d1}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY}~0
\item 
\#define \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT}~5000
\item 
\#define \hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context}~struct \hyperlink{struct__MqttSnClientContext}{\+\_\+\+Mqtt\+Sn\+Client\+Context}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t}($\ast$ \hyperlink{mqtt__sn__client_8h_a0aa65bd0e127e05595c247c01aeca2d5}{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback}) (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$dtls\+Context)
\begin{DoxyCompactList}\small\item\em D\+T\+LS initialization callback. \end{DoxyCompactList}\item 
typedef void($\ast$ \hyperlink{mqtt__sn__client_8h_a4f0890f5b533cda2ad972b1e433cf109}{Mqtt\+Sn\+Client\+Publish\+Callback}) (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$topic, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level} \hyperlink{mqtt__sn__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain})
\begin{DoxyCompactList}\small\item\em P\+U\+B\+L\+I\+SH message received callback. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071}{Mqtt\+Sn\+Client\+State} \{ \newline
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+ED} = 0, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a467b75c7773b826b5bd91423b6bd91fc}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+A\+R\+C\+H\+I\+NG} = 1, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9bdad609f89dd17ca63814c753160111}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+NG} = 2, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+C\+T\+I\+VE} = 3, 
\newline
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+R\+EQ} = 4, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+P\+\_\+\+R\+E\+C\+E\+I\+V\+ED} = 5, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a4d296b47cc0bfaf9d881c2a6083daef6}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+L\+O\+ST} = 6, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a36a8a8cd0fc56b982e31dbec65a03cee}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+S\+L\+E\+EP} = 7, 
\newline
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a6ac12ebbb806bcaa8b7040372740b244}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+W\+A\+KE} = 8, 
\hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+I\+NG} = 9
 \}\begin{DoxyCompactList}\small\item\em M\+Q\+T\+T-\/\+SN client states. \end{DoxyCompactList}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_ab400c38eea27a5f985932f44724dfc1e}{mqtt\+Sn\+Client\+Init} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Initialize M\+Q\+T\+T-\/\+SN client context. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_af9957d5739a5ef313e284153eb4346ba}{mqtt\+Sn\+Client\+Set\+Transport\+Protocol} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{mqtt__sn__common_8h_a253f39a8dfbcfb9062c71a05947121eb}{Mqtt\+Sn\+Transport\+Protocol} transport\+Protocol)
\begin{DoxyCompactList}\small\item\em Set the transport protocol to be used. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_aff81d84e215962385db1c6115c001045}{mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{mqtt__sn__client_8h_a0aa65bd0e127e05595c247c01aeca2d5}{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback} callback)
\begin{DoxyCompactList}\small\item\em Register D\+T\+LS initialization callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a1f3bc6a6708eb792cd8f9a6e24c26889}{mqtt\+Sn\+Client\+Register\+Publish\+Callback} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{mqtt__sn__client_8h_a4f0890f5b533cda2ad972b1e433cf109}{Mqtt\+Sn\+Client\+Publish\+Callback} callback)
\begin{DoxyCompactList}\small\item\em Register publish callback function. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a2e810dc2d1fe353e4a5d52496827b24d}{mqtt\+Sn\+Client\+Set\+Predefined\+Topics} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{structMqttSnPredefinedTopic}{Mqtt\+Sn\+Predefined\+Topic} $\ast$predefined\+Topics, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} size)
\begin{DoxyCompactList}\small\item\em Set the list of predefined topics. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a43bcead45f89f895a7c270438dabb827}{mqtt\+Sn\+Client\+Set\+Timeout} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} timeout)
\begin{DoxyCompactList}\small\item\em Set communication timeout. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_af05eeb02d6c5f83b991a61eca89290bc}{mqtt\+Sn\+Client\+Set\+Keep\+Alive} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} keep\+Alive)
\begin{DoxyCompactList}\small\item\em Set keep-\/alive value. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a51eb676e894403e88439cc1976c82802}{mqtt\+Sn\+Client\+Set\+Identifier} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_aaaf873d7efb58d9ccdddc5c8569e092b}{client\+Id})
\begin{DoxyCompactList}\small\item\em Set client identifier. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a2285b0286073e10be3c6b6535da9ff72}{mqtt\+Sn\+Client\+Set\+Will\+Message} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$topic, const void $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level} \hyperlink{mqtt__sn__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain})
\begin{DoxyCompactList}\small\item\em Specify the Will message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_ab8195471f702b58564775c62249bff81}{mqtt\+Sn\+Client\+Bind\+To\+Interface} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$interface)
\begin{DoxyCompactList}\small\item\em Bind the M\+Q\+T\+T-\/\+SN client to a particular network interface. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a3fe66b7dfc48851293112308f586fb7a}{mqtt\+Sn\+Client\+Set\+Gateway} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$gw\+Ip\+Addr, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} gw\+Port)
\begin{DoxyCompactList}\small\item\em Specify the address of the gateway. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a4c65943f9e4596eac884440fe3ccb23b}{mqtt\+Sn\+Client\+Search\+Gateway} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$\hyperlink{ipcp_8h_a752e1719cf65f78dfec6274352cb56df}{dest\+Ip\+Addr}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} \hyperlink{udp_8h_af15d713ad2bc92686abfa6ab012b5039}{dest\+Port})
\begin{DoxyCompactList}\small\item\em Search for a gateway. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a7c478abdd8f0b7a886f2f283dfad7aa0}{mqtt\+Sn\+Client\+Connect} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_a34fa00ac0448386d644eb92f070aadb6}{clean\+Session})
\begin{DoxyCompactList}\small\item\em Establish connection with the M\+Q\+T\+T-\/\+SN gateway. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_affecc396a00f26096496a74ac88f4668}{mqtt\+Sn\+Client\+Publish} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name}, const void $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level} \hyperlink{mqtt__sn__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msg\+Id})
\begin{DoxyCompactList}\small\item\em Publish message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a833f4757a82301f7c5d1fef6d8c82e5d}{mqtt\+Sn\+Client\+Subscribe} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name}, \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level} \hyperlink{mqtt__sn__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos})
\begin{DoxyCompactList}\small\item\em Subscribe to topic. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a8327da75540613194c3cb1fa5b99d2db}{mqtt\+Sn\+Client\+Unsubscribe} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topic\+Name})
\begin{DoxyCompactList}\small\item\em Unsubscribe from topic. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a5bc64e15f9306a10b0ba709b45eb22f8}{mqtt\+Sn\+Client\+Ping} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Send ping request. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_afa4d08df03fe1345764e5f08eb2d7434}{mqtt\+Sn\+Client\+Update\+Will\+Message} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$topic, const void $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level} \hyperlink{mqtt__sn__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain})
\begin{DoxyCompactList}\small\item\em Update the Will message. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a1d73b7ebdc9846ea26b622b06fbbfb40}{mqtt\+Sn\+Client\+Get\+Return\+Code} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9c}{Mqtt\+Sn\+Return\+Code} $\ast$\hyperlink{mqtt__sn__common_8h_aa43af56bba229c3214623f0f0c23bf6e}{return\+Code})
\begin{DoxyCompactList}\small\item\em Retrieve return code. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_aaa8d5dec9766a744b8c4a95d0d04824c}{mqtt\+Sn\+Client\+Task} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t} timeout)
\begin{DoxyCompactList}\small\item\em Process M\+Q\+T\+T-\/\+SN client events. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{mqtt__sn__client_8h_a684773e9dc4529da1c907b8106c411c3}{mqtt\+Sn\+Client\+Disconnect} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Disconnect from the M\+Q\+T\+T-\/\+SN gateway. \end{DoxyCompactList}\item 
void \hyperlink{mqtt__sn__client_8h_ab76e1ebe375a1b10e7fed0af4d4e3378}{mqtt\+Sn\+Client\+Deinit} (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Release M\+Q\+T\+T-\/\+SN client context. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
M\+Q\+T\+T-\/\+SN client. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+T\+CP Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{mqtt__sn__client_8h_ac658597e1991ef68bcc1a2cc5c5c5376}\label{mqtt__sn__client_8h_ac658597e1991ef68bcc1a2cc5c5c5376}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE}{MQTT\_SN\_CLIENT\_DEFAULT\_KEEP\_ALIVE}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+VE~0}



Definition at line 111 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_afe0d365aa5d9cf22df9a84a9a1515b8c}\label{mqtt__sn__client_8h_afe0d365aa5d9cf22df9a84a9a1515b8c}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT}{MQTT\_SN\_CLIENT\_DEFAULT\_TIMEOUT}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+M\+E\+O\+UT~30000}



Definition at line 104 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_ab5af0505d6eb46d2cfc41e4075c9dacd}\label{mqtt__sn__client_8h_ab5af0505d6eb46d2cfc41e4075c9dacd}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT}{MQTT\_SN\_CLIENT\_DTLS\_SUPPORT}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+T\+L\+S\+\_\+\+S\+U\+P\+P\+O\+RT~\hyperlink{os__port_8h_abd5c8ab57c190a6522ccdbf0ed7577da}{D\+I\+S\+A\+B\+L\+ED}}



Definition at line 48 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a8903ddd9dd0e6d56d19a16aa63381389}\label{mqtt__sn__client_8h_a8903ddd9dd0e6d56d19a16aa63381389}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN}{MQTT\_SN\_CLIENT\_MAX\_ID\_LEN}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+I\+D\+\_\+\+L\+EN~23}



Definition at line 69 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a20c1e6ef1d8aa1ff620efeeaecfc03f0}\label{mqtt__sn__client_8h_a20c1e6ef1d8aa1ff620efeeaecfc03f0}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES}{MQTT\_SN\_CLIENT\_MAX\_KEEP\_ALIVE\_PROBES}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+P\+R\+O\+B\+ES~5}



Definition at line 118 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a746a6fb4ce05f20c05f8a852a1e376e1}\label{mqtt__sn__client_8h_a746a6fb4ce05f20c05f8a852a1e376e1}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN}{MQTT\_SN\_CLIENT\_MAX\_TOPIC\_NAME\_LEN}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+T\+O\+P\+I\+C\+\_\+\+N\+A\+M\+E\+\_\+\+L\+EN~32}



Definition at line 76 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a1059cb0e47f7c47d79ca58c5f29c6126}\label{mqtt__sn__client_8h_a1059cb0e47f7c47d79ca58c5f29c6126}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN}{MQTT\_SN\_CLIENT\_MAX\_WILL\_PAYLOAD\_LEN}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+P\+A\+Y\+L\+O\+A\+D\+\_\+\+L\+EN~32}



Definition at line 90 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_ae418ee87e6d47c1cfdb4e7a5694a2caa}\label{mqtt__sn__client_8h_ae418ee87e6d47c1cfdb4e7a5694a2caa}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN}{MQTT\_SN\_CLIENT\_MAX\_WILL\_TOPIC\_LEN}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+W\+I\+L\+L\+\_\+\+T\+O\+P\+I\+C\+\_\+\+L\+EN~32}



Definition at line 83 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}\label{mqtt__sn__client_8h_a720582816fcc2db4accc2fb95955c92c}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}{MQTT\_SN\_CLIENT\_MSG\_ID\_TABLE\_SIZE}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+S\+G\+\_\+\+I\+D\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE~10}



Definition at line 62 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}\label{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+R\+E\+T\+R\+Y\+\_\+\+T\+I\+M\+E\+O\+UT~5000}



Definition at line 132 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a7d9c6d732aae16efd9db028f3ecfa2d1}\label{mqtt__sn__client_8h_a7d9c6d732aae16efd9db028f3ecfa2d1}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY}{MQTT\_SN\_CLIENT\_SEARCH\_DELAY}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+E\+A\+R\+C\+H\+\_\+\+D\+E\+L\+AY~0}



Definition at line 125 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_ae2b7c85633e90ad7a60eaefd0ec9f2d5}\label{mqtt__sn__client_8h_ae2b7c85633e90ad7a60eaefd0ec9f2d5}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT}{MQTT\_SN\_CLIENT\_SUPPORT}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+U\+P\+P\+O\+RT~\hyperlink{os__port_8h_a73c228f87e038e8295ee8ea8eceaa5ac}{E\+N\+A\+B\+L\+ED}}



Definition at line 41 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}\label{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+I\+C\+K\+\_\+\+I\+N\+T\+E\+R\+V\+AL~100}



Definition at line 97 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}\label{mqtt__sn__client_8h_a5b09bca70606bc04d0c7ae24e2319f75}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}}
\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE}{MQTT\_SN\_CLIENT\_TOPIC\_TABLE\_SIZE}}
{\footnotesize\ttfamily \#define M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+T\+O\+P\+I\+C\+\_\+\+T\+A\+B\+L\+E\+\_\+\+S\+I\+ZE~10}



Definition at line 55 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}\label{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!Mqtt\+Sn\+Client\+Context@{Mqtt\+Sn\+Client\+Context}}
\index{Mqtt\+Sn\+Client\+Context@{Mqtt\+Sn\+Client\+Context}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{Mqtt\+Sn\+Client\+Context}{MqttSnClientContext}}
{\footnotesize\ttfamily \#define Mqtt\+Sn\+Client\+Context~struct \hyperlink{struct__MqttSnClientContext}{\+\_\+\+Mqtt\+Sn\+Client\+Context}}



Definition at line 145 of file mqtt\+\_\+sn\+\_\+client.\+h.



\subsection{Typedef Documentation}
\mbox{\Hypertarget{mqtt__sn__client_8h_a0aa65bd0e127e05595c247c01aeca2d5}\label{mqtt__sn__client_8h_a0aa65bd0e127e05595c247c01aeca2d5}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!Mqtt\+Sn\+Client\+Dtls\+Init\+Callback@{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback}}
\index{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback@{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback}{MqttSnClientDtlsInitCallback}}
{\footnotesize\ttfamily typedef \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t}($\ast$ Mqtt\+Sn\+Client\+Dtls\+Init\+Callback) (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, \hyperlink{tls_8h_ac09f7a286c0cdf9b07ee1edd107946f5}{Tls\+Context} $\ast$dtls\+Context)}



D\+T\+LS initialization callback. 



Definition at line 179 of file mqtt\+\_\+sn\+\_\+client.\+h.

\mbox{\Hypertarget{mqtt__sn__client_8h_a4f0890f5b533cda2ad972b1e433cf109}\label{mqtt__sn__client_8h_a4f0890f5b533cda2ad972b1e433cf109}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!Mqtt\+Sn\+Client\+Publish\+Callback@{Mqtt\+Sn\+Client\+Publish\+Callback}}
\index{Mqtt\+Sn\+Client\+Publish\+Callback@{Mqtt\+Sn\+Client\+Publish\+Callback}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{Mqtt\+Sn\+Client\+Publish\+Callback}{MqttSnClientPublishCallback}}
{\footnotesize\ttfamily typedef void($\ast$ Mqtt\+Sn\+Client\+Publish\+Callback) (\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$context, const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$topic, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{pap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level} \hyperlink{mqtt__sn__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} \hyperlink{mqtt__sn__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain})}



P\+U\+B\+L\+I\+SH message received callback. 



Definition at line 189 of file mqtt\+\_\+sn\+\_\+client.\+h.



\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!Mqtt\+Sn\+Client\+State@{Mqtt\+Sn\+Client\+State}}
\index{Mqtt\+Sn\+Client\+State@{Mqtt\+Sn\+Client\+State}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{Mqtt\+Sn\+Client\+State}{MqttSnClientState}}
{\footnotesize\ttfamily enum \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071}{Mqtt\+Sn\+Client\+State}}



M\+Q\+T\+T-\/\+SN client states. 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+ED@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+ED}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+ED@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+ED}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+ED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+A\+R\+C\+H\+I\+NG@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+A\+R\+C\+H\+I\+NG}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+A\+R\+C\+H\+I\+NG@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+A\+R\+C\+H\+I\+NG}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a467b75c7773b826b5bd91423b6bd91fc}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a467b75c7773b826b5bd91423b6bd91fc}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+A\+R\+C\+H\+I\+NG&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+NG@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+NG}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+NG@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+NG}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9bdad609f89dd17ca63814c753160111}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9bdad609f89dd17ca63814c753160111}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+NG&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+C\+T\+I\+VE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+C\+T\+I\+VE}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+C\+T\+I\+VE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+C\+T\+I\+VE}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+C\+T\+I\+VE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+R\+EQ@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+R\+EQ}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+R\+EQ@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+R\+EQ}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+R\+EQ&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+P\+\_\+\+R\+E\+C\+E\+I\+V\+ED@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+P\+\_\+\+R\+E\+C\+E\+I\+V\+ED}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+P\+\_\+\+R\+E\+C\+E\+I\+V\+ED@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+P\+\_\+\+R\+E\+C\+E\+I\+V\+ED}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+R\+E\+S\+P\+\_\+\+R\+E\+C\+E\+I\+V\+ED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+L\+O\+ST@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+L\+O\+ST}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+L\+O\+ST@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+L\+O\+ST}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a4d296b47cc0bfaf9d881c2a6083daef6}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a4d296b47cc0bfaf9d881c2a6083daef6}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+L\+O\+ST&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+S\+L\+E\+EP@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+S\+L\+E\+EP}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+S\+L\+E\+EP@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+S\+L\+E\+EP}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a36a8a8cd0fc56b982e31dbec65a03cee}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a36a8a8cd0fc56b982e31dbec65a03cee}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+S\+L\+E\+EP&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+W\+A\+KE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+W\+A\+KE}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+W\+A\+KE@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+W\+A\+KE}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a6ac12ebbb806bcaa8b7040372740b244}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a6ac12ebbb806bcaa8b7040372740b244}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+A\+W\+A\+KE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+I\+NG@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+I\+NG}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+I\+NG@{M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+I\+NG}}}\mbox{\Hypertarget{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}\label{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}} 
M\+Q\+T\+T\+\_\+\+S\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+I\+NG&\\
\hline

\end{DoxyEnumFields}


Definition at line 157 of file mqtt\+\_\+sn\+\_\+client.\+h.


\begin{DoxyCode}
158 \{
159    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED}  = 0,
160    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a467b75c7773b826b5bd91423b6bd91fc}{MQTT\_SN\_CLIENT\_STATE\_SEARCHING}     = 1,
161    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9bdad609f89dd17ca63814c753160111}{MQTT\_SN\_CLIENT\_STATE\_CONNECTING}    = 2,
162    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE}        = 3,
163    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ}   = 4,
164    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED} = 5,
165    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a4d296b47cc0bfaf9d881c2a6083daef6}{MQTT\_SN\_CLIENT\_STATE\_LOST}          = 6,
166    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a36a8a8cd0fc56b982e31dbec65a03cee}{MQTT\_SN\_CLIENT\_STATE\_ASLEEP}        = 7,
167    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a6ac12ebbb806bcaa8b7040372740b244}{MQTT\_SN\_CLIENT\_STATE\_AWAKE}         = 8,
168    \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING} = 9
169 \} \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071}{MqttSnClientState};
\end{DoxyCode}


\subsection{Function Documentation}
\mbox{\Hypertarget{mqtt__sn__client_8h_ab8195471f702b58564775c62249bff81}\label{mqtt__sn__client_8h_ab8195471f702b58564775c62249bff81}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Bind\+To\+Interface@{mqtt\+Sn\+Client\+Bind\+To\+Interface}}
\index{mqtt\+Sn\+Client\+Bind\+To\+Interface@{mqtt\+Sn\+Client\+Bind\+To\+Interface}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Bind\+To\+Interface()}{mqttSnClientBindToInterface()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Bind\+To\+Interface (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{net_8h_a2234db8911a1148c9159979d8f5e0d6b}{Net\+Interface} $\ast$}]{interface }\end{DoxyParamCaption})}



Bind the M\+Q\+T\+T-\/\+SN client to a particular network interface. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em interface} & Network interface to be used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 319 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
321 \{
322    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
323    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
324       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
325 
326    \textcolor{comment}{//Explicitly associate the MQTT client with the specified interface}
327    context->interface = interface;
328 
329    \textcolor{comment}{//Successful processing}
330    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
331 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a7c478abdd8f0b7a886f2f283dfad7aa0}\label{mqtt__sn__client_8h_a7c478abdd8f0b7a886f2f283dfad7aa0}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Connect@{mqtt\+Sn\+Client\+Connect}}
\index{mqtt\+Sn\+Client\+Connect@{mqtt\+Sn\+Client\+Connect}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Connect()}{mqttSnClientConnect()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Connect (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{clean\+Session }\end{DoxyParamCaption})}



Establish connection with the M\+Q\+T\+T-\/\+SN gateway. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em clean\+Session} & If this flag is set, then the client and server must discard any previous session and start a new one \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 479 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
480 \{
481    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
482    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
483 
484    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
485    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
486       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
487 
488    \textcolor{comment}{//Initialize status code}
489    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
490 
491    \textcolor{comment}{//Establish connection with the MQTT-SN gateway}
492    \textcolor{keywordflow}{while}(!error)
493    \{
494       \textcolor{comment}{//Get current time}
495       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
496 
497       \textcolor{comment}{//Check current state}
498       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED})
499       \{
500          \textcolor{comment}{//Open network connection}
501          error = \hyperlink{mqtt__sn__client__transport_8c_a12bb832d0d0ab19156caf80131ed7f64}{mqttSnClientOpenConnection}(context, 
      \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
502 
503          \textcolor{comment}{//Check status code}
504          \textcolor{keywordflow}{if}(!error)
505          \{
506             \textcolor{comment}{//Save current time}
507             context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
508             \textcolor{comment}{//Update MQTT-SN client state}
509             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9bdad609f89dd17ca63814c753160111}{MQTT\_SN\_CLIENT\_STATE\_CONNECTING};
510          \}
511       \}
512       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9bdad609f89dd17ca63814c753160111}{MQTT\_SN\_CLIENT\_STATE\_CONNECTING})
513       \{
514          \textcolor{comment}{//Establish DTLS connection}
515          error = \hyperlink{mqtt__sn__client__transport_8c_a6cd7e875c4210980d2c45d1cc19a6b3c}{mqttSnClientEstablishConnection}(context);
516 
517          \textcolor{comment}{//Check status code}
518          \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR})
519          \{
520             \textcolor{comment}{//Check whether the CleanSession flag is set}
521             \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__common_8h_a34fa00ac0448386d644eb92f070aadb6}{cleanSession})
522             \{
523                \textcolor{comment}{//Discard previous session state}
524                memset(context->topicTable, 0, \textcolor{keyword}{sizeof}(context->topicTable));
525                memset(context->msgIdTable, 0, \textcolor{keyword}{sizeof}(context->msgIdTable));
526             \}
527 
528             \textcolor{comment}{//The CONNECT message is sent by a client to setup a connection}
529             error = \hyperlink{mqtt__sn__client__message_8c_a065452383ebdbb044bd37a36c8fbcc75}{mqttSnClientSendConnect}(context, 
      \hyperlink{mqtt__sn__common_8h_a34fa00ac0448386d644eb92f070aadb6}{cleanSession});
530          \}
531          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(error == \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK} || error == 
      \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT})
532          \{
533             \textcolor{comment}{//Check whether the timeout has elapsed}
534             \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
535             \{
536                \textcolor{comment}{//Report an error}
537                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
538             \}
539          \}
540          \textcolor{keywordflow}{else}
541          \{
542             \textcolor{comment}{//Failed to establish DTLS connection}
543          \}
544       \}
545       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
546       \{
547          \textcolor{comment}{//Check whether the timeout has elapsed}
548          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
549          \{
550             \textcolor{comment}{//Abort the retransmission procedure}
551             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
552          \}
553          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
554             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
555          \{
556             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
557             \textcolor{comment}{//is not received, the client retransmits the message}
558             error = \hyperlink{mqtt__sn__client__message_8c_a065452383ebdbb044bd37a36c8fbcc75}{mqttSnClientSendConnect}(context, 
      \hyperlink{mqtt__sn__common_8h_a34fa00ac0448386d644eb92f070aadb6}{cleanSession});
559          \}
560          \textcolor{keywordflow}{else}
561          \{
562             \textcolor{comment}{//Wait for the gateway's reply}
563             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
564          \}
565       \}
566       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
567       \{
568          \textcolor{comment}{//Check the type of the received message}
569          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112af473b9ecc7101028dd6986d4c052fecd}{MQTT\_SN\_MSG\_TYPE\_CONNACK})
570          \{
571             \textcolor{comment}{//If the connection request has not been accepted, the failure reason}
572             \textcolor{comment}{//is encoded in the return code field of the CONNACK message}
573             \textcolor{keywordflow}{if}(context->returnCode == \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED})
574             \{
575                \textcolor{comment}{//The connection request has been accepted by the gateway}
576                context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE};
577             \}
578             \textcolor{keywordflow}{else}
579             \{
580                \textcolor{comment}{//Terminate DTLS connection}
581                \hyperlink{mqtt__sn__client__transport_8c_a4f5316380fb801843f3e64624b221306}{mqttSnClientShutdownConnection}(context);
582 
583                \textcolor{comment}{//The connection request has been rejected by the gateway}
584                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac26eec5bbb83dd552d12e20de474b326}{ERROR\_REQUEST\_REJECTED};
585             \}
586          \}
587          \textcolor{keywordflow}{else}
588          \{
589             \textcolor{comment}{//Report an error}
590             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
591          \}
592       \}
593       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
594       \{
595          \textcolor{comment}{//The MQTT-SN client is connected}
596          \textcolor{keywordflow}{break};
597       \}
598       \textcolor{keywordflow}{else}
599       \{
600          \textcolor{comment}{//Invalid state}
601          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
602       \}
603    \}
604 
605    \textcolor{comment}{//Any error to report?}
606    \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} && error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK})
607    \{
608       \textcolor{comment}{//Clean up side effects}
609       \hyperlink{mqtt__sn__client__transport_8c_a0ceab50877bbe9943ae16592f4f243a0}{mqttSnClientCloseConnection}(context);
610       \textcolor{comment}{//Update MQTT-SN client state}
611       context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED};
612    \}
613 
614    \textcolor{comment}{//Return status code}
615    \textcolor{keywordflow}{return} error;
616 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_ab76e1ebe375a1b10e7fed0af4d4e3378}\label{mqtt__sn__client_8h_ab76e1ebe375a1b10e7fed0af4d4e3378}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Deinit@{mqtt\+Sn\+Client\+Deinit}}
\index{mqtt\+Sn\+Client\+Deinit@{mqtt\+Sn\+Client\+Deinit}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Deinit()}{mqttSnClientDeinit()}}
{\footnotesize\ttfamily void mqtt\+Sn\+Client\+Deinit (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Release M\+Q\+T\+T-\/\+SN client context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\end{DoxyParams}


Definition at line 1462 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
1463 \{
1464    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
1465    \textcolor{keywordflow}{if}(context != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1466    \{
1467       \textcolor{comment}{//Close connection}
1468       \hyperlink{mqtt__sn__client__transport_8c_a0ceab50877bbe9943ae16592f4f243a0}{mqttSnClientCloseConnection}(context);
1469 
1470 \textcolor{preprocessor}{#if (MQTT\_SN\_CLIENT\_DTLS\_SUPPORT == ENABLED)}
1471       \textcolor{comment}{//Release DTLS session state}
1472       \hyperlink{tls_8c_a6e78d966a9bcd9eb6210c996389f6551}{tlsFreeSessionState}(&context->dtlsSession);
1473 \textcolor{preprocessor}{#endif}
1474 
1475       \textcolor{comment}{//Clear MQTT-SN client context}
1476       memset(context, 0, \textcolor{keyword}{sizeof}(\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{MqttSnClientContext}));
1477    \}
1478 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a684773e9dc4529da1c907b8106c411c3}\label{mqtt__sn__client_8h_a684773e9dc4529da1c907b8106c411c3}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Disconnect@{mqtt\+Sn\+Client\+Disconnect}}
\index{mqtt\+Sn\+Client\+Disconnect@{mqtt\+Sn\+Client\+Disconnect}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Disconnect()}{mqttSnClientDisconnect()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Disconnect (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Disconnect from the M\+Q\+T\+T-\/\+SN gateway. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1369 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
1370 \{
1371    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1372    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1373 
1374    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
1375    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1376       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1377 
1378    \textcolor{comment}{//Initialize status code}
1379    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1380 
1381    \textcolor{comment}{//Disconnect procedure}
1382    \textcolor{keywordflow}{while}(!error)
1383    \{
1384       \textcolor{comment}{//Get current time}
1385       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1386 
1387       \textcolor{comment}{//Check current state}
1388       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
1389       \{
1390          \textcolor{comment}{//Save current time}
1391          context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1392 
1393          \textcolor{comment}{//The DISCONNECT message is sent by a client to indicate that it}
1394          \textcolor{comment}{//wants to close the connection}
1395          error = \hyperlink{mqtt__sn__client__message_8c_a37cecab2e41579d1d84adbb92735a72c}{mqttSnClientSendDisconnect}(context, 0);
1396       \}
1397       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
1398       \{
1399          \textcolor{comment}{//Check whether the timeout has elapsed}
1400          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
1401          \{
1402             \textcolor{comment}{//Terminate DTLS connection}
1403             \hyperlink{mqtt__sn__client__transport_8c_a4f5316380fb801843f3e64624b221306}{mqttSnClientShutdownConnection}(context);
1404 
1405             \textcolor{comment}{//Report a timeout error}
1406             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
1407          \}
1408          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
1409             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
1410          \{
1411             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
1412             \textcolor{comment}{//is not received, the client retransmits the message}
1413             error = \hyperlink{mqtt__sn__client__message_8c_a37cecab2e41579d1d84adbb92735a72c}{mqttSnClientSendDisconnect}(context, 0);
1414          \}
1415          \textcolor{keywordflow}{else}
1416          \{
1417             \textcolor{comment}{//Wait for the gateway's reply}
1418             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
1419          \}
1420       \}
1421       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING})
1422       \{
1423          \textcolor{comment}{//Terminate DTLS connection}
1424          error = \hyperlink{mqtt__sn__client__transport_8c_a4f5316380fb801843f3e64624b221306}{mqttSnClientShutdownConnection}(context);
1425          \textcolor{comment}{//Close network connection}
1426          \hyperlink{mqtt__sn__client__transport_8c_a0ceab50877bbe9943ae16592f4f243a0}{mqttSnClientCloseConnection}(context);
1427 
1428          \textcolor{comment}{//The connection is closed}
1429          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED};
1430       \}
1431       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED})
1432       \{
1433          \textcolor{comment}{//The MQTT-SN client is disconnected}
1434          \textcolor{keywordflow}{break};
1435       \}
1436       \textcolor{keywordflow}{else}
1437       \{
1438          \textcolor{comment}{//Invalid state}
1439          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
1440       \}
1441    \}
1442 
1443    \textcolor{comment}{//Any error to report?}
1444    \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} && error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK})
1445    \{
1446       \textcolor{comment}{//Close network connection}
1447       \hyperlink{mqtt__sn__client__transport_8c_a0ceab50877bbe9943ae16592f4f243a0}{mqttSnClientCloseConnection}(context);
1448       \textcolor{comment}{//Update MQTT-SN client state}
1449       context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED};
1450    \}
1451 
1452    \textcolor{comment}{//Return status code}
1453    \textcolor{keywordflow}{return} error;
1454 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a1d73b7ebdc9846ea26b622b06fbbfb40}\label{mqtt__sn__client_8h_a1d73b7ebdc9846ea26b622b06fbbfb40}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Get\+Return\+Code@{mqtt\+Sn\+Client\+Get\+Return\+Code}}
\index{mqtt\+Sn\+Client\+Get\+Return\+Code@{mqtt\+Sn\+Client\+Get\+Return\+Code}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Get\+Return\+Code()}{mqttSnClientGetReturnCode()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Get\+Return\+Code (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9c}{Mqtt\+Sn\+Return\+Code} $\ast$}]{return\+Code }\end{DoxyParamCaption})}



Retrieve return code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt out}  & {\em return\+Code} & Return code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1314 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
1316 \{
1317    \textcolor{comment}{//Check parameters}
1318    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{mqtt__sn__common_8h_aa43af56bba229c3214623f0f0c23bf6e}{returnCode} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1319       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1320 
1321    \textcolor{comment}{//Retrieve return code}
1322    *\hyperlink{mqtt__sn__common_8h_aa43af56bba229c3214623f0f0c23bf6e}{returnCode} = context->returnCode;
1323 
1324    \textcolor{comment}{//Successful processing}
1325    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1326 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_ab400c38eea27a5f985932f44724dfc1e}\label{mqtt__sn__client_8h_ab400c38eea27a5f985932f44724dfc1e}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Init@{mqtt\+Sn\+Client\+Init}}
\index{mqtt\+Sn\+Client\+Init@{mqtt\+Sn\+Client\+Init}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Init()}{mqttSnClientInit()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Initialize M\+Q\+T\+T-\/\+SN client context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 52 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
53 \{
54 \textcolor{preprocessor}{#if (MQTT\_SN\_CLIENT\_DTLS\_SUPPORT == ENABLED)}
55    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
56 \textcolor{preprocessor}{#endif}
57 
58    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
59    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
60       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
61 
62    \textcolor{comment}{//Clear MQTT-SN client context}
63    memset(context, 0, \textcolor{keyword}{sizeof}(\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{MqttSnClientContext}));
64 
65 \textcolor{preprocessor}{#if (MQTT\_SN\_CLIENT\_DTLS\_SUPPORT == ENABLED)}
66    \textcolor{comment}{//Initialize DTLS session state}
67    error = \hyperlink{tls_8c_aea7b98b4b876fe45322df04583f7c1b4}{tlsInitSessionState}(&context->dtlsSession);
68    \textcolor{comment}{//Any error to report?}
69    \textcolor{keywordflow}{if}(error)
70       \textcolor{keywordflow}{return} error;
71 \textcolor{preprocessor}{#endif}
72 
73    \textcolor{comment}{//Initialize MQTT-SN client state}
74    context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED};
75 
76    \textcolor{comment}{//Default transport protocol}
77    context->transportProtocol = \hyperlink{mqtt__sn__common_8h_a253f39a8dfbcfb9062c71a05947121eba8ab163f8a670315259bf52cb4868a002}{MQTT\_SN\_TRANSPORT\_PROTOCOL\_UDP};
78    \textcolor{comment}{//Default timeout}
79    context->timeout = \hyperlink{mqtt__sn__client_8h_afe0d365aa5d9cf22df9a84a9a1515b8c}{MQTT\_SN\_CLIENT\_DEFAULT\_TIMEOUT};
80    \textcolor{comment}{//Default keep-alive time interval}
81    context->keepAlive = \hyperlink{mqtt__sn__client_8h_ac658597e1991ef68bcc1a2cc5c5c5376}{MQTT\_SN\_CLIENT\_DEFAULT\_KEEP\_ALIVE};
82 
83    \textcolor{comment}{//Initialize message identifier}
84    context->msgId = 0;
85 
86    \textcolor{comment}{//Successful initialization}
87    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
88 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a5bc64e15f9306a10b0ba709b45eb22f8}\label{mqtt__sn__client_8h_a5bc64e15f9306a10b0ba709b45eb22f8}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Ping@{mqtt\+Sn\+Client\+Ping}}
\index{mqtt\+Sn\+Client\+Ping@{mqtt\+Sn\+Client\+Ping}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Ping()}{mqttSnClientPing()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Ping (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Send ping request. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1069 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
1070 \{
1071    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1072    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1073 
1074    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
1075    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1076       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1077 
1078    \textcolor{comment}{//Initialize status code}
1079    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1080 
1081    \textcolor{comment}{//Send PINGREQ packet and wait for PINGRESP packet to be received}
1082    \textcolor{keywordflow}{while}(!error)
1083    \{
1084       \textcolor{comment}{//Get current time}
1085       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1086 
1087       \textcolor{comment}{//Check current state}
1088       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
1089       \{
1090          \textcolor{comment}{//Save current time}
1091          context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1092          context->retransmitStartTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1093 
1094          \textcolor{comment}{//Send PINGREQ message}
1095          error = \hyperlink{mqtt__sn__client__message_8c_a6b0db34af4f76e875fd5e471de572589}{mqttSnClientSendPingReq}(context);
1096 
1097          \textcolor{comment}{//Update MQTT-SN client state}
1098          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ};
1099          context->msgType = \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a194c6e9f117a199acf63ea58f394d57d}{MQTT\_SN\_MSG\_TYPE\_PINGREQ};
1100       \}
1101       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
1102       \{
1103          \textcolor{comment}{//Check whether the timeout has elapsed}
1104          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
1105          \{
1106             \textcolor{comment}{//Abort the retransmission procedure}
1107             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING};
1108             \textcolor{comment}{//Report a timeout error}
1109             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
1110          \}
1111          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
1112             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
1113          \{
1114             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
1115             \textcolor{comment}{//is not received, the client retransmits the message}
1116             error = \hyperlink{mqtt__sn__client__message_8c_a6b0db34af4f76e875fd5e471de572589}{mqttSnClientSendPingReq}(context);
1117 
1118             \textcolor{comment}{//Save the time at which the message was sent}
1119             context->retransmitStartTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1120          \}
1121          \textcolor{keywordflow}{else}
1122          \{
1123             \textcolor{comment}{//Wait for the gateway's reply}
1124             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
1125          \}
1126       \}
1127       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
1128       \{
1129          \textcolor{comment}{//Update MQTT-SN client state}
1130          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE};
1131 
1132          \textcolor{comment}{//Check the type of the received message}
1133          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a7b0b690c0417ac129942d2b7bcc4c033}{MQTT\_SN\_MSG\_TYPE\_PINGRESP})
1134          \{
1135             \textcolor{comment}{//A PINGRESP message has been received}
1136             \textcolor{keywordflow}{break};
1137          \}
1138          \textcolor{keywordflow}{else}
1139          \{
1140             \textcolor{comment}{//Report an error}
1141             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
1142          \}
1143       \}
1144       \textcolor{keywordflow}{else}
1145       \{
1146          \textcolor{comment}{//Invalid state}
1147          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
1148       \}
1149    \}
1150 
1151    \textcolor{comment}{//Return status code}
1152    \textcolor{keywordflow}{return} error;
1153 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_affecc396a00f26096496a74ac88f4668}\label{mqtt__sn__client_8h_affecc396a00f26096496a74ac88f4668}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Publish@{mqtt\+Sn\+Client\+Publish}}
\index{mqtt\+Sn\+Client\+Publish@{mqtt\+Sn\+Client\+Publish}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Publish()}{mqttSnClientPublish()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Publish (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name,  }\item[{const void $\ast$}]{message,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level}}]{qos,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{retain,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{dup,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$}]{msg\+Id }\end{DoxyParamCaption})}



Publish message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Topic name \\
\hline
\mbox{\tt in}  & {\em message} & Message payload \\
\hline
\mbox{\tt in}  & {\em length} & Length of the message payload \\
\hline
\mbox{\tt in}  & {\em qos} & QoS level to be used when publishing the message \\
\hline
\mbox{\tt in}  & {\em retain} & This flag specifies if the message is to be retained \\
\hline
\mbox{\tt in}  & {\em dup} & This flag specifies if the message is sent for the first time or if the message is retransmitted \\
\hline
\mbox{\tt in,out}  & {\em msg\+Id} & Message identifier used to send the P\+U\+B\+L\+I\+SH message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 633 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
636 \{
637    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
638    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
639    \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\_t} publishMsgId;
640 
641    \textcolor{comment}{//Check parameters}
642    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
643       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
644    \textcolor{keywordflow}{if}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} != 0)
645       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
646    \textcolor{keywordflow}{if}(\hyperlink{mqtt__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup} && \hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
647       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
648 
649    \textcolor{comment}{//Initialize status code}
650    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
651 
652    \textcolor{comment}{//Initialize message identifier}
653    \textcolor{keywordflow}{if}(\hyperlink{mqtt__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup})
654       publishMsgId = *\hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId};
655    \textcolor{keywordflow}{else}
656       publishMsgId = 0;
657 
658    \textcolor{comment}{//Publish procedure}
659    \textcolor{keywordflow}{while}(!error)
660    \{
661       \textcolor{comment}{//Get current time}
662       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
663 
664       \textcolor{comment}{//Check current state}
665       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
666       \{
667          \textcolor{comment}{//Save current time}
668          context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
669 
670          \textcolor{comment}{//Check whether the register procedure is needed}
671          \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__client__misc_8c_a562e489c567eebf11c934e7379b42022}{mqttSnClientIsShortTopicName}(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}) == 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} &&
672             \hyperlink{mqtt__sn__client__misc_8c_a2cd69e6ec99d3b7c7bddd0452a7308d0}{mqttSnClientFindTopicName}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}) == 0 &&
673             \hyperlink{mqtt__sn__client__misc_8c_a5a3a8ce51441f762a4d7a92a24d1c936}{mqttSnClientFindPredefTopicName}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}) == 0)
674          \{
675             \textcolor{comment}{//The message identifier allows the sender to match a message with}
676             \textcolor{comment}{//its corresponding acknowledgment}
677             \hyperlink{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}{mqttSnClientGenerateMessageId}(context);
678 
679             \textcolor{comment}{//To register a topic name a client sends a REGISTER message to}
680             \textcolor{comment}{//the gateway}
681             error = \hyperlink{mqtt__sn__client__message_8c_a8f404825e3cad7813b703b61aea12bcc}{mqttSnClientSendRegister}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName});
682          \}
683          \textcolor{keywordflow}{else}
684          \{
685             \textcolor{comment}{//The message ID is only relevant in case of QoS levels 1 and 2}
686             \textcolor{keywordflow}{if}(\hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos} == \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6a7bf24115b2392060ea344c786c324075}{MQTT\_SN\_QOS\_LEVEL\_1} || \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos} == 
      \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6afcf6709e25108bc27d7f7002a1aeb28e}{MQTT\_SN\_QOS\_LEVEL\_2})
687             \{
688                \textcolor{comment}{//The message identifier allows the sender to match a message with}
689                \textcolor{comment}{//its corresponding acknowledgment}
690                \textcolor{keywordflow}{if}(!\hyperlink{mqtt__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup})
691                   publishMsgId = \hyperlink{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}{mqttSnClientGenerateMessageId}(context);
692             \}
693             \textcolor{keywordflow}{else}
694             \{
695                \textcolor{comment}{//For QoS level 0, the message identifier is coded 0x0000}
696                publishMsgId = 0;
697             \}
698 
699             \textcolor{comment}{//The client can start publishing data relating to the registered}
700             \textcolor{comment}{//topic name by sending PUBLISH messages to the gateway}
701             error = \hyperlink{mqtt__sn__client__message_8c_a7e170c895c48b07088a06135457afbc3}{mqttSnClientSendPublish}(context, publishMsgId, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName},
702                \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{mqtt__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain}, \hyperlink{mqtt__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup});
703 
704             \textcolor{comment}{//In the QoS 0, no response is sent by the receiver and no retry}
705             \textcolor{comment}{//is performed by the sender}
706             \textcolor{keywordflow}{if}(\hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos} != \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6a7bf24115b2392060ea344c786c324075}{MQTT\_SN\_QOS\_LEVEL\_1} && \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos} != 
      \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6afcf6709e25108bc27d7f7002a1aeb28e}{MQTT\_SN\_QOS\_LEVEL\_2})
707                \textcolor{keywordflow}{break};
708          \}
709       \}
710       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
711       \{
712          \textcolor{comment}{//Check whether the transmission of the PUBLISH message has started}
713          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a37c9bc96e12d4079199211d7aeda5398}{MQTT\_SN\_MSG\_TYPE\_PUBLISH} ||
714             context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112ac8a07a546f23a523b469944a26de0ab1}{MQTT\_SN\_MSG\_TYPE\_PUBREL})
715          \{
716             \textcolor{comment}{//Restore the message identifier that was used to send the first}
717             \textcolor{comment}{//PUBLISH message}
718             \textcolor{keywordflow}{if}(!\hyperlink{mqtt__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup})
719                publishMsgId = context->msgId;
720          \}
721 
722          \textcolor{comment}{//Check whether the timeout has elapsed}
723          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
724          \{
725             \textcolor{comment}{//Abort the retransmission procedure}
726             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING};
727             \textcolor{comment}{//Report a timeout error}
728             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
729          \}
730          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
731             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
732          \{
733             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
734             \textcolor{comment}{//is not received, the client retransmits the message}
735             \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a74d8f28e6bd857bad8753800d962b118}{MQTT\_SN\_MSG\_TYPE\_REGISTER})
736             \{
737                \textcolor{comment}{//Retransmit REGISTER message}
738                error = \hyperlink{mqtt__sn__client__message_8c_a8f404825e3cad7813b703b61aea12bcc}{mqttSnClientSendRegister}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName});
739             \}
740             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a37c9bc96e12d4079199211d7aeda5398}{MQTT\_SN\_MSG\_TYPE\_PUBLISH})
741             \{
742                \textcolor{comment}{//Retransmit PUBLISH message}
743                error = \hyperlink{mqtt__sn__client__message_8c_a7e170c895c48b07088a06135457afbc3}{mqttSnClientSendPublish}(context, publishMsgId,
744                   \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, 
      \hyperlink{mqtt__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain}, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
745             \}
746             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112ac8a07a546f23a523b469944a26de0ab1}{MQTT\_SN\_MSG\_TYPE\_PUBREL})
747             \{
748                \textcolor{comment}{//Retransmit PUBREL message}
749                error = \hyperlink{mqtt__sn__client__message_8c_a8d82c408d62580d958d24e397e05d161}{mqttSnClientSendPubRel}(context, context->msgId);
750             \}
751             \textcolor{keywordflow}{else}
752             \{
753                \textcolor{comment}{//Report an error}
754                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
755             \}
756          \}
757          \textcolor{keywordflow}{else}
758          \{
759             \textcolor{comment}{//Wait for the gateway's reply}
760             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
761          \}
762       \}
763       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
764       \{
765          \textcolor{comment}{//Update MQTT-SN client state}
766          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE};
767 
768          \textcolor{comment}{//Check whether the transmission of the PUBLISH message has started}
769          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a647bc2e2152d672947eb838eccbb233f}{MQTT\_SN\_MSG\_TYPE\_PUBACK} ||
770             context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a92af8cf59403b5ad7e68c136d5af9ce9}{MQTT\_SN\_MSG\_TYPE\_PUBREC} ||
771             context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112ab0101d318c3bdf33f9d0650e80330ec6}{MQTT\_SN\_MSG\_TYPE\_PUBCOMP})
772          \{
773             \textcolor{comment}{//Restore the message identifier that was used to send the first}
774             \textcolor{comment}{//PUBLISH message}
775             \textcolor{keywordflow}{if}(!\hyperlink{mqtt__common_8h_a4e198deb57c49dad652a61d21ad478e6}{dup})
776                publishMsgId = context->msgId;
777          \}
778 
779          \textcolor{comment}{//Check the type of the received message}
780          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112adba83eda8e1643116d68daffce9c9923}{MQTT\_SN\_MSG\_TYPE\_REGACK})
781          \{
782             \textcolor{comment}{//If the registration has not been accepted, the failure reason is}
783             \textcolor{comment}{//encoded in the return code field of the REGACK message}
784             \textcolor{keywordflow}{if}(context->returnCode == \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED})
785             \{
786                \textcolor{comment}{//Save the topic ID assigned by the gateway}
787                error = \hyperlink{mqtt__sn__client__misc_8c_ad237e69506d77f2867af6da6e22e776c}{mqttSnClientAddTopic}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, context->topicId);
788             \}
789             \textcolor{keywordflow}{else}
790             \{
791                \textcolor{comment}{//The registration request has been rejected by the gateway}
792                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac26eec5bbb83dd552d12e20de474b326}{ERROR\_REQUEST\_REJECTED};
793             \}
794          \}
795          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a647bc2e2152d672947eb838eccbb233f}{MQTT\_SN\_MSG\_TYPE\_PUBACK})
796          \{
797             \textcolor{comment}{//If the publish request has not been accepted, the failure reason}
798             \textcolor{comment}{//is encoded in the return code field of the PUBACK message}
799             \textcolor{keywordflow}{if}(context->returnCode == \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED})
800             \{
801                \textcolor{comment}{//Check QoS level}
802                \textcolor{keywordflow}{if}(\hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos} == \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6afcf6709e25108bc27d7f7002a1aeb28e}{MQTT\_SN\_QOS\_LEVEL\_2})
803                \{
804                   \textcolor{comment}{//Unexpected PUBREC message received}
805                   error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafb4f7e4640c9d495bf35ee668d620b17}{ERROR\_UNEXPECTED\_MESSAGE};
806                \}
807                \textcolor{keywordflow}{else}
808                \{
809                   \textcolor{comment}{//A PUBACK message has been received}
810                   \textcolor{keywordflow}{break};
811                \}
812             \}
813             \textcolor{keywordflow}{else}
814             \{
815                \textcolor{comment}{//The publish request has been rejected by the gateway}
816                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac26eec5bbb83dd552d12e20de474b326}{ERROR\_REQUEST\_REJECTED};
817             \}
818          \}
819          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a92af8cf59403b5ad7e68c136d5af9ce9}{MQTT\_SN\_MSG\_TYPE\_PUBREC})
820          \{
821             \textcolor{comment}{//Check QoS level}
822             \textcolor{keywordflow}{if}(\hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos} == \hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6afcf6709e25108bc27d7f7002a1aeb28e}{MQTT\_SN\_QOS\_LEVEL\_2})
823             \{
824                \textcolor{comment}{//A PUBREL packet is the response to a PUBREC packet. It is the}
825                \textcolor{comment}{//third packet of the QoS 2 protocol exchange}
826                error = \hyperlink{mqtt__sn__client__message_8c_a8d82c408d62580d958d24e397e05d161}{mqttSnClientSendPubRel}(context, context->msgId);
827             \}
828             \textcolor{keywordflow}{else}
829             \{
830                \textcolor{comment}{//Unexpected PUBREC message received}
831                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafb4f7e4640c9d495bf35ee668d620b17}{ERROR\_UNEXPECTED\_MESSAGE};
832             \}
833          \}
834          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112ab0101d318c3bdf33f9d0650e80330ec6}{MQTT\_SN\_MSG\_TYPE\_PUBCOMP})
835          \{
836             \textcolor{comment}{//A PUBCOMP message has been received}
837             \textcolor{keywordflow}{break};
838          \}
839          \textcolor{keywordflow}{else}
840          \{
841             \textcolor{comment}{//Report an error}
842             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
843          \}
844       \}
845       \textcolor{keywordflow}{else}
846       \{
847          \textcolor{comment}{//Invalid state}
848          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
849       \}
850    \}
851 
852    \textcolor{comment}{//Return the message identifier that was used to send the PUBLISH message}
853    \textcolor{keywordflow}{if}(\hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId} != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
854       *\hyperlink{mqtt__sn__common_8h_a2acf66d2c12f7b04f90ed704f5ac215c}{msgId} = publishMsgId;
855 
856    \textcolor{comment}{//Return status code}
857    \textcolor{keywordflow}{return} error;
858 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_aff81d84e215962385db1c6115c001045}\label{mqtt__sn__client_8h_aff81d84e215962385db1c6115c001045}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback@{mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback}}
\index{mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback@{mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback()}{mqttSnClientRegisterDtlsInitCallback()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Register\+Dtls\+Init\+Callback (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{mqtt__sn__client_8h_a0aa65bd0e127e05595c247c01aeca2d5}{Mqtt\+Sn\+Client\+Dtls\+Init\+Callback}}]{callback }\end{DoxyParamCaption})}



Register D\+T\+LS initialization callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em callback} & D\+T\+LS initialization callback function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 122 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
124 \{
125    \textcolor{comment}{//Check parameters}
126    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || callback == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
127       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
128 
129    \textcolor{comment}{//Save callback function}
130    context->dtlsInitCallback = callback;
131 
132    \textcolor{comment}{//Successful processing}
133    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
134 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a1f3bc6a6708eb792cd8f9a6e24c26889}\label{mqtt__sn__client_8h_a1f3bc6a6708eb792cd8f9a6e24c26889}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Register\+Publish\+Callback@{mqtt\+Sn\+Client\+Register\+Publish\+Callback}}
\index{mqtt\+Sn\+Client\+Register\+Publish\+Callback@{mqtt\+Sn\+Client\+Register\+Publish\+Callback}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Register\+Publish\+Callback()}{mqttSnClientRegisterPublishCallback()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Register\+Publish\+Callback (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{mqtt__sn__client_8h_a4f0890f5b533cda2ad972b1e433cf109}{Mqtt\+Sn\+Client\+Publish\+Callback}}]{callback }\end{DoxyParamCaption})}



Register publish callback function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em callback} & Callback function to be called when a P\+U\+B\+L\+I\+SH message is received \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 147 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
149 \{
150    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
151    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
152       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
153 
154    \textcolor{comment}{//Save callback function}
155    context->publishCallback = callback;
156 
157    \textcolor{comment}{//Successful processing}
158    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
159 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a4c65943f9e4596eac884440fe3ccb23b}\label{mqtt__sn__client_8h_a4c65943f9e4596eac884440fe3ccb23b}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Search\+Gateway@{mqtt\+Sn\+Client\+Search\+Gateway}}
\index{mqtt\+Sn\+Client\+Search\+Gateway@{mqtt\+Sn\+Client\+Search\+Gateway}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Search\+Gateway()}{mqttSnClientSearchGateway()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Search\+Gateway (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$}]{dest\+Ip\+Addr,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{dest\+Port }\end{DoxyParamCaption})}



Search for a gateway. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em dest\+Ip\+Addr} & Destination IP address \\
\hline
\mbox{\tt in}  & {\em dest\+Port} & Destination port number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 366 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
368 \{
369    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
370    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
371 
372    \textcolor{comment}{//Check parameters}
373    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || destIpAddr == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
374       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
375 
376    \textcolor{comment}{//Initialize status code}
377    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
378 
379    \textcolor{comment}{//Gateway discovery procedure}
380    \textcolor{keywordflow}{while}(!error)
381    \{
382       \textcolor{comment}{//Get current time}
383       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
384 
385       \textcolor{comment}{//Check current state}
386       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED})
387       \{
388          \textcolor{comment}{//Open network connection}
389          error = \hyperlink{mqtt__sn__client__transport_8c_a12bb832d0d0ab19156caf80131ed7f64}{mqttSnClientOpenConnection}(context, 
      \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
390 
391          \textcolor{comment}{//Check status code}
392          \textcolor{keywordflow}{if}(!error)
393          \{
394             \textcolor{comment}{//Save current time}
395             context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
396             context->retransmitStartTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
397 
398             \textcolor{comment}{//To prevent broadcast storms when multiple clients start searching}
399             \textcolor{comment}{//for GW almost at the same time, the sending of the SEARCHGW message}
400             \textcolor{comment}{//is delayed by a random time between 0 and TSEARCHGW}
401             context->retransmitTimeout = \hyperlink{net_8c_af45ea0afc9806749114ec85e507014e1}{netGetRandRange}(0,
402                \hyperlink{mqtt__sn__client_8h_a7d9c6d732aae16efd9db028f3ecfa2d1}{MQTT\_SN\_CLIENT\_SEARCH\_DELAY});
403 
404             \textcolor{comment}{//Start searching for gateways}
405             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a467b75c7773b826b5bd91423b6bd91fc}{MQTT\_SN\_CLIENT\_STATE\_SEARCHING};
406          \}
407       \}
408       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a467b75c7773b826b5bd91423b6bd91fc}{MQTT\_SN\_CLIENT\_STATE\_SEARCHING})
409       \{
410          \textcolor{comment}{//Check whether the timeout has elapsed}
411          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
412          \{
413             \textcolor{comment}{//Abort the retransmission procedure}
414             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
415          \}
416          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
417             context->retransmitTimeout) >= 0)
418          \{
419             \textcolor{comment}{//Set retransmission timeout}
420             context->retransmitTimeout = \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT};
421 
422             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
423             \textcolor{comment}{//is not received, the client retransmits the message}
424             error = \hyperlink{mqtt__sn__client__message_8c_a38ca7260c1fbba0dabcb84d4bb5a2528}{mqttSnClientSendSearchGw}(context, 0, destIpAddr, 
      \hyperlink{tcp_8h_af15d713ad2bc92686abfa6ab012b5039}{destPort});
425          \}
426          \textcolor{keywordflow}{else}
427          \{
428             \textcolor{comment}{//Wait for the gateway's reply}
429             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
430          \}
431       \}
432       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
433       \{
434          \textcolor{comment}{//Check the type of the received message}
435          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a30bbcb61a716198dc41655b74be7d442}{MQTT\_SN\_MSG\_TYPE\_GWINFO})
436          \{
437             \textcolor{comment}{//Close network connection}
438             \hyperlink{mqtt__sn__client__transport_8c_a0ceab50877bbe9943ae16592f4f243a0}{mqttSnClientCloseConnection}(context);
439 
440             \textcolor{comment}{//A MQTT-SN gateway has been found}
441             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED};
442             \textcolor{keywordflow}{break};
443          \}
444          \textcolor{keywordflow}{else}
445          \{
446             \textcolor{comment}{//Report an error}
447             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
448          \}
449       \}
450       \textcolor{keywordflow}{else}
451       \{
452          \textcolor{comment}{//Invalid state}
453          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac3190fa1f36c6acf147c7ce453a655e2}{ERROR\_WRONG\_STATE};
454       \}
455    \}
456 
457    \textcolor{comment}{//Any error to report?}
458    \textcolor{keywordflow}{if}(error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR} && error != \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca16f356a669fbb42deb27f59e9054f6d6}{ERROR\_WOULD\_BLOCK})
459    \{
460       \textcolor{comment}{//Clean up side effects}
461       \hyperlink{mqtt__sn__client__transport_8c_a0ceab50877bbe9943ae16592f4f243a0}{mqttSnClientCloseConnection}(context);
462       \textcolor{comment}{//Update MQTT-SN client state}
463       context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a7a7a01456f26f19df212e55de7e6a279}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTED};
464    \}
465 
466    \textcolor{comment}{//Return status code}
467    \textcolor{keywordflow}{return} error;
468 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a3fe66b7dfc48851293112308f586fb7a}\label{mqtt__sn__client_8h_a3fe66b7dfc48851293112308f586fb7a}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Gateway@{mqtt\+Sn\+Client\+Set\+Gateway}}
\index{mqtt\+Sn\+Client\+Set\+Gateway@{mqtt\+Sn\+Client\+Set\+Gateway}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Gateway()}{mqttSnClientSetGateway()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Gateway (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{structIpAddr}{Ip\+Addr} $\ast$}]{gw\+Ip\+Addr,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t}}]{gw\+Port }\end{DoxyParamCaption})}



Specify the address of the gateway. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em gw\+Ip\+Addr} & Gateway IP address \\
\hline
\mbox{\tt in}  & {\em gw\+Port} & Gateway port number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 342 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
344 \{
345    \textcolor{comment}{//Check parameters}
346    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || gwIpAddr == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
347       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
348 
349    \textcolor{comment}{//Save the IP address and the port number of the MQTT-SN gateway}
350    context->gwIpAddr = *gwIpAddr;
351    context->gwPort = gwPort;
352 
353    \textcolor{comment}{//Successful processing}
354    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
355 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a51eb676e894403e88439cc1976c82802}\label{mqtt__sn__client_8h_a51eb676e894403e88439cc1976c82802}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Identifier@{mqtt\+Sn\+Client\+Set\+Identifier}}
\index{mqtt\+Sn\+Client\+Set\+Identifier@{mqtt\+Sn\+Client\+Set\+Identifier}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Identifier()}{mqttSnClientSetIdentifier()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Identifier (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{client\+Id }\end{DoxyParamCaption})}



Set client identifier. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em client\+Id} & N\+U\+L\+L-\/terminated string containing the client identifier \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 239 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
241 \{
242    \textcolor{comment}{//Check parameters}
243    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{mqtt__sn__common_8h_aaaf873d7efb58d9ccdddc5c8569e092b}{clientId} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
244       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
245 
246    \textcolor{comment}{//Make sure the length of the client identifier is acceptable}
247    \textcolor{keywordflow}{if}(strlen(\hyperlink{mqtt__sn__common_8h_aaaf873d7efb58d9ccdddc5c8569e092b}{clientId}) > \hyperlink{mqtt__sn__client_8h_a8903ddd9dd0e6d56d19a16aa63381389}{MQTT\_SN\_CLIENT\_MAX\_ID\_LEN})
248       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
249 
250    \textcolor{comment}{//Save client identifier}
251    strcpy(context->clientId, \hyperlink{mqtt__sn__common_8h_aaaf873d7efb58d9ccdddc5c8569e092b}{clientId});
252 
253    \textcolor{comment}{//Successful processing}
254    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
255 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_af05eeb02d6c5f83b991a61eca89290bc}\label{mqtt__sn__client_8h_af05eeb02d6c5f83b991a61eca89290bc}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Keep\+Alive@{mqtt\+Sn\+Client\+Set\+Keep\+Alive}}
\index{mqtt\+Sn\+Client\+Set\+Keep\+Alive@{mqtt\+Sn\+Client\+Set\+Keep\+Alive}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Keep\+Alive()}{mqttSnClientSetKeepAlive()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Keep\+Alive (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{keep\+Alive }\end{DoxyParamCaption})}



Set keep-\/alive value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em keep\+Alive} & Keep-\/alive interval, in milliseconds \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 218 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
219 \{
220    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
221    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
222       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
223 
224    \textcolor{comment}{//Save keep-alive value}
225    context->keepAlive = keepAlive;
226 
227    \textcolor{comment}{//Successful processing}
228    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
229 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a2e810dc2d1fe353e4a5d52496827b24d}\label{mqtt__sn__client_8h_a2e810dc2d1fe353e4a5d52496827b24d}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Predefined\+Topics@{mqtt\+Sn\+Client\+Set\+Predefined\+Topics}}
\index{mqtt\+Sn\+Client\+Set\+Predefined\+Topics@{mqtt\+Sn\+Client\+Set\+Predefined\+Topics}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Predefined\+Topics()}{mqttSnClientSetPredefinedTopics()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Predefined\+Topics (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{structMqttSnPredefinedTopic}{Mqtt\+Sn\+Predefined\+Topic} $\ast$}]{predefined\+Topics,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{size }\end{DoxyParamCaption})}



Set the list of predefined topics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em predefined\+Topics} & List of predefined topics \\
\hline
\mbox{\tt in}  & {\em size} & Number of predefined topics \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 170 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
172 \{
173    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
174    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
175       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
176 
177    \textcolor{comment}{//Check parameters}
178    \textcolor{keywordflow}{if}(predefinedTopics == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && size != 0)
179       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
180 
181    \textcolor{comment}{//Save the list of predefined topics}
182    context->predefinedTopicTable = predefinedTopics;
183    context->predefinedTopicTableSize = size;
184 
185    \textcolor{comment}{//Successful processing}
186    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
187 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a43bcead45f89f895a7c270438dabb827}\label{mqtt__sn__client_8h_a43bcead45f89f895a7c270438dabb827}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Timeout@{mqtt\+Sn\+Client\+Set\+Timeout}}
\index{mqtt\+Sn\+Client\+Set\+Timeout@{mqtt\+Sn\+Client\+Set\+Timeout}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Timeout()}{mqttSnClientSetTimeout()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Timeout (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{timeout }\end{DoxyParamCaption})}



Set communication timeout. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em timeout} & Timeout value, in milliseconds \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 197 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
198 \{
199    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
200    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
201       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
202 
203    \textcolor{comment}{//Save timeout value}
204    context->timeout = timeout;
205 
206    \textcolor{comment}{//Successful processing}
207    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
208 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_af9957d5739a5ef313e284153eb4346ba}\label{mqtt__sn__client_8h_af9957d5739a5ef313e284153eb4346ba}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Transport\+Protocol@{mqtt\+Sn\+Client\+Set\+Transport\+Protocol}}
\index{mqtt\+Sn\+Client\+Set\+Transport\+Protocol@{mqtt\+Sn\+Client\+Set\+Transport\+Protocol}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Transport\+Protocol()}{mqttSnClientSetTransportProtocol()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Transport\+Protocol (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{mqtt__sn__common_8h_a253f39a8dfbcfb9062c71a05947121eb}{Mqtt\+Sn\+Transport\+Protocol}}]{transport\+Protocol }\end{DoxyParamCaption})}



Set the transport protocol to be used. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em transport\+Protocol} & Transport protocol to be used (U\+DP or D\+T\+LS) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 98 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
100 \{
101    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
102    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
103       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
104 
105    \textcolor{comment}{//Save the transport protocol to be used}
106    context->transportProtocol = transportProtocol;
107 
108    \textcolor{comment}{//Successful processing}
109    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
110 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a2285b0286073e10be3c6b6535da9ff72}\label{mqtt__sn__client_8h_a2285b0286073e10be3c6b6535da9ff72}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Set\+Will\+Message@{mqtt\+Sn\+Client\+Set\+Will\+Message}}
\index{mqtt\+Sn\+Client\+Set\+Will\+Message@{mqtt\+Sn\+Client\+Set\+Will\+Message}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Set\+Will\+Message()}{mqttSnClientSetWillMessage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Set\+Will\+Message (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic,  }\item[{const void $\ast$}]{message,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level}}]{qos,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{retain }\end{DoxyParamCaption})}



Specify the Will message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic} & Will topic name \\
\hline
\mbox{\tt in}  & {\em message} & Will message \\
\hline
\mbox{\tt in}  & {\em length} & Length of the Will message \\
\hline
\mbox{\tt in}  & {\em qos} & QoS level to be used when publishing the Will message \\
\hline
\mbox{\tt in}  & {\em retain} & This flag specifies if the Will message is to be retained \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 269 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
272 \{
273    \textcolor{comment}{//Check parameters}
274    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || topic == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
275       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
276 
277    \textcolor{comment}{//Make sure the length of the Will topic is acceptable}
278    \textcolor{keywordflow}{if}(strlen(topic) > \hyperlink{mqtt__sn__client_8h_ae418ee87e6d47c1cfdb4e7a5694a2caa}{MQTT\_SN\_CLIENT\_MAX\_WILL\_TOPIC\_LEN})
279       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
280 
281    \textcolor{comment}{//Save Will topic}
282    strcpy(context->willMessage.topic, topic);
283 
284    \textcolor{comment}{//Any message payload}
285    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
286    \{
287       \textcolor{comment}{//Sanity check}
288       \textcolor{keywordflow}{if}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
289          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
290 
291       \textcolor{comment}{//Make sure the length of the Will message payload is acceptable}
292       \textcolor{keywordflow}{if}(strlen(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}) > \hyperlink{mqtt__sn__client_8h_a1059cb0e47f7c47d79ca58c5f29c6126}{MQTT\_SN\_CLIENT\_MAX\_WILL\_PAYLOAD\_LEN})
293          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
294 
295       \textcolor{comment}{//Save Will message payload}
296       memcpy(context->willMessage.payload, \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
297    \}
298 
299    \textcolor{comment}{//Length of the Will message payload}
300    context->willMessage.length = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
301 
302    \textcolor{comment}{//QoS level to be used when publishing the Will message}
303    context->willMessage.flags.qos = \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos};
304    \textcolor{comment}{//This flag specifies if the Will message is to be retained}
305    context->willMessage.flags.retain = \hyperlink{mqtt__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain};
306 
307    \textcolor{comment}{//Successful processing}
308    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
309 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a833f4757a82301f7c5d1fef6d8c82e5d}\label{mqtt__sn__client_8h_a833f4757a82301f7c5d1fef6d8c82e5d}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Subscribe@{mqtt\+Sn\+Client\+Subscribe}}
\index{mqtt\+Sn\+Client\+Subscribe@{mqtt\+Sn\+Client\+Subscribe}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Subscribe()}{mqttSnClientSubscribe()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Subscribe (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name,  }\item[{\hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level}}]{qos }\end{DoxyParamCaption})}



Subscribe to topic. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Topic filter \\
\hline
\mbox{\tt in}  & {\em qos} & Maximum QoS level at which the server can send application messages to the client \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 870 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
872 \{
873    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
874    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
875 
876    \textcolor{comment}{//Check parameters}
877    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
878       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
879 
880    \textcolor{comment}{//Initialize status code}
881    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
882 
883    \textcolor{comment}{//Topic subscribe procedure}
884    \textcolor{keywordflow}{while}(!error)
885    \{
886       \textcolor{comment}{//Get current time}
887       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
888 
889       \textcolor{comment}{//Check current state}
890       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
891       \{
892          \textcolor{comment}{//The message identifier allows the sender to match a message with}
893          \textcolor{comment}{//its corresponding acknowledgment}
894          \hyperlink{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}{mqttSnClientGenerateMessageId}(context);
895 
896          \textcolor{comment}{//Save current time}
897          context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
898 
899          \textcolor{comment}{//Send SUBSCRIBE message}
900          error = \hyperlink{mqtt__sn__client__message_8c_aee1ec88500c030f48a42bcf86f13b8d8}{mqttSnClientSendSubscribe}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos});
901       \}
902       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
903       \{
904          \textcolor{comment}{//Check whether the timeout has elapsed}
905          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
906          \{
907             \textcolor{comment}{//Abort the retransmission procedure}
908             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING};
909             \textcolor{comment}{//Report a timeout error}
910             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
911          \}
912          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
913             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
914          \{
915             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
916             \textcolor{comment}{//is not received, the client retransmits the message}
917             error = \hyperlink{mqtt__sn__client__message_8c_aee1ec88500c030f48a42bcf86f13b8d8}{mqttSnClientSendSubscribe}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos});
918          \}
919          \textcolor{keywordflow}{else}
920          \{
921             \textcolor{comment}{//Wait for the gateway's reply}
922             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
923          \}
924       \}
925       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
926       \{
927          \textcolor{comment}{//Update MQTT-SN client state}
928          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE};
929 
930          \textcolor{comment}{//Check the type of the received message}
931          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a10da2a99ac13fe51103649cdda53b89c}{MQTT\_SN\_MSG\_TYPE\_SUBACK})
932          \{
933             \textcolor{comment}{//If the subscribe request has not been accepted, the failure reason}
934             \textcolor{comment}{//is encoded in the return code field of the SUBACK message}
935             \textcolor{keywordflow}{if}(context->returnCode == \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED})
936             \{
937                \textcolor{comment}{//The topic ID field is not relevant in case of subscriptions to a}
938                \textcolor{comment}{//topic name which contains wildcard characters}
939                \textcolor{keywordflow}{if}(strchr(\hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \textcolor{charliteral}{'#'}) == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && strchr(
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, \textcolor{charliteral}{'+'}) == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
940                \{
941                   \textcolor{comment}{//Save the topic ID assigned by the gateway}
942                   error = \hyperlink{mqtt__sn__client__misc_8c_ad237e69506d77f2867af6da6e22e776c}{mqttSnClientAddTopic}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName}, context->topicId);
943                \}
944 
945                \textcolor{comment}{//A SUBACK message has been received}
946                \textcolor{keywordflow}{break};
947             \}
948             \textcolor{keywordflow}{else}
949             \{
950                \textcolor{comment}{//The subscribe request has been rejected by the gateway}
951                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac26eec5bbb83dd552d12e20de474b326}{ERROR\_REQUEST\_REJECTED};
952             \}
953          \}
954          \textcolor{keywordflow}{else}
955          \{
956             \textcolor{comment}{//Report an error}
957             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
958          \}
959       \}
960       \textcolor{keywordflow}{else}
961       \{
962          \textcolor{comment}{//Invalid state}
963          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
964       \}
965    \}
966 
967    \textcolor{comment}{//Return status code}
968    \textcolor{keywordflow}{return} error;
969 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_aaa8d5dec9766a744b8c4a95d0d04824c}\label{mqtt__sn__client_8h_aaa8d5dec9766a744b8c4a95d0d04824c}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Task@{mqtt\+Sn\+Client\+Task}}
\index{mqtt\+Sn\+Client\+Task@{mqtt\+Sn\+Client\+Task}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Task()}{mqttSnClientTask()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Task (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{\hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\+\_\+t}}]{timeout }\end{DoxyParamCaption})}



Process M\+Q\+T\+T-\/\+SN client events. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em timeout} & Maximum time to wait before returning \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1336 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
1337 \{
1338    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1339 
1340    \textcolor{comment}{//Make sure the MQTT-SN client context is valid}
1341    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1342       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1343 
1344    \textcolor{comment}{//Make sure the MQTT-SN client is connected}
1345    \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE} ||
1346       context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ} ||
1347       context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
1348    \{
1349       \textcolor{comment}{//Process MQTT-SN client events}
1350       error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, timeout);
1351    \}
1352    \textcolor{keywordflow}{else}
1353    \{
1354       \textcolor{comment}{//Invalid state}
1355       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
1356    \}
1357 
1358    \textcolor{comment}{//Return status code}
1359    \textcolor{keywordflow}{return} error;
1360 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_a8327da75540613194c3cb1fa5b99d2db}\label{mqtt__sn__client_8h_a8327da75540613194c3cb1fa5b99d2db}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Unsubscribe@{mqtt\+Sn\+Client\+Unsubscribe}}
\index{mqtt\+Sn\+Client\+Unsubscribe@{mqtt\+Sn\+Client\+Unsubscribe}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Unsubscribe()}{mqttSnClientUnsubscribe()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Unsubscribe (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic\+Name }\end{DoxyParamCaption})}



Unsubscribe from topic. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic\+Name} & Topic filter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 979 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
981 \{
982    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
983    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
984 
985    \textcolor{comment}{//Check parameters}
986    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
987       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
988 
989    \textcolor{comment}{//Initialize status code}
990    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
991 
992    \textcolor{comment}{//Topic unsubscribe procedure}
993    \textcolor{keywordflow}{while}(!error)
994    \{
995       \textcolor{comment}{//Get current time}
996       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
997 
998       \textcolor{comment}{//Check current state}
999       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
1000       \{
1001          \textcolor{comment}{//The message identifier allows the sender to match a message with}
1002          \textcolor{comment}{//its corresponding acknowledgment}
1003          \hyperlink{mqtt__sn__client__misc_8c_ad7d4f291071e0c89836ebd3ab12ca3e6}{mqttSnClientGenerateMessageId}(context);
1004 
1005          \textcolor{comment}{//Save current time}
1006          context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1007 
1008          \textcolor{comment}{//Send UNSUBSCRIBE message}
1009          error = \hyperlink{mqtt__sn__client__message_8c_abe5f55aaad9e4731caa9a813b41adc5b}{mqttSnClientSendUnsubscribe}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName});
1010       \}
1011       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
1012       \{
1013          \textcolor{comment}{//Check whether the timeout has elapsed}
1014          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
1015          \{
1016             \textcolor{comment}{//Abort the retransmission procedure}
1017             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING};
1018             \textcolor{comment}{//Report a timeout error}
1019             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
1020          \}
1021          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
1022             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
1023          \{
1024             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
1025             \textcolor{comment}{//is not received, the client retransmits the message}
1026             error = \hyperlink{mqtt__sn__client__message_8c_abe5f55aaad9e4731caa9a813b41adc5b}{mqttSnClientSendUnsubscribe}(context, 
      \hyperlink{mqtt__sn__common_8h_a12172589bd20ef38ecbc6f4faf6ae3d0}{topicName});
1027          \}
1028          \textcolor{keywordflow}{else}
1029          \{
1030             \textcolor{comment}{//Wait for the gateway's reply}
1031             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
1032          \}
1033       \}
1034       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
1035       \{
1036          \textcolor{comment}{//Update MQTT-SN client state}
1037          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE};
1038 
1039          \textcolor{comment}{//Check the type of the received message}
1040          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a248ff43605e58a25ff0f2f1ebb22e376}{MQTT\_SN\_MSG\_TYPE\_UNSUBACK})
1041          \{
1042             \textcolor{comment}{//An UNSUBACK message has been received}
1043             \textcolor{keywordflow}{break};
1044          \}
1045          \textcolor{keywordflow}{else}
1046          \{
1047             \textcolor{comment}{//Report an error}
1048             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
1049          \}
1050       \}
1051       \textcolor{keywordflow}{else}
1052       \{
1053          \textcolor{comment}{//Invalid state}
1054          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
1055       \}
1056    \}
1057 
1058    \textcolor{comment}{//Return status code}
1059    \textcolor{keywordflow}{return} error;
1060 \}
\end{DoxyCode}
\mbox{\Hypertarget{mqtt__sn__client_8h_afa4d08df03fe1345764e5f08eb2d7434}\label{mqtt__sn__client_8h_afa4d08df03fe1345764e5f08eb2d7434}} 
\index{mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}!mqtt\+Sn\+Client\+Update\+Will\+Message@{mqtt\+Sn\+Client\+Update\+Will\+Message}}
\index{mqtt\+Sn\+Client\+Update\+Will\+Message@{mqtt\+Sn\+Client\+Update\+Will\+Message}!mqtt\+\_\+sn\+\_\+client.\+h@{mqtt\+\_\+sn\+\_\+client.\+h}}
\subsubsection{\texorpdfstring{mqtt\+Sn\+Client\+Update\+Will\+Message()}{mqttSnClientUpdateWillMessage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} mqtt\+Sn\+Client\+Update\+Will\+Message (\begin{DoxyParamCaption}\item[{\hyperlink{mqtt__sn__client_8h_aee99129ffa9bde57fd8b742f576ae3f5}{Mqtt\+Sn\+Client\+Context} $\ast$}]{context,  }\item[{const \hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\+\_\+t} $\ast$}]{topic,  }\item[{const void $\ast$}]{message,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{mqtt__sn__common_8h_a5037c476df69550c4f714d27359d38a6}{Mqtt\+Sn\+Qos\+Level}}]{qos,  }\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{retain }\end{DoxyParamCaption})}



Update the Will message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the M\+Q\+T\+T-\/\+SN client context \\
\hline
\mbox{\tt in}  & {\em topic} & Will topic name \\
\hline
\mbox{\tt in}  & {\em message} & Will message \\
\hline
\mbox{\tt in}  & {\em length} & Length of the Will message \\
\hline
\mbox{\tt in}  & {\em qos} & QoS level to be used when publishing the Will message \\
\hline
\mbox{\tt in}  & {\em retain} & This flag specifies if the Will message is to be retained \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1167 of file mqtt\+\_\+sn\+\_\+client.\+c.


\begin{DoxyCode}
1170 \{
1171    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1172    \hyperlink{compiler__port_8h_ae3e32a98d431a02106616da3071832dd}{systime\_t} \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1173 
1174    \textcolor{comment}{//Check parameters}
1175    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} || topic == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
1176       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1177    \textcolor{keywordflow}{if}(\hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message} == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} && \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} != 0)
1178       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8}{ERROR\_INVALID\_PARAMETER};
1179 
1180    \textcolor{comment}{//Initialize status code}
1181    error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1182 
1183    \textcolor{comment}{//Publish procedure}
1184    \textcolor{keywordflow}{while}(!error)
1185    \{
1186       \textcolor{comment}{//Get current time}
1187       time = \hyperlink{os__port__chibios_8c_ab66a11272d40a916fa69dd8e4dc443d4}{osGetSystemTime}();
1188 
1189       \textcolor{comment}{//Check current state}
1190       \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE})
1191       \{
1192          \textcolor{comment}{//Update the Will message}
1193          error = \hyperlink{mqtt__sn__client_8c_a2285b0286073e10be3c6b6535da9ff72}{mqttSnClientSetWillMessage}(context, topic, 
      \hyperlink{chap_8h_a52f19d36a71e9b8ddea38fe00c291181}{message}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
1194             \hyperlink{mqtt__common_8h_a65ee2b4b16f25052c441ff9959dcc7e7}{qos}, \hyperlink{mqtt__common_8h_ae25d47ab22bd975ad97012eddb6bbfce}{retain});
1195 
1196          \textcolor{comment}{//Check status code}
1197          \textcolor{keywordflow}{if}(!error)
1198          \{
1199             \textcolor{comment}{//Save current time}
1200             context->startTime = \hyperlink{dhcpv6__common_8h_ae73654f333e4363463ad8c594eca1905}{time};
1201 
1202             \textcolor{comment}{//Send WILLTOPICUPD message}
1203             error = \hyperlink{mqtt__sn__client__message_8c_afe5e9dfec2ae9dba6dfabdcb17402d3f}{mqttSnClientSendWillTopicUpd}(context);
1204          \}
1205       \}
1206       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071af7aeb72fac83c3e235aa59543c1da1bf}{MQTT\_SN\_CLIENT\_STATE\_SENDING\_REQ})
1207       \{
1208          \textcolor{comment}{//Check whether the timeout has elapsed}
1209          \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->startTime + context->timeout) >= 0)
1210          \{
1211             \textcolor{comment}{//Abort the retransmission procedure}
1212             context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9d08c1be6a78b37a6f433f52bf0e0092}{MQTT\_SN\_CLIENT\_STATE\_DISCONNECTING};
1213             \textcolor{comment}{//Report a timeout error}
1214             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca4d0f7be53b837f004379ac6bbd56f1e2}{ERROR\_TIMEOUT};
1215          \}
1216          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{os__port_8h_a25c13833ef003da02045a91b1080263a}{timeCompare}(time, context->retransmitStartTime +
1217             \hyperlink{mqtt__sn__client_8h_a10713a56afd89bbb09197fbfc0dce2f3}{MQTT\_SN\_CLIENT\_RETRY\_TIMEOUT}) >= 0)
1218          \{
1219             \textcolor{comment}{//If the retry timer times out and the expected gateway's reply}
1220             \textcolor{comment}{//is not received, the client retransmits the message}
1221             \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a38e7a463c018cbcd3de053913515e5db}{MQTT\_SN\_MSG\_TYPE\_WILLTOPICUPD})
1222             \{
1223                \textcolor{comment}{//Retransmit WILLTOPICUPD message}
1224                error = \hyperlink{mqtt__sn__client__message_8c_afe5e9dfec2ae9dba6dfabdcb17402d3f}{mqttSnClientSendWillTopicUpd}(context);
1225             \}
1226             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a8aa84d8100f3ef131d29575c38165bac}{MQTT\_SN\_MSG\_TYPE\_WILLMSGUPD})
1227             \{
1228                \textcolor{comment}{//Retransmit WILLMSGUPD message}
1229                error = \hyperlink{mqtt__sn__client__message_8c_a32f7fa8e90f1dd58ca2ed8a83988e3b6}{mqttSnClientSendWillMsgUpd}(context);
1230             \}
1231             \textcolor{keywordflow}{else}
1232             \{
1233                \textcolor{comment}{//Report an error}
1234                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
1235             \}
1236          \}
1237          \textcolor{keywordflow}{else}
1238          \{
1239             \textcolor{comment}{//Wait for the gateway's reply}
1240             error = \hyperlink{mqtt__sn__client__misc_8c_a2b478f231c1e91f5f58213c5b1eca3cb}{mqttSnClientProcessEvents}(context, 
      \hyperlink{mqtt__sn__client_8h_ab94d2a16c5ce1ba408582901edd630c8}{MQTT\_SN\_CLIENT\_TICK\_INTERVAL});
1241          \}
1242       \}
1243       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->state == \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a9512423d440e0143284ff3e4ffaf2013}{MQTT\_SN\_CLIENT\_STATE\_RESP\_RECEIVED})
1244       \{
1245          \textcolor{comment}{//Update MQTT-SN client state}
1246          context->state = \hyperlink{mqtt__sn__client_8h_ac2c5b1752aff9aadfd267c2a11535071a5f379a957d11d1178d53e2b176ec8a30}{MQTT\_SN\_CLIENT\_STATE\_ACTIVE};
1247 
1248          \textcolor{comment}{//Check the type of the received message}
1249          \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a0a7130c585f58603d4ff5e5c76c721c4}{MQTT\_SN\_MSG\_TYPE\_WILLTOPICRESP})
1250          \{
1251             \textcolor{comment}{//If the WILLTOPICUPD has not been accepted, the failure reason}
1252             \textcolor{comment}{//is encoded in the return code field of the WILLTOPICRESP}
1253             \textcolor{keywordflow}{if}(context->returnCode == \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED})
1254             \{
1255                \textcolor{comment}{//Valid Will topic?}
1256                \textcolor{keywordflow}{if}(context->willMessage.topic[0] != \textcolor{charliteral}{'\(\backslash\)0'})
1257                \{
1258                   \textcolor{comment}{//Send WILLMSGUPD message}
1259                   error = \hyperlink{mqtt__sn__client__message_8c_a32f7fa8e90f1dd58ca2ed8a83988e3b6}{mqttSnClientSendWillMsgUpd}(context);
1260                \}
1261                \textcolor{keywordflow}{else}
1262                \{
1263                   \textcolor{comment}{//An empty WILLTOPIC message is used by a client to delete}
1264                   \textcolor{comment}{//the Will topic and the Will message stored in the server}
1265                   \textcolor{keywordflow}{break};
1266                \}
1267             \}
1268             \textcolor{keywordflow}{else}
1269             \{
1270                \textcolor{comment}{//The WILLTOPICUPD request has been rejected by the gateway}
1271                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac26eec5bbb83dd552d12e20de474b326}{ERROR\_REQUEST\_REJECTED};
1272             \}
1273          \}
1274          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(context->msgType == \hyperlink{mqtt__sn__common_8h_a0b5ccdae8aa73dc7c74ae2dfe62fd112a9765d8cdab39800ffcc84b85eb634da3}{MQTT\_SN\_MSG\_TYPE\_WILLMSGRESP})
1275          \{
1276             \textcolor{comment}{//If the WILLMSGUPD has not been accepted, the failure reason}
1277             \textcolor{comment}{//is encoded in the return code field of the WILLMSGRESP}
1278             \textcolor{keywordflow}{if}(context->returnCode == \hyperlink{mqtt__sn__common_8h_aa8ae09a48836472262f42c1f09638e9ca09797026d22073f75af1a2012739a89a}{MQTT\_SN\_RETURN\_CODE\_ACCEPTED})
1279             \{
1280                \textcolor{comment}{//The WILLMSGUPD request has been accepted by the gateway}
1281                \textcolor{keywordflow}{break};
1282             \}
1283             \textcolor{keywordflow}{else}
1284             \{
1285                \textcolor{comment}{//The WILLMSGUPD request has been rejected by the gateway}
1286                error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac26eec5bbb83dd552d12e20de474b326}{ERROR\_REQUEST\_REJECTED};
1287             \}
1288          \}
1289          \textcolor{keywordflow}{else}
1290          \{
1291             \textcolor{comment}{//Report an error}
1292             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689caa71f5ec9e991d033d622bd5fb6f6633f}{ERROR\_UNEXPECTED\_RESPONSE};
1293          \}
1294       \}
1295       \textcolor{keywordflow}{else}
1296       \{
1297          \textcolor{comment}{//Invalid state}
1298          error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca8cf62de6117b9a4c1537d1ce96c219a8}{ERROR\_NOT\_CONNECTED};
1299       \}
1300    \}
1301 
1302    \textcolor{comment}{//Return status code}
1303    \textcolor{keywordflow}{return} error;
1304 \}
\end{DoxyCode}
