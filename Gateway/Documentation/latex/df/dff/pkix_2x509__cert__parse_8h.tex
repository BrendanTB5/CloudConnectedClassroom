\hypertarget{pkix_2x509__cert__parse_8h}{}\section{cyclone\+\_\+crypto/pkix/x509\+\_\+cert\+\_\+parse.h File Reference}
\label{pkix_2x509__cert__parse_8h}\index{cyclone\+\_\+crypto/pkix/x509\+\_\+cert\+\_\+parse.\+h@{cyclone\+\_\+crypto/pkix/x509\+\_\+cert\+\_\+parse.\+h}}
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkix/x509\+\_\+common.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a0c8997b0f608c1fee25bdd281e7c4acb}{x509\+Parse\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$cert\+Info)
\begin{DoxyCompactList}\small\item\em Parse a X.\+509 certificate. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a7a0742ff1b43f4cbf588b0d55f8adf33}{x509\+Parse\+Tbs\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509TbsCertificate}{X509\+Tbs\+Certificate} $\ast$tbs\+Cert)
\begin{DoxyCompactList}\small\item\em Parse T\+B\+S\+Certificate structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a6bb8c9cd7914a755f55796fb888aa2df}{x509\+Parse\+Version} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$\hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Parse Version field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a936f23f5633f2c2c9c767d27f2196f26}{x509\+Parse\+Serial\+Number} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SerialNumber}{X509\+Serial\+Number} $\ast$serial\+Number)
\begin{DoxyCompactList}\small\item\em Parse Serial\+Number field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a91dc365cee54dd84e0e926317b7a1cea}{x509\+Parse\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Name}{X509\+Name} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name})
\begin{DoxyCompactList}\small\item\em Parse Name structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_ac2fda2111b747d8e392ac9676b607125}{x509\+Parse\+Name\+Attribute} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509NameAttribute}{X509\+Name\+Attribute} $\ast$name\+Attribute)
\begin{DoxyCompactList}\small\item\em Parse name attribute. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a13716132dba34d3a3fb8321d1355c6d1}{x509\+Parse\+Validity} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Validity}{X509\+Validity} $\ast$validity)
\begin{DoxyCompactList}\small\item\em Parse Validity structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_ae0100508f7e094fffc624414f40f932e}{x509\+Parse\+Time} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structDateTime}{Date\+Time} $\ast$date\+Time)
\begin{DoxyCompactList}\small\item\em Parse U\+T\+C\+Time or Generalized\+Time field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a16087bad69c48b98cbba8ead2d56c5cd}{x509\+Parse\+Issuer\+Unique\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length)
\begin{DoxyCompactList}\small\item\em Parse Issuer\+Unique\+ID structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a417813688cad9149a37f2b22e9522bee}{x509\+Parse\+Subject\+Unique\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Unique\+ID structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a6bc5db12553ab85062046966b6835359}{x509\+Parse\+Extensions} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Extensions}{X509\+Extensions} $\ast$\hyperlink{tls13__misc_8h_a7b8cc84c920376c616d85d575080d28e}{extensions})
\begin{DoxyCompactList}\small\item\em Parse X.\+509 certificate extensions. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509\+Parse\+Extension} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Extension}{X509\+Extension} $\ast$extension)
\begin{DoxyCompactList}\small\item\em Parse X.\+509 certificate extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_abf00ff52c398cab7d1dea073565bb483}{x509\+Parse\+Basic\+Constraints} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509BasicConstraints}{X509\+Basic\+Constraints} $\ast$basic\+Constraints)
\begin{DoxyCompactList}\small\item\em Parse Basic\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a6d44bf52961bcab248b5c7c15a9388cf}{x509\+Parse\+Name\+Constraints} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509NameConstraints}{X509\+Name\+Constraints} $\ast$name\+Constraints)
\begin{DoxyCompactList}\small\item\em Parse Name\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a44c40ee0268e0602ec3f9798d05f4c06}{x509\+Parse\+Policy\+Constraints} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Policy\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a7647b97767de61288b28b741d282c8ce}{x509\+Parse\+Policy\+Mappings} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Policy\+Mappings extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_acb3f7c866ea11cc7874fcd94fe9c2ed5}{x509\+Parse\+Inhibit\+Any\+Policy} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Inhibit\+Any\+Policy extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a422fd9c0cb45ce8bdbb39b90ec97b9b2}{x509\+Parse\+Key\+Usage} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509KeyUsage}{X509\+Key\+Usage} $\ast$key\+Usage)
\begin{DoxyCompactList}\small\item\em Parse Key\+Usage extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a8d749363df6e0e19f41b6c87d9871afc}{x509\+Parse\+Extended\+Key\+Usage} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509ExtendedKeyUsage}{X509\+Extended\+Key\+Usage} $\ast$ext\+Key\+Usage)
\begin{DoxyCompactList}\small\item\em Parse Extended\+Key\+Usage extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a1834c4a293deeefdd2190cd797b043eb}{x509\+Parse\+Subject\+Alt\+Name} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509SubjectAltName}{X509\+Subject\+Alt\+Name} $\ast$subject\+Alt\+Name)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Alt\+Name extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a45f5611340a9cb8e6c48516ff977c213}{x509\+Parse\+General\+Subtrees} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse General\+Subtrees field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a9195227eeefd0a4135989aae9be08082}{x509\+Parse\+General\+Subtree} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$general\+Name)
\begin{DoxyCompactList}\small\item\em Parse General\+Subtree field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_aa329c231ea14f7d8b61a64db46be87e1}{x509\+Parse\+General\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$general\+Name)
\begin{DoxyCompactList}\small\item\em Parse General\+Name field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_abb67592342a7a0bddcb6a9dfa0c6cdb4}{x509\+Parse\+Subject\+Key\+Id} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509SubjectKeyId}{X509\+Subject\+Key\+Id} $\ast$subject\+Key\+Id)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Key\+Identifier extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_ae597e501920da969d8167e52d8a90ba2}{x509\+Parse\+Authority\+Key\+Id} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509AuthorityKeyId}{X509\+Authority\+Key\+Id} $\ast$auth\+Key\+Id)
\begin{DoxyCompactList}\small\item\em Parse Authority\+Key\+Identifier extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_aa028ba917ab627bbea822b1e29c59d6f}{x509\+Parse\+Ns\+Cert\+Type} (\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t} critical, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509NsCertType}{X509\+Ns\+Cert\+Type} $\ast$ns\+Cert\+Type)
\begin{DoxyCompactList}\small\item\em Parse Netscape\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_adc0fa5cb6436afc727cce7f359621beb}{x509\+Parse\+Signature\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$signature\+Algo)
\begin{DoxyCompactList}\small\item\em Parse Signature\+Algorithm structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_acba116ee8ec551412ecdc02747355b3f}{x509\+Parse\+Signature\+Value} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureValue}{X509\+Signature\+Value} $\ast$signature\+Value)
\begin{DoxyCompactList}\small\item\em Parse Signature\+Value field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{pkix_2x509__cert__parse_8h_a635c796deb07a45dd0ba16daf1d837f9}{x509\+Parse\+Int} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$\hyperlink{chap_8h_adfa040d04d16520129a735fff8fb1628}{value})
\begin{DoxyCompactList}\small\item\em Convert string to integer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_ae597e501920da969d8167e52d8a90ba2}\label{pkix_2x509__cert__parse_8h_ae597e501920da969d8167e52d8a90ba2}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Authority\+Key\+Id@{x509\+Parse\+Authority\+Key\+Id}}
\index{x509\+Parse\+Authority\+Key\+Id@{x509\+Parse\+Authority\+Key\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Authority\+Key\+Id()}{x509ParseAuthorityKeyId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Authority\+Key\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509AuthorityKeyId}{X509\+Authority\+Key\+Id} $\ast$}]{auth\+Key\+Id }\end{DoxyParamCaption})}



Parse Authority\+Key\+Identifier extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em auth\+Key\+Id} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1912 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1914 \{
1915    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1916    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1917 
1918    \textcolor{comment}{//Debug message}
1919    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing AuthorityKeyIdentifier...\(\backslash\)r\(\backslash\)n"});
1920 
1921    \textcolor{comment}{//An extension can be marked as critical}
1922    authKeyId->\hyperlink{structX509AuthorityKeyId_a6fcba640adab232183f55a463d066b81}{critical} = critical;
1923 
1924    \textcolor{comment}{//The AuthorityKeyIdentifier structure shall contain a valid sequence}
1925    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1926    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1927    \textcolor{keywordflow}{if}(error)
1928       \textcolor{keywordflow}{return} error;
1929 
1930    \textcolor{comment}{//Point to the first item of the sequence}
1931    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1932    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1933 
1934    \textcolor{comment}{//Parse the content of the sequence}
1935    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1936    \{
1937       \textcolor{comment}{//Read current item}
1938       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1939       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1940       \textcolor{keywordflow}{if}(error)
1941          \textcolor{keywordflow}{return} error;
1942 
1943       \textcolor{comment}{//Explicit tagging shall be used to encode the item}
1944       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
1945          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
1946 
1947       \textcolor{comment}{//keyIdentifier object found?}
1948       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
1949       \{
1950          \textcolor{comment}{//Save the authority key identifier}
1951          authKeyId->\hyperlink{structX509AuthorityKeyId_ab96ff029d18bc7035b698c9b0daa9681}{keyId} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1952          authKeyId->\hyperlink{structX509AuthorityKeyId_ae1cbf5840bbe41649ea904a2f787278d}{keyIdLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1953       \}
1954 
1955       \textcolor{comment}{//Next item}
1956       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1957       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1958    \}
1959 
1960    \textcolor{comment}{//Successful processing}
1961    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1962 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_abf00ff52c398cab7d1dea073565bb483}\label{pkix_2x509__cert__parse_8h_abf00ff52c398cab7d1dea073565bb483}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Basic\+Constraints@{x509\+Parse\+Basic\+Constraints}}
\index{x509\+Parse\+Basic\+Constraints@{x509\+Parse\+Basic\+Constraints}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Basic\+Constraints()}{x509ParseBasicConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Basic\+Constraints (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509BasicConstraints}{X509\+Basic\+Constraints} $\ast$}]{basic\+Constraints }\end{DoxyParamCaption})}



Parse Basic\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em basic\+Constraints} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1233 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1235 \{
1236    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1237    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1238    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1239 
1240    \textcolor{comment}{//Debug message}
1241    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing BasicConstraints...\(\backslash\)r\(\backslash\)n"});
1242 
1243    \textcolor{comment}{//An extension can be marked as critical}
1244    basicConstraints->\hyperlink{structX509BasicConstraints_a188f2fcfc8d1a8da81a6361affeb66e8}{critical} = critical;
1245 
1246    \textcolor{comment}{//The BasicConstraints structure shall contain a valid sequence}
1247    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1248    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1249    \textcolor{keywordflow}{if}(error)
1250       \textcolor{keywordflow}{return} error;
1251 
1252    \textcolor{comment}{//Point to the first item of the sequence}
1253    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1254    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1255 
1256    \textcolor{comment}{//The cA field is optional}
1257    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1258    \{
1259       \textcolor{comment}{//The cA boolean indicates whether the certified public key may be used}
1260       \textcolor{comment}{//to verify certificate signatures}
1261       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1262       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1263       \textcolor{keywordflow}{if}(error)
1264          \textcolor{keywordflow}{return} error;
1265 
1266       \textcolor{comment}{//Enforce encoding, class and type}
1267       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa6e8bd3d6d3cfdc39ccc2891743560462}{ASN1\_TYPE\_BOOLEAN});
1268 
1269       \textcolor{comment}{//Check status code}
1270       \textcolor{keywordflow}{if}(!error)
1271       \{
1272          \textcolor{comment}{//Make sure the length of the boolean is valid}
1273          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
1274             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1275 
1276          \textcolor{comment}{//Get boolean value}
1277          basicConstraints->\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1278 
1279          \textcolor{comment}{//Point to the next item}
1280          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1281          \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1282       \}
1283    \}
1284 
1285    \textcolor{comment}{//The pathLenConstraint field is optional}
1286    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1287    \{
1288       \textcolor{comment}{//Read the pathLenConstraint field}
1289       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &value);
1290       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1291       \textcolor{keywordflow}{if}(error)
1292          \textcolor{keywordflow}{return} error;
1293 
1294       \textcolor{comment}{//The pathLenConstraint field is meaningful only if the cA boolean is}
1295       \textcolor{comment}{//asserted (refer to RFC 5280, section 4.2.1.9)}
1296       \textcolor{keywordflow}{if}(!basicConstraints->\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA})
1297          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1298 
1299       \textcolor{comment}{//Where it appears, the pathLenConstraint field must be greater than or}
1300       \textcolor{comment}{//equal to zero (refer to RFC 5280, section 4.2.1.9)}
1301       \textcolor{keywordflow}{if}(value < 0)
1302          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1303 
1304       \textcolor{comment}{//The pathLenConstraint field gives the maximum number of non-self-issued}
1305       \textcolor{comment}{//intermediate certificates that may follow this certificate in a valid}
1306       \textcolor{comment}{//certification path}
1307       basicConstraints->\hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1308    \}
1309 
1310    \textcolor{comment}{//Successful processing}
1311    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1312 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a0c8997b0f608c1fee25bdd281e7c4acb}\label{pkix_2x509__cert__parse_8h_a0c8997b0f608c1fee25bdd281e7c4acb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Certificate@{x509\+Parse\+Certificate}}
\index{x509\+Parse\+Certificate@{x509\+Parse\+Certificate}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Certificate()}{x509ParseCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$}]{cert\+Info }\end{DoxyParamCaption})}



Parse a X.\+509 certificate. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the X.\+509 certificate to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the X.\+509 certificate \\
\hline
\mbox{\tt out}  & {\em cert\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 62 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
64 \{
65    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
66    \textcolor{keywordtype}{size\_t} totalLength;
67    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
68 
69    \textcolor{comment}{//Debug message}
70    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Parsing X.509 certificate...\(\backslash\)r\(\backslash\)n"});
71 
72    \textcolor{comment}{//Clear the certificate information structure}
73    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(certInfo, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509CertificateInfo}{X509CertificateInfo}));
74 
75    \textcolor{comment}{//Where pathLenConstraint does not appear, no limit is imposed}
76    certInfo->\hyperlink{structX509CertificateInfo_a6fbc847cf3a3459834fae3c4ece76297}{extensions}.\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.
      \hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = -1;
77 
78    \textcolor{comment}{//Read the contents of the certificate}
79    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
80    \textcolor{comment}{//Failed to decode ASN.1 tag?}
81    \textcolor{keywordflow}{if}(error)
82       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
83 
84    \textcolor{comment}{//Point to the very first field}
85    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
86    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
87 
88    \textcolor{comment}{//Parse TBSCertificate structure}
89    error = \hyperlink{certificate_2x509__cert__parse_8c_aa7675ee05506115f9b21a18385282630}{x509ParseTbsCertificate}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength, certInfo);
90    \textcolor{comment}{//Any error to report?}
91    \textcolor{keywordflow}{if}(error)
92       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
93 
94    \textcolor{comment}{//Point to the next field}
95    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
96    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
97 
98    \textcolor{comment}{//Parse SignatureAlgorithm structure}
99    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
100       &certInfo->\hyperlink{structX509CertificateInfo_a557f43736fe7dab190eac1cd31559281}{signatureAlgo});
101    \textcolor{comment}{//Any error to report?}
102    \textcolor{keywordflow}{if}(error)
103       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
104 
105    \textcolor{comment}{//Point to the next field}
106    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
107    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
108 
109    \textcolor{comment}{//Parse SignatureValue structure}
110    error = \hyperlink{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509ParseSignatureValue}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
111       &certInfo->\hyperlink{structX509CertificateInfo_a14aae7b8131fdc0d1cae4ccc6be1f02d}{signatureValue});
112    \textcolor{comment}{//Any error to report?}
113    \textcolor{keywordflow}{if}(error)
114       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
115 
116    \textcolor{comment}{//Certificate successfully parsed}
117    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
118 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a8d749363df6e0e19f41b6c87d9871afc}\label{pkix_2x509__cert__parse_8h_a8d749363df6e0e19f41b6c87d9871afc}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Extended\+Key\+Usage@{x509\+Parse\+Extended\+Key\+Usage}}
\index{x509\+Parse\+Extended\+Key\+Usage@{x509\+Parse\+Extended\+Key\+Usage}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extended\+Key\+Usage()}{x509ParseExtendedKeyUsage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extended\+Key\+Usage (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509ExtendedKeyUsage}{X509\+Extended\+Key\+Usage} $\ast$}]{ext\+Key\+Usage }\end{DoxyParamCaption})}



Parse Extended\+Key\+Usage extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ext\+Key\+Usage} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1573 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1575 \{
1576    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1577    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1578 
1579    \textcolor{comment}{//Debug message}
1580    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ExtendedKeyUsage...\(\backslash\)r\(\backslash\)n"});
1581 
1582    \textcolor{comment}{//A certificate must not include more than one instance of a particular}
1583    \textcolor{comment}{//extension (refer to RFC 5280, section 4.2)}
1584    \textcolor{keywordflow}{if}(extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} != 0)
1585       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1586 
1587    \textcolor{comment}{//An extension can be marked as critical}
1588    extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_a482c22b220014930529c692a4138e958}{critical} = critical;
1589 
1590    \textcolor{comment}{//The ExtendedKeyUsage structure shall contain a valid sequence}
1591    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1592    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1593    \textcolor{keywordflow}{if}(error)
1594       \textcolor{keywordflow}{return} error;
1595 
1596    \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.12)}
1597    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1598       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1599 
1600    \textcolor{comment}{//Point to the first item of the sequence}
1601    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1602    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1603 
1604    \textcolor{comment}{//This extension indicates one or more purposes for which the certified}
1605    \textcolor{comment}{//public key may be used}
1606    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1607    \{
1608       \textcolor{comment}{//Read KeyPurposeId field}
1609       error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1610       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1611       \textcolor{keywordflow}{if}(error)
1612          \textcolor{keywordflow}{return} error;
1613 
1614       \textcolor{comment}{//anyExtendedKeyUsage?}
1615       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1616          \hyperlink{certificate_2x509__common_8c_a68a4a910638432512485a488e9a162cd}{X509\_ANY\_EXT\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a68a4a910638432512485a488e9a162cd}{X509\_ANY\_EXT\_KEY\_USAGE\_OID})))
1617       \{
1618          \textcolor{comment}{//If a CA includes extended key usages to satisfy such applications,}
1619          \textcolor{comment}{//but does not wish to restrict usages of the key, the CA can include}
1620          \textcolor{comment}{//the special KeyPurposeId anyExtendedKeyUsage}
1621          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca7b28befa17d32564de1990ba5b45e639}{X509\_EXT\_KEY\_USAGE\_ANY};
1622       \}
1623       \textcolor{comment}{//id-kp-serverAuth?}
1624       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1625          \hyperlink{certificate_2x509__common_8c_ae7c9de2f82549acaa3f2b25b56cb187e}{X509\_KP\_SERVER\_AUTH\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae7c9de2f82549acaa3f2b25b56cb187e}{X509\_KP\_SERVER\_AUTH\_OID})))
1626       \{
1627          \textcolor{comment}{//TLS WWW server authentication}
1628          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca63ac39e8e01f7523091284efb3735c76}{X509\_EXT\_KEY\_USAGE\_SERVER\_AUTH};
1629       \}
1630       \textcolor{comment}{//id-kp-clientAuth?}
1631       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1632          \hyperlink{certificate_2x509__common_8c_a837fd5c67b1ec25f4ff5feb51d0e9a6b}{X509\_KP\_CLIENT\_AUTH\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a837fd5c67b1ec25f4ff5feb51d0e9a6b}{X509\_KP\_CLIENT\_AUTH\_OID})))
1633       \{
1634          \textcolor{comment}{//TLS WWW client authentication}
1635          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46caeb140d0686928e663c22c2e032088713}{X509\_EXT\_KEY\_USAGE\_CLIENT\_AUTH};
1636       \}
1637       \textcolor{comment}{//id-kp-codeSigning?}
1638       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1639          \hyperlink{certificate_2x509__common_8c_a17afbafce40d657df96d72ed4c68da1b}{X509\_KP\_CODE\_SIGNING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a17afbafce40d657df96d72ed4c68da1b}{X509\_KP\_CODE\_SIGNING\_OID})))
1640       \{
1641          \textcolor{comment}{//Signing of downloadable executable code}
1642          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca646fedcf77153cb44696361174c99949}{X509\_EXT\_KEY\_USAGE\_CODE\_SIGNING};
1643       \}
1644       \textcolor{comment}{//id-kp-emailProtection?}
1645       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1646          \hyperlink{certificate_2x509__common_8c_a5faa07f49865a76dc91d23067a673a37}{X509\_KP\_EMAIL\_PROTECTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a5faa07f49865a76dc91d23067a673a37}{X509\_KP\_EMAIL\_PROTECTION\_OID})))
1647       \{
1648          \textcolor{comment}{//Email protection}
1649          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46cae38d3955936ea8dabdb3d59e91874b7b}{X509\_EXT\_KEY\_USAGE\_EMAIL\_PROTECTION}
      ;
1650       \}
1651       \textcolor{comment}{//id-kp-timeStamping?}
1652       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1653          \hyperlink{certificate_2x509__common_8c_aeca16b0ea97dd1224378935cea91f6b5}{X509\_KP\_TIME\_STAMPING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_aeca16b0ea97dd1224378935cea91f6b5}{X509\_KP\_TIME\_STAMPING\_OID})))
1654       \{
1655          \textcolor{comment}{//Binding the hash of an object to a time}
1656          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca1900647c6747d7d480869b8e82706986}{X509\_EXT\_KEY\_USAGE\_TIME\_STAMPING};
1657       \}
1658       \textcolor{comment}{//id-kp-OCSPSigning?}
1659       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
1660          \hyperlink{certificate_2x509__common_8c_acf696ac09d30d639c1d331e32007b1a9}{X509\_KP\_OCSP\_SIGNING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_acf696ac09d30d639c1d331e32007b1a9}{X509\_KP\_OCSP\_SIGNING\_OID})))
1661       \{
1662          \textcolor{comment}{//Signing OCSP responses}
1663          extKeyUsage->\hyperlink{structX509ExtendedKeyUsage_ad8972a4feaf8d58626f66650ff9e3ebb}{bitmap} |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca802e45e67a33c7eb0f856f09fce9df0a}{X509\_EXT\_KEY\_USAGE\_OCSP\_SIGNING};
1664       \}
1665       \textcolor{comment}{//Unknown key purpose?}
1666       \textcolor{keywordflow}{else}
1667       \{
1668          \textcolor{comment}{//Discard KeyPurposeId field}
1669       \}
1670 
1671       \textcolor{comment}{//Next item}
1672       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1673       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1674    \}
1675 
1676    \textcolor{comment}{//Successful processing}
1677    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1678 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_ab1c115cdbaf5ae6b616aafc76b0c82fb}\label{pkix_2x509__cert__parse_8h_ab1c115cdbaf5ae6b616aafc76b0c82fb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Extension@{x509\+Parse\+Extension}}
\index{x509\+Parse\+Extension@{x509\+Parse\+Extension}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extension()}{x509ParseExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extension (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Extension}{X509\+Extension} $\ast$}]{extension }\end{DoxyParamCaption})}



Parse X.\+509 certificate extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em extension} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1885 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1887 \{
1888    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1889    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1890 
1891    \textcolor{comment}{//The X.509 extension is encapsulated within a sequence}
1892    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1893    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1894    \textcolor{keywordflow}{if}(error)
1895       \textcolor{keywordflow}{return} error;
1896 
1897    \textcolor{comment}{//Save the total length of the X.509 extension}
1898    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1899 
1900    \textcolor{comment}{//Each extension includes an OID and a value}
1901    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1902    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1903 
1904    \textcolor{comment}{//Read extension OID}
1905    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1906    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1907    \textcolor{keywordflow}{if}(error)
1908       \textcolor{keywordflow}{return} error;
1909 
1910    \textcolor{comment}{//Save the object identifier}
1911    extension->\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1912    extension->\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1913 
1914    \textcolor{comment}{//Next item}
1915    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1916    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1917 
1918    \textcolor{comment}{//Read the Critical flag (if present)}
1919    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1920    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1921    \textcolor{keywordflow}{if}(error)
1922       \textcolor{keywordflow}{return} error;
1923 
1924    \textcolor{comment}{//Enforce encoding, class and type}
1925    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa6e8bd3d6d3cfdc39ccc2891743560462}{ASN1\_TYPE\_BOOLEAN});
1926 
1927    \textcolor{comment}{//Check whether the Critical field is present}
1928    \textcolor{keywordflow}{if}(!error)
1929    \{
1930       \textcolor{comment}{//Make sure the length of the boolean is valid}
1931       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
1932          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1933 
1934       \textcolor{comment}{//Each extension in a certificate is designated as either critical}
1935       \textcolor{comment}{//or non-critical}
1936       extension->\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1937 
1938       \textcolor{comment}{//Next item}
1939       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1940       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1941    \}
1942    \textcolor{keywordflow}{else}
1943    \{
1944       \textcolor{comment}{//The extension is considered as non-critical}
1945       extension->\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1946    \}
1947 
1948    \textcolor{comment}{//The extension value is encapsulated within an octet string}
1949    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1950    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1951    \textcolor{keywordflow}{if}(error)
1952       \textcolor{keywordflow}{return} error;
1953 
1954    \textcolor{comment}{//Save the value of the extension}
1955    extension->\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1956    extension->\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1957 
1958    \textcolor{comment}{//Successful processing}
1959    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1960 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a6bc5db12553ab85062046966b6835359}\label{pkix_2x509__cert__parse_8h_a6bc5db12553ab85062046966b6835359}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Extensions@{x509\+Parse\+Extensions}}
\index{x509\+Parse\+Extensions@{x509\+Parse\+Extensions}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extensions()}{x509ParseExtensions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extensions (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Extensions}{X509\+Extensions} $\ast$}]{extensions }\end{DoxyParamCaption})}



Parse X.\+509 certificate extensions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em extensions} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1689 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1691 \{
1692    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1693    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1694    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1695    \hyperlink{structX509Extension}{X509Extension} extension;
1696 
1697    \textcolor{comment}{//No more data to process?}
1698    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1699    \{
1700       \textcolor{comment}{//The Extensions field is optional}
1701       *totalLength = 0;
1702       \textcolor{comment}{//Exit immediately}
1703       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1704    \}
1705 
1706    \textcolor{comment}{//Explicit tagging is used to encode the Extensions field}
1707    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1708    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1709    \textcolor{keywordflow}{if}(error)
1710       \textcolor{keywordflow}{return} error;
1711 
1712    \textcolor{comment}{//Enforce encoding, class and type}
1713    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       3);
1714    \textcolor{comment}{//Invalid tag?}
1715    \textcolor{keywordflow}{if}(error)
1716    \{
1717       \textcolor{comment}{//The Extensions field is optional}
1718       *totalLength = 0;
1719       \textcolor{comment}{//Exit immediately}
1720       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1721    \}
1722 
1723    \textcolor{comment}{//Save the total length of the field}
1724    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1725 
1726    \textcolor{comment}{//Debug message}
1727    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Extensions...\(\backslash\)r\(\backslash\)n"});
1728 
1729    \textcolor{comment}{//This field is a sequence of one or more certificate extensions}
1730    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
1731    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1732    \textcolor{keywordflow}{if}(error)
1733       \textcolor{keywordflow}{return} error;
1734 
1735    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1736    extensions->\hyperlink{structX509Extensions_aed67fee9d790d14c3af1381cd07a7e0a}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1737    extensions->\hyperlink{structX509Extensions_affa35283aa7142110b2973474b7b1965}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1738 
1739    \textcolor{comment}{//Point to the first item of the sequence}
1740    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1741    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1742 
1743    \textcolor{comment}{//Loop through the extensions}
1744    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1745    \{
1746       \textcolor{comment}{//Each extension includes an OID and a value}
1747       error = \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509ParseExtension}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &extension);
1748       \textcolor{comment}{//Any error to report?}
1749       \textcolor{keywordflow}{if}(error)
1750          \textcolor{keywordflow}{return} error;
1751 
1752       \textcolor{comment}{//BasicConstraints extension found?}
1753       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1754          \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID})))
1755       \{
1756          \textcolor{comment}{//Parse BasicConstraints extension}
1757          error = \hyperlink{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}{x509ParseBasicConstraints}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1758             &extensions->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints});
1759       \}
1760       \textcolor{comment}{//NameConstraints extension found?}
1761       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1762          \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID})))
1763       \{
1764          \textcolor{comment}{//Parse NameConstraints extension}
1765          error = \hyperlink{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}{x509ParseNameConstraints}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1766             &extensions->\hyperlink{structX509Extensions_a25c09f610754fe740c393867ee9950a9}{nameConstraints});
1767       \}
1768 \textcolor{preprocessor}{#if 0}
1769       \textcolor{comment}{//PolicyConstraints extension found?}
1770       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1771          \hyperlink{certificate_2x509__common_8c_add47aa496ac99a30c225ce3b3b5fd1c0}{X509\_POLICY\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_add47aa496ac99a30c225ce3b3b5fd1c0}{X509\_POLICY\_CONSTRAINTS\_OID})))
1772       \{
1773          \textcolor{comment}{//Parse PolicyConstraints extension}
1774          error = \hyperlink{certificate_2x509__cert__parse_8c_a69067e7a8941f2329cbbb3e3a1413887}{x509ParsePolicyConstraints}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1775       \}
1776       \textcolor{comment}{//PolicyMappings extension found?}
1777       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1778          \hyperlink{certificate_2x509__common_8c_aa356a7336c86eebe80e158f38327f5b1}{X509\_POLICY\_MAPPINGS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_aa356a7336c86eebe80e158f38327f5b1}{X509\_POLICY\_MAPPINGS\_OID})))
1779       \{
1780          \textcolor{comment}{//Parse PolicyMappings extension}
1781          error = \hyperlink{certificate_2x509__cert__parse_8c_a71cf108498b2a57b5306de9f005f5a96}{x509ParsePolicyMappings}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1782       \}
1783       \textcolor{comment}{//InhibitAnyPolicy extension found?}
1784       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1785          \hyperlink{certificate_2x509__common_8c_acc42689b362dca46f9dcf8e5190edaf0}{X509\_INHIBIT\_ANY\_POLICY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_acc42689b362dca46f9dcf8e5190edaf0}{X509\_INHIBIT\_ANY\_POLICY\_OID})))
1786       \{
1787          \textcolor{comment}{//Parse InhibitAnyPolicy extension}
1788          error = \hyperlink{certificate_2x509__cert__parse_8c_ade6829856343b371abc479c340c3175b}{x509ParseInhibitAnyPolicy}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1789       \}
1790 \textcolor{preprocessor}{#endif}
1791       \textcolor{comment}{//KeyUsage extension found?}
1792       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1793          \hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID})))
1794       \{
1795          \textcolor{comment}{//Parse KeyUsage extension}
1796          error = \hyperlink{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}{x509ParseKeyUsage}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1797             &extensions->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage});
1798       \}
1799       \textcolor{comment}{//ExtendedKeyUsage extension found?}
1800       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1801          \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID})))
1802       \{
1803          \textcolor{comment}{//Parse ExtendedKeyUsage extension}
1804          error = \hyperlink{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}{x509ParseExtendedKeyUsage}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1805             &extensions->\hyperlink{structX509Extensions_afad9dec97dd6bba0297e67efd46ff042}{extKeyUsage});
1806       \}
1807       \textcolor{comment}{//SubjectAltName extension found?}
1808       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1809          \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID})))
1810       \{
1811          \textcolor{comment}{//Parse SubjectAltName extension}
1812          error = \hyperlink{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}{x509ParseSubjectAltName}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1813             &extensions->\hyperlink{structX509Extensions_a6a01ce6bc43517af604b8cf580ebd01d}{subjectAltName});
1814       \}
1815       \textcolor{comment}{//SubjectKeyIdentifier extension found?}
1816       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1817          \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID})))
1818       \{
1819          \textcolor{comment}{//Parse SubjectKeyIdentifier extension}
1820          error = \hyperlink{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}{x509ParseSubjectKeyId}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1821             &extensions->\hyperlink{structX509Extensions_a720e6ecde7eba80ee36a83d18a67dfd9}{subjectKeyId});
1822       \}
1823       \textcolor{comment}{//AuthorityKeyIdentifier extension found?}
1824       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1825          \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID})))
1826       \{
1827          \textcolor{comment}{//Parse AuthorityKeyIdentifier extension}
1828          error = \hyperlink{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}{x509ParseAuthorityKeyId}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1829             &extensions->\hyperlink{structX509Extensions_acc617db6c54f375abf1455a73e2c5ea3}{authorityKeyId});
1830       \}
1831       \textcolor{comment}{//NetscapeCertType extension found?}
1832       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1833          \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID})))
1834       \{
1835          \textcolor{comment}{//Parse NetscapeCertType extension}
1836          error = \hyperlink{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}{x509ParseNsCertType}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1837             &extensions->\hyperlink{structX509Extensions_a3600340825a23651f29c87e6da57a4bb}{nsCertType});
1838       \}
1839       \textcolor{comment}{//Unknown extension?}
1840       \textcolor{keywordflow}{else}
1841       \{
1842          \textcolor{comment}{//Check if the extension is marked as critical}
1843          \textcolor{keywordflow}{if}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical})
1844          \{
1845             \textcolor{comment}{//An application must reject the certificate if it encounters a}
1846             \textcolor{comment}{//critical extension it does not recognize or a critical extension}
1847             \textcolor{comment}{//that contains information that it cannot process}
1848             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
1849          \}
1850       \}
1851 
1852       \textcolor{comment}{//Any parsing error?}
1853       \textcolor{keywordflow}{if}(error)
1854          \textcolor{keywordflow}{return} error;
1855 
1856       \textcolor{comment}{//Next extension}
1857       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1858       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1859    \}
1860 
1861    \textcolor{comment}{//Check whether the keyCertSign bit is asserted}
1862    \textcolor{keywordflow}{if}(extensions->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage} & \hyperlink{certificate_2x509__common_8h_a071feff2befadce3a4fe5b708cdb149ba2dc6d1748a2dd8a65a7ba5e521a1c054}{X509\_KEY\_USAGE\_KEY\_CERT\_SIGN})
1863    \{
1864       \textcolor{comment}{//If the keyCertSign bit is asserted, then the cA bit in the basic}
1865       \textcolor{comment}{//constraints extension must also be asserted (refer to RFC 5280,}
1866       \textcolor{comment}{//section 4.2.1.3)}
1867       \textcolor{keywordflow}{if}(!extensions->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA})
1868          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1869    \}
1870 
1871    \textcolor{comment}{//Successful processing}
1872    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1873 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_aa329c231ea14f7d8b61a64db46be87e1}\label{pkix_2x509__cert__parse_8h_aa329c231ea14f7d8b61a64db46be87e1}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+General\+Name@{x509\+Parse\+General\+Name}}
\index{x509\+Parse\+General\+Name@{x509\+Parse\+General\+Name}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Name()}{x509ParseGeneralName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$}]{general\+Name }\end{DoxyParamCaption})}



Parse General\+Name field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em general\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2542 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2544 \{
2545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2546    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2547 
2548    \textcolor{comment}{//Debug message}
2549    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing GeneralName...\(\backslash\)r\(\backslash\)n"});
2550 
2551    \textcolor{comment}{//Read current item}
2552    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2553    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2554    \textcolor{keywordflow}{if}(error)
2555       \textcolor{keywordflow}{return} error;
2556 
2557    \textcolor{comment}{//Explicit tagging shall be used to encode the subject alternative name}
2558    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
2559       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
2560 
2561    \textcolor{comment}{//Conforming CAs must not issue certificates with subjectAltNames containing}
2562    \textcolor{comment}{//empty GeneralName fields (refer to RFC 5280, section 4.2.1.6)}
2563    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2564       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2565 
2566    \textcolor{comment}{//Save subject alternative name}
2567    generalName->\hyperlink{structX509GeneralName_a014e3358c1ab42d4da4cd2535d59f05f}{type} = (\hyperlink{certificate_2x509__common_8h_a6a82f43a61ee7a3e18d71f986d7f9a59}{X509GeneralNameType}) tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType};
2568    generalName->\hyperlink{structX509GeneralName_a00814b3509e1b708f019a645511e3d3a}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2569    generalName->\hyperlink{structX509GeneralName_a2804f41c9ae3cf1fb375b1d222d4f3af}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2570 
2571    \textcolor{comment}{//Save the total length of the field}
2572    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2573 
2574    \textcolor{comment}{//Successful processing}
2575    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2576 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a9195227eeefd0a4135989aae9be08082}\label{pkix_2x509__cert__parse_8h_a9195227eeefd0a4135989aae9be08082}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+General\+Subtree@{x509\+Parse\+General\+Subtree}}
\index{x509\+Parse\+General\+Subtree@{x509\+Parse\+General\+Subtree}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Subtree()}{x509ParseGeneralSubtree()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Subtree (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$}]{general\+Name }\end{DoxyParamCaption})}



Parse General\+Subtree field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em general\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2509 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2511 \{
2512    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2513    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2514    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2515 
2516    \textcolor{comment}{//The GeneralSubtrees structure shall contain a valid sequence}
2517    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2518    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2519    \textcolor{keywordflow}{if}(error)
2520       \textcolor{keywordflow}{return} error;
2521 
2522    \textcolor{comment}{//Save the total length of the field}
2523    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2524 
2525    \textcolor{comment}{//Parse GeneralName field}
2526    error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &n, generalName);
2527 
2528    \textcolor{comment}{//Discard minimum and maximum fields}
2529    \textcolor{keywordflow}{return} error;
2530 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a45f5611340a9cb8e6c48516ff977c213}\label{pkix_2x509__cert__parse_8h_a45f5611340a9cb8e6c48516ff977c213}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+General\+Subtrees@{x509\+Parse\+General\+Subtrees}}
\index{x509\+Parse\+General\+Subtrees@{x509\+Parse\+General\+Subtrees}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Subtrees()}{x509ParseGeneralSubtrees()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Subtrees (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse General\+Subtrees field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2475 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2476 \{
2477    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2478    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2479    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
2480 
2481    \textcolor{comment}{//Loop through the list of GeneralSubtree fields}
2482    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2483    \{
2484       \textcolor{comment}{//Parse current GeneralSubtree field}
2485       error = \hyperlink{certificate_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}{x509ParseGeneralSubtree}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
2486       \textcolor{comment}{//Any error to report?}
2487       \textcolor{keywordflow}{if}(error)
2488          \textcolor{keywordflow}{return} error;
2489 
2490       \textcolor{comment}{//Next item}
2491       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2492       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2493    \}
2494 
2495    \textcolor{comment}{//Successful processing}
2496    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2497 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_acb3f7c866ea11cc7874fcd94fe9c2ed5}\label{pkix_2x509__cert__parse_8h_acb3f7c866ea11cc7874fcd94fe9c2ed5}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Inhibit\+Any\+Policy@{x509\+Parse\+Inhibit\+Any\+Policy}}
\index{x509\+Parse\+Inhibit\+Any\+Policy@{x509\+Parse\+Inhibit\+Any\+Policy}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Inhibit\+Any\+Policy()}{x509ParseInhibitAnyPolicy()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Inhibit\+Any\+Policy (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Inhibit\+Any\+Policy extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1484 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1486 \{
1487    \textcolor{comment}{//Debug message}
1488    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing InhibitAnyPolicy...\(\backslash\)r\(\backslash\)n"});
1489 
1490    \textcolor{comment}{//Successful processing}
1491    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1492 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a635c796deb07a45dd0ba16daf1d837f9}\label{pkix_2x509__cert__parse_8h_a635c796deb07a45dd0ba16daf1d837f9}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Int@{x509\+Parse\+Int}}
\index{x509\+Parse\+Int@{x509\+Parse\+Int}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Int()}{x509ParseInt()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Int (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} $\ast$}]{value }\end{DoxyParamCaption})}



Convert string to integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & String containing the representation of an integral number \\
\hline
\mbox{\tt in}  & {\em length} & Length of the string \\
\hline
\mbox{\tt out}  & {\em value} & On success, the function returns the converted integral number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2140 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2141 \{
2142    \textcolor{comment}{//Initialize integer value}
2143    *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = 0;
2144 
2145    \textcolor{comment}{//Parse the string}
2146    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2147    \{
2148       \textcolor{comment}{//Check whether the character is decimal digit}
2149       \textcolor{keywordflow}{if}(!\hyperlink{cyclone__crypto_2core_2crypto_8h_a6859cfefa1679722e293755ba4d51ce5}{cryptoIsdigit}(*\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}))
2150          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
2151 
2152       \textcolor{comment}{//Convert the string to integer}
2153       *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} = *\hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value} * 10 + (*\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} - \textcolor{charliteral}{'0'});
2154 
2155       \textcolor{comment}{//Next character}
2156       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}++;
2157       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}--;
2158    \}
2159 
2160    \textcolor{comment}{//Successful processing}
2161    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2162 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a16087bad69c48b98cbba8ead2d56c5cd}\label{pkix_2x509__cert__parse_8h_a16087bad69c48b98cbba8ead2d56c5cd}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Issuer\+Unique\+Id@{x509\+Parse\+Issuer\+Unique\+Id}}
\index{x509\+Parse\+Issuer\+Unique\+Id@{x509\+Parse\+Issuer\+Unique\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Issuer\+Unique\+Id()}{x509ParseIssuerUniqueId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Issuer\+Unique\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length }\end{DoxyParamCaption})}



Parse Issuer\+Unique\+ID structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1582 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1584 \{
1585    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1586    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1587 
1588    \textcolor{comment}{//No more data to process?}
1589    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1590    \{
1591       \textcolor{comment}{//The IssuerUniqueID field is optional}
1592       *totalLength = 0;
1593       \textcolor{comment}{//Exit immediately}
1594       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1595    \}
1596 
1597    \textcolor{comment}{//Implicit tagging is used to encode the IssuerUniqueID field}
1598    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1599    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1600    \textcolor{keywordflow}{if}(error)
1601       \textcolor{keywordflow}{return} error;
1602 
1603    \textcolor{comment}{//Enforce encoding, class and type}
1604    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       1);
1605    \textcolor{comment}{//Invalid tag?}
1606    \textcolor{keywordflow}{if}(error)
1607    \{
1608       \textcolor{comment}{//The IssuerUniqueID field is optional}
1609       *totalLength = 0;
1610       \textcolor{comment}{//Exit immediately}
1611       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1612    \}
1613 
1614    \textcolor{comment}{//Save the total length of the field}
1615    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1616 
1617    \textcolor{comment}{//Debug message}
1618    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing IssuerUniqueID...\(\backslash\)r\(\backslash\)n"});
1619 
1620    \textcolor{comment}{//Conforming applications should be capable of parsing certificates that}
1621    \textcolor{comment}{//include unique identifiers, but there are no processing requirements}
1622    \textcolor{comment}{//associated with the unique identifiers}
1623    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1624 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a422fd9c0cb45ce8bdbb39b90ec97b9b2}\label{pkix_2x509__cert__parse_8h_a422fd9c0cb45ce8bdbb39b90ec97b9b2}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Key\+Usage@{x509\+Parse\+Key\+Usage}}
\index{x509\+Parse\+Key\+Usage@{x509\+Parse\+Key\+Usage}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Key\+Usage()}{x509ParseKeyUsage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Key\+Usage (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509KeyUsage}{X509\+Key\+Usage} $\ast$}]{key\+Usage }\end{DoxyParamCaption})}



Parse Key\+Usage extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em key\+Usage} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1504 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1506 \{
1507    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1508    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1509 
1510    \textcolor{comment}{//Debug message}
1511    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing KeyUsage...\(\backslash\)r\(\backslash\)n"});
1512 
1513    \textcolor{comment}{//A certificate must not include more than one instance of a particular}
1514    \textcolor{comment}{//extension (refer to RFC 5280, section 4.2)}
1515    \textcolor{keywordflow}{if}(keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} != 0)
1516       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1517 
1518    \textcolor{comment}{//An extension can be marked as critical}
1519    keyUsage->\hyperlink{structX509KeyUsage_a111fd22c20e3dd57cbc8036432987a57}{critical} = critical;
1520 
1521    \textcolor{comment}{//The key usage extension defines the purpose of the key contained in the}
1522    \textcolor{comment}{//certificate}
1523    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1524    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1525    \textcolor{keywordflow}{if}(error)
1526       \textcolor{keywordflow}{return} error;
1527 
1528    \textcolor{comment}{//Enforce encoding, class and type}
1529    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
1530    \textcolor{comment}{//Invalid tag?}
1531    \textcolor{keywordflow}{if}(error)
1532       \textcolor{keywordflow}{return} error;
1533 
1534    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
1535    \textcolor{comment}{//of unused bits in the final subsequent octet}
1536    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
1537       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1538 
1539    \textcolor{comment}{//Sanity check}
1540    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] >= 8)
1541       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1542 
1543    \textcolor{comment}{//Clear bit string}
1544    keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} = 0;
1545 
1546    \textcolor{comment}{//Read bits b0 to b7}
1547    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 2)
1548       keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[1]);
1549 
1550    \textcolor{comment}{//Read bits b8 to b15}
1551    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 3)
1552       keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[2]) << 8;
1553 
1554    \textcolor{comment}{//When the key usage extension appears in a certificate, at least one of}
1555    \textcolor{comment}{//the bits must be set to 1 (refer to RFC 5280, section 4.2.1.3)}
1556    \textcolor{keywordflow}{if}(keyUsage->\hyperlink{structX509KeyUsage_a36e70866e15b4d2bac5c87bd3f985988}{bitmap} == 0)
1557       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1558 
1559    \textcolor{comment}{//Successful processing}
1560    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1561 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a91dc365cee54dd84e0e926317b7a1cea}\label{pkix_2x509__cert__parse_8h_a91dc365cee54dd84e0e926317b7a1cea}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Name@{x509\+Parse\+Name}}
\index{x509\+Parse\+Name@{x509\+Parse\+Name}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name()}{x509ParseName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Name}{X509\+Name} $\ast$}]{name }\end{DoxyParamCaption})}



Parse Name structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 624 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
626 \{
627    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
628    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
629    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
630    \hyperlink{structX509NameAttribute}{X509NameAttribute} nameAttribute;
631 
632    \textcolor{comment}{//Debug message}
633    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Name...\(\backslash\)r\(\backslash\)n"});
634 
635    \textcolor{comment}{//Read the contents of the Name structure}
636    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
637    \textcolor{comment}{//Failed to decode ASN.1 tag?}
638    \textcolor{keywordflow}{if}(error)
639       \textcolor{keywordflow}{return} error;
640 
641    \textcolor{comment}{//Save the total length of the field}
642    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
643 
644    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
645    name->\hyperlink{structX509Name_a16f889e11f79b38a1ade245692857253}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
646    name->\hyperlink{structX509Name_a0f57dd73feee5e3a4aa769fa1ecf3766}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
647 
648    \textcolor{comment}{//The Name describes a hierarchical name composed of attributes}
649    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
650    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
651 
652    \textcolor{comment}{//Loop through all the attributes}
653    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
654    \{
655       \textcolor{comment}{//Read current attribute}
656       error = \hyperlink{certificate_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}{x509ParseNameAttribute}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &nameAttribute);
657       \textcolor{comment}{//Any error to report?}
658       \textcolor{keywordflow}{if}(error)
659          \textcolor{keywordflow}{return} error;
660 
661       \textcolor{comment}{//Common Name attribute found?}
662       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
663          \hyperlink{certificate_2x509__common_8c_a2b21c2e5cf2832b0e88fd6fab5a94e42}{X509\_COMMON\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a2b21c2e5cf2832b0e88fd6fab5a94e42}{X509\_COMMON\_NAME\_OID})))
664       \{
665          name->\hyperlink{structX509Name_a29948ef6424aa86551582e5bf7afa47a}{commonName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
666          name->\hyperlink{structX509Name_a5c5af434bfa902d83cae8cec8af15581}{commonNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
667       \}
668       \textcolor{comment}{//Surname attribute found?}
669       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
670          \hyperlink{certificate_2x509__common_8c_a98f5d48193ddb65ea83893b9e8db5c19}{X509\_SURNAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a98f5d48193ddb65ea83893b9e8db5c19}{X509\_SURNAME\_OID})))
671       \{
672          name->\hyperlink{structX509Name_aa9a667195b0076689e31a6995d925cc0}{surname} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
673          name->\hyperlink{structX509Name_a43f4016488337cbd57078b9b51720645}{surnameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
674       \}
675       \textcolor{comment}{//Serial Number attribute found?}
676       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
677          \hyperlink{certificate_2x509__common_8c_a4641159299e9a03993387e947ab10ed0}{X509\_SERIAL\_NUMBER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a4641159299e9a03993387e947ab10ed0}{X509\_SERIAL\_NUMBER\_OID})))
678       \{
679          name->\hyperlink{structX509Name_ab59d7753a4b9c386e9d10c5ddc609ec5}{serialNumber} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
680          name->\hyperlink{structX509Name_ad24a46ee271b93997a308179a6e8f154}{serialNumberLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
681       \}
682       \textcolor{comment}{//Country Name attribute found?}
683       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
684          \hyperlink{certificate_2x509__common_8c_a358f40098801dee2105f40d48d4d6a3c}{X509\_COUNTRY\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a358f40098801dee2105f40d48d4d6a3c}{X509\_COUNTRY\_NAME\_OID})))
685       \{
686          name->\hyperlink{structX509Name_aebedcf83915608e1929d6cc612a67c2e}{countryName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
687          name->\hyperlink{structX509Name_ae146dda0b021633e3cfc15bda3435bf9}{countryNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
688       \}
689       \textcolor{comment}{//Locality Name attribute found?}
690       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
691          \hyperlink{certificate_2x509__common_8c_a0b268786ad68f63b1e38d64a48e77436}{X509\_LOCALITY\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a0b268786ad68f63b1e38d64a48e77436}{X509\_LOCALITY\_NAME\_OID})))
692       \{
693          name->\hyperlink{structX509Name_a9e5c517817abea85a4ad7a8fa074fb76}{localityName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
694          name->\hyperlink{structX509Name_aba984d3fdf4e5c6eecb90752e54de3a7}{localityNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
695       \}
696       \textcolor{comment}{//State Or Province Name attribute found?}
697       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
698          \hyperlink{certificate_2x509__common_8c_a29d223ee0c7055add854914bad3b0907}{X509\_STATE\_OR\_PROVINCE\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a29d223ee0c7055add854914bad3b0907}{X509\_STATE\_OR\_PROVINCE\_NAME\_OID})))
699       \{
700          name->\hyperlink{structX509Name_ad7101a1d70be5540fc1246c3819383dd}{stateOrProvinceName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
701          name->\hyperlink{structX509Name_a976a693703efcb68deed5c6294d0c95e}{stateOrProvinceNameLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
702       \}
703       \textcolor{comment}{//Organization Name attribute found?}
704       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
705          \hyperlink{certificate_2x509__common_8c_ac425aa6ed62ca6e26603c42a0036bed9}{X509\_ORGANIZATION\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ac425aa6ed62ca6e26603c42a0036bed9}{X509\_ORGANIZATION\_NAME\_OID})))
706       \{
707          name->\hyperlink{structX509Name_a521dfa010d25113b7ebca412a8ef1b6b}{organizationName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
708          name->\hyperlink{structX509Name_af2841192675d2bd0f999533a723d1c1d}{organizationNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
709       \}
710       \textcolor{comment}{//Organizational Unit Name attribute found?}
711       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
712          \hyperlink{certificate_2x509__common_8c_a5e4b5b454f1950a297fa7d74db18a6cd}{X509\_ORGANIZATIONAL\_UNIT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a5e4b5b454f1950a297fa7d74db18a6cd}{X509\_ORGANIZATIONAL\_UNIT\_NAME\_OID})))
713       \{
714          name->\hyperlink{structX509Name_a4095d2020e8553687a85b462fd00eac9}{organizationalUnitName} = nameAttribute.
      \hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
715          name->\hyperlink{structX509Name_a17dc575cf29d256e44331bcb05ea67f0}{organizationalUnitNameLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
716       \}
717       \textcolor{comment}{//Title attribute found?}
718       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
719          \hyperlink{certificate_2x509__common_8c_aff61701a36132aa50d28fd5cf7a9ea0f}{X509\_TITLE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_aff61701a36132aa50d28fd5cf7a9ea0f}{X509\_TITLE\_OID})))
720       \{
721          name->\hyperlink{structX509Name_a5d2ae5a4848f91eccefbeabc69820652}{title} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
722          name->\hyperlink{structX509Name_a0058184d7e0354caeac1e7fdad588b83}{titleLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
723       \}
724       \textcolor{comment}{//Name attribute found?}
725       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
726          \hyperlink{certificate_2x509__common_8c_af6a5d0576cc12caea4ef904c8cbffddd}{X509\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_af6a5d0576cc12caea4ef904c8cbffddd}{X509\_NAME\_OID})))
727       \{
728          name->\hyperlink{structX509Name_a394c9f9f73684a428aae25966b8ba4ca}{name} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
729          name->\hyperlink{structX509Name_a7dbc2e822775eadb3fd3954acdc6f73c}{nameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
730       \}
731       \textcolor{comment}{//Given Name attribute found?}
732       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
733          \hyperlink{certificate_2x509__common_8c_a6dded88e9e1ca6542bf2fce2f18f9002}{X509\_GIVEN\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a6dded88e9e1ca6542bf2fce2f18f9002}{X509\_GIVEN\_NAME\_OID})))
734       \{
735          name->\hyperlink{structX509Name_a17920a6ac4d8f5861eb94d449de21338}{givenName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
736          name->\hyperlink{structX509Name_aacfef579b78cdecc4e865d3a59dc5901}{givenNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
737       \}
738       \textcolor{comment}{//Initials attribute OID (2.5.4.43)}
739       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
740          \hyperlink{certificate_2x509__common_8c_a6b6d6b86ae6068c35861ac70d6b881f8}{X509\_INITIALS\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a6b6d6b86ae6068c35861ac70d6b881f8}{X509\_INITIALS\_OID})))
741       \{
742          name->\hyperlink{structX509Name_a4b7ee284208fc072beb26bd1ab2d8297}{initials} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
743          name->\hyperlink{structX509Name_a2b7b4d29b65c03212c5b2fb3d94c1ab1}{initialsLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
744       \}
745       \textcolor{comment}{//Generation Qualifier attribute found?}
746       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
747          \hyperlink{certificate_2x509__common_8c_af87d6b94adb88574b7bacd0da33240a7}{X509\_GENERATION\_QUALIFIER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_af87d6b94adb88574b7bacd0da33240a7}{X509\_GENERATION\_QUALIFIER\_OID})))
748       \{
749          name->\hyperlink{structX509Name_af795a7195c222e32c6ece85764672094}{generationQualifier} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
750          name->\hyperlink{structX509Name_a295dd5dd5361f04b4f15cfb6d9488d76}{generationQualifierLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
751       \}
752       \textcolor{comment}{//DN Qualifier attribute found?}
753       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
754          \hyperlink{certificate_2x509__common_8c_a734687e867f0ef28c6ffa179dbc51324}{X509\_DN\_QUALIFIER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a734687e867f0ef28c6ffa179dbc51324}{X509\_DN\_QUALIFIER\_OID})))
755       \{
756          name->\hyperlink{structX509Name_aff2c9afbb89584912d7a66f70d2e21ea}{dnQualifier} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
757          name->\hyperlink{structX509Name_a070cb2ee94a282f233a4ee5a23a7374d}{dnQualifierLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
758       \}
759       \textcolor{comment}{//Pseudonym attribute found?}
760       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
761          \hyperlink{certificate_2x509__common_8c_ac6cb01372209cfb385bccdb197214b7d}{X509\_PSEUDONYM\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ac6cb01372209cfb385bccdb197214b7d}{X509\_PSEUDONYM\_OID})))
762       \{
763          name->\hyperlink{structX509Name_ac157a7985fd1b9ea07893de309947823}{pseudonym} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
764          name->\hyperlink{structX509Name_a701db328dc75e341e16cc03f65abf062}{pseudonymLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
765       \}
766       \textcolor{comment}{//Unknown attribute?}
767       \textcolor{keywordflow}{else}
768       \{
769          \textcolor{comment}{//Discard current attribute}
770       \}
771 
772       \textcolor{comment}{//Next attribute}
773       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
774       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
775    \}
776 
777    \textcolor{comment}{//Name field successfully parsed}
778    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
779 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_ac2fda2111b747d8e392ac9676b607125}\label{pkix_2x509__cert__parse_8h_ac2fda2111b747d8e392ac9676b607125}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Name\+Attribute@{x509\+Parse\+Name\+Attribute}}
\index{x509\+Parse\+Name\+Attribute@{x509\+Parse\+Name\+Attribute}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name\+Attribute()}{x509ParseNameAttribute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name\+Attribute (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509NameAttribute}{X509\+Name\+Attribute} $\ast$}]{name\+Attribute }\end{DoxyParamCaption})}



Parse name attribute. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em name\+Attribute} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 791 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
793 \{
794    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
795    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
796 
797    \textcolor{comment}{//Attributes are encapsulated within a set}
798    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
799    \textcolor{comment}{//Failed to decode ASN.1 tag?}
800    \textcolor{keywordflow}{if}(error)
801       \textcolor{keywordflow}{return} error;
802 
803    \textcolor{comment}{//Enforce encoding, class and type}
804    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9b2fa570f44ed585417c69fdeead6efa}{ASN1\_TYPE\_SET});
805    \textcolor{comment}{//Invalid tag?}
806    \textcolor{keywordflow}{if}(error)
807       \textcolor{keywordflow}{return} error;
808 
809    \textcolor{comment}{//Save the total length of the attribute}
810    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
811 
812    \textcolor{comment}{//Read the first field of the set}
813    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
814    \textcolor{comment}{//Failed to decode ASN.1 tag?}
815    \textcolor{keywordflow}{if}(error)
816       \textcolor{keywordflow}{return} error;
817 
818    \textcolor{comment}{//Point to the first field of the sequence}
819    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
820    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
821 
822    \textcolor{comment}{//Read attribute type}
823    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
824    \textcolor{comment}{//Failed to decode ASN.1 tag?}
825    \textcolor{keywordflow}{if}(error)
826       \textcolor{keywordflow}{return} error;
827 
828    \textcolor{comment}{//Save attribute type}
829    nameAttribute->\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
830    nameAttribute->\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
831 
832    \textcolor{comment}{//Point to the next field}
833    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
834    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
835 
836    \textcolor{comment}{//Read attribute value}
837    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
838    \textcolor{comment}{//Failed to decode ASN.1 tag?}
839    \textcolor{keywordflow}{if}(error)
840       \textcolor{keywordflow}{return} error;
841 
842    \textcolor{comment}{//Save attribute value}
843    nameAttribute->\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
844    nameAttribute->\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
845 
846    \textcolor{comment}{//Successful processing}
847    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
848 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a6d44bf52961bcab248b5c7c15a9388cf}\label{pkix_2x509__cert__parse_8h_a6d44bf52961bcab248b5c7c15a9388cf}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Name\+Constraints@{x509\+Parse\+Name\+Constraints}}
\index{x509\+Parse\+Name\+Constraints@{x509\+Parse\+Name\+Constraints}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name\+Constraints()}{x509ParseNameConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name\+Constraints (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509NameConstraints}{X509\+Name\+Constraints} $\ast$}]{name\+Constraints }\end{DoxyParamCaption})}



Parse Name\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em name\+Constraints} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1324 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1326 \{
1327    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1328    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1329 
1330    \textcolor{comment}{//Debug message}
1331    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing NameConstraints...\(\backslash\)r\(\backslash\)n"});
1332 
1333    \textcolor{comment}{//An extension can be marked as critical}
1334    nameConstraints->\hyperlink{structX509NameConstraints_a635bd3b8e0e3ec7a232529ad58f9594b}{critical} = critical;
1335 
1336    \textcolor{comment}{//The NameConstraints structure shall contain a valid sequence}
1337    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1338    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1339    \textcolor{keywordflow}{if}(error)
1340       \textcolor{keywordflow}{return} error;
1341 
1342    \textcolor{comment}{//Conforming CAs must not issue certificates where name constraints is an}
1343    \textcolor{comment}{//empty sequence (refer to RFC 5280, section 4.2.1.10)}
1344    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1345       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1346 
1347    \textcolor{comment}{//Point to the first item of the sequence}
1348    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1349    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1350 
1351    \textcolor{comment}{//The name constraints extension indicates a name space within which all}
1352    \textcolor{comment}{//subject names in subsequent certificates in a certification path must}
1353    \textcolor{comment}{//be located}
1354    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1355    \{
1356       \textcolor{comment}{//Parse GeneralSubtrees field}
1357       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1358       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1359       \textcolor{keywordflow}{if}(error)
1360          \textcolor{keywordflow}{return} error;
1361 
1362       \textcolor{comment}{//Explicit tagging shall be used to encode the GeneralSubtrees field}
1363       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
1364          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
1365 
1366       \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.10)}
1367       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1368          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1369 
1370       \textcolor{comment}{//Restrictions are defined in terms of permitted or excluded name subtrees}
1371       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
1372       \{
1373          \textcolor{comment}{//Parse the permittedSubtrees field}
1374          error = \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509ParseGeneralSubtrees}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length});
1375          \textcolor{comment}{//Any error to report?}
1376          \textcolor{keywordflow}{if}(error)
1377             \textcolor{keywordflow}{return} error;
1378 
1379          \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1380          nameConstraints->\hyperlink{structX509NameConstraints_a156421797fb4821bee39cfc265a0c2da}{permittedSubtrees} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1381          nameConstraints->\hyperlink{structX509NameConstraints_aaada0ccb4f22f65db2b71493b14327c0}{permittedSubtreesLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1382       \}
1383       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 1)
1384       \{
1385          \textcolor{comment}{//Parse the excludedSubtrees field}
1386          error = \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509ParseGeneralSubtrees}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length});
1387          \textcolor{comment}{//Any error to report?}
1388          \textcolor{keywordflow}{if}(error)
1389             \textcolor{keywordflow}{return} error;
1390 
1391          \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1392          nameConstraints->\hyperlink{structX509NameConstraints_a187e11b65d21e9eb4c9124c133c0fbbc}{excludedSubtrees} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1393          nameConstraints->\hyperlink{structX509NameConstraints_a5f03d1d2e8b8eddf4f1e99bbb61254af}{excludedSubtreesLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1394       \}
1395       \textcolor{keywordflow}{else}
1396       \{
1397          \textcolor{comment}{//Report an error}
1398          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
1399       \}
1400 
1401       \textcolor{comment}{//Next item}
1402       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1403       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1404    \}
1405 
1406    \textcolor{comment}{//Successful processing}
1407    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1408 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_aa028ba917ab627bbea822b1e29c59d6f}\label{pkix_2x509__cert__parse_8h_aa028ba917ab627bbea822b1e29c59d6f}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Ns\+Cert\+Type@{x509\+Parse\+Ns\+Cert\+Type}}
\index{x509\+Parse\+Ns\+Cert\+Type@{x509\+Parse\+Ns\+Cert\+Type}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ns\+Cert\+Type()}{x509ParseNsCertType()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ns\+Cert\+Type (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509NsCertType}{X509\+Ns\+Cert\+Type} $\ast$}]{ns\+Cert\+Type }\end{DoxyParamCaption})}



Parse Netscape\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ns\+Cert\+Type} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1974 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1976 \{
1977    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1978    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1979 
1980    \textcolor{comment}{//Debug message}
1981    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing NetscapeCertType...\(\backslash\)r\(\backslash\)n"});
1982 
1983    \textcolor{comment}{//An extension can be marked as critical}
1984    nsCertType->\hyperlink{structX509NsCertType_ae633c6008dfd10b8d487d9c4f92eae7b}{critical} = critical;
1985 
1986    \textcolor{comment}{//The NetscapeCertType extension limit the use of a certificate}
1987    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1988    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1989    \textcolor{keywordflow}{if}(error)
1990       \textcolor{keywordflow}{return} error;
1991 
1992    \textcolor{comment}{//Enforce encoding, class and type}
1993    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
1994    \textcolor{comment}{//Invalid tag?}
1995    \textcolor{keywordflow}{if}(error)
1996       \textcolor{keywordflow}{return} error;
1997 
1998    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
1999    \textcolor{comment}{//of unused bits in the final subsequent octet}
2000    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
2001       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2002 
2003    \textcolor{comment}{//Sanity check}
2004    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] >= 8)
2005       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2006 
2007    \textcolor{comment}{//Clear bit string}
2008    nsCertType->\hyperlink{structX509NsCertType_a573466b1c15b14b50697f06c64005917}{bitmap} = 0;
2009 
2010    \textcolor{comment}{//Read bits b0 to b7}
2011    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 2)
2012       nsCertType->\hyperlink{structX509NsCertType_a573466b1c15b14b50697f06c64005917}{bitmap} |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[1]);
2013 
2014    \textcolor{comment}{//Successful processing}
2015    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2016 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a44c40ee0268e0602ec3f9798d05f4c06}\label{pkix_2x509__cert__parse_8h_a44c40ee0268e0602ec3f9798d05f4c06}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Policy\+Constraints@{x509\+Parse\+Policy\+Constraints}}
\index{x509\+Parse\+Policy\+Constraints@{x509\+Parse\+Policy\+Constraints}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Policy\+Constraints()}{x509ParsePolicyConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Policy\+Constraints (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Policy\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1419 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1421 \{
1422    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1423    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1424 
1425    \textcolor{comment}{//Debug message}
1426    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing PolicyConstraints...\(\backslash\)r\(\backslash\)n"});
1427 
1428    \textcolor{comment}{//The PolicyConstraints structure shall contain a valid sequence}
1429    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1430    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1431    \textcolor{keywordflow}{if}(error)
1432       \textcolor{keywordflow}{return} error;
1433 
1434    \textcolor{comment}{//Conforming CAs must not issue certificates where policy constraints is an}
1435    \textcolor{comment}{//empty sequence (refer to RFC 5280, section 4.2.1.11)}
1436    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1437       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1438 
1439    \textcolor{comment}{//Successful processing}
1440    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1441 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a7647b97767de61288b28b741d282c8ce}\label{pkix_2x509__cert__parse_8h_a7647b97767de61288b28b741d282c8ce}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Policy\+Mappings@{x509\+Parse\+Policy\+Mappings}}
\index{x509\+Parse\+Policy\+Mappings@{x509\+Parse\+Policy\+Mappings}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Policy\+Mappings()}{x509ParsePolicyMappings()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Policy\+Mappings (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Policy\+Mappings extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1452 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1454 \{
1455    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1456    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1457 
1458    \textcolor{comment}{//Debug message}
1459    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing PolicyMappings...\(\backslash\)r\(\backslash\)n"});
1460 
1461    \textcolor{comment}{//The PolicyMappings structure shall contain a valid sequence}
1462    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1463    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1464    \textcolor{keywordflow}{if}(error)
1465       \textcolor{keywordflow}{return} error;
1466 
1467    \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.5)}
1468    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
1469       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1470 
1471    \textcolor{comment}{//Successful processing}
1472    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1473 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a936f23f5633f2c2c9c767d27f2196f26}\label{pkix_2x509__cert__parse_8h_a936f23f5633f2c2c9c767d27f2196f26}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Serial\+Number@{x509\+Parse\+Serial\+Number}}
\index{x509\+Parse\+Serial\+Number@{x509\+Parse\+Serial\+Number}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Serial\+Number()}{x509ParseSerialNumber()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Serial\+Number (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SerialNumber}{X509\+Serial\+Number} $\ast$}]{serial\+Number }\end{DoxyParamCaption})}



Parse Serial\+Number field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em serial\+Number} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 354 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
356 \{
357    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
358    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
359 
360    \textcolor{comment}{//Debug message}
361    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SerialNumber...\(\backslash\)r\(\backslash\)n"});
362 
363    \textcolor{comment}{//Read the contents of the SerialNumber structure}
364    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
365    \textcolor{comment}{//Failed to decode ASN.1 tag?}
366    \textcolor{keywordflow}{if}(error)
367       \textcolor{keywordflow}{return} error;
368 
369    \textcolor{comment}{//Save the total length of the field}
370    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
371 
372    \textcolor{comment}{//Enforce encoding, class and type}
373    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
374    \textcolor{comment}{//Invalid tag?}
375    \textcolor{keywordflow}{if}(error)
376       \textcolor{keywordflow}{return} error;
377 
378    \textcolor{comment}{//Check the length of the serial number}
379    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
380       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
381 
382    \textcolor{comment}{//Non-conforming CAs may issue certificates with serial numbers that are}
383    \textcolor{comment}{//negative or zero. Certificate users should be prepared to gracefully}
384    \textcolor{comment}{//handle such certificates (refer to RFC 5280, section 4.1.2.2)}
385    serialNumber->\hyperlink{structX509SerialNumber_a04490ca0624096caf478beed3331d552}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
386    serialNumber->\hyperlink{structX509SerialNumber_ab076f0a46bcefa47cdc8135d5990ab78}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
387 
388    \textcolor{comment}{//No error to report}
389    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
390 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_adc0fa5cb6436afc727cce7f359621beb}\label{pkix_2x509__cert__parse_8h_adc0fa5cb6436afc727cce7f359621beb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Signature\+Algo@{x509\+Parse\+Signature\+Algo}}
\index{x509\+Parse\+Signature\+Algo@{x509\+Parse\+Signature\+Algo}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature\+Algo()}{x509ParseSignatureAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$}]{signature\+Algo }\end{DoxyParamCaption})}



Parse Signature\+Algorithm structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature\+Algo} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2729 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2731 \{
2732    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2733    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2734 
2735    \textcolor{comment}{//Debug message}
2736    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing SignatureAlgorithm...\(\backslash\)r\(\backslash\)n"});
2737 
2738    \textcolor{comment}{//Read the contents of the SignatureAlgorithm field}
2739    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2740    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2741    \textcolor{keywordflow}{if}(error)
2742       \textcolor{keywordflow}{return} error;
2743 
2744    \textcolor{comment}{//Save the total length of the field}
2745    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2746 
2747    \textcolor{comment}{//Read the inner tag}
2748    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
2749    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2750    \textcolor{keywordflow}{if}(error)
2751       \textcolor{keywordflow}{return} error;
2752 
2753    \textcolor{comment}{//This field must contain the same algorithm identifier as the signature}
2754    \textcolor{comment}{//field in the TBSCertificate sequence}
2755    error = \hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, signatureAlgo->\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid}, signatureAlgo->
      \hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen});
2756    \textcolor{comment}{//Invalid tag?}
2757    \textcolor{keywordflow}{if}(error)
2758       \textcolor{keywordflow}{return} error;
2759 
2760    \textcolor{comment}{//Successful processing}
2761    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2762 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_acba116ee8ec551412ecdc02747355b3f}\label{pkix_2x509__cert__parse_8h_acba116ee8ec551412ecdc02747355b3f}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Signature\+Value@{x509\+Parse\+Signature\+Value}}
\index{x509\+Parse\+Signature\+Value@{x509\+Parse\+Signature\+Value}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature\+Value()}{x509ParseSignatureValue()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature\+Value (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureValue}{X509\+Signature\+Value} $\ast$}]{signature\+Value }\end{DoxyParamCaption})}



Parse Signature\+Value field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature\+Value} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2774 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2776 \{
2777    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2778    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2779 
2780    \textcolor{comment}{//Debug message}
2781    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing SignatureValue...\(\backslash\)r\(\backslash\)n"});
2782 
2783    \textcolor{comment}{//Read the contents of the SignatureValue structure}
2784    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2785    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2786    \textcolor{keywordflow}{if}(error)
2787       \textcolor{keywordflow}{return} error;
2788 
2789    \textcolor{comment}{//Save the total length of the field}
2790    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2791 
2792    \textcolor{comment}{//Enforce encoding, class and type}
2793    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
2794    \textcolor{comment}{//Invalid tag?}
2795    \textcolor{keywordflow}{if}(error)
2796       \textcolor{keywordflow}{return} error;
2797 
2798    \textcolor{comment}{//The bit string shall contain an initial octet which encodes}
2799    \textcolor{comment}{//the number of unused bits in the final subsequent octet}
2800    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1 || tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] != 0x00)
2801       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
2802 
2803    \textcolor{comment}{//Get the signature value}
2804    signatureValue->\hyperlink{structX509SignatureValue_a3e53e8589cdfc0c22d30e85bebfa0625}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1;
2805    signatureValue->\hyperlink{structX509SignatureValue_af1bce8baf0e1a46212467145e00079d7}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1;
2806 
2807    \textcolor{comment}{//Successful processing}
2808    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2809 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a1834c4a293deeefdd2190cd797b043eb}\label{pkix_2x509__cert__parse_8h_a1834c4a293deeefdd2190cd797b043eb}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Subject\+Alt\+Name@{x509\+Parse\+Subject\+Alt\+Name}}
\index{x509\+Parse\+Subject\+Alt\+Name@{x509\+Parse\+Subject\+Alt\+Name}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Alt\+Name()}{x509ParseSubjectAltName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Alt\+Name (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509SubjectAltName}{X509\+Subject\+Alt\+Name} $\ast$}]{subject\+Alt\+Name }\end{DoxyParamCaption})}



Parse Subject\+Alt\+Name extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em subject\+Alt\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1690 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1692 \{
1693    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1694    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
1695    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1696    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1697    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
1698 
1699    \textcolor{comment}{//Debug message}
1700    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing SubjectAltName...\(\backslash\)r\(\backslash\)n"});
1701 
1702    \textcolor{comment}{//An extension can be marked as critical}
1703    subjectAltName->\hyperlink{structX509SubjectAltName_a9e9447d4bb78391112715c74f6599dbf}{critical} = critical;
1704 
1705    \textcolor{comment}{//The SubjectAltName structure shall contain a valid sequence}
1706    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1707    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1708    \textcolor{keywordflow}{if}(error)
1709       \textcolor{keywordflow}{return} error;
1710 
1711    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1712    subjectAltName->\hyperlink{structX509SubjectAltName_a7d756442bef6565af58ede9410b2dc77}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1713    subjectAltName->\hyperlink{structX509SubjectAltName_a87435ad32eda0d4b0a9229028521812b}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1714 
1715    \textcolor{comment}{//Point to the first item of the sequence}
1716    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1717    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1718 
1719    \textcolor{comment}{//The subject alternative name extension allows identities to be bound to the}
1720    \textcolor{comment}{//subject of the certificate. These identities may be included in addition}
1721    \textcolor{comment}{//to or in place of the identity in the subject field of the certificate}
1722    \textcolor{keywordflow}{for}(i = 0; \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0; i++)
1723    \{
1724       \textcolor{comment}{//Parse GeneralName field}
1725       error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
1726       \textcolor{comment}{//Any error to report?}
1727       \textcolor{keywordflow}{if}(error)
1728          \textcolor{keywordflow}{return} error;
1729 
1730       \textcolor{comment}{//Sanity check}
1731       \textcolor{keywordflow}{if}(i < \hyperlink{certificate_2x509__common_8h_ad4b18644ac42bdeede4fe0b1643ce954}{X509\_MAX\_SUBJECT\_ALT\_NAMES})
1732       \{
1733          \textcolor{comment}{//Save subject alternative name}
1734          subjectAltName->\hyperlink{structX509SubjectAltName_ab4a56143bba771858700f363a8da4647}{generalNames}[i] = generalName;
1735       \}
1736 
1737       \textcolor{comment}{//Next item}
1738       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1739       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1740    \}
1741 
1742    \textcolor{comment}{//If the SubjectAltName extension is present, the sequence must contain at}
1743    \textcolor{comment}{//least one entry (refer to RFC 5280, section 4.2.1.6)}
1744    \textcolor{keywordflow}{if}(i == 0)
1745       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1746 
1747    \textcolor{comment}{//Save the number of subject alternative names}
1748    subjectAltName->\hyperlink{structX509SubjectAltName_a320072e6555af4e2bd76d9d154ef7eca}{numGeneralNames} = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(i, 
      \hyperlink{certificate_2x509__common_8h_ad4b18644ac42bdeede4fe0b1643ce954}{X509\_MAX\_SUBJECT\_ALT\_NAMES});
1749 
1750    \textcolor{comment}{//Successful processing}
1751    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1752 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_abb67592342a7a0bddcb6a9dfa0c6cdb4}\label{pkix_2x509__cert__parse_8h_abb67592342a7a0bddcb6a9dfa0c6cdb4}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Subject\+Key\+Id@{x509\+Parse\+Subject\+Key\+Id}}
\index{x509\+Parse\+Subject\+Key\+Id@{x509\+Parse\+Subject\+Key\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Key\+Id()}{x509ParseSubjectKeyId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Key\+Id (\begin{DoxyParamCaption}\item[{\hyperlink{compiler__port_8h_a812d16e5494522586b3784e55d479912}{bool\+\_\+t}}]{critical,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509SubjectKeyId}{X509\+Subject\+Key\+Id} $\ast$}]{subject\+Key\+Id }\end{DoxyParamCaption})}



Parse Subject\+Key\+Identifier extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em critical} & Critical extension flag \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em subject\+Key\+Id} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1875 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1877 \{
1878    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1879    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1880 
1881    \textcolor{comment}{//Debug message}
1882    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing SubjectKeyIdentifier...\(\backslash\)r\(\backslash\)n"});
1883 
1884    \textcolor{comment}{//An extension can be marked as critical}
1885    subjectKeyId->\hyperlink{structX509SubjectKeyId_abae7eb488122b99c3413adb35d04d7f2}{critical} = critical;
1886 
1887    \textcolor{comment}{//The subject key identifier extension provides a means of identifying}
1888    \textcolor{comment}{//certificates that contain a particular public key}
1889    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1890    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1891    \textcolor{keywordflow}{if}(error)
1892       \textcolor{keywordflow}{return} error;
1893 
1894    \textcolor{comment}{//Save the subject key identifier}
1895    subjectKeyId->\hyperlink{structX509SubjectKeyId_ac13791883d5af3098c8fcecd596f4737}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1896    subjectKeyId->\hyperlink{structX509SubjectKeyId_ae72259e33329d3224c90547e63f95804}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1897 
1898    \textcolor{comment}{//Successful processing}
1899    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1900 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a417813688cad9149a37f2b22e9522bee}\label{pkix_2x509__cert__parse_8h_a417813688cad9149a37f2b22e9522bee}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Subject\+Unique\+Id@{x509\+Parse\+Subject\+Unique\+Id}}
\index{x509\+Parse\+Subject\+Unique\+Id@{x509\+Parse\+Subject\+Unique\+Id}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Unique\+Id()}{x509ParseSubjectUniqueId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Unique\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length }\end{DoxyParamCaption})}



Parse Subject\+Unique\+ID structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1635 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1637 \{
1638    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1639    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1640 
1641    \textcolor{comment}{//No more data to process?}
1642    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1643    \{
1644       \textcolor{comment}{//The SubjectUniqueID field is optional}
1645       *totalLength = 0;
1646       \textcolor{comment}{//Exit immediately}
1647       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1648    \}
1649 
1650    \textcolor{comment}{//Implicit tagging is used to encode the SubjectUniqueID field}
1651    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1652    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1653    \textcolor{keywordflow}{if}(error)
1654       \textcolor{keywordflow}{return} error;
1655 
1656    \textcolor{comment}{//Enforce encoding, class and type}
1657    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       2);
1658    \textcolor{comment}{//Invalid tag?}
1659    \textcolor{keywordflow}{if}(error)
1660    \{
1661       \textcolor{comment}{//The SubjectUniqueID field is optional}
1662       *totalLength = 0;
1663       \textcolor{comment}{//Exit immediately}
1664       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1665    \}
1666 
1667    \textcolor{comment}{//Save the total length of the field}
1668    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1669 
1670    \textcolor{comment}{//Debug message}
1671    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SubjectUniqueID...\(\backslash\)r\(\backslash\)n"});
1672 
1673    \textcolor{comment}{//Conforming applications should be capable of parsing certificates that}
1674    \textcolor{comment}{//include unique identifiers, but there are no processing requirements}
1675    \textcolor{comment}{//associated with the unique identifiers}
1676    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1677 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a7a0742ff1b43f4cbf588b0d55f8adf33}\label{pkix_2x509__cert__parse_8h_a7a0742ff1b43f4cbf588b0d55f8adf33}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Tbs\+Certificate@{x509\+Parse\+Tbs\+Certificate}}
\index{x509\+Parse\+Tbs\+Certificate@{x509\+Parse\+Tbs\+Certificate}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Tbs\+Certificate()}{x509ParseTbsCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Tbs\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509TbsCertificate}{X509\+Tbs\+Certificate} $\ast$}]{tbs\+Cert }\end{DoxyParamCaption})}



Parse T\+B\+S\+Certificate structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em tbs\+Cert} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 145 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
147 \{
148    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
149    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
150    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
151 
152    \textcolor{comment}{//Debug message}
153    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing TBSCertificate...\(\backslash\)r\(\backslash\)n"});
154 
155    \textcolor{comment}{//Read the contents of the TBSCertificate structure}
156    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
157    \textcolor{comment}{//Failed to decode ASN.1 tag?}
158    \textcolor{keywordflow}{if}(error)
159       \textcolor{keywordflow}{return} error;
160 
161    \textcolor{comment}{//Save the total length of the field}
162    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
163 
164    \textcolor{comment}{//The ASN.1 DER-encoded TBSCertificate is used as the input to the}
165    \textcolor{comment}{//signature function}
166    tbsCert->\hyperlink{structX509TbsCertificate_ace5ec9ea3582843c4e81cdbbe4c3d0aa}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
167    tbsCert->\hyperlink{structX509TbsCertificate_af8694e963e30d044b217305d089e7ecd}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
168 
169    \textcolor{comment}{//Point to the very first field of the TBSCertificate}
170    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
171    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
172 
173    \textcolor{comment}{//Parse Version field}
174    error = \hyperlink{certificate_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}{x509ParseVersion}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version});
175    \textcolor{comment}{//Any parsing error?}
176    \textcolor{keywordflow}{if}(error)
177       \textcolor{keywordflow}{return} error;
178 
179    \textcolor{comment}{//Point to the next field}
180    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
181    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
182 
183    \textcolor{comment}{//Parse SerialNumber field}
184    error = \hyperlink{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}{x509ParseSerialNumber}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_ae21529587634708bc0f5cc3aa0558a3a}{serialNumber});
185    \textcolor{comment}{//Any parsing error?}
186    \textcolor{keywordflow}{if}(error)
187       \textcolor{keywordflow}{return} error;
188 
189    \textcolor{comment}{//Point to the next field}
190    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
191    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
192 
193    \textcolor{comment}{//Parse Signature field}
194    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a6b7b1c8ebc69acd3317d38394961048a}{signatureAlgo});
195    \textcolor{comment}{//Any parsing error?}
196    \textcolor{keywordflow}{if}(error)
197       \textcolor{keywordflow}{return} error;
198 
199    \textcolor{comment}{//Point to the next field}
200    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
201    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
202 
203    \textcolor{comment}{//Parse Issuer field}
204    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a8f9e1f73fbccfe993464a10bf6420a69}{issuer});
205    \textcolor{comment}{//Any parsing error?}
206    \textcolor{keywordflow}{if}(error)
207       \textcolor{keywordflow}{return} error;
208 
209    \textcolor{comment}{//Point to the next field}
210    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
211    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
212 
213    \textcolor{comment}{//Parse Validity field}
214    error = \hyperlink{certificate_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}{x509ParseValidity}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_ad2149392b07cf44a8b6421572a93a70e}{validity});
215    \textcolor{comment}{//Any parsing error?}
216    \textcolor{keywordflow}{if}(error)
217       \textcolor{keywordflow}{return} error;
218 
219    \textcolor{comment}{//Point to the next field}
220    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
221    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
222 
223    \textcolor{comment}{//Parse Subject field}
224    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_a68e21bffb3f287f4e57378b275e1d178}{subject});
225    \textcolor{comment}{//Any parsing error?}
226    \textcolor{keywordflow}{if}(error)
227       \textcolor{keywordflow}{return} error;
228 
229    \textcolor{comment}{//Point to the next field}
230    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
231    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
232 
233    \textcolor{comment}{//Parse SubjectPublicKeyInfo field}
234    error = \hyperlink{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}{x509ParseSubjectPublicKeyInfo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
235       &tbsCert->\hyperlink{structX509TbsCertificate_ae6d392cbe0fcd240ab1dabaac465ca95}{subjectPublicKeyInfo});
236    \textcolor{comment}{//Any parsing error?}
237    \textcolor{keywordflow}{if}(error)
238       \textcolor{keywordflow}{return} error;
239 
240    \textcolor{comment}{//Point to the next field}
241    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
242    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
243 
244    \textcolor{comment}{//Parse IssuerUniqueID field}
245    error = \hyperlink{certificate_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}{x509ParseIssuerUniqueId}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
246    \textcolor{comment}{//Any parsing error?}
247    \textcolor{keywordflow}{if}(error)
248       \textcolor{keywordflow}{return} error;
249 
250    \textcolor{comment}{//The IssuerUniqueID field is optional}
251    \textcolor{keywordflow}{if}(n > 0)
252    \{
253       \textcolor{comment}{//This field must only appear if the version is 2 or 3}
254       \textcolor{keywordflow}{if}(tbsCert->\hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
255          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
256    \}
257 
258    \textcolor{comment}{//Point to the next field}
259    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
260    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
261 
262    \textcolor{comment}{//Parse SubjectUniqueID field}
263    error = \hyperlink{certificate_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}{x509ParseSubjectUniqueId}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
264    \textcolor{comment}{//Any parsing error?}
265    \textcolor{keywordflow}{if}(error)
266       \textcolor{keywordflow}{return} error;
267 
268    \textcolor{comment}{//The SubjectUniqueID field is optional}
269    \textcolor{keywordflow}{if}(n > 0)
270    \{
271       \textcolor{comment}{//This field must only appear if the version is 2 or 3}
272       \textcolor{keywordflow}{if}(tbsCert->\hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
273          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
274    \}
275 
276    \textcolor{comment}{//Point to the next field}
277    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
278    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
279 
280    \textcolor{comment}{//Parse Extensions field}
281    error = \hyperlink{certificate_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}{x509ParseExtensions}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &tbsCert->
      \hyperlink{structX509TbsCertificate_aa60d8b8a952d01fd8de02c2da091563e}{extensions});
282    \textcolor{comment}{//Any parsing error?}
283    \textcolor{keywordflow}{if}(error)
284       \textcolor{keywordflow}{return} error;
285 
286    \textcolor{comment}{//The Extensions field is optional}
287    \textcolor{keywordflow}{if}(n > 0)
288    \{
289       \textcolor{comment}{//This field must only appear if the version is 3}
290       \textcolor{keywordflow}{if}(tbsCert->\hyperlink{structX509TbsCertificate_a651e18b39b7492e6e739823ea19129d9}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26addaa01d4830baa29e7e19044f0a656eb}{X509\_VERSION\_3})
291          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
292    \}
293 
294    \textcolor{comment}{//No error to report}
295    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
296 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_ae0100508f7e094fffc624414f40f932e}\label{pkix_2x509__cert__parse_8h_ae0100508f7e094fffc624414f40f932e}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Time@{x509\+Parse\+Time}}
\index{x509\+Parse\+Time@{x509\+Parse\+Time}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Time()}{x509ParseTime()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Time (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structDateTime}{Date\+Time} $\ast$}]{date\+Time }\end{DoxyParamCaption})}



Parse U\+T\+C\+Time or Generalized\+Time field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em date\+Time} & date resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 913 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
915 \{
916    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
917    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
918    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
919 
920    \textcolor{comment}{//Debug message}
921    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing Time...\(\backslash\)r\(\backslash\)n"});
922 
923    \textcolor{comment}{//Read current ASN.1 tag}
924    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
925    \textcolor{comment}{//Failed to decode ASN.1 tag?}
926    \textcolor{keywordflow}{if}(error)
927       \textcolor{keywordflow}{return} error;
928 
929    \textcolor{comment}{//Save the total length of the field}
930    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
931 
932    \textcolor{comment}{//The date may be encoded as UTCTime or GeneralizedTime}
933    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9f9c0acd29e300911008f2f14d38603d}{ASN1\_TYPE\_UTC\_TIME}))
934    \{
935       \textcolor{comment}{//Check the length of the UTCTime field}
936       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 13)
937          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
938 
939       \textcolor{comment}{//The UTCTime uses a 2-digit representation of the year}
940       error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, 2, &value);
941       \textcolor{comment}{//Any error to report?}
942       \textcolor{keywordflow}{if}(error)
943          \textcolor{keywordflow}{return} error;
944 
945       \textcolor{comment}{//If YY is greater than or equal to 50, the year shall be interpreted}
946       \textcolor{comment}{//as 19YY. If YY is less than 50, the year shall be interpreted as 20YY}
947       \textcolor{keywordflow}{if}(value >= 50)
948          dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 1900 + \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
949       \textcolor{keywordflow}{else}
950          dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 2000 + \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
951 
952       \textcolor{comment}{//Point to the next field}
953       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 2;
954    \}
955    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa27cd934568bfa45864e37d5ba434b3f9}{ASN1\_TYPE\_GENERALIZED\_TIME}))
956    \{
957       \textcolor{comment}{//Check the length of the GeneralizedTime field}
958       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 15)
959          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
960 
961       \textcolor{comment}{//The GeneralizedTime uses a 4-digit representation of the year}
962       error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, 4, &value);
963       \textcolor{comment}{//Any error to report?}
964       \textcolor{keywordflow}{if}(error)
965          \textcolor{keywordflow}{return} error;
966 
967       \textcolor{comment}{//Save the resulting value}
968       dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
969 
970       \textcolor{comment}{//Point to the next field}
971       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 4;
972    \}
973    \textcolor{keywordflow}{else}
974    \{
975       \textcolor{comment}{//The tag does not contain a valid date}
976       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
977    \}
978 
979    \textcolor{comment}{//Month}
980    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 2, &value);
981    \textcolor{comment}{//Any error to report?}
982    \textcolor{keywordflow}{if}(error)
983       \textcolor{keywordflow}{return} error;
984 
985    \textcolor{comment}{//Save the resulting value}
986    dateTime->\hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
987 
988    \textcolor{comment}{//Day}
989    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 2, 2, &value);
990    \textcolor{comment}{//Any error to report?}
991    \textcolor{keywordflow}{if}(error)
992       \textcolor{keywordflow}{return} error;
993 
994    \textcolor{comment}{//Save the resulting value}
995    dateTime->\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
996 
997    \textcolor{comment}{//Hours}
998    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 4, 2, &value);
999    \textcolor{comment}{//Any error to report?}
1000    \textcolor{keywordflow}{if}(error)
1001       \textcolor{keywordflow}{return} error;
1002 
1003    \textcolor{comment}{//Save the resulting value}
1004    dateTime->\hyperlink{structDateTime_a46fa4e0c13c7fc19c8ae97a5642c4a15}{hours} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1005 
1006    \textcolor{comment}{//Minutes}
1007    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 6, 2, &value);
1008    \textcolor{comment}{//Any error to report?}
1009    \textcolor{keywordflow}{if}(error)
1010       \textcolor{keywordflow}{return} error;
1011 
1012    \textcolor{comment}{//Save the resulting value}
1013    dateTime->\hyperlink{structDateTime_a9e705a28fc51e333616553313107d579}{minutes} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1014 
1015    \textcolor{comment}{//Seconds}
1016    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 8, 2, &value);
1017    \textcolor{comment}{//Any error to report?}
1018    \textcolor{keywordflow}{if}(error)
1019       \textcolor{keywordflow}{return} error;
1020 
1021    \textcolor{comment}{//The encoding shall terminate with a "Z"}
1022    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[10] != \textcolor{charliteral}{'Z'})
1023       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1024 
1025    \textcolor{comment}{//Save the resulting value}
1026    dateTime->\hyperlink{structDateTime_a428828f757146b36432b4669e8b27eeb}{seconds} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1027 
1028    \textcolor{comment}{//Milliseconds}
1029    dateTime->\hyperlink{structDateTime_a8b3982e7347da9a62c2bfc6c273da909}{milliseconds} = 0;
1030 
1031    \textcolor{comment}{//UTCTime or GeneralizedTime field successfully parsed}
1032    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1033 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a13716132dba34d3a3fb8321d1355c6d1}\label{pkix_2x509__cert__parse_8h_a13716132dba34d3a3fb8321d1355c6d1}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Validity@{x509\+Parse\+Validity}}
\index{x509\+Parse\+Validity@{x509\+Parse\+Validity}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Validity()}{x509ParseValidity()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Validity (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Validity}{X509\+Validity} $\ast$}]{validity }\end{DoxyParamCaption})}



Parse Validity structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em validity} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 860 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
862 \{
863    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
864    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
865    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
866 
867    \textcolor{comment}{//Debug message}
868    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Validity...\(\backslash\)r\(\backslash\)n"});
869 
870    \textcolor{comment}{//Read the contents of the Validity structure}
871    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
872    \textcolor{comment}{//Failed to decode ASN.1 tag?}
873    \textcolor{keywordflow}{if}(error)
874       \textcolor{keywordflow}{return} error;
875 
876    \textcolor{comment}{//Save the total length of the field}
877    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
878 
879    \textcolor{comment}{//Point to the very first field of the sequence}
880    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
881    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
882 
883    \textcolor{comment}{//The NotBefore field may be encoded as UTCTime or GeneralizedTime}
884    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &validity->
      \hyperlink{structX509Validity_a54d94f88fced1072aaacb4824757aee0}{notBefore});
885    \textcolor{comment}{//Failed to decode ASN.1 tag?}
886    \textcolor{keywordflow}{if}(error)
887       \textcolor{keywordflow}{return} error;
888 
889    \textcolor{comment}{//Point to the next field}
890    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
891    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
892 
893    \textcolor{comment}{//The NotAfter field may be encoded as UTCTime or GeneralizedTime}
894    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &validity->
      \hyperlink{structX509Validity_a23debc3797b2921431fce9658ecc1b73}{notAfter});
895    \textcolor{comment}{//Failed to decode ASN.1 tag?}
896    \textcolor{keywordflow}{if}(error)
897       \textcolor{keywordflow}{return} error;
898 
899    \textcolor{comment}{//Validity field successfully parsed}
900    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
901 \}
\end{DoxyCode}
\mbox{\Hypertarget{pkix_2x509__cert__parse_8h_a6bb8c9cd7914a755f55796fb888aa2df}\label{pkix_2x509__cert__parse_8h_a6bb8c9cd7914a755f55796fb888aa2df}} 
\index{pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}!x509\+Parse\+Version@{x509\+Parse\+Version}}
\index{x509\+Parse\+Version@{x509\+Parse\+Version}!pkix/x509\+\_\+cert\+\_\+parse.\+h@{pkix/x509\+\_\+cert\+\_\+parse.\+h}}
\subsubsection{\texorpdfstring{x509\+Parse\+Version()}{x509ParseVersion()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Version (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$}]{version }\end{DoxyParamCaption})}



Parse Version field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em version} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 293 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
295 \{
296    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
297    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
298    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
299 
300    \textcolor{comment}{//Debug message}
301    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Version...\(\backslash\)r\(\backslash\)n"});
302 
303    \textcolor{comment}{//Explicit tagging shall be used to encode version}
304    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
305    \textcolor{comment}{//Failed to decode ASN.1 tag?}
306    \textcolor{keywordflow}{if}(error)
307       \textcolor{keywordflow}{return} error;
308 
309    \textcolor{comment}{//Enforce encoding, class and type}
310    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       0);
311 
312    \textcolor{comment}{//Invalid tag?}
313    \textcolor{keywordflow}{if}(error)
314    \{
315       \textcolor{comment}{//Assume X.509 version 1 format}
316       *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26a146bf525f16981660f60fd6c0bdeeee7}{X509\_VERSION\_1};
317       \textcolor{comment}{//Skip the current field}
318       *totalLength = 0;
319 
320       \textcolor{comment}{//Exit immediately}
321       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
322    \}
323 
324    \textcolor{comment}{//Save the total length of the field}
325    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
326 
327    \textcolor{comment}{//Read the inner tag}
328    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag, &value);
329    \textcolor{comment}{//Failed to decode ASN.1 tag?}
330    \textcolor{keywordflow}{if}(error)
331       \textcolor{keywordflow}{return} error;
332 
333    \textcolor{comment}{//Check version field}
334    \textcolor{keywordflow}{if}(value > \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26addaa01d4830baa29e7e19044f0a656eb}{X509\_VERSION\_3})
335       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
336 
337    \textcolor{comment}{//Save certificate version}
338    *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = (\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509Version}) value;
339 
340    \textcolor{comment}{//No error to report}
341    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
342 \}
\end{DoxyCode}
