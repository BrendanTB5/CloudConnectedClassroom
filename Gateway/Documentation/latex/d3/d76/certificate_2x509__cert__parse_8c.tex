\hypertarget{certificate_2x509__cert__parse_8c}{}\section{cyclone\+\_\+crypto/certificate/x509\+\_\+cert\+\_\+parse.c File Reference}
\label{certificate_2x509__cert__parse_8c}\index{cyclone\+\_\+crypto/certificate/x509\+\_\+cert\+\_\+parse.\+c@{cyclone\+\_\+crypto/certificate/x509\+\_\+cert\+\_\+parse.\+c}}
{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}certificate/x509\+\_\+cert\+\_\+parse.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/asn1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}encoding/oid.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkc/rsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}pkc/dsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/ecdsa.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/md5.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha224.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha256.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha384.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/sha512.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{certificate_2x509__cert__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a0c8997b0f608c1fee25bdd281e7c4acb}{x509\+Parse\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$cert\+Info)
\begin{DoxyCompactList}\small\item\em Parse a X.\+509 certificate. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_aa7675ee05506115f9b21a18385282630}{x509\+Parse\+Tbs\+Certificate} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$cert\+Info)
\begin{DoxyCompactList}\small\item\em Parse T\+B\+S\+Certificate structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}{x509\+Parse\+Version} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$\hyperlink{coap__common_8h_ab22abc2906422da61885ac6c8e6a1a59}{version})
\begin{DoxyCompactList}\small\item\em Parse Version field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}{x509\+Parse\+Serial\+Number} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SerialNumber}{X509\+Serial\+Number} $\ast$serial\+Number)
\begin{DoxyCompactList}\small\item\em Parse Serial\+Number field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a1772db63e91fc1e65e14931e67a7e084}{x509\+Parse\+Signature} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$\hyperlink{tls_8h_af27e6d4ea3add14cd8cc9aa275d716ad}{signature})
\begin{DoxyCompactList}\small\item\em Parse Signature field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_aad327c7f3da9180fbf94b8e4363bda40}{x509\+Parse\+Rsa\+Pss\+Parameters} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a695e24dfcc2e5669cb0ad6068298ce3f}{x509\+Parse\+Rsa\+Pss\+Hash\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS hash algorithm. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_aa9f385740a40d71e149e795c3bb3e4e0}{x509\+Parse\+Rsa\+Pss\+Salt\+Length} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$rsa\+Pss\+Params)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+S\+S\+A-\/\+P\+SS salt length. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509\+Parse\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Name}{X509\+Name} $\ast$\hyperlink{resource__manager_8h_a26532d7194d592ae8da35222073f36d6}{name})
\begin{DoxyCompactList}\small\item\em Parse Name structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}{x509\+Parse\+Name\+Attribute} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509NameAttribute}{X509\+Name\+Attribute} $\ast$name\+Attribute)
\begin{DoxyCompactList}\small\item\em Parse name attribute. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}{x509\+Parse\+Validity} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Validity}{X509\+Validity} $\ast$validity)
\begin{DoxyCompactList}\small\item\em Parse Validity structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509\+Parse\+Time} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structDateTime}{Date\+Time} $\ast$date\+Time)
\begin{DoxyCompactList}\small\item\em Parse U\+T\+C\+Time or Generalized\+Time field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}{x509\+Parse\+Subject\+Public\+Key\+Info} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$subject\+Public\+Key\+Info)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Public\+Key\+Info structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a2de67fd41226a162fa5f3fb14539108f}{x509\+Parse\+Algorithm\+Identifier} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$subject\+Public\+Key\+Info)
\begin{DoxyCompactList}\small\item\em Parse Algorithm\+Identifier structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}{x509\+Parse\+Rsa\+Public\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509RsaPublicKey}{X509\+Rsa\+Public\+Key} $\ast$rsa\+Public\+Key)
\begin{DoxyCompactList}\small\item\em Parse R\+S\+A\+Public\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_afa7c44bc9c776d4bdb4a03519ef894a5}{x509\+Parse\+Dsa\+Parameters} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509DsaParameters}{X509\+Dsa\+Parameters} $\ast$dsa\+Params)
\begin{DoxyCompactList}\small\item\em Parse D\+SA domain parameters. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a3d52f72e0b1285700bcc30b5b6b54ac1}{x509\+Parse\+Dsa\+Public\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509DsaPublicKey}{X509\+Dsa\+Public\+Key} $\ast$dsa\+Public\+Key)
\begin{DoxyCompactList}\small\item\em Parse D\+S\+A\+Public\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}{x509\+Parse\+Ec\+Parameters} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$ec\+Params)
\begin{DoxyCompactList}\small\item\em Parse E\+C\+Parameters structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509\+Parse\+Ec\+Public\+Key} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509EcPublicKey}{X509\+Ec\+Public\+Key} $\ast$ec\+Public\+Key)
\begin{DoxyCompactList}\small\item\em Parse E\+C\+Public\+Key structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}{x509\+Parse\+Issuer\+Unique\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length)
\begin{DoxyCompactList}\small\item\em Parse Issuer\+Unique\+ID structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}{x509\+Parse\+Subject\+Unique\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Unique\+ID structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}{x509\+Parse\+Extensions} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Extensions}{X509\+Extensions} $\ast$\hyperlink{tls13__misc_8h_a7b8cc84c920376c616d85d575080d28e}{extensions})
\begin{DoxyCompactList}\small\item\em Parse X.\+509 certificate extensions. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509\+Parse\+Extension} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509Extension}{X509\+Extension} $\ast$extension)
\begin{DoxyCompactList}\small\item\em Parse X.\+509 certificate extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}{x509\+Parse\+Basic\+Constraints} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509BasicConstraints}{X509\+Basic\+Constraints} $\ast$basic\+Constraints)
\begin{DoxyCompactList}\small\item\em Parse Basic\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}{x509\+Parse\+Name\+Constraints} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509NameConstraints}{X509\+Name\+Constraints} $\ast$name\+Constraints)
\begin{DoxyCompactList}\small\item\em Parse Name\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a69067e7a8941f2329cbbb3e3a1413887}{x509\+Parse\+Policy\+Constraints} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Policy\+Constraints extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a71cf108498b2a57b5306de9f005f5a96}{x509\+Parse\+Policy\+Mappings} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Policy\+Mappings extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_ade6829856343b371abc479c340c3175b}{x509\+Parse\+Inhibit\+Any\+Policy} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse Inhibit\+Any\+Policy extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}{x509\+Parse\+Key\+Usage} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$key\+Usage)
\begin{DoxyCompactList}\small\item\em Parse Key\+Usage extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}{x509\+Parse\+Extended\+Key\+Usage} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ext\+Key\+Usage)
\begin{DoxyCompactList}\small\item\em Parse Extended\+Key\+Usage extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}{x509\+Parse\+Subject\+Alt\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509SubjectAltName}{X509\+Subject\+Alt\+Name} $\ast$subject\+Alt\+Name)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Alt\+Name extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509\+Parse\+General\+Subtrees} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Parse General\+Subtrees field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}{x509\+Parse\+General\+Subtree} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$general\+Name)
\begin{DoxyCompactList}\small\item\em Parse General\+Subtree field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509\+Parse\+General\+Name} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$general\+Name)
\begin{DoxyCompactList}\small\item\em Parse General\+Name field. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}{x509\+Parse\+Subject\+Key\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509SubjectKeyId}{X509\+Subject\+Key\+Id} $\ast$subject\+Key\+Id)
\begin{DoxyCompactList}\small\item\em Parse Subject\+Key\+Identifier extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}{x509\+Parse\+Authority\+Key\+Id} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{structX509AuthorityKeyId}{X509\+Authority\+Key\+Id} $\ast$authority\+Key\+Id)
\begin{DoxyCompactList}\small\item\em Parse Authority\+Key\+Identifier extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}{x509\+Parse\+Ns\+Cert\+Type} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$ns\+Cert\+Type)
\begin{DoxyCompactList}\small\item\em Parse Netscape\+Cert\+Type extension. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509\+Parse\+Signature\+Algo} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$signature\+Algo)
\begin{DoxyCompactList}\small\item\em Parse Signature\+Algorithm structure. \end{DoxyCompactList}\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509\+Parse\+Signature\+Value} (const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, size\+\_\+t $\ast$total\+Length, \hyperlink{structX509SignatureValue}{X509\+Signature\+Value} $\ast$signature\+Value)
\begin{DoxyCompactList}\small\item\em Parse Signature\+Value field. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{certificate_2x509__cert__parse_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file x509\+\_\+cert\+\_\+parse.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a2de67fd41226a162fa5f3fb14539108f}\label{certificate_2x509__cert__parse_8c_a2de67fd41226a162fa5f3fb14539108f}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Algorithm\+Identifier@{x509\+Parse\+Algorithm\+Identifier}}
\index{x509\+Parse\+Algorithm\+Identifier@{x509\+Parse\+Algorithm\+Identifier}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Algorithm\+Identifier()}{x509ParseAlgorithmIdentifier()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Algorithm\+Identifier (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{subject\+Public\+Key\+Info }\end{DoxyParamCaption})}



Parse Algorithm\+Identifier structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em subject\+Public\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1187 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1189 \{
1190    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1191    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1192 
1193    \textcolor{comment}{//Debug message}
1194    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing AlgorithmIdentifier...\(\backslash\)r\(\backslash\)n"});
1195 
1196    \textcolor{comment}{//Read AlgorithmIdentifier field}
1197    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1198    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1199    \textcolor{keywordflow}{if}(error)
1200       \textcolor{keywordflow}{return} error;
1201 
1202    \textcolor{comment}{//Save the total length of the field}
1203    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1204 
1205    \textcolor{comment}{//Point to the first field}
1206    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1207    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1208 
1209    \textcolor{comment}{//Read algorithm identifier (OID)}
1210    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1211    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1212    \textcolor{keywordflow}{if}(error)
1213       \textcolor{keywordflow}{return} error;
1214 
1215    \textcolor{comment}{//Save the algorithm identifier}
1216    subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1217    subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1218 
1219    \textcolor{comment}{//Point to the next field (if any)}
1220    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1221    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1222 
1223 \textcolor{preprocessor}{#if (X509\_RSA\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1224    \textcolor{comment}{//RSA algorithm identifier?}
1225    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})))
1226    \{
1227       \textcolor{comment}{//RSA does not require any additional parameters}
1228       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1229    \}
1230    \textcolor{keywordflow}{else}
1231 \textcolor{preprocessor}{#endif}
1232 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1233    \textcolor{comment}{//RSA-PSS algorithm identifier?}
1234    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
1235    \{
1236       \textcolor{comment}{//RSA-PSS does not require any additional parameters}
1237       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1238    \}
1239    \textcolor{keywordflow}{else}
1240 \textcolor{preprocessor}{#endif}
1241 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1242    \textcolor{comment}{//DSA algorithm identifier?}
1243    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
1244    \{
1245       \textcolor{comment}{//Read DsaParameters structure}
1246       error = \hyperlink{certificate_2x509__cert__parse_8c_afa7c44bc9c776d4bdb4a03519ef894a5}{x509ParseDsaParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
1247          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a2a4f7c14413231aa4a09a59390b4f6c0}{dsaParams});
1248    \}
1249    \textcolor{keywordflow}{else}
1250 \textcolor{preprocessor}{#endif}
1251 \textcolor{preprocessor}{#if (X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED)}
1252    \textcolor{comment}{//EC public key identifier?}
1253    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
1254    \{
1255       \textcolor{comment}{//Read ECParameters structure}
1256       error = \hyperlink{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}{x509ParseEcParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length},
1257          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af45ca47e19db60631c9fdb4d4b62ed10}{ecParams});
1258    \}
1259    \textcolor{keywordflow}{else}
1260 \textcolor{preprocessor}{#endif}
1261 \textcolor{preprocessor}{#if (X509\_ED25519\_SUPPORT == ENABLED && ED25519\_SUPPORT == ENABLED)}
1262    \textcolor{comment}{//X25519 or Ed25519 algorithm identifier?}
1263    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID})) ||
1264       !\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
1265    \{
1266       \textcolor{comment}{//For all of the OIDs, the parameters are absent}
1267       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1268    \}
1269    \textcolor{keywordflow}{else}
1270 \textcolor{preprocessor}{#endif}
1271 \textcolor{preprocessor}{#if (X509\_ED448\_SUPPORT == ENABLED && ED448\_SUPPORT == ENABLED)}
1272    \textcolor{comment}{//X448 or Ed448 algorithm identifier?}
1273    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID})) ||
1274       !\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
1275    \{
1276       \textcolor{comment}{//For all of the OIDs, the parameters are absent}
1277       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1278    \}
1279    \textcolor{keywordflow}{else}
1280 \textcolor{preprocessor}{#endif}
1281    \textcolor{comment}{//The certificate does not contain any valid public key...}
1282    \{
1283       \textcolor{comment}{//Report an error}
1284       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
1285    \}
1286 
1287    \textcolor{comment}{//Return status code}
1288    \textcolor{keywordflow}{return} error;
1289 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}\label{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Authority\+Key\+Id@{x509\+Parse\+Authority\+Key\+Id}}
\index{x509\+Parse\+Authority\+Key\+Id@{x509\+Parse\+Authority\+Key\+Id}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Authority\+Key\+Id()}{x509ParseAuthorityKeyId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Authority\+Key\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509AuthorityKeyId}{X509\+Authority\+Key\+Id} $\ast$}]{authority\+Key\+Id }\end{DoxyParamCaption})}



Parse Authority\+Key\+Identifier extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em authority\+Key\+Id} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2620 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2622 \{
2623    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2624    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2625 
2626    \textcolor{comment}{//Debug message}
2627    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing AuthorityKeyIdentifier...\(\backslash\)r\(\backslash\)n"});
2628 
2629    \textcolor{comment}{//The AuthorityKeyIdentifier structure shall contain a valid sequence}
2630    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2631    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2632    \textcolor{keywordflow}{if}(error)
2633       \textcolor{keywordflow}{return} error;
2634 
2635    \textcolor{comment}{//Point to the first item of the sequence}
2636    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2637    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2638 
2639    \textcolor{comment}{//Parse the content of the sequence}
2640    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2641    \{
2642       \textcolor{comment}{//Read current item}
2643       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2644       \textcolor{comment}{//Failed to decode ASN.1 tag?}
2645       \textcolor{keywordflow}{if}(error)
2646          \textcolor{keywordflow}{return} error;
2647 
2648       \textcolor{comment}{//Explicit tagging shall be used to encode the authority key identifier}
2649       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
2650          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
2651 
2652       \textcolor{comment}{//keyIdentifier object found?}
2653       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
2654       \{
2655          \textcolor{comment}{//Save the authority key identifier}
2656          authorityKeyId->\hyperlink{structX509AuthorityKeyId_a8d58117612a6a39683f7dac0454d41bb}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2657          authorityKeyId->\hyperlink{structX509AuthorityKeyId_ad786e919eade63c0dd214834c7c0728b}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2658       \}
2659 
2660       \textcolor{comment}{//Next item}
2661       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2662       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2663    \}
2664 
2665    \textcolor{comment}{//Successful processing}
2666    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2667 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}\label{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Basic\+Constraints@{x509\+Parse\+Basic\+Constraints}}
\index{x509\+Parse\+Basic\+Constraints@{x509\+Parse\+Basic\+Constraints}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Basic\+Constraints()}{x509ParseBasicConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Basic\+Constraints (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509BasicConstraints}{X509\+Basic\+Constraints} $\ast$}]{basic\+Constraints }\end{DoxyParamCaption})}



Parse Basic\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em basic\+Constraints} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1971 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1973 \{
1974    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1975    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1976    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1977 
1978    \textcolor{comment}{//Debug message}
1979    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing BasicConstraints...\(\backslash\)r\(\backslash\)n"});
1980 
1981    \textcolor{comment}{//The BasicConstraints structure shall contain a valid sequence}
1982    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1983    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1984    \textcolor{keywordflow}{if}(error)
1985       \textcolor{keywordflow}{return} error;
1986 
1987    \textcolor{comment}{//Point to the first item of the sequence}
1988    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1989    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1990 
1991    \textcolor{comment}{//The cA field is optional}
1992    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1993    \{
1994       \textcolor{comment}{//The cA boolean indicates whether the certified public key may be used}
1995       \textcolor{comment}{//to verify certificate signatures}
1996       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1997       \textcolor{comment}{//Failed to decode ASN.1 tag?}
1998       \textcolor{keywordflow}{if}(error)
1999          \textcolor{keywordflow}{return} error;
2000 
2001       \textcolor{comment}{//Enforce encoding, class and type}
2002       error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa6e8bd3d6d3cfdc39ccc2891743560462}{ASN1\_TYPE\_BOOLEAN});
2003 
2004       \textcolor{comment}{//Check status code}
2005       \textcolor{keywordflow}{if}(!error)
2006       \{
2007          \textcolor{comment}{//Make sure the length of the boolean is valid}
2008          \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
2009             \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
2010 
2011          \textcolor{comment}{//Get boolean value}
2012          basicConstraints->\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2013 
2014          \textcolor{comment}{//Point to the next item}
2015          \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2016          \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2017       \}
2018    \}
2019 
2020    \textcolor{comment}{//The pathLenConstraint field is optional}
2021    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2022    \{
2023       \textcolor{comment}{//Read the pathLenConstraint field}
2024       error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &value);
2025       \textcolor{comment}{//Failed to decode ASN.1 tag?}
2026       \textcolor{keywordflow}{if}(error)
2027          \textcolor{keywordflow}{return} error;
2028 
2029       \textcolor{comment}{//The pathLenConstraint field is meaningful only if the cA boolean is}
2030       \textcolor{comment}{//asserted (refer to RFC 5280, section 4.2.1.9)}
2031       \textcolor{keywordflow}{if}(!basicConstraints->\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA})
2032          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2033 
2034       \textcolor{comment}{//Where it appears, the pathLenConstraint field must be greater than or}
2035       \textcolor{comment}{//equal to zero (refer to RFC 5280, section 4.2.1.9)}
2036       \textcolor{keywordflow}{if}(value < 0)
2037          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2038 
2039       \textcolor{comment}{//The pathLenConstraint field gives the maximum number of non-self-issued}
2040       \textcolor{comment}{//intermediate certificates that may follow this certificate in a valid}
2041       \textcolor{comment}{//certification path}
2042       basicConstraints->\hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
2043    \}
2044 
2045    \textcolor{comment}{//Successful processing}
2046    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2047 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a0c8997b0f608c1fee25bdd281e7c4acb}\label{certificate_2x509__cert__parse_8c_a0c8997b0f608c1fee25bdd281e7c4acb}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Certificate@{x509\+Parse\+Certificate}}
\index{x509\+Parse\+Certificate@{x509\+Parse\+Certificate}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Certificate()}{x509ParseCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$}]{cert\+Info }\end{DoxyParamCaption})}



Parse a X.\+509 certificate. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the X.\+509 certificate to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the X.\+509 certificate \\
\hline
\mbox{\tt out}  & {\em cert\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 62 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
64 \{
65    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
66    \textcolor{keywordtype}{size\_t} totalLength;
67    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
68 
69    \textcolor{comment}{//Debug message}
70    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"Parsing X.509 certificate...\(\backslash\)r\(\backslash\)n"});
71 
72    \textcolor{comment}{//Clear the certificate information structure}
73    \hyperlink{cyclone__crypto_2core_2crypto_8h_ad4465436e4ff353300fba4896012e18b}{cryptoMemset}(certInfo, 0, \textcolor{keyword}{sizeof}(\hyperlink{structX509CertificateInfo}{X509CertificateInfo}));
74 
75    \textcolor{comment}{//Where pathLenConstraint does not appear, no limit is imposed}
76    certInfo->\hyperlink{structX509CertificateInfo_a6fbc847cf3a3459834fae3c4ece76297}{extensions}.\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.
      \hyperlink{structX509BasicConstraints_a13c129a1b79a0a489604e28d69dd0950}{pathLenConstraint} = -1;
77 
78    \textcolor{comment}{//Read the contents of the certificate}
79    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
80    \textcolor{comment}{//Failed to decode ASN.1 tag?}
81    \textcolor{keywordflow}{if}(error)
82       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
83 
84    \textcolor{comment}{//Point to the very first field}
85    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
86    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
87 
88    \textcolor{comment}{//Parse TBSCertificate structure}
89    error = \hyperlink{certificate_2x509__cert__parse_8c_aa7675ee05506115f9b21a18385282630}{x509ParseTbsCertificate}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength, certInfo);
90    \textcolor{comment}{//Any error to report?}
91    \textcolor{keywordflow}{if}(error)
92       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
93 
94    \textcolor{comment}{//Point to the next field}
95    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
96    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
97 
98    \textcolor{comment}{//Parse SignatureAlgorithm structure}
99    error = \hyperlink{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}{x509ParseSignatureAlgo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
100       &certInfo->\hyperlink{structX509CertificateInfo_a557f43736fe7dab190eac1cd31559281}{signatureAlgo});
101    \textcolor{comment}{//Any error to report?}
102    \textcolor{keywordflow}{if}(error)
103       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
104 
105    \textcolor{comment}{//Point to the next field}
106    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += totalLength;
107    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= totalLength;
108 
109    \textcolor{comment}{//Parse SignatureValue structure}
110    error = \hyperlink{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}{x509ParseSignatureValue}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &totalLength,
111       &certInfo->\hyperlink{structX509CertificateInfo_a14aae7b8131fdc0d1cae4ccc6be1f02d}{signatureValue});
112    \textcolor{comment}{//Any error to report?}
113    \textcolor{keywordflow}{if}(error)
114       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
115 
116    \textcolor{comment}{//Certificate successfully parsed}
117    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
118 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_afa7c44bc9c776d4bdb4a03519ef894a5}\label{certificate_2x509__cert__parse_8c_afa7c44bc9c776d4bdb4a03519ef894a5}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Dsa\+Parameters@{x509\+Parse\+Dsa\+Parameters}}
\index{x509\+Parse\+Dsa\+Parameters@{x509\+Parse\+Dsa\+Parameters}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Dsa\+Parameters()}{x509ParseDsaParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Dsa\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509DsaParameters}{X509\+Dsa\+Parameters} $\ast$}]{dsa\+Params }\end{DoxyParamCaption})}



Parse D\+SA domain parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em dsa\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1373 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1375 \{
1376 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1377    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1378    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1379 
1380    \textcolor{comment}{//Debug message}
1381    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing DSAParameters...\(\backslash\)r\(\backslash\)n"});
1382 
1383    \textcolor{comment}{//Read DSAParameters structure}
1384    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1385    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1386    \textcolor{keywordflow}{if}(error)
1387       \textcolor{keywordflow}{return} error;
1388 
1389    \textcolor{comment}{//Point to the first field}
1390    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1391    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1392 
1393    \textcolor{comment}{//Read the parameter p}
1394    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1395    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1396    \textcolor{keywordflow}{if}(error)
1397       \textcolor{keywordflow}{return} error;
1398 
1399    \textcolor{comment}{//Enforce encoding, class and type}
1400    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1401    \textcolor{comment}{//Invalid tag?}
1402    \textcolor{keywordflow}{if}(error)
1403       \textcolor{keywordflow}{return} error;
1404 
1405    \textcolor{comment}{//Save the parameter p}
1406    dsaParams->\hyperlink{structX509DsaParameters_adf55df7def4d98995045e1c23e995cde}{p} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1407    dsaParams->\hyperlink{structX509DsaParameters_a492453aa50210c40372c6d76ff955c7f}{pLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1408 
1409    \textcolor{comment}{//Point to the next field}
1410    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1411    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1412 
1413    \textcolor{comment}{//Read the parameter q}
1414    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1415    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1416    \textcolor{keywordflow}{if}(error)
1417       \textcolor{keywordflow}{return} error;
1418 
1419    \textcolor{comment}{//Enforce encoding, class and type}
1420    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1421    \textcolor{comment}{//Invalid tag?}
1422    \textcolor{keywordflow}{if}(error)
1423       \textcolor{keywordflow}{return} error;
1424 
1425    \textcolor{comment}{//Save the parameter q}
1426    dsaParams->\hyperlink{structX509DsaParameters_a8d55a808e46108ce0b7c2af09926f913}{q} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1427    dsaParams->\hyperlink{structX509DsaParameters_a2cb0e6cf41cb0b07dfccedc79bce007e}{qLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1428 
1429    \textcolor{comment}{//Point to the next field}
1430    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1431    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1432 
1433    \textcolor{comment}{//Read the parameter g}
1434    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1435    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1436    \textcolor{keywordflow}{if}(error)
1437       \textcolor{keywordflow}{return} error;
1438 
1439    \textcolor{comment}{//Enforce encoding, class and type}
1440    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1441    \textcolor{comment}{//Invalid tag?}
1442    \textcolor{keywordflow}{if}(error)
1443       \textcolor{keywordflow}{return} error;
1444 
1445    \textcolor{comment}{//Save the parameter g}
1446    dsaParams->\hyperlink{structX509DsaParameters_ae79dacfe9617adf9d672aa48fe40a3ea}{g} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1447    dsaParams->\hyperlink{structX509DsaParameters_a84e6f3a0159da3fff5bf9315be4cf5f7}{gLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1448 
1449    \textcolor{comment}{//Successful processing}
1450    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1451 \textcolor{preprocessor}{#else}
1452    \textcolor{comment}{//Not implemented}
1453    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1454 \textcolor{preprocessor}{#endif}
1455 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a3d52f72e0b1285700bcc30b5b6b54ac1}\label{certificate_2x509__cert__parse_8c_a3d52f72e0b1285700bcc30b5b6b54ac1}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Dsa\+Public\+Key@{x509\+Parse\+Dsa\+Public\+Key}}
\index{x509\+Parse\+Dsa\+Public\+Key@{x509\+Parse\+Dsa\+Public\+Key}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Dsa\+Public\+Key()}{x509ParseDsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Dsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509DsaPublicKey}{X509\+Dsa\+Public\+Key} $\ast$}]{dsa\+Public\+Key }\end{DoxyParamCaption})}



Parse D\+S\+A\+Public\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em dsa\+Public\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1466 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1468 \{
1469 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1470    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1471    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1472 
1473    \textcolor{comment}{//Debug message}
1474    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing DSAPublicKey...\(\backslash\)r\(\backslash\)n"});
1475 
1476    \textcolor{comment}{//Read DSAPublicKey structure}
1477    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1478    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1479    \textcolor{keywordflow}{if}(error)
1480       \textcolor{keywordflow}{return} error;
1481 
1482    \textcolor{comment}{//Enforce encoding, class and type}
1483    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1484    \textcolor{comment}{//Invalid tag?}
1485    \textcolor{keywordflow}{if}(error)
1486       \textcolor{keywordflow}{return} error;
1487 
1488    \textcolor{comment}{//Save the DSA public value}
1489    dsaPublicKey->\hyperlink{structX509DsaPublicKey_a8a2e4dd10c344dfeae0d55487b2bfce8}{y} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1490    dsaPublicKey->\hyperlink{structX509DsaPublicKey_ae8ad5e10e6090c0b95a083b49efe18b2}{yLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1491 
1492    \textcolor{comment}{//Successful processing}
1493    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1494 \textcolor{preprocessor}{#else}
1495    \textcolor{comment}{//Not implemented}
1496    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1497 \textcolor{preprocessor}{#endif}
1498 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}\label{certificate_2x509__cert__parse_8c_a2caeec4d90cfecef949ee31dcaefaf83}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Ec\+Parameters@{x509\+Parse\+Ec\+Parameters}}
\index{x509\+Parse\+Ec\+Parameters@{x509\+Parse\+Ec\+Parameters}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ec\+Parameters()}{x509ParseEcParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ec\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509EcParameters}{X509\+Ec\+Parameters} $\ast$}]{ec\+Params }\end{DoxyParamCaption})}



Parse E\+C\+Parameters structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ec\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1509 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1511 \{
1512 \textcolor{preprocessor}{#if (X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED)}
1513    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1514    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1515 
1516    \textcolor{comment}{//Debug message}
1517    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing ECParameters...\(\backslash\)r\(\backslash\)n"});
1518 
1519    \textcolor{comment}{//Read namedCurve field}
1520    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1521    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1522    \textcolor{keywordflow}{if}(error)
1523       \textcolor{keywordflow}{return} error;
1524 
1525    \textcolor{comment}{//The namedCurve field identifies all the required values for a particular}
1526    \textcolor{comment}{//set of elliptic curve domain parameters to be represented by an object}
1527    \textcolor{comment}{//identifier}
1528    ecParams->\hyperlink{structX509EcParameters_a122c5387fb2f12374a905ecfd2ca4c86}{namedCurve} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1529    ecParams->\hyperlink{structX509EcParameters_ac58081bd63ed68d0cb101ff7e65667ec}{namedCurveLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1530 
1531    \textcolor{comment}{//Successful processing}
1532    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1533 \textcolor{preprocessor}{#else}
1534    \textcolor{comment}{//Not implemented}
1535    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1536 \textcolor{preprocessor}{#endif}
1537 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}\label{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Ec\+Public\+Key@{x509\+Parse\+Ec\+Public\+Key}}
\index{x509\+Parse\+Ec\+Public\+Key@{x509\+Parse\+Ec\+Public\+Key}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ec\+Public\+Key()}{x509ParseEcPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ec\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509EcPublicKey}{X509\+Ec\+Public\+Key} $\ast$}]{ec\+Public\+Key }\end{DoxyParamCaption})}



Parse E\+C\+Public\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ec\+Public\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1548 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1550 \{
1551 \textcolor{preprocessor}{#if ((X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED) || \(\backslash\)}
1552 \textcolor{preprocessor}{   (X509\_ED25519\_SUPPORT == ENABLED && ED25519\_SUPPORT == ENABLED) || \(\backslash\)}
1553 \textcolor{preprocessor}{   (X509\_ED448\_SUPPORT == ENABLED && ED448\_SUPPORT == ENABLED))}
1554    \textcolor{comment}{//Debug message}
1555    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ECPublicKey...\(\backslash\)r\(\backslash\)n"});
1556 
1557    \textcolor{comment}{//Make sure the EC public key is valid}
1558    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1559       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
1560 
1561    \textcolor{comment}{//Save the EC public key}
1562    ecPublicKey->\hyperlink{structX509EcPublicKey_a40d2e839059193580054d744529d0131}{q} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
1563    ecPublicKey->\hyperlink{structX509EcPublicKey_a62e05abdaa08ec4418a624e44b84a5b8}{qLen} = \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length};
1564 
1565    \textcolor{comment}{//Successful processing}
1566    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1567 \textcolor{preprocessor}{#else}
1568    \textcolor{comment}{//Not implemented}
1569    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1570 \textcolor{preprocessor}{#endif}
1571 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}\label{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Extended\+Key\+Usage@{x509\+Parse\+Extended\+Key\+Usage}}
\index{x509\+Parse\+Extended\+Key\+Usage@{x509\+Parse\+Extended\+Key\+Usage}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extended\+Key\+Usage()}{x509ParseExtendedKeyUsage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extended\+Key\+Usage (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ext\+Key\+Usage }\end{DoxyParamCaption})}



Parse Extended\+Key\+Usage extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ext\+Key\+Usage} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2293 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2295 \{
2296    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2297    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2298 
2299    \textcolor{comment}{//Debug message}
2300    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing ExtendedKeyUsage...\(\backslash\)r\(\backslash\)n"});
2301 
2302    \textcolor{comment}{//A certificate must not include more than one instance of a particular}
2303    \textcolor{comment}{//extension (refer to RFC 5280, section 4.2)}
2304    \textcolor{keywordflow}{if}(*extKeyUsage != 0)
2305       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2306 
2307    \textcolor{comment}{//The ExtendedKeyUsage structure shall contain a valid sequence}
2308    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2309    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2310    \textcolor{keywordflow}{if}(error)
2311       \textcolor{keywordflow}{return} error;
2312 
2313    \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.12)}
2314    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2315       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2316 
2317    \textcolor{comment}{//Point to the first item of the sequence}
2318    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2319    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2320 
2321    \textcolor{comment}{//This extension indicates one or more purposes for which the certified}
2322    \textcolor{comment}{//public key may be used}
2323    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2324    \{
2325       \textcolor{comment}{//Read KeyPurposeId field}
2326       error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2327       \textcolor{comment}{//Failed to decode ASN.1 tag?}
2328       \textcolor{keywordflow}{if}(error)
2329          \textcolor{keywordflow}{return} error;
2330 
2331       \textcolor{comment}{//anyExtendedKeyUsage?}
2332       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2333          \hyperlink{certificate_2x509__common_8c_a68a4a910638432512485a488e9a162cd}{X509\_ANY\_EXT\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a68a4a910638432512485a488e9a162cd}{X509\_ANY\_EXT\_KEY\_USAGE\_OID})))
2334       \{
2335          \textcolor{comment}{//If a CA includes extended key usages to satisfy such applications,}
2336          \textcolor{comment}{//but does not wish to restrict usages of the key, the CA can include}
2337          \textcolor{comment}{//the special KeyPurposeId anyExtendedKeyUsage}
2338          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca7b28befa17d32564de1990ba5b45e639}{X509\_EXT\_KEY\_USAGE\_ANY};
2339       \}
2340       \textcolor{comment}{//id-kp-serverAuth?}
2341       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2342          \hyperlink{certificate_2x509__common_8c_ae7c9de2f82549acaa3f2b25b56cb187e}{X509\_KP\_SERVER\_AUTH\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae7c9de2f82549acaa3f2b25b56cb187e}{X509\_KP\_SERVER\_AUTH\_OID})))
2343       \{
2344          \textcolor{comment}{//TLS WWW server authentication}
2345          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca63ac39e8e01f7523091284efb3735c76}{X509\_EXT\_KEY\_USAGE\_SERVER\_AUTH};
2346       \}
2347       \textcolor{comment}{//id-kp-clientAuth?}
2348       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2349          \hyperlink{certificate_2x509__common_8c_a837fd5c67b1ec25f4ff5feb51d0e9a6b}{X509\_KP\_CLIENT\_AUTH\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a837fd5c67b1ec25f4ff5feb51d0e9a6b}{X509\_KP\_CLIENT\_AUTH\_OID})))
2350       \{
2351          \textcolor{comment}{//TLS WWW client authentication}
2352          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46caeb140d0686928e663c22c2e032088713}{X509\_EXT\_KEY\_USAGE\_CLIENT\_AUTH};
2353       \}
2354       \textcolor{comment}{//id-kp-codeSigning?}
2355       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2356          \hyperlink{certificate_2x509__common_8c_a17afbafce40d657df96d72ed4c68da1b}{X509\_KP\_CODE\_SIGNING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a17afbafce40d657df96d72ed4c68da1b}{X509\_KP\_CODE\_SIGNING\_OID})))
2357       \{
2358          \textcolor{comment}{//Signing of downloadable executable code}
2359          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca646fedcf77153cb44696361174c99949}{X509\_EXT\_KEY\_USAGE\_CODE\_SIGNING};
2360       \}
2361       \textcolor{comment}{//id-kp-emailProtection?}
2362       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2363          \hyperlink{certificate_2x509__common_8c_a5faa07f49865a76dc91d23067a673a37}{X509\_KP\_EMAIL\_PROTECTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a5faa07f49865a76dc91d23067a673a37}{X509\_KP\_EMAIL\_PROTECTION\_OID})))
2364       \{
2365          \textcolor{comment}{//Email protection}
2366          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46cae38d3955936ea8dabdb3d59e91874b7b}{X509\_EXT\_KEY\_USAGE\_EMAIL\_PROTECTION};
2367       \}
2368       \textcolor{comment}{//id-kp-timeStamping?}
2369       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2370          \hyperlink{certificate_2x509__common_8c_aeca16b0ea97dd1224378935cea91f6b5}{X509\_KP\_TIME\_STAMPING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_aeca16b0ea97dd1224378935cea91f6b5}{X509\_KP\_TIME\_STAMPING\_OID})))
2371       \{
2372          \textcolor{comment}{//Binding the hash of an object to a time}
2373          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca1900647c6747d7d480869b8e82706986}{X509\_EXT\_KEY\_USAGE\_TIME\_STAMPING};
2374       \}
2375       \textcolor{comment}{//id-kp-OCSPSigning?}
2376       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length},
2377          \hyperlink{certificate_2x509__common_8c_acf696ac09d30d639c1d331e32007b1a9}{X509\_KP\_OCSP\_SIGNING\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_acf696ac09d30d639c1d331e32007b1a9}{X509\_KP\_OCSP\_SIGNING\_OID})))
2378       \{
2379          \textcolor{comment}{//Signing OCSP responses}
2380          *extKeyUsage |= \hyperlink{certificate_2x509__common_8h_a14abb74201f358023e263d66316af46ca802e45e67a33c7eb0f856f09fce9df0a}{X509\_EXT\_KEY\_USAGE\_OCSP\_SIGNING};
2381       \}
2382       \textcolor{comment}{//Unknown key purpose?}
2383       \textcolor{keywordflow}{else}
2384       \{
2385          \textcolor{comment}{//Discard KeyPurposeId field}
2386       \}
2387 
2388       \textcolor{comment}{//Next item}
2389       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2390       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2391    \}
2392 
2393    \textcolor{comment}{//Successful processing}
2394    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2395 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}\label{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Extension@{x509\+Parse\+Extension}}
\index{x509\+Parse\+Extension@{x509\+Parse\+Extension}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extension()}{x509ParseExtension()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extension (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Extension}{X509\+Extension} $\ast$}]{extension }\end{DoxyParamCaption})}



Parse X.\+509 certificate extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em extension} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1885 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1887 \{
1888    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1889    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1890 
1891    \textcolor{comment}{//The X.509 extension is encapsulated within a sequence}
1892    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1893    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1894    \textcolor{keywordflow}{if}(error)
1895       \textcolor{keywordflow}{return} error;
1896 
1897    \textcolor{comment}{//Save the total length of the X.509 extension}
1898    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1899 
1900    \textcolor{comment}{//Each extension includes an OID and a value}
1901    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1902    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1903 
1904    \textcolor{comment}{//Read extension OID}
1905    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1906    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1907    \textcolor{keywordflow}{if}(error)
1908       \textcolor{keywordflow}{return} error;
1909 
1910    \textcolor{comment}{//Save the object identifier}
1911    extension->\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1912    extension->\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1913 
1914    \textcolor{comment}{//Next item}
1915    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1916    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1917 
1918    \textcolor{comment}{//Read the Critical flag (if present)}
1919    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1920    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1921    \textcolor{keywordflow}{if}(error)
1922       \textcolor{keywordflow}{return} error;
1923 
1924    \textcolor{comment}{//Enforce encoding, class and type}
1925    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa6e8bd3d6d3cfdc39ccc2891743560462}{ASN1\_TYPE\_BOOLEAN});
1926 
1927    \textcolor{comment}{//Check whether the Critical field is present}
1928    \textcolor{keywordflow}{if}(!error)
1929    \{
1930       \textcolor{comment}{//Make sure the length of the boolean is valid}
1931       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 1)
1932          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28}{ERROR\_INVALID\_LENGTH};
1933 
1934       \textcolor{comment}{//Each extension in a certificate is designated as either critical}
1935       \textcolor{comment}{//or non-critical}
1936       extension->\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] ? \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1937 
1938       \textcolor{comment}{//Next item}
1939       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1940       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1941    \}
1942    \textcolor{keywordflow}{else}
1943    \{
1944       \textcolor{comment}{//The extension is considered as non-critical}
1945       extension->\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical} = \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1946    \}
1947 
1948    \textcolor{comment}{//The extension value is encapsulated within an octet string}
1949    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1950    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1951    \textcolor{keywordflow}{if}(error)
1952       \textcolor{keywordflow}{return} error;
1953 
1954    \textcolor{comment}{//Save the value of the extension}
1955    extension->\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1956    extension->\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1957 
1958    \textcolor{comment}{//Successful processing}
1959    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1960 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}\label{certificate_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Extensions@{x509\+Parse\+Extensions}}
\index{x509\+Parse\+Extensions@{x509\+Parse\+Extensions}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Extensions()}{x509ParseExtensions()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Extensions (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Extensions}{X509\+Extensions} $\ast$}]{extensions }\end{DoxyParamCaption})}



Parse X.\+509 certificate extensions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em extensions} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1689 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1691 \{
1692    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1693    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1694    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1695    \hyperlink{structX509Extension}{X509Extension} extension;
1696 
1697    \textcolor{comment}{//No more data to process?}
1698    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1699    \{
1700       \textcolor{comment}{//The Extensions field is optional}
1701       *totalLength = 0;
1702       \textcolor{comment}{//Exit immediately}
1703       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1704    \}
1705 
1706    \textcolor{comment}{//Explicit tagging is used to encode the Extensions field}
1707    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1708    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1709    \textcolor{keywordflow}{if}(error)
1710       \textcolor{keywordflow}{return} error;
1711 
1712    \textcolor{comment}{//Enforce encoding, class and type}
1713    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       3);
1714    \textcolor{comment}{//Invalid tag?}
1715    \textcolor{keywordflow}{if}(error)
1716    \{
1717       \textcolor{comment}{//The Extensions field is optional}
1718       *totalLength = 0;
1719       \textcolor{comment}{//Exit immediately}
1720       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1721    \}
1722 
1723    \textcolor{comment}{//Save the total length of the field}
1724    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1725 
1726    \textcolor{comment}{//Debug message}
1727    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Extensions...\(\backslash\)r\(\backslash\)n"});
1728 
1729    \textcolor{comment}{//This field is a sequence of one or more certificate extensions}
1730    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
1731    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1732    \textcolor{keywordflow}{if}(error)
1733       \textcolor{keywordflow}{return} error;
1734 
1735    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1736    extensions->\hyperlink{structX509Extensions_aed67fee9d790d14c3af1381cd07a7e0a}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1737    extensions->\hyperlink{structX509Extensions_affa35283aa7142110b2973474b7b1965}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1738 
1739    \textcolor{comment}{//Point to the first item of the sequence}
1740    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1741    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1742 
1743    \textcolor{comment}{//Loop through the extensions}
1744    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
1745    \{
1746       \textcolor{comment}{//Each extension includes an OID and a value}
1747       error = \hyperlink{certificate_2x509__cert__parse_8c_ab1c115cdbaf5ae6b616aafc76b0c82fb}{x509ParseExtension}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &extension);
1748       \textcolor{comment}{//Any error to report?}
1749       \textcolor{keywordflow}{if}(error)
1750          \textcolor{keywordflow}{return} error;
1751 
1752       \textcolor{comment}{//BasicConstraints extension found?}
1753       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1754          \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a457e7911fb0bbd8a8579f7198d2dbcba}{X509\_BASIC\_CONSTRAINTS\_OID})))
1755       \{
1756          \textcolor{comment}{//Parse BasicConstraints extension}
1757          error = \hyperlink{certificate_2x509__cert__parse_8c_a41373e3b9bd0f2c1d7d651f25bf8faf6}{x509ParseBasicConstraints}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1758             &extensions->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints});
1759       \}
1760       \textcolor{comment}{//NameConstraints extension found?}
1761       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1762          \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a126407f871cfe6468f546f357e4a4086}{X509\_NAME\_CONSTRAINTS\_OID})))
1763       \{
1764          \textcolor{comment}{//Parse NameConstraints extension}
1765          error = \hyperlink{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}{x509ParseNameConstraints}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1766             &extensions->\hyperlink{structX509Extensions_a25c09f610754fe740c393867ee9950a9}{nameConstraints});
1767       \}
1768 \textcolor{preprocessor}{#if 0}
1769       \textcolor{comment}{//PolicyConstraints extension found?}
1770       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1771          \hyperlink{certificate_2x509__common_8c_add47aa496ac99a30c225ce3b3b5fd1c0}{X509\_POLICY\_CONSTRAINTS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_add47aa496ac99a30c225ce3b3b5fd1c0}{X509\_POLICY\_CONSTRAINTS\_OID})))
1772       \{
1773          \textcolor{comment}{//Parse PolicyConstraints extension}
1774          error = \hyperlink{certificate_2x509__cert__parse_8c_a69067e7a8941f2329cbbb3e3a1413887}{x509ParsePolicyConstraints}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1775       \}
1776       \textcolor{comment}{//PolicyMappings extension found?}
1777       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1778          \hyperlink{certificate_2x509__common_8c_aa356a7336c86eebe80e158f38327f5b1}{X509\_POLICY\_MAPPINGS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_aa356a7336c86eebe80e158f38327f5b1}{X509\_POLICY\_MAPPINGS\_OID})))
1779       \{
1780          \textcolor{comment}{//Parse PolicyMappings extension}
1781          error = \hyperlink{certificate_2x509__cert__parse_8c_a71cf108498b2a57b5306de9f005f5a96}{x509ParsePolicyMappings}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1782       \}
1783       \textcolor{comment}{//InhibitAnyPolicy extension found?}
1784       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1785          \hyperlink{certificate_2x509__common_8c_acc42689b362dca46f9dcf8e5190edaf0}{X509\_INHIBIT\_ANY\_POLICY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_acc42689b362dca46f9dcf8e5190edaf0}{X509\_INHIBIT\_ANY\_POLICY\_OID})))
1786       \{
1787          \textcolor{comment}{//Parse InhibitAnyPolicy extension}
1788          error = \hyperlink{certificate_2x509__cert__parse_8c_ade6829856343b371abc479c340c3175b}{x509ParseInhibitAnyPolicy}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen});
1789       \}
1790 \textcolor{preprocessor}{#endif}
1791       \textcolor{comment}{//KeyUsage extension found?}
1792       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1793          \hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ab8715054378778b299416013e3dba1c8}{X509\_KEY\_USAGE\_OID})))
1794       \{
1795          \textcolor{comment}{//Parse KeyUsage extension}
1796          error = \hyperlink{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}{x509ParseKeyUsage}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1797             &extensions->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage});
1798       \}
1799       \textcolor{comment}{//ExtendedKeyUsage extension found?}
1800       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1801          \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a9496812c91906e4f0d811fbe062fe2d4}{X509\_EXTENDED\_KEY\_USAGE\_OID})))
1802       \{
1803          \textcolor{comment}{//Parse ExtendedKeyUsage extension}
1804          error = \hyperlink{certificate_2x509__cert__parse_8c_a96edb9c2cd29de17692987c9667c6178}{x509ParseExtendedKeyUsage}(extension.
      \hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.\hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1805             &extensions->\hyperlink{structX509Extensions_afad9dec97dd6bba0297e67efd46ff042}{extKeyUsage});
1806       \}
1807       \textcolor{comment}{//SubjectAltName extension found?}
1808       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1809          \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a54156c89eb4115b75cc540863e438879}{X509\_SUBJECT\_ALT\_NAME\_OID})))
1810       \{
1811          \textcolor{comment}{//Parse SubjectAltName extension}
1812          error = \hyperlink{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}{x509ParseSubjectAltName}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1813             &extensions->\hyperlink{structX509Extensions_a6a01ce6bc43517af604b8cf580ebd01d}{subjectAltName});
1814       \}
1815       \textcolor{comment}{//SubjectKeyIdentifier extension found?}
1816       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1817          \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a035e654ed9823c727dd109c18e5e2cbd}{X509\_SUBJECT\_KEY\_ID\_OID})))
1818       \{
1819          \textcolor{comment}{//Parse SubjectKeyIdentifier extension}
1820          error = \hyperlink{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}{x509ParseSubjectKeyId}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1821             &extensions->\hyperlink{structX509Extensions_a720e6ecde7eba80ee36a83d18a67dfd9}{subjectKeyId});
1822       \}
1823       \textcolor{comment}{//AuthorityKeyIdentifier extension found?}
1824       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1825          \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ae647117666d0ad67f65ade1ec8da1f60}{X509\_AUTHORITY\_KEY\_ID\_OID})))
1826       \{
1827          \textcolor{comment}{//Parse AuthorityKeyIdentifier extension}
1828          error = \hyperlink{certificate_2x509__cert__parse_8c_afbba029f21085bc79825d102dc1290f8}{x509ParseAuthorityKeyId}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1829             &extensions->\hyperlink{structX509Extensions_acc617db6c54f375abf1455a73e2c5ea3}{authorityKeyId});
1830       \}
1831       \textcolor{comment}{//NetscapeCertType extension found?}
1832       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(extension.\hyperlink{structX509Extension_a3bb16b166862712604b01d136b6cdab2}{oid}, extension.\hyperlink{structX509Extension_a6d4c36c0f0ba38c228a1dc3cf20e4981}{oidLen},
1833          \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a2144da6500b31dc85f50a2a1b6d38f87}{X509\_NS\_CERT\_TYPE\_OID})))
1834       \{
1835          \textcolor{comment}{//Parse NetscapeCertType extension}
1836          error = \hyperlink{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}{x509ParseNsCertType}(extension.\hyperlink{structX509Extension_a0ae0ef35ada444d669c37c0ba83856be}{value}, extension.
      \hyperlink{structX509Extension_a0755db4dfc17cf65b84bb318852db166}{valueLen},
1837             &extensions->\hyperlink{structX509Extensions_a3600340825a23651f29c87e6da57a4bb}{nsCertType});
1838       \}
1839       \textcolor{comment}{//Unknown extension?}
1840       \textcolor{keywordflow}{else}
1841       \{
1842          \textcolor{comment}{//Check if the extension is marked as critical}
1843          \textcolor{keywordflow}{if}(extension.\hyperlink{structX509Extension_afa8e6dfc4bdcca74d71d699e3a75bf88}{critical})
1844          \{
1845             \textcolor{comment}{//An application must reject the certificate if it encounters a}
1846             \textcolor{comment}{//critical extension it does not recognize or a critical extension}
1847             \textcolor{comment}{//that contains information that it cannot process}
1848             error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca0024b1359f3a168578a6cf9da0ca4564}{ERROR\_UNSUPPORTED\_EXTENSION};
1849          \}
1850       \}
1851 
1852       \textcolor{comment}{//Any parsing error?}
1853       \textcolor{keywordflow}{if}(error)
1854          \textcolor{keywordflow}{return} error;
1855 
1856       \textcolor{comment}{//Next extension}
1857       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1858       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1859    \}
1860 
1861    \textcolor{comment}{//Check whether the keyCertSign bit is asserted}
1862    \textcolor{keywordflow}{if}(extensions->\hyperlink{structX509Extensions_adc23b201b2f81c036bb2f6fb364af346}{keyUsage} & \hyperlink{certificate_2x509__common_8h_a071feff2befadce3a4fe5b708cdb149ba2dc6d1748a2dd8a65a7ba5e521a1c054}{X509\_KEY\_USAGE\_KEY\_CERT\_SIGN})
1863    \{
1864       \textcolor{comment}{//If the keyCertSign bit is asserted, then the cA bit in the basic}
1865       \textcolor{comment}{//constraints extension must also be asserted (refer to RFC 5280,}
1866       \textcolor{comment}{//section 4.2.1.3)}
1867       \textcolor{keywordflow}{if}(!extensions->\hyperlink{structX509Extensions_ab06800e3424608f8d652ff23c5a027a9}{basicConstraints}.\hyperlink{structX509BasicConstraints_afcfd439b65fdffa3e6fd07e6a46e9d7d}{cA})
1868          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1869    \}
1870 
1871    \textcolor{comment}{//Successful processing}
1872    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1873 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}\label{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+General\+Name@{x509\+Parse\+General\+Name}}
\index{x509\+Parse\+General\+Name@{x509\+Parse\+General\+Name}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Name()}{x509ParseGeneralName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$}]{general\+Name }\end{DoxyParamCaption})}



Parse General\+Name field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em general\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2542 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2544 \{
2545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2546    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2547 
2548    \textcolor{comment}{//Debug message}
2549    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"        Parsing GeneralName...\(\backslash\)r\(\backslash\)n"});
2550 
2551    \textcolor{comment}{//Read current item}
2552    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2553    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2554    \textcolor{keywordflow}{if}(error)
2555       \textcolor{keywordflow}{return} error;
2556 
2557    \textcolor{comment}{//Explicit tagging shall be used to encode the subject alternative name}
2558    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
2559       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
2560 
2561    \textcolor{comment}{//Conforming CAs must not issue certificates with subjectAltNames containing}
2562    \textcolor{comment}{//empty GeneralName fields (refer to RFC 5280, section 4.2.1.6)}
2563    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2564       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2565 
2566    \textcolor{comment}{//Save subject alternative name}
2567    generalName->\hyperlink{structX509GeneralName_a014e3358c1ab42d4da4cd2535d59f05f}{type} = (\hyperlink{certificate_2x509__common_8h_a6a82f43a61ee7a3e18d71f986d7f9a59}{X509GeneralNameType}) tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType};
2568    generalName->\hyperlink{structX509GeneralName_a00814b3509e1b708f019a645511e3d3a}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2569    generalName->\hyperlink{structX509GeneralName_a2804f41c9ae3cf1fb375b1d222d4f3af}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2570 
2571    \textcolor{comment}{//Save the total length of the field}
2572    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2573 
2574    \textcolor{comment}{//Successful processing}
2575    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2576 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}\label{certificate_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+General\+Subtree@{x509\+Parse\+General\+Subtree}}
\index{x509\+Parse\+General\+Subtree@{x509\+Parse\+General\+Subtree}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Subtree()}{x509ParseGeneralSubtree()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Subtree (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509GeneralName}{X509\+General\+Name} $\ast$}]{general\+Name }\end{DoxyParamCaption})}



Parse General\+Subtree field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em general\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2509 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2511 \{
2512    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2513    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2514    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2515 
2516    \textcolor{comment}{//The GeneralSubtrees structure shall contain a valid sequence}
2517    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2518    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2519    \textcolor{keywordflow}{if}(error)
2520       \textcolor{keywordflow}{return} error;
2521 
2522    \textcolor{comment}{//Save the total length of the field}
2523    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2524 
2525    \textcolor{comment}{//Parse GeneralName field}
2526    error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &n, generalName);
2527 
2528    \textcolor{comment}{//Discard minimum and maximum fields}
2529    \textcolor{keywordflow}{return} error;
2530 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}\label{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+General\+Subtrees@{x509\+Parse\+General\+Subtrees}}
\index{x509\+Parse\+General\+Subtrees@{x509\+Parse\+General\+Subtrees}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+General\+Subtrees()}{x509ParseGeneralSubtrees()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+General\+Subtrees (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse General\+Subtrees field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2475 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2476 \{
2477    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2478    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2479    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
2480 
2481    \textcolor{comment}{//Loop through the list of GeneralSubtree fields}
2482    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2483    \{
2484       \textcolor{comment}{//Parse current GeneralSubtree field}
2485       error = \hyperlink{certificate_2x509__cert__parse_8c_a9195227eeefd0a4135989aae9be08082}{x509ParseGeneralSubtree}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
2486       \textcolor{comment}{//Any error to report?}
2487       \textcolor{keywordflow}{if}(error)
2488          \textcolor{keywordflow}{return} error;
2489 
2490       \textcolor{comment}{//Next item}
2491       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2492       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2493    \}
2494 
2495    \textcolor{comment}{//Successful processing}
2496    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2497 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_ade6829856343b371abc479c340c3175b}\label{certificate_2x509__cert__parse_8c_ade6829856343b371abc479c340c3175b}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Inhibit\+Any\+Policy@{x509\+Parse\+Inhibit\+Any\+Policy}}
\index{x509\+Parse\+Inhibit\+Any\+Policy@{x509\+Parse\+Inhibit\+Any\+Policy}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Inhibit\+Any\+Policy()}{x509ParseInhibitAnyPolicy()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Inhibit\+Any\+Policy (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Inhibit\+Any\+Policy extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2210 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2211 \{
2212    \textcolor{comment}{//Debug message}
2213    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing InhibitAnyPolicy...\(\backslash\)r\(\backslash\)n"});
2214 
2215    \textcolor{comment}{//Successful processing}
2216    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2217 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}\label{certificate_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Issuer\+Unique\+Id@{x509\+Parse\+Issuer\+Unique\+Id}}
\index{x509\+Parse\+Issuer\+Unique\+Id@{x509\+Parse\+Issuer\+Unique\+Id}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Issuer\+Unique\+Id()}{x509ParseIssuerUniqueId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Issuer\+Unique\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length }\end{DoxyParamCaption})}



Parse Issuer\+Unique\+ID structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1582 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1584 \{
1585    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1586    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1587 
1588    \textcolor{comment}{//No more data to process?}
1589    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1590    \{
1591       \textcolor{comment}{//The IssuerUniqueID field is optional}
1592       *totalLength = 0;
1593       \textcolor{comment}{//Exit immediately}
1594       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1595    \}
1596 
1597    \textcolor{comment}{//Implicit tagging is used to encode the IssuerUniqueID field}
1598    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1599    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1600    \textcolor{keywordflow}{if}(error)
1601       \textcolor{keywordflow}{return} error;
1602 
1603    \textcolor{comment}{//Enforce encoding, class and type}
1604    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       1);
1605    \textcolor{comment}{//Invalid tag?}
1606    \textcolor{keywordflow}{if}(error)
1607    \{
1608       \textcolor{comment}{//The IssuerUniqueID field is optional}
1609       *totalLength = 0;
1610       \textcolor{comment}{//Exit immediately}
1611       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1612    \}
1613 
1614    \textcolor{comment}{//Save the total length of the field}
1615    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1616 
1617    \textcolor{comment}{//Debug message}
1618    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing IssuerUniqueID...\(\backslash\)r\(\backslash\)n"});
1619 
1620    \textcolor{comment}{//Conforming applications should be capable of parsing certificates that}
1621    \textcolor{comment}{//include unique identifiers, but there are no processing requirements}
1622    \textcolor{comment}{//associated with the unique identifiers}
1623    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1624 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}\label{certificate_2x509__cert__parse_8c_aef8823ce7d1415b0f5e430fb16b119de}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Key\+Usage@{x509\+Parse\+Key\+Usage}}
\index{x509\+Parse\+Key\+Usage@{x509\+Parse\+Key\+Usage}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Key\+Usage()}{x509ParseKeyUsage()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Key\+Usage (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\+\_\+t} $\ast$}]{key\+Usage }\end{DoxyParamCaption})}



Parse Key\+Usage extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em key\+Usage} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2228 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2230 \{
2231    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2232    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2233 
2234    \textcolor{comment}{//Debug message}
2235    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing KeyUsage...\(\backslash\)r\(\backslash\)n"});
2236 
2237    \textcolor{comment}{//A certificate must not include more than one instance of a particular}
2238    \textcolor{comment}{//extension (refer to RFC 5280, section 4.2)}
2239    \textcolor{keywordflow}{if}(*keyUsage != 0)
2240       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2241 
2242    \textcolor{comment}{//The key usage extension defines the purpose of the key contained in the}
2243    \textcolor{comment}{//certificate}
2244    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2245    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2246    \textcolor{keywordflow}{if}(error)
2247       \textcolor{keywordflow}{return} error;
2248 
2249    \textcolor{comment}{//Enforce encoding, class and type}
2250    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
2251    \textcolor{comment}{//Invalid tag?}
2252    \textcolor{keywordflow}{if}(error)
2253       \textcolor{keywordflow}{return} error;
2254 
2255    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
2256    \textcolor{comment}{//of unused bits in the final subsequent octet}
2257    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
2258       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2259 
2260    \textcolor{comment}{//Sanity check}
2261    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] >= 8)
2262       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2263 
2264    \textcolor{comment}{//Clear bit string}
2265    *keyUsage = 0;
2266 
2267    \textcolor{comment}{//Read bits b0 to b7}
2268    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 2)
2269       *keyUsage |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[1]);
2270 
2271    \textcolor{comment}{//Read bits b8 to b15}
2272    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 3)
2273       *keyUsage |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[2]) << 8;
2274 
2275    \textcolor{comment}{//When the key usage extension appears in a certificate, at least one of}
2276    \textcolor{comment}{//the bits must be set to 1 (refer to RFC 5280, section 4.2.1.3)}
2277    \textcolor{keywordflow}{if}(*keyUsage == 0)
2278       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2279 
2280    \textcolor{comment}{//Successful processing}
2281    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2282 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}\label{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Name@{x509\+Parse\+Name}}
\index{x509\+Parse\+Name@{x509\+Parse\+Name}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name()}{x509ParseName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Name}{X509\+Name} $\ast$}]{name }\end{DoxyParamCaption})}



Parse Name structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 624 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
626 \{
627    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
628    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
629    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
630    \hyperlink{structX509NameAttribute}{X509NameAttribute} nameAttribute;
631 
632    \textcolor{comment}{//Debug message}
633    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Name...\(\backslash\)r\(\backslash\)n"});
634 
635    \textcolor{comment}{//Read the contents of the Name structure}
636    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
637    \textcolor{comment}{//Failed to decode ASN.1 tag?}
638    \textcolor{keywordflow}{if}(error)
639       \textcolor{keywordflow}{return} error;
640 
641    \textcolor{comment}{//Save the total length of the field}
642    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
643 
644    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
645    name->\hyperlink{structX509Name_a16f889e11f79b38a1ade245692857253}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
646    name->\hyperlink{structX509Name_a0f57dd73feee5e3a4aa769fa1ecf3766}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
647 
648    \textcolor{comment}{//The Name describes a hierarchical name composed of attributes}
649    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
650    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
651 
652    \textcolor{comment}{//Loop through all the attributes}
653    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
654    \{
655       \textcolor{comment}{//Read current attribute}
656       error = \hyperlink{certificate_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}{x509ParseNameAttribute}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &nameAttribute);
657       \textcolor{comment}{//Any error to report?}
658       \textcolor{keywordflow}{if}(error)
659          \textcolor{keywordflow}{return} error;
660 
661       \textcolor{comment}{//Common Name attribute found?}
662       \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
663          \hyperlink{certificate_2x509__common_8c_a2b21c2e5cf2832b0e88fd6fab5a94e42}{X509\_COMMON\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a2b21c2e5cf2832b0e88fd6fab5a94e42}{X509\_COMMON\_NAME\_OID})))
664       \{
665          name->\hyperlink{structX509Name_a29948ef6424aa86551582e5bf7afa47a}{commonName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
666          name->\hyperlink{structX509Name_a5c5af434bfa902d83cae8cec8af15581}{commonNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
667       \}
668       \textcolor{comment}{//Surname attribute found?}
669       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
670          \hyperlink{certificate_2x509__common_8c_a98f5d48193ddb65ea83893b9e8db5c19}{X509\_SURNAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a98f5d48193ddb65ea83893b9e8db5c19}{X509\_SURNAME\_OID})))
671       \{
672          name->\hyperlink{structX509Name_aa9a667195b0076689e31a6995d925cc0}{surname} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
673          name->\hyperlink{structX509Name_a43f4016488337cbd57078b9b51720645}{surnameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
674       \}
675       \textcolor{comment}{//Serial Number attribute found?}
676       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
677          \hyperlink{certificate_2x509__common_8c_a4641159299e9a03993387e947ab10ed0}{X509\_SERIAL\_NUMBER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a4641159299e9a03993387e947ab10ed0}{X509\_SERIAL\_NUMBER\_OID})))
678       \{
679          name->\hyperlink{structX509Name_ab59d7753a4b9c386e9d10c5ddc609ec5}{serialNumber} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
680          name->\hyperlink{structX509Name_ad24a46ee271b93997a308179a6e8f154}{serialNumberLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
681       \}
682       \textcolor{comment}{//Country Name attribute found?}
683       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
684          \hyperlink{certificate_2x509__common_8c_a358f40098801dee2105f40d48d4d6a3c}{X509\_COUNTRY\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a358f40098801dee2105f40d48d4d6a3c}{X509\_COUNTRY\_NAME\_OID})))
685       \{
686          name->\hyperlink{structX509Name_aebedcf83915608e1929d6cc612a67c2e}{countryName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
687          name->\hyperlink{structX509Name_ae146dda0b021633e3cfc15bda3435bf9}{countryNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
688       \}
689       \textcolor{comment}{//Locality Name attribute found?}
690       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
691          \hyperlink{certificate_2x509__common_8c_a0b268786ad68f63b1e38d64a48e77436}{X509\_LOCALITY\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a0b268786ad68f63b1e38d64a48e77436}{X509\_LOCALITY\_NAME\_OID})))
692       \{
693          name->\hyperlink{structX509Name_a9e5c517817abea85a4ad7a8fa074fb76}{localityName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
694          name->\hyperlink{structX509Name_aba984d3fdf4e5c6eecb90752e54de3a7}{localityNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
695       \}
696       \textcolor{comment}{//State Or Province Name attribute found?}
697       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
698          \hyperlink{certificate_2x509__common_8c_a29d223ee0c7055add854914bad3b0907}{X509\_STATE\_OR\_PROVINCE\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a29d223ee0c7055add854914bad3b0907}{X509\_STATE\_OR\_PROVINCE\_NAME\_OID})))
699       \{
700          name->\hyperlink{structX509Name_ad7101a1d70be5540fc1246c3819383dd}{stateOrProvinceName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
701          name->\hyperlink{structX509Name_a976a693703efcb68deed5c6294d0c95e}{stateOrProvinceNameLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
702       \}
703       \textcolor{comment}{//Organization Name attribute found?}
704       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
705          \hyperlink{certificate_2x509__common_8c_ac425aa6ed62ca6e26603c42a0036bed9}{X509\_ORGANIZATION\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_ac425aa6ed62ca6e26603c42a0036bed9}{X509\_ORGANIZATION\_NAME\_OID})))
706       \{
707          name->\hyperlink{structX509Name_a521dfa010d25113b7ebca412a8ef1b6b}{organizationName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
708          name->\hyperlink{structX509Name_af2841192675d2bd0f999533a723d1c1d}{organizationNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
709       \}
710       \textcolor{comment}{//Organizational Unit Name attribute found?}
711       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
712          \hyperlink{certificate_2x509__common_8c_a5e4b5b454f1950a297fa7d74db18a6cd}{X509\_ORGANIZATIONAL\_UNIT\_NAME\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a5e4b5b454f1950a297fa7d74db18a6cd}{X509\_ORGANIZATIONAL\_UNIT\_NAME\_OID})))
713       \{
714          name->\hyperlink{structX509Name_a4095d2020e8553687a85b462fd00eac9}{organizationalUnitName} = nameAttribute.
      \hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
715          name->\hyperlink{structX509Name_a17dc575cf29d256e44331bcb05ea67f0}{organizationalUnitNameLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
716       \}
717       \textcolor{comment}{//Title attribute found?}
718       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
719          \hyperlink{certificate_2x509__common_8c_aff61701a36132aa50d28fd5cf7a9ea0f}{X509\_TITLE\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_aff61701a36132aa50d28fd5cf7a9ea0f}{X509\_TITLE\_OID})))
720       \{
721          name->\hyperlink{structX509Name_a5d2ae5a4848f91eccefbeabc69820652}{title} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
722          name->\hyperlink{structX509Name_a0058184d7e0354caeac1e7fdad588b83}{titleLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
723       \}
724       \textcolor{comment}{//Name attribute found?}
725       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
726          \hyperlink{certificate_2x509__common_8c_af6a5d0576cc12caea4ef904c8cbffddd}{X509\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_af6a5d0576cc12caea4ef904c8cbffddd}{X509\_NAME\_OID})))
727       \{
728          name->\hyperlink{structX509Name_a394c9f9f73684a428aae25966b8ba4ca}{name} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
729          name->\hyperlink{structX509Name_a7dbc2e822775eadb3fd3954acdc6f73c}{nameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
730       \}
731       \textcolor{comment}{//Given Name attribute found?}
732       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
733          \hyperlink{certificate_2x509__common_8c_a6dded88e9e1ca6542bf2fce2f18f9002}{X509\_GIVEN\_NAME\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a6dded88e9e1ca6542bf2fce2f18f9002}{X509\_GIVEN\_NAME\_OID})))
734       \{
735          name->\hyperlink{structX509Name_a17920a6ac4d8f5861eb94d449de21338}{givenName} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
736          name->\hyperlink{structX509Name_aacfef579b78cdecc4e865d3a59dc5901}{givenNameLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
737       \}
738       \textcolor{comment}{//Initials attribute OID (2.5.4.43)}
739       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
740          \hyperlink{certificate_2x509__common_8c_a6b6d6b86ae6068c35861ac70d6b881f8}{X509\_INITIALS\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_a6b6d6b86ae6068c35861ac70d6b881f8}{X509\_INITIALS\_OID})))
741       \{
742          name->\hyperlink{structX509Name_a4b7ee284208fc072beb26bd1ab2d8297}{initials} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
743          name->\hyperlink{structX509Name_a2b7b4d29b65c03212c5b2fb3d94c1ab1}{initialsLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
744       \}
745       \textcolor{comment}{//Generation Qualifier attribute found?}
746       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
747          \hyperlink{certificate_2x509__common_8c_af87d6b94adb88574b7bacd0da33240a7}{X509\_GENERATION\_QUALIFIER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_af87d6b94adb88574b7bacd0da33240a7}{X509\_GENERATION\_QUALIFIER\_OID})))
748       \{
749          name->\hyperlink{structX509Name_af795a7195c222e32c6ece85764672094}{generationQualifier} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
750          name->\hyperlink{structX509Name_a295dd5dd5361f04b4f15cfb6d9488d76}{generationQualifierLen} = nameAttribute.
      \hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
751       \}
752       \textcolor{comment}{//DN Qualifier attribute found?}
753       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
754          \hyperlink{certificate_2x509__common_8c_a734687e867f0ef28c6ffa179dbc51324}{X509\_DN\_QUALIFIER\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{certificate_2x509__common_8c_a734687e867f0ef28c6ffa179dbc51324}{X509\_DN\_QUALIFIER\_OID})))
755       \{
756          name->\hyperlink{structX509Name_aff2c9afbb89584912d7a66f70d2e21ea}{dnQualifier} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
757          name->\hyperlink{structX509Name_a070cb2ee94a282f233a4ee5a23a7374d}{dnQualifierLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
758       \}
759       \textcolor{comment}{//Pseudonym attribute found?}
760       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(nameAttribute.\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type}, nameAttribute.\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen},
761          \hyperlink{certificate_2x509__common_8c_ac6cb01372209cfb385bccdb197214b7d}{X509\_PSEUDONYM\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{certificate_2x509__common_8c_ac6cb01372209cfb385bccdb197214b7d}{X509\_PSEUDONYM\_OID})))
762       \{
763          name->\hyperlink{structX509Name_ac157a7985fd1b9ea07893de309947823}{pseudonym} = nameAttribute.\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value};
764          name->\hyperlink{structX509Name_a701db328dc75e341e16cc03f65abf062}{pseudonymLen} = nameAttribute.\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen};
765       \}
766       \textcolor{comment}{//Unknown attribute?}
767       \textcolor{keywordflow}{else}
768       \{
769          \textcolor{comment}{//Discard current attribute}
770       \}
771 
772       \textcolor{comment}{//Next attribute}
773       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
774       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
775    \}
776 
777    \textcolor{comment}{//Name field successfully parsed}
778    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
779 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}\label{certificate_2x509__cert__parse_8c_ac2fda2111b747d8e392ac9676b607125}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Name\+Attribute@{x509\+Parse\+Name\+Attribute}}
\index{x509\+Parse\+Name\+Attribute@{x509\+Parse\+Name\+Attribute}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name\+Attribute()}{x509ParseNameAttribute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name\+Attribute (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509NameAttribute}{X509\+Name\+Attribute} $\ast$}]{name\+Attribute }\end{DoxyParamCaption})}



Parse name attribute. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em name\+Attribute} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 791 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
793 \{
794    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
795    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
796 
797    \textcolor{comment}{//Attributes are encapsulated within a set}
798    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
799    \textcolor{comment}{//Failed to decode ASN.1 tag?}
800    \textcolor{keywordflow}{if}(error)
801       \textcolor{keywordflow}{return} error;
802 
803    \textcolor{comment}{//Enforce encoding, class and type}
804    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9b2fa570f44ed585417c69fdeead6efa}{ASN1\_TYPE\_SET});
805    \textcolor{comment}{//Invalid tag?}
806    \textcolor{keywordflow}{if}(error)
807       \textcolor{keywordflow}{return} error;
808 
809    \textcolor{comment}{//Save the total length of the attribute}
810    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
811 
812    \textcolor{comment}{//Read the first field of the set}
813    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
814    \textcolor{comment}{//Failed to decode ASN.1 tag?}
815    \textcolor{keywordflow}{if}(error)
816       \textcolor{keywordflow}{return} error;
817 
818    \textcolor{comment}{//Point to the first field of the sequence}
819    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
820    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
821 
822    \textcolor{comment}{//Read attribute type}
823    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
824    \textcolor{comment}{//Failed to decode ASN.1 tag?}
825    \textcolor{keywordflow}{if}(error)
826       \textcolor{keywordflow}{return} error;
827 
828    \textcolor{comment}{//Save attribute type}
829    nameAttribute->\hyperlink{structX509NameAttribute_a66dff073fff9aec0c164a6dfaa81a523}{type} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
830    nameAttribute->\hyperlink{structX509NameAttribute_ac57d67161545c7a78f8997eac569320a}{typeLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
831 
832    \textcolor{comment}{//Point to the next field}
833    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
834    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
835 
836    \textcolor{comment}{//Read attribute value}
837    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
838    \textcolor{comment}{//Failed to decode ASN.1 tag?}
839    \textcolor{keywordflow}{if}(error)
840       \textcolor{keywordflow}{return} error;
841 
842    \textcolor{comment}{//Save attribute value}
843    nameAttribute->\hyperlink{structX509NameAttribute_a282b457c4732701132df0b293cb7910c}{value} = (\hyperlink{compiler__port_8h_a40bb5262bf908c328fbcfbe5d29d0201}{char\_t} *) tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
844    nameAttribute->\hyperlink{structX509NameAttribute_a265bb7fc7ba14428f029b10c2bd9db9d}{valueLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
845 
846    \textcolor{comment}{//Successful processing}
847    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
848 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}\label{certificate_2x509__cert__parse_8c_a4b074c526c6377ff18020e24fe75744a}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Name\+Constraints@{x509\+Parse\+Name\+Constraints}}
\index{x509\+Parse\+Name\+Constraints@{x509\+Parse\+Name\+Constraints}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Name\+Constraints()}{x509ParseNameConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Name\+Constraints (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509NameConstraints}{X509\+Name\+Constraints} $\ast$}]{name\+Constraints }\end{DoxyParamCaption})}



Parse Name\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em name\+Constraints} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2058 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2060 \{
2061    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2062    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2063 
2064    \textcolor{comment}{//Debug message}
2065    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing NameConstraints...\(\backslash\)r\(\backslash\)n"});
2066 
2067    \textcolor{comment}{//The NameConstraints structure shall contain a valid sequence}
2068    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2069    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2070    \textcolor{keywordflow}{if}(error)
2071       \textcolor{keywordflow}{return} error;
2072 
2073    \textcolor{comment}{//Conforming CAs must not issue certificates where name constraints is an}
2074    \textcolor{comment}{//empty sequence (refer to RFC 5280, section 4.2.1.10)}
2075    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2076       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2077 
2078    \textcolor{comment}{//Point to the first item of the sequence}
2079    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2080    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2081 
2082    \textcolor{comment}{//The name constraints extension indicates a name space within which all}
2083    \textcolor{comment}{//subject names in subsequent certificates in a certification path must}
2084    \textcolor{comment}{//be located}
2085    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
2086    \{
2087       \textcolor{comment}{//Parse GeneralSubtrees field}
2088       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2089       \textcolor{comment}{//Failed to decode ASN.1 tag?}
2090       \textcolor{keywordflow}{if}(error)
2091          \textcolor{keywordflow}{return} error;
2092 
2093       \textcolor{comment}{//Explicit tagging shall be used to encode the GeneralSubtrees field}
2094       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a9f35c291ffa22d903d9c66638bb225ea}{objClass} != \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC})
2095          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca43454cea92ccd5499886077a93f63d08}{ERROR\_INVALID\_CLASS};
2096 
2097       \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.10)}
2098       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2099          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2100 
2101       \textcolor{comment}{//Restrictions are defined in terms of permitted or excluded name subtrees}
2102       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 0)
2103       \{
2104          \textcolor{comment}{//Parse the permittedSubtrees field}
2105          error = \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509ParseGeneralSubtrees}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length});
2106          \textcolor{comment}{//Any error to report?}
2107          \textcolor{keywordflow}{if}(error)
2108             \textcolor{keywordflow}{return} error;
2109 
2110          \textcolor{comment}{//Raw contents of the ASN.1 sequence}
2111          nameConstraints->\hyperlink{structX509NameConstraints_a156421797fb4821bee39cfc265a0c2da}{permittedSubtrees} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2112          nameConstraints->\hyperlink{structX509NameConstraints_aaada0ccb4f22f65db2b71493b14327c0}{permittedSubtreesLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2113       \}
2114       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a3ecdc4bbf328b5216521cb2114f45935}{objType} == 1)
2115       \{
2116          \textcolor{comment}{//Parse the excludedSubtrees field}
2117          error = \hyperlink{certificate_2x509__cert__parse_8c_a45f5611340a9cb8e6c48516ff977c213}{x509ParseGeneralSubtrees}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length});
2118          \textcolor{comment}{//Any error to report?}
2119          \textcolor{keywordflow}{if}(error)
2120             \textcolor{keywordflow}{return} error;
2121 
2122          \textcolor{comment}{//Raw contents of the ASN.1 sequence}
2123          nameConstraints->\hyperlink{structX509NameConstraints_a187e11b65d21e9eb4c9124c133c0fbbc}{excludedSubtrees} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2124          nameConstraints->\hyperlink{structX509NameConstraints_a5f03d1d2e8b8eddf4f1e99bbb61254af}{excludedSubtreesLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2125       \}
2126       \textcolor{keywordflow}{else}
2127       \{
2128          \textcolor{comment}{//Report an error}
2129          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca2daa3c161edaa4477d1ae954c2136008}{ERROR\_INVALID\_TYPE};
2130       \}
2131 
2132       \textcolor{comment}{//Next item}
2133       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2134       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2135    \}
2136 
2137    \textcolor{comment}{//Successful processing}
2138    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2139 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}\label{certificate_2x509__cert__parse_8c_afa46e3a241a78da0e97f636979a682cf}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Ns\+Cert\+Type@{x509\+Parse\+Ns\+Cert\+Type}}
\index{x509\+Parse\+Ns\+Cert\+Type@{x509\+Parse\+Ns\+Cert\+Type}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Ns\+Cert\+Type()}{x509ParseNsCertType()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Ns\+Cert\+Type (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{ns\+Cert\+Type }\end{DoxyParamCaption})}



Parse Netscape\+Cert\+Type extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em ns\+Cert\+Type} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2678 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2680 \{
2681    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2682    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2683 
2684    \textcolor{comment}{//Debug message}
2685    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing NetscapeCertType...\(\backslash\)r\(\backslash\)n"});
2686 
2687    \textcolor{comment}{//The NetscapeCertType extension limit the use of a certificate}
2688    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2689    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2690    \textcolor{keywordflow}{if}(error)
2691       \textcolor{keywordflow}{return} error;
2692 
2693    \textcolor{comment}{//Enforce encoding, class and type}
2694    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
2695    \textcolor{comment}{//Invalid tag?}
2696    \textcolor{keywordflow}{if}(error)
2697       \textcolor{keywordflow}{return} error;
2698 
2699    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
2700    \textcolor{comment}{//of unused bits in the final subsequent octet}
2701    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
2702       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2703 
2704    \textcolor{comment}{//Sanity check}
2705    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] >= 8)
2706       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2707 
2708    \textcolor{comment}{//Clear bit string}
2709    *nsCertType = 0;
2710 
2711    \textcolor{comment}{//Read bits b0 to b7}
2712    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} >= 2)
2713       *nsCertType |= \hyperlink{cpu__endian_8c_af2ffdcd294086e82ec95ff4ade458aea}{reverseInt8}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[1]);
2714 
2715    \textcolor{comment}{//Successful processing}
2716    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2717 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a69067e7a8941f2329cbbb3e3a1413887}\label{certificate_2x509__cert__parse_8c_a69067e7a8941f2329cbbb3e3a1413887}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Policy\+Constraints@{x509\+Parse\+Policy\+Constraints}}
\index{x509\+Parse\+Policy\+Constraints@{x509\+Parse\+Policy\+Constraints}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Policy\+Constraints()}{x509ParsePolicyConstraints()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Policy\+Constraints (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Policy\+Constraints extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2149 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2150 \{
2151    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2152    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2153 
2154    \textcolor{comment}{//Debug message}
2155    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing PolicyConstraints...\(\backslash\)r\(\backslash\)n"});
2156 
2157    \textcolor{comment}{//The PolicyConstraints structure shall contain a valid sequence}
2158    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2159    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2160    \textcolor{keywordflow}{if}(error)
2161       \textcolor{keywordflow}{return} error;
2162 
2163    \textcolor{comment}{//Conforming CAs must not issue certificates where policy constraints is an}
2164    \textcolor{comment}{//empty sequence (refer to RFC 5280, section 4.2.1.11)}
2165    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2166       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2167 
2168    \textcolor{comment}{//Successful processing}
2169    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2170 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a71cf108498b2a57b5306de9f005f5a96}\label{certificate_2x509__cert__parse_8c_a71cf108498b2a57b5306de9f005f5a96}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Policy\+Mappings@{x509\+Parse\+Policy\+Mappings}}
\index{x509\+Parse\+Policy\+Mappings@{x509\+Parse\+Policy\+Mappings}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Policy\+Mappings()}{x509ParsePolicyMappings()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Policy\+Mappings (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Parse Policy\+Mappings extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2180 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2181 \{
2182    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2183    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2184 
2185    \textcolor{comment}{//Debug message}
2186    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing PolicyMappings...\(\backslash\)r\(\backslash\)n"});
2187 
2188    \textcolor{comment}{//The PolicyMappings structure shall contain a valid sequence}
2189    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2190    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2191    \textcolor{keywordflow}{if}(error)
2192       \textcolor{keywordflow}{return} error;
2193 
2194    \textcolor{comment}{//The sequence cannot be empty (refer to RFC 5280, section 4.2.1.5)}
2195    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} == 0)
2196       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2197 
2198    \textcolor{comment}{//Successful processing}
2199    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2200 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a695e24dfcc2e5669cb0ad6068298ce3f}\label{certificate_2x509__cert__parse_8c_a695e24dfcc2e5669cb0ad6068298ce3f}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Rsa\+Pss\+Hash\+Algo@{x509\+Parse\+Rsa\+Pss\+Hash\+Algo}}
\index{x509\+Parse\+Rsa\+Pss\+Hash\+Algo@{x509\+Parse\+Rsa\+Pss\+Hash\+Algo}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Hash\+Algo()}{x509ParseRsaPssHashAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Hash\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS hash algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 541 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
543 \{
544 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
545    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
546    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
547 
548    \textcolor{comment}{//Read the contents of the structure}
549    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
550    \textcolor{comment}{//Failed to decode ASN.1 tag?}
551    \textcolor{keywordflow}{if}(error)
552       \textcolor{keywordflow}{return} error;
553 
554    \textcolor{comment}{//Point to the first field of the sequence}
555    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
556    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
557 
558    \textcolor{comment}{//Read hash algorithm identifier}
559    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
560    \textcolor{comment}{//Failed to decode ASN.1 tag?}
561    \textcolor{keywordflow}{if}(error)
562       \textcolor{keywordflow}{return} error;
563 
564    \textcolor{comment}{//Save the hash algorithm identifier}
565    rsaPssParams->\hyperlink{structX509RsaPssParameters_a21f002c671582b73f60617bc23116db3}{hashAlgo} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
566    rsaPssParams->\hyperlink{structX509RsaPssParameters_a91b731f749a7d1bfafbb8595f898ff2e}{hashAlgoLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
567 
568    \textcolor{comment}{//No error to report}
569    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
570 \textcolor{preprocessor}{#else}
571    \textcolor{comment}{//Not implemented}
572    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
573 \textcolor{preprocessor}{#endif}
574 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_aad327c7f3da9180fbf94b8e4363bda40}\label{certificate_2x509__cert__parse_8c_aad327c7f3da9180fbf94b8e4363bda40}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Rsa\+Pss\+Parameters@{x509\+Parse\+Rsa\+Pss\+Parameters}}
\index{x509\+Parse\+Rsa\+Pss\+Parameters@{x509\+Parse\+Rsa\+Pss\+Parameters}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Parameters()}{x509ParseRsaPssParameters()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Parameters (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 466 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
468 \{
469 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
470    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
471    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
472 
473 \textcolor{preprocessor}{#if(X509\_SHA1\_SUPPORT == ENABLED && SHA1\_SUPPORT == ENABLED)}
474    \textcolor{comment}{//The default hash algorithm is SHA-1 (refer to RFC 4055, section 3.1)}
475    rsaPssParams->\hyperlink{structX509RsaPssParameters_a21f002c671582b73f60617bc23116db3}{hashAlgo} = \hyperlink{sha1_8h_ab109ac10e322227e63da00290a746a44}{SHA1\_OID};
476    rsaPssParams->\hyperlink{structX509RsaPssParameters_a91b731f749a7d1bfafbb8595f898ff2e}{hashAlgoLen} = \textcolor{keyword}{sizeof}(\hyperlink{sha1_8h_ab109ac10e322227e63da00290a746a44}{SHA1\_OID});
477 \textcolor{preprocessor}{#endif}
478 
479    \textcolor{comment}{//The default length of the salt is 20 (refer to RFC 4055, section 3.1)}
480    rsaPssParams->\hyperlink{structX509RsaPssParameters_a0472b015828361df56b2550e4c1ac220}{saltLen} = 20;
481 
482    \textcolor{comment}{//Read the contents of the structure}
483    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
484    \textcolor{comment}{//Failed to decode ASN.1 tag?}
485    \textcolor{keywordflow}{if}(error)
486       \textcolor{keywordflow}{return} error;
487 
488    \textcolor{comment}{//Point to the first field of the sequence}
489    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
490    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
491 
492    \textcolor{comment}{//Parse RSASSA-PSS parameters}
493    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
494    \{
495       \textcolor{comment}{//Read current parameter}
496       error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
497       \textcolor{comment}{//Failed to decode ASN.1 tag?}
498       \textcolor{keywordflow}{if}(error)
499          \textcolor{keywordflow}{return} error;
500 
501       \textcolor{comment}{//The tags in this sequence are explicit}
502       \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC}, 
      0))
503       \{
504          \textcolor{comment}{//Parse hashAlgorithm field}
505          error = \hyperlink{certificate_2x509__cert__parse_8c_a695e24dfcc2e5669cb0ad6068298ce3f}{x509ParseRsaPssHashAlgo}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, rsaPssParams);
506          \textcolor{comment}{//Any error to report?}
507          \textcolor{keywordflow}{if}(error)
508             \textcolor{keywordflow}{return} error;
509       \}
510       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, 
      \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC}, 2))
511       \{
512          \textcolor{comment}{//Parse saltLength field}
513          error = \hyperlink{certificate_2x509__cert__parse_8c_aa9f385740a40d71e149e795c3bb3e4e0}{x509ParseRsaPssSaltLength}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, rsaPssParams);
514          \textcolor{comment}{//Any error to report?}
515          \textcolor{keywordflow}{if}(error)
516             \textcolor{keywordflow}{return} error;
517       \}
518 
519       \textcolor{comment}{//Next parameter}
520       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
521       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
522    \}
523 
524    \textcolor{comment}{//Successful processing}
525    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
526 \textcolor{preprocessor}{#else}
527    \textcolor{comment}{//Not implemented}
528    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
529 \textcolor{preprocessor}{#endif}
530 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_aa9f385740a40d71e149e795c3bb3e4e0}\label{certificate_2x509__cert__parse_8c_aa9f385740a40d71e149e795c3bb3e4e0}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Rsa\+Pss\+Salt\+Length@{x509\+Parse\+Rsa\+Pss\+Salt\+Length}}
\index{x509\+Parse\+Rsa\+Pss\+Salt\+Length@{x509\+Parse\+Rsa\+Pss\+Salt\+Length}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Pss\+Salt\+Length()}{x509ParseRsaPssSaltLength()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Pss\+Salt\+Length (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPssParameters}{X509\+Rsa\+Pss\+Parameters} $\ast$}]{rsa\+Pss\+Params }\end{DoxyParamCaption})}



Parse R\+S\+A\+S\+S\+A-\/\+P\+SS salt length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Pss\+Params} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 585 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
587 \{
588 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
589    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
590    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} saltLen;
591    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
592 
593    \textcolor{comment}{//Read the saltLength field}
594    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag, &saltLen);
595    \textcolor{comment}{//Failed to decode ASN.1 tag?}
596    \textcolor{keywordflow}{if}(error)
597       \textcolor{keywordflow}{return} error;
598 
599    \textcolor{comment}{//Sanity check}
600    \textcolor{keywordflow}{if}(saltLen < 0)
601       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
602 
603    \textcolor{comment}{//Save the length of the salt}
604    rsaPssParams->\hyperlink{structX509RsaPssParameters_a0472b015828361df56b2550e4c1ac220}{saltLen} = saltLen;
605 
606    \textcolor{comment}{//No error to report}
607    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
608 \textcolor{preprocessor}{#else}
609    \textcolor{comment}{//Not implemented}
610    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
611 \textcolor{preprocessor}{#endif}
612 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}\label{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Rsa\+Public\+Key@{x509\+Parse\+Rsa\+Public\+Key}}
\index{x509\+Parse\+Rsa\+Public\+Key@{x509\+Parse\+Rsa\+Public\+Key}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Rsa\+Public\+Key()}{x509ParseRsaPublicKey()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Rsa\+Public\+Key (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509RsaPublicKey}{X509\+Rsa\+Public\+Key} $\ast$}]{rsa\+Public\+Key }\end{DoxyParamCaption})}



Parse R\+S\+A\+Public\+Key structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em rsa\+Public\+Key} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1300 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1302 \{
1303 \textcolor{preprocessor}{#if (X509\_RSA\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1304    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1305    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1306 
1307    \textcolor{comment}{//Debug message}
1308    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing RSAPublicKey...\(\backslash\)r\(\backslash\)n"});
1309 
1310    \textcolor{comment}{//Read RSAPublicKey structure}
1311    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1312    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1313    \textcolor{keywordflow}{if}(error)
1314       \textcolor{keywordflow}{return} error;
1315 
1316    \textcolor{comment}{//Point to the first field}
1317    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1318    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1319 
1320    \textcolor{comment}{//Read Modulus field}
1321    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1322    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1323    \textcolor{keywordflow}{if}(error)
1324       \textcolor{keywordflow}{return} error;
1325 
1326    \textcolor{comment}{//Enforce encoding, class and type}
1327    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1328    \textcolor{comment}{//Invalid tag?}
1329    \textcolor{keywordflow}{if}(error)
1330       \textcolor{keywordflow}{return} error;
1331 
1332    \textcolor{comment}{//Get the modulus}
1333    rsaPublicKey->\hyperlink{structX509RsaPublicKey_acda40dfd0c6f2b68e0ba227e59bfb727}{n} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1334    rsaPublicKey->\hyperlink{structX509RsaPublicKey_a8311e7f5f00c9faaf36640f9dbd7cdb5}{nLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1335 
1336    \textcolor{comment}{//Point to the next field}
1337    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1338    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1339 
1340    \textcolor{comment}{//Read PublicExponent field}
1341    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1342    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1343    \textcolor{keywordflow}{if}(error)
1344       \textcolor{keywordflow}{return} error;
1345 
1346    \textcolor{comment}{//Enforce encoding, class and type}
1347    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
1348    \textcolor{comment}{//Invalid tag?}
1349    \textcolor{keywordflow}{if}(error)
1350       \textcolor{keywordflow}{return} error;
1351 
1352    \textcolor{comment}{//Get the public exponent}
1353    rsaPublicKey->\hyperlink{structX509RsaPublicKey_a13db0b045295934879aa34cea8996ef6}{e} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1354    rsaPublicKey->\hyperlink{structX509RsaPublicKey_af531c21f55e40fb06165cd151dd96fa4}{eLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1355 
1356    \textcolor{comment}{//Successful processing}
1357    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1358 \textcolor{preprocessor}{#else}
1359    \textcolor{comment}{//Not implemented}
1360    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cab61c5ef368fbf03fdc1fb566c63f2f9a}{ERROR\_NOT\_IMPLEMENTED};
1361 \textcolor{preprocessor}{#endif}
1362 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}\label{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Serial\+Number@{x509\+Parse\+Serial\+Number}}
\index{x509\+Parse\+Serial\+Number@{x509\+Parse\+Serial\+Number}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Serial\+Number()}{x509ParseSerialNumber()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Serial\+Number (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SerialNumber}{X509\+Serial\+Number} $\ast$}]{serial\+Number }\end{DoxyParamCaption})}



Parse Serial\+Number field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em serial\+Number} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 354 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
356 \{
357    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
358    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
359 
360    \textcolor{comment}{//Debug message}
361    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SerialNumber...\(\backslash\)r\(\backslash\)n"});
362 
363    \textcolor{comment}{//Read the contents of the SerialNumber structure}
364    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
365    \textcolor{comment}{//Failed to decode ASN.1 tag?}
366    \textcolor{keywordflow}{if}(error)
367       \textcolor{keywordflow}{return} error;
368 
369    \textcolor{comment}{//Save the total length of the field}
370    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
371 
372    \textcolor{comment}{//Enforce encoding, class and type}
373    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994}{ASN1\_TYPE\_INTEGER});
374    \textcolor{comment}{//Invalid tag?}
375    \textcolor{keywordflow}{if}(error)
376       \textcolor{keywordflow}{return} error;
377 
378    \textcolor{comment}{//Check the length of the serial number}
379    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1)
380       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
381 
382    \textcolor{comment}{//Non-conforming CAs may issue certificates with serial numbers that are}
383    \textcolor{comment}{//negative or zero. Certificate users should be prepared to gracefully}
384    \textcolor{comment}{//handle such certificates (refer to RFC 5280, section 4.1.2.2)}
385    serialNumber->\hyperlink{structX509SerialNumber_a04490ca0624096caf478beed3331d552}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
386    serialNumber->\hyperlink{structX509SerialNumber_ab076f0a46bcefa47cdc8135d5990ab78}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
387 
388    \textcolor{comment}{//No error to report}
389    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
390 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a1772db63e91fc1e65e14931e67a7e084}\label{certificate_2x509__cert__parse_8c_a1772db63e91fc1e65e14931e67a7e084}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Signature@{x509\+Parse\+Signature}}
\index{x509\+Parse\+Signature@{x509\+Parse\+Signature}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature()}{x509ParseSignature()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$}]{signature }\end{DoxyParamCaption})}



Parse Signature field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 402 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
404 \{
405    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
406    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
407 
408    \textcolor{comment}{//Debug message}
409    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Signature...\(\backslash\)r\(\backslash\)n"});
410 
411    \textcolor{comment}{//Read the contents of the Signature structure}
412    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
413    \textcolor{comment}{//Failed to decode ASN.1 tag?}
414    \textcolor{keywordflow}{if}(error)
415       \textcolor{keywordflow}{return} error;
416 
417    \textcolor{comment}{//Save the total length of the field}
418    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
419 
420    \textcolor{comment}{//Point to the first field of the sequence}
421    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
422    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
423 
424    \textcolor{comment}{//Read signature algorithm identifier}
425    error = \hyperlink{asn1_8c_a842c029a80fcf3c0c1a2a8bf1ba2d96c}{asn1ReadOid}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
426    \textcolor{comment}{//Failed to decode ASN.1 tag?}
427    \textcolor{keywordflow}{if}(error)
428       \textcolor{keywordflow}{return} error;
429 
430    \textcolor{comment}{//Save the signature algorithm identifier}
431    signature->\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
432    signature->\hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
433 
434    \textcolor{comment}{//Point to the next field (if any)}
435    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
436    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
437 
438 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
439    \textcolor{comment}{//RSASSA-PSS algorithm identifier?}
440    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
441    \{
442       \textcolor{comment}{//Read RSASSA-PSS parameters}
443       error = \hyperlink{certificate_2x509__cert__parse_8c_aad327c7f3da9180fbf94b8e4363bda40}{x509ParseRsaPssParameters}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &signature->\hyperlink{structX509SignatureAlgoId_aabb448030d8783d06739cdd2c660dde4}{rsaPssParams});
444    \}
445    \textcolor{keywordflow}{else}
446 \textcolor{preprocessor}{#endif}
447    \textcolor{comment}{//Unknown algorithm identifier?}
448    \{
449       \textcolor{comment}{//The parameters are optional}
450       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
451    \}
452 
453    \textcolor{comment}{//Return status code}
454    \textcolor{keywordflow}{return} error;
455 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}\label{certificate_2x509__cert__parse_8c_adc0fa5cb6436afc727cce7f359621beb}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Signature\+Algo@{x509\+Parse\+Signature\+Algo}}
\index{x509\+Parse\+Signature\+Algo@{x509\+Parse\+Signature\+Algo}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature\+Algo()}{x509ParseSignatureAlgo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature\+Algo (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureAlgoId}{X509\+Signature\+Algo\+Id} $\ast$}]{signature\+Algo }\end{DoxyParamCaption})}



Parse Signature\+Algorithm structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature\+Algo} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2729 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2731 \{
2732    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2733    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2734 
2735    \textcolor{comment}{//Debug message}
2736    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing SignatureAlgorithm...\(\backslash\)r\(\backslash\)n"});
2737 
2738    \textcolor{comment}{//Read the contents of the SignatureAlgorithm field}
2739    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2740    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2741    \textcolor{keywordflow}{if}(error)
2742       \textcolor{keywordflow}{return} error;
2743 
2744    \textcolor{comment}{//Save the total length of the field}
2745    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2746 
2747    \textcolor{comment}{//Read the inner tag}
2748    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag);
2749    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2750    \textcolor{keywordflow}{if}(error)
2751       \textcolor{keywordflow}{return} error;
2752 
2753    \textcolor{comment}{//This field must contain the same algorithm identifier as the signature}
2754    \textcolor{comment}{//field in the TBSCertificate sequence}
2755    error = \hyperlink{asn1_8c_a565e797369dd4ec4b722954715507907}{asn1CheckOid}(&tag, signatureAlgo->\hyperlink{structX509SignatureAlgoId_a98ec1f180733e1e0cc22b133f8a23416}{oid}, signatureAlgo->
      \hyperlink{structX509SignatureAlgoId_a4a15b78049b8e360a069b72f0c79b0f4}{oidLen});
2756    \textcolor{comment}{//Invalid tag?}
2757    \textcolor{keywordflow}{if}(error)
2758       \textcolor{keywordflow}{return} error;
2759 
2760    \textcolor{comment}{//Successful processing}
2761    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2762 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}\label{certificate_2x509__cert__parse_8c_acba116ee8ec551412ecdc02747355b3f}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Signature\+Value@{x509\+Parse\+Signature\+Value}}
\index{x509\+Parse\+Signature\+Value@{x509\+Parse\+Signature\+Value}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Signature\+Value()}{x509ParseSignatureValue()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Signature\+Value (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SignatureValue}{X509\+Signature\+Value} $\ast$}]{signature\+Value }\end{DoxyParamCaption})}



Parse Signature\+Value field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em signature\+Value} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2774 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2776 \{
2777    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2778    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2779 
2780    \textcolor{comment}{//Debug message}
2781    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing SignatureValue...\(\backslash\)r\(\backslash\)n"});
2782 
2783    \textcolor{comment}{//Read the contents of the SignatureValue structure}
2784    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2785    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2786    \textcolor{keywordflow}{if}(error)
2787       \textcolor{keywordflow}{return} error;
2788 
2789    \textcolor{comment}{//Save the total length of the field}
2790    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
2791 
2792    \textcolor{comment}{//Enforce encoding, class and type}
2793    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
2794    \textcolor{comment}{//Invalid tag?}
2795    \textcolor{keywordflow}{if}(error)
2796       \textcolor{keywordflow}{return} error;
2797 
2798    \textcolor{comment}{//The bit string shall contain an initial octet which encodes}
2799    \textcolor{comment}{//the number of unused bits in the final subsequent octet}
2800    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1 || tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] != 0x00)
2801       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
2802 
2803    \textcolor{comment}{//Get the signature value}
2804    signatureValue->\hyperlink{structX509SignatureValue_a3e53e8589cdfc0c22d30e85bebfa0625}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1;
2805    signatureValue->\hyperlink{structX509SignatureValue_af1bce8baf0e1a46212467145e00079d7}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1;
2806 
2807    \textcolor{comment}{//Successful processing}
2808    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2809 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}\label{certificate_2x509__cert__parse_8c_ad45d4fe20340f7cdf795f8a5338f7f3a}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Alt\+Name@{x509\+Parse\+Subject\+Alt\+Name}}
\index{x509\+Parse\+Subject\+Alt\+Name@{x509\+Parse\+Subject\+Alt\+Name}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Alt\+Name()}{x509ParseSubjectAltName()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Alt\+Name (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509SubjectAltName}{X509\+Subject\+Alt\+Name} $\ast$}]{subject\+Alt\+Name }\end{DoxyParamCaption})}



Parse Subject\+Alt\+Name extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em subject\+Alt\+Name} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2406 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2408 \{
2409    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2410    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
2411    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2412    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2413    \hyperlink{structX509GeneralName}{X509GeneralName} generalName;
2414 
2415    \textcolor{comment}{//Debug message}
2416    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing SubjectAltName...\(\backslash\)r\(\backslash\)n"});
2417 
2418    \textcolor{comment}{//The SubjectAltName structure shall contain a valid sequence}
2419    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2420    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2421    \textcolor{keywordflow}{if}(error)
2422       \textcolor{keywordflow}{return} error;
2423 
2424    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
2425    subjectAltName->\hyperlink{structX509SubjectAltName_a7d756442bef6565af58ede9410b2dc77}{rawData} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2426    subjectAltName->\hyperlink{structX509SubjectAltName_a87435ad32eda0d4b0a9229028521812b}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2427 
2428    \textcolor{comment}{//Point to the first item of the sequence}
2429    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2430    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2431 
2432    \textcolor{comment}{//The subject alternative name extension allows identities to be bound to the}
2433    \textcolor{comment}{//subject of the certificate. These identities may be included in addition}
2434    \textcolor{comment}{//to or in place of the identity in the subject field of the certificate}
2435    \textcolor{keywordflow}{for}(i = 0; \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0; i++)
2436    \{
2437       \textcolor{comment}{//Parse GeneralName field}
2438       error = \hyperlink{certificate_2x509__cert__parse_8c_aa329c231ea14f7d8b61a64db46be87e1}{x509ParseGeneralName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &generalName);
2439       \textcolor{comment}{//Any error to report?}
2440       \textcolor{keywordflow}{if}(error)
2441          \textcolor{keywordflow}{return} error;
2442 
2443       \textcolor{comment}{//Sanity check}
2444       \textcolor{keywordflow}{if}(i < \hyperlink{certificate_2x509__common_8h_ad4b18644ac42bdeede4fe0b1643ce954}{X509\_MAX\_SUBJECT\_ALT\_NAMES})
2445       \{
2446          \textcolor{comment}{//Save subject alternative name}
2447          subjectAltName->\hyperlink{structX509SubjectAltName_ab4a56143bba771858700f363a8da4647}{generalNames}[i] = generalName;
2448       \}
2449 
2450       \textcolor{comment}{//Next item}
2451       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2452       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
2453    \}
2454 
2455    \textcolor{comment}{//If the SubjectAltName extension is present, the sequence must contain at}
2456    \textcolor{comment}{//least one entry (refer to RFC 5280, section 4.2.1.6)}
2457    \textcolor{keywordflow}{if}(i == 0)
2458       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
2459 
2460    \textcolor{comment}{//Save the number of subject alternative names}
2461    subjectAltName->\hyperlink{structX509SubjectAltName_a320072e6555af4e2bd76d9d154ef7eca}{numGeneralNames} = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(i, 
      \hyperlink{certificate_2x509__common_8h_ad4b18644ac42bdeede4fe0b1643ce954}{X509\_MAX\_SUBJECT\_ALT\_NAMES});
2462 
2463    \textcolor{comment}{//Successful processing}
2464    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2465 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}\label{certificate_2x509__cert__parse_8c_a86a7d15f4e1047be4b4a75944368ee85}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Key\+Id@{x509\+Parse\+Subject\+Key\+Id}}
\index{x509\+Parse\+Subject\+Key\+Id@{x509\+Parse\+Subject\+Key\+Id}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Key\+Id()}{x509ParseSubjectKeyId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Key\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{structX509SubjectKeyId}{X509\+Subject\+Key\+Id} $\ast$}]{subject\+Key\+Id }\end{DoxyParamCaption})}



Parse Subject\+Key\+Identifier extension. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em subject\+Key\+Id} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 2587 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
2589 \{
2590    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
2591    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
2592 
2593    \textcolor{comment}{//Debug message}
2594    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing SubjectKeyIdentifier...\(\backslash\)r\(\backslash\)n"});
2595 
2596    \textcolor{comment}{//The subject key identifier extension provides a means of identifying}
2597    \textcolor{comment}{//certificates that contain a particular public key}
2598    error = \hyperlink{asn1_8c_a08b7995f0473e1ff62a9061f31410b2f}{asn1ReadOctetString}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
2599    \textcolor{comment}{//Failed to decode ASN.1 tag?}
2600    \textcolor{keywordflow}{if}(error)
2601       \textcolor{keywordflow}{return} error;
2602 
2603    \textcolor{comment}{//Save the subject key identifier}
2604    subjectKeyId->\hyperlink{structX509SubjectKeyId_ac13791883d5af3098c8fcecd596f4737}{value} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
2605    subjectKeyId->\hyperlink{structX509SubjectKeyId_ae72259e33329d3224c90547e63f95804}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
2606 
2607    \textcolor{comment}{//Successful processing}
2608    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
2609 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}\label{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Public\+Key\+Info@{x509\+Parse\+Subject\+Public\+Key\+Info}}
\index{x509\+Parse\+Subject\+Public\+Key\+Info@{x509\+Parse\+Subject\+Public\+Key\+Info}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Public\+Key\+Info()}{x509ParseSubjectPublicKeyInfo()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Public\+Key\+Info (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509SubjectPublicKeyInfo}{X509\+Subject\+Public\+Key\+Info} $\ast$}]{subject\+Public\+Key\+Info }\end{DoxyParamCaption})}



Parse Subject\+Public\+Key\+Info structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em subject\+Public\+Key\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1045 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1047 \{
1048    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1049    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1050    \textcolor{keywordtype}{size\_t} oidLen;
1051    \textcolor{keyword}{const} \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *\hyperlink{mib__common_8h_a5d78f42b3545deb9bbd305138506c7a7}{oid};
1052    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1053 
1054    \textcolor{comment}{//Debug message}
1055    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SubjectPublicKeyInfo...\(\backslash\)r\(\backslash\)n"});
1056 
1057    \textcolor{comment}{//Read SubjectPublicKeyInfo field}
1058    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1059    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1060    \textcolor{keywordflow}{if}(error)
1061       \textcolor{keywordflow}{return} error;
1062 
1063    \textcolor{comment}{//Save the total length of the field}
1064    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1065 
1066    \textcolor{comment}{//Raw contents of the ASN.1 sequence}
1067    subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a40099adba11d706e320a0d553b9e2438}{rawData} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
1068    subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a1397c8953cfe641fda3a326479b48dbd}{rawDataLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1069 
1070    \textcolor{comment}{//Point to the first field}
1071    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
1072    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
1073 
1074    \textcolor{comment}{//Read AlgorithmIdentifier field}
1075    error = \hyperlink{certificate_2x509__cert__parse_8c_a2de67fd41226a162fa5f3fb14539108f}{x509ParseAlgorithmIdentifier}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, subjectPublicKeyInfo);
1076    \textcolor{comment}{//Any error to report?}
1077    \textcolor{keywordflow}{if}(error)
1078       \textcolor{keywordflow}{return} error;
1079 
1080    \textcolor{comment}{//Point to the next field}
1081    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1082    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
1083 
1084    \textcolor{comment}{//The SubjectPublicKey structure is encapsulated within a bit string}
1085    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1086    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1087    \textcolor{keywordflow}{if}(error)
1088       \textcolor{keywordflow}{return} error;
1089 
1090    \textcolor{comment}{//Enforce encoding, class and type}
1091    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfab40c213cd2fda439f157e8e4523d020c}{ASN1\_TYPE\_BIT\_STRING});
1092    \textcolor{comment}{//Invalid tag?}
1093    \textcolor{keywordflow}{if}(error)
1094       \textcolor{keywordflow}{return} error;
1095 
1096    \textcolor{comment}{//The bit string shall contain an initial octet which encodes the number}
1097    \textcolor{comment}{//of unused bits in the final subsequent octet}
1098    \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} < 1 || tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}[0] != 0x00)
1099       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
1100 
1101    \textcolor{comment}{//Retrieve signature algorithm identifier}
1102    oid = subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a90a8b808782b18de901306acd49b0706}{oid};
1103    oidLen = subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_a7c5d6f507f653f6085ba56e6b4b55912}{oidLen};
1104 
1105 \textcolor{preprocessor}{#if (X509\_RSA\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1106    \textcolor{comment}{//RSA algorithm identifier?}
1107    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_a05da0bdcba7d0be3da2cc921a8a0dd50}{RSA\_ENCRYPTION\_OID})))
1108    \{
1109       \textcolor{comment}{//Read RSAPublicKey structure}
1110       error = \hyperlink{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}{x509ParseRsaPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1111          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey});
1112    \}
1113    \textcolor{keywordflow}{else}
1114 \textcolor{preprocessor}{#endif}
1115 \textcolor{preprocessor}{#if (X509\_RSA\_PSS\_SUPPORT == ENABLED && RSA\_SUPPORT == ENABLED)}
1116    \textcolor{comment}{//RSA-PSS algorithm identifier?}
1117    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{rsa_8c_ac136e2cc009f56598c67cf31f37c0d2b}{RSASSA\_PSS\_OID})))
1118    \{
1119       \textcolor{comment}{//Read RSAPublicKey structure}
1120       error = \hyperlink{certificate_2x509__cert__parse_8c_a9af828c1f9152b3f008a9334d071bac2}{x509ParseRsaPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1121          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_ab8bc6398001418fd21271ff8b791caab}{rsaPublicKey});
1122    \}
1123    \textcolor{keywordflow}{else}
1124 \textcolor{preprocessor}{#endif}
1125 \textcolor{preprocessor}{#if (X509\_DSA\_SUPPORT == ENABLED && DSA\_SUPPORT == ENABLED)}
1126    \textcolor{comment}{//DSA algorithm identifier?}
1127    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{dsa_8c_aec62d423add8486c829eacb574ebe4f3}{DSA\_OID})))
1128    \{
1129       \textcolor{comment}{//Read DSAPublicKey structure}
1130       error = \hyperlink{certificate_2x509__cert__parse_8c_a3d52f72e0b1285700bcc30b5b6b54ac1}{x509ParseDsaPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1131          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_aca3c9dc2e4fefc2e5ac0f1db6baedccc}{dsaPublicKey});
1132    \}
1133    \textcolor{keywordflow}{else}
1134 \textcolor{preprocessor}{#endif}
1135 \textcolor{preprocessor}{#if (X509\_ECDSA\_SUPPORT == ENABLED && ECDSA\_SUPPORT == ENABLED)}
1136    \textcolor{comment}{//EC public key identifier?}
1137    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID}, \textcolor{keyword}{sizeof}(
      \hyperlink{ec_8c_a5ff93c201b1e50b6fda04774a2fa537c}{EC\_PUBLIC\_KEY\_OID})))
1138    \{
1139       \textcolor{comment}{//Read ECPublicKey structure}
1140       error = \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509ParseEcPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1141          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey});
1142    \}
1143    \textcolor{keywordflow}{else}
1144 \textcolor{preprocessor}{#endif}
1145 \textcolor{preprocessor}{#if (X509\_ED25519\_SUPPORT == ENABLED && ED25519\_SUPPORT == ENABLED)}
1146    \textcolor{comment}{//X25519 or Ed25519 algorithm identifier?}
1147    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ab59e2fc8d4de54edaf7bb4866a57beae}{X25519\_OID})) ||
1148       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a0c0db5ac9072998c05e021d51fd03992}{ED25519\_OID})))
1149    \{
1150       \textcolor{comment}{//Read ECPublicKey structure}
1151       error = \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509ParseEcPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1152          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey});
1153    \}
1154    \textcolor{keywordflow}{else}
1155 \textcolor{preprocessor}{#endif}
1156 \textcolor{preprocessor}{#if (X509\_ED448\_SUPPORT == ENABLED && ED448\_SUPPORT == ENABLED)}
1157    \textcolor{comment}{//X448 or Ed448 algorithm identifier?}
1158    \textcolor{keywordflow}{if}(!\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_a6f5d28c07c26ec1d021c2eb40067a892}{X448\_OID})) ||
1159       !\hyperlink{oid_8c_a3f24a7995a2a7aa587379ec6e1922e36}{oidComp}(oid, oidLen, \hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID}, \textcolor{keyword}{sizeof}(\hyperlink{ec__curves_8c_ad355985d25e281438e8d813c171aea13}{ED448\_OID})))
1160    \{
1161       \textcolor{comment}{//Read ECPublicKey structure}
1162       error = \hyperlink{certificate_2x509__cert__parse_8c_ae09cd9fb14828d4666570022bdf094ab}{x509ParseEcPublicKey}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 1, tag.
      \hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} - 1,
1163          &subjectPublicKeyInfo->\hyperlink{structX509SubjectPublicKeyInfo_af9b3b1e9d01c44192f01edbf14001622}{ecPublicKey});
1164    \}
1165    \textcolor{keywordflow}{else}
1166 \textcolor{preprocessor}{#endif}
1167    \textcolor{comment}{//The certificate does not contain any valid public key...}
1168    \{
1169       \textcolor{comment}{//Report an error}
1170       error = \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac22a1806531a09ab25cc2ef268b2eeb0}{ERROR\_BAD\_CERTIFICATE};
1171    \}
1172 
1173    \textcolor{comment}{//Return status code}
1174    \textcolor{keywordflow}{return} error;
1175 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}\label{certificate_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Subject\+Unique\+Id@{x509\+Parse\+Subject\+Unique\+Id}}
\index{x509\+Parse\+Subject\+Unique\+Id@{x509\+Parse\+Subject\+Unique\+Id}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Subject\+Unique\+Id()}{x509ParseSubjectUniqueId()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Subject\+Unique\+Id (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length }\end{DoxyParamCaption})}



Parse Subject\+Unique\+ID structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 1635 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
1637 \{
1638    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
1639    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
1640 
1641    \textcolor{comment}{//No more data to process?}
1642    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} == 0)
1643    \{
1644       \textcolor{comment}{//The SubjectUniqueID field is optional}
1645       *totalLength = 0;
1646       \textcolor{comment}{//Exit immediately}
1647       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1648    \}
1649 
1650    \textcolor{comment}{//Implicit tagging is used to encode the SubjectUniqueID field}
1651    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
1652    \textcolor{comment}{//Failed to decode ASN.1 tag?}
1653    \textcolor{keywordflow}{if}(error)
1654       \textcolor{keywordflow}{return} error;
1655 
1656    \textcolor{comment}{//Enforce encoding, class and type}
1657    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       2);
1658    \textcolor{comment}{//Invalid tag?}
1659    \textcolor{keywordflow}{if}(error)
1660    \{
1661       \textcolor{comment}{//The SubjectUniqueID field is optional}
1662       *totalLength = 0;
1663       \textcolor{comment}{//Exit immediately}
1664       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1665    \}
1666 
1667    \textcolor{comment}{//Save the total length of the field}
1668    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
1669 
1670    \textcolor{comment}{//Debug message}
1671    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing SubjectUniqueID...\(\backslash\)r\(\backslash\)n"});
1672 
1673    \textcolor{comment}{//Conforming applications should be capable of parsing certificates that}
1674    \textcolor{comment}{//include unique identifiers, but there are no processing requirements}
1675    \textcolor{comment}{//associated with the unique identifiers}
1676    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1677 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_aa7675ee05506115f9b21a18385282630}\label{certificate_2x509__cert__parse_8c_aa7675ee05506115f9b21a18385282630}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Tbs\+Certificate@{x509\+Parse\+Tbs\+Certificate}}
\index{x509\+Parse\+Tbs\+Certificate@{x509\+Parse\+Tbs\+Certificate}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Tbs\+Certificate()}{x509ParseTbsCertificate()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Tbs\+Certificate (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509CertificateInfo}{X509\+Certificate\+Info} $\ast$}]{cert\+Info }\end{DoxyParamCaption})}



Parse T\+B\+S\+Certificate structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em cert\+Info} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 130 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
132 \{
133    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
134    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
135    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
136 
137    \textcolor{comment}{//Debug message}
138    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"  Parsing TBSCertificate...\(\backslash\)r\(\backslash\)n"});
139 
140    \textcolor{comment}{//Read the contents of the TBSCertificate structure}
141    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
142    \textcolor{comment}{//Failed to decode ASN.1 tag?}
143    \textcolor{keywordflow}{if}(error)
144       \textcolor{keywordflow}{return} error;
145 
146    \textcolor{comment}{//Save the total length of the field}
147    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
148 
149    \textcolor{comment}{//The ASN.1 DER encoded TBSCertificate is used as the input to the}
150    \textcolor{comment}{//signature function}
151    certInfo->\hyperlink{structX509CertificateInfo_a6f0f56fdd661c01753b5408a831f3dcd}{tbsCertificate} = \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data};
152    certInfo->\hyperlink{structX509CertificateInfo_a4db5f8e3cc589a8445eebf86863e205a}{tbsCertificateLen} = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
153 
154    \textcolor{comment}{//Point to the very first field of the TBSCertificate}
155    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
156    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
157 
158    \textcolor{comment}{//Parse Version field}
159    error = \hyperlink{certificate_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}{x509ParseVersion}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_a15902fd60ae1f744a24fed017535891f}{version});
160    \textcolor{comment}{//Any parsing error?}
161    \textcolor{keywordflow}{if}(error)
162       \textcolor{keywordflow}{return} error;
163 
164    \textcolor{comment}{//Point to the next field}
165    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
166    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
167 
168    \textcolor{comment}{//Parse SerialNumber field}
169    error = \hyperlink{certificate_2x509__cert__parse_8c_a936f23f5633f2c2c9c767d27f2196f26}{x509ParseSerialNumber}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_a7e16de43b3c58b80c62fbd633d4f1a42}{serialNumber});
170    \textcolor{comment}{//Any parsing error?}
171    \textcolor{keywordflow}{if}(error)
172       \textcolor{keywordflow}{return} error;
173 
174    \textcolor{comment}{//Point to the next field}
175    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
176    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
177 
178    \textcolor{comment}{//Parse Signature field}
179    error = \hyperlink{certificate_2x509__cert__parse_8c_a1772db63e91fc1e65e14931e67a7e084}{x509ParseSignature}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_a557f43736fe7dab190eac1cd31559281}{signatureAlgo});
180    \textcolor{comment}{//Any parsing error?}
181    \textcolor{keywordflow}{if}(error)
182       \textcolor{keywordflow}{return} error;
183 
184    \textcolor{comment}{//Point to the next field}
185    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
186    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
187 
188    \textcolor{comment}{//Parse Issuer field}
189    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_a21948b3fc93a9d531e6855243c5681c7}{issuer});
190    \textcolor{comment}{//Any parsing error?}
191    \textcolor{keywordflow}{if}(error)
192       \textcolor{keywordflow}{return} error;
193 
194    \textcolor{comment}{//Point to the next field}
195    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
196    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
197 
198    \textcolor{comment}{//Parse Validity field}
199    error = \hyperlink{certificate_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}{x509ParseValidity}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_aca3c2dbc54d2b8a711ed3b9c3c595fa8}{validity});
200    \textcolor{comment}{//Any parsing error?}
201    \textcolor{keywordflow}{if}(error)
202       \textcolor{keywordflow}{return} error;
203 
204    \textcolor{comment}{//Point to the next field}
205    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
206    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
207 
208    \textcolor{comment}{//Parse Subject field}
209    error = \hyperlink{certificate_2x509__cert__parse_8c_a91dc365cee54dd84e0e926317b7a1cea}{x509ParseName}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_adaf5e2c713f42a2ca307b2d4eed55a0e}{subject});
210    \textcolor{comment}{//Any parsing error?}
211    \textcolor{keywordflow}{if}(error)
212       \textcolor{keywordflow}{return} error;
213 
214    \textcolor{comment}{//Point to the next field}
215    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
216    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
217 
218    \textcolor{comment}{//Parse SubjectPublicKeyInfo field}
219    error = \hyperlink{certificate_2x509__cert__parse_8c_a17bacf95e872d7fdcd6cec43b1724dd6}{x509ParseSubjectPublicKeyInfo}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 
      \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n,
220       &certInfo->\hyperlink{structX509CertificateInfo_a1e15bfaddec61608bad974fa7385d225}{subjectPublicKeyInfo});
221    \textcolor{comment}{//Any parsing error?}
222    \textcolor{keywordflow}{if}(error)
223       \textcolor{keywordflow}{return} error;
224 
225    \textcolor{comment}{//Point to the next field}
226    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
227    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
228 
229    \textcolor{comment}{//Parse IssuerUniqueID field}
230    error = \hyperlink{certificate_2x509__cert__parse_8c_a16087bad69c48b98cbba8ead2d56c5cd}{x509ParseIssuerUniqueId}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
231    \textcolor{comment}{//Any parsing error?}
232    \textcolor{keywordflow}{if}(error)
233       \textcolor{keywordflow}{return} error;
234 
235    \textcolor{comment}{//The IssuerUniqueID field is optional}
236    \textcolor{keywordflow}{if}(n > 0)
237    \{
238       \textcolor{comment}{//This field must only appear if the version is 2 or 3}
239       \textcolor{keywordflow}{if}(certInfo->\hyperlink{structX509CertificateInfo_a15902fd60ae1f744a24fed017535891f}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
240          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
241    \}
242 
243    \textcolor{comment}{//Point to the next field}
244    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
245    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
246 
247    \textcolor{comment}{//Parse SubjectUniqueID field}
248    error = \hyperlink{certificate_2x509__cert__parse_8c_a417813688cad9149a37f2b22e9522bee}{x509ParseSubjectUniqueId}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n);
249    \textcolor{comment}{//Any parsing error?}
250    \textcolor{keywordflow}{if}(error)
251       \textcolor{keywordflow}{return} error;
252 
253    \textcolor{comment}{//The SubjectUniqueID field is optional}
254    \textcolor{keywordflow}{if}(n > 0)
255    \{
256       \textcolor{comment}{//This field must only appear if the version is 2 or 3}
257       \textcolor{keywordflow}{if}(certInfo->\hyperlink{structX509CertificateInfo_a15902fd60ae1f744a24fed017535891f}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26aaf2c323563360efe248f61f1939be26d}{X509\_VERSION\_2})
258          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
259    \}
260 
261    \textcolor{comment}{//Point to the next field}
262    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
263    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
264 
265    \textcolor{comment}{//Parse Extensions field}
266    error = \hyperlink{certificate_2x509__cert__parse_8c_a6bc5db12553ab85062046966b6835359}{x509ParseExtensions}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &certInfo->
      \hyperlink{structX509CertificateInfo_a6fbc847cf3a3459834fae3c4ece76297}{extensions});
267    \textcolor{comment}{//Any parsing error?}
268    \textcolor{keywordflow}{if}(error)
269       \textcolor{keywordflow}{return} error;
270 
271    \textcolor{comment}{//The Extensions field is optional}
272    \textcolor{keywordflow}{if}(n > 0)
273    \{
274       \textcolor{comment}{//This field must only appear if the version is 3}
275       \textcolor{keywordflow}{if}(certInfo->\hyperlink{structX509CertificateInfo_a15902fd60ae1f744a24fed017535891f}{version} < \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26addaa01d4830baa29e7e19044f0a656eb}{X509\_VERSION\_3})
276          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
277    \}
278 
279    \textcolor{comment}{//No error to report}
280    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
281 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}\label{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Time@{x509\+Parse\+Time}}
\index{x509\+Parse\+Time@{x509\+Parse\+Time}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Time()}{x509ParseTime()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Time (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structDateTime}{Date\+Time} $\ast$}]{date\+Time }\end{DoxyParamCaption})}



Parse U\+T\+C\+Time or Generalized\+Time field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em date\+Time} & date resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 913 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
915 \{
916    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
917    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
918    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
919 
920    \textcolor{comment}{//Debug message}
921    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"      Parsing Time...\(\backslash\)r\(\backslash\)n"});
922 
923    \textcolor{comment}{//Read current ASN.1 tag}
924    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
925    \textcolor{comment}{//Failed to decode ASN.1 tag?}
926    \textcolor{keywordflow}{if}(error)
927       \textcolor{keywordflow}{return} error;
928 
929    \textcolor{comment}{//Save the total length of the field}
930    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
931 
932    \textcolor{comment}{//The date may be encoded as UTCTime or GeneralizedTime}
933    \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa9f9c0acd29e300911008f2f14d38603d}{ASN1\_TYPE\_UTC\_TIME}))
934    \{
935       \textcolor{comment}{//Check the length of the UTCTime field}
936       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 13)
937          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
938 
939       \textcolor{comment}{//The UTCTime uses a 2-digit representation of the year}
940       error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, 2, &value);
941       \textcolor{comment}{//Any error to report?}
942       \textcolor{keywordflow}{if}(error)
943          \textcolor{keywordflow}{return} error;
944 
945       \textcolor{comment}{//If YY is greater than or equal to 50, the year shall be interpreted}
946       \textcolor{comment}{//as 19YY. If YY is less than 50, the year shall be interpreted as 20YY}
947       \textcolor{keywordflow}{if}(value >= 50)
948          dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 1900 + \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
949       \textcolor{keywordflow}{else}
950          dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = 2000 + \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
951 
952       \textcolor{comment}{//Point to the next field}
953       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 2;
954    \}
955    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!\hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \hyperlink{asn1_8h_ab3589ac11c049bfda069aa3ecf683578}{ASN1\_CLASS\_UNIVERSAL}, 
      \hyperlink{asn1_8h_a1b0f39cb3d87e425703ba389df9da1dfa27cd934568bfa45864e37d5ba434b3f9}{ASN1\_TYPE\_GENERALIZED\_TIME}))
956    \{
957       \textcolor{comment}{//Check the length of the GeneralizedTime field}
958       \textcolor{keywordflow}{if}(tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length} != 15)
959          \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
960 
961       \textcolor{comment}{//The GeneralizedTime uses a 4-digit representation of the year}
962       error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, 4, &value);
963       \textcolor{comment}{//Any error to report?}
964       \textcolor{keywordflow}{if}(error)
965          \textcolor{keywordflow}{return} error;
966 
967       \textcolor{comment}{//Save the resulting value}
968       dateTime->\hyperlink{structDateTime_a0a61d60280541502e47f9a7fd6e1c8d2}{year} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
969 
970       \textcolor{comment}{//Point to the next field}
971       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value} + 4;
972    \}
973    \textcolor{keywordflow}{else}
974    \{
975       \textcolor{comment}{//The tag does not contain a valid date}
976       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cae9be6449970fca5714ab9957b16562a5}{ERROR\_FAILURE};
977    \}
978 
979    \textcolor{comment}{//Month}
980    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 2, &value);
981    \textcolor{comment}{//Any error to report?}
982    \textcolor{keywordflow}{if}(error)
983       \textcolor{keywordflow}{return} error;
984 
985    \textcolor{comment}{//Save the resulting value}
986    dateTime->\hyperlink{structDateTime_ac895afb51c74941c50205f746b709148}{month} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
987 
988    \textcolor{comment}{//Day}
989    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 2, 2, &value);
990    \textcolor{comment}{//Any error to report?}
991    \textcolor{keywordflow}{if}(error)
992       \textcolor{keywordflow}{return} error;
993 
994    \textcolor{comment}{//Save the resulting value}
995    dateTime->\hyperlink{structDateTime_a727866b5ecdfda1edf946efe86aa74af}{day} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
996 
997    \textcolor{comment}{//Hours}
998    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 4, 2, &value);
999    \textcolor{comment}{//Any error to report?}
1000    \textcolor{keywordflow}{if}(error)
1001       \textcolor{keywordflow}{return} error;
1002 
1003    \textcolor{comment}{//Save the resulting value}
1004    dateTime->\hyperlink{structDateTime_a46fa4e0c13c7fc19c8ae97a5642c4a15}{hours} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1005 
1006    \textcolor{comment}{//Minutes}
1007    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 6, 2, &value);
1008    \textcolor{comment}{//Any error to report?}
1009    \textcolor{keywordflow}{if}(error)
1010       \textcolor{keywordflow}{return} error;
1011 
1012    \textcolor{comment}{//Save the resulting value}
1013    dateTime->\hyperlink{structDateTime_a9e705a28fc51e333616553313107d579}{minutes} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1014 
1015    \textcolor{comment}{//Seconds}
1016    error = \hyperlink{certificate_2x509__common_8c_a8d344d89edfba1db3dcefab50e9ad02a}{x509ReadInt}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + 8, 2, &value);
1017    \textcolor{comment}{//Any error to report?}
1018    \textcolor{keywordflow}{if}(error)
1019       \textcolor{keywordflow}{return} error;
1020 
1021    \textcolor{comment}{//The encoding shall terminate with a "Z"}
1022    \textcolor{keywordflow}{if}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}[10] != \textcolor{charliteral}{'Z'})
1023       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0}{ERROR\_INVALID\_SYNTAX};
1024 
1025    \textcolor{comment}{//Save the resulting value}
1026    dateTime->\hyperlink{structDateTime_a428828f757146b36432b4669e8b27eeb}{seconds} = \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
1027 
1028    \textcolor{comment}{//Milliseconds}
1029    dateTime->\hyperlink{structDateTime_a8b3982e7347da9a62c2bfc6c273da909}{milliseconds} = 0;
1030 
1031    \textcolor{comment}{//UTCTime or GeneralizedTime field successfully parsed}
1032    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
1033 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}\label{certificate_2x509__cert__parse_8c_a13716132dba34d3a3fb8321d1355c6d1}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Validity@{x509\+Parse\+Validity}}
\index{x509\+Parse\+Validity@{x509\+Parse\+Validity}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Validity()}{x509ParseValidity()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Validity (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{structX509Validity}{X509\+Validity} $\ast$}]{validity }\end{DoxyParamCaption})}



Parse Validity structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em validity} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 860 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
862 \{
863    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
864    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
865    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
866 
867    \textcolor{comment}{//Debug message}
868    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Validity...\(\backslash\)r\(\backslash\)n"});
869 
870    \textcolor{comment}{//Read the contents of the Validity structure}
871    error = \hyperlink{asn1_8c_a5df4a5a14b22837b3dea3525608a9122}{asn1ReadSequence}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
872    \textcolor{comment}{//Failed to decode ASN.1 tag?}
873    \textcolor{keywordflow}{if}(error)
874       \textcolor{keywordflow}{return} error;
875 
876    \textcolor{comment}{//Save the total length of the field}
877    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
878 
879    \textcolor{comment}{//Point to the very first field of the sequence}
880    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value};
881    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} = tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length};
882 
883    \textcolor{comment}{//The NotBefore field may be encoded as UTCTime or GeneralizedTime}
884    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &validity->
      \hyperlink{structX509Validity_a54d94f88fced1072aaacb4824757aee0}{notBefore});
885    \textcolor{comment}{//Failed to decode ASN.1 tag?}
886    \textcolor{keywordflow}{if}(error)
887       \textcolor{keywordflow}{return} error;
888 
889    \textcolor{comment}{//Point to the next field}
890    \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
891    \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
892 
893    \textcolor{comment}{//The NotAfter field may be encoded as UTCTime or GeneralizedTime}
894    error = \hyperlink{certificate_2x509__cert__parse_8c_ae0100508f7e094fffc624414f40f932e}{x509ParseTime}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &n, &validity->
      \hyperlink{structX509Validity_a23debc3797b2921431fce9658ecc1b73}{notAfter});
895    \textcolor{comment}{//Failed to decode ASN.1 tag?}
896    \textcolor{keywordflow}{if}(error)
897       \textcolor{keywordflow}{return} error;
898 
899    \textcolor{comment}{//Validity field successfully parsed}
900    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
901 \}
\end{DoxyCode}
\mbox{\Hypertarget{certificate_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}\label{certificate_2x509__cert__parse_8c_a6bb8c9cd7914a755f55796fb888aa2df}} 
\index{certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}!x509\+Parse\+Version@{x509\+Parse\+Version}}
\index{x509\+Parse\+Version@{x509\+Parse\+Version}!certificate/x509\+\_\+cert\+\_\+parse.\+c@{certificate/x509\+\_\+cert\+\_\+parse.\+c}}
\subsubsection{\texorpdfstring{x509\+Parse\+Version()}{x509ParseVersion()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} x509\+Parse\+Version (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{size\+\_\+t $\ast$}]{total\+Length,  }\item[{\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509\+Version} $\ast$}]{version }\end{DoxyParamCaption})}



Parse Version field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the A\+S\+N.\+1 structure to parse \\
\hline
\mbox{\tt in}  & {\em length} & Length of the A\+S\+N.\+1 structure \\
\hline
\mbox{\tt out}  & {\em total\+Length} & Number of bytes that have been parsed \\
\hline
\mbox{\tt out}  & {\em version} & Information resulting from the parsing process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 293 of file x509\+\_\+cert\+\_\+parse.\+c.


\begin{DoxyCode}
295 \{
296    \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\_t} error;
297    \hyperlink{stdint_8h_ab1967d8591af1a4e48c37fd2b0f184d0}{int32\_t} \hyperlink{dtls__misc_8h_a74bce8e92ccabd0c885447114a48b80e}{value};
298    \hyperlink{structAsn1Tag}{Asn1Tag} tag;
299 
300    \textcolor{comment}{//Debug message}
301    \hyperlink{debug_8h_a67a8f9bc74358aa21745a76e23768dae}{TRACE\_DEBUG}(\textcolor{stringliteral}{"    Parsing Version...\(\backslash\)r\(\backslash\)n"});
302 
303    \textcolor{comment}{//Explicit tagging shall be used to encode version}
304    error = \hyperlink{asn1_8c_a1abd5e2bb0488ff85fb1d94392f80dc4}{asn1ReadTag}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, &tag);
305    \textcolor{comment}{//Failed to decode ASN.1 tag?}
306    \textcolor{keywordflow}{if}(error)
307       \textcolor{keywordflow}{return} error;
308 
309    \textcolor{comment}{//Enforce encoding, class and type}
310    error = \hyperlink{asn1_8c_a73fa06e5d71abe974aa6ad8fb53ecaa2}{asn1CheckTag}(&tag, \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{asn1_8h_aed381d50c77b8c9f962b5359d6115c97}{ASN1\_CLASS\_CONTEXT\_SPECIFIC},
       0);
311 
312    \textcolor{comment}{//Invalid tag?}
313    \textcolor{keywordflow}{if}(error)
314    \{
315       \textcolor{comment}{//Assume X.509 version 1 format}
316       *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26a146bf525f16981660f60fd6c0bdeeee7}{X509\_VERSION\_1};
317       \textcolor{comment}{//Skip the current field}
318       *totalLength = 0;
319 
320       \textcolor{comment}{//Exit immediately}
321       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
322    \}
323 
324    \textcolor{comment}{//Save the total length of the field}
325    *totalLength = tag.\hyperlink{structAsn1Tag_a27df45a2d65de5a2a1289a64e43149bf}{totalLength};
326 
327    \textcolor{comment}{//Read the inner tag}
328    error = \hyperlink{asn1_8c_aca52b824f6c2dd7f97747606d325e154}{asn1ReadInt32}(tag.\hyperlink{structAsn1Tag_a90f3832fa59c62feb4fb8be9d8b11b29}{value}, tag.\hyperlink{structAsn1Tag_a5131e751817ae2cbfdaf031c2ce97f3d}{length}, &tag, &value);
329    \textcolor{comment}{//Failed to decode ASN.1 tag?}
330    \textcolor{keywordflow}{if}(error)
331       \textcolor{keywordflow}{return} error;
332 
333    \textcolor{comment}{//Check version field}
334    \textcolor{keywordflow}{if}(value > \hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26addaa01d4830baa29e7e19044f0a656eb}{X509\_VERSION\_3})
335       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cafc403a048723cbb5e5ade33caa70c48b}{ERROR\_INVALID\_VERSION};
336 
337    \textcolor{comment}{//Save certificate version}
338    *\hyperlink{dtls__misc_8h_ab6d7b6f8c2ceaba7acda80aaf05f4899}{version} = (\hyperlink{certificate_2x509__common_8h_a42c631650a1a4fbe9d70d54d99dcac26}{X509Version}) value;
339 
340    \textcolor{comment}{//No error to report}
341    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
342 \}
\end{DoxyCode}
