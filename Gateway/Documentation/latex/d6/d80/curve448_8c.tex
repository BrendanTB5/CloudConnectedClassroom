\hypertarget{curve448_8c}{}\section{cyclone\+\_\+crypto/ecc/curve448.c File Reference}
\label{curve448_8c}\index{cyclone\+\_\+crypto/ecc/curve448.\+c@{cyclone\+\_\+crypto/ecc/curve448.\+c}}


Curve448 elliptic curve (constant-\/time implementation)  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/ec\+\_\+curves.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ecc/curve448.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{curve448_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{curve448_8c_a3ac13c880f381f5349d061bd171bef60}{curve448\+Set\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Set integer value. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a95607469c0c0c75d84234a41ad3b2987}{curve448\+Add} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular addition. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a9c843242211ad186cc6d961fd35f7cc0}{curve448\+Add\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular addition. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a60277698c2d05decaa3755fcf2e6dee8}{curve448\+Sub} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular subtraction. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_ab77c81e1dc5fe4586667acdd3080a9c6}{curve448\+Sub\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular subtraction. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448\+Mul} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular multiplication. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a5c6e67973c3ef80241ddd2d6b06ef7c5}{curve448\+Mul\+Int} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Modular multiplication. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448\+Sqr} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Modular squaring. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448\+Pwr2} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n})
\begin{DoxyCompactList}\small\item\em Raise an integer to power 2$^\wedge$n. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448\+Red} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{ndp_8h_a1f1dfeb2f802fe99f37fe91867b84456}{h})
\begin{DoxyCompactList}\small\item\em Modular reduction. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_ac7719f974f4b271e3571760807e24cde}{curve448\+Inv} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a})
\begin{DoxyCompactList}\small\item\em Modular multiplicative inverse. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{curve448_8c_a548498ab60c89922a9bc1e16e9d1a1c6}{curve448\+Sqrt} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compute the square root of (A / B) modulo p. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a94b95a2737f6ff5016cde1280d48ee77}{curve448\+Copy} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Copy an integer. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a89107f35ede21cc517dd452a4730072f}{curve448\+Swap} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\begin{DoxyCompactList}\small\item\em Conditional swap. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a1722eb19844e80369c8b7dd04e8ea8aa}{curve448\+Select} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b}, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\begin{DoxyCompactList}\small\item\em Select an integer. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} \hyperlink{curve448_8c_a7defba8eb3dee93dd77c6f7bdba6c4d7}{curve448\+Comp} (const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b})
\begin{DoxyCompactList}\small\item\em Compare integers. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_adefb9b763312f68025f5607420aed329}{curve448\+Import} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data})
\begin{DoxyCompactList}\small\item\em Import an octet string. \end{DoxyCompactList}\item 
void \hyperlink{curve448_8c_a9039eeaa95f929f0cc5cf5c4120dfac0}{curve448\+Export} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data})
\begin{DoxyCompactList}\small\item\em Export an octet string. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Curve448 elliptic curve (constant-\/time implementation) 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{curve448_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{curve448_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{curve448.\+c@{curve448.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 32 of file curve448.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{curve448_8c_a95607469c0c0c75d84234a41ad3b2987}\label{curve448_8c_a95607469c0c0c75d84234a41ad3b2987}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Add@{curve448\+Add}}
\index{curve448\+Add@{curve448\+Add}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Add()}{curve448Add()}}
{\footnotesize\ttfamily void curve448\+Add (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Modular addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A + B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ p \\
\hline
\end{DoxyParams}


Definition at line 72 of file curve448.\+c.


\begin{DoxyCode}
73 \{
74    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
75    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
76 
77    \textcolor{comment}{//Compute R = A + B}
78    \textcolor{keywordflow}{for}(temp = 0, i = 0; i < 14; i++)
79    \{
80       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
81       temp += \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
82       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
83       temp >>= 32;
84    \}
85 
86    \textcolor{comment}{//Perform modular reduction}
87    \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp);
88 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a9c843242211ad186cc6d961fd35f7cc0}\label{curve448_8c_a9c843242211ad186cc6d961fd35f7cc0}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Add\+Int@{curve448\+Add\+Int}}
\index{curve448\+Add\+Int@{curve448\+Add\+Int}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Add\+Int()}{curve448AddInt()}}
{\footnotesize\ttfamily void curve448\+Add\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Modular addition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A + B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ (2$^\wedge$32 -\/ 1) \\
\hline
\end{DoxyParams}


Definition at line 98 of file curve448.\+c.


\begin{DoxyCode}
99 \{
100    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
101    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
102 
103    \textcolor{comment}{//Compute R = A + B}
104    \textcolor{keywordflow}{for}(temp = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}, i = 0; i < 14; i++)
105    \{
106       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
107       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
108       temp >>= 32;
109    \}
110 
111    \textcolor{comment}{//Perform modular reduction}
112    \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp);
113 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a7defba8eb3dee93dd77c6f7bdba6c4d7}\label{curve448_8c_a7defba8eb3dee93dd77c6f7bdba6c4d7}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Comp@{curve448\+Comp}}
\index{curve448\+Comp@{curve448\+Comp}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Comp()}{curve448Comp()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} curve448\+Comp (\begin{DoxyParamCaption}\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Compare integers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to the first integer \\
\hline
\mbox{\tt in}  & {\em b} & Pointer to the second integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 0 if the A = B, else 1 
\end{DoxyReturn}


Definition at line 600 of file curve448.\+c.


\begin{DoxyCode}
601 \{
602    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
603    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
604 
605    \textcolor{comment}{//Initialize mask}
606    mask = 0;
607 
608    \textcolor{comment}{//Compare A and B}
609    \textcolor{keywordflow}{for}(i = 0; i < 14; i++)
610    \{
611       \textcolor{comment}{//Constant time implementation}
612       mask |= \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] ^ \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
613    \}
614 
615    \textcolor{comment}{//Return 0 if A = B, else 1}
616    \textcolor{keywordflow}{return} ((\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) (mask | (~mask + 1))) >> 31;
617 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a94b95a2737f6ff5016cde1280d48ee77}\label{curve448_8c_a94b95a2737f6ff5016cde1280d48ee77}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Copy@{curve448\+Copy}}
\index{curve448\+Copy@{curve448\+Copy}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Copy()}{curve448Copy()}}
{\footnotesize\ttfamily void curve448\+Copy (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Copy an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em a} & Pointer to the destination integer \\
\hline
\mbox{\tt in}  & {\em b} & Pointer to the source integer \\
\hline
\end{DoxyParams}


Definition at line 528 of file curve448.\+c.


\begin{DoxyCode}
529 \{
530    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
531 
532    \textcolor{comment}{//Copy the value of the integer}
533    \textcolor{keywordflow}{for}(i = 0; i < 14; i++)
534    \{
535       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
536    \}
537 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a9039eeaa95f929f0cc5cf5c4120dfac0}\label{curve448_8c_a9039eeaa95f929f0cc5cf5c4120dfac0}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Export@{curve448\+Export}}
\index{curve448\+Export@{curve448\+Export}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Export()}{curve448Export()}}
{\footnotesize\ttfamily void curve448\+Export (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data }\end{DoxyParamCaption})}



Export an octet string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Pointer to the integer to be exported \\
\hline
\mbox{\tt out}  & {\em data} & Octet string resulting from the conversion \\
\hline
\end{DoxyParams}


Definition at line 647 of file curve448.\+c.


\begin{DoxyCode}
648 \{
649    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
650 
651    \textcolor{comment}{//Convert from host byte order to little-endian byte order}
652    \textcolor{keywordflow}{for}(i = 0; i < 14; i++)
653    \{
654       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = \hyperlink{cpu__endian_8h_a336f132f175f47bfab3fa57f6a00276d}{htole32}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i]);
655    \}
656 
657    \textcolor{comment}{//Export the octet string}
658    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(\hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, 56);
659 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_adefb9b763312f68025f5607420aed329}\label{curve448_8c_adefb9b763312f68025f5607420aed329}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Import@{curve448\+Import}}
\index{curve448\+Import@{curve448\+Import}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Import()}{curve448Import()}}
{\footnotesize\ttfamily void curve448\+Import (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{data }\end{DoxyParamCaption})}



Import an octet string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em a} & Pointer to resulting integer \\
\hline
\mbox{\tt in}  & {\em data} & Octet string to be converted \\
\hline
\end{DoxyParams}


Definition at line 626 of file curve448.\+c.


\begin{DoxyCode}
627 \{
628    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
629 
630    \textcolor{comment}{//Import the octet string}
631    \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, 56);
632 
633    \textcolor{comment}{//Convert from little-endian byte order to host byte order}
634    \textcolor{keywordflow}{for}(i = 0; i < 14; i++)
635    \{
636       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = \hyperlink{cpu__endian_8h_a637984da0e96437b4bff8b68108256c6}{letoh32}(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i]);
637    \}
638 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_ac7719f974f4b271e3571760807e24cde}\label{curve448_8c_ac7719f974f4b271e3571760807e24cde}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Inv@{curve448\+Inv}}
\index{curve448\+Inv@{curve448\+Inv}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Inv()}{curve448Inv()}}
{\footnotesize\ttfamily void curve448\+Inv (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a }\end{DoxyParamCaption})}



Modular multiplicative inverse. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A$^\wedge$-\/1 mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\end{DoxyParams}


Definition at line 403 of file curve448.\+c.


\begin{DoxyCode}
404 \{
405    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[14];
406    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} v[14];
407 
408    \textcolor{comment}{//Since GF(p) is a prime field, the Fermat's little theorem can be}
409    \textcolor{comment}{//used to find the multiplicative inverse of A modulo p}
410    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
411    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^2 - 1)}
412    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
413    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^3 - 1)}
414    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 3);
415    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, v); \textcolor{comment}{//A^(2^6 - 1)}
416    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 6);
417    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//A^(2^12 - 1)}
418    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
419    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^13 - 1)}
420    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 13);
421    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//A^(2^26 - 1)}
422    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
423    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^27 - 1)}
424    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 27);
425    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//A^(2^54 - 1)}
426    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
427    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^55 - 1)}
428    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 55);
429    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//A^(2^110 - 1)}
430    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
431    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^111 - 1)}
432    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 111);
433    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, v); \textcolor{comment}{//A^(2^222 - 1)}
434    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, v);
435    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^223 - 1)}
436    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, u, 223);
437    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//A^(2^446 - 2^222 - 1)}
438    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
439    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
440    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}); \textcolor{comment}{//A^(2^448 - 2^224 - 3)}
441 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}\label{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Mul@{curve448\+Mul}}
\index{curve448\+Mul@{curve448\+Mul}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Mul()}{curve448Mul()}}
{\footnotesize\ttfamily void curve448\+Mul (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Modular multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $\ast$ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ p \\
\hline
\end{DoxyParams}


Definition at line 199 of file curve448.\+c.


\begin{DoxyCode}
200 \{
201    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
202    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} j;
203    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
204    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
205    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[28];
206 
207    \textcolor{comment}{//Initialize variables}
208    temp = 0;
209    c = 0;
210 
211    \textcolor{comment}{//Comba's method is used to perform multiplication}
212    \textcolor{keywordflow}{for}(i = 0; i < 28; i++)
213    \{
214       \textcolor{comment}{//The algorithm computes the products, column by column}
215       \textcolor{keywordflow}{if}(i < 14)
216       \{
217          \textcolor{comment}{//Inner loop}
218          \textcolor{keywordflow}{for}(j = 0; j <= i; j++)
219          \{
220             temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[j] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i - j];
221             c += temp >> 32;
222             temp &= 0xFFFFFFFF;
223          \}
224       \}
225       \textcolor{keywordflow}{else}
226       \{
227          \textcolor{comment}{//Inner loop}
228          \textcolor{keywordflow}{for}(j = i - 13; j < 14; j++)
229          \{
230             temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[j] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i - j];
231             c += temp >> 32;
232             temp &= 0xFFFFFFFF;
233          \}
234       \}
235 
236       \textcolor{comment}{//At the bottom of each column, the final result is written to memory}
237       u[i] = temp & 0xFFFFFFFF;
238 
239       \textcolor{comment}{//Propagate the carry upwards}
240       temp = c & 0xFFFFFFFF;
241       c >>= 32;
242    \}
243 
244    \textcolor{comment}{//Perform fast modular reduction (first pass)}
245    \textcolor{keywordflow}{for}(temp = 0, i = 0; i < 7; i++)
246    \{
247       temp += u[i];
248       temp += u[i + 14];
249       temp += u[i + 21];
250       u[i] = temp & 0xFFFFFFFF;
251       temp >>= 32;
252    \}
253 
254    \textcolor{keywordflow}{for}(i = 7; i < 14; i++)
255    \{
256       temp += u[i];
257       temp += u[i + 7];
258       temp += u[i + 14];
259       temp += u[i + 14];
260       u[i] = temp & 0xFFFFFFFF;
261       temp >>= 32;
262    \}
263 
264    \textcolor{comment}{//Perform fast modular reduction (second pass)}
265    \textcolor{keywordflow}{for}(c = temp, i = 0; i < 7; i++)
266    \{
267       temp += u[i];
268       u[i] = temp & 0xFFFFFFFF;
269       temp >>= 32;
270    \}
271 
272    \textcolor{keywordflow}{for}(temp += c, i = 7; i < 14; i++)
273    \{
274       temp += u[i];
275       u[i] = temp & 0xFFFFFFFF;
276       temp >>= 32;
277    \}
278 
279    \textcolor{comment}{//Reduce non-canonical values}
280    \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u, (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp);
281 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a5c6e67973c3ef80241ddd2d6b06ef7c5}\label{curve448_8c_a5c6e67973c3ef80241ddd2d6b06ef7c5}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Mul\+Int@{curve448\+Mul\+Int}}
\index{curve448\+Mul\+Int@{curve448\+Mul\+Int}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Mul\+Int()}{curve448MulInt()}}
{\footnotesize\ttfamily void curve448\+Mul\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Modular multiplication. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $\ast$ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ (2$^\wedge$32 -\/ 1) \\
\hline
\end{DoxyParams}


Definition at line 291 of file curve448.\+c.


\begin{DoxyCode}
292 \{
293    \hyperlink{compiler__port_8h_a022c65af7f6c8d3947e8a37d64db6ad6}{int\_t} i;
294    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c};
295    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
296    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[14];
297 
298    \textcolor{comment}{//Compute R = A * B}
299    \textcolor{keywordflow}{for}(temp = 0, i = 0; i < 14; i++)
300    \{
301       temp += (\hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t}) \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] * \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
302       u[i] = temp & 0xFFFFFFFF;
303       temp >>= 32;
304    \}
305 
306    \textcolor{comment}{//Perform fast modular reduction}
307    \textcolor{keywordflow}{for}(c = temp, i = 0; i < 7; i++)
308    \{
309       temp += u[i];
310       u[i] = temp & 0xFFFFFFFF;
311       temp >>= 32;
312    \}
313 
314    \textcolor{keywordflow}{for}(temp += c, i = 7; i < 14; i++)
315    \{
316       temp += u[i];
317       u[i] = temp & 0xFFFFFFFF;
318       temp >>= 32;
319    \}
320 
321    \textcolor{comment}{//Reduce non-canonical values}
322    \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u, (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp);
323 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}\label{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Pwr2@{curve448\+Pwr2}}
\index{curve448\+Pwr2@{curve448\+Pwr2}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Pwr2()}{curve448Pwr2()}}
{\footnotesize\ttfamily void curve448\+Pwr2 (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\+\_\+t}}]{n }\end{DoxyParamCaption})}



Raise an integer to power 2$^\wedge$n. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $^\wedge$ (2$^\wedge$n)) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em n} & An integer such as n $>$= 1 \\
\hline
\end{DoxyParams}


Definition at line 346 of file curve448.\+c.


\begin{DoxyCode}
347 \{
348    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
349 
350    \textcolor{comment}{//Pre-compute (A ^ 2) mod p}
351    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
352 
353    \textcolor{comment}{//Compute R = (A ^ (2^n)) mod p}
354    \textcolor{keywordflow}{for}(i = 1; i < \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}; i++)
355    \{
356       \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r});
357    \}
358 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a95420270ecd754f541508d3142c041f5}\label{curve448_8c_a95420270ecd754f541508d3142c041f5}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Red@{curve448\+Red}}
\index{curve448\+Red@{curve448\+Red}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Red()}{curve448Red()}}
{\footnotesize\ttfamily void curve448\+Red (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{h }\end{DoxyParamCaption})}



Modular reduction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = A mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ (2 $\ast$ p) \\
\hline
\mbox{\tt in}  & {\em h} & The highest term of A \\
\hline
\end{DoxyParams}


Definition at line 368 of file curve448.\+c.


\begin{DoxyCode}
369 \{
370    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
371    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} temp;
372    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[14];
373 
374    \textcolor{comment}{//Compute B = A - (2^448 - 2^224 - 1)}
375    \textcolor{keywordflow}{for}(temp = 1, i = 0; i < 7; i++)
376    \{
377       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
378       b[i] = temp & 0xFFFFFFFF;
379       temp >>= 32;
380    \}
381 
382    \textcolor{keywordflow}{for}(temp += 1, i = 7; i < 14; i++)
383    \{
384       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
385       b[i] = temp & 0xFFFFFFFF;
386       temp >>= 32;
387    \}
388 
389    \textcolor{comment}{//Compute the highest term of the result}
390    \hyperlink{ndp_8h_a1f1dfeb2f802fe99f37fe91867b84456}{h} += (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp - 1;
391 
392    \textcolor{comment}{//If B < (2^448 - 2^224 + 1) then R = B, else R = A}
393    \hyperlink{curve448_8c_a1722eb19844e80369c8b7dd04e8ea8aa}{curve448Select}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, b, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{ndp_8h_a1f1dfeb2f802fe99f37fe91867b84456}{h} & 1);
394 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a1722eb19844e80369c8b7dd04e8ea8aa}\label{curve448_8c_a1722eb19844e80369c8b7dd04e8ea8aa}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Select@{curve448\+Select}}
\index{curve448\+Select@{curve448\+Select}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Select()}{curve448Select()}}
{\footnotesize\ttfamily void curve448\+Select (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{c }\end{DoxyParamCaption})}



Select an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Pointer to the destination integer \\
\hline
\mbox{\tt in}  & {\em a} & Pointer to the first source integer \\
\hline
\mbox{\tt in}  & {\em b} & Pointer to the second source integer \\
\hline
\mbox{\tt in}  & {\em c} & Condition variable \\
\hline
\end{DoxyParams}


Definition at line 575 of file curve448.\+c.


\begin{DoxyCode}
577 \{
578    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
579    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
580 
581    \textcolor{comment}{//The mask is the all-1 or all-0 word}
582    mask = \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} - 1;
583 
584    \textcolor{comment}{//Select between A and B}
585    \textcolor{keywordflow}{for}(i = 0; i < 14; i++)
586    \{
587       \textcolor{comment}{//Constant time implementation}
588       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = (\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] & \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask}) | (\hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i] & ~mask);
589    \}
590 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a3ac13c880f381f5349d061bd171bef60}\label{curve448_8c_a3ac13c880f381f5349d061bd171bef60}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Set\+Int@{curve448\+Set\+Int}}
\index{curve448\+Set\+Int@{curve448\+Set\+Int}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Set\+Int()}{curve448SetInt()}}
{\footnotesize\ttfamily void curve448\+Set\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Set integer value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em a} & Pointer to the integer to be initialized \\
\hline
\mbox{\tt in}  & {\em b} & Initial value \\
\hline
\end{DoxyParams}


Definition at line 50 of file curve448.\+c.


\begin{DoxyCode}
51 \{
52    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
53 
54    \textcolor{comment}{//Set the value of the least significant word}
55    \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[0] = \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
56 
57    \textcolor{comment}{//Initialize the rest of the integer}
58    \textcolor{keywordflow}{for}(i = 1; i < 14; i++)
59    \{
60       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] = 0;
61    \}
62 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}\label{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Sqr@{curve448\+Sqr}}
\index{curve448\+Sqr@{curve448\+Sqr}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Sqr()}{curve448Sqr()}}
{\footnotesize\ttfamily void curve448\+Sqr (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a }\end{DoxyParamCaption})}



Modular squaring. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A $^\wedge$ 2) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\end{DoxyParams}


Definition at line 332 of file curve448.\+c.


\begin{DoxyCode}
333 \{
334    \textcolor{comment}{//Compute R = (A ^ 2) mod p}
335    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
336 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a548498ab60c89922a9bc1e16e9d1a1c6}\label{curve448_8c_a548498ab60c89922a9bc1e16e9d1a1c6}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Sqrt@{curve448\+Sqrt}}
\index{curve448\+Sqrt@{curve448\+Sqrt}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Sqrt()}{curve448Sqrt()}}
{\footnotesize\ttfamily \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} curve448\+Sqrt (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Compute the square root of (A / B) modulo p. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A / B)$^\wedge$(1 / 2) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$ B $<$ p \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The function returns 0 if the square root exists, else 1 
\end{DoxyReturn}


Definition at line 452 of file curve448.\+c.


\begin{DoxyCode}
453 \{
454    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
455    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}[14];
456    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} u[14];
457    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} v[14];
458 
459    \textcolor{comment}{//Compute the candidate root (A / B)^((p + 1) / 4). This can be done}
460    \textcolor{comment}{//with the following trick, using a single modular powering for both the}
461    \textcolor{comment}{//inversion of B and the square root: A^3 * B * (A^5 * B^3)^((p - 3) / 4)}
462    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
463    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
464    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
465    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
466    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, v, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
467 
468    \textcolor{comment}{//Compute C = A^5 * B^3}
469    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(c, u, v);
470 
471    \textcolor{comment}{//Compute U = C^((p - 3) / 4)}
472    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, c);
473    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, c); \textcolor{comment}{//C^(2^2 - 1)}
474    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
475    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, c); \textcolor{comment}{//C^(2^3 - 1)}
476    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 3);
477    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, v); \textcolor{comment}{//C^(2^6 - 1)}
478    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 6);
479    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//C^(2^12 - 1)}
480    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
481    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, c); \textcolor{comment}{//C^(2^13 - 1)}
482    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 13);
483    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//C^(2^26 - 1)}
484    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
485    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, c); \textcolor{comment}{//C^(2^27 - 1)}
486    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 27);
487    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//C^(2^54 - 1)}
488    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
489    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, c); \textcolor{comment}{//C^(2^55 - 1)}
490    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 55);
491    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//C^(2^110 - 1)}
492    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, u);
493    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, c); \textcolor{comment}{//C^(2^111 - 1)}
494    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, v, 111);
495    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, u, v); \textcolor{comment}{//C^(2^222 - 1)}
496    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(u, v);
497    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, c); \textcolor{comment}{//C^(2^223 - 1)}
498    \hyperlink{curve448_8c_a87cae72391d06ad468da0fb7fd99576b}{curve448Pwr2}(u, u, 223);
499    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v); \textcolor{comment}{//C^(2^446 - 2^222 - 1)}
500 
501    \textcolor{comment}{//The candidate root is U = A^3 * B * (A^5 * B^3)^((p - 3) / 4)}
502    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(v, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
503    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(v, v, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
504    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, v);
505    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(u, u, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
506 
507    \textcolor{comment}{//Calculate C = B * U^2}
508    \hyperlink{curve448_8c_aef5f312be16d281f6106adb9446c4eeb}{curve448Sqr}(c, u);
509    \hyperlink{curve448_8c_a9e465ebba8466bf0c71c08fb4e8c5e7d}{curve448Mul}(c, c, \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b});
510 
511    \textcolor{comment}{//Check whether B * U^2 = A}
512    res = \hyperlink{curve448_8c_a7defba8eb3dee93dd77c6f7bdba6c4d7}{curve448Comp}(c, \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a});
513 
514    \textcolor{comment}{//Copy the candidate root}
515    \hyperlink{curve448_8c_a94b95a2737f6ff5016cde1280d48ee77}{curve448Copy}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, u);
516 
517    \textcolor{comment}{//Return 0 if the square root exists}
518    \textcolor{keywordflow}{return} \hyperlink{resource__manager_8c_a369fab9cf831846ad1a1d6bd33a86fa1}{res};
519 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a60277698c2d05decaa3755fcf2e6dee8}\label{curve448_8c_a60277698c2d05decaa3755fcf2e6dee8}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Sub@{curve448\+Sub}}
\index{curve448\+Sub@{curve448\+Sub}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Sub()}{curve448Sub()}}
{\footnotesize\ttfamily void curve448\+Sub (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b }\end{DoxyParamCaption})}



Modular subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A -\/ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ p \\
\hline
\end{DoxyParams}


Definition at line 123 of file curve448.\+c.


\begin{DoxyCode}
124 \{
125    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
126    \hyperlink{stdint_8h_a414156feea104f8f75b4ed9e3121b2f6}{int64\_t} temp;
127 
128    \textcolor{comment}{//Compute R = A + (2^448 - 2^224 - 1) - B}
129    \textcolor{keywordflow}{for}(temp = -1, i = 0; i < 7; i++)
130    \{
131       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
132       temp -= \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
133       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
134       temp >>= 32;
135    \}
136 
137    \textcolor{keywordflow}{for}(temp -= 1, i = 7; i < 14; i++)
138    \{
139       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
140       temp -= \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i];
141       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
142       temp >>= 32;
143    \}
144 
145    \textcolor{comment}{//Compute the highest term of the result}
146    temp += 1;
147 
148    \textcolor{comment}{//Perform modular reduction}
149    \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp);
150 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_ab77c81e1dc5fe4586667acdd3080a9c6}\label{curve448_8c_ab77c81e1dc5fe4586667acdd3080a9c6}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Sub\+Int@{curve448\+Sub\+Int}}
\index{curve448\+Sub\+Int@{curve448\+Sub\+Int}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Sub\+Int()}{curve448SubInt()}}
{\footnotesize\ttfamily void curve448\+Sub\+Int (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{r,  }\item[{const \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{b }\end{DoxyParamCaption})}



Modular subtraction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em r} & Resulting integer R = (A -\/ B) mod p \\
\hline
\mbox{\tt in}  & {\em a} & An integer such as 0 $<$= A $<$ p \\
\hline
\mbox{\tt in}  & {\em b} & An integer such as 0 $<$= B $<$ (2$^\wedge$32 -\/ 1) \\
\hline
\end{DoxyParams}


Definition at line 160 of file curve448.\+c.


\begin{DoxyCode}
161 \{
162    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
163    \hyperlink{stdint_8h_a414156feea104f8f75b4ed9e3121b2f6}{int64\_t} temp;
164 
165    \textcolor{comment}{//Set initial value}
166    temp = -1;
167    temp -= \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b};
168 
169    \textcolor{comment}{//Compute R = A + (2^448 - 2^224 - 1) - B}
170    \textcolor{keywordflow}{for}(i = 0; i < 7; i++)
171    \{
172       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
173       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
174       temp >>= 32;
175    \}
176 
177    \textcolor{keywordflow}{for}(temp -= 1, i = 7; i < 14; i++)
178    \{
179       temp += \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i];
180       \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}[i] = temp & 0xFFFFFFFF;
181       temp >>= 32;
182    \}
183 
184    \textcolor{comment}{//Compute the highest term of the result}
185    temp += 1;
186 
187    \textcolor{comment}{//Perform modular reduction}
188    \hyperlink{curve448_8c_a95420270ecd754f541508d3142c041f5}{curve448Red}(\hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, \hyperlink{ndp_8h_a4c5c6ceb8ed33456261fa907136e0c3a}{r}, (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t}) temp);
189 \}
\end{DoxyCode}
\mbox{\Hypertarget{curve448_8c_a89107f35ede21cc517dd452a4730072f}\label{curve448_8c_a89107f35ede21cc517dd452a4730072f}} 
\index{curve448.\+c@{curve448.\+c}!curve448\+Swap@{curve448\+Swap}}
\index{curve448\+Swap@{curve448\+Swap}!curve448.\+c@{curve448.\+c}}
\subsubsection{\texorpdfstring{curve448\+Swap()}{curve448Swap()}}
{\footnotesize\ttfamily void curve448\+Swap (\begin{DoxyParamCaption}\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{a,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t} $\ast$}]{b,  }\item[{\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\+\_\+t}}]{c }\end{DoxyParamCaption})}



Conditional swap. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em a} & Pointer to the first integer \\
\hline
\mbox{\tt in,out}  & {\em b} & Pointer to the second integer \\
\hline
\mbox{\tt in}  & {\em c} & Condition variable \\
\hline
\end{DoxyParams}


Definition at line 547 of file curve448.\+c.


\begin{DoxyCode}
548 \{
549    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
550    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} \hyperlink{web__socket_8h_a8a74907784be6c7786c2d060c8d7e10b}{mask};
551    \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} dummy;
552 
553    \textcolor{comment}{//The mask is the all-1 or all-0 word}
554    mask = ~\hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c} + 1;
555 
556    \textcolor{comment}{//Conditional swap}
557    \textcolor{keywordflow}{for}(i = 0; i < 14; i++)
558    \{
559       \textcolor{comment}{//Constant time implementation}
560       dummy = mask & (\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] ^ \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i]);
561       \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[i] ^= dummy;
562       \hyperlink{dtls__misc_8h_ab590318ac859d0e57e15c3dd6c62a605}{b}[i] ^= dummy;
563    \}
564 \}
\end{DoxyCode}
