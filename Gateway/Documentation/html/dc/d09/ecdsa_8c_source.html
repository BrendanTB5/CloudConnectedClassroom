<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Senior Design Gateway: cyclone_crypto/ecc/ecdsa.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Senior Design Gateway
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A HTTP To MQTT Converted for AWS IoT Core.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d09/ecdsa_8c_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ecdsa.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d09/ecdsa_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//Switch to the appropriate trace level</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="../../dc/d09/ecdsa_8c.html#afcdf5e66fd927a7f4cc64295acd20407">   32</a></span>&#160;<span class="preprocessor">#define TRACE_LEVEL CRYPTO_TRACE_LEVEL</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//Dependencies</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html">core/crypto.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d5d/ecdsa_8h.html">ecc/ecdsa.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/dd8/mpi_8h.html">mpi/mpi.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d63/asn1_8h.html">encoding/asn1.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d16/debug_8h.html">debug.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//Check crypto library configuration</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#if (ECDSA_SUPPORT == ENABLED)</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//ECDSA with SHA-1 OID (1.2.840.10045.4.1)</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#af020650a7162df3e86dc65f7cc8da14f">   45</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#af020650a7162df3e86dc65f7cc8da14f">ECDSA_WITH_SHA1_OID</a>[7] = {0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x01};</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//ECDSA with SHA-224 OID (1.2.840.10045.4.3.1)</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a2c82fe5e3c598e3c764973f22fa53bd0">   47</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a2c82fe5e3c598e3c764973f22fa53bd0">ECDSA_WITH_SHA224_OID</a>[8] = {0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x03, 0x01};</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//ECDSA with SHA-256 OID (1.2.840.10045.4.3.2)</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a552ef11d006434b7d6302c762d084771">   49</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a552ef11d006434b7d6302c762d084771">ECDSA_WITH_SHA256_OID</a>[8] = {0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x03, 0x02};</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//ECDSA with SHA-384 OID (1.2.840.10045.4.3.3)</span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#aa5356473862a85426ad8574589c44b9e">   51</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#aa5356473862a85426ad8574589c44b9e">ECDSA_WITH_SHA384_OID</a>[8] = {0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x03, 0x03};</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//ECDSA with SHA-512 OID (1.2.840.10045.4.3.4)</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#ad311e1710697e87730e321b45a5e65e3">   53</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#ad311e1710697e87730e321b45a5e65e3">ECDSA_WITH_SHA512_OID</a>[8] = {0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x03, 0x04};</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//ECDSA with SHA-3-224 OID (2.16.840.1.101.3.4.3.9)</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a2fed3fb0f037994cea3dd5350e4018e5">   55</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a2fed3fb0f037994cea3dd5350e4018e5">ECDSA_WITH_SHA3_224_OID</a>[9] = {0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x09};</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//ECDSA with SHA-3-256 OID (2.16.840.1.101.3.4.3.10)</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a63fbac830ec56b5cd0a29a06662f123f">   57</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a63fbac830ec56b5cd0a29a06662f123f">ECDSA_WITH_SHA3_256_OID</a>[9] = {0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0A};</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//ECDSA with SHA-3-384 OID (2.16.840.1.101.3.4.3.11)</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#af310b898cce19d1b620bb8cd44d0634c">   59</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#af310b898cce19d1b620bb8cd44d0634c">ECDSA_WITH_SHA3_384_OID</a>[9] = {0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0B};</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//ECDSA with SHA-3-512 OID (2.16.840.1.101.3.4.3.12)</span></div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a377d9053f5c7ba2c5659080e0ebff342">   61</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a377d9053f5c7ba2c5659080e0ebff342">ECDSA_WITH_SHA3_512_OID</a>[9] = {0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x03, 0x0C};</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#aef8cd9a530146f44fc0597eb67480133">   69</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/ecdsa_8c.html#aef8cd9a530146f44fc0597eb67480133">ecdsaInitSignature</a>(<a class="code" href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a> *<a class="code" href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a>)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="comment">//Initialize multiple precision integers</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a6f4daa07ea8815b8c67b47c4b089d157">   82</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/ecdsa_8c.html#a6f4daa07ea8815b8c67b47c4b089d157">ecdsaFreeSignature</a>(<a class="code" href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a> *<a class="code" href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a>)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="comment">//Release multiple precision integers</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a38bfa167c941721c005548c336c44d51">   98</a></span>&#160;<a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a38bfa167c941721c005548c336c44d51">ecdsaWriteSignature</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a> *<a class="code" href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a>, <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="code" href="../../d3/d25/dtls__misc_8h.html#a5c239a1bb87b52b0f1d6d68c4749cd2a">data</a>,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="keywordtype">size_t</span> *<a class="code" href="../../d3/d25/dtls__misc_8h.html#ab43ca82dd7fa2a0e56f941032ef324c4">length</a>)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> error;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="keywordtype">size_t</span> <a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordtype">size_t</span> <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="keywordtype">size_t</span> rLen;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordtype">size_t</span> sLen;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <a class="code" href="../../d2/de6/structAsn1Tag.html">Asn1Tag</a> tag;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;Writing ECDSA signature...\r\n&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="comment">//Dump (R, S) integer pair</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  r:\r\n&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  s:\r\n&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="comment">//Calculate the length of R</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   rLen = <a class="code" href="../../db/d50/mpi_8c.html#a8599cb7537c854ae3b2442144c7f853b">mpiGetByteLength</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="comment">//Calculate the length of S</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   sLen = <a class="code" href="../../db/d50/mpi_8c.html#a8599cb7537c854ae3b2442144c7f853b">mpiGetByteLength</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="comment">//Make sure the (R, S) integer pair is valid</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordflow">if</span>(rLen == 0 || sLen == 0)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28">ERROR_INVALID_LENGTH</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="comment">//R and S are always encoded in the smallest possible number of octets</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../db/d50/mpi_8c.html#ad62c1f7143a1cc46b080bea217f20ede">mpiGetBitValue</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, (rLen * 8) - 1))</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      rLen++;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../db/d50/mpi_8c.html#ad62c1f7143a1cc46b080bea217f20ede">mpiGetBitValue</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, (sLen * 8) - 1))</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      sLen++;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="comment">//The first pass computes the length of the ASN.1 sequence</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   n = 0;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="comment">//The parameter R is encapsulated within an ASN.1 structure</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a93c64e611d57dfb59e6ebafe938f28c1">constructed</a> = <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a9f35c291ffa22d903d9c66638bb225ea">objClass</a> = <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a3ecdc4bbf328b5216521cb2114f45935">objType</a> = <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> = rLen;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a> = <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="comment">//Compute the length of the corresponding ASN.1 structure</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   error = <a class="code" href="../../d6/d36/asn1_8c.html#a246f5e4192e8f064bd28d519a89d0207">asn1WriteTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="comment">//Update the length of the ASN.1 sequence</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   n += tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">totalLength</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="comment">//The parameter S is encapsulated within an ASN.1 structure</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a93c64e611d57dfb59e6ebafe938f28c1">constructed</a> = <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a9f35c291ffa22d903d9c66638bb225ea">objClass</a> = <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a3ecdc4bbf328b5216521cb2114f45935">objType</a> = <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> = sLen;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a> = <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="comment">//Compute the length of the corresponding ASN.1 structure</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   error = <a class="code" href="../../d6/d36/asn1_8c.html#a246f5e4192e8f064bd28d519a89d0207">asn1WriteTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="comment">//Update the length of the ASN.1 sequence</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   n += tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">totalLength</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="comment">//The second pass encodes the ASN.1 structure</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   k = 0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="comment">//The (R, S) integer pair is encapsulated within a sequence</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a93c64e611d57dfb59e6ebafe938f28c1">constructed</a> = <a class="code" href="../../da/d42/os__port_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a9f35c291ffa22d903d9c66638bb225ea">objClass</a> = <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a3ecdc4bbf328b5216521cb2114f45935">objType</a> = <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea">ASN1_TYPE_SEQUENCE</a>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> = <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a> = <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="comment">//Write the corresponding ASN.1 tag</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   error = <a class="code" href="../../d6/d36/asn1_8c.html#a246f5e4192e8f064bd28d519a89d0207">asn1WriteTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, data + k, &amp;n);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="comment">//Advance write pointer</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   k += <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="comment">//Encode the parameter R using ASN.1</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a93c64e611d57dfb59e6ebafe938f28c1">constructed</a> = <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a9f35c291ffa22d903d9c66638bb225ea">objClass</a> = <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a3ecdc4bbf328b5216521cb2114f45935">objType</a> = <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> = rLen;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a> = <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="comment">//Write the corresponding ASN.1 tag</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   error = <a class="code" href="../../d6/d36/asn1_8c.html#a246f5e4192e8f064bd28d519a89d0207">asn1WriteTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, data + k, &amp;n);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="comment">//Advance write pointer</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   k += <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="comment">//Convert R to an octet string</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   error = <a class="code" href="../../dd/d89/crypto__legacy_8h.html#ae5151562c07814ce486b94bf0035ad12">mpiWriteRaw</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, data + k, rLen);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="comment">//Advance write pointer</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   k += rLen;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="comment">//Encode the parameter S using ASN.1</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a93c64e611d57dfb59e6ebafe938f28c1">constructed</a> = <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a9f35c291ffa22d903d9c66638bb225ea">objClass</a> = <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a3ecdc4bbf328b5216521cb2114f45935">objType</a> = <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> = sLen;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a> = <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="comment">//Write the corresponding ASN.1 tag</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   error = <a class="code" href="../../d6/d36/asn1_8c.html#a246f5e4192e8f064bd28d519a89d0207">asn1WriteTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, data + k, &amp;n);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="comment">//Advance write pointer</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   k += <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="comment">//Convert S to an octet string</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   error = <a class="code" href="../../dd/d89/crypto__legacy_8h.html#ae5151562c07814ce486b94bf0035ad12">mpiWriteRaw</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, data + k, sLen);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="comment">//Advance write pointer</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   k += sLen;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="comment">//Dump ECDSA signature</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  signature:\r\n&quot;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a1f71019169d85407d8827300ed43bdf0">TRACE_DEBUG_ARRAY</a>(<span class="stringliteral">&quot;    &quot;</span>, data, k);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="comment">//Total length of the ASN.1 structure</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   *length = <a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="comment">//Successful processing</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a51f5efbd49199a8d8db36b694f0683ff">  255</a></span>&#160;<a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a51f5efbd49199a8d8db36b694f0683ff">ecdsaReadSignature</a>(<span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *<a class="code" href="../../d3/d25/dtls__misc_8h.html#a5c239a1bb87b52b0f1d6d68c4749cd2a">data</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d3/d25/dtls__misc_8h.html#ab43ca82dd7fa2a0e56f941032ef324c4">length</a>,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <a class="code" href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a> *<a class="code" href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a>)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;{</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> error;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <a class="code" href="../../d2/de6/structAsn1Tag.html">Asn1Tag</a> tag;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;Reading ECDSA signature...\r\n&quot;</span>);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="comment">//Dump ECDSA signature</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  signature:\r\n&quot;</span>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a1f71019169d85407d8827300ed43bdf0">TRACE_DEBUG_ARRAY</a>(<span class="stringliteral">&quot;    &quot;</span>, data, length);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="comment">//Start of exception handling block</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="keywordflow">do</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">//Display ASN.1 structure</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      error = <a class="code" href="../../d6/d36/asn1_8c.html#adfebd6c0e21cc4d23414ff98aa9e9a69">asn1DumpObject</a>(data, length, 0);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">//Read the contents of the ASN.1 structure</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      error = <a class="code" href="../../d6/d36/asn1_8c.html#a5df4a5a14b22837b3dea3525608a9122">asn1ReadSequence</a>(data, length, &amp;tag);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">//Failed to decode ASN.1 tag?</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="comment">//Malformed ECDSA signature?</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">if</span>(length != tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">totalLength</a>)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="comment">//Report an error</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         error = <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0">ERROR_INVALID_SYNTAX</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="comment">//Point to the first field</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      data = tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      length = tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">//Read the parameter R</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      error = <a class="code" href="../../d6/d36/asn1_8c.html#a1abd5e2bb0488ff85fb1d94392f80dc4">asn1ReadTag</a>(data, length, &amp;tag);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">//Failed to decode ASN.1 tag?</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">//Enforce encoding, class and type</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      error = <a class="code" href="../../d6/d36/asn1_8c.html#a73fa06e5d71abe974aa6ad8fb53ecaa2">asn1CheckTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>, <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">//Invalid tag?</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="comment">//Make sure R is a positive integer</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">if</span>(tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> == 0 || (tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a>[0] &amp; 0x80) != 0)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         <span class="comment">//Report an error</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;         error = <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0">ERROR_INVALID_SYNTAX</a>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">//Convert the octet string to a multiple precision integer</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      error = <a class="code" href="../../dd/d89/crypto__legacy_8h.html#abcebe7f916d9073a85492596ec3924fa">mpiReadRaw</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a>, tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">//Point to the next field</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      data += tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">totalLength</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      length -= tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">totalLength</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">//Read the parameter S</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      error = <a class="code" href="../../d6/d36/asn1_8c.html#a1abd5e2bb0488ff85fb1d94392f80dc4">asn1ReadTag</a>(data, length, &amp;tag);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">//Failed to decode ASN.1 tag?</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="comment">//Enforce encoding, class and type</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      error = <a class="code" href="../../d6/d36/asn1_8c.html#a73fa06e5d71abe974aa6ad8fb53ecaa2">asn1CheckTag</a>(&amp;tag, <a class="code" href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a>, <a class="code" href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="comment">//Invalid tag?</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="comment">//Make sure S is a positive integer</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">if</span>(tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a> == 0 || (tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a>[0] &amp; 0x80) != 0)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         <span class="comment">//Report an error</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         error = <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0">ERROR_INVALID_SYNTAX</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="comment">//Convert the octet string to a multiple precision integer</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      error = <a class="code" href="../../dd/d89/crypto__legacy_8h.html#abcebe7f916d9073a85492596ec3924fa">mpiReadRaw</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">value</a>, tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">length</a>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">//Malformed ECDSA signature?</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">if</span>(length != tag.<a class="code" href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">totalLength</a>)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;         <span class="comment">//Report an error</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;         error = <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0">ERROR_INVALID_SYNTAX</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">//Dump (R, S) integer pair</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  r:\r\n&quot;</span>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  s:\r\n&quot;</span>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">//End of exception handling block</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   } <span class="keywordflow">while</span>(0);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="comment">//Any error to report?</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="comment">//Clean up side effects</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <a class="code" href="../../dc/d09/ecdsa_8c.html#a6f4daa07ea8815b8c67b47c4b089d157">ecdsaFreeSignature</a>(signature);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="comment">//Return status code</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#ac0d651638f0fbf5c5a5325430c9f7613">  390</a></span>&#160;<a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#ac0d651638f0fbf5c5a5325430c9f7613">ecdsaGenerateKeyPair</a>(<span class="keyword">const</span> <a class="code" href="../../de/d94/structPrngAlgo.html">PrngAlgo</a> *prngAlgo, <span class="keywordtype">void</span> *prngContext,</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keyword">const</span> <a class="code" href="../../d9/ddd/structEcDomainParameters.html">EcDomainParameters</a> *params, <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> *privateKey, <a class="code" href="../../df/d49/structEcPoint.html">EcPoint</a> *publicKey)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> error;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="comment">//Check parameters</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordflow">if</span>(params == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || privateKey == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || publicKey == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;Generating ECDSA key pair...\r\n&quot;</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="comment">//Let N be the bit length of q</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   n = <a class="code" href="../../db/d50/mpi_8c.html#a2e540eb4b5d15ea9755fb3e138990c1c">mpiGetBitLength</a>(&amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="comment">//Generated a pseudorandom number</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#a9753c7bf919b7c41e48512ba572c3bbb">mpiRand</a>(privateKey, n, prngAlgo, prngContext));</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="comment">//Make sure that 0 &lt; d &lt; q</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../db/d50/mpi_8c.html#a54cf7aedd99e130971849eb21eb578c9">mpiComp</a>(privateKey, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>) &gt;= 0)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#a550a7330971d895957015b810b25c805">mpiShiftRight</a>(privateKey, 1));</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  Private key:\r\n&quot;</span>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, privateKey);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="comment">//Compute Q = d.G</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#adfdc61723278833b0c8cecbb10185233">ecMult</a>(params, publicKey, privateKey, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#a48b4ef67c6d94e7be182ae6b73708511">g</a>));</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#af156298aca268c06f7708d4c4d700757">ecAffinify</a>(params, publicKey, publicKey));</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  Public key X:\r\n&quot;</span>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;publicKey-&gt;<a class="code" href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">x</a>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  Public key Y:\r\n&quot;</span>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;publicKey-&gt;<a class="code" href="../../df/d49/structEcPoint.html#a2102dff813849bd0eaed8a1a5e64ec1f">y</a>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;end:</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="comment">//Return status code</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#aab165583615f3a2993e75dfb41d9fa1e">  447</a></span>&#160;__weak <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a8f4a74d48b4e59e1682a6dc05fee42fe">ecdsaGenerateSignature</a>(<span class="keyword">const</span> <a class="code" href="../../de/d94/structPrngAlgo.html">PrngAlgo</a> *prngAlgo,</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="keywordtype">void</span> *prngContext, <span class="keyword">const</span> <a class="code" href="../../d9/ddd/structEcDomainParameters.html">EcDomainParameters</a> *params, <span class="keyword">const</span> <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> *privateKey,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *digest, <span class="keywordtype">size_t</span> digestLen, <a class="code" href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a> *<a class="code" href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a>)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> error;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> <a class="code" href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> <a class="code" href="../../da/d54/dns__common_8h.html#ab3539ae3820541b70d17c66cfc5a0e3f">z</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <a class="code" href="../../df/d49/structEcPoint.html">EcPoint</a> r1;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="comment">//Check parameters</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keywordflow">if</span>(params == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || privateKey == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || digest == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || signature == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;ECDSA signature generation...\r\n&quot;</span>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  private key:\r\n&quot;</span>);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, privateKey);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  digest:\r\n&quot;</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a1f71019169d85407d8827300ed43bdf0">TRACE_DEBUG_ARRAY</a>(<span class="stringliteral">&quot;    &quot;</span>, digest, digestLen);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="comment">//Initialize multiple precision integers</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;k);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;z);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="comment">//Initialize EC point</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <a class="code" href="../../db/d29/ec_8c.html#ac038e67dcc04d6d94bb930f9475f3ff8">ecInit</a>(&amp;r1);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="comment">//Let N be the bit length of q</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   n = <a class="code" href="../../db/d50/mpi_8c.html#a2e540eb4b5d15ea9755fb3e138990c1c">mpiGetBitLength</a>(&amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="comment">//Generated a pseudorandom number</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#a9753c7bf919b7c41e48512ba572c3bbb">mpiRand</a>(&amp;k, n, prngAlgo, prngContext));</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="comment">//Make sure that 0 &lt; k &lt; q</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../db/d50/mpi_8c.html#a54cf7aedd99e130971849eb21eb578c9">mpiComp</a>(&amp;k, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>) &gt;= 0)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <a class="code" href="../../db/d50/mpi_8c.html#a550a7330971d895957015b810b25c805">mpiShiftRight</a>(&amp;k, 1);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  k:\r\n&quot;</span>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;k);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="comment">//Compute N = MIN(N, outlen)</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   n = <a class="code" href="../../da/d42/os__port_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(n, digestLen * 8);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <span class="comment">//Convert the digest to a multiple precision integer</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../dd/d89/crypto__legacy_8h.html#abcebe7f916d9073a85492596ec3924fa">mpiReadRaw</a>(&amp;z, digest, (n + 7) / 8));</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="comment">//Keep the leftmost N bits of the hash value</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keywordflow">if</span>((n % 8) != 0)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#a550a7330971d895957015b810b25c805">mpiShiftRight</a>(&amp;z, 8 - (n % 8)));</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  z:\r\n&quot;</span>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;z);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="comment">//Compute R1 = (x1, y1) = k.G</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#adfdc61723278833b0c8cecbb10185233">ecMult</a>(params, &amp;r1, &amp;k, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#a48b4ef67c6d94e7be182ae6b73708511">g</a>));</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#af156298aca268c06f7708d4c4d700757">ecAffinify</a>(params, &amp;r1, &amp;r1));</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  x1:\r\n&quot;</span>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;r1.<a class="code" href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">x</a>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  y1:\r\n&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;r1.<a class="code" href="../../df/d49/structEcPoint.html#a2102dff813849bd0eaed8a1a5e64ec1f">y</a>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">//Compute r = x1 mod q</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#ac1ddf7a0ceb3cb9c2490edaef9878bf9">mpiMod</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, &amp;r1.<a class="code" href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">x</a>, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <span class="comment">//Compute k ^ -1 mod q</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../da/df9/samd51__crypto__pukcc_8c.html#a2195ea62b59019943aa5bfa4d309028f">mpiInvMod</a>(&amp;k, &amp;k, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <span class="comment">//Compute s = k ^ -1 * (z + x * r) mod q</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../da/df9/samd51__crypto__pukcc_8c.html#a5ce82adaded4af385feef6b79aaad6d2">mpiMul</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, privateKey, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>));</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#abd7700302eaf9c1a7929b0d4362f43a5">mpiAdd</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;z));</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#ac1ddf7a0ceb3cb9c2490edaef9878bf9">mpiMod</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#ab94435373793a664364ccd91dbd808b7">mpiMulMod</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;k, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="comment">//Dump ECDSA signature</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  r:\r\n&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  s:\r\n&quot;</span>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;end:</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="comment">//Release multiple precision integers</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;k);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;z);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="comment">//Release EC point</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <a class="code" href="../../db/d29/ec_8c.html#ae4a9276eac491f8acbb6d0916287411b">ecFree</a>(&amp;r1);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="comment">//Clean up side effects if necessary</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="keywordflow">if</span>(error)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="comment">//Release (R, S) integer pair</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">//Return status code</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="../../d5/d5d/ecdsa_8h.html#a599f498b0f041fbd312bc1c738f49415">  562</a></span>&#160;__weak <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> <a class="code" href="../../dc/d09/ecdsa_8c.html#a34b9fa4b6962c63ed4edf6f4ec1b6f6d">ecdsaVerifySignature</a>(<span class="keyword">const</span> <a class="code" href="../../d9/ddd/structEcDomainParameters.html">EcDomainParameters</a> *params,</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keyword">const</span> <a class="code" href="../../df/d49/structEcPoint.html">EcPoint</a> *publicKey, <span class="keyword">const</span> <a class="code" href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *digest, <span class="keywordtype">size_t</span> digestLen,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="keyword">const</span> <a class="code" href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a> *<a class="code" href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a>)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a> error;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <a class="code" href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a> <a class="code" href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> <a class="code" href="../../de/d79/ethernet_8h.html#aaa9bda35d7b2e3d98ecec180d3f628c0">w</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> <a class="code" href="../../da/d54/dns__common_8h.html#ab3539ae3820541b70d17c66cfc5a0e3f">z</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> u1;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> u2;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <a class="code" href="../../dd/d55/structMpi.html">Mpi</a> v;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <a class="code" href="../../df/d49/structEcPoint.html">EcPoint</a> <a class="code" href="../../d7/da5/pic32mx_2isr__support_8h.html#a723337565196458d5e9a5c5cdca2ff25">v0</a>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <a class="code" href="../../df/d49/structEcPoint.html">EcPoint</a> <a class="code" href="../../d7/da5/pic32mx_2isr__support_8h.html#aafd40fe8ac88a1eabd8379d8bda0ecb2">v1</a>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="comment">//Check parameters</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordflow">if</span>(params == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || publicKey == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || digest == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || signature == <a class="code" href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;ECDSA signature verification...\r\n&quot;</span>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  public key X:\r\n&quot;</span>);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;publicKey-&gt;<a class="code" href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">x</a>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  public key Y:\r\n&quot;</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;publicKey-&gt;<a class="code" href="../../df/d49/structEcPoint.html#a2102dff813849bd0eaed8a1a5e64ec1f">y</a>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  digest:\r\n&quot;</span>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a1f71019169d85407d8827300ed43bdf0">TRACE_DEBUG_ARRAY</a>(<span class="stringliteral">&quot;    &quot;</span>, digest, digestLen);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  r:\r\n&quot;</span>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  s:\r\n&quot;</span>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <span class="comment">//The verifier shall check that 0 &lt; r &lt; q</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../db/d50/mpi_8c.html#a46c2ff9f6fd5aa944ad4d41833ebef50">mpiCompInt</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, 0) &lt;= 0 || <a class="code" href="../../db/d50/mpi_8c.html#a54cf7aedd99e130971849eb21eb578c9">mpiComp</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>) &gt;= 0)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="comment">//If the condition is violated, the signature shall be rejected as invalid</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48">ERROR_INVALID_SIGNATURE</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="comment">//The verifier shall check that 0 &lt; s &lt; q</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../db/d50/mpi_8c.html#a46c2ff9f6fd5aa944ad4d41833ebef50">mpiCompInt</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, 0) &lt;= 0 || <a class="code" href="../../db/d50/mpi_8c.html#a54cf7aedd99e130971849eb21eb578c9">mpiComp</a>(&amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>) &gt;= 0)</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">//If the condition is violated, the signature shall be rejected as invalid</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48">ERROR_INVALID_SIGNATURE</a>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="comment">//Initialize multiple precision integers</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;w);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;z);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;u1);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;u2);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a>(&amp;v);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="comment">//Initialize EC points</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <a class="code" href="../../db/d29/ec_8c.html#ac038e67dcc04d6d94bb930f9475f3ff8">ecInit</a>(&amp;v0);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <a class="code" href="../../db/d29/ec_8c.html#ac038e67dcc04d6d94bb930f9475f3ff8">ecInit</a>(&amp;v1);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="comment">//Let N be the bit length of q</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   n = <a class="code" href="../../db/d50/mpi_8c.html#a2e540eb4b5d15ea9755fb3e138990c1c">mpiGetBitLength</a>(&amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="comment">//Compute N = MIN(N, outlen)</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   n = <a class="code" href="../../da/d42/os__port_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(n, digestLen * 8);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="comment">//Convert the digest to a multiple precision integer</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../dd/d89/crypto__legacy_8h.html#abcebe7f916d9073a85492596ec3924fa">mpiReadRaw</a>(&amp;z, digest, (n + 7) / 8));</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <span class="comment">//Keep the leftmost N bits of the hash value</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <span class="keywordflow">if</span>((n % 8) != 0)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#a550a7330971d895957015b810b25c805">mpiShiftRight</a>(&amp;z, 8 - (n % 8)));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <span class="comment">//Compute w = s ^ -1 mod q</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../da/df9/samd51__crypto__pukcc_8c.html#a2195ea62b59019943aa5bfa4d309028f">mpiInvMod</a>(&amp;w, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">s</a>, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="comment">//Compute u1 = z * w mod q</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#ab94435373793a664364ccd91dbd808b7">mpiMulMod</a>(&amp;u1, &amp;z, &amp;w, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   <span class="comment">//Compute u2 = r * w mod q</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#ab94435373793a664364ccd91dbd808b7">mpiMulMod</a>(&amp;u2, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>, &amp;w, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <span class="comment">//Compute V0 = (x0, y0) = u1.G + u2.Q</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#a1dbdfb4f5689eb88092fa08bc50eda00">ecProjectify</a>(params, &amp;v1, publicKey));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#aa71cc4a2e12f627bca5a9279e10e17ec">ecTwinMult</a>(params, &amp;v0, &amp;u1, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#a48b4ef67c6d94e7be182ae6b73708511">g</a>, &amp;u2, &amp;v1));</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <a class="code" href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a>(<a class="code" href="../../db/d29/ec_8c.html#af156298aca268c06f7708d4c4d700757">ecAffinify</a>(params, &amp;v0, &amp;v0));</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  x0:\r\n&quot;</span>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;v0.<a class="code" href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">x</a>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  y0:\r\n&quot;</span>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;v0.<a class="code" href="../../df/d49/structEcPoint.html#a2102dff813849bd0eaed8a1a5e64ec1f">y</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="comment">//Compute v = x0 mod q</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   <a class="code" href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a>(<a class="code" href="../../db/d50/mpi_8c.html#ac1ddf7a0ceb3cb9c2490edaef9878bf9">mpiMod</a>(&amp;v, &amp;v0.<a class="code" href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">x</a>, &amp;params-&gt;<a class="code" href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">q</a>));</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   <span class="comment">//Debug message</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a>(<span class="stringliteral">&quot;  v:\r\n&quot;</span>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <a class="code" href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a>(<span class="stringliteral">&quot;    &quot;</span>, &amp;v);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="comment">//If v = r, then the signature is verified. If v does not equal r,</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="comment">//then the message or the signature may have been modified</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="../../db/d50/mpi_8c.html#a54cf7aedd99e130971849eb21eb578c9">mpiComp</a>(&amp;v, &amp;signature-&gt;<a class="code" href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">r</a>))</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      error = <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      error = <a class="code" href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48">ERROR_INVALID_SIGNATURE</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;end:</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <span class="comment">//Release multiple precision integers</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;w);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;z);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;u1);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;u2);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <a class="code" href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a>(&amp;v);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="comment">//Release EC points</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../db/d29/ec_8c.html#ae4a9276eac491f8acbb6d0916287411b">ecFree</a>(&amp;v0);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <a class="code" href="../../db/d29/ec_8c.html#ae4a9276eac491f8acbb6d0916287411b">ecFree</a>(&amp;v1);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <span class="comment">//Return status code</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="mpi_8c_html_a9753c7bf919b7c41e48512ba572c3bbb"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a9753c7bf919b7c41e48512ba572c3bbb">mpiRand</a></div><div class="ttdeci">error_t mpiRand(Mpi *r, uint_t length, const PrngAlgo *prngAlgo, void *prngContext)</div><div class="ttdoc">Generate a random value. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00468">mpi.c:468</a></div></div>
<div class="ttc" id="asn1_8c_html_adfebd6c0e21cc4d23414ff98aa9e9a69"><div class="ttname"><a href="../../d6/d36/asn1_8c.html#adfebd6c0e21cc4d23414ff98aa9e9a69">asn1DumpObject</a></div><div class="ttdeci">error_t asn1DumpObject(const uint8_t *data, size_t length, uint_t level)</div><div class="ttdoc">Display an ASN.1 data object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d36/asn1_8c_source.html#l00690">asn1.c:690</a></div></div>
<div class="ttc" id="structEcDomainParameters_html_a48b4ef67c6d94e7be182ae6b73708511"><div class="ttname"><a href="../../d9/ddd/structEcDomainParameters.html#a48b4ef67c6d94e7be182ae6b73708511">EcDomainParameters::g</a></div><div class="ttdeci">EcPoint g</div><div class="ttdoc">Base point G. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00070">ec.h:70</a></div></div>
<div class="ttc" id="ecdsa_8c_html_ad311e1710697e87730e321b45a5e65e3"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#ad311e1710697e87730e321b45a5e65e3">ECDSA_WITH_SHA512_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA512_OID[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00053">ecdsa.c:53</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a377d9053f5c7ba2c5659080e0ebff342"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a377d9053f5c7ba2c5659080e0ebff342">ECDSA_WITH_SHA3_512_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA3_512_OID[9]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00061">ecdsa.c:61</a></div></div>
<div class="ttc" id="structPrngAlgo_html"><div class="ttname"><a href="../../de/d94/structPrngAlgo.html">PrngAlgo</a></div><div class="ttdoc">Common interface for pseudo-random number generators. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h_source.html#l01168">crypto.h:1168</a></div></div>
<div class="ttc" id="structMpi_html"><div class="ttname"><a href="../../dd/d55/structMpi.html">Mpi</a></div><div class="ttdoc">Arbitrary precision integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd8/mpi_8h_source.html#l00069">mpi.h:69</a></div></div>
<div class="ttc" id="structEcDomainParameters_html"><div class="ttname"><a href="../../d9/ddd/structEcDomainParameters.html">EcDomainParameters</a></div><div class="ttdoc">EC domain parameters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00063">ec.h:63</a></div></div>
<div class="ttc" id="crypto__legacy_8h_html_ae5151562c07814ce486b94bf0035ad12"><div class="ttname"><a href="../../dd/d89/crypto__legacy_8h.html#ae5151562c07814ce486b94bf0035ad12">mpiWriteRaw</a></div><div class="ttdeci">#define mpiWriteRaw(a, data, length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d89/crypto__legacy_8h_source.html#l00036">crypto_legacy.h:36</a></div></div>
<div class="ttc" id="ecdsa_8c_html_af310b898cce19d1b620bb8cd44d0634c"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#af310b898cce19d1b620bb8cd44d0634c">ECDSA_WITH_SHA3_384_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA3_384_OID[9]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00059">ecdsa.c:59</a></div></div>
<div class="ttc" id="mpi_8c_html_a9dc5be2f62d37d3854fa61beab3a61ad"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a9dc5be2f62d37d3854fa61beab3a61ad">mpiFree</a></div><div class="ttdeci">void mpiFree(Mpi *r)</div><div class="ttdoc">Release a multiple precision integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00062">mpi.c:62</a></div></div>
<div class="ttc" id="structEcdsaSignature_html_a5ad53c056e439704d86c50e4b8a328b6"><div class="ttname"><a href="../../d5/d0a/structEcdsaSignature.html#a5ad53c056e439704d86c50e4b8a328b6">EcdsaSignature::s</a></div><div class="ttdeci">Mpi s</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5d/ecdsa_8h_source.html#l00051">ecdsa.h:51</a></div></div>
<div class="ttc" id="dns__common_8h_html_ab3539ae3820541b70d17c66cfc5a0e3f"><div class="ttname"><a href="../../da/d54/dns__common_8h.html#ab3539ae3820541b70d17c66cfc5a0e3f">z</a></div><div class="ttdeci">uint8_t z</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d54/dns__common_8h_source.html#l00175">dns_common.h:175</a></div></div>
<div class="ttc" id="pic32mx_2isr__support_8h_html_aafd40fe8ac88a1eabd8379d8bda0ecb2"><div class="ttname"><a href="../../d7/da5/pic32mx_2isr__support_8h.html#aafd40fe8ac88a1eabd8379d8bda0ecb2">v1</a></div><div class="ttdeci">macro portSAVE_CONTEXT mfc0 _CP0_CAUSE addiu portCONTEXT_SIZE mfc0 _CP0_STATUS sw sp sw sp sw ins ins add sp la uxInterruptNesting lw k0 bne nop la xISRStackTop lw sw k0 mfc0 _CP0_EPC mtc0 _CP0_STATUS sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw v1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da5/pic32mx_2isr__support_8h_source.html#l00051">isr_support.h:51</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a2c82fe5e3c598e3c764973f22fa53bd0"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a2c82fe5e3c598e3c764973f22fa53bd0">ECDSA_WITH_SHA224_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA224_OID[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00047">ecdsa.c:47</a></div></div>
<div class="ttc" id="mpi_8c_html_ab94435373793a664364ccd91dbd808b7"><div class="ttname"><a href="../../db/d50/mpi_8c.html#ab94435373793a664364ccd91dbd808b7">mpiMulMod</a></div><div class="ttdeci">error_t mpiMulMod(Mpi *r, const Mpi *a, const Mpi *b, const Mpi *p)</div><div class="ttdoc">Modular multiplication. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l01436">mpi.c:1436</a></div></div>
<div class="ttc" id="debug_8h_html"><div class="ttname"><a href="../../db/d16/debug_8h.html">debug.h</a></div><div class="ttdoc">Debugging facilities. </div></div>
<div class="ttc" id="ecdsa_8c_html_a34b9fa4b6962c63ed4edf6f4ec1b6f6d"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a34b9fa4b6962c63ed4edf6f4ec1b6f6d">ecdsaVerifySignature</a></div><div class="ttdeci">__weak error_t ecdsaVerifySignature(const EcDomainParameters *params, const EcPoint *publicKey, const uint8_t *digest, size_t digestLen, const EcdsaSignature *signature)</div><div class="ttdoc">ECDSA signature verification. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00562">ecdsa.c:562</a></div></div>
<div class="ttc" id="structEcdsaSignature_html_a4e23fcd13582b13713fd2b79355ec586"><div class="ttname"><a href="../../d5/d0a/structEcdsaSignature.html#a4e23fcd13582b13713fd2b79355ec586">EcdsaSignature::r</a></div><div class="ttdeci">Mpi r</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5d/ecdsa_8h_source.html#l00050">ecdsa.h:50</a></div></div>
<div class="ttc" id="ecdsa_8h_html"><div class="ttname"><a href="../../d5/d5d/ecdsa_8h.html">ecdsa.h</a></div><div class="ttdoc">ECDSA (Elliptic Curve Digital Signature Algorithm) </div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689caeae4b12e06d727d085f75f79a820f2e8">ERROR_INVALID_PARAMETER</a></div><div class="ttdoc">Invalid parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00047">error.h:47</a></div></div>
<div class="ttc" id="mpi_8c_html_a54cf7aedd99e130971849eb21eb578c9"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a54cf7aedd99e130971849eb21eb578c9">mpiComp</a></div><div class="ttdeci">int_t mpiComp(const Mpi *a, const Mpi *b)</div><div class="ttdoc">Compare two multiple precision integers. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00295">mpi.c:295</a></div></div>
<div class="ttc" id="samd51__crypto__pukcc_8c_html_a5ce82adaded4af385feef6b79aaad6d2"><div class="ttname"><a href="../../da/df9/samd51__crypto__pukcc_8c.html#a5ce82adaded4af385feef6b79aaad6d2">mpiMul</a></div><div class="ttdeci">error_t mpiMul(Mpi *r, const Mpi *a, const Mpi *b)</div><div class="ttdoc">Multiple precision multiplication. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df9/samd51__crypto__pukcc_8c_source.html#l00190">samd51_crypto_pukcc.c:190</a></div></div>
<div class="ttc" id="ec_8h_html_ab3bdd4fc9d2068ed2f78d09c85102198"><div class="ttname"><a href="../../d1/d28/ec_8h.html#ab3bdd4fc9d2068ed2f78d09c85102198">EC_CHECK</a></div><div class="ttdeci">#define EC_CHECK(f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00039">ec.h:39</a></div></div>
<div class="ttc" id="mpi_8h_html_a5e76fea2f61391de0c215692cbd3f418"><div class="ttname"><a href="../../d1/dd8/mpi_8h.html#a5e76fea2f61391de0c215692cbd3f418">MPI_CHECK</a></div><div class="ttdeci">#define MPI_CHECK(f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd8/mpi_8h_source.html#l00042">mpi.h:42</a></div></div>
<div class="ttc" id="debug_8h_html_a1f71019169d85407d8827300ed43bdf0"><div class="ttname"><a href="../../db/d16/debug_8h.html#a1f71019169d85407d8827300ed43bdf0">TRACE_DEBUG_ARRAY</a></div><div class="ttdeci">#define TRACE_DEBUG_ARRAY(p, a, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00107">debug.h:107</a></div></div>
<div class="ttc" id="group__BSPDefine_html_ga070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../de/da2/group__BSPDefine.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6b/nm__bsp_8h_source.html#l00070">nm_bsp.h:70</a></div></div>
<div class="ttc" id="ec_8c_html_ac038e67dcc04d6d94bb930f9475f3ff8"><div class="ttname"><a href="../../db/d29/ec_8c.html#ac038e67dcc04d6d94bb930f9475f3ff8">ecInit</a></div><div class="ttdeci">void ecInit(EcPoint *r)</div><div class="ttdoc">Initialize elliptic curve point. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d29/ec_8c_source.html#l00156">ec.c:156</a></div></div>
<div class="ttc" id="stdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="../../df/dd8/stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/stdint_8h_source.html#l00078">stdint.h:78</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a63fbac830ec56b5cd0a29a06662f123f"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a63fbac830ec56b5cd0a29a06662f123f">ECDSA_WITH_SHA3_256_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA3_256_OID[9]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00057">ecdsa.c:57</a></div></div>
<div class="ttc" id="ethernet_8h_html_aaa9bda35d7b2e3d98ecec180d3f628c0"><div class="ttname"><a href="../../de/d79/ethernet_8h.html#aaa9bda35d7b2e3d98ecec180d3f628c0">w</a></div><div class="ttdeci">uint16_t w[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d79/ethernet_8h_source.html#l00166">ethernet.h:166</a></div></div>
<div class="ttc" id="ecdsa_8c_html_ac0d651638f0fbf5c5a5325430c9f7613"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#ac0d651638f0fbf5c5a5325430c9f7613">ecdsaGenerateKeyPair</a></div><div class="ttdeci">error_t ecdsaGenerateKeyPair(const PrngAlgo *prngAlgo, void *prngContext, const EcDomainParameters *params, Mpi *privateKey, EcPoint *publicKey)</div><div class="ttdoc">ECDSA key pair generation. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00390">ecdsa.c:390</a></div></div>
<div class="ttc" id="os__port_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../da/d42/os__port_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d42/os__port_8h_source.html#l00050">os_port.h:50</a></div></div>
<div class="ttc" id="debug_8h_html_a9c9f3b28f2daf14d77b401512c189d93"><div class="ttname"><a href="../../db/d16/debug_8h.html#a9c9f3b28f2daf14d77b401512c189d93">TRACE_DEBUG_MPI</a></div><div class="ttdeci">#define TRACE_DEBUG_MPI(p, a)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00109">debug.h:109</a></div></div>
<div class="ttc" id="asn1_8c_html_a246f5e4192e8f064bd28d519a89d0207"><div class="ttname"><a href="../../d6/d36/asn1_8c.html#a246f5e4192e8f064bd28d519a89d0207">asn1WriteTag</a></div><div class="ttdeci">error_t asn1WriteTag(Asn1Tag *tag, bool_t reverse, uint8_t *data, size_t *written)</div><div class="ttdoc">Write an ASN.1 tag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d36/asn1_8c_source.html#l00377">asn1.c:377</a></div></div>
<div class="ttc" id="asn1_8c_html_a73fa06e5d71abe974aa6ad8fb53ecaa2"><div class="ttname"><a href="../../d6/d36/asn1_8c.html#a73fa06e5d71abe974aa6ad8fb53ecaa2">asn1CheckTag</a></div><div class="ttdeci">error_t asn1CheckTag(const Asn1Tag *tag, bool_t constructed, uint_t objClass, uint_t objType)</div><div class="ttdoc">Enforce the type of a specified tag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d36/asn1_8c_source.html#l00637">asn1.c:637</a></div></div>
<div class="ttc" id="structEcPoint_html"><div class="ttname"><a href="../../df/d49/structEcPoint.html">EcPoint</a></div><div class="ttdoc">Elliptic curve point. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00051">ec.h:51</a></div></div>
<div class="ttc" id="ec_8c_html_a1dbdfb4f5689eb88092fa08bc50eda00"><div class="ttname"><a href="../../db/d29/ec_8c.html#a1dbdfb4f5689eb88092fa08bc50eda00">ecProjectify</a></div><div class="ttdeci">error_t ecProjectify(const EcDomainParameters *params, EcPoint *r, const EcPoint *s)</div><div class="ttdoc">Compute projective representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d29/ec_8c_source.html#l00344">ec.c:344</a></div></div>
<div class="ttc" id="asn1_8h_html"><div class="ttname"><a href="../../d1/d63/asn1_8h.html">asn1.h</a></div><div class="ttdoc">ASN.1 (Abstract Syntax Notation One) </div></div>
<div class="ttc" id="asn1_8c_html_a5df4a5a14b22837b3dea3525608a9122"><div class="ttname"><a href="../../d6/d36/asn1_8c.html#a5df4a5a14b22837b3dea3525608a9122">asn1ReadSequence</a></div><div class="ttdeci">error_t asn1ReadSequence(const uint8_t *data, size_t length, Asn1Tag *tag)</div><div class="ttdoc">Read an ASN.1 sequence from the input stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d36/asn1_8c_source.html#l00163">asn1.c:163</a></div></div>
<div class="ttc" id="ecdsa_8c_html_aef8cd9a530146f44fc0597eb67480133"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#aef8cd9a530146f44fc0597eb67480133">ecdsaInitSignature</a></div><div class="ttdeci">void ecdsaInitSignature(EcdsaSignature *signature)</div><div class="ttdoc">Initialize an ECDSA signature. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00069">ecdsa.c:69</a></div></div>
<div class="ttc" id="crypto__legacy_8h_html_abcebe7f916d9073a85492596ec3924fa"><div class="ttname"><a href="../../dd/d89/crypto__legacy_8h.html#abcebe7f916d9073a85492596ec3924fa">mpiReadRaw</a></div><div class="ttdeci">#define mpiReadRaw(r, data, length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d89/crypto__legacy_8h_source.html#l00035">crypto_legacy.h:35</a></div></div>
<div class="ttc" id="ecdsa_8c_html_aa5356473862a85426ad8574589c44b9e"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#aa5356473862a85426ad8574589c44b9e">ECDSA_WITH_SHA384_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA384_OID[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00051">ecdsa.c:51</a></div></div>
<div class="ttc" id="cyclone__crypto_2core_2crypto_8h_html"><div class="ttname"><a href="../../d1/d81/cyclone__crypto_2core_2crypto_8h.html">crypto.h</a></div></div>
<div class="ttc" id="mpi_8c_html_a2e540eb4b5d15ea9755fb3e138990c1c"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a2e540eb4b5d15ea9755fb3e138990c1c">mpiGetBitLength</a></div><div class="ttdeci">uint_t mpiGetBitLength(const Mpi *a)</div><div class="ttdoc">Get the actual length in bits. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00195">mpi.c:195</a></div></div>
<div class="ttc" id="asn1_8c_html_a1abd5e2bb0488ff85fb1d94392f80dc4"><div class="ttname"><a href="../../d6/d36/asn1_8c.html#a1abd5e2bb0488ff85fb1d94392f80dc4">asn1ReadTag</a></div><div class="ttdeci">error_t asn1ReadTag(const uint8_t *data, size_t length, Asn1Tag *tag)</div><div class="ttdoc">Read an ASN.1 tag from the input stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d36/asn1_8c_source.html#l00052">asn1.c:52</a></div></div>
<div class="ttc" id="ec_8c_html_af156298aca268c06f7708d4c4d700757"><div class="ttname"><a href="../../db/d29/ec_8c.html#af156298aca268c06f7708d4c4d700757">ecAffinify</a></div><div class="ttdeci">__weak error_t ecAffinify(const EcDomainParameters *params, EcPoint *r, const EcPoint *s)</div><div class="ttdoc">Recover affine representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d29/ec_8c_source.html#l00368">ec.c:368</a></div></div>
<div class="ttc" id="structAsn1Tag_html"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html">Asn1Tag</a></div><div class="ttdoc">ASN.1 tag. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00097">asn1.h:97</a></div></div>
<div class="ttc" id="structEcdsaSignature_html"><div class="ttname"><a href="../../d5/d0a/structEcdsaSignature.html">EcdsaSignature</a></div><div class="ttdoc">ECDSA signature. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d5d/ecdsa_8h_source.html#l00048">ecdsa.h:48</a></div></div>
<div class="ttc" id="mpi_8c_html_ad62c1f7143a1cc46b080bea217f20ede"><div class="ttname"><a href="../../db/d50/mpi_8c.html#ad62c1f7143a1cc46b080bea217f20ede">mpiGetBitValue</a></div><div class="ttdeci">uint_t mpiGetBitValue(const Mpi *a, uint_t index)</div><div class="ttdoc">Get the bit value at the specified index. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00270">mpi.c:270</a></div></div>
<div class="ttc" id="os__port_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="../../da/d42/os__port_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d42/os__port_8h_source.html#l00062">os_port.h:62</a></div></div>
<div class="ttc" id="mpi_8c_html_abd7700302eaf9c1a7929b0d4362f43a5"><div class="ttname"><a href="../../db/d50/mpi_8c.html#abd7700302eaf9c1a7929b0d4362f43a5">mpiAdd</a></div><div class="ttdeci">error_t mpiAdd(Mpi *r, const Mpi *a, const Mpi *b)</div><div class="ttdoc">Multiple precision addition. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00696">mpi.c:696</a></div></div>
<div class="ttc" id="pic32mx_2isr__support_8h_html_a723337565196458d5e9a5c5cdca2ff25"><div class="ttname"><a href="../../d7/da5/pic32mx_2isr__support_8h.html#a723337565196458d5e9a5c5cdca2ff25">v0</a></div><div class="ttdeci">macro portSAVE_CONTEXT mfc0 _CP0_CAUSE addiu portCONTEXT_SIZE mfc0 _CP0_STATUS sw sp sw sp sw ins ins add sp la uxInterruptNesting lw k0 bne nop la xISRStackTop lw sw k0 mfc0 _CP0_EPC mtc0 _CP0_STATUS sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw s5 sw v0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da5/pic32mx_2isr__support_8h_source.html#l00051">isr_support.h:51</a></div></div>
<div class="ttc" id="tls_8h_html_af27e6d4ea3add14cd8cc9aa275d716ad"><div class="ttname"><a href="../../df/d79/tls_8h.html#af27e6d4ea3add14cd8cc9aa275d716ad">signature</a></div><div class="ttdeci">uint8_t signature</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l01370">tls.h:1370</a></div></div>
<div class="ttc" id="structAsn1Tag_html_a5131e751817ae2cbfdaf031c2ce97f3d"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html#a5131e751817ae2cbfdaf031c2ce97f3d">Asn1Tag::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00102">asn1.h:102</a></div></div>
<div class="ttc" id="md5_8c_html_af11ea3cdbca7345eb6a4a8ac5ce0434d"><div class="ttname"><a href="../../d7/d6c/md5_8c.html#af11ea3cdbca7345eb6a4a8ac5ce0434d">k</a></div><div class="ttdeci">static const uint32_t k[64]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6c/md5_8c_source.html#l00067">md5.c:67</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a8f4a74d48b4e59e1682a6dc05fee42fe"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a8f4a74d48b4e59e1682a6dc05fee42fe">ecdsaGenerateSignature</a></div><div class="ttdeci">__weak error_t ecdsaGenerateSignature(const PrngAlgo *prngAlgo, void *prngContext, const EcDomainParameters *params, const Mpi *privateKey, const uint8_t *digest, size_t digestLen, EcdsaSignature *signature)</div><div class="ttdoc">ECDSA signature generation. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00447">ecdsa.c:447</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94">NO_ERROR</a></div><div class="ttdoc">Success. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00044">error.h:44</a></div></div>
<div class="ttc" id="asn1_8h_html_a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea"><div class="ttname"><a href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf6223adf2132054146cf838b14c593ea">ASN1_TYPE_SEQUENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00076">asn1.h:76</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a6f4daa07ea8815b8c67b47c4b089d157"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a6f4daa07ea8815b8c67b47c4b089d157">ecdsaFreeSignature</a></div><div class="ttdeci">void ecdsaFreeSignature(EcdsaSignature *signature)</div><div class="ttdoc">Release an ECDSA signature. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00082">ecdsa.c:82</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689c"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689c">error_t</a></div><div class="ttdeci">error_t</div><div class="ttdoc">Error codes. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00042">error.h:42</a></div></div>
<div class="ttc" id="mpi_8h_html"><div class="ttname"><a href="../../d1/dd8/mpi_8h.html">mpi.h</a></div><div class="ttdoc">MPI (Multiple Precision Integer Arithmetic) </div></div>
<div class="ttc" id="mpi_8c_html_a46c2ff9f6fd5aa944ad4d41833ebef50"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a46c2ff9f6fd5aa944ad4d41833ebef50">mpiCompInt</a></div><div class="ttdeci">int_t mpiCompInt(const Mpi *a, int_t b)</div><div class="ttdoc">Compare a multiple precision integer with an integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00339">mpi.c:339</a></div></div>
<div class="ttc" id="ec_8c_html_ae4a9276eac491f8acbb6d0916287411b"><div class="ttname"><a href="../../db/d29/ec_8c.html#ae4a9276eac491f8acbb6d0916287411b">ecFree</a></div><div class="ttdeci">void ecFree(EcPoint *r)</div><div class="ttdoc">Release an elliptic curve point. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d29/ec_8c_source.html#l00170">ec.c:170</a></div></div>
<div class="ttc" id="structAsn1Tag_html_a27df45a2d65de5a2a1289a64e43149bf"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html#a27df45a2d65de5a2a1289a64e43149bf">Asn1Tag::totalLength</a></div><div class="ttdeci">size_t totalLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00104">asn1.h:104</a></div></div>
<div class="ttc" id="compiler__port_8h_html_a12a1e9b3ce141648783a82445d02b58d"><div class="ttname"><a href="../../d1/dfa/compiler__port_8h.html#a12a1e9b3ce141648783a82445d02b58d">uint_t</a></div><div class="ttdeci">unsigned int uint_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfa/compiler__port_8h_source.html#l00045">compiler_port.h:45</a></div></div>
<div class="ttc" id="dtls__misc_8h_html_a5c239a1bb87b52b0f1d6d68c4749cd2a"><div class="ttname"><a href="../../d3/d25/dtls__misc_8h.html#a5c239a1bb87b52b0f1d6d68c4749cd2a">data</a></div><div class="ttdeci">uint8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d25/dtls__misc_8h_source.html#l00176">dtls_misc.h:176</a></div></div>
<div class="ttc" id="ec_8c_html_aa71cc4a2e12f627bca5a9279e10e17ec"><div class="ttname"><a href="../../db/d29/ec_8c.html#aa71cc4a2e12f627bca5a9279e10e17ec">ecTwinMult</a></div><div class="ttdeci">error_t ecTwinMult(const EcDomainParameters *params, EcPoint *r, const Mpi *d0, const EcPoint *s, const Mpi *d1, const EcPoint *t)</div><div class="ttdoc">Twin multiplication. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d29/ec_8c_source.html#l00984">ec.c:984</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a38bfa167c941721c005548c336c44d51"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a38bfa167c941721c005548c336c44d51">ecdsaWriteSignature</a></div><div class="ttdeci">error_t ecdsaWriteSignature(const EcdsaSignature *signature, uint8_t *data, size_t *length)</div><div class="ttdoc">Encode ECDSA signature using ASN.1. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00098">ecdsa.c:98</a></div></div>
<div class="ttc" id="samd51__crypto__pukcc_8c_html_a2195ea62b59019943aa5bfa4d309028f"><div class="ttname"><a href="../../da/df9/samd51__crypto__pukcc_8c.html#a2195ea62b59019943aa5bfa4d309028f">mpiInvMod</a></div><div class="ttdeci">error_t mpiInvMod(Mpi *r, const Mpi *a, const Mpi *p)</div><div class="ttdoc">Modular inverse. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df9/samd51__crypto__pukcc_8c_source.html#l00346">samd51_crypto_pukcc.c:346</a></div></div>
<div class="ttc" id="structEcPoint_html_a2102dff813849bd0eaed8a1a5e64ec1f"><div class="ttname"><a href="../../df/d49/structEcPoint.html#a2102dff813849bd0eaed8a1a5e64ec1f">EcPoint::y</a></div><div class="ttdeci">Mpi y</div><div class="ttdoc">y-coordinate </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00054">ec.h:54</a></div></div>
<div class="ttc" id="asn1_8h_html_ab3589ac11c049bfda069aa3ecf683578"><div class="ttname"><a href="../../d1/d63/asn1_8h.html#ab3589ac11c049bfda069aa3ecf683578">ASN1_CLASS_UNIVERSAL</a></div><div class="ttdeci">#define ASN1_CLASS_UNIVERSAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00048">asn1.h:48</a></div></div>
<div class="ttc" id="ec_8c_html_adfdc61723278833b0c8cecbb10185233"><div class="ttname"><a href="../../db/d29/ec_8c.html#adfdc61723278833b0c8cecbb10185233">ecMult</a></div><div class="ttdeci">__weak error_t ecMult(const EcDomainParameters *params, EcPoint *r, const Mpi *d, const EcPoint *s)</div><div class="ttdoc">Scalar multiplication. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d29/ec_8c_source.html#l00835">ec.c:835</a></div></div>
<div class="ttc" id="ecdsa_8c_html_af020650a7162df3e86dc65f7cc8da14f"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#af020650a7162df3e86dc65f7cc8da14f">ECDSA_WITH_SHA1_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA1_OID[7]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00045">ecdsa.c:45</a></div></div>
<div class="ttc" id="structAsn1Tag_html_a9f35c291ffa22d903d9c66638bb225ea"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html#a9f35c291ffa22d903d9c66638bb225ea">Asn1Tag::objClass</a></div><div class="ttdeci">uint_t objClass</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00100">asn1.h:100</a></div></div>
<div class="ttc" id="structAsn1Tag_html_a90f3832fa59c62feb4fb8be9d8b11b29"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html#a90f3832fa59c62feb4fb8be9d8b11b29">Asn1Tag::value</a></div><div class="ttdeci">const uint8_t * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00103">asn1.h:103</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca92e7b26953f11d1bc4f4526fad39aed0">ERROR_INVALID_SYNTAX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00068">error.h:68</a></div></div>
<div class="ttc" id="structEcPoint_html_a08f3fbb7a7d07607306bd8d6200629af"><div class="ttname"><a href="../../df/d49/structEcPoint.html#a08f3fbb7a7d07607306bd8d6200629af">EcPoint::x</a></div><div class="ttdeci">Mpi x</div><div class="ttdoc">x-coordinate </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00053">ec.h:53</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689ca6e8db1d17e3aad53ecc5a4ff62df6f48">ERROR_INVALID_SIGNATURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00223">error.h:223</a></div></div>
<div class="ttc" id="asn1_8h_html_a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994"><div class="ttname"><a href="../../d1/d63/asn1_8h.html#a1b0f39cb3d87e425703ba389df9da1dfaf49fe8465a80ebfbe92fe0f0622ec994">ASN1_TYPE_INTEGER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00066">asn1.h:66</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a2fed3fb0f037994cea3dd5350e4018e5"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a2fed3fb0f037994cea3dd5350e4018e5">ECDSA_WITH_SHA3_224_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA3_224_OID[9]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00055">ecdsa.c:55</a></div></div>
<div class="ttc" id="error_8h_html_ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28"><div class="ttname"><a href="../../da/d41/error_8h.html#ac7659d73a8cdedc08e9f566bb406689cae5c014519c3ac2540447887ddca1bd28">ERROR_INVALID_LENGTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/error_8h_source.html#l00109">error.h:109</a></div></div>
<div class="ttc" id="dtls__misc_8h_html_ab43ca82dd7fa2a0e56f941032ef324c4"><div class="ttname"><a href="../../d3/d25/dtls__misc_8h.html#ab43ca82dd7fa2a0e56f941032ef324c4">length</a></div><div class="ttdeci">uint8_t length</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d25/dtls__misc_8h_source.html#l00149">dtls_misc.h:149</a></div></div>
<div class="ttc" id="dhcpv6__common_8h_html_a5a648f5ec00c526b0dfa2df7a272c6c0"><div class="ttname"><a href="../../d1/ddf/dhcpv6__common_8h.html#a5a648f5ec00c526b0dfa2df7a272c6c0">n</a></div><div class="ttdeci">uint8_t n</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/dhcpv6__common_8h_source.html#l00413">dhcpv6_common.h:413</a></div></div>
<div class="ttc" id="mpi_8c_html_a6f30959dcaabfb16e96cc47ef90515a6"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a6f30959dcaabfb16e96cc47ef90515a6">mpiInit</a></div><div class="ttdeci">void mpiInit(Mpi *r)</div><div class="ttdoc">Initialize a multiple precision integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00048">mpi.c:48</a></div></div>
<div class="ttc" id="mpi_8c_html_a8599cb7537c854ae3b2442144c7f853b"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a8599cb7537c854ae3b2442144c7f853b">mpiGetByteLength</a></div><div class="ttdeci">uint_t mpiGetByteLength(const Mpi *a)</div><div class="ttdoc">Get the actual length in bytes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l00156">mpi.c:156</a></div></div>
<div class="ttc" id="os__port_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../da/d42/os__port_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d42/os__port_8h_source.html#l00046">os_port.h:46</a></div></div>
<div class="ttc" id="structAsn1Tag_html_a3ecdc4bbf328b5216521cb2114f45935"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html#a3ecdc4bbf328b5216521cb2114f45935">Asn1Tag::objType</a></div><div class="ttdeci">uint_t objType</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00101">asn1.h:101</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a51f5efbd49199a8d8db36b694f0683ff"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a51f5efbd49199a8d8db36b694f0683ff">ecdsaReadSignature</a></div><div class="ttdeci">error_t ecdsaReadSignature(const uint8_t *data, size_t length, EcdsaSignature *signature)</div><div class="ttdoc">Read an ASN.1 encoded ECDSA signature. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00255">ecdsa.c:255</a></div></div>
<div class="ttc" id="ecdsa_8c_html_a552ef11d006434b7d6302c762d084771"><div class="ttname"><a href="../../dc/d09/ecdsa_8c.html#a552ef11d006434b7d6302c762d084771">ECDSA_WITH_SHA256_OID</a></div><div class="ttdeci">const uint8_t ECDSA_WITH_SHA256_OID[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/ecdsa_8c_source.html#l00049">ecdsa.c:49</a></div></div>
<div class="ttc" id="structAsn1Tag_html_a93c64e611d57dfb59e6ebafe938f28c1"><div class="ttname"><a href="../../d2/de6/structAsn1Tag.html#a93c64e611d57dfb59e6ebafe938f28c1">Asn1Tag::constructed</a></div><div class="ttdeci">bool_t constructed</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d63/asn1_8h_source.html#l00099">asn1.h:99</a></div></div>
<div class="ttc" id="mpi_8c_html_ac1ddf7a0ceb3cb9c2490edaef9878bf9"><div class="ttname"><a href="../../db/d50/mpi_8c.html#ac1ddf7a0ceb3cb9c2490edaef9878bf9">mpiMod</a></div><div class="ttdeci">error_t mpiMod(Mpi *r, const Mpi *a, const Mpi *p)</div><div class="ttdoc">Modulo operation. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l01325">mpi.c:1325</a></div></div>
<div class="ttc" id="debug_8h_html_a67a8f9bc74358aa21745a76e23768dae"><div class="ttname"><a href="../../db/d16/debug_8h.html#a67a8f9bc74358aa21745a76e23768dae">TRACE_DEBUG</a></div><div class="ttdeci">#define TRACE_DEBUG(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00106">debug.h:106</a></div></div>
<div class="ttc" id="mpi_8c_html_a550a7330971d895957015b810b25c805"><div class="ttname"><a href="../../db/d50/mpi_8c.html#a550a7330971d895957015b810b25c805">mpiShiftRight</a></div><div class="ttdeci">error_t mpiShiftRight(Mpi *r, uint_t n)</div><div class="ttdoc">Right shift operation. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d50/mpi_8c_source.html#l01073">mpi.c:1073</a></div></div>
<div class="ttc" id="structEcDomainParameters_html_afcdd8e7ec1aa29476df4e2ae13882a12"><div class="ttname"><a href="../../d9/ddd/structEcDomainParameters.html#afcdd8e7ec1aa29476df4e2ae13882a12">EcDomainParameters::q</a></div><div class="ttdeci">Mpi q</div><div class="ttdoc">Order of the point G. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/ec_8h_source.html#l00071">ec.h:71</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_1702080616e5f4ed1265447cf141dd85.html">cyclone_crypto</a></li><li class="navelem"><a class="el" href="../../dir_aee0331b4c7b4c8e2c12ba918f10dc9b.html">ecc</a></li><li class="navelem"><a class="el" href="../../dc/d09/ecdsa_8c.html">ecdsa.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
