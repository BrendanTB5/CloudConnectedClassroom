\hypertarget{whirlpool_8c}{}\section{cyclone\+\_\+crypto/hash/whirlpool.c File Reference}
\label{whirlpool_8c}\index{cyclone\+\_\+crypto/hash/whirlpool.\+c@{cyclone\+\_\+crypto/hash/whirlpool.\+c}}


Whirlpool hash function.  


{\ttfamily \#include \char`\"{}core/crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}hash/whirlpool.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{whirlpool_8c_afcdf5e66fd927a7f4cc64295acd20407}{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}
\item 
\#define \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{R\+HO}(\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b},  \hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a},  \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n},  \hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} \hyperlink{whirlpool_8c_a60442c117d246bbc206aecbbdf64c76f}{whirlpool\+Compute} (const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length}, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest)
\begin{DoxyCompactList}\small\item\em Digest a message using Whirlpool. \end{DoxyCompactList}\item 
void \hyperlink{whirlpool_8c_a64090b0258ddf68cbc7668f00f004cc4}{whirlpool\+Init} (\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Initialize Whirlpool message digest context. \end{DoxyCompactList}\item 
void \hyperlink{whirlpool_8c_aaa66455d16873a69d184e2716d5950ee}{whirlpool\+Update} (\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$context, const void $\ast$\hyperlink{tftp__common_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, size\+\_\+t \hyperlink{ppp_8h_ab2b3adeb2a67e656ff030b56727fd0ac}{length})
\begin{DoxyCompactList}\small\item\em Update the Whirlpool context with a portion of the message being hashed. \end{DoxyCompactList}\item 
void \hyperlink{whirlpool_8c_a6c0da4537b2c61984d3cd7f018ef19c6}{whirlpool\+Final} (\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$context, \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$digest)
\begin{DoxyCompactList}\small\item\em Finish the Whirlpool message digest. \end{DoxyCompactList}\item 
void \hyperlink{whirlpool_8c_a8e63140d113500393cd30b121cd5291c}{whirlpool\+Process\+Block} (\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$context)
\begin{DoxyCompactList}\small\item\em Process message in 16-\/word blocks. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{whirlpool_8c_ae1cca62951c2df9f5bf77fda3dcdd423}{padding} \mbox{[}64\mbox{]}
\item 
static const \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} \hyperlink{whirlpool_8c_a39e2bdbc3db4af4bc91ce02c528236a0}{rc} \mbox{[}10\mbox{]}
\item 
static const \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} \hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t} \mbox{[}256\mbox{]}
\item 
const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} \hyperlink{whirlpool_8c_a331901788eff771b8649a94e2f92d280}{whirlpool\+Oid} \mbox{[}6\mbox{]} = \{0x28, 0x\+C\+F, 0x06, 0x03, 0x00, 0x37\}
\item 
const \hyperlink{structHashAlgo}{Hash\+Algo} \hyperlink{whirlpool_8c_a23bb8234f73387ce13b68fca4970f4a1}{whirlpool\+Hash\+Algo}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Whirlpool hash function. 

\hypertarget{pic32mz__ef__curiosity_8h_License}{}\subsection{License}\label{pic32mz__ef__curiosity_8h_License}
S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0-\/or-\/later

Copyright (C) 2010-\/2019 Oryx Embedded S\+A\+RL. All rights reserved.

This file is part of Cyclone\+Crypto Open.

This program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301, U\+SA.\hypertarget{tftp__server_8c_Description}{}\subsection{Description}\label{tftp__server_8c_Description}
Whirlpool is a hash function that operates on messages less than 2$^\wedge$256 bits in length, and produces a message digest of 512 bits

\begin{DoxyAuthor}{Author}
Oryx Embedded S\+A\+RL (www.\+oryx-\/embedded.\+com) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+9.\+6 
\end{DoxyVersion}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}\label{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}} 
\index{whirlpool.\+c@{whirlpool.\+c}!R\+HO@{R\+HO}}
\index{R\+HO@{R\+HO}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{R\+HO}{RHO}}
{\footnotesize\ttfamily \#define R\+HO(\begin{DoxyParamCaption}\item[{}]{\hyperlink{nbns__common_8h_a4313c9563516f94387762ab05763456b}{b},  }\item[{}]{\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a},  }\item[{}]{\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n},  }\item[{}]{\hyperlink{llmnr__common_8h_a2e5a04327b5658199f0f7bda2acceee1}{c} }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
\{ \(\backslash\)
   b = \hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n}] >> 56) & 0xFF]; \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 7) % 8] >> 48) & 0xFF], 8); \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 6) % 8] >> 40) & 0xFF], 16); \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 5) % 8] >> 32) & 0xFF], 24); \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 4) % 8] >> 24) & 0xFF], 32); \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 3) % 8] >> 16) & 0xFF], 40); \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[(\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 2) % 8] >> 8) & 0xFF], 48); \(\backslash\)
   b ^= \hyperlink{cyclone__crypto_2core_2crypto_8h_a057cc20666fe872898590d5d29bec330}{ROR64}(\hyperlink{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}{t}[\hyperlink{ndp_8h_af4007aacd75b22aee32dba9ea96082c0}{a}[(\hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n} + 1) % 8] & 0xFF], 56); \(\backslash\)
   b ^= \hyperlink{aria_8c_a5dadc28804036d1b82e1dc027e95c9a6}{c}; \(\backslash\)
\}
\end{DoxyCode}


Definition at line 47 of file whirlpool.\+c.

\mbox{\Hypertarget{whirlpool_8c_afcdf5e66fd927a7f4cc64295acd20407}\label{whirlpool_8c_afcdf5e66fd927a7f4cc64295acd20407}} 
\index{whirlpool.\+c@{whirlpool.\+c}!T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}
\index{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL@{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}{TRACE\_LEVEL}}
{\footnotesize\ttfamily \#define T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL~\hyperlink{crypto__config_8h_a6afae3a9b63f9b55d979e667ee0e881d}{C\+R\+Y\+P\+T\+O\+\_\+\+T\+R\+A\+C\+E\+\_\+\+L\+E\+V\+EL}}



Definition at line 37 of file whirlpool.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{whirlpool_8c_a60442c117d246bbc206aecbbdf64c76f}\label{whirlpool_8c_a60442c117d246bbc206aecbbdf64c76f}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Compute@{whirlpool\+Compute}}
\index{whirlpool\+Compute@{whirlpool\+Compute}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Compute()}{whirlpoolCompute()}}
{\footnotesize\ttfamily \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689c}{error\+\_\+t} whirlpool\+Compute (\begin{DoxyParamCaption}\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest }\end{DoxyParamCaption})}



Digest a message using Whirlpool. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & Pointer to the message being hashed \\
\hline
\mbox{\tt in}  & {\em length} & Length of the message \\
\hline
\mbox{\tt out}  & {\em digest} & Pointer to the calculated digest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}


Definition at line 183 of file whirlpool.\+c.


\begin{DoxyCode}
184 \{
185    \textcolor{comment}{//Allocate a memory buffer to hold the Whirlpool context}
186    \hyperlink{structWhirlpoolContext}{WhirlpoolContext} *context = \hyperlink{cyclone__crypto_2core_2crypto_8h_a48b53d16f66d31e5dcf82db3c1b882ba}{cryptoAllocMem}(\textcolor{keyword}{sizeof}(
      \hyperlink{structWhirlpoolContext}{WhirlpoolContext}));
187    \textcolor{comment}{//Failed to allocate memory?}
188    \textcolor{keywordflow}{if}(context == \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
189       \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cac0a554045048d2fb61387cf735676f69}{ERROR\_OUT\_OF\_MEMORY};
190 
191    \textcolor{comment}{//Initialize the Whirlpool context}
192    \hyperlink{whirlpool_8c_a64090b0258ddf68cbc7668f00f004cc4}{whirlpoolInit}(context);
193    \textcolor{comment}{//Digest the message}
194    \hyperlink{whirlpool_8c_aaa66455d16873a69d184e2716d5950ee}{whirlpoolUpdate}(context, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length});
195    \textcolor{comment}{//Finalize the Whirlpool message digest}
196    \hyperlink{whirlpool_8c_a6c0da4537b2c61984d3cd7f018ef19c6}{whirlpoolFinal}(context, digest);
197 
198    \textcolor{comment}{//Free previously allocated memory}
199    \hyperlink{cyclone__crypto_2core_2crypto_8h_ac8a223b176683db4e9eed4162774f870}{cryptoFreeMem}(context);
200    \textcolor{comment}{//Successful processing}
201    \textcolor{keywordflow}{return} \hyperlink{error_8h_ac7659d73a8cdedc08e9f566bb406689cabf350750d0d4fabd8954c0f1e9bbae94}{NO\_ERROR};
202 \}
\end{DoxyCode}
\mbox{\Hypertarget{whirlpool_8c_a6c0da4537b2c61984d3cd7f018ef19c6}\label{whirlpool_8c_a6c0da4537b2c61984d3cd7f018ef19c6}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Final@{whirlpool\+Final}}
\index{whirlpool\+Final@{whirlpool\+Final}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Final()}{whirlpoolFinal()}}
{\footnotesize\ttfamily void whirlpool\+Final (\begin{DoxyParamCaption}\item[{\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$}]{context,  }\item[{\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} $\ast$}]{digest }\end{DoxyParamCaption})}



Finish the Whirlpool message digest. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Whirlpool context \\
\hline
\mbox{\tt out}  & {\em digest} & Calculated digest (optional parameter) \\
\hline
\end{DoxyParams}


Definition at line 273 of file whirlpool.\+c.


\begin{DoxyCode}
274 \{
275    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
276    \textcolor{keywordtype}{size\_t} paddingSize;
277    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} \hyperlink{resource__manager_8h_afd8a6a01e3b212857df6efb82e06f682}{totalSize};
278 
279    \textcolor{comment}{//Length of the original message (before padding)}
280    totalSize = context->\hyperlink{structWhirlpoolContext_a5723d1b91fce5cb012b66bc21d626a43}{totalSize} * 8;
281 
282    \textcolor{comment}{//Pad the message so that its length is congruent to 32 modulo 64}
283    \textcolor{keywordflow}{if}(context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size} < 32)
284       paddingSize = 32 - context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size};
285    \textcolor{keywordflow}{else}
286       paddingSize = 64 + 32 - context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size};
287 
288    \textcolor{comment}{//Append padding}
289    \hyperlink{whirlpool_8c_aaa66455d16873a69d184e2716d5950ee}{whirlpoolUpdate}(context, \hyperlink{whirlpool_8c_ae1cca62951c2df9f5bf77fda3dcdd423}{padding}, paddingSize);
290 
291    \textcolor{comment}{//Append the length of the original message}
292    context->\hyperlink{structWhirlpoolContext_a31944f1f23b15f9c15db3b17d1c07eb4}{x}[4] = 0;
293    context->\hyperlink{structWhirlpoolContext_a31944f1f23b15f9c15db3b17d1c07eb4}{x}[5] = 0;
294    context->\hyperlink{structWhirlpoolContext_a31944f1f23b15f9c15db3b17d1c07eb4}{x}[6] = 0;
295    context->\hyperlink{structWhirlpoolContext_a31944f1f23b15f9c15db3b17d1c07eb4}{x}[7] = \hyperlink{cpu__endian_8h_a02eed9f02bd58916880c33c57510bea5}{htobe64}(totalSize);
296 
297    \textcolor{comment}{//Calculate the message digest}
298    \hyperlink{whirlpool_8c_a8e63140d113500393cd30b121cd5291c}{whirlpoolProcessBlock}(context);
299 
300    \textcolor{comment}{//Convert from host byte order to big-endian byte order}
301    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
302    \{
303       context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[i] = \hyperlink{cpu__endian_8h_a02eed9f02bd58916880c33c57510bea5}{htobe64}(context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[i]);
304    \}
305 
306    \textcolor{comment}{//Copy the resulting digest}
307    \textcolor{keywordflow}{if}(digest != \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})
308       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(digest, context->\hyperlink{structWhirlpoolContext_a797f258a426a4f5f2de2f3572cb02e25}{digest}, 
      \hyperlink{whirlpool_8h_ae55192999924bf94af7514f214b49808}{WHIRLPOOL\_DIGEST\_SIZE});
309 \}
\end{DoxyCode}
\mbox{\Hypertarget{whirlpool_8c_a64090b0258ddf68cbc7668f00f004cc4}\label{whirlpool_8c_a64090b0258ddf68cbc7668f00f004cc4}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Init@{whirlpool\+Init}}
\index{whirlpool\+Init@{whirlpool\+Init}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Init()}{whirlpoolInit()}}
{\footnotesize\ttfamily void whirlpool\+Init (\begin{DoxyParamCaption}\item[{\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Initialize Whirlpool message digest context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Whirlpool context to initialize \\
\hline
\end{DoxyParams}


Definition at line 210 of file whirlpool.\+c.


\begin{DoxyCode}
211 \{
212    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
213 
214    \textcolor{comment}{//Set initial hash value}
215    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
216    \{
217       context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[i] = 0;
218    \}
219 
220    \textcolor{comment}{//Number of bytes in the buffer}
221    context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size} = 0;
222    \textcolor{comment}{//Total length of the message}
223    context->\hyperlink{structWhirlpoolContext_a5723d1b91fce5cb012b66bc21d626a43}{totalSize} = 0;
224 \}
\end{DoxyCode}
\mbox{\Hypertarget{whirlpool_8c_a8e63140d113500393cd30b121cd5291c}\label{whirlpool_8c_a8e63140d113500393cd30b121cd5291c}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Process\+Block@{whirlpool\+Process\+Block}}
\index{whirlpool\+Process\+Block@{whirlpool\+Process\+Block}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Process\+Block()}{whirlpoolProcessBlock()}}
{\footnotesize\ttfamily void whirlpool\+Process\+Block (\begin{DoxyParamCaption}\item[{\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$}]{context }\end{DoxyParamCaption})}



Process message in 16-\/word blocks. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Whirlpool context \\
\hline
\end{DoxyParams}


Definition at line 317 of file whirlpool.\+c.


\begin{DoxyCode}
318 \{
319    \hyperlink{compiler__port_8h_a12a1e9b3ce141648783a82445d02b58d}{uint\_t} i;
320 
321    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} *x = context->\hyperlink{structWhirlpoolContext_a31944f1f23b15f9c15db3b17d1c07eb4}{x};
322    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} *\hyperlink{md5_8c_af11ea3cdbca7345eb6a4a8ac5ce0434d}{k} = context->\hyperlink{structWhirlpoolContext_a89a25dce17ea119db7c22a74b4424fd9}{k};
323    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} *\hyperlink{ndp_8h_a523d464ab421eaf2fae968f37a02bc02}{l} = context->\hyperlink{structWhirlpoolContext_ad3194c0b7a6c4e1ea1d0552943a1490f}{l};
324    \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\_t} *state = context->\hyperlink{structWhirlpoolContext_a5618839a2d02bf3e1282290f8d79a353}{state};
325 
326    \textcolor{comment}{//Convert from big-endian byte order to host byte order}
327    \textcolor{keywordflow}{for}(i = 0; i < 8; i++)
328    \{
329       x[i] = \hyperlink{cpu__endian_8h_af18eac7ad2dec12ba37255aeb701b08e}{betoh64}(x[i]);
330    \}
331 
332    k[0] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[0];
333    k[1] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[1];
334    k[2] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[2];
335    k[3] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[3];
336    k[4] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[4];
337    k[5] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[5];
338    k[6] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[6];
339    k[7] = context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[7];
340 
341    state[0] = x[0] ^ k[0];
342    state[1] = x[1] ^ k[1];
343    state[2] = x[2] ^ k[2];
344    state[3] = x[3] ^ k[3];
345    state[4] = x[4] ^ k[4];
346    state[5] = x[5] ^ k[5];
347    state[6] = x[6] ^ k[6];
348    state[7] = x[7] ^ k[7];
349 
350    \textcolor{comment}{//Iterate over all rounds}
351    \textcolor{keywordflow}{for}(i = 0; i < 10; i++)
352    \{
353       \textcolor{comment}{//Key schedule}
354       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[0], k, 0, \hyperlink{whirlpool_8c_a39e2bdbc3db4af4bc91ce02c528236a0}{rc}[i]);
355       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[1], k, 1, 0);
356       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[2], k, 2, 0);
357       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[3], k, 3, 0);
358       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[4], k, 4, 0);
359       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[5], k, 5, 0);
360       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[6], k, 6, 0);
361       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[7], k, 7, 0);
362 
363       k[0] = l[0];
364       k[1] = l[1];
365       k[2] = l[2];
366       k[3] = l[3];
367       k[4] = l[4];
368       k[5] = l[5];
369       k[6] = l[6];
370       k[7] = l[7];
371 
372       \textcolor{comment}{//Apply the round function}
373       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[0], state, 0, k[0]);
374       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[1], state, 1, k[1]);
375       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[2], state, 2, k[2]);
376       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[3], state, 3, k[3]);
377       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[4], state, 4, k[4]);
378       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[5], state, 5, k[5]);
379       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[6], state, 6, k[6]);
380       \hyperlink{whirlpool_8c_ad749585cfab8095ea3b31ed5c60af667}{RHO}(l[7], state, 7, k[7]);
381 
382       state[0] = l[0];
383       state[1] = l[1];
384       state[2] = l[2];
385       state[3] = l[3];
386       state[4] = l[4];
387       state[5] = l[5];
388       state[6] = l[6];
389       state[7] = l[7];
390    \}
391 
392    \textcolor{comment}{//Update the hash value}
393    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[0] ^= state[0] ^ x[0];
394    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[1] ^= state[1] ^ x[1];
395    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[2] ^= state[2] ^ x[2];
396    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[3] ^= state[3] ^ x[3];
397    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[4] ^= state[4] ^ x[4];
398    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[5] ^= state[5] ^ x[5];
399    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[6] ^= state[6] ^ x[6];
400    context->\hyperlink{structWhirlpoolContext_a25cc44a7c21c2bb3686cc19b95783a83}{h}[7] ^= state[7] ^ x[7];
401 \}
\end{DoxyCode}
\mbox{\Hypertarget{whirlpool_8c_aaa66455d16873a69d184e2716d5950ee}\label{whirlpool_8c_aaa66455d16873a69d184e2716d5950ee}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Update@{whirlpool\+Update}}
\index{whirlpool\+Update@{whirlpool\+Update}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Update()}{whirlpoolUpdate()}}
{\footnotesize\ttfamily void whirlpool\+Update (\begin{DoxyParamCaption}\item[{\hyperlink{structWhirlpoolContext}{Whirlpool\+Context} $\ast$}]{context,  }\item[{const void $\ast$}]{data,  }\item[{size\+\_\+t}]{length }\end{DoxyParamCaption})}



Update the Whirlpool context with a portion of the message being hashed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em context} & Pointer to the Whirlpool context \\
\hline
\mbox{\tt in}  & {\em data} & Pointer to the buffer being hashed \\
\hline
\mbox{\tt in}  & {\em length} & Length of the buffer \\
\hline
\end{DoxyParams}


Definition at line 234 of file whirlpool.\+c.


\begin{DoxyCode}
235 \{
236    \textcolor{keywordtype}{size\_t} \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
237 
238    \textcolor{comment}{//Process the incoming data}
239    \textcolor{keywordflow}{while}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} > 0)
240    \{
241       \textcolor{comment}{//The buffer can hold at most 64 bytes}
242       n = \hyperlink{os__port_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(\hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length}, 64 - context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size});
243 
244       \textcolor{comment}{//Copy the data to the buffer}
245       \hyperlink{cyclone__crypto_2core_2crypto_8h_a6724616c4014bb7e21f2660bd7b88be8}{cryptoMemcpy}(context->\hyperlink{structWhirlpoolContext_a884c918532249ee9bb31e50ef88bfb07}{buffer} + context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size}, \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data}, n);
246 
247       \textcolor{comment}{//Update the Whirlpool context}
248       context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
249       context->\hyperlink{structWhirlpoolContext_a5723d1b91fce5cb012b66bc21d626a43}{totalSize} += \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
250       \textcolor{comment}{//Advance the data pointer}
251       \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} = (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *) \hyperlink{dtls__misc_8h_a5c239a1bb87b52b0f1d6d68c4749cd2a}{data} + n;
252       \textcolor{comment}{//Remaining bytes to process}
253       \hyperlink{dtls__misc_8h_ab43ca82dd7fa2a0e56f941032ef324c4}{length} -= \hyperlink{dhcpv6__common_8h_a5a648f5ec00c526b0dfa2df7a272c6c0}{n};
254 
255       \textcolor{comment}{//Process message in 8-word blocks}
256       \textcolor{keywordflow}{if}(context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size} == 64)
257       \{
258          \textcolor{comment}{//Transform the 8-word block}
259          \hyperlink{whirlpool_8c_a8e63140d113500393cd30b121cd5291c}{whirlpoolProcessBlock}(context);
260          \textcolor{comment}{//Empty the buffer}
261          context->\hyperlink{structWhirlpoolContext_a35dddd961573cb16dfaa2ffaf0c3fba1}{size} = 0;
262       \}
263    \}
264 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{whirlpool_8c_ae1cca62951c2df9f5bf77fda3dcdd423}\label{whirlpool_8c_ae1cca62951c2df9f5bf77fda3dcdd423}} 
\index{whirlpool.\+c@{whirlpool.\+c}!padding@{padding}}
\index{padding@{padding}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{padding}{padding}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} padding\mbox{[}64\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
\}
\end{DoxyCode}


Definition at line 61 of file whirlpool.\+c.

\mbox{\Hypertarget{whirlpool_8c_a39e2bdbc3db4af4bc91ce02c528236a0}\label{whirlpool_8c_a39e2bdbc3db4af4bc91ce02c528236a0}} 
\index{whirlpool.\+c@{whirlpool.\+c}!rc@{rc}}
\index{rc@{rc}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{rc}{rc}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} rc\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   0x1823C6E887B8014F,
   0x36A6D2F5796F9152,
   0x60BC9B8EA30C7B35,
   0x1DE0D7C22E4BFE57,
   0x157737E59FF04ADA,
   0x58C9290AB1A06B85,
   0xBD5D10F4CB3E0567,
   0xE427418BA77D95D8,
   0xFBEE7C66DD17479E,
   0xCA2DBF07AD5A8333
\}
\end{DoxyCode}


Definition at line 70 of file whirlpool.\+c.

\mbox{\Hypertarget{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}\label{whirlpool_8c_a2cb0b5aab00187bbfb9c6cceec42b979}} 
\index{whirlpool.\+c@{whirlpool.\+c}!t@{t}}
\index{t@{t}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{t}{t}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} t\mbox{[}256\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 85 of file whirlpool.\+c.

\mbox{\Hypertarget{whirlpool_8c_a23bb8234f73387ce13b68fca4970f4a1}\label{whirlpool_8c_a23bb8234f73387ce13b68fca4970f4a1}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Hash\+Algo@{whirlpool\+Hash\+Algo}}
\index{whirlpool\+Hash\+Algo@{whirlpool\+Hash\+Algo}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Hash\+Algo}{whirlpoolHashAlgo}}
{\footnotesize\ttfamily const \hyperlink{structHashAlgo}{Hash\+Algo} whirlpool\+Hash\+Algo}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
   \textcolor{stringliteral}{"WHIRLPOOL"},
   \hyperlink{whirlpool_8c_a331901788eff771b8649a94e2f92d280}{whirlpoolOid},
   \textcolor{keyword}{sizeof}(\hyperlink{whirlpool_8c_a331901788eff771b8649a94e2f92d280}{whirlpoolOid}),
   \textcolor{keyword}{sizeof}(\hyperlink{structWhirlpoolContext}{WhirlpoolContext}),
   \hyperlink{whirlpool_8h_a480a6e25ed48dcec6c726b0f7d1c6e9a}{WHIRLPOOL\_BLOCK\_SIZE},
   \hyperlink{whirlpool_8h_ae55192999924bf94af7514f214b49808}{WHIRLPOOL\_DIGEST\_SIZE},
   \hyperlink{whirlpool_8h_af6f1f96b052bfd3e4978aa31712c752b}{WHIRLPOOL\_MIN\_PAD\_SIZE},
   \hyperlink{os__port_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_a02fe893af436f6d8a574897a59748592}{HashAlgoCompute}) \hyperlink{whirlpool_8c_a60442c117d246bbc206aecbbdf64c76f}{whirlpoolCompute},
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_afc5ce55917bd80825aa610848f402caf}{HashAlgoInit}) \hyperlink{whirlpool_8c_a64090b0258ddf68cbc7668f00f004cc4}{whirlpoolInit},
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_a3d1fb45d6ca7822d20873ddbc8e39b89}{HashAlgoUpdate}) \hyperlink{whirlpool_8c_aaa66455d16873a69d184e2716d5950ee}{whirlpoolUpdate},
   (\hyperlink{cyclone__crypto_2core_2crypto_8h_a0a272470b5f95692d2e2e882f75844b3}{HashAlgoFinal}) \hyperlink{whirlpool_8c_a6c0da4537b2c61984d3cd7f018ef19c6}{whirlpoolFinal},
   \hyperlink{group__BSPDefine_ga070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}
\}
\end{DoxyCode}


Definition at line 157 of file whirlpool.\+c.

\mbox{\Hypertarget{whirlpool_8c_a331901788eff771b8649a94e2f92d280}\label{whirlpool_8c_a331901788eff771b8649a94e2f92d280}} 
\index{whirlpool.\+c@{whirlpool.\+c}!whirlpool\+Oid@{whirlpool\+Oid}}
\index{whirlpool\+Oid@{whirlpool\+Oid}!whirlpool.\+c@{whirlpool.\+c}}
\subsubsection{\texorpdfstring{whirlpool\+Oid}{whirlpoolOid}}
{\footnotesize\ttfamily const \hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} whirlpool\+Oid\mbox{[}6\mbox{]} = \{0x28, 0x\+C\+F, 0x06, 0x03, 0x00, 0x37\}}



Definition at line 154 of file whirlpool.\+c.

